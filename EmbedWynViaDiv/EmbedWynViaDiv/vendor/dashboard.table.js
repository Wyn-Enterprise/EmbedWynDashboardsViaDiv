(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1798:function(e,t,r){var n,o,i,a,qe="object"==typeof qe?qe:{};function s(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}qe.Spread=(a={},s.m=i={"./all.entry.js":function(e,t,r){(qe=qe||{}).Spread=qe.Spread||{},qe.Spread=r("./node_modules_local/@grapecity/js-sheets-common/index.js"),qe.Spread.CalcEngine=r("./node_modules_local/@grapecity/js-calc/index.js"),qe.Spread.CalcEngine.BasicFunctions=r("./node_modules_local/@grapecity/js-calc-basicfunctions/index.js"),qe.Spread.CalcEngine.AdvancedFunctions=r("./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js"),qe.Spread.Sheets=r("./dist/core/core.entry.js"),qe.Spread.Sheets.Bindings=r("./dist/plugins/data/data.entry.js"),qe.Spread.Sheets.CalcEngine=r("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),qe.Spread.Sheets.ConditionalFormatting=r("./dist/plugins/conditional/conditional.entry.js"),qe.Spread.Sheets.DataValidation=r("./dist/plugins/validation/datavalidation.entry.js"),qe.Spread.Sheets.Touch=r("./dist/plugins/touch/touch.entry.js"),qe.Spread.Sheets.Sparklines=r("./dist/plugins/sparkline/sparkline-wrapper.entry.js"),qe.Spread.Sheets.CellTypes=r("./dist/plugins/celltype/celltypes.entry.js"),qe.Spread.Sheets.Tables=r("./dist/plugins/table/table.entry.js"),qe.Spread.Sheets.Fill=r("./dist/plugins/fill/fill.entry.js"),qe.Spread.Sheets.ContextMenu=r("./dist/plugins/contextMenu/context-menu.entry.js"),qe.Spread.Sheets.FormulaTextBox=r("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),e.exports=qe.Spread},"./dist/core/celltype/basecelltype.js":function(e,t,r){"use strict";var l,k,Ce,we,ue,n,u,c,h,f,ve,o,Se,a,ce,xe,he,Te,M,P,fe,G,d,U,y,w,de,pe,ge,L,W,T,p,I,Ae,E,ke,Me,Ie,Ee,i,Re,g,m,R,s,O,C,b,v;function A(){}function S(e,t,r){return Se(e.x)||(e.x+=t.width),e.width=e.width-t.width-r.width,e}function x(){this.allowOverflow=!1,this.typeName="0"}function B(e,t,r,n){var o,i,a=e.conditionalFormats;return a&&(o=e.getValue(t,r,n),i=a.oRa(e,t,r,o).iconSet,a.bp(t,r,n)&&i)}function V(e,t,r){var n,o,i=0;for(n=0;n<e.length;n++)o=e[n].style&&e[n].style.font?e[n].style.font:t,i=Math.max(ce(o,I,he(e[n].text))/r,i),(e[n].style&&1===e[n].style.vertAlign||2===e[n].style.vertAlign)&&(i=Math.max(ce(o,I,he(e[n].text))/r+2*we.To.No(o,g).fontSize*.218,i));return i}function z(e,t,r,n,o){var i,a,s,l,u,c=Ce.Vn.bm();if(!c)return 0;for(a=i=0;a<e.length;a++)s=void 0,s=e[a].style&&e[a].style.font?e[a].style.font:t,e[a].style&&e[a].style.vertAlign&&(s=we.To.No(s,g).font),Te(c,s),l=a===e.length-1&&o?Ce.Vn.Rvb(e[a].text):e[a].text,u=0,n?u=ce(s)*l.length/r:Se(e[a].text)||(u=fe(c,s,e[a].text)/r),i+=u;return i}function j(e){return parseInt(L*e.zoom(),10)}function De(e,t,r,n){var o=e.cellPadding,i=0,a=e.labelOptions;return r&&(o=a?a.margin:"0"),o&&(i=typeof(i=parseInt(N(o)[t],10))===T&&0<i?i:0),n===I?i:i*n}function D(e,t,r,n){var o,i,a,s,l=n&&n.sheet;l&&r&&(o=n.canvasOffset||l._eventHandler.bG(),i=l.Dr(),(a=t.backColor||"white").stops&&(a=(s=a.stops)[0]&&s[0].color),a.backgroundColor&&(a=a.backgroundColor),k.GC$(e).width(r.width).height(r.height).css({top:o.top+i.y+r.y-2,left:o.left+i.x+r.x-2,"background-color":a}))}function N(e){var t,r,n,o,i=["0","0","0","0"];return typeof e===W&&(o=n=void 0,1===(r=(t=e.split(" ",4)).length)?i=[n=t[0],n,n,n]:2===r?i=[n=t[0],o=t[1],n,o]:3===r?(o=t[1],i=[t[0],o,t[2],o]):4===r&&(i=[t[0],t[1],t[2],t[3]])),i}function F(e,t){var r,n=De(e,0),o=De(e,2),i=De(e,0,!0),a=De(e,2,!0);if(!(De(e,3,!0)+De(e,1,!0)>=t.width))if((r=e.labelOptions.alignment)===I&&(r=e.labelOptions.alignment=0),0===r||1===r||2===r){if(0<n&&i+a<n)return 1}else if((3===r||4===r||5===r)&&n<t.height&&0<o&&i+a<o)return 1}function _(e){var t="left";return 1===e||4===e?t="center":2!==e&&5!==e||(t="right"),t}function H(e,t){var r,n,o;if(e.cellPadding){for(r=N(e.cellPadding),n=void 0,o=[],n=0;n<4;n++)o[n]=parseInt(r[n],10),"number"==typeof o[n]&&0<o[n]&&(o[n]*=t);e.cellPadding=o.join(" ")}}function q(e,t,r){var n,o,i;if(a(t,W))return n=0,m[e.font+t]?n=m[e.font+t]:(n=fe(e,e.font,t),m[e.font+t]=n),n;if(r&&t&&t[0]&&t[0].value)return t[0].value.length*ce(e.font);for(i=o=0;i<t.length;i++)"fillingChar"!==t[i].type&&(n=0,m[e.font+t[i].value]?n=m[e.font+t[i].value]:(n=fe(e,e.font,t[i].value),m[e.font+t[i].value]=n),o+=n);return o}function Z(e){for(var t=0;t<e.length;t++)if("fillingChar"===e[t].type)return 1}function Y(e,t,r,n,o){var i;return i=n?Math.floor(t/o):Math.floor(t/fe(e,e.font,r)),Array(i+1).join(r)}function K(e){var t=e.clone();return t.width--,t.height--,t}function X(e,t,r){var n,o,i;for(n=0;n<e.length;n++)e[n].style=e[n].style||{},o=(i=e[n].style).font?we.To.No(i.font,r).font:t,i.font=o}function Ne(e,t,r,n,o){var i=r*Me(-n)+o*ke(-n),a=r*Me(-n)+o*ke(-n),s=e-i/2,l=t-a/2;return new Ce.Rect(s,l,i,a)}Object.defineProperty(t,"__esModule",{value:!0}),l=r("@grapecity/js-sheets-common"),k=r("./dist/core/util/domUtil.js"),Ce=r("./dist/core/util/common.js"),we=r("./dist/core/worksheet/stylehelper.js"),ue=r("./dist/core/core.enum.js"),n=r("./dist/core/celltype/celltype.ns.js"),u=r("@grapecity/js-calc"),l.Common.F,c=l.Common.CultureManager,h=l.Common.o,f=l.Common.l,ve=l.Common.pc,o=l.Common.j,Se=o.Fa,a=o.Ma,ce=Ce.Ul.fp,xe=Ce.Ul.ol,he=Ce.Ul.uWa,Te=Ce.Ul.lZa,M=Ce.Ul.hZa,P=Ce.Ul.K_a,fe=Ce.Ul.pL,G=Ce.Ul.Fxb,d=Ce.Ul.lHb,U=k.GC$.extend,y=Ce.Ul.Ml,w="left",de="right",pe="center",ge="alphabetic",L=16,W="string",T="number",p=null,I=void 0,Ae=Math.floor,E=Math.ceil,ke=Math.sin,Me=Math.cos,Ie=Math.tan,Ee=Math.abs,i="General",Re=Math.max,g=.7,m={},R="...",(v=s=s||{})[v.top=0]="top",v[v.right=1]="right",v[v.bottom=2]="bottom",v[v.left=3]="left",A.Gxb=function(e){var t,r,n=e.split("e")[1];if(n&&0<n.length&&("+"===n[0]?t=!0:"-"===n[0]&&(t=!1),r=n.slice(1)),void 0!==t)return{isAdd:t,length:r}},A.Apb=function(e,t,r){var n=A.Hxb,o=n[t+r];return o||(o=fe(e,t,r),n[t+r]=o),o},A.Ixb=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x=n.font;if(r=r-1-3*o,i=n.textIndent&&0!==n.textIndent,a=n.isVerticalText,typeof t!==T||!0===n.shrinkToFit||a||i)return n._autoFormatter;if(s=t<0,t=Ee(t),l=s?A.Apb(e,x,"-"):0,c=A.Gxb(u=""+t),h=void 0,f=A.Jxb(n._autoFormatter,t),c)return h=(""+c.length).length,h=Re(h,2),A.Kxb(e,r,n,h,l,c.isAdd,f);if(d=l,p=A.Apb(e,x,"0"),g=u.split("."),d+=m=p*(""+Math.round(t)).length,b=A.Apb(e,x,"."),y=void 0,m<=r){if(!g[1]||0===g[1].length)return n._autoFormatter;if((d=d+g[1].length*p+b)<=r)return n._autoFormatter;if(t<.001)return h=(""+g[1].length).length,h=Re(h,2),A.Kxb(e,r,n,h,l,!1,f);for(C=r-l-m-b,w=Math.floor(C/p),y="0",0<(w=Math.min(w,g[1].length))&&(y+="."),v=0;v<w;v++)y+="0";return y}return S=Math.round(t),h=Re(h=(""+(""+S).length).length,2),A.Kxb(e,r,n,h,l,!0,f)},A.Kxb=function(e,t,r,n,o,i,a){var s,l,u,c=r.font,h=A.Apb(e,c,"0"),f=A.Apb(e,c,"E"),d=A.Apb(e,c,"+"),p=A.Apb(e,c,"-"),g=t-o-n*h-f-(i?d:p)-h,m=g-A.Apb(e,c,".");if(m<=h)return i?"0E+00":0<g?"0E-00":"0";for(s=Math.floor(m/h),s=Math.min(s,a),l="0",u=0;u<s;u++)0===u&&(l+="."),l+="0";return l+(i?"E+00":"E-00")},A.Lxb=function(e,t,r,n,o){var i,a,s,l,u,c,h=n.font;if(r=r-1-3*o,i=n.textIndent||0,a=r,1!==n.hAlign&&0<i&&(a=r-8*i),a<fe(e,n.font,t)){for(s=A.Apb(e,h,"#"),l=Math.floor(r/s),u="",c=0;c<l;c++)u+="#";return u}return t},A.ap=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b;if(i&&"none"!==i&&s)try{s.ko(i)?(l=s.lo(i),u=void 0,y.msie&&((u=document.createElement("div")).appendChild(l),document.body.appendChild(u)),c=l.width,h=l.height,y.msie&&(u.removeChild(l),document.body.removeChild(u)),f=c,d=h,p=n,g=o,m=t,b=r,1===a?(f=c<=n?c:n,d=h<=o?h:o,m=c<n&&0<c?E(t+n/2-c/2):t,b=h<o&&0<h?E(r+o/2-h/2):r,p=f,g=d):2===a?0<o&&0<h&&c/h<n/o?m=t+n/2-(p=c/h*o)/2:0<n&&0<c&&h/c<o/n&&(b=r+o/2-(g=h/c*n)/2):3===a&&(p=f=c<=n?c:n,g=d=h<=o?h:o),e.drawImage(l,0,0,f,d,m,b,p,g)):s.fo(i)}catch(e){}},A.cp=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k=0,M=o&&o.sheet,I=r.textIndent,E=r.hAlign,R=r.isVerticalText,D=r.textOrientation,N=r.borderTop||r.borderBottom||r.borderLeft||r.borderRight,F=r.font,_=o.row,P=o.col;if(D&&-90<=D&&D<=90&&(l=Ee(D*Math.PI/180),a=ke(l),s=Me(l)),M&&typeof t===W&&t)if(u=[],c=void 0,e&&e.richText)if(h=r.formatter||r._autoFormatter,d=(f=M.getCellType(_,P)).T_a(h,e.text),X(c=U(!0,[],f.U_a(e,t,d,F,r.foreColor)),F,n),R)if(r.wordWrap){if(p=o.sheetArea,g=M.Sl(_),(m=M._modelManager.findSpan(_,P,p))&&m.row>=_&&m.col>=P&&1<m.rowCount)for(b=_+1;b<_+m.rowCount;b++)g+=M.Sl(b);for((y=0)<I&&(y=8*I),0<(C=De(r,0))&&(g-=C),0<(w=De(r,2))&&(g-=w),g++,u=Ce.Vn.M_a(t,g-3-y,F,c,R),i=0;i<u.length;i++)k+=V(u[i].textInfos,F,n)}else k=V(c,F,n);else{if(r.wordWrap){for(v=t.split(/\r\n|\r|\n/),i=0;i<v.length;i++)(S=[]).push(v[i]),u.push(S);for(u=Ce.Vn.O_a(u,Ce.Vn.P_a(c)),i=0;i<u.length;i++)k=Math.max(k,z(u[i],F,n,R,!0))}else k=z(c,F,n);1!==E&&0<I&&(k+=8*I/n),B(M,_,P,o.sheetArea)&&(k+=j(M))}else if(u=t.split(/\r\n|\r|\n/),x=r.font,T=ce(x)/n,R)if(r.wordWrap)for(i=0;i<u.length;i++)k+=T;else k=T;else{if(r.wordWrap){if(D)return A=M.Sl(_),Ce.Vn.mHb(_,P,a,s,t,x,A);for(i=0;i<u.length;i++)k=Math.max(k,Ce.Vn.Xn(u[i],x,!0)/n)}else k=D?N?(4+T)/a:s*(M.dp(t,x)/n)+T*a:M.dp(t,x)/n;1!==E&&0<I&&(k+=8*I/n),B(M,_,P,o.sheetArea)&&(k+=L)}return k},A.ep=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N=0,F=o&&o.sheet,_=r.font,P=r.isVerticalText,L=r.textIndent,O=r.vAlign,B=r.textOrientation,j=o.row,H=o.col;if(B&&-90<=B&&B<=90&&(C=Ee(B*Math.PI/180),b=ke(C),y=Me(C)),F&&typeof t===W&&t)if(w=[],v=void 0,e&&e.richText)if(S=r.formatter||r._autoFormatter,T=(x=F.getCellType(j,H)).T_a(S,e.text),X(v=U(!0,[],x.U_a(e,t,T,_,r.foreColor)),_,n),P){if(r.wordWrap){for(A=t.split(/\r\n|\r|\n/),i=0;i<A.length;i++)(k=[]).push(A[i]),w.push(k);for(w=Ce.Vn.O_a(w,Ce.Vn.P_a(v)),i=0;i<w.length;i++)N=Math.max(N,z(w[i],_,n,P,!0))}else N=z(v,_,n,P);1!==O&&0<L&&(N+=8*L/n)}else if(r.wordWrap){if(a=o.sheetArea,s=F.Tl(H),(u=F._modelManager.findSpan(j,H,a))&&u.row>=j&&u.col>=H&&1<u.colCount)for(c=H+1;c<H+u.colCount;c++)s+=F.Tl(c);for((f=0)<L&&(f=8*L),d=De(r,1),0<(p=De(r,3))&&(s-=p),0<d&&(s-=d),s++,w=Ce.Vn.M_a(t,s-3-f,_,v),i=0;i<w.length;i++)N+=V(w[i].textInfos,_,n)}else N=V(v,_,n);else if(M=r.font,I=ce(M)/n,P){if(r.wordWrap)for(w=t.split(/\r\n|\r|\n/),i=0;i<w.length;i++)E=w[i].length*I,N=Math.max(N,E);else N=t.length*I;1!==O&&0<L&&(N+=8*L/n)}else if(r.wordWrap){if(a=o.sheetArea,s=F.Tl(H),l=F.Sl(j),(u=F._modelManager.findSpan(j,H,a))&&u.row>=j&&u.col>=H&&1<u.colCount){for(c=H+1;c<H+u.colCount;c++)s+=F.Tl(c);for(h=j+1;h<j+u.colCount;h++)l+=F.Sl(h)}if((f=0)<L&&(f=8*L),d=De(r,1),0<(p=De(r,3))&&(s-=p),0<d&&(s-=d),0<(g=De(r,0))&&(l-=g),0<(m=De(r,2))&&(l-=m),1===a&&(R=F.rowFilter&&F.rowFilter())&&R.Dl(j,H,a)&&R.filterButtonVisible(H)&&(s-=F.oK(new Ce.Rect(0,0,s,l),a).width),B)return D=(l-I*y)/b,w=Ce.Vn.Wn(t,D,M),b*(F.dp(w[0],M)/n)+I*y;N=(w=G(e)?[t]:Ce.Vn.Wn(t,s-3-f,M)).length*I}else N=B?b*(F.dp(t,M)/n)+I*y:I;return N},A.gp=function(e,t,r,n,o,i,a,s,l,u,c){var h;1===l?(e.beginPath(),(h=e.createLinearGradient(t,r+1,t,r+o-2)).addColorStop(0,s.borderLeftColor),h.addColorStop(1,s.borderRightColor),e.strokeStyle!==h&&(e.strokeStyle=h),i.borderLeft||(e.moveTo(t+.5,r),e.lineTo(t+.5,r+o)),i.borderRight||(e.moveTo(t+n-.5,r),e.lineTo(t+n-.5,r+o)),u&&!i.borderTop&&(e.moveTo(t,r+.5),e.lineTo(t+n,r+.5)),e.stroke(),s.borderBottomWidth&&!i.borderBottom&&(e.beginPath(),e.strokeStyle!==s.borderBottomColor&&(e.strokeStyle=s.borderBottomColor),e.moveTo(t+1,r+o-.5),e.lineTo(t+n,r+o-.5),e.stroke())):(e.beginPath(),(h=e.createLinearGradient(t,r,t+n-2,r)).addColorStop(0,s.borderTopColor),h.addColorStop(1,s.borderBottomColor),e.strokeStyle!==h&&(e.strokeStyle=h),i.borderTop||(e.moveTo(t,r+.5),e.lineTo(t+n,r+.5)),i.borderBottom||(e.moveTo(t,r+o-.5),e.lineTo(t+n,r+o-.5)),c&&!i.borderLeft&&(e.moveTo(t+.5,r),e.lineTo(t+.5,r+o)),e.stroke(),s.borderRightWidth&&!i.borderRight&&(e.beginPath(),e.strokeStyle!==s.borderRightColor&&(e.strokeStyle=s.borderRightColor),e.moveTo(t+n-.5,r+1),e.lineTo(t+n-.5,r+o),e.stroke()))},A.hp=function(e,t){var r;r=2===t?"active":4===t?"inactive":0===t?"disabled":"auto",k.GC$(e).css("ime-mode",r)},A.bDc=function(e,t,r,n,o,i,a){var s,l;return!!(t&&"SparklineExValue"===t.typeName&&(s=a&&a.parent)&&(l=s.getSparklineEx(t.name)))&&(l.paint(e,t.value,r,n,o,i,{zoomFactor:a.zoom(),sheet:a}),!0)},A.Hxb={},A.Jxb=function(e,t){var r,n,o,i,a;return e&&e.Ud&&(r=e.Ud(t).format(t))&&r[1]&&"decimalSeparator"===r[1].type?(n=r[2])&&"number"===n.type?(o=n.value,a=(i=r[3])&&"exponent"===i.type&&i.value&&-1<i.value.indexOf("E"),!Se(o)&&a?o.length:5):0:5},A.u5=De,O=A,t.Context=O,C={9001:65087,9002:65088,10216:65087,10217:65088,10092:65087,10093:65088,10096:65087,10097:65088,12296:65087,12297:65088,9121:65089,9126:65090,12300:65089,12301:65090,65378:65089,65379:65090,40:9180,41:9181,91:9140,93:9141,65339:9140,65341:9141,123:9182,125:9183,10100:9182,10101:9183,65115:9182,65116:9183,65371:9182,65373:9183,12310:65047,12311:65048,10098:65081,10099:65082,12308:65081,12309:65082,65117:65081,65118:65082,12304:65083,12305:65084,10218:65085,10219:65086,12298:65085,12299:65086,12302:65091,12303:65092},x.prototype.uxb=function(e,t,r,n){var o={ctx:e,options:{rect:t,context:r,value:n}};return x.ao(r.sheet,"paintCellPadding",o),o.options.rect},x.prototype.Mfc=function(e,t,r){var n={context:e,options:{dom:t,cellRect:r,contentRect:r.clone(),leftExternalRect:new Ce.Rect(0,0,0,0),rightExternalRect:new Ce.Rect(0,0,0,0)}};return x.ao(e.sheet,"onCreateCellEditor",n),n.options.dom},x.prototype.TBb=function(e,t,r){var n={ctx:null,options:{rect:t.clone(),context:e,value:null,style:r}};return x.ao(e.sheet,"getCellButtonRect",n),n.options.rect},x.prototype.Nfc=function(e,t,r,n){var o={context:e,options:{dom:t,cellRect:r,cellStyle:n,contentRect:r.clone(),leftExternalRect:new Ce.Rect(0,0,0,0),rightExternalRect:new Ce.Rect(0,0,0,0)}};return x.ao(e.sheet,"onActivateCellEditor",o),o},x.prototype.VBb=function(e,t,r,n){var o={context:e,contentContainer:t,editorBounds:r,cellStyle:n,contentRect:r.clone(),leftExternalRect:new Ce.Rect(0,0,0,0),rightExternalRect:new Ce.Rect(0,0,0,0)};return x.ao(e.sheet,"onUpdateContainer",o),o},x.prototype.Ofc=function(e,t,r){var n={context:e,options:{dom:t,cellRect:r,contentRect:r.clone(),leftExternalRect:new Ce.Rect(0,0,0,0),rightExternalRect:new Ce.Rect(0,0,0,0)}};return x.ao(e.sheet,"onDeactivateCellEditor",n),n.options.dom},x.prototype.XBb=function(e,t,r){this.deactivateEditor(e,t),this.Ofc(t,e,r)},x.prototype.i5=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v=r.labelOptions;if(v&&(o=n.sheet,i=r.watermark)){if(a=v.visibility,s=o.getText(n.row,n.col,n.sheetArea),1===a||(2===a||a===I)&&""===s)return;1!==(l=o.zoom())&&H(r,l),c=(u=v.font)?we.To.No(u,l):we.To.No(r.font,1),h=ce(c.font),p=t,m=De(g=r,0),b=De(g,3,!0),y=De(g,2,!0),C=p.clone(),0===(w=g.labelOptions.alignment)||1===w||2===w?m<p.height&&(C.height=m-y+1):3!==w&&4!==w&&5!==w||(C.height=p.height-y),C.x+=b,C.width-=b+De(g,1,!0),f=C,d=void 0,F(r,t)&&(d=function(e,t,r,n){var o=new Ce.Point(e.x,e.y),i=parseInt(r.fontSize,10),a=De(t,0),s=De(t,2),l=De(t,3,!0),u=De(t,1,!0),c=e.width,h=e.height,f=8<i?Math.floor((i-8)/5+2):1,d=8<i?1:2,p=n-(n/2-i/2+f-1)+De(t,0,!0),g=p+1,m=h<a+s?a+p:h-s+p-1;switch(t.labelOptions.alignment){case 0:o.x+=l+d+1,o.y+=g;break;case 1:o.x+=l+(c-l-u)/2,o.y+=g;break;case 2:o.x+=c-u-2,o.y+=g;break;case 3:o.x+=l+d+1,o.y+=m;break;case 4:o.x+=l+(c-l-u)/2,o.y+=m;break;case 5:o.x+=c-u-2,o.y+=m}return o}(t,r,c,h)),d&&(e.save(),e.textAlign=_(v.alignment),e.textBaseline="alphabetic",Te(e,c.font),e.fillStyle=v.foreColor||r.foreColor||"grey",e.rect(f.x,f.y,f.width,f.height),e.clip(),e.beginPath(),e.fillText(i,d.x,d.y),e.restore())}},x.prototype.f5=function(e,t){var r=e.clone(),n=De(t,0),o=De(t,1),i=De(t,2),a=De(t,3);return 0<n&&(r.y+=n,r.height-=n),0<i&&(r.height-=i),0<a&&(r.x+=a,r.width-=a),0<o&&(r.width-=o),o+a>=e.width&&(r.width=0),n+i>=e.height&&(r.height=0),r},x.prototype.Ama=function(e,t,r,n){var o;return o={ctx:e,options:{rect:t=this.f5(t,r),context:n}},x.ao(n.sheet,"getCellPaddingRect",o),o.options.rect},x.prototype.e5=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A=r.labelOptions;A&&(i=(o=n.sheet).getText(n.row,n.col,n.sheetArea),a=r.watermark,1!==(s=A.visibility)&&a&&(l=A.font||r.font||o._render.Bl(),1!==(u=o.zoom())&&(l=o._render.Cl(l),H(r,u)),c=ce(l),F(r,t)&&(b=t,C=De(y=r,3,!0),w=De(y,1,!0),v=De(y,0,!0),S=De(y,2,!0),x=b.clone(),T=y.labelOptions.alignment,x.x=C+1,x.width-=C+w,0===T||1===T||2===T?(x.y=v,x.height=De(y,0)-v-S):3!==T&&4!==T&&5!==T||(x.y=b.height-De(y,2)+v,x.height=De(y,2)-v-S),2!==T&&5!==T||(x.width-=2),h=x),h&&((f=k.GC$(Ce.Ul.Nl("span"))).text(a),d=(2===s||s===I)&&""===i,p=h.height-c,g=h.y+(d&&0<p?p:0),f.css({display:"block",position:"absolute",left:h.x,top:g,width:h.width,height:h.height,font:M(l),color:A.foreColor||r.foreColor||"grey",textAlign:_(A.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),k.GC$(e).append(f),d&&(m=setInterval(function(){g--,f.css("top",g),g<=h.y&&clearInterval(m)},20)))))},x.prototype._createCellTypeElement=function(e){var t,r,n=Ce.Ul.Nl("div");return n.style.cssText="position: absolute; margin: 0;padding: 0 ;overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",(t=Ce.Ul.Nl("div")).style.cssText="position: absolute; outline: none; border: none",k.GC$(n).append(k.GC$(t)),(r=this.createEditorElement(e,n))&&k.GC$(t).append(k.GC$(r)),this.Mfc(e,n,e.sheet.getCellRect(e.row,e.col)),n},x.prototype._activateEditorWrapper=function(e,t,r,n){var o,i,a,s,l,u,c,h,f;e&&e.firstChild&&(o=this,D(e,t,i=K(r),n),s=(a=o.Nfc(n,e,i,t)).options.contentRect,l=a.options.cellRect,u=a.options.leftExternalRect,c=a.options.rightExternalRect,o.e5&&o.e5(e,s,t,n),h=S(s=o.f5?o.f5(s,t):s,u,c),f=e.firstChild,k.GC$(f).css({left:(+k.GC$(f).css("left").replace("px","")||0)+De(t,3),top:(+k.GC$(f).css("top").replace("px","")||0)+De(t,0)}),o.activateEditor(e.firstChild.firstChild,t,h,n,l,u,c))},x.prototype.updateEditorContainer=function(e,t,r,n,o,i,a){var s,l,u,c,h,f;e&&t&&(l=(s=e.parentNode)?s.parentNode:I)&&o&&(u=k.GC$(l),c=o.width,h=o.height,0<c&&(u.width(c),f=l.lastChild,r&&"gcEditorLabel"===f.getAttribute("gcUIElement")&&k.GC$(f).width(c-De(r,3,!0)-De(r,1,!0)-2)),0<h&&u.height(h),Se(o.x)||u.css("left",o.x+"px"),Se(o.y)||u.css("top",o.y+"px"))},x.prototype._updateEditorWrapper=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m=this,b=e.firstChild,y=n.sheet,C=K(r);D(e,t,C,n),i=m.VBb(n,b,C,t),o&&y&&H(t,y.zoom()),a=i.editorBounds,s=i.contentRect,l=i.leftExternalRect,u=i.rightExternalRect,c=b.firstChild,h=S(s=m.f5?m.f5(s,t):s,l,u),f=m.updateEditor(c,t,h,n,a,l,u),d={width:l.width,height:l.height},p={width:u.width,height:u.height},g={width:!isNaN(f&&f.width)&&f.width+d.width+p.width>a.width?f.width+d.width+p.width:a.width,height:!isNaN(f&&f.height)&&f.height+d.height+p.height>a.height?f.height+d.height+p.height:a.height},m.updateEditorContainer(c,f,t,n,g,d,p)},x.prototype.h5=function(e,t,r,n,o){return this.getCellAndPaddingHitInfo(e,t,r,n,o)},x.prototype.X4=function(e,t,r,n,o){var i,a,s,l,u=(l={context:s=o,value:0,cellStyle:r},b.ao(s.sheet,"getCellButtonAutoWidth",l),l.value+(a={context:i=o,value:0},b.ao(i.sheet,"getOutlineColumnOffset",a),a.value)),c=this.getAutoFitWidth(e,t,r,n,o);return 0<c&&(u+=c+De(r,3,!1)+De(r,1,!1)),u},x.prototype.Y4=function(e,t,r,n,o){var i,a,s=0,l=this.getAutoFitHeight(e,t,r,n,o);return 0<l&&(s+=l+De(r,0,!1)+De(r,2,!1)),Math.max((a={context:i=o,value:0,cellStyle:r},b.ao(i.sheet,"getCellButtonAutoHeight",a),a.value),s)},x.prototype.paintValue=function(e,t,r,n,o,i,a,s){var l,u,c={};s.quotePrefix=a.quotePrefix,(l=this.format(P(t),a.formatter||a._autoFormatter,c,s))&&(u=this.Pfc(e,l,a,s,r,n,o,i),this.paintText(e,t,r,n,o,i,a,s,l,c,I,u.externals))},x.prototype.S_a=function(e,t,r){var n=0;return 0<e&&(n=8*e),t&&t.XQa(r)&&(n=0),n},x.prototype.T_a=function(e,t){return!!(!e||a(e,W)&&e===i||e&&e.formatString&&e.formatString()===i)||!(t&&(!isNaN(t)||"TRUE"===t.toUpperCase()||"FALSE"===t.toUpperCase())&&"@"!==e)},x.prototype.Qfc=function(e){var t,r=0;for(t=0;t<e.length;t++)r+=e[t].width;return r},x.prototype.Rfc=function(e){var t,r=0;for(t=0;t<e.length;t++)r+=e[t].height;return r},x.prototype.Sfc=function(e,t,r,n,o){var i={ctx:e,options:{rect:r,context:t,value:n,style:o}};x.ao(t.sheet,"beforePaintLabel",i)},x.prototype.Pfc=function(e,t,r,n,o,i,a,s){var l={ctx:e,text:t,rect:new Ce.Rect(o,i,a,s),style:r,context:n,externals:{left:[],right:[]}};return x.ao(n.sheet,"beforePaintText",l),l},x.prototype.Tfc=function(e,t,r,n,o,i,a,s,l){var u={ctx:e,style:t,context:r,textRect:new Ce.Rect(n,o,i,a),availRect:s};return x.ao(r.sheet,l,u),u},x.prototype.Ufc=function(e,t,r,n,o,i,a,s){return this.Tfc(e,t,r,n,o,i,a,s,"beforeFillTextArea")},x.prototype.Vfc=function(e,t,r,n,o,i,a,s){return this.Tfc(e,t,r,n,o,i,a,s,"afterFillTextArea")},x.prototype.paintText=function(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p;e.save(),e.beginPath(),f=a.textOrientation,d=a.textIndent&&0!==a.textIndent,p=a.isVerticalText,t&&t.richText&&0<t.richText.length||p?this.Fpb(e,t,r,n,o,i,a,s,l,u,c,h):0!==f&&!Se(f)&&-90<=f&&f<=90&&!d&&!p?this.nHb(e,t,r,n,o,i,a,s,l,u,c,h):this.N$a(e,t,r,n,o,i,a,s,l,u,c,h),e.restore()},x.prototype.oHb=function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p,g,m,b,y,C,w,v,S=t.sheet,x=t.row,T=t.col,A=o.vAlign,k=t.sheetArea;for(c=0;c<r.length;c++)if(h=r[c].text,f=n[c].lineHeight,d=1===A?0:s,p=this.pHb(e,"0"),g="",(m=i)-1-2-d<h.length*f){if(m<3*p)u.push(0),g=R;else if(b=Ae((m-1-2-3*p-(1===A?0:s))/f),(y=0)===A){for(C=0;C<b;C++)g+=h[C];w=g.length,3*p+((g+=R).length-3)*f+s>m-1-2?(g=g.substring(0,g.length-4)+R,u.push(g.split(R)[0].length)):u.push(w)}else if(1===A){for(v=0;v<E(b/2);v++)g+=h.charAt(v),y=v;for(w=g.length,g+=R,v=E(h.length-b/2);v<h.length;v++)g+=h.charAt(v);3*p+(g.length-3)*f+s>m-1-2?(g=g.replace(h[y],""),u.push(g.split(R)[0].length)):u.push(w),l[c].y=a+(i-(3*p+(g.length-3)*f))/2}else{for(u.push(0),C=h.length-1;C>=h.length-b;C--)g=h[C]+g;3*p+((g=R+g).length-3)*f+s>m-1-2&&(g=g.replace(h[h.length-b],"")),l[c].y=a+i-s-(3*p+(g.length-3)*f)-2}r[c].textInfos[0].text=g,S._modelManager.qHb(x,T,h,k)}else S._modelManager.qHb(x,T,null,k)},x.prototype.Fpb=function(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F=this,_=new Ce.Rect(r,n,o,i),P=F.S_a(a.textIndent,s.sheet.outlineColumn,s.col),L=a.hAlign;if(3===L&&(L=xe(L,t,a.formatter)),d=!!(f=a.isVerticalText)&&he(l),p=a.font,g=a.formatter||a._autoFormatter,m=F.T_a(g,t.text),b=U(!0,[],F.U_a(t,l,m,p,a.foreColor)),t&&t.richText&&0<t.richText.length&&(y=s.sheet?s.sheet.zoom():1,F.V_a(b,p,y)),w=C=0,h&&(C=F.Qfc(h.left),w=F.Qfc(h.right)),v=C+w,S={left:C,right:w},!a.wordWrap&&a.shrinkToFit&&F.W_a(b,o-v,i,a,p,1,f),x=F.X_a(e,l,a.font,f?i:o-v,P,f?a.vAlign:a.hAlign,a.wordWrap,f,b),T=F.Y_a(x,a,L,c),A=F.Z_a(e,a,r,n,o,i,a.wordWrap,s.cellOverflowLayout,L,P,f,x[0].textLength,T[0].lineHeight),k=!1,a.showEllipsis&&f&&!t.richText&&(k=!0),M=F.$_a(r,n,o,i,L,a.vAlign,P,f,d,x,T,S,k),I=x.length,E=[],k&&u&&(u.content&&1===u.content.length&&"text"===u.content[0].type||!u.content&&1===x.length&&x[0].text)&&this.oHb(e,s,x,T,a,i,n,P,M,E),1===I&&u&&!m)F.__a(e,s.sheet,l,u,M[0].x,M[0].y,o,i,L,a,A.width,A.height,P,f,x[0].textLength,s,S,_);else{for(R=F.Wfc(x),D=M[0].x,e.textAlign===pe?D-=R/2:e.textAlign===de&&(D-=R),F.Ufc(e,a,s,D,M[0].y,R,0,_),N=0;N<I;N++)F.a0a(e,s.sheet,M[N].x,M[N].y,T[N],L,x[N],E[N]);F.Ufc(e,a,s,D,M[0].x,R,0,_)}},x.prototype.Wfc=function(e){var t,r=e[0].textLength;for(t=0;t<e.length;t++)r=Re(r,e[t].textLength);return r},x.prototype.pHb=function(e,t){var r=0,n=e.font+t;return m[n]?r=m[n]:(r=fe(e,e.font,t),m[n]=r),r},x.prototype.rHb=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=t&&t.content,A=e.sheetArea;if(s=T?t.content[0].value:r,l=this.pHb(n,s),u=e.sheet,c=e.row,h=e.col,f=o,d=0,p=this.pHb(n,"0"),d=this.pHb(n,R),f-1-2-(1===i?0:a)<l){if(g="",2===i)for(m=s.length-1;0<=m;m--){if(f-1-2-a<d){b=g.length,g=R+g.substring(1,b);break}g=(y=s.charAt(m))+g,d+=this.pHb(n,y)}else if(1===i){for(C=E((f-d)/p),m=0;m<C/2;m++)g+=y=s.charAt(m);for(g+=R,m=Ae(s.length-C/2);m<s.length;m++)g+=y=s.charAt(m);for(w=this.pHb(n,g);f-1-2<w&&g!==R;)S=(v=g.split(R))[0],x=v[1],g=S.length>x.length?S.substring(0,S.length-1)+R+x:S+R+x.substring(1,x.length),w=this.pHb(n,g)}else for(m=0;m<s.length;m++){if(f-1-2-a<d){b=g.length,g=g.substring(0,b-1)+R;break}g+=y=s.charAt(m),d+=this.pHb(n,y)}T?t.content[0].value=g:t.content=[{value:g,type:"text"}],u._modelManager.qHb(c,h,s,A)}},x.prototype.N$a=function(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q=this,Z=0,Y=a.textIndent,K=a.wordWrap,X=a.hAlign,J=a.vAlign,Q=a.shrinkToFit,$=a.textDecoration,ee="left",te=2,re=2,ne=a.font,oe=0,ie=[],ae=0,se=s.sheet,le=new Ce.Rect(r,n,o,i);if(Se(s.fontInfo)&&(s.fontInfo=we.To.No(a.font,se.zoom())),f=parseInt(s.fontInfo.fontSize,10),Se(s.lineHeight)&&(s.lineHeight=ce(we.To.No(a.font,se.zoom()).font,!1,he(l))),d=s.lineHeight,p=a.foreColor,p=Ce.Im._ob(se,p),(g=u.conditionalForeColor)&&(p=g),c=Se(a.opacity)?c:a.opacity,Se(c)||((m=ve.ec(p)).a=c,p=ve.bc(m)),e.fillStyle!==p&&(e.fillStyle=p||"#000000"),0<Y&&(Z=8*Y),se.outlineColumn&&se.outlineColumn.XQa(s.col)&&(Z=0),3===X&&(X=xe(X,t,a.formatter)),Te(e,ne),y=b=0,h&&(b=q.Qfc(h.left),y=q.Qfc(h.right)),C=b+y,w={left:b,right:y},!K&&Q)for(S={value:!1},x=v=0;x<3&&!1===S.value&&(T=e.measureText(l).width,(v=Re(0,o-4-(1===X?0:Z)-C))<T);x++)ne=we.To.No(ne,v/T,S,!0).font,Te(e,ne);if(A=(A=se.parent&&se.parent.options.numbersFitMode===ue.NumbersFitMode.overflow||!1)||(u&&u.content?!(!u.content||1!==u.content.length||"text"!==u.content[0].type):"string"==typeof t&&t===l),!K&&!Q&&a.showEllipsis&&A&&this.rHb(s,u,l,e,o,X,Z),te+=Z+b,1===X?(te=(o+b-y)/2,ee=pe):2===X&&(te=o-y-1-2,te-=Z,ee=de),e.textAlign!==ee&&(e.textAlign=ee),k=0,K&&(k=o-C-3-Z,--k,1<(ae=(ie=Ce.Vn.Wn(l,k,ne,!1,e)).length)&&0!==J&&(oe=(ae-1)*d)),re+=d-(I=d/2-f/2+(M=8<f?Ae((f-8)/5+2):1)-1),1===J?re=(i-oe)/2+d/2-I:2===J&&(re=i-oe-2-I),e.textBaseline!==ge&&(e.textBaseline=ge),D={x:(R=(E=s.cellOverflowLayout)&&E.layout)?R.x:r+1,y:R?R.y:n+1,width:R?R.width:o-2,height:R?R.height:i-2},N=R&&R.width>o,F=D.x,_=D.y,P=D.width,L=D.height,K)if(e.rect(F,_,P,L),e.clip(),e.beginPath(),O=n+re,1<ae){for(B=r+te,e.textAlign===pe?B-=k/2:e.textAlign===de&&(B-=k),q.Ufc(e,a,s,B,O,k,d*ae,le),x=0;x<ae;x++)e.fillText(ie[x],r+te,O),$&&(T=e.measureText(ie[x]).width,q.ip(e,$,r+te,O,T,f,M)),O+=d;q.Ufc(e,a,s,B,O,k,d*ae,le)}else q.Oja(e,l,u,r+te,n+re,X,P,Z,$,M,f,s,a,w,le,N);else H=P-(r+1-F)<(j=fe(e,e.font,l))||L<d,G=De(a,0),U=De(a,1),W=De(a,2),V=De(a,3),H||(1===X?E&&((z=j/2)>E.backgroundLeftWidth||z>E.backgroundRightWidth)&&(H=!0):(P<j+Z+G+W||L<oe+V+U)&&(H=!0)),H&&(e.rect(F,_,P,L),e.clip(),e.beginPath()),q.Oja(e,l,u,r+te,n+re,X,P,Z,$,M,f,s,a,w,le,N)},x.prototype.nHb=function(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y=this,K=a.wordWrap,X=a.hAlign,J=a.vAlign,Q=a.shrinkToFit,$=a.textDecoration,ee=2,te=2,re=a.font,ne=[],oe=0,ie=parseInt(s.fontInfo.fontSize,10),ae=s.sheet,se=new Ce.Rect(r,n,o,i),le=s.cellOverflowLayout,ue=le&&le.layout,ce=a&&(a.borderLeft||a.borderTop||a.borderRight||a.borderBottom)&&!ae.getSpan(s.row,s.col),he=a.textOrientation,fe=he*Math.PI/180,de=Ee(fe),pe=Me(de),ge=ke(de),me=Ie(de),be=s.lineHeight,ye=90===he||-90===he;if(ce&&(-90<he&&he<0&&(p=!1),0<he&&he<90&&(p=!0)),m=(g={x:ue?ue.x:r+1,y:ue?ue.y:n+1,width:ue?ue.width:o-2,height:ue?ue.height:i-2}).x,b=g.y,y=g.width,C=g.height,w=be/2*ke(de),v=be/2*Me(de),x=be/2-ie/2+(S=8<ie?Ae((ie-8)/5+2):1)-1,u&&u.content&&0<u.content.length&&!Q&&(l=Y.sHb(e,u.content,i-4,re)),T=ae.dp(l,re),A=a.foreColor,A=Ce.Im._ob(ae,A),(k=u.conditionalForeColor)&&(A=k),c=Se(a.opacity)?c:a.opacity,Se(c)||((M=ve.ec(A)).a=c,A=ve.bc(M)),e.fillStyle!==A&&(e.fillStyle=A||"#000000"),3===X&&(X=xe(X,t,a.formatter,he)),Te(e,re),E=I=0,h&&(I=Y.Qfc(h.left),E=Y.Qfc(h.right)),!K&&Q)for(D={value:!1},N=R=0;N<3&&!1===D.value&&(R=Re(0,(i-4-2*v)/ge))<T;N++)re=we.To.No(re,R/T,D,!0).font,Te(e,re),ie=parseInt(s.fontInfo.fontSize,10),T=ae.dp(l,re),w=(be=Ce.Ul.fp(re))/2*ke(de),v=be/2*Me(de);if(_=F=0,K)for(_=(i-4-2*v)/ge,oe=(ne=Ce.Vn.Wn(l,_,re,!1,e)).length,T=ae.dp(ne[0],re),P=0;P<oe;P++)F<(L=ae.dp(ne[P],re))&&(F=L);switch(i<=(K?F:T)*ge+2*v&&(J=2),f=T/2*pe,d=(K?F:T)/2*ge,""+X+J){case"00":ee+=f+w+I,te+=d,ye||(te+=v),ce&&(ee=(i-te)/me*(p?1:-1)+(be/2+2)/ge);break;case"01":ee+=f+w+I,te=i/2,ce&&(ee=(i-te)/me*(p?1:-1)+(be/2+2)/ge);break;case"02":ee+=f+w+I,te+=d,ye||(te+=v),ce&&(ee=te/me*(p?1:-1)+(be/2+2)/ge),te=i-te;break;case"10":ee=(o+I-E)/2,te+=d,ye||(te+=v),ce&&(ee+=(p?1:-1)*(i-te)/me);break;case"11":ee=(o+I-E)/2,te=i/2,ce&&(ee+=(p?1:-1)*(i-te)/me);break;case"12":ee=(o+I-E)/2,te+=d,ye||(te+=v),ce&&(ee+=(p?1:-1)*te/me),te=i-te;break;case"20":ee=o-2-f-w-E,te+=d,ye||(te+=v),ce&&(ee=o+(i-te)/me*(p?1:-1)-(be/2+2)/ge);break;case"21":ee=o-2-f-w-E,te=i/2,ce&&(ee=o+(i-te)/me*(p?1:-1)-(be/2+2)/ge);break;case"22":ee=o-2-f-w-E,te+=d,ye||(te+=v),ce&&(ee=o+te/me*(p?1:-1)-(be/2+2)/ge),te=i-te}if(K)if(O=r+ee,B=be/ge,j=void 0,1<oe){for(1===X&&(O-=oe%2!=0?B*(oe-1)/2:oe/2*B-.5*B),G=(H=Ne(O,n+te,T,fe,be)).width+B*(oe-1),U=H.height,W=2===X?H.x-B*(oe-1):H.x+B*(oe-1),V=H.y,Y.Ufc(e,a,s,W,V,G,U,se),N=0;N<oe;N++)j=N,(0<a.textOrientation&&2===X||a.textOrientation<0&&(0===X||1===X))&&(j=oe-N-1),Y.tHb(e,fe,ne[j],O,n+te,$,ie,S,x),O=2===X?O-B:O+B;Y.Ufc(e,a,s,W,V,G,U,se)}else Y.Xfc(e,l,r,n,ee,te,s,a,T,fe,$,ie,S,be,x,se);else z=T*ge+ie*ge+2,q=De(a,0),Z=De(a,2),(C-(n+1-b)<z||C<be||C<z+q+Z)&&(e.rect(m,b,y,C),e.clip()),Y.Xfc(e,l,r,n,ee,te,s,a,T,fe,$,ie,S,be,x,se)},x.prototype.Xfc=function(e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g){var m=Ne(r,n,l,u,d),b=m.width,y=m.height,C=m.x,w=m.y;this.Ufc(e,s,a,C,w,b,y,g),this.tHb(e,u,t,r+o,n+i,c,h,f,p),this.Ufc(e,s,a,C,w,b,y,g)},x.prototype.V_a=function(e,t,r){X(e,t,r)},x.prototype.W_a=function(e,t,r,n,o,i,a){var s,l,u,c=0,h={value:!1};for(s=0;s<3&&!1===h.value&&(l=z(e,o,i,a),c=Re(0,(a?r:t)-4),(a?n.vAlign:1!==n.hAlign&&n.textIndent)&&(c=Re(0,c-8*n.textIndent)),c<l);s++)for(u=0;u<e.length;u++)e[u].style.font=we.To.No(e[u].style.font,c/l,h,!0).font},x.prototype.U_a=function(e,t,r,n,o){var i=e.richText;return!Se(i)&&r||(i=[{style:{font:n,foreColor:o},text:t}]),i},x.prototype.Z_a=function(e,t,r,n,o,i,a,s,l,u,c,h,f){var d=s&&s.layout,p={x:d?d.x:r+1,y:d?d.y:n+1,width:d?d.width:o-2,height:d?d.height:i-2},g=p.x,m=p.y,b=p.width,y=p.height;return(a||this.b0a(t,l,t.vAlign,r,n,y,b,g,m,h,f,u,c,s))&&(e.rect(g,m,b,y),e.clip(),e.beginPath()),p},x.prototype.b0a=function(e,t,r,n,o,i,a,s,l,u,c,h,f,d){var p,g,m=De(e,0),b=De(e,1),y=De(e,2),C=De(e,3);return f?(!(p=i-(o+1-l)<u||a<c)&&1!==r&&i<u+h+m+y||a<c+C+b)&&(p=!0):(p=a-(n+1-s)<u||i<c)||(1===t?d&&((g=u/2)>d.backgroundLeftWidth||g>d.backgroundRightWidth)&&(p=!0):(a<u+h+C+b||i<c+m+y)&&(p=!0)),p},x.prototype.X_a=function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d;if(1!==i?n=n-3-o:n-=3,a)return Ce.Vn.M_a(t,n,r,l,s,e);for(c=u=0;c<l.length;c++)h=l[c].text,s?u+=ce(l[c].style.font)*(h?h.length:0):(f=we.To.No(l[c].style.font,1),d=l[c].style.vertAlign?f.fontSize*g+"px "+f.fontFamily:l[c].style.font,u+=fe(e,d,h));return[{textLength:u,text:t,textInfos:l}]},x.prototype.__a=function(e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b){var y,C,w=u.font,v=we.To.No(w,1).fontSize,S=8<v?Ae((v-8)/5+2):1;this.L$a(e,t,u),(y=n.conditionalForeColor)&&e.fillStyle!==y&&(e.fillStyle=y),d?this.c0a(e,r,n,u,o,i,h,f,h,g,m,b):(C=a<c,this.Oja(e,r,n,o,i,l,c,f,u.textDecoration,S,v,g,u,m,b,C,p))},x.prototype.c0a=function(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g=r.content,m=i;if(this.Ufc(e,n,u,o,m,l,l*t.length,h),g&&0<g.length)for(d=0<(d=a-s-q(e,g,!0)-2)?d:0,f=0;f<g.length;f++)"fillingChar"===g[f].type?(p=Y(e,d,g[f].value,!0),this.vWa(e,p,o,i),i+=d):"placeholder"===g[f].type?i+=g[f].value?g[f].value.length*l:0:"numberPlaceholder"===g[f].type?i+=l:(this.vWa(e,g[f].value,o,i),i+=g[f].value?g[f].value.length*l:0);else if(t)for(f=0;f<t.length;f++)i=this.vWa(e,t[f],o,i,l).y;this.Vfc(e,n,u,o,m,l,i-m,h)},x.prototype.d0a=function(e){var t=w;return 1===e?t=pe:2===e&&(t=de),t},x.prototype.a0a=function(e,t,r,n,o,i,a,s){var l,u,c=[],h=a.textInfos;for(l=0;l<h.length;l++)c.push(U(!0,{},o,h[l].style));for(l=0;l<h.length;l++)r=(u=this.f0a(e,t,r,n,c[l],h[l].text,s)).x,n=u.y},x.prototype.Y_a=function(e,t,r,n){var o,i,a=[],s=e.length;for(o=0;o<s;o++)i=this.g0a(t,r,n,e[o].textInfos),a.push(i);return a},x.prototype.g0a=function(e,t,r,n){var o,i,a,s=0,l=0;for(o=0;o<n.length;o++)i=n[o].style&&n[o].style.font?n[o].style.font:e.font,s=Math.max(ce(i,I,he(n[o].text)),s),l=Math.max(we.To.No(i,1).fontSize,l),(n[o].style&&1===n[o].style.vertAlign||2===n[o].style.vertAlign)&&(s=Math.max(ce(i,I,he(n[o].text))+2*we.To.No(i,g).fontSize*.218,s));return{lineHeight:s,fontSize:l,baselineOffset:a=8<l?Ae((l-8)/5+2):1,lineOffset:s/2-l/2+a-1,font:e.font,foreColor:e.foreColor,textDecoration:e.textDecoration,isVerticalText:e.isVerticalText,textAlign:this.d0a(t),textBaseline:ge,opacity:r}},x.prototype.h0a=function(e,t,r){var n,o=0,i=0;for(n=0;n<e.length;n++)i+=t[n].lineHeight,o=Math.max(e[n].textLength,o);return{width:r?i:o,height:r?o:i}},x.prototype.$_a=function(e,t,r,n,o,i,a,s,l,u,c,h,f){var d,p=this.h0a(u,c,s),g=p.height,m=p.width,b=[];if(s)for(d=0;d<u.length;d++)b.push(this.i0a(e,t,r,n,o,i,a,m,u[d].textLength,c[d].lineHeight,c[d].lineOffset,l,h,u[d],f)),l?e-=c[d].lineHeight:e+=c[d].lineHeight;else for(d=0;d<u.length;d++)b.push(this.j0a(e,t,r,n,o,i,a,u[d].textLength,g,c[d].lineHeight,c[d].lineOffset,h)),t+=c[d].lineHeight;return b},x.prototype.j0a=function(e,t,r,n,o,i,a,s,l,u,c,h){var f=0,d=h.left,p=h.right;return 1===o?f=(r-s+d-p)/2:2===o?(f=r-1-2-s-p,f-=a):f=2+a+d,{x:e+f,y:t+(1===i?(n-l)/2+u-c:2===i?n-l-2+u-c:2+u-c)}},x.prototype.i0a=function(e,t,r,n,o,i,a,s,l,u,c,h,f,d,p){var g=0,m=f.left,b=f.right;return h?0===o?g=2+s+b-u/2:1===o?g=(r-m+b+s)/2-u/2:2===o&&(g=r-m-1-2-u/2):1===o?g=(r-s+m-b)/2+u/2:2===o?g=r-1-2-b-s+u/2:0===o&&(g=2+m+u/2),{x:e+g,y:t+(1===i?(n-l)/2:2===i?n-a-l-2:2+a)}},x.prototype.f0a=function(e,t,r,n,o,i,a){var s,l;return e.save(),this.L$a(e,t,o),s=o.vertAlign,l=o.isVerticalText?this.vWa(e,i,r,n,o.textDecoration,o.baselineOffset,a):this.k0a(e,r,n,o,i,s),e.restore(),l},x.prototype.L$a=function(e,t,r){var n,o,i=r.foreColor,a=r.opacity;i=Ce.Im._ob(t,i),Se(a)||((n=ve.ec(i)).a=a,i=ve.bc(n)),e.fillStyle!==i&&(e.fillStyle=i),o=r.vertAlign?this.l0a(r.font):r.font,Se(r.textBaseline)||e.textBaseline===r.textBaseline?Se(e.textBaseline)&&e.textBaseline!==ge&&(e.textBaseline=ge):e.textBaseline=r.textBaseline,r.isVerticalText?e.textAlign!==pe&&(e.textAlign=pe):e.textAlign!==w&&(e.textAlign=w),Te(e,o)},x.prototype.l0a=function(e){var t=we.To.Ko(e),r=parseFloat(t.fontSize)*g;return t.fontSize=r+"px",this.m0a(t)},x.prototype.m0a=function(e){var t="",r=e.fontStyle,n=e.fontSize,o=e.fontWeight,i=e.fontFamily;return t=void 0!==r?r:"normal",t+=void 0!==o?(t?" ":"")+o:(t?" ":"")+"normal",(t+=(t?" ":"")+n)+(void 0!==i?(t?" ":"")+i:(t?" ":"")+"Calibri")},x.prototype.vWa=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y;if(t&&0<t.length)for(s=e.font,l=ce(s,I,he(t)),y=we.To.No(s,1).fontSize,u=l/2-y/2+(8<y?Ae((y-8)/5+2):1)-1,h=(c=this.pHb(e,"0"))/2,f=0;f<t.length;f++)m=t[f],d=(b=C[m.charCodeAt(0)])?String.fromCharCode(b):m,n=n+((p=void 0!==a&&a<=f&&f<=a+2&&(a+3===t.length||0===a&&a+3<t.length||0!==a&&a+3<t.length))?c:l)-(g=p?h:u),e.fillText(d,r,n),this.Mxb(e,o,r,n,fe(e,e.font,d),we.To.No(e.font,1).fontSize,i),n+=g;return{x:r,y:n}},x.prototype.Mxb=function(e,t,r,n,o,i,a){var s,l,u,c;e.strokeStyle!==e.fillStyle&&(e.strokeStyle=e.fillStyle),s=0,u=.5,l=Ae(((i<=12?12:i)-12)/21+1),e.lineWidth!==l&&(e.lineWidth=l),0==(1&l)&&(u=0),(c=e.textAlign)===pe?r-=o/2:c===de&&(r-=o),e.beginPath(),2==(2&t)&&(s=E(n+a-i/2)-u,e.moveTo(r,s),e.lineTo(r+o,s)),e.stroke()},x.prototype.k0a=function(e,t,r,n,o,i){var a,s,l,u,c;return Se(o)?{x:t,y:r}:(s=8<(a=we.To.No(e.font,1).fontSize)?Ae((a-8)/5+2):1,l=0,i?(l=1===i?.74*a:.28*-a,e.fillText(o,t,r-l)):e.fillText(o,t,r),u=fe(e,e.font,o),c=n.textDecoration,this.ip(e,c,t,r,u,a,s-l),{x:t+u,y:r})},x.prototype.jp=function(e,t,r,n,o,i,a,s){var l={row:s.row,col:s.col,sheet:s.sheet,sheetArea:s.sheetArea,style:a,underline:a.textDecoration,foreColor:a.foreColor};x.ao(s.sheet,"applyHyperlinkStyle",l),this.paint(e,t,r,n,o,i,a,s)},x.prototype.paint=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_;e&&(l=a.backColor,s.parentBackColor!==l&&(h=e,f=r,d=n,p=o,g=i,m=s.imageLoader,y=t,C=s,x=(b=a).backColor,T=b.backgroundImage,A=b.textOrientation,k=b.isVerticalText,M=b.textIndent&&0!==b.textIndent,I=b.backgroundImageLayout,E=C.row,R=C.col,D=C.sheet&&C.sheet.getSpan(E,R),N=b&&(b.borderLeft||b.borderTop||b.borderRight||b.borderBottom),F=0,_=f,h.save(),S=A&&0!==A&&N&&y&&!D&&!k&&!M?(w=Ee(A*Math.PI/180),v=Ie(w),F=Ae(g/v),-90<A&&A<0&&(_=f-F),0<A&&A<90&&(_=f+F),function(){h.beginPath(),h.moveTo(_,d),h.lineTo(_+p,d),h.lineTo(f+p,d+g),h.lineTo(f,d+g),h.fill()}):function(){h.fillRect(f,d,p,g)},(x||T)&&(x&&we.To.setFillStyle(h,x,Math.min(_,f),d,p+F,g,S),O.ap(h,f,d,p,g,T,I,m)),h.restore()),u=this,c=new Ce.Rect(r,n,o,i),u.Sfc(e,s,c,t,a),u.i5&&(u.i5(e,c,a,s),c=u.f5(c,a)),s.cellOverflowLayout||u.uxb(e,c,s,P(t)),0<c.width&&0<c.height&&(a&&a.showEllipsis&&s.sheet._modelManager.qHb(s.row,s.col,null,s.sheetArea),u.paintContent(e,t,c.x,c.y,c.width,c.height,a,s)))},x.prototype.paintContent=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m=s.sheetArea;2!==m&&1!==m||(l=s.visualState||0,u="columnHeader",2===m&&(u="rowHeader"),c=this.getThemeStyle(s.visualState,"gc-"+u+"-"+Ce.Im.Jm(l)),O.gp(e,r,n,o,i,a,u,c,m)),(f=s.conditionalFormats)&&(h=f.jp(e,P(t),r,n,o,i,a,s)),s.showBarIconOnly=h,(d=s.sparkline)&&d.paintSparkline(e,r,n,o,i),p=O.bDc(e,P(t),r,n,o,i,s.sheet),s.cellOverflowLayout||h||p||(g=new Ce.Rect(r,n,o,i),function(e,t,r,n,o,i){if(0===e&&B(t,r,n,o)){var a=j(t);i.x+=a,i.width-=a}}(a.hAlign,s.sheet,s.row,s.col,s.sheetArea,g),this.paintValue(e,t,g.x,g.y,g.width,g.height,a,s))},x.prototype.createEditorElement=function(e,t){return p},x.prototype.getEditorValue=function(e,t){return p},x.prototype.kp=function(e,t,r,n){return r},x.prototype.setEditorValue=function(e,t,r){},x.prototype.getEditingElement=function(){return p},x.prototype.parse=function(e,t,r){var n,o=Se(t),i=Se(e);try{if(n=l.Formatter&&l.Formatter.GeneralFormatter,!o&&!i&&n)return(typeof t===W?new n(t):t).parse(e)}catch(e){}return i?"":""+e},x.prototype.format=function(e,t,r,n){var o,i,a,s=d(t);if(n&&s&&(o=n.sheet.aHb(n.row,n.col,t),Se(o)||(e=o)),Se(e)||""===e)return"";if(n&&n.quotePrefix)return""+e;if(!s&&typeof t===W&&"object"!=typeof e)return Ce.mn.un(e,t,r);if(!t||"General"===t||s)return"boolean"==typeof e||e instanceof Boolean?(u&&(e=e?u.getBoolean().boolean_true:u.getBoolean().boolean_false),(""+e).toUpperCase()):e instanceof Date?(a=(i=c.q4(c.culture()).DateTimeFormat).shortDatePattern,0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()||(a=i.defaultDatePattern),f.Vb(e,a)):(typeof e===T&&(e=h.nb(""+e)),""+e);try{return l.Formatter&&l.Formatter.GeneralFormatter?(typeof t===W?Ce.mn.tn(t):t).format(e,r):""+e}catch(t){return""+e}},x.prototype.focus=function(e,t){e&&e.focus&&e.focus()},x.prototype.getThemeStyle=function(e,t){return Ce.Im.Km(e,t)},x.prototype.activateEditor=function(e,t,r,n,o,i,a){},x.prototype.deactivateEditor=function(e,t){},x.prototype.selectAll=function(e,t){e&&e.select&&e.select()},x.prototype.updateEditor=function(e,t,r,n,o,i,a){},x.prototype.setImeMode=function(e,t,r){this.isImeAware(r)?this.updateImeMode(e,t,r):e&&O.hp(e,0)},x.prototype.updateImeMode=function(e,t,r){e&&O.hp(e,t)},x.prototype.getHitInfo=function(e,t,r,n,o){return p},x.prototype.getCellAndPaddingHitInfo=function(e,t,r,n,o){var i,a;if(o){if(i={x:e,y:t,context:o,cellStyle:r,cellRect:n,paddingHitInfo:null},x.ao(o.sheet,"getCellButtonHitInfo",i,function(){return null!==i.paddingHitInfo&&void 0!==i.paddingHitInfo}),a=i.paddingHitInfo,i.paddingHitInfo&&!Se(i.paddingHitInfo.cellButtonHitInfo)&&!Se(i.paddingHitInfo.cellButtonHitInfo.buttonConfig))return i.paddingHitInfo;if(i.cellRect=this.f5?this.f5(i.cellRect,r):i.cellRect,x.ao(o.sheet,"getCellTextHitInfo",i,function(){return!Se(i.paddingHitInfo)&&i.paddingHitInfo.isReservedLocation}),i.paddingHitInfo&&i.paddingHitInfo.isReservedLocation)return i.paddingHitInfo;if(3===o.sheetArea)return x.ao(o.sheet,"getCellPaddingHitInfo",i,function(){return!Se(i.paddingHitInfo)&&i.paddingHitInfo.isReservedLocation}),i.paddingHitInfo?i.paddingHitInfo:a||this.getHitInfo(e,t,r,n,o)}return this.getHitInfo(e,t,r,n,o)},x.prototype.processCellAndPaddingMouseDown=function(e){return x.ao(e.sheet,"processMouseDownOnCellPadding",e),this.processMouseDown(e)},x.prototype.processMouseDown=function(e){return!1},x.prototype.YBb=function(e){return x.ao(e.sheet,"processMouseMoveOnCellPadding",e),this.processMouseMove(e)},x.prototype.processMouseMove=function(e){return!1},x.prototype.XGb=function(e){return x.ao(e.sheet,"processMouseUpOnCellPadding",e),this.processMouseUp(e)},x.prototype.processMouseUp=function(e){return!1},x.prototype.processMouseEnter=function(e){return!1},x.prototype.ZBb=function(e){return x.ao(e.sheet,"processMouseLeaveOnCellPadding",e),this.processMouseLeave(e)},x.prototype.processMouseLeave=function(e){return!1},x.prototype.isReservedKey=function(e,t){return!1},x.prototype.isEditingValueChanged=function(e,t,r){return r.klb&&(e=e.replace(/\r\n?/g,"\n")),e!==t},x.prototype.processKeyDown=function(e,t){return!1},x.prototype.processKeyUp=function(e,t){return!1},x.prototype.getAutoFitWidth=function(e,t,r,n,o){return O.cp(e,t,r,n,o)},x.prototype.getAutoFitHeight=function(e,t,r,n,o){return O.ep(e,t,r,n,o)},x.prototype.Oja=function(e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b){var y;r&&r.content&&0<r.content.length&&(b||!g)?this.Pja(e,r.content,n,o,i,a,s,l,u,c,h,f,d,p,m):(m=m||fe(e,e.font,t),y=n,e.textAlign===pe?y-=m/2:e.textAlign===de&&(y-=m),this.Ufc(e,f,h,y,o,m,h.lineHeight,p),e.fillText(t,n,o),l&&this.ip(e,l,n,o,m,c,u),this.Vfc(e,f,h,y,o,m,h.lineHeight,p))},x.prototype.tHb=function(e,t,r,n,o,i,a,s,l){if(e.save(),e.textAlign="center",e.textBaseline="middle",e.translate(n,o),e.rotate(-t),e.fillText(r,0,0),i){var u=e.measureText(r).width;this.ip(e,i,0,l,u,a,s)}e.restore()},x.prototype.sHb=function(e,t,r,n){var o,i,a;for(e.font||Te(e,n),o=0<(o=r-q(e,t))?o:0,i=[],a=0;a<t.length;a++)if("fillingChar"===t[a].type)i.push(Y(e,o,t[a].value));else{if("placeholder"===t[a].type||"numberPlaceholder"===t[a].type)continue;i.push(t[a].value)}return i.join("")},x.prototype.Pja=function(e,t,r,n,o,i,a,s,l,u,c,h,f,d,p){var g,m,b,y,C;e.save(),e.textAlign!==w&&(e.textAlign=w),y=0<(y=i-a-(g=q(e,t))-((m=f?f.left:0)+(b=f?f.right:0))-2)?y:0,Se(p)?Z(t)?1===o?(r-=(i+m-b)/2,r+=a+m):2===o&&(r=r-i+b+2,r+=a+m):Se(g)||(1===o?r-=g/2:2===o&&(r-=g)):Z(t)?1===o?(r=r+(p||g)/2-(i+m-b)/2,r+=a+m):2===o&&(r=r+(p||g)-i+b+2,r+=a+m):Se(g)||(1===o?r=r+p/2-g/2:2===o&&(r=r+p-g)),this.Ufc(e,h,c,r,n,g,c.lineHeight,d),C=this.Qja(e,t,r,n,y,s,l,u),this.Vfc(e,h,c,r,n,C-r,c.lineHeight,d),e.restore()},x.prototype.Qja=function(e,t,r,n,o,i,a,s,l){var u,c,h,f=0;for(m[e.font+"0"]?f=m[e.font+"0"]:(f=fe(e,e.font,"0"),m[e.font+"0"]=f),u=0;u<t.length;u++)"fillingChar"===t[u].type?(e.fillText(Y(e,o,t[u].value),r,n),i&&this.ip(e,i,r,n,o,s,a),r+=o):"placeholder"===t[u].type?r+=fe(e,e.font,t[u].value):"numberPlaceholder"===t[u].type?r+=f:((c=t[u].value)!==p&&e.fillText(c,r,n),h=fe(e,e.font,c),i&&this.ip(e,i,r,n,h,s,a),r+=h);return r},x.prototype.ip=function(e,t,r,n,o,i,a){var s,l,u,c;e.strokeStyle!==e.fillStyle&&(e.strokeStyle=e.fillStyle),s=e.textAlign,l=0,c=.5,u=Ae(((i<=12?12:i)-12)/21+1),e.lineWidth!==u&&(e.lineWidth=u),0==(1&u)&&(c=0),s===pe?r-=o/2:s===de&&(r-=o),e.beginPath(),4==(4&t)&&(l=E(n+a-i-1)-c,e.moveTo(r,l),e.lineTo(r+o,l)),2==(2&t)&&(l=E(n+a-i/2)-c,e.moveTo(r,l),e.lineTo(r+o,l)),1==(1&t)&&(l=E(n+a-1)-c,e.moveTo(r,l),e.lineTo(r+o,l)),8==(8&t)&&(l=E(n+a-1)-c,e.moveTo(r,l-u),e.lineTo(r+o,l-u),e.moveTo(r,l+u),e.lineTo(r+o,l+u)),e.stroke()},x.prototype.lp=function(e,t){var r="";4==(4&t)&&(r="overline"),2==(2&t)&&(r+=" line-through"),1==(1&t)&&(r+=" underline"),e.css("text-decoration",r)},x.prototype.gQa=function(){return p},x.prototype.isImeAware=function(e){return!1},x.prototype.isEditting=function(){return!1},x.prototype.toJSON=function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},x.prototype.fromJSON=function(e){if(e)for(var t in e)Se(e[t])||(this[t]=e[t])},b=x,t.Base=b,Ce.Zn(b),n._o[0]=b},"./dist/core/celltype/cellType.entry.js":function(e,r,t){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),n(t("./dist/core/celltype/celltype.ns.js")),n(t("./dist/core/celltype/basecelltype.js")),n(t("./dist/core/celltype/textcelltype.js")),n(t("./dist/core/celltype/headercelltype.js"))},"./dist/core/celltype/celltype.ns.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._o={}},"./dist/core/celltype/headercelltype.js":function(e,t,r){"use strict";var n,o,b,Y,i,x,T,A,K,k,O,X,M,B,j,I,H,J,Q,a,s,l,u,c,h,f,d=this&&this.__extends||(u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function g(e,t){return e=e||0,A.Km(e,"gc-"+t+"-"+A.Jm(e))}function E(e,t,r,n,o,i){var a=new Image,s=i;s=(s=s.replace('url("',"")).replace('")',""),a.src=s,e.drawImage(a,t,r,n,o)}function p(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p;t&&(function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b,y,C,w,v;function S(){e.fillRect(t+1,r+1,n-1,o-1)}if(!M(s)){if(e.save(),e.beginPath(),u=i.backColor,0===s&&u)Y.To.setFillStyle(e,u,t,r,n,o,S);else try{if(u=l&&l.backgroundColor,c=l&&l.backgroundImage,h=a.sheet,f=a.row,d=a.col,p=a.sheetArea,g=void 0,m=!1,h.cellStates&&s===T.VisualState.hover&&((g=h.cellStates.getStyle(f,d,p))&&g.backColor&&(u=g.backColor,m=!0)),!m&&c&&-1!==c.indexOf("linear-gradient")){for(b=k(c),y={degree:90,stops:[]},C=0,w=b.length;C<w;C++)v=b[C],y.stops.push({position:v.point,color:v.color});Y.To.setFillStyle_Gradient(e,y,t,r,n,o,S)}else u?(e.fillStyle=u,S()):c&&c!==I&&E(e,t+1,r+1,n-1,o-1,c)}catch(e){}x.Context.ap(e,t,r,n,o,i.backgroundImage,i.backgroundImageLayout,a.imageLoader),e.restore()}}(t,n,o,i,a,s,l,f=l.visualState||0,d=g(f,u)),x.Context.gp(t,n,o,i,a,s,u,d,c,l.needTopGridline,l.needLeftGridline),p=new b.Rect(n,o,i,a),e.Sfc(t,l,p,r,s),e.i5&&(e.i5(t,p,s,l),p=e.f5(p,s)),0<p.width&&0<p.height&&e.paintContent(t,r,p.x,p.y,p.width,p.height,s,l,h))}function $(e,t,r,n,o,i){var a,s={font:t,fillStyle:r},l=n.sheet;return 0!==n.visualState&&2007<parseInt(i.zIndex,10)&&l.vp(n.row,n.col,o)&&(a=l.wp(n.row,n.col,o)?e(n.visualState,"gc-columnHeader-selected"):e(n.visualState,"gc-columnHeader-highlight"),s.fillStyle=a.color,s.font=Y.To.Ro(s.font,"bold")),s}function m(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p={},g=e.format(B(r),s.formatter,p),m=l.sheet;g&&(t.save(),t.beginPath(),((f=m.rowFilter&&m.rowFilter())&&f.Dl(l.row,l.col,u)&&f.filterButtonVisible(l.col)||h)&&(i-=m.oK(new b.Rect(n,o,i,a),u).width),(d=(d=s.foreColor)||c.color)&&t.fillStyle!==d&&(t.fillStyle=d),r&&r.richText&&0<r.richText.length||s.isVerticalText?function(e,t,r,n,o,i,a,s,l,u,c,h,f,d){var p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R=new Q(o,i,a,s),D=$(e.getThemeStyle,l.font||r.font,r.fillStyle,h,f,d),N=l.isVerticalText,F=l.hAlign,_=function(e){var t=0,r=e.textIndent;return 0<r&&(t=8*r),t}(l),P=e.T_a(l.formatter||l._autoFormatter,n.text),L=j(!0,[],e.U_a(n,u,P,D.font,D.fillStyle));if(n&&n.richText&&0<n.richText.length&&(p=h.sheet?h.sheet.zoom():1,e.V_a(L,D,p)),g=e.Pfc(r,B(n),l,h,o,i,a,s),m=e.Qfc(g.externals.left),b=e.Qfc(g.externals.right),y=m+b,C={left:m,right:b},!l.wordWrap&&l.shrinkToFit&&e.W_a(L,a-y,s,l,D,1,N),w=e.X_a(r,u,l.font,N?s:a-y,_,N?l.vAlign:l.hAlign,l.wordWrap,N,L),v=e.Y_a(w,l,F),function(e,t,r,n,o,i,a,s,l){(!!t.wordWrap||(t.isVerticalText?i<s+a||o<l:o<s+a||i<l))&&(e.rect(r,n,o,i),e.clip(),e.beginPath())}(r,l,o,i,a,s,_,w[0].textLength,v[0].lineHeight),S=N?O(u):H,x=!1,l.wordWrap||l.shrinkToFit||!l.showEllipsis||!N||n.richText||(x=!0),T=e.$_a(R.x,R.y,R.width,R.height,F,l.vAlign,_,N,S,w,v,C,x),A=[],x&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===w.length&&w[0].text)&&e.oHb(r,h,w,v,l,s,i,_,T,A),1===(k=w.length)&&c.content&&!P)e.__a(r,t,u,c,T[0].x,T[0].y,a,s,F,l,R.width,R.height,_,N,w[0].textLength,h,C,R);else for(M=0;M<k;M++)I=e.Wfc(w),E=T[0].x,"center"===r.textAlign?E-=I/2:"right"===r.textAlign&&(E-=I),e.Ufc(r,l,h,E,T[0].y,I,0,R),e.a0a(r,t,T[M].x,T[M].y,v[M],F,w[M],A[M]),e.Ufc(r,l,h,E,T[0].x,I,0,R)}(e,m,t,r,n,o,i,a,s,g,p,l,u,c):function(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q=new Q(r,n,o,i),Z=$(e.getThemeStyle,a.font||t.font,t.fillStyle,u,c,h);if(X(t,Z.font),t.fillStyle=Z.fillStyle,f=0,0<(d=a.textIndent)&&(f=8*d),p=parseInt(u.fontInfo.fontSize,10),g=a.hAlign,m=a.vAlign,b="left",y=2,C=e.Pfc(t,s,a,u,r,n,o,i),w=e.Qfc(C.externals.left),v=e.Qfc(C.externals.right),S=w+v,x={left:w,right:v},y+=f+w,1===g?(y=(o+w-v)/2,b="center"):2===g&&(y=o-v-1,y-=f,b="right"),t.textAlign!==b&&(t.textAlign=b),T=0,A="alphabetic",k=2,M=a.wordWrap,I=a.shrinkToFit,E=a.font,R=u.lineHeight,D=[],N=0,!M&&I)for(_={value:!1},P=F=0;P<3&&!1===_.value&&(L=t.measureText(s).width,(F=Math.max(0,o-4-(1===g?0:f)))<L);P++)E=Y.To.No(E,F/L,_,!0).font,X(t,E);if(O=0,M&&(O=o-S-3-f,--O,D=K.Wn(s,O,Z.font),1<(N=D.length)&&0!==m&&(T=(N-1)*R)),B=8<p?J((p-8)/5+2):1,j=R/2-p/2+B-1,!M&&a.showEllipsis&&e.rHb(u,l,s,t,o,g,f),k+=R-j,1===m?k=(i-T)/2+R/2-j:2===m&&(k=i-T-2-j),t.textBaseline!==A&&(t.textBaseline=A),H=a.textDecoration,G=q.x,U=q.y,W=q.width,V=q.height,a.wordWrap)if(t.rect(G,U,W,V),t.clip(),t.beginPath(),z=n+k,1<N){for(e.Ufc(t,a,u,r+y,z,O,R*N,q),P=0;P<N;P++)t.fillText(D[P],r+y,z),H&&(L=t.measureText(D[P]).width,e.ip(t,H,r+y,z,L,p,B)),z+=R;e.Ufc(t,a,u,r+y,z,O,R*N,q)}else e.Oja(t,s,l,r+y,n+k,g,W,f,H,B,p,u,a,x,q);else(t.measureText(s).width>W||V<R)&&(t.rect(G,U,W,V),t.clip(),t.beginPath()),e.Oja(t,s,l,r+y,n+k,g,W,f,H,B,p,u,a,x,q,void 0,void 0,a.showEllipsis)}(e,t,n,o,i,a,s,g,p,l,u,c),t.restore())}function y(){var e=c.call(this)||this;return e.typeName="4",e}function C(){var e=h.call(this)||this;return e.typeName="3",e}function w(){var e=f.call(this)||this;return e.typeName="2",e}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),o=r("./dist/core/util/domUtil.js"),b=r("./dist/core/util/common.js"),Y=r("./dist/core/worksheet/stylehelper.js"),i=r("./dist/core/celltype/celltype.ns.js"),x=r("./dist/core/celltype/basecelltype.js"),T=r("./dist/core/core.enum.js"),A=b.Im,K=b.Vn,k=b.Ul.wl,O=b.Ul.uWa,X=b.Ul.lZa,M=n.Common.j.Fa,B=b.Ul.K_a,j=o.GC$.extend,I="none",H=void 0,J=Math.floor,Q=b.Rect,f=x.Base,d(w,f),w.prototype.paint=function(e,t,r,n,o,i,a,s,l){p(this,e,t,r,n,o,i,a,s,"columnHeader",1,l)},w.prototype.paintContent=function(e,t,r,n,o,i,a,s,l){x.Context.bDc(e,B(t),r,n,o,i,s.sheet)||m(this,e,t,r,n,o,i,a,s,1,g(s.visualState,"columnHeader"),l)},a=w,t.ColumnHeader=a,i._o[2]=a,h=x.Base,d(C,h),C.prototype.paint=function(e,t,r,n,o,i,a,s){p(this,e,t,r,n,o,i,a,s,"rowHeader",2)},C.prototype.paintContent=function(e,t,r,n,o,i,a,s){x.Context.bDc(e,B(t),r,n,o,i,s.sheet)||m(this,e,t,r,n,o,i,a,s,2,g(s.visualState,"rowHeader"))},s=C,t.RowHeader=s,i._o[3]=s,c=x.Base,d(y,c),y.prototype.paint=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S;if(e){e.save(),e.rect(r,n,o,i),e.clip(),e.beginPath(),l=s.visualState||0;try{c=(u=this.getThemeStyle(s.visualState,"gc-corner-"+A.Jm(l)))&&u.backgroundColor,h=u&&u.backgroundImage,c?(e.fillStyle=c,e.fillRect(r,n,o,i)):h&&h!==I&&E(e,r,n,o,i,h)}catch(e){}if(d=(f=this.getThemeStyle(4,"gc-corner-triangle-"+A.Jm(l)))&&f.backgroundImage,p=f&&f.backgroundColor,g=e.createLinearGradient(r+o/2,n,r+o/2,n+i),d&&-1!==d.indexOf("linear-gradient")){for(b=0,y=(m=k(d)).length;b<y;b++)C=m[b],g.addColorStop(C.point,C.color);e.fillStyle=g}else p&&(g.addColorStop(.125,"#f6fafb"),g.addColorStop(1,p),e.fillStyle=g);(w=e.createLinearGradient(r+o,n+1,r+o,n+i-2)).addColorStop(0,f.borderLeftColor),w.addColorStop(1,f.borderRightColor),e.beginPath(),e.strokeStyle=w,e.moveTo(r+o-.5,n),e.lineTo(r+o-.5,n+i),e.stroke(),s.needLeftGridline&&(e.beginPath(),e.strokeStyle=f.borderLeftColor,e.moveTo(r+.5,n),e.lineTo(r+.5,n+i),e.stroke()),(v=e.createLinearGradient(r,n,r+o-2,n)).addColorStop(0,f.borderTopColor),v.addColorStop(1,f.borderBottomColor),e.beginPath(),e.strokeStyle=v,e.moveTo(r,n+i-.5),e.lineTo(r+o,n+i-.5),e.stroke(),s.needTopGridline&&(e.beginPath(),e.strokeStyle=f.borderTopColor,e.moveTo(r,n+.5),e.lineTo(r+o,n+.5),e.stroke()),e.beginPath(),o<(S=i)&&(S=o),e.moveTo(r+o-S+3,n+i-3),e.lineTo(r+o-3,n+i-3),e.lineTo(r+o-3,n+i-S+3),e.fill(),e.restore()}},l=y,t.Corner=l,i._o[4]=l},"./dist/core/celltype/textcelltype.js":function(e,t,r){"use strict";var n,A,J,o,i,Q,D,c,$,ee,a,k,s,M,N,l,u,te,f,re,I,ne,h,d,p,oe,ie,g,m,ae,F,_,se,E,le,R,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,P,L,b,y,O,B,ve,Se,j,H,G,xe,Te,C,U,w,v,S,x,T,W=this&&this.__extends||(S=function(e,t){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}S(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function V(e){return y||0===e?J.GC$(l("textarea")):J.GC$(l("div"))}function Ae(e){return e&&"DIV"===e.tagName&&"true"===e.contentEditable}function ke(e){return Ae(e)?te&&parseFloat(u.version)<10?s.Woa(e):e.innerText:e.value}function z(e,t){Ae(e)?e.innerText=t:e.value=t}function Me(e){var t;return Ae(e)?0<(t=P.getSelection()).rangeCount?t.getRangeAt(0).startOffset:0:e.selectionStart}function Ie(e){var t;return Ae(e)?0<(t=P.getSelection()).rangeCount?t.getRangeAt(0).endOffset:0:e.selectionEnd}function q(e){return e&&"BR"===e.tagName}function Z(e){return e&&"SPAN"===e.tagName}function Y(e){return e&&"DIV"===e.tagName}function K(e){return e instanceof Text}function X(e,t,r,n){return e.substr(0,t)+n+e.substr(r,e.length-r)}function Ee(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p=String.fromCharCode((l=(s=o).keyCode,u=s.shiftKey,c={106:42,107:43,109:45,110:46,111:47,173:45},h={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},f={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},96<=(d=l)&&l<=105?d=l-48:c[l]?d=c[l]:u&&f[l]?d=f[l]:!u&&h[l]?d=h[l]:!u&&65<=l&&l<=90&&(d=l+32),d));return Ae(e)?0<(i=P.getSelection()).rangeCount&&K((a=i.getRangeAt(0)).startContainer)?function e(t,r,n,o,i,a){var s,l,u,c,h,f="",d=t.childNodes,p=d.length;for(s=0;s<p;s++)Z(l=d[s])?f+=e(l,r,n,o,i,a):K(l)?(u=r&&r.startContainer,c=r&&r.endContainer,h=l.textContent,l===u||l===c?u!==c?a=l===u?(f+=X(h,n,h.length,i),!0):(f+=X(h,0,o,""),!1):f+=X(h,n,o,i):a||(f+=h)):q(l)&&!a&&(f+="\n");return f}(e,a,r,n,p):a&&a.startOffset===a.endOffset?t+p:p:X(t,r,n,p)}function Re(e){var t,r,n=((r=e)&&0<(t=r.length)&&"\n"===r[t-1]&&(r+=U),r);return n&&0<=n.indexOf(" ")&&(n=m(n," ",C)),n}function De(e){var t,r=e;return!r||r.indexOf(U)<0&&r.indexOf("\n")<0?r:((t=e.split("\n")).forEach(function(e,t,r){e[0]===U&&(r[t]=e.substr(1))}),t.join("\n"))}function Ne(e){var t,r,n,o,i,a=P.getSelection(),s=!1,l=0,u=0;if(0<a.rangeCount)return t=a.getRangeAt(0),r=Me(e),n=Ie(e),o=t.startContainer,i=t.endContainer,Y(o)&&(s=!0,l=r),Y(i)&&(u=n),function e(t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g;if(o===i&&!a)return{content:De(o.textContent.slice(r,n))};for(u="",c=s,d=t.childNodes,p=l||d.length;c<p;c++)if(g=d[c],Z(g)){if(h=e(g,r,n,o,i,a,0,0),u+=h.content,h.startFlag&&(a=!0),h.endFlag){f=!0;break}}else if(K(g)&&g===o)u+=g.textContent.slice(r,g.textContent.length),a=!0;else{if(K(g)&&g===i){u+=g.textContent.slice(0,n),f=!0;break}a&&(u+=q(g)?"\n":g.innerText||g.textContent)}return{content:De(u),startFlag:a,endFlag:f}}(e,r,n,o,i,s,l,u).content}function Fe(e,t,r,n){var o,i=0,a=r;for(o=0;o<e.length;o++)re&&(a=n[o]),e[o]>t?i+=a*ve(e[o]/t):i+=a;return i}function _e(e){var t=x.call(this)||this;return t.allowOverflow=!0,t.typeName="1",t.editorType=$(e)?1:e,t}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),A=r("./dist/core/worksheet/worksheet.js"),J=r("./dist/core/util/domUtil.js"),o=r("./dist/core/util/common.js"),i=r("./dist/core/celltype/celltype.ns.js"),Q=r("./dist/core/celltype/basecelltype.js"),D=r("./dist/core/core.enum.js"),c=r("./dist/core/util/common.js"),$=n.Common.j.Fa,ee=o.Vn,a=o.Events.EditChange,k=o.Vl,s=o.Ul,M=o.uHb,N=s.lHb,l=s.Nl,u=s.Ml,te=u.msie,f=u.edge,re=u.chrome,I=s.nl,ne=s.ol,h=s.Il,d=s.vl,p=s.rl(),oe=s.fp,ie=s.Voa,g=s.pL,m=s.Ika,ae=s.hZa,F=s.K_a,_=s.Fxb,se="left",E="gcUIElement",le="none",R=".gcEditingInput",ue="width",ce="height",he="text-align",fe="hidden",de="word-wrap",pe="overflow",ge="vertical-align",me="normal",be="break-word",ye="overflow-y",Ce="word-break",we="float",P=window,L=document,b=p.ipad,y=p.iphone||b||p.android,O=null,B=void 0,ve=Math.ceil,Se=Math.min,j=Math.sin,H=Math.cos,G=Math.abs,xe=Math.max,Te=parseInt,C="",U="",w="string",(T=t.EditorType||(t.EditorType={}))[T.textarea=0]="textarea",T[T.editableDiv=1]="editableDiv",x=Q.Base,W(_e,x),_e.prototype.getText=function(e,t){return e},_e.prototype.paintValue=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I=this,E=s.sheet,R=E.zoom?E.zoom():1;if(t=I.getText(t,s),l={},s.quotePrefix=a.quotePrefix,h=(c=a.formatter)&&"General"!==c,f=N(c),"string"==typeof c&&(h=h&&!f),d=a.textOrientation,p=a.textIndent&&0!==a.textIndent,g=a.isVerticalText,m=o,d&&-90<=d&&d<=90&&!p&&!g&&(b=G(d*Math.PI/180),m=(i-s.lineHeight*H(b))/j(b)),y=I.Pfc(e,u,a,s,r,n,o,i).externals,C=I.Qfc(y.left),w=I.Qfc(y.right),3===(v=a.hAlign)&&(v=ne(v,t,a.formatter)),2===v?m-=w:0===v&&(m-=C),S=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,h?x=a.formatter:S?x=a._autoFormatter:E.parent&&E.parent.options.numbersFitMode===D.NumbersFitMode.mask?x=Q.Context.Ixb(e,t,m,a,R):E.parent&&E.parent.options.numbersFitMode===D.NumbersFitMode.overflow&&(x=a._autoFormatter),u=f&&(t instanceof Date||"boolean"==typeof t||t instanceof Boolean||"number"==typeof t)?I.format(t,c,{}):I.format(F(t),x,l,s),!0!==a.shrinkToFit&&!g)if(_(t)){if(E.parent){switch(T=u,E.parent.options.numbersFitMode){case D.NumbersFitMode.mask:T=this.Yfc(e,u,m,a,R,s,l,E);break;case D.NumbersFitMode.overflow:T=this.Klb(e,s,t,a,E,u,l)}u=T}}else void 0===E._modelManager.uIb(s.row,s.col,s.sheetArea)||a.showEllipsis||E._modelManager.qHb(s.row,s.col,void 0,s.sheetArea);return A=a.labelOptions,k=a.watermark,M=!A||0!==A.visibility,k&&!u&&M?void I.paintText(e,k,r,n,o,i,a,s,k,l,.337):void((u||l.content&&l.content.length)&&(1===a.vAlign&&re&&n--,I.paintText(e,t,r,n,o,i,a,s,u,l,B,y)))},_e.prototype.Yfc=function(e,t,r,n,o,i,a,s){var l=Q.Context.Lxb(e,t,r,n,o),u=i.row,c=i.col;return t!==l?(delete a.content,n.textIndent=0,s._modelManager.qHb(u,c,s.getText(u,c,i.sheetArea),i.sheetArea)):s._modelManager.qHb(u,c,void 0,i.sheetArea),l},_e.prototype.Klb=function(e,t,r,n,o,i,a){var s,l,u,c,h=t.row,f=t.col;if("number"==typeof r&&delete a.content,n.wordWrap&&(n.wordWrap=!1),s=g(e,n.font,i),l=o.ss._m(f),c=void 0,!(u=t.cellOverflowLayout)&&l<s)c=o.getText(h,f,t.sheetArea);else if(u&&l<s&&this.lDc(u.backgroundWidth)&&this.lDc(u.valueWidth)){if(!this.lDc(n.hAlign))return;c=(1!==n.hAlign?u.valueWidth>u.backgroundWidth:u.valueWidth/2>u.backgroundLeftWidth||u.valueWidth/2>u.backgroundRightWidth)?o.getText(h,f,t.sheetArea):void 0}return o._modelManager.qHb(h,f,c,t.sheetArea),i},_e.prototype.lDc=function(e){return null!=e},_e.prototype.createEditorElement=function(e,t){var r,n=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,o=d(n)+1e3;return J.GC$(t).css("z-index",o),r=V(this.editorType),J.GC$(r).css({font:"normal 11pt calibri",outline:le,resize:le,border:le,padding:"1px","vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(de,me).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(pe,fe).attr(E,"gcEditingInput"),u.safari&&J.GC$(r).css("-webkit-user-select","auto"),Ae(J.GC$(r)[0])&&(J.GC$(r).css("display","table-cell"),J.GC$(r).css(Ce,me)),J.GC$(r)[0]},_e.prototype.getEditorValue=function(e,t){var r,n;return e&&(r=ke(e),!$(r)&&0<r.length)?(n=(n=De(r)).replace(/\r\n?/g,"\n")).indexOf(C)<0?n:m(n,C," "):O},_e.prototype.setEditorValue=function(e,t,r,n){var o,i;e&&(o=r&&r.sheet&&r.sheet.HF,i=Re(t),te?o&&r.isImeInput||z(e,$(i)?n?"%":"":i):z(e,o?n?"%":"":i))},_e.prototype.selectAll=function(e,t){e&&e.select?e.select():P.getSelection().selectAllChildren(e)},_e.prototype.focus=function(e,t){this.isImeAware()&&e?(e.focus(),function(e){if(Ae(e)){var t=P.getSelection();t.selectAllChildren(e),0<t.rangeCount&&t.collapseToEnd()}else e.selectionStart=e.selectionEnd=e.value.length}(e)):e.parentNode.parentNode.focus()},_e.prototype.kp=function(e,t,r,n){var o=e&&n&&n.sheet,i={},a=h(t,r,o,i);return e.oja=i.formatter||B,a},_e.prototype.activateEditor=function(e,m,b,y,C,w,v){var S,x,t,T,i=y&&y.sheet;i&&(S=this,(x=e)&&(t=J.GC$(x),T=Ae(x),S._editingElement=x,p.android&&t.bind("input"+R,function(e){try{S.$fc(x,m,b,e,y,!1,C,w,v)}catch(e){}}),t.bind("keydown"+R,function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g;try{t=e.keyCode,T&&(8===t?M.processBackspaceAndLeftArrowKeyEvent(e,!0):46===t?M.processDeleteAndRightArrowKeyEvent(e,!0):37===t?M.processBackspaceAndLeftArrowKeyEvent(e,!1):39===t&&M.processDeleteAndRightArrowKeyEvent(e,!1)),229===t||0===t||S.kK||S.$fc(x,m,b,e,y,!0,C,w,v),r=e,n=y,o=S.kK,(g=r.srcElement||r.target)&&"gcEditingInput"===g.getAttribute(E)&&13===r.keyCode&&(r.ctrlKey||r.altKey)&&((i=k.Xl())instanceof A.Worksheet&&(a=i.getCellType(i.Jl,i.Kl))&&(Ae(g)?(o&&(g.blur(),g.focus()),0<(s=P.getSelection()).rangeCount&&(l=s.getRangeAt(0),(u=L.createElement("span")).innerHTML="<br/>"+U,l.insertNode(u),(c=L.createRange()).setStartAfter(u),c.setEndAfter(u),c.collapse(!1),s.removeAllRanges(),s.addRange(c))):(h=g.selectionStart,d=(f=g.value).substr(0,h),p=f.substr(h,f.length-h),g.value=d+"\n"+p,g.selectionStart=h+1,g.selectionEnd=h+1),a.$fc(i._editor,O,O,r,n,!0)),I(r))}catch(e){}}),t.bind("keyup"+R,function(e){var t=e.keyCode,r=e.ctrlKey,n=e.altKey;229===t||0===t||S.kK||(46!==t&&8!==t&&(90!==t&&89!==t||!r||n)||(T&&"\n"===x.innerText&&J.GC$(x).empty(),S.$fc(x,m,b,e,y,!1,C,w,v)),(13!==t&&9!==t&&27!==t&&16!==t||r||n)&&i.Wq(a,{sheet:i,sheetName:i.name(),row:i.Jl,col:i.Kl,editingText:S.getEditorValue(x,y)}))}),t.bind("mousedown"+R,function(){1===i._editorStatus&&(i._editorStatus=2,i._raiseEditorStatusChanged(1,2))}),t.bind("textInput"+R,function(e){if(e.data&&(S.probabilityAddPercentSpec||S.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(e.data)){var t=document.createElement("span");t.innerText="%",t.id="updateEditorImpAddPercent","#text"===x.firstChild.nodeName?x.appendChild(t):x.firstChild.appendChild(t),delete S.probabilityAddPercentSpec,delete S.probabilityAddPercent}}),t.bind("compositionstart"+R,function(){S.kK=!0,S.nK=ke(x)}),t.bind("compositionupdate"+R,function(e){S.$fc(x,m,b,e||O,y,!0,C,w,v)}),t.bind("compositionend"+R,function(e){var t,r,n,o;S.$fc(x,m,b,e||O,y,!1,C,w,v),S.kK=!1,t=e.keyCode,r=e.ctrlKey,n=e.altKey,o=S.getEditorValue(x,y)||"",S.nK!==o&&(t===B||13!==t&&9!==t||r||n)&&i.Wq(a,{sheet:i,sheetName:i.name(),row:i.Jl,col:i.Kl,editingText:o})}),T&&(t.bind("copy"+R,function(e){var t=P.clipboardData,r=e.clipboardData,n=Ne(e.currentTarget);$(n)||(t&&t.setData?(t.setData("text",n),I(e)):r&&r.setData&&(r.setData("text/plain",n),I(e)))}),t.bind("paste"+R,function(e){var t,r,n,o,i,a,s,l,u,c,h=!1;if(T)try{t=void 0,te&&!f&&P.clipboardData&&P.clipboardData.getData?t=P.clipboardData.getData("text"):e.clipboardData&&e.clipboardData.getData&&(t=e.clipboardData.getData("text/plain")),t=Re(t=t.replace(/\r\n?/g,"\n")),0<(r=P.getSelection()).rangeCount&&((o=(n=r.getRangeAt(0)).startOffset)!==n.endOffset&&n.deleteContents(),l=t,u=o,(c=ke(x))&&"="===c[0]||""===c&&"="===l[0]||0===u&&"="===l[0]||(i=L.createElement("span"),"\n"===(t=t.replace(/\u200B/g,""))[(a=t.length)-1]&&(t="\r"===t[a-2]?t.substr(0,a-2):t.substr(0,a-1)),i.innerText=t,n.insertNode(i),(s=document.createRange()).setStartAfter(i),s.setEndAfter(i),s.collapse(!1),r.removeAllRanges(),r.addRange(s),h=!0))}catch(e){}if(S.mK=P.setTimeout(function(){S.$fc(x,m,b,e,y,!1,C,w,v),S.mK&&(clearTimeout(S.mK),delete S.mK)},10),h)return!1}))))},_e.prototype.deactivateEditor=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d;if(e){if(r=e,this.kK&&b&&t&&t.sheet&&t.sheet.CH)try{r&&J.GC$(r).trigger("compositionend"+R)}catch(e){}if(n=t.sheet.getActualStyle(t.row,t.col,t.sheetArea).cellPadding)for(o=[se,"top"],i=[3,0],a=0;a<o.length;a++)s="number"==typeof(s=parseInt((d=f=h=c=u=void 0,d=["0","0","0","0"],typeof(l=n)===w&&(u=l.split(" ",4),c=u.length,f=h=void 0,1===c?(h=u[0],d=[h,h,h,h]):2===c?(h=u[0],f=u[1],d=[h,f,h,f]):3===c?(f=u[1],d=[u[0],f,u[2],f]):4===c&&(d=[u[0],u[1],u[2],u[3]])),d)[i[a]],10))&&0<s?s:0,this.shiftPadding(r,o[a],s);J.GC$(e).unbind(R)}this._editingElement=O},_e.prototype.shiftPadding=function(e,t,r){var n=J.GC$(e).parent();n&&(t===se?n.css({left:(+J.GC$(n).css(se).replace("px","")||0)-r}):"top"===t&&n.css({top:(+J.GC$(n).css("top").replace("px","")||0)-r}))},_e.prototype.getEditingElement=function(){return this._editingElement},_e.prototype.lK=function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z=o&&o.sheet,Y=this,K=Z.options.sheetAreaOffset,X=e;if(X&&Z&&(u=J.GC$(X),c=Z._render,h=o.preventOverflow,f=ke(X),Z.isEditing())){if(d=Ae(X),g=se,m=p=void 0,b=Q.Context.u5,v=w=C=y=0,t&&(y=b(t,0),C=b(t,1),w=b(t,2),v=b(t,3),1===(p=ne(t.hAlign,e.LF))?g="center":2===p&&(g="right"),u.css(he,g),t.foreColor&&u.css("color",t.foreColor),(m=t.font||c.Bl())&&(1<Z.zoom()&&(m=c.Cl(m)),u.css("font",ae(m))),t.textDecoration&&Y.lp(u,t.textDecoration)),S=Te(u.css("padding-left"),10)+Te(u.css("padding-right"),10),x=Te(u.css("padding-top"),10)+Te(u.css("padding-bottom"),10),$(a)&&(a=r),a&&(T=Z.am(),A=r.width,a.x+a.width-K.left>T.width&&(r.width=T.width-r.x,a.width=T.width-a.x),u.css(ue,A-S).css(ce,r.height-x),X.maxWidth=K.left+T.width-r.x-S-C,u.css("max-width",X.maxWidth+"px"),X.maxHeight=K.top+T.height-r.y-x-w,X.minWidth=Te(X.style.width,10),X.minHeight=Te(X.style.height,10)),k=Me(X),M=Ie(X),I=(i=(i=i&&n&&n.keyCode&&Z._eventHandler.LH(n)&&0===k&&M===f.length)||Z.HF)?"":f,m=(m=X.style.font)||c.Cl(c.Bl()),E=oe(m),n&&Y.probabilityAddPercent&&(R=n.keyCode)&&(96<=R&&R<=105||48<=R&&R<=57)&&(Z.parent.options.enableFormulaTextbox?(N=X.innerText,/[a-z]/i.test(N)?Y.probabilityAddPercent=!1:((D=document.createElement("span")).innerText="%",D.id="updateEditorImpAddPercent",X.appendChild(D),delete Y.probabilityAddPercent)):((D=document.createElement("span")).innerText="%",D.id="updateEditorImpAddPercent",X.firstChild.appendChild(D),delete Y.probabilityAddPercent)),!i&&n&&(Z._eventHandler.LH(n)&&8!==n.keyCode&&(I=Ee(X,I,k,M,n)),Y.kK&&(I=te?f:Y.nK+n.data)),P=_=void 0,L=(F=t&&t.wordWrap?ee.Wn(I,Te(X.style.width)-S,m):I.split(/\r\n|\r|\n/)).length,X.minWidth=Se(X.minWidth,X.maxWidth),X.minHeight=Se(X.minHeight,X.maxHeight),t&&t.wordWrap||0<L){if(B=O=void 0,O=re?function(e){var t,r=e.length,n=0;for(t=0;t<r;t++)n+=e[t];return n}(B=function(e,t){var r,n=e.length,o=[];for(r=0;r<n;r++)o.push(ie(e[r],t));return o}(F,m)):L*E,t&&t.wordWrap)u.css(de,be).css(pe,fe).css("max-width",X.style.width);else{for(H=[],_=j=0;_<L;_++)P=ve(Z.rt(F[_],m)),H.push(P),j=xe(j,P);G=u.css(de),U=Te(X.style.width),t||G!==be?j<=X.minWidth?(u.css(ue,X.minWidth).css(de,me).css(pe,fe),d&&u.css(Ce,me)):j>X.minWidth&&j<=X.maxWidth&&!h?(u.css(ue,j).css(de,me).css(pe,fe),d&&u.css(Ce,me)):j>X.maxWidth&&!h&&(u.css(ue,X.maxWidth-2).css(de,be).css(pe,fe),O=Fe(H,X.maxWidth,E,B)):U<j&&!h&&(O=Fe(H,U,E,B))}O<=X.minHeight?u.css(ce,X.minHeight).css(we,le):O>X.minHeight&&O<=X.maxHeight?u.css(ce,O).css(we,le):O>X.maxHeight&&u.css(ce,X.maxHeight-1).css(ye,"scroll").css(we,se)}return p=u.css(he),W=u.width()-X.minWidth,$(p)||p===se||("center"===p?u.css(se,X.originalLeft-W/2):"right"===p&&u.css(se,X.originalLeft-W)),t&&d&&(1===(V=t.vAlign)?u.css(ge,"middle"):2===V&&u.css(ge,"bottom")),z=Te(X.style.height)+x+y+w,q=S+v+C,"scroll"===u.css(ye)?{width:X.offsetWidth+q,height:i?0:z}:{width:Te(X.style.width)+q,height:z}}},_e.prototype.updateEditor=function(e,t,r,n,o,i,a){var s,l,u;return r=this.lK(e,t,r,O,n,!1,o,i,a),te&&e&&(l=(s=J.GC$(e)).width(),s.width(l+1).width(l)),!$(r)&&e&&(u=new c.Rect(e.style.left?parseFloat(e.style.left):0,e.style.top?parseFloat(e.style.top):0,r.width,r.height)),u},_e.prototype.$fc=function(e,t,r,n,o,i,a,s,l){if(r=this.lK(e,t,r,n,o,i,a,s,l),te&&e){var u=J.GC$(e),c=u.width();u.width(c+1).width(c)}!$(r)&&e&&($(a)?a=r:(a.x=B,a.y=B),this.updateEditorContainer(e,r,t,o,a,s,l))},_e.prototype.updateEditorContainer=function(e,t,r,n,o,i,a){var s,l,u;n&&n.preventOverflow?(x.prototype.updateEditorContainer.call(this,e,t,r,n,o,i,a),(s=e.parentNode)&&t&&(l=J.GC$(s),0<(u=t.width)&&l.width(u))):(t&&t.width&&o&&o.width&&(o.width=t.width),t&&t.height&&o&&o.height&&(o.height=t.height),x.prototype.updateEditorContainer.call(this,e,t,r,n,o,i,a))},_e.prototype.updateImeMode=function(e,t,r){this.isImeAware()&&e&&Q.Context.hp(e,t)},_e.prototype.isReservedKey=function(e,t){var r=e.srcElement||e.target,n=e.keyCode,o=e.ctrlKey,i=e.altKey,a=e.metaKey;return!!(r&&t&&t.isEditing&&"gcEditingInput"===r.getAttribute(E))&&(13===n&&(o&&!e.shiftKey||i)||90===n&&o&&!i||89===n&&o&&!i||67===n&&(o||a)&&!i||88===n&&(o||a)&&!i)},_e.prototype.isImeAware=function(e){return!0},_e.prototype.toJSON=function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&"_editingElement"!==e&&(t[e]=this[e]);return t},v=_e,t.Text=v,i._o[1]=v},"./dist/core/core.definition.js":function(e,t){},"./dist/core/core.entry.js":function(e,r,t){"use strict";var n,o,i,a,s,l,u;function c(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),t("./dist/core/core.res.en.js"),c(t("./dist/core/core.ns.js")),c(t("./dist/core/core.enum.js")),c(t("./dist/core/util/common.js")),c(t("./dist/core/util/domUtil.js")),t("./dist/core/core.definition.js"),n=t("./dist/core/util/common.js"),Object.defineProperty(r,"getTypeFromString",{set:function(e){n.getTypeFromString=e},get:function(){return n.getTypeFromString}}),a=-1,1===(i=(o=t("./dist/core/lc/releaseLc.js")).Soa)&&(a=Math.floor(5*Math.random()),r["G".concat("C","$")]["s".concat("d")]=a),c(t("./dist/core/util/theme.js")),c(t("./dist/core/util/basedialog.js")),c(t("./dist/core/util/imageLoader.js")),c(t("./dist/core/util/tasks.js")),0===a&&t("./dist/core/lc/lcRegister.js"),c(t("./dist/core/worksheet/stylehelper.js")),1===a&&t("./dist/core/lc/lcRegister.js"),c(t("./dist/core/worksheet/style.js")),2===a&&t("./dist/core/lc/lcRegister.js"),c(t("./dist/core/worksheet/clipboardhelper.js")),3===a&&t("./dist/core/lc/lcRegister.js"),c(t("./dist/core/worksheet/worksheet-model.js")),4===a&&t("./dist/core/lc/lcRegister.js"),c(t("./dist/core/worksheet/worksheet.js")),t("./dist/core/worksheet/worksheet-formatter.js"),c(t("./dist/core/worksheet/worksheet-actions.js")),c(t("./dist/core/worksheet/worksheet-border.js")),t("./dist/core/worksheet/worksheet-edit.js"),c(t("./dist/core/worksheet/worksheet-event.js")),t("./dist/core/worksheet/worksheet-json.js"),c(t("./dist/core/worksheet/worksheet-render.js")),t("./dist/core/worksheet/worksheet-selection.js"),t("./dist/core/worksheet/worksheet-sort.js"),c(t("./dist/core/worksheet/worksheet-ui.js")),c(t("./dist/core/worksheet/worksheet-static.js")),c(t("./dist/core/workbook/workbook.js")),t("./dist/core/workbook/workbook-json.js"),c(t("./dist/core/workbook/sheettabbase.js")),c(t("./dist/core/workbook/sheettab.js")),c(t("./dist/core/workbook/sheettab2007.js")),c(t("./dist/core/workbook/workbookpanelex.js")),s=t("./dist/core/celltype/cellType.entry.js"),r.CellTypes=s,l=t("./dist/core/celltype/headercelltype.js"),Object.defineProperty(s,"Corner",{set:function(e){e!==l.Corner&&(l.Corner=e)},get:function(){return l.Corner}}),Object.defineProperty(s,"ColumnHeader",{set:function(e){e!==l.ColumnHeader&&(l.ColumnHeader=e)},get:function(){return l.ColumnHeader}}),Object.defineProperty(s,"RowHeader",{set:function(e){e!==l.RowHeader&&(l.RowHeader=e)},get:function(){return l.RowHeader}}),u=t("./dist/core/celltype/textcelltype.js"),Object.defineProperty(s,"Text",{set:function(e){e!==u.Text&&(u.Text=e)},get:function(){return u.Text}}),s.vHb=l,s.wHb=u,1!==i&&2!==i||o.Gb(r)},"./dist/core/core.enum.js":function(e,t,r){"use strict";var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$;Object.defineProperty(t,"__esModule",{value:!0}),($=t.ScrollType||(t.ScrollType={}))[$.pixels=0]="pixels",$[$.continuous=1]="continuous",(Q=t.AxisInfoChangeType||(t.AxisInfoChangeType={}))[Q.setRowCount=0]="setRowCount",Q[Q.setColumnCount=1]="setColumnCount",Q[Q.addRows=2]="addRows",Q[Q.deleteRows=3]="deleteRows",Q[Q.addColumns=4]="addColumns",Q[Q.deleteColumns=5]="deleteColumns",Q[Q.setRowHeight=6]="setRowHeight",Q[Q.setColumnWidth=7]="setColumnWidth",Q[Q.setRowVisible=8]="setRowVisible",Q[Q.setColumnVisible=9]="setColumnVisible",Q[Q.filterRows=10]="filterRows",Q[Q.outlineExpandRows=11]="outlineExpandRows",Q[Q.outlineExpandColumns=12]="outlineExpandColumns",(J=t.ScrollbarState||(t.ScrollbarState={}))[J.hide=0]="hide",J[J.show=1]="show",J[J.active=2]="active",J[J.unactive=3]="unactive",(X=t.ShowResizeTip||(t.ShowResizeTip={}))[X.none=0]="none",X[X.column=1]="column",X[X.row=2]="row",X[X.both=3]="both",(K=t.ScrollbarAppearance||(t.ScrollbarAppearance={}))[K.skin=0]="skin",K[K.mobile=1]="mobile",(Y=t.ShowScrollTip||(t.ShowScrollTip={}))[Y.none=0]="none",Y[Y.horizontal=1]="horizontal",Y[Y.vertical=2]="vertical",Y[Y.both=3]="both",(Z=t.InsertShiftCell||(t.InsertShiftCell={}))[Z.right=0]="right",Z[Z.down=1]="down",(q=t.ResizeMode||(t.ResizeMode={}))[q.normal=0]="normal",q[q.split=1]="split",(z=t.CopyPasteHeaderOptions||(t.CopyPasteHeaderOptions={}))[z.noHeaders=0]="noHeaders",z[z.rowHeaders=1]="rowHeaders",z[z.columnHeaders=2]="columnHeaders",z[z.allHeaders=3]="allHeaders",(V=t.HeaderOptions||(t.HeaderOptions={}))[V.noHeaders=0]="noHeaders",V[V.rowHeaders=1]="rowHeaders",V[V.columnHeaders=2]="columnHeaders",V[V.allHeaders=3]="allHeaders",(W=t.ResizeZeroIndicator||(t.ResizeZeroIndicator={}))[W.default=0]="default",W[W.enhanced=1]="enhanced",(U=t.InvalidOperationType||(t.InvalidOperationType={}))[U.setFormula=0]="setFormula",U[U.copyPaste=1]="copyPaste",U[U.dragFill=2]="dragFill",U[U.dragDrop=3]="dragDrop",U[U.changePartOfArrayFormula=4]="changePartOfArrayFormula",U[U.changeSheetName=5]="changeSheetName",(G=t.AutoFitType||(t.AutoFitType={}))[G.cell=0]="cell",G[G.cellWithHeader=1]="cellWithHeader",(H=t.ClipboardPasteOptions||(t.ClipboardPasteOptions={}))[H.all=0]="all",H[H.values=1]="values",H[H.formatting=2]="formatting",H[H.formulas=3]="formulas",H[H.valuesAndFormatting=4]="valuesAndFormatting",H[H.formulasAndFormatting=5]="formulasAndFormatting",(j=t.LabelAlignment||(t.LabelAlignment={}))[j.topLeft=0]="topLeft",j[j.topCenter=1]="topCenter",j[j.topRight=2]="topRight",j[j.bottomLeft=3]="bottomLeft",j[j.bottomCenter=4]="bottomCenter",j[j.bottomRight=5]="bottomRight",(B=t.LabelVisibility||(t.LabelVisibility={}))[B.visible=0]="visible",B[B.hidden=1]="hidden",B[B.auto=2]="auto",(O=t.TextDecorationType||(t.TextDecorationType={}))[O.underline=1]="underline",O[O.lineThrough=2]="lineThrough",O[O.overline=4]="overline",O[O.doubleUnderline=8]="doubleUnderline",O[O.none=0]="none",(L=t.HorizontalAlign||(t.HorizontalAlign={}))[L.left=0]="left",L[L.center=1]="center",L[L.right=2]="right",L[L.general=3]="general",(P=t.VerticalAlign||(t.VerticalAlign={}))[P.top=0]="top",P[P.center=1]="center",P[P.bottom=2]="bottom",(_=t.VertAlign||(t.VertAlign={}))[_.normal=0]="normal",_[_.superscript=1]="superscript",_[_.subscript=2]="subscript",(F=t.Nxb||(t.Nxb={}))[F.smallDecrement=0]="smallDecrement",F[F.smallIncrement=1]="smallIncrement",F[F.largeDecrement=2]="largeDecrement",F[F.largeIncrement=3]="largeIncrement",F[F.thumbPosition=4]="thumbPosition",F[F.thumbTrack=5]="thumbTrack",F[F.endScroll=6]="endScroll",(N=t.VisualState||(t.VisualState={}))[N.normal=0]="normal",N[N.highlight=1]="highlight",N[N.selected=2]="selected",N[N.active=3]="active",N[N.hover=4]="hover",N[N.activeNotSelected=5]="activeNotSelected",(D=t.EditorStatus||(t.EditorStatus={}))[D.ready=0]="ready",D[D.enter=1]="enter",D[D.edit=2]="edit",(R=t.ImeMode||(t.ImeMode={}))[R.auto=1]="auto",R[R.active=2]="active",R[R.inactive=4]="inactive",R[R.disabled=0]="disabled",(E=t.SelectionPolicy||(t.SelectionPolicy={}))[E.single=0]="single",E[E.range=1]="range",E[E.multiRange=2]="multiRange",(I=t.SelectionUnit||(t.SelectionUnit={}))[I.cell=0]="cell",I[I.row=1]="row",I[I.column=2]="column",(M=t.StorageType||(t.StorageType={}))[M.data=1]="data",M[M.style=2]="style",M[M.comment=4]="comment",M[M.tag=8]="tag",M[M.sparkline=16]="sparkline",M[M.axis=32]="axis",M[M.bindingPath=64]="bindingPath",M[M.hyperlink=256]="hyperlink",(k=t.HeaderAutoText||(t.HeaderAutoText={}))[k.blank=0]="blank",k[k.numbers=1]="numbers",k[k.letters=2]="letters",(A=t.RangeChangedAction||(t.RangeChangedAction={}))[A.dragDrop=0]="dragDrop",A[A.dragFill=1]="dragFill",A[A.clear=2]="clear",A[A.paste=3]="paste",A[A.sort=4]="sort",A[A.setArrayFormula=5]="setArrayFormula",A[A.evaluateFormula=6]="evaluateFormula",(T=t.ValueType||(t.ValueType={}))[T.normal=0]="normal",T[T.richText=1]="richText",(x=t.ImageLayout||(t.ImageLayout={}))[x.stretch=0]="stretch",x[x.center=1]="center",x[x.zoom=2]="zoom",x[x.none=3]="none",(S=t.Oxb||(t.Oxb={})).ThumbButton="thumbButton",S.TrackButton="trackButton",S.LeftButton="leftButton",S.RightButton="rightButton",S.UpButton="upButton",S.DownButton="downButton",(v=t.HorizontalPosition||(t.HorizontalPosition={}))[v.left=0]="left",v[v.center=1]="center",v[v.right=2]="right",v[v.nearest=3]="nearest",(w=t.VerticalPosition||(t.VerticalPosition={}))[w.top=0]="top",w[w.center=1]="center",w[w.bottom=2]="bottom",w[w.nearest=3]="nearest",(C=t.SheetArea||(t.SheetArea={}))[C.corner=0]="corner",C[C.colHeader=1]="colHeader",C[C.rowHeader=2]="rowHeader",C[C.viewport=3]="viewport",(y=t.SortState||(t.SortState={}))[y.none=0]="none",y[y.ascending=1]="ascending",y[y.descending=2]="descending",(b=t.CellStatesType||(t.CellStatesType={}))[b.hover=1]="hover",b[b.invalid=2]="invalid",b[b.readonly=4]="readonly",b[b.edit=8]="edit",b[b.active=16]="active",b[b.selected=32]="selected",b[b.dirty=64]="dirty",(m=t.ButtonVisibility||(t.ButtonVisibility={}))[m.always=0]="always",m[m.onSelected=1]="onSelected",m[m.onEditing=2]="onEditing",(g=n=t.ButtonImageType||(t.ButtonImageType={}))[g.none=0]="none",g[g.custom=1]="custom",g[g.clear=2]="clear",g[g.cancel=3]="cancel",g[g.ok=4]="ok",g[g.dropdown=5]="dropdown",g[g.ellipsis=6]="ellipsis",g[g.left=7]="left",g[g.right=8]="right",g[g.plus=9]="plus",g[g.minus=10]="minus",g[g.undo=11]="undo",g[g.redo=12]="redo",g[g.search=13]="search",g[g.separator=14]="separator",g[g.spinLeft=15]="spinLeft",g[g.spinRight=16]="spinRight",g[g.collapse=17]="collapse",g[g.expand=18]="expand",n.calcel=n.cancel,(p=t.DropDownType||(t.DropDownType={}))[p.colorPicker=0]="colorPicker",p[p.dateTimePicker=1]="dateTimePicker",p[p.timePicker=2]="timePicker",p[p.monthPicker=3]="monthPicker",p[p.list=4]="list",p[p.slider=5]="slider",p[p.calculator=6]="calculator",p[p.workflowList=7]="workflowList",p[p.multiColumn=8]="multiColumn",(d=t.ButtonPosition||(t.ButtonPosition={}))[d.left=0]="left",d[d.right=1]="right",d[d.leftOfText=2]="leftOfText",d[d.rightOfText=3]="rightOfText",(f=t.CaptionAlignment||(t.CaptionAlignment={}))[f.left=0]="left",f[f.right=1]="right",(h=t.LayoutDirection||(t.LayoutDirection={}))[h.horizontal=0]="horizontal",h[h.vertical=1]="vertical",(c=t.LayoutDisplayAs||(t.LayoutDisplayAs={}))[c.inline=0]="inline",c[c.popup=1]="popup",c[c.tree=2]="tree",(u=t.CalendarPage||(t.CalendarPage={}))[u.year=1]="year",u[u.month=2]="month",u[u.day=3]="day",(l=t.CalendarStartDay||(t.CalendarStartDay={}))[l.monday=1]="monday",l[l.tuesday=2]="tuesday",l[l.wednesday=3]="wednesday",l[l.thursday=4]="thursday",l[l.friday=5]="friday",l[l.saturday=6]="saturday",l[l.sunday=7]="sunday",(s=t.GroupSort||(t.GroupSort={}))[s.none=0]="none",s[s.group=1]="group",s[s.child=2]="child",s[s.full=3]="full",(a=t.DropdownListValue||(t.DropdownListValue={}))[a.string=0]="string",a[a.array=1]="array",(i=t.PatternType||(t.PatternType={}))[i.solid=1]="solid",i[i.darkGray=2]="darkGray",i[i.mediumGray=3]="mediumGray",i[i.lightGray=4]="lightGray",i[i.gray125=5]="gray125",i[i.gray0625=6]="gray0625",i[i.darkHorizontal=7]="darkHorizontal",i[i.darkVertical=8]="darkVertical",i[i.darkDown=9]="darkDown",i[i.darkUp=10]="darkUp",i[i.darkGrid=11]="darkGrid",i[i.darkTrellis=12]="darkTrellis",i[i.lightHorizontal=13]="lightHorizontal",i[i.lightVertical=14]="lightVertical",i[i.lightDown=15]="lightDown",i[i.lightUp=16]="lightUp",i[i.lightGrid=17]="lightGrid",i[i.lightTrellis=18]="lightTrellis",(o=t.NumbersFitMode||(t.NumbersFitMode={}))[o.mask=0]="mask",o[o.overflow=1]="overflow"},"./dist/core/core.ns.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./dist/core/core.res.en.js");t.SR={en:n}},"./dist/core/core.res.en.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_NotSupported="NotSupportException",t.Exp_PasteExtentIsNull="pasteExtent is null",t.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",t.Exp_MultipleSelections="This action won't work on multiple selections.",t.Exp_ChangePartOfArray="Cannot change part of an array.",t.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",t.Exp_SrcIsNull="The argument 'src' is null",t.Exp_DestIsNull="The argument 'dest' is null",t.Exp_InvalidCustomFunction="invalid custom function",t.Exp_InvalidCustomName="invalid custom name",t.Exp_IndexOutOfRange="Index is out of range!",t.Exp_InvalidRange="Invalid range",t.Exp_ArgumentOutOfRange="ArgumentOutOfRange",t.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",t.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",t.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",t.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",t.Tip_Row="Row: ",t.Tip_Column="Column: ",t.Tip_Height="Height: {0} pixels",t.Tip_Width="Width: {0} pixels",t.NewTab="New...",t.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",t.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",t.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",t.Exp_DestSheetIsNull="destSheet is null",t.Exp_SheetIsNull="sheet is null.",t.Exp_OverlappingSpans="This operation will cause overlapping spans.",t.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",t.ARIA_Resize="resize",t.ARIA_First="first",t.ARIA_PreviousArrow="previous arrow",t.ARIA_NextArrow="next arrow",t.ARIA_Last="last",t.ARIA_PreviousButton="previous button",t.ARIA_NextButton="next button",t.ARIA_SheetTab="sheet tab",t.ARIA_NewSheet="new sheet",t.ARIA_Blank="blank",t.ARIA_Scrollbar_Left_Button="scrollbar left button",t.ARIA_Scrollbar_Top_Button="scrollbar top button",t.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",t.ARIA_Scrollbar_Right_Button="scrollbar right button",t.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",t.ARIA_Scrollbar_TRACK_Button="scrollbar track button",t.ARIA_Cell="cell",t.ARIA_HasValue="has value {0}",t.ARIA_RowHeader="row header",t.ARIA_ColumnHeader="column header",t.SHEET_NAME="Sheet",t.lsru=["","6465706c6f796d656e74"],t.lsde=["","64657369676e6572"],t.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],t.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],t.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a532e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e6365206f7220726571756573742061206b6579206174206763676f2e746f2f736a736b65792e"],t.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],t.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],t.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],t.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",t.Exp_InsertCopiedCutCellsOnSpanTable="This wont work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",t.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",t.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",t.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",t.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist."},"./dist/core/lc/common.js":function(e,G,U){"use strict";(function(e){var t,r,i,n,u,o,a,A,s,l,k,c,M,h,f,d,p,g,m,b,I,E,R,D,N,F,_,P,y,L;function C(e,t){var r,n,o,i,a="",s=0;for(r=0;r<e.length;r++)s=Math.max(s,e[r].length);for(r=0;r<s;r++){for(t&&(n=""),i=0;i<e.length;i++)t?n+=r>=e[i].length?"00":e[i].charAt(r)+e[i].charAt(r+1):r<e[i].length&&(a+=e[i].charAt(r));t&&(o=parseInt(n,16),a+=String.fromCharCode(o),r++)}return a}function w(t,r,n){var o,e=C(["Lcnee","iesKy"]),i=L[e];return a(i,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B0"},function(e){(o=v(e,"VIEE")).hl=!!i,o.m=i?o.m:-1,r.call(t,o),S(o,t,0,n)},function(){(o=v()).hl=!!i,o.m=i?o.m:-1,r.call(t,o),S(o,t,0,n)}),o}function v(y,C){var w,v,S,x,e,t={isVd:function(e){return e=1===L.Workbook.lm||e,this.s&&!this.e&&(!this.adr||!!this.adr.dsr==!!e)}},T=(e=A(P),function(e){var t=A("VdgJHc#wJb59"),r=A("Zdg3Ga#UHbw5");return e&&(function(e){var t=A("MlSZto#Z");return e&&e===t}(e[t])||function(e){var t=A("yXbog&w");return e&&e===t}(e[t])||function(e){var t=A("4LJITMx8UMcA"),r=A("jOxo"),n=A("JYw3Gb4NOb6x"),o=A("g1Jbww#Y"),i=RegExp("^[\\w\\-]+\\."+o+"$","i");return e&&(e===t||e===r||e===n||c.test(e)||i.test(e))}(e[r]))}(k[e]));return t[d]=T,t.s=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b;if(!y)return!1;if(!(e=y[I])||!e.length)return!1;for(n=0,o=e.length;n<o;n++)if(r=(t=e[n])&&t[R]===C){w=t[E];break}if(!r)return!1;if(y[_]&&(x=y[_]),y[F]){if(i=new Date,s=y[F],a=new Date(O(s.substr(0,4))||0,O(s.substr(4,2))-1||0,O(s.substr(6,2))||0),S=Math.ceil((a-i)/864e5),v=S<=0)return!1}else S=void 0;return!!(T||!y[D]&&!y[N]||(d=y[D],y[N],function(){var e=A(P),t=A("VdgJHc#wJb59"),r=A("Udg36Y#oUddV"),n=k[e];return n&&n[t]===r}()&&(p=A(P),g=A("1agFGc#UHbw5"),(m=k[p]&&k[p][g])&&(m=m.toLowerCase(),b=d.split(","),d&&function(e,t){var r,n,o,i;if(e&&0===e.indexOf("//")&&!((r=e.slice(2).split("/")).length<1))for(n=r[0],o=0,i=t.length;o<i;o++)if(t[o]===n)return 1}(m,b))))||(l=y[D],y[N],c=A(P),h=A("Zdg3Ga#UHbw5"),!(f=k[c]&&k[c][h])||(f=f.toLowerCase(),u=l.split(","),l&&function(e,t){var r,n,o,i,a;for(r=0,n=t.length;r<n;r++){if(o=t[r],i=!1,o&&0===o.lastIndexOf("*.",0)&&(i=!0),(o=i?o.slice(2):o)===e)return 1;if(i&&0<(a=e.indexOf("."+o))&&a===e.length-o.length-1)return 1}}(f,u)||l&&function(e,t){var r,n,o,i;if(e&&4===e.split(".").length)for(r=0,n=t.length;r<n;r++)if((o=t[r])&&0<(i=o.length-2)&&(o===e||".*"===o.substr(i)&&e.substr(0,i)===o.substr(0,i)&&M.test(e)))return 1}(f,u))))}(),t[h]=y?y[b]?-1:1:0,t[f]=w,(t[g]=v)||(t[p]=S),t[m]=x,t}function O(e){return parseInt(e,10)}function S(e,t,r,n){x(e)?n||t.repaint&&!t.Js&&t.repaint():T(t,e)}function x(e){return e&&(e.isVd(!1)||e.b&&!e.hl)}function T(e,t){var r,n;function o(){n.width=i.GC$(r).width(),n.height=i.GC$(r).height(),function(e,t,r,n){var o,i,a,s,l;if(!n||!n.isVd(!1))for(o=n.hl?(!n.adr||!n.adr.dsr)&&n.e?"l5":"l4":"l3",i=j(o,y,n),u(e,"16pt calibri"),e.fillStyle="black",e.fillRect(0,0,t,r),e.fillStyle="white",a=30,s=0;s<i.length;s++)l=i[s],e.fillText(l,20,a),a+=25}(n.getContext("2d"),n.width,n.height,t)}e.XIc||(e.XIc=!0,r=e._host,e.sheets=[],e.no(),r&&(n=document.createElement("canvas"),r.appendChild(n),o(),i.GC$(window).bind("resize",function(){setTimeout(o,100)})))}function B(e){return new t.Common.ResourceManager(r.SR).getResource()[e]}function j(e,t,r){var n,o,i,a=B(C([e,"s"])),s=B(1===L.Workbook.lm?C(["ld","se"]):C(["lr","su"])),l=H(a,t);for(s=H(s,t),l=(l=l.replace("{0}",r.d)).replace("{1}",s).replace("{1}",s),n=[],i=o=0;i<l.length;i++)"\r"!==l[i]&&"\n"!==l[i]||(n.push(l.substring(o,i)),"\r"===l[i]&&i<l.length-1&&"\n"===l[i+1]&&i++,o=i+1);return o<l.length&&n.push(l.substring(o,l.length)),n}function H(e,t){var r,n,o,i=!0,a="";if(e)if("string"==typeof e)(e=e.trim())&&(r=[e]);else if(Array.isArray(e)){for(n=!0,r=[],o=0;o<e.length;o++)a=e[o].trim(),r.push(a),n&&a&&(n=!1);n&&(r=null)}return r||(i=!1,r=t),C(r,i)}Object.defineProperty(G,"__esModule",{value:!0}),t=U("@grapecity/js-sheets-common"),r=U("./dist/core/core.ns.js"),i=U("./dist/core/util/domUtil.js"),n=U("./dist/core/util/common.js"),u=n.Ul.lZa,o=U("./dist/core/lc/lcValidator.js"),a=o.VIc,A=o.WIc,s="object"==typeof e&&e&&e.Object===Object&&e,l="object"==typeof self&&self&&self.Object===Object&&self,k=s||l||Function("return this")(),c=/^[\w\-]+$/i,M=/^[0-9.]+$/,h="m",f="n",d="b",p="d",g="e",m="adr",b=A("XRsZ"),I=A("HUkJ"),E=A("T&g"),R=A("Q&w"),D=A("GRz1"),N=A("XSzB"),F=A("XRwh"),_=A("WQs5"),P="JYx3Gb#8Pb5R",y=["Ivldlcneky mi pedslsgaeiycmi o edassac.","nai ies e.Ealsra.ae@rpct.o fyune sitne"],G.VIc=w,G.Gb=function(r,e){var n,t,o,i,a,s,l,u;t=(L=e).Workbook.prototype,o=t.ad,t.ad=function(){var t=this;if(w(t,function(e){t.ls=e,n=e,t.ul=function(){w(t,function(e){t.ls=e,n=e})}}),!n||x(n))return o.apply(t,arguments)},i=e.Worksheet.prototype,a=i.ad,i.ad=function(){if(n||this.parent||w(this,function(e){n=e}),!n||x(n))return a.apply(this,arguments)},s=e.oJ.prototype,l=s.Pw,s.Pw=function(e,t){l.apply(this,arguments),n&&(-1===n.m||!n.hl&&n.b)&&r(this.kj,e,t,n)},u=s.RI,s.RI=function(e,t){u.apply(this,arguments),n&&(-1===n.m||!n.hl&&n.b)&&r(this.kj,e,t,n)}},G.Hhc=T,G.e6=j,G.YIc=function(e){return B(C([e,"sa"]))}}).call(this,U("./node_modules/webpack/buildin/global.js"))},"./dist/core/lc/lcRegister.js":function(e,t,r){"use strict";var o,n,i,a,s;function l(){if(s=null,a[0])try{var n=a[0].tc;n&&n._host&&o.VIc(n,function(e){var t,r=n.getActiveSheet();r&&((t=r.l)&&(e=t),t||e.b||-1!==e.m||!e.d||(e.s=!1,o.Hhc(n,e)))},!0)}finally{a=[]}}Object.defineProperty(t,"__esModule",{value:!0}),o=r("./dist/core/lc/releaseLc.js"),i=(n=r("./dist/core/util/domUtil.js")).GC$.sd,a=[],n.GC$[i]=function(e){a.push(e),s=s||setTimeout(l,5e3*Math.random()+3e3)}},"./dist/core/lc/lcValidator.js":function(e,t){var r,n,o=(n={},i.m=r=[function(e,s){(function(e){"use strict";var n,m,b,y,f,t,r,C;function o(e,t,r,n){return 1==e.length||e.splice(r,1,n(e.splice(t,1,n(e[r]))[0])),e}function i(e){function t(e){return function(e,t){var r=1<arguments.length&&void 0!==t?t:1,n=e.charCodeAt(0);return 65<=n&&n<=90?e.toLowerCase():97<=n&&n<=122?e.toUpperCase():48<=n&&n<=57?b(48+(n-48+10+r)%10):e}(e,-1)}var r,n=e.split("");for(r=n.length-5;0<=r;r--)o(n,r+1,r+3,t),o(n,r,r+2,t);return n.join("")}function a(e){return(m&&window.atob||function(e){var t,r,n,o,i,a,s,l=[],u=f,c=e;for(s=0;s<c.length;s+=4)t=(a=u.indexOf(c.charAt(s))<<18|u.indexOf(c.charAt(s+1))<<12|(o=u.indexOf(c.charAt(s+2)))<<6|(i=u.indexOf(c.charAt(s+3))))>>>16&255,r=a>>>8&255,n=255&a,l[s/4]=b(t,r,n),64==i&&(l[s/4]=b(t,r)),64==o&&(l[s/4]=b(t));return l.join("")})(e)}function w(e){return(m&&window.btoa||function(e){var t,r,n,o,i,a,s=[],l="",u=f,c=e,h=c.length%3;if(0<h)for(;h++<3;)l+="=",c+="\0";for(h=0;h<c.length;h+=3)r=(t=c.charCodeAt(h)<<16|c.charCodeAt(h+1)<<8|c.charCodeAt(h+2))>>18&63,n=t>>12&63,o=t>>6&63,i=63&t,s[h/3]=u.charAt(r)+u.charAt(n)+u.charAt(o)+u.charAt(i);return(a=s.join("")).slice(0,a.length-l.length)+l})(e)}function v(e){var t,r,n;return e?(t=i(e),t=t.split("").reverse().join(""),r=Math.ceil(t.length/2),t=(t=(t=t.substr(r)+t.substr(0,r)).replace("#","=")).replace("&","=="),n=t,decodeURIComponent(Array.prototype.map.call(a(n),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))):""}function S(e){var t,r=a(e),n=r.length,o=new y(n);for(t=0;t<n;t++)o[t]=r.charCodeAt(t);return o.buffer}function x(e){var t,r,n=new ArrayBuffer(e.length),o=new y(n);for(t=0,r=e.length;t<r;t++)o[t]=e.charCodeAt(t);return n}function T(r){return"oncomplete"in r&&(r.then=function(e,t){r.resolve=e,r.reject=t},r.oncomplete=function(e){r.resolve(r.result)},r.onerror=function(){r.reject()}),r}Object.defineProperty(s,"__esModule",{value:!0}),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m="undefined"!=typeof window,b=String.fromCharCode,y=m&&window.Uint8Array||function(e){var t,r;if("number"==typeof e)for(t=Array(e),r=0;r<e;++r)t[r]=0;else t=e.slice(0);return(t.buffer=t).byteLength=t.length,"object"===(void 0===e?"undefined":n(e))&&e.buffer&&(t.buffer=e.buffer),t},f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="object"==(void 0===e?"undefined":n(e))&&e&&e.Object===Object&&e,r="object"==("undefined"==typeof self?"undefined":n(self))&&self&&self.Object===Object&&self,C=t||r||Function("return this")(),s.iDe=v,s.attorn=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d=m?window.msCrypto?window.msCrypto:window.crypto:void 0,p=function(e,t){try{t="#"+t;var r=e.indexOf(t);if(-1<r)return{prefix:e.substring(0,r),licData:JSON.parse(v(e.substr(r+t.length)))}}catch(e){}return!1}(e,t.aC);if(!p)return n();function g(){return function(e){var t,r,n,o=0,i=5381,a=0;for(t=e.length-1;0<=t;t--)o=(r=e.charCodeAt(t))+(o<<6)+(o<<16)-o,i=r+((i<<5)+i),a=r+((a<<5)-a),a&=a;return(n=o^i^a)<0&&(n=~n),n.toString(16).toUpperCase()}(i+JSON.stringify(o.D))===o.H?r(o.D):n()}return o=p.licData,i=p.prefix+"#"+t.aC,h=S((f=i+JSON.stringify(o.D),w(encodeURIComponent(f).replace(/%([0-9A-F]{2})/g,function(e,t){return b(parseInt(t,16))})))),a=b.apply(null,new y(h)),s=v("JYx3Gb#8Pb5R"),l=v("VdgJHc#wJb59"),(!C[s]||!C[s][l]||location.protocol.match(/^https/i))&&d&&d.subtle?(u={alg:"RS256",e:"AQAB",kty:"RSA",n:t.pK.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")},u=window.msCrypto?x(JSON.stringify(u)):u,c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},void T(d.subtle.importKey("jwk",u,c,!1,["verify"])).then(function(e){T(d.subtle.verify(c,e,S(o.S),x(a))).then(function(e){return e?r(o.D):n()})},function(){return g()})):g()}}).call(s,function(){return this}())}],i.c=n,i.p="dist",i(0));function i(e){if(n[e])return n[e].exports;var t=n[e]={exports:{},id:e,loaded:!1};return r[e].call(t.exports,t,t.exports,i),t.loaded=!0,t.exports}e.exports={VIc:o.attorn,WIc:o.iDe}},"./dist/core/lc/releaseLc.js":function(e,t,r){"use strict";var y,n,C,w,v;function o(t,e,r,n){var o,i,a,s,l,u,c,h,f=t.am(),d=t.parent,p="11pt calibri",g=n.hl&&n.isVd(!1)&&n.d,m=d&&d.jDc,b="";for(g?o="l2":n.e?o="l5":n.hl&&!n.d?o="l6":(o="l1",i=y.YIc(o)),f=f||t.am(),a=y.e6(o,w,n),s=0,i&&a.forEach(function(e){s=v(s,t.dp(e,p))}),t.l=a[0]?n:void 0,l=0;l<a.length&&(203<f.width||203<f.height)&&!m;l++)b=a[l],u=s||t.dp(b,p),c=f.width-u-10,h=f.height-10-20*(a.length-l),r&&!r.intersect(c,h,u,20)||(e.save(),e.fillStyle="rgba(0, 0, 0, 0.5)",C(e,p),r&&(e.rect(r.x,r.y,r.width,r.height),e.clip(),e.beginPath()),e.fillText(b,c,20+h),b&&(t.l=n),e.restore())}Object.defineProperty(t,"__esModule",{value:!0}),y=r("./dist/core/lc/common.js"),n=r("./dist/core/util/common.js"),C=n.Ul.lZa,w=["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\nfyuprhsdalcne orkyi nyu ucaecnimto mi.\nmi sslsgaeiycmi o edassac.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain\rI o ucae  ies,yu e si orprhs ofraineal\rEalu.ae@rpct.o fyune sitne"],v=Math.max,t.Gb=function(e){y.Gb(o,e)},t.Soa=1,t.VIc=y.VIc,t.Hhc=y.Hhc},"./dist/core/util/basedialog.js":function(e,t,r){"use strict";var n,o,d,i,a,s,p,l,u;function c(e,t,r){this.c4="gc-popup",this.so="gc-overlay",this.AWa=null;var n=this;n._host=e,n.zWa=r,t=t||0,n.to={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:t,backgroundColor:"rgba(0,0,0,0)"},n.uo={position:"absolute",padding:0,margin:0,height:"auto",zIndex:t+1,outline:"none"},n.ad()}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/util/common.js"),o=r("./dist/core/util/domUtil.js"),d=o.GC$,i=n.util.Nl,a=n.util.Ml,s=n.util.nl,p=document,l=window,u=l.Yl,c.prototype.ad=function(){var e=this;e.vo(e.Cj)?e.xo=d("#"+e.Cj):(e.Cj=e.wo(),e.xo=d(i("div")).addClass(e.c4+" ui-widget").attr({id:e.Cj,tabIndex:-1}).css(e.uo))},c.prototype.wo=function(){for(var e=0,t="gc-dialog";this.vo(t+e);)e++;return t+e},c.prototype.yo=function(){if(this.xo)return this.xo},c.prototype.zo=function(){return this._host?this._host:p.body},c.prototype.Ao=function(e){var t=this,r=t.xo;t.Bo()||t.Co(),u.Gm(),t.vo(t.Cj)||(d(t.zo()).append(r),t.Do(),r.css("display","none")),r.show(e)},c.prototype.close=function(){var e=this;e.vo(e.Cj)&&e.xo.remove(),d("."+e.c4).isVisible()||e.Eo(),u.Hm()},c.prototype.Eo=function(){d("."+this.so).remove(),this.AWa=null},c.prototype.Do=function(){var e,t,r,n,o,i,a,s,l,u,c,h=this.xo,f=this.zo();0!==h.length&&(e=d(f).offset(),t=parseInt(h.css("left"),10)+e.left,r=parseInt(h.css("top"),10)+e.top,n=h.width(),o=h.height(),isNaN(t)||isNaN(r)||isNaN(n)||isNaN(o)||(a=i=0,l=(s=p.documentElement).clientWidth,u=s.clientHeight,(c=h[0].getBoundingClientRect()).left+n>l&&(a=c.left+n-l),c.top+o>u&&(i=c.top+o-u),(t<0||r<0||0<i||0<a)&&((t-=a)<0&&(t=0),(r-=i)<0&&(r=0),h.css({left:t-e.left+"px",top:r-e.top+"px"}))))},c.prototype.vo=function(e){return 0<d("#"+e).length},c.prototype.Co=function(){var t,r,n=this,o=d(i("div")).addClass(n.so),e=n.xo;(this.AWa=o).css(n.to),d(n._host).append(o),(t=a&&a.mozilla)&&(r=(new Date).valueOf()),o.bind("mousedown",function(e){if(!n.zWa){if(t&&(new Date).valueOf()-r<100)return;n.close(),t&&n.Fo&&clearTimeout(n.Fo)}s(e)}),o.bind("contextmenu",function(e){n.zWa&&s(e)}),e.bind("contextmenu",function(e){s(e)}),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(e){o.bind(e,function(e){n.zWa||(t?n.Fo=l.setTimeout(function(){n.close()},100):n.close()),s(e)})})},c.prototype.Bo=function(){return 0<d("."+this.so).length},t.Go=c},"./dist/core/util/common.js":function(e,n,t){"use strict";var d,r,M,p,w,o,g,h,m,b,I,i,f,y,a,C,E,s,R,D,v,S,N,x,T,A,k,F,_,l,u,P,L,O,c,B,j,H,G,U,W,V,z,q,Z,Y;function K(e){return void 0!==e}function X(e){return y.createElement(e)}function J(e){y.body&&y.body.insertBefore(e,E)}function Q(e){return e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!1,e.returnValue=!1),!1}function $(e){var t,r,n=!1;if(e)for(t=0;t<e.length;t++)if(11904<=(r=e.charCodeAt(t))&&r<12032||12288<=r&&r<40960||43360<=r&&r<43392||63744<=r&&r<64256){n=!0;break}return n}function ee(){}function te(){}function re(e,t){var r=X("span");return r.className=e,t&&(r.id=t),r.style.display="none",J(r),r}function ne(e,t,r,n){e.addEventListener(t,r,n)}function oe(e){var t=e.currentStyle,r=y.defaultView;return r&&r.getComputedStyle&&(t=r.getComputedStyle(e,"")),t}function ie(e){var t,r,n,o,i,a,s=f.Yl;0<s.jm||(16!==e.keyCode&&(s.XCb=!0),(r=(t=c.Xl())&&t.lm)&&w(r).isVisible()||t&&t._eventHandler&&t._eventHandler.nm&&(t._eventHandler.nm(e),t.isEditing()||(n=e.keyCode,o=e.ctrlKey,i=e.altKey,a=e.shiftKey,90!==n&&89!==n||!o||i?86!==n||!o||i||a||e.stopPropagation&&e.stopPropagation():Q(e))))}function ae(e){var t,r=f.Yl;0<r.jm||(r.XCb=!1,(t=c.Xl())&&t._eventHandler&&t._eventHandler.om&&t._eventHandler.om(e))}function se(e){var t;0<f.Yl.jm||(t=c.Xl())&&t._eventHandler&&t._eventHandler.pm&&t._eventHandler.pm(e)}function le(e){var t,r=f.Yl;0<r.jm||(!0===r.XCb||(t=c.Xl())&&t._eventHandler&&t._eventHandler.pm&&t._eventHandler.pm(e))}function ue(e){return y.all===C&&c.Xl()&&Q(e),!1}function ce(e,t,r,n){this.row=e,this.rowCount=r,this.col=t,this.colCount=n}function he(e,t,r,n){this.x=e,this.y=t,this.width=r,this.height=n}function fe(e,t){this.x=e,this.y=t}function de(){}function pe(){this.jm=0,this.km=[],this.XCb=!1,this.ad()}function ge(e,t){var r=D(e.row,t.row),n=D(e.col,t.col),o=v(e.row+e.rowCount-1,t.row+t.rowCount-1),i=v(e.col+e.colCount-1,t.col+t.colCount-1);return 0<=r&&0<=n?new j(r,n,o-r+1,i-n+1):0<=r?new j(r,-1,o-r+1,-1):0<=n?new j(-1,n,-1,i-n+1):new j(-1,-1,-1,-1)}function me(){}function be(e){this.kj=e}function ye(){}function Ce(){}function we(e){var t=e.An||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return e.An=t}function ve(){}function Se(e,t){e&&(e.Gn=t)}function xe(e,t){e&&(e.Hn=t)}function Te(){}function Ae(){return W.Yn||(W.Yn=X("canvas").getContext("2d")),W.Yn}function ke(e){var t,r,n,o=[],i=0,a=k;for(t=0;t<e.length;t++)o[i]===C&&(o[i]=""),r=e.charAt(t),n="",t+1<e.length&&(n=e.charAt(t+1)),r===a&&n!==a||"-"===r&&"-"!==n?(o[i]+=r,i++):o[i]+=r;return o}function Me(e){for(var t=e.length-1;" "===e.charAt(t);)t--;return t!==e.length-1&&(e=e.substring(0,t+1)),e}function Ie(e){var t,r=e instanceof Array?[]:{};for(t in e)e.hasOwnProperty(t)&&(r[t]="object"==typeof e[t]&&e[t]!==E?Ie(e[t]):e[t]);return r}function Ee(e,t,r,n,o){var i,a,s,l,u,c,h,f,d=[],p=o||Ae();if(!p)return d;for(a=r?(s=e.length*n,R(t/n)):(i=(s=O(p,p.font,e))/e.length,R(t/i));t<s&&e;)for(l=!1,u=a;;){if(e.length<u){d.push(e),e="";break}if(c=e.substring(0,u),h=r?u*n:O(p,p.font,c),"-"===c.charAt(c.length-1)&&(h=r?u*n:O(p,p.font,c)-O(p,p.font,"-")),h===t||l&&h<t){d.push(c),e=e.substring(u),s-=h;break}if(t<h){if(1===c.length){e.substring(c.length).trim()?(d.push(c),e=e.substring(u),s-=h):(d.push(e),e="");break}--u,l=!0}else u+=f=1<=(f=r?(t-h)/n:(t-h)/i)?f:1}return e&&-1===e.search(/^[ ]*$/)&&d.push(e),d}function Re(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m=i||Ae();if(!m)return[e];for(a=[],l=t,u=[],c=s=0;c<e.length;c++)if(h=e[c].style&&e[c].style.font||o,f=L.fp(h),e[c].text&&0<e[c].text.length?s+=n?f*e[c].text.length:O(m,h,e[c].text):s=0,s<l)u.push(e[c]);else for(s-=n?f*e[c].text.length:O(m,h,e[c].text),d=0;d<e[c].text.length;d++){if(r<(p=n?f:O(m,h,e[c].text.charAt(d)))&&0===d){0<u.length&&(a.push(u),u=[]),u.push({style:e[c].style,text:e[c].text.substring(0,1)}),a.push(u),u=[],(g=e[c].text.substring(1,e[c].text.length)).length&&e.splice(c+1,0,{style:e[c].style,text:g}),s=0,l=r;break}if(l<(s+=p)){u.push({style:e[c].style,text:e[c].text.substring(0,d)}),a.push(u),u=[],(g=e[c].text.substring(d,e[c].text.length)).length&&e.splice(c+1,0,{style:e[c].style,text:g}),s=0,l=r;break}}return 0<u.length&&a.push(u),a}function De(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C=[],w=ke(e),v=o||Ae();if(!v)return C;for(i=O(v,v.font,e),a=r?n:i/e.length,s=N(t/a+"",10),h=c=u=l=0,d=!(f=[]);h<w.length;){if(!1===d){if(p=w[h],f.push(p),(u+=p.length)<s&&h<w.length-1){h++;continue}c=u,u=0}if(g=r?f.join("").length*n:W.Xn(f.join(""),v.font,!0,v),"-"===f.join("").charAt(f.join("").length-1)&&(g=r?f.join("").length*n:O(v,v.font,f.join(""))-O(v,v.font,"-")),t<g)if(m=f.pop(),0===f.length){for(b=Ee(m,t,r,n,v),y=0;y<b.length-1;y++)C[l]=b[y],l++;1===b.length&&(C[l]=b[0],l++),2<=b.length?w[h]=b[b.length-1]:h++,d=!1}else d=!0,h--;else g<t&&!0===d||g===t?(d=!1,C[l]=Me(f.join("")),l++,f=[],h++):g<t&&(h++,u=c)}return 0!==f.length&&(C[l]=Me(f.join(""))),C}function Ne(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g=[],m=o||Ae();if(!m)return g;if(0===e.length)return g.push({textLength:0,text:"",textInfos:[{style:{font:r},text:""}]}),g;for(a=[],s=i=0;s<e.length;s++){for(l=e[s],c=u=0;c<l.length;c++)h=l[c].style&&l[c].style.font?l[c].style.font:r,n?u+=L.fp(h)*l[c].text.length:I(l[c].text)||(u+=O(m,h,l[c].text));if(t<u){for(0<a.length&&(g.push({textLength:i,text:Me(_e(a)),textInfos:Ie(a)}),a=[],i=0),f=Re(l,t-i,t,n,r,m),a=a.concat(f[0]),I(f[0])||g.push({textLength:i+Fe(f[0],r,n,m),text:Me(_e(a)),textInfos:Ie(a)}),a=[],i=0,d=1;d<f.length-1;d++)I(f[d])||g.push({textLength:Fe(f[d],r,n,m),text:Me(_e(f[d])),textInfos:Ie(f[d])});1<f.length&&(p=f[f.length-1],a=a.concat(p),I(p)||(i+=Fe(p,r,n,m)))}else t<i+u?(g.push({textLength:i,text:Me(_e(a)),textInfos:Ie(a)}),a=(a=[]).concat(l),i=u):(a=a.concat(l),i+=u)}return 0<a.length&&g.push({textLength:i,text:Me(_e(a)),textInfos:Ie(a)}),g}function Fe(e,t,r,n){var o,i,a=0,s=n||Ae();for(o=0;o<e.length;o++)i=e[o].style&&e[o].style.font||t,a+=r?L.fp(i)*e[o].text.length:O(s,i,e[o].text);return a}function _e(e){var t,r="";for(t=0;t<e.length;t++)r+=e[t].text;return r}function Pe(){}function Le(){this.JTa={}}function Oe(){}function Be(e){return e&&"SPAN"===e.tagName}function je(e){return e&&"BR"===e.tagName}function He(e){return e instanceof Text}function Ge(e){if(e){var t=e.childNodes;return Be(e)&&2===t.length&&je(t[0])&&Ue(t[1])}return!1}function Ue(e){if(e&&He(e)){var t=e.textContent;if(1===t.length&&Ve(t[0]))return!0}return!1}function We(e,t,r,n){return e.substr(0,t)+n+e.substr(r,e.length-r)}function Ve(e){return e===P}function ze(e,t){for(var r=e&&e.previousSibling;r;){if(t(r))return r;r=r.lastChild}return E}Object.defineProperty(n,"__esModule",{value:!0}),d=t("@grapecity/js-sheets-common"),r=t("./dist/core/util/domUtil.js"),M=t("./dist/core/core.enum.js"),p=t("@grapecity/js-calc"),w=r.GC$,o=w.extend,g=d.Common.o,h=d.Common.k.Uo,m=d.Formatter&&d.Formatter.GeneralFormatter,b=d.Formatter&&d.Formatter.lxb,I=d.Common.j.Fa,i=d.Common.u,n.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',f=window,y=document,a="boolean",C=void 0,E=null,s=Math.floor,R=Math.ceil,D=Math.min,v=Math.max,S=Math.round,N=parseInt,x=parseFloat,T=isNaN,A="px",k=" ",F="string",_="number",l=RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),u=RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),P="",n.productInfo={productVersion:"13.1.1"},n.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},n.getTypeFromString=function(e){var t,r,n,o=!1,i=f;if(typeof e==F){for(r=0,n=(t=e.split(".")).length;r<n&&i;r++)i=i[t[r]];i&&r===n&&0<n&&(o=!0)}return o?i:C},n.findControl=function(e){return typeof e==F&&(e=y.getElementById(e)),w(e).data("workbook")},te.xq=function(e){for(var t,r="";0<e;e=parseInt((e-1)/26+"",10))t=(e-1)%26,r=String.fromCharCode(65+t)+r;return r},te.ol=function(e,t,r,n){if(3===e){var o=w.getType(t);e=r&&"@"===r?0:o===a?1:o===_||"date"===o||o===F&&te.YGb(t)?2:0,n&&0!==n&&(0<n?e=0:n<0&&(e=2),-90===n?e=0:90===n&&(e=2))}return e},te.YGb=function(e){return te.ZGb.test(e)},te.bc=function(e){var t,r=w.getType(e);return e=e===E||e===C?"":r===a?(""+e).toUpperCase():"date"===r?(t=0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds(),d.Common.l.Vb(e,t?"M/d/yyyy":"M/d/yyyy h:mm:ss")):e.richText?te.K_a(e):""+e},te.ql=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d=w(e),p=t,g=r,m="background-position",b="background-size",y="auto",C="0%";switch(i){case 0:a?d.css(m,a.position).css(b,a.size):d.css(m,C+k+C).css(b,"100%"+k+"100%");break;case 1:l=s="50%",p<n&&(s=C),g<o&&(l=C),d.css(m,s+k+l).css(b,y+k+y);break;case 2:h=p,(c=u=0)<(f=g)&&0<o&&n/o<p/g?u=u+p/2-(h=n/o*g)/2:0<p&&0<n&&o/n<g/p&&(c=c+g/2-(f=o/n*p)/2),d.css(m,u+A+k+c+A).css(b,h+A+k+f+A);break;case 3:d.css(m,C+k+C).css(b,y+k+y)}},te.device=function(){var e,t,r,n,o=navigator.userAgent,i=o.match(/iPad/i);if(i)(e=i[0])&&(t="ipad"===e.toLowerCase());else if((i=o.match(/Macintosh/i))&&(e=i[0]))try{document.createEvent("TouchEvent"),t="macintosh"===e.toLowerCase()}catch(e){}return(i=o.match(/iPhone/i))&&(e=i[0])&&(r="iphone"===e.toLowerCase()),(i=o.match(/android/i))&&(e=i[0])&&(n="android"===e.toLowerCase()),{ipad:t,iphone:r,android:n}},te.sl=function(){var e=navigator.platform;return e&&-1<e.indexOf("Mac")},te.tl=function(e){if(e===C||e===E)return!1;var t=""+e;return t=g.Oa(t),!T(+(""===t.trim()?NaN:t))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(t)},te.ul=function(e,t,r,n,o){var i,a,s,l,u,c,h=E,f=!1;if(e&&((i=e.formatter)?(o?h=o:te.lHb(i)||(h=i,f=!0),typeof h==F&&m&&(h=new m(h))):h=e._autoFormatter),h&&!h.isAuto){a=E;try{if(a=h.parse(t),f&&a instanceof Date&&(s=(new m).getPreferredDisplayFormatter(t,o))&&(a=s.parse(t)),typeof a==_)return a}catch(e){}return a===C||a===E?t:a}if(r){if(l=void 0,l={},u=void 0,c=E,m)try{c=(new m).getPreferredDisplayFormatter(t,l)}catch(e){}return typeof(u=l.value)==_?t=u:te.tl(t)&&(u=l.value=t),n&&(n.value=c),u!==C&&u!==E?u:t}return t},te.vl=function(e){for(var t,r,n=y.body,o=e;o&&o.parentElement&&o.parentElement!==n;)o=o.parentElement;return t=1e3,o&&o.parentElement===n&&(r=N(w(o).css("z-index")),T(r)||(t+=r)),t},te.wl=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g;if(!e)return[];if(t=e.indexOf("("),r=e.lastIndexOf(")"),!(n=e.substring(t+1,r)))return[];for(o=[],a="",l=s=i=0;l<n.length;)s=n.indexOf("rgb",i),-1===(l=n.indexOf("rgb",i+1))&&(l=n.length),a=n.substring(s,l),o.push(a),i=l;for(u=[],c=0,h=o.length;c<h;c++)d=(f=o[c]).indexOf(")"),p=f.substring(0,d+1),g=x(f.substring(d+1,f.length)),T(g)&&(c===h-1?g=100:c<=1&&(g=0)),!p&&0===c||(g/=100,u.push({color:p,point:g}));return u},te.xl=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x=t._render,T=0,A=[r],k=t.zoom();for(n===M.AutoFitType.cellWithHeader&&(r===M.SheetArea.viewport?A.push(1):r===M.SheetArea.rowHeader&&A.push(0)),o=0;o<A.length;o++)for(i=0,a=A[o],s=t.getRowCount(a);0<=i&&i<s;)(l=t._modelManager.findSpan(i,e,a))&&(l.col<e||1<l.colCount||l.row<i)?i=l.row+l.rowCount:(0<t.getRowHeight(i,a)&&(c=0,(h=(u=t.getActualStyle(i,e,a)).cellType||t.Al(a))&&(f=u.font||x.Bl(),u.font=x.Cl(f),(p=!(!(d=t.rowFilter&&t.rowFilter())||!d.Dl(i,e,a)))||3!==a||(g=t.tables?t.tables.find(i,e):E)&&g.showHeader()&&g.headerIndex()===i&&g.rowFilter()&&g.filterButtonVisible(e-g.range().col)&&(p=!0),m=u.formatter?u.formatter:u._autoFormatter,b={sheet:t,row:i,col:e,sheetArea:a,quotePrefix:u.quotePrefix},y={},C=t.getValue(i,e,a,M.ValueType.richText),w=t.xHb(i,e,r),v=C&&C.richText?t.getText(i,e,a):I(w)?h.format(C,m,y,b):w,c=h.X4(C,v,u,k,b),p&&(S=D(k,1),c+=N(""+t.defaults.rowHeight*S,10))),T<c&&(T=c)),a===M.SheetArea.viewport?i=te.El(i,e,t,a):i++);return 0===T?T=t.defaults.colWidth:T+=R(3),R(T)},te.El=function(e,t,r,n){var o,i,a=-1,s=r.getRowCount(n);for(o=e+1;o<s;o++){if(r.getText(o,t,n)){a=o;break}if((i=r.getActualStyle(o,t,n))&&(i.cellType||i.cellButtons&&0<i.cellButtons.length)){a=o;break}}return a},te.Fl=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g=t._render,m=0,b=[r],y=t.zoom();for(1===n&&(3===r?b.push(2):1===r&&b.push(0)),o=0;o<b.length;o++)for(r=b[o],i=0,a=t.getColumnCount(r);0<=i&&i<a;)(s=t._modelManager.findSpan(e,i,r))&&(s.row<e||1<s.rowCount||s.col<i)?i=s.col+s.colCount:(0<t.getColumnWidth(i,r)&&(u=(l=t.getActualStyle(e,i,r)).font||g.Bl(),l.font=g.Cl(u),c=0,(h=t.getCellType(e,i,r))&&(f=t.getText(e,i,r),d=t.getValue(e,i,r,1),p={sheet:t,row:e,col:i,sheetArea:r},c=h.Y4(d,f,l,y,p)),m<c&&(m=c)),3===r?i=te.Gl(e,i,t,r):i++);return 0===m?m=t.defaults.rowHeight:m+=R(3),R(m)},te.Gl=function(e,t,r,n){var o,i,a=-1,s=r.getColumnCount(n);for(o=t+1;o<s;o++){if(r.getText(e,o,n)){a=o;break}if((i=r.getActualStyle(e,o,n))&&i.cellType){a=o;break}}return a},te.Il=function(e,t,r,n){var o,i,a,s,l,u,c,h,f;if(r&&(o=r.Jl,i=r.Kl,a=e.formatter?e.formatter:e._autoFormatter,s=n||{},m&&t!==E&&t!==C))if(l=void 0,a&&a.isAuto)l=typeof t==_,u=te.tl(t),!l&&u&&(t=g.Oa(t)),t=a.getPreferredEditingFormatter?a.getPreferredEditingFormatter(t).format(t):t;else if(typeof a!=F||te.lHb(a)||(a=new m(a)),a)try{t instanceof Date?((c=p&&p.Convert.Wh(t))&&(t=c),h=d.Common.CultureManager.q4().DateTimeFormat,f=d.Common.l.Ra(t),a=new m(!b.Lc(a.formatString(),["d","y"])&&0<=f&&f<1?h.longTimePattern:0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?h.shortDatePattern:h.shortDatePattern+k+h.longTimePattern),r.Ll=!0,t=a.format(t),s.formatter=a):typeof t==_&&(t=g.nb(""+t))}catch(e){t=r.getText(o,i)}else t=r.getText(o,i,3);return t!==E&&t!==C&&(t=te.bc(t)),t},te.yIc=function(e,t){var r,n,o=e,i=d.Common.CultureManager.q4(t).NumberFormat,a=d.Common.u,s=i&&i.percentSymbol;return!(!s||!e)&&("object"==typeof e&&e.formatCached&&(o=e.formatCached),"object"!=typeof o&&(r=!0,n=o,a.kb(o,s)?n=a.Fb(o,0,s.length):a.jb(o,s)?n=a.Fb(o,e.length-s.length,s.length):r=!1,a.Bb(n,s)&&(r=!1),r))},te._Va=function(e){var t,r=te.Ml.msie||te.Ml.edge,n=r&&f.MSPointerEvent&&1<(navigator.msMaxTouchPoints||0);return e?n:(t=r&&f.PointerEvent&&1<(navigator.maxTouchPoints||0),n||t)},te.K_a=function(e){return e&&e.richText&&0<e.richText.length?(e.text||(e=te.n0a(e)),e.text):e},te.n0a=function(e){var t,r,n;if(!e)return e;if((t=e.richText)&&0<t.length){for(r=[],n=0;n<t.length;n++)r.push(t[n].text?t[n].text:"");e.text=r.join("")}return e},te.lHb=function(e){return"string"==typeof e&&("="===e.charAt(0)||0<=e.indexOf("{{")&&0<=e.indexOf("}}"))},te.Pl=function(e,t,i,a){function r(e,t){var r,n,o=this;return o.hasOwnProperty("_ps")||(o._ps={}),r=o._ps,0===arguments.length?r[s]!==C?r[s]:l:(!1!==t&&a&&!a.call(o,e)||(n=r[s]!==C?r[s]:l)!==e&&(r[s]=e,!1!==t&&i&&i.call(o,e,n)),o)}var s=e,l=t;return r.isDefault=function(e){return e===l},r},te.Ql=function(e,o){var i={_ps:{}};return d.Common.j.H(e,function(e){var t,r,n;t=i,r=e,n=o,Object.defineProperty(t,r,{get:function(){return this._ps[r]},set:function(e){var t=this._ps[r];t!==e&&(this._ps[r]=e,n&&n(r,e,t))},enumerable:!0})}),i},te.Rl=function(e,t,r,n,o){var i,a=D(t,r),s=v(t,r),l=0;for(i=a;i<s&&(l+=n?e.Sl(i,3):e.Tl(i,3),!(o&&o<l));i++);return l},te.Z3=function(e,t){var r,n,o=0,i=0;return e!==t&&(r=w(e).offset(),n=w(t).offset(),o=r.left-n.left,i=r.top-n.top),{FB:i,EB:o}},te.bq=function(e,t,r){var n,o,i,a;if(!e||"string"!=typeof e)return!1;for(o=0;o<e.length;o++)if("*"===(n=e.charAt(o))||":"===n||"["===n||"]"===n||"?"===n||"\\"===n||"/"===n)return!1;if("'"===e.charAt(0)||"'"===e.charAt(e.length-1))return!1;if(!t)return!0;for(i=t.length,o=0;o<i;o++)if(r!==(a=t[o])&&e.toUpperCase()===a.name().toUpperCase())return!1;return!0},te.Ika=function(e,t,r){var n,o,i;if(!e)return e;for(n=0,o=e.length,i=[];n<o;)e[n]===t?i[n]=r:i[n]=e[n],n++;return i.join("")},te.tt=function(){var e,t,r,n=te;return n.ct||(r="-10000px",(t=(e=X("span")).style).visibility="hidden",t.top=r,t.left=r,t.position="absolute",e.setAttribute("gcUIElement","gcStringWidthSpan"),y.body.insertBefore(e,E),n.ct=e),n.ct},te.fp=function(e,t,r){var n,o,i,a=te,s=a.st;if(!t)if(s){if(r&&(s=s.CJKFontCache),n=s[e])return n}else s=a.st={CJKFontCache:{}},r&&(s=s.CJKFontCache);return(o=a.tt()).style.font=te.hZa(e),te.Ml&&te.Ml.safari&&(o.style.lineHeight="normal"),o.innerHTML=r?String.fromCharCode(20013):"H",i=o.offsetHeight,t||(s[e]=i),i},te.Pxb=function(e){var t,r,n=te,o=n.Qxb;if(o){if(o[e])return o[e]}else o=n.Qxb={};return(r=n.tt()).style.font=e,r.innerHTML="H",(t={}).fontFamily=r.style.fontFamily,t.fontSize=r.style.fontSize,t.fontStyle=r.style.fontStyle,t.fontWeight=r.style.fontWeight,o[e]=t},te.Voa=function(e,t){var r=te.tt();return r.style.font=te.hZa(t),te.Ml&&te.Ml.safari&&(r.style.lineHeight="normal"),r.innerHTML=i.Ob(e||"H"),r.offsetHeight},te.iZa=function(e){var t,r=te;return 0<=e.indexOf(n.FallbackFontFamily)?e:(e=e.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),(t=r.tt().style).font=e,t.fontFamily=[].concat(t.fontFamily.split(","),n.FallbackFontFamily.split(",")).join(","),t.font)},te.hZa=function(e){var t,r=te;return e&&r.jZa?(t=(t=r.kZa)||(r.kZa={}))[e]||(t[e]=r.iZa(e)):e},te.lZa=function(e,t){t&&(t=te.hZa(t),e.font!==t&&(e.font=t))},te.pL=function(e,t,r){return!t||I(r)?0:(te.lZa(e,t),e.measureText(r).width)},te.no=function(){var e=te,t=e.ct;t&&(w(t).remove(),e.ct=C),e.st=C,e.Qxb=C,te._0&&(te._0=C),e.kZa=C},te.Woa=function(e){var t,r=te._0;return r=r||(te._0=X("div")),t=e.innerHTML,r.innerHTML=t,r.innerText},te.G$a=function(e){return e&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(e)&&!(-1!==["C","c","R","r"].indexOf(e)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(e)||/^[Rr]\d*[Cc]\d*$/.test(e)||255<=e.length)},te.T$a=function(e){e&&(e.j_a(!0),e.initExpression(),e.k_a())},te.l_a=function(e){var t,r,n=0,o=0,i=e.length;for(0<i&&(n=e[0].row,o=e[0].col),t=1;t<i;t++)n>(r=e[t]).row&&(n=r.row),o>r.col&&(o=r.col);return{r:n=n<0?0:n,c:o=o<0?0:o}},te.w0a=function(e){var t;return typeof e==F&&"/"===e.charAt(0)?(t=void 0,u.test(e)?(t=e.match(u),d.Common.l.Xb(x(t[1]))):l.test(e)?(t=e.match(l),new Date(x(t[1]))):e):e},te.x0a=function(e){return!I(e)&&d.Common.l.Ska(e)?d.Common.l.Daa(e):e},te.yHb=function(e,t){var r,n,o=e.getImageData(t.x,t.y,t.width,t.height),i=o.data;for(r=0;r<i.length-4;r+=4)n=s((30*i[r]+59*i[r+1]+11*i[r+2]+50)/100),i[r]=n,i[r+1]=n,i[r+2]=n;e.putImageData(o,t.x,t.y)},te.ZGb=/[\u0600-\u06FF\u0750-\u077F]/,te.nl=Q,te.rl=te.device,te.Ml=(z=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}(V=navigator.userAgent),q={version:C,chrome:C,webkit:C,safari:C,mozilla:C,msie:C,metroMode:C,edge:C},z.browser&&(q[z.browser]=!0,q.version=z.version),q.chrome?q.webkit=!0:q.webkit&&(q.safari=!0),0<=V.indexOf("PhantomJS")&&(q.safari=!1,q.chrome=!0),(Z=V.toLowerCase()).indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(Z)!==E&&(q.mozilla=C,q.msie=!0),(Y=/Edge\/\d+/.exec(V))!==E&&0<Y.length&&(q.webkit=C,q.chrome=C,q.msie=!0,q.edge=!0,q.version=Y[0].substr(Y[0].indexOf("/")+1)),q.msie&&function(){var e=E,t=!1;try{new ActiveXObject("")}catch(t){e=t.name}try{t=!!new ActiveXObject("htmlfile")}catch(e){t=!1}return!(t="ReferenceError"===e||!1!==t)}()&&(q.metroMode=!0),q),te.browser=te.Ml,te.Nl=X,te.Ol=K,te.uWa=$,te.jZa=te.sl(),te.Fxb=function(e){return!1},L=te,n.util=L,n.Ul=L,O=L.pL,ee.Wl=function(e){return!(ee.Xl()!==e||!e._eventHandler||!e._eventHandler.YH)},ee.Xl=function(){return f&&f.Yl&&f.Yl.activeElement},ee.kmb=function(n){var o,i,a,e,t,r,s;function l(e){var t,r;for(t=0;t<=2;t++)(r=e.call(o,t))&&0!==r.width&&0!==r.height&&(n.$l=!0,i._l(a,r))}if(n&&!ee.Wl(n)&&n.parent&&n.parent.options.hideSelection){for(o=n.am(),i=n._render,a=i.bm(),e=n.getSelections(),r=t=void 0,t=0;t<e.length;t++)s=e[t],0<=(r=n.cm(s)).width&&0<=r.height&&(r.x-=9,r.y-=9,r.width+=18,r.height+=30,i.dm(r));r=o.em(),n.$l=!0,i._l(a,r),l(o.fm),l(o.gm)}},ee.Zl=function(e,t){var r=qe&&qe._legacyWynbi&&qe._legacyWynbi.spreadChartEditState&&qe._legacyWynbi.spreadChartEditState.pivotTableManager,n=r&&r.getPivotTableBySheet(e),o=ee.Xl();n&&o&&o._formulaTextBox||(f.Yl.activeElement=e)===o||t||(o&&(o.endEdit(),ee.kmb(o),o.hm&&o.hm()),e&&e._render.im())},c=ee,n.Vl=c,pe.prototype.rm=function(){var e="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",t="span."+e.split(k).join(".");return B.vm?w(y).find(t).length<=0&&J(B.vm):B.vm=re(e),B.vm},pe.prototype.sm=function(){var e="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",t="span."+e.split(k).join(".");return B.wm?w(y).find(t).length<=0&&J(B.wm):B.wm=re(e),B.wm},pe.prototype.tm=function(){var e="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",t="span."+e.split(k).join(".");return B.xm?w(y).find(t).length<=0&&J(B.xm):B.xm=re(e),B.xm},pe.prototype.um=function(){var e="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",t="span."+e.split(k).join(".");return B.ym?w(y).find(t).length<=0&&J(B.ym):B.ym=re(e),B.ym},pe.prototype.zm=function(){var e="gcDummyElement";return B.Am?w(y).find("#"+e).length<=0&&J(B.Am):B.Am=re("gc-theme-version",e),B.Am},pe.prototype.qm=function(){B.rm(),B.sm(),B.tm(),B.um()},pe.prototype.ad=function(){var e,i,a=this;function r(e){var t,r,n,o=c.Xl();if(o&&(t=B.Bm(e.target),r=o._formulaTextBox&&o._formulaTextBox._isSelectMode,a.km.forEach(function(e){e&&e(o,t)}),!t||function(e,t){var r,n;if(!(qe&&qe._legacyWynbi&&qe._legacyWynbi.spreadChartEditState&&qe._legacyWynbi.spreadChartEditState.enableReferenceCrossSpread)){for(r=!1,n=e;n;){if("gcSpread"===w(n).attr("gcUIElement")){r=t.zo()!==n;break}n=n.parentElement}return r}}(t,o)))if(o._endEditImp(C,C,r))i&&(n=o._eventHandler)&&n.Cm&&n.Cm(),c.Zl(E);else if(e.cancelable)return!1}function t(e){var t=e.pointerType;t!==e.MSPOINTER_TYPE_TOUCH&&"touch"!==t||r(e)}a.jm=0,ne(f,"keydown",ie,!0),ne(f,"keyup",ae,!0),ne(f,"compositionstart",se,!0),ne(f,"selectstart",ue,!0),e=L.rl(),i=e.ipad||e.iphone,L.browser.safari&&!i&&ne(f,"textInput",le,!0),L._Va()?(w(y).bind("MSPointerDown",t),w(y).bind("pointerdown",t)):w(y).bind("touchstart",r),ne(y,"mousedown",function(e){!1===r(e)&&Q(e)},!0),w(y).bind("DOMContentLoaded",function(){B.qm()})},pe.prototype.Bm=function(e){for(var t=e;t&&"BODY"!==t.tagName&&"function"==typeof t.getAttribute;){if(t.getAttribute("gcUIElement")||t.gcUIElement)return t;t=t.parentNode}return E},pe.prototype.Dm=function(e,t){var r,n,o,i,a=B.rm();return e===M.VisualState.highlight||e===M.VisualState.selected?a=B.um():e===M.VisualState.hover&&(a=B.tm()),r=a.className,w(a).removeClass(r).addClass(t),o={backgroundColor:(n=oe(a)).backgroundColor,backgroundImage:n.backgroundImage},w(a).addClass(r),(i={backgroundColor:(n=oe(a)).backgroundColor,backgroundImage:n.backgroundImage,color:n.color,zIndex:n.zIndex}).borderLeftColor=n.borderLeftColor,i.borderRightColor=n.borderRightColor,i.borderBottomColor=n.borderBottomColor,i.borderBottomWidth=n.borderBottomWidth,i.borderTopColor=n.borderTopColor,i.borderRightWidth=n.borderRightWidth,i.backgroundImage===o.backgroundImage&&i.backgroundColor!==o.backgroundColor&&(i.backgroundImage=C),w(a).removeClass(t),i},pe.prototype.Em=function(e){var t,r=B.zm();return w(r).removeClass(r.className).addClass("gc-theme-version "+e),t=oe(r),o({},t)},pe.prototype.Fm=function(e){var t,r=B.sm();return w(r).removeClass(r.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+e),t=oe(r),o({},t)},pe.prototype.Gm=function(){f.Yl.jm++},pe.prototype.Hm=function(){var e=f.Yl;e.jm--,e.jm<0&&(e.jm=0)},B=pe.prototype,f.Yl||(f.Yl=new pe),de.Jm=function(e){return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"}[e]||""},de.Km=function(e,t){var r=de.Jm(e)+t,n=de.styleCache;return n[r]||(n[r]=B.Dm(e,t)),n[r]},de.Lm=function(e){var t=e,r=de.styleCache;return r[t]||(r[t]=B.Em(e)),r[t]},de.Mm=function(e){var t="content"+e,r=de.styleCache;return r[t]||(r[t]=B.Fm(e)),r[t]},de._ob=function(e,t){var r=e.Pm;return r&&r.getColor&&(t=r.getColor(t)),t},de.Nm=function(){de.styleCache={}},de.styleCache={},n.Im=de,fe.prototype.clone=function(){return new fe(this.x,this.y)},n.Point=fe,he.prototype.intersect=function(e,t,r,n){var o=this;return e<o.x+o.width&&o.x<e+r&&t<o.y+o.height&&o.y<t+n},he.prototype.intersectRect=function(e){return this.intersect(e.x,e.y,e.width,e.height)},he.prototype.contains=function(e,t){var r=this;return r.x<e&&e<r.x+r.width&&r.y<t&&t<r.y+r.height},he.prototype.containsRect=function(e){return this.contains(e.x,e.y)&&this.contains(e.x+e.width,e.y+e.height)},he.prototype.getIntersectRect=function(e){return this.getIntersect(e.x,e.y,e.width,e.height)},he.prototype.getIntersect=function(e,t,r,n){var o=this,i=o.x,a=o.y,s=o.x+o.width,l=o.y+o.height,u=t,c=e+r,h=t+n,f=v(i,e),d=v(a,u),p=D(s,c)-f,g=D(l,h)-d;return 0<p&&0<g?new he(f,d,p,g):E},he.prototype.round=function(){var e=this;e.x=s(e.x),e.y=s(e.y),e.width=R(e.width),e.height=R(e.height)},he.prototype.clone=function(){return new he(this.x,this.y,this.width,this.height)},n.Rect=he,ce.prototype.intersect=function(e,t,r,n){var o=this;return(-1===e||-1===o.row||o.row<e+r&&e<o.row+o.rowCount)&&(-1===t||-1===o.col||o.col<t+n&&t<o.col+o.colCount)},ce.prototype.getIntersect=function(e,t,r){var n,o,i,a,s,l,u,c,h=this;return e&&h.intersect(e.row,e.col,e.rowCount,e.colCount)?(n=-1===h.col?r-1:h.col+h.colCount-1,o=-1===e.col?r-1:e.col+e.colCount-1,i=-1===h.row?t-1:h.row+h.rowCount-1,a=-1===e.row?t-1:e.row+e.rowCount-1,s=v(h.col,e.col),l=D(n,o),u=v(h.row,e.row),c=D(i,a),new ce(u,s,-1===u?-1:c-u+1,-1===s?-1:l-s+1)):E},ce.prototype.contains=function(e,t,r,n){var o=this,i=arguments.length,a=!1;return 2!==i&&4!==i||(2===i&&(n=r=1),a=(-1===o.row||o.row<=e&&e+r<=o.row+o.rowCount)&&(-1===o.col||o.col<=t&&t+n<=o.col+o.colCount)),a},ce.prototype.containsRange=function(e){return this.contains(e.row,e.col,e.rowCount,e.colCount)},ce.prototype.offset=function(e,t){var r=this.col,n=this.row;return-1!==r&&(r+=e),-1!==n&&(n+=t),new ce(n,r,this.rowCount,this.colCount)},ce.prototype.union=function(e){return ge(this,e)},ce.prototype.equals=function(e){return e instanceof ce&&this.row===e.row&&this.col===e.col&&this.rowCount===e.rowCount&&this.colCount===e.colCount},j=ce,n.Range=j,n.kf=function(e,t,r,n){return new j(e,t,r,n)},n.getUnionRange=ge,Ce.Om=function(e,t){if(e&&t){var r=e.Pm;if(r)return r.getColor(t)}return t},Ce.Qm=function(e,t){if(e&&t){var r=e.Pm;return r?r.getFont(t):t}return E},n.Rm=Ce,ye.ValidationError="ValidationError",ye.CellClick="CellClick",ye.CellDoubleClick="CellDoubleClick",ye.ColumnChanging="ColumnChanging",ye.RowChanging="RowChanging",ye.EnterCell="EnterCell",ye.LeaveCell="LeaveCell",ye.ValueChanged="ValueChanged",ye.TopRowChanged="TopRowChanged",ye.SheetChanging="SheetChanging",ye.SheetChanged="SheetChanged",ye.LeftColumnChanged="LeftColumnChanged",ye.InvalidOperation="InvalidOperation",ye.RangeFiltering="RangeFiltering",ye.RangeFiltered="RangeFiltered",ye.RangeFilterClearing="RangeFilterClearing",ye.TableFilterClearing="TableFilterClearing",ye.RangeFilterCleared="RangeFilterCleared",ye.TableFilterCleared="TableFilterCleared",ye.TableFiltering="TableFiltering",ye.TableFiltered="TableFiltered",ye.RangeSorting="RangeSorting",ye.RangeSorted="RangeSorted",ye.ClipboardChanging="ClipboardChanging",ye.ClipboardChanged="ClipboardChanged",ye.ClipboardPasting="ClipboardPasting",ye.ClipboardPasted="ClipboardPasted",ye.ColumnWidthChanging="ColumnWidthChanging",ye.ColumnWidthChanged="ColumnWidthChanged",ye.RowHeightChanging="RowHeightChanging",ye.RowHeightChanged="RowHeightChanged",ye.DragDropBlock="DragDropBlock",ye.DragDropBlockCompleted="DragDropBlockCompleted",ye.DragFillBlock="DragFillBlock",ye.DragFillBlockCompleted="DragFillBlockCompleted",ye.EditStarting="EditStarting",ye.EditStarted="EditStarted",ye.EditChange="EditChange",ye.EditEnding="EditEnding",ye.EditEnd="EditEnd",ye.EditEnded="EditEnded",ye.RangeGroupStateChanging="RangeGroupStateChanging",ye.RangeGroupStateChanged="RangeGroupStateChanged",ye.SelectionChanging="SelectionChanging",ye.SelectionChanged="SelectionChanged",ye.SheetTabClick="SheetTabClick",ye.SheetTabDoubleClick="SheetTabDoubleClick",ye.SheetNameChanging="SheetNameChanging",ye.SheetNameChanged="SheetNameChanged",ye.ViewZooming="ViewZooming",ye.ViewZoomed="ViewZoomed",ye.UserZooming="UserZooming",ye.UserFormulaEntered="UserFormulaEntered",ye.CellChanged="CellChanged",ye.ColumnChanged="ColumnChanged",ye.RowChanged="RowChanged",ye.ActiveSheetChanging="ActiveSheetChanging",ye.ActiveSheetChanged="ActiveSheetChanged",ye.SparklineChanged="SparklineChanged",ye.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",ye.RangeChanged="RangeChanged",ye.ButtonClicked="ButtonClicked",ye.EditorStatusChanged="EditorStatusChanged",ye.FloatingObjectChanged="FloatingObjectChanged",ye.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",ye.ShapeChanged="ShapeChanged",ye.ShapeSelectionChanged="ShapeSelectionChanged",ye.PictureChanged="PictureChanged",ye.FloatingObjectRemoving="FloatingObjectRemoving",ye.ShapeRemoving="ShapeRemoving",ye.FloatingObjectRemoved="FloatingObjectRemoved",ye.ShapeRemoved="ShapeRemoved",ye.PictureSelectionChanged="PictureSelectionChanged",ye.FloatingObjectLoaded="FloatingObjectLoaded",ye.TouchToolStripOpening="TouchToolStripOpening",ye.CommentChanged="CommentChanged",ye.CommentRemoving="CommentRemoving",ye.CommentRemoved="CommentRemoved",ye.SlicerChanged="SlicerChanged",ye.BeforeDragDrop="BeforeDragDrop",ye.FormulatextboxActiveSheetChanging="FormulatextboxActiveSheetChanging",ye.FormulatextboxActiveSheetChanged="FormulatextboxActiveSheetChanged",ye.FormulatextboxEditStarted="FormulatextboxEditStarted",ye.FormulatextboxEnterCell="FormulatextboxEnterCell",ye.FormulatextboxEditEnded="FormulatextboxEditEnded",ye.FormulatextboxRangeChanged="FormulatextboxRangeChanged",ye.SheetMoving="SheetMoving",ye.SheetMoved="SheetMoved",ye.DragMerging="DragMerging",ye.DragMerged="DragMerged",ye.ChartClicked="ChartClicked",ye.FloatingElementSelected="FloatingElementSelected",ye.BeforePrint="BeforePrint",ye.TableResizing="TableResizing",ye.TableResized="TableResized",ye.TableRowsChanged="TableRowsChanged",ye.TableColumnsChanged="TableColumnsChanged",ye.DropdownSpreadMouseClick="DropdownSpreadMouseClick",ye.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",n.Events=ye,be.prototype.no=function(){this.kj=E},be.prototype.Sm=function(e,t,r){var n,o=this.Tm,i=e<<4+t;return o?((n=o[i])||(n=r(),o[i]=n),n):r()},be.prototype.Um=function(e,t){var r,n=this.Vm;return n&&(r=n[e])?r[t]:E},be.prototype.Wm=function(e,t,r,n){var o=this.Vm;o&&(o[e]||(o[e]={}),o[e][t]={d:r,i:n})},be.prototype.zHb=function(e,t,r,n,o){var i,a=this.kj;return r===C&&(r=3),i=a.xHb(e,t,r),I(i)?!I(o)&&L.lHb(o.formatter)?H.vn(a,o,this.ge(e,t,r,0),{},{row:e,col:t,sheet:a}):this.ge(e,t,r,n):i},be.prototype.ge=function(e,t,r,n){var o,i,a,s=this.kj,l=this.Xm;return r===C&&(r=3),l?((o=l[r])||(o={},l[r]=o),(i=o[e])||(i={},o[e]=i),(a=i[t])===C&&(a=s.getValue(e,t,r,n),i[t]=a),a):s.getValue(e,t,r,n)},be.prototype.Ym=function(e,t,r){var n,o,i,a=this.kj,s=this.Zm;return r===C&&(r=3),s?((n=s[r])||(n={},s[r]=n),(o=n[e])||(o={},n[e]=o),(i=o[t])||(i=a.AHb(e,t,r,!1,!0),o[t]=i),i.clone(!0)):a.AHb(e,t,r,!1,!1)},be.prototype.Sl=function(e){var t,r=this.kj,n=this.$m;return n?((t=n[e])===C&&(t=n[e]=r.Sl(e)),t):r.Sl(e)},be.prototype._m=function(e){var t,r=this.kj,n=this.an;return n?((t=n[e])===C&&(t=n[e]=r.Tl(e)),t):r.Tl(e)},be.prototype.bn=function(e){return this.Xm?(this.cn||(this.cn=e()),this.cn):e()},be.prototype.dn=function(e){return this.Xm?(this.gn||(this.gn=e()),this.gn):e()},be.prototype.hn=function(){this.in=!0,this.Tm={},this.Vm={},this.Xm={},this.Zm={},this.$m={},this.an={}},be.prototype.jn=function(){this.in=!1},be.prototype.kn=function(){this.in=!1,this.Tm=E,this.Vm=E,this.Xm=E,this.Zm=E,this.an=E,this.$m=E,this.cn=E,this.gn=E},n.ln=be,me.qn=function(e,t,r,n,o){var i,a,s,l;if(me.nn=!0,(i=e.tables)&&i.rn(t,r,n-t+1,o-r+1))for(a=-1,s=me.sn=[],l=0;l<=n;l++)e.getRowVisible(l)?(a++,s[l]=a):s[l]=-1},me.Nm=function(){me.sn=E,me.nn=!1},me.tn=function(e){var t=me.on;return t[e]||(t[e]=m?new m(e):E),t[e]},me.un=function(e,t,r){var n,o,i,a,s,l,u=me.pn,c=e+"_"+typeof e;return m?(u[t]||(u[t]={}),(o=(n=u[t])[c])?(r&&(r.conditionalForeColor=r.value=o.color,r.content=h(o.content)),o.text):((i=me.on)[t]||(i[t]=new m(t)),a={},s=i[t].format(e,a),(l=n[c]={}).text=s,l.color=a.conditionalForeColor,l.content=a.content,r&&(r.conditionalForeColor=r.value=a.conditionalForeColor,r.content=h(a.content)),s)):""+e},me.vn=function(e,t,r,n,o){var i,a;return r&&"SparklineExValue"===r.typeName?"":(i=t.cellType||e.Al(),a=t.formatter||t._autoFormatter,i.format(r,a,n,o))},me.wn=function(){me.on={},me.pn={}},me.nn=!1,me.on={},me.pn={},me.sn=[],H=me,n.mn=H,ve.Cn=function(e,t,r){var n=we(e);n.scaleX=t,n.scaleY=r,n.translateX=n.orgTranslateX*t,n.translateY=n.orgTranslateY*r,e.setTransform(n.scaleX,n.skewX,n.skewY,n.scaleY,n.translateX,n.translateY)},ve.Dn=function(e,t,r){var n=we(e);n.orgTranslateX+=t,n.orgTranslateY+=r,n.translateX=n.orgTranslateX*n.scaleX,n.translateY=n.orgTranslateY*n.scaleY,e.setTransform(n.scaleX,n.skewX,n.skewY,n.scaleY,n.translateX,n.translateY)},G=ve,n.Bn=G,U=G,Te.npb=function(){var e=f.screen,t=e.deviceXDPI,r=f.devicePixelRatio||(t?t/e.logicalXDPI:1),n=20*r,o=S(n);return.82<o-n?o/20:S(100*r)/100},Te.Kn=function(e,t,r){var n,o,i,a,s,l,u,c,h=Te;if(Se(e,1),xe(e,1),(1!==(n=Te.npb())||1!==h.dpr)&&(h.dpr=n,o=t||r&&r.parent)){for(i=h.Fn,a=void 0,s=0;s<i.length;s++)if(o===i[s].workbook){a=i[s];break}if(a||(a={workbook:o,sheets:[],canvases:[]},i.push(a)),t)a.canvases.push(e);else{for(l=void 0,u=a.sheets,c=0;c<u.length;c++)if(u[c].sheet===r){l=u[c];break}l||(l={sheet:r,canvases:[]},u.push(l)),l.canvases.push(e)}}},Te.Ln=function(e){return e&&e.Gn||1},Te.Mn=function(e){return e&&e.Hn||1},Te.Nn=function(e){return e.In},Te.On=function(e){return e.Jn},Te.Pn=function(e,t,r){var n,o,i,a,s,l=Te,u=l.dpr,c=l.Ln(e),h=l.Mn(e);s=t,e.In=s,a=r,e.Jn=a,1===u&&1===c&&1===h?(e.width=t,e.height=r):(n=e.getContext("2d"),U.Cn(n,1,1),L.Ml.mozilla?(e.width=R(t*u),e.height=R(r*u)):(e.width=S(t*u),e.height=S(r*u)),e.style.width=t+A,e.style.height=r+A,o=e.width/t,i=e.height/r,o===c&&i===h||(Se(e,o),xe(e,i)),U.Cn(n,o,i))},Te.Qn=function(e,t){var r,n,o,i,a,s=Te.Fn,l=e.parent;for(o=0;o<s.length;o++)if(!l||s[o].workbook===l)for(r=s[o].sheets,i=0;i<r.length;i++)if(r[i].sheet===e){for(n=r[i].canvases,a=0;a<n.length;a++)if(n[a]===t){n.splice(a,1);break}break}},Te.Rn=function(e,t){var r,n,o,i=Te.Fn;for(n=0;n<i.length;n++)if(i[n].workbook===e)for(r=i[n].canvases,o=0;o<r.length;o++)if(r[o]===t){r.splice(o,1);break}},Te.Sn=function(e){var t,r,n,o=Te.Fn,i=e.parent;for(r=0;r<o.length;r++)if(!i||o[r].workbook===i){for(t=o[r].sheets,n=0;n<t.length;n++)t[n].sheet===e&&t.splice(n,1);return}},Te.Tn=function(e){var t,r=Te.Fn;for(t=0;t<r.length;t++)if(r[t].workbook===e)return void r.splice(t,1)},Te.Un=function(){var e,t,r,n,o,i,a,s,l=Te,u=l.npb();if(l.dpr!==u)for(e=l.Fn,o=n=r=t=void 0,l.dpr=u,i=0;i<e.length;i++){for(n=(r=e[i]).canvases,t=r.sheets,a=0;a<t.length;a++)n=n.concat(t[a].canvases);for(s=0;s<n.length;s++)o=n[s],l.Pn(o,l.Nn(o),l.On(o))}},Te.dpr=1,Te.Fn=[],n.En=Te,Oe.Wn=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g=[];if(!e||0===e.length)return g;if(!(i=o||Ae()))return g;if(L.lZa(i,r),a=L.fp(r),t<=0){for(s=-1,l=!0,u=0;u<e.length;u++)(c=e.charAt(u))===k||l?c!==k&&l&&(s=n?a:O(i,i.font,c),l=!1):s=D(s,n?a:O(i,i.font,c));if((t=s)<=0)return[e]}for(h=e.split(/\r\n|\r|\n/),f=0;f<h.length;f++)if(d=De(h[f],t,n,a,i))if(0===d.length)g.push("");else for(p=0;p<d.length;p++)g.push(d[p]);return g},Oe.oV=function(e,t,r,n,o){var i,a,s,l,u=[];if(0===t.length)return u;if(n)u=Oe.Wn(t,o,r,!0);else for(i=t.split(/\r\n|\r|\n/),a=0;a<i.length;a++){for(s=[],l=0;l<i[a].length;l++)s.push(i[a][l]);u.push(s)}return u},Oe.M_a=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d=[];if(0===e.length)return d;if(!(a=i||Ae()))return d;if(t<=0&&(t=function(e,t,r,n){var o,i,a,s,l,u=-1,c=!0;for(o=0;o<t.length;o++)if(!I(t[o].text))for(i=0;i<t[o].text.length;i++)a=t[o].text.charAt(i),s=t[o].style?t[o].style.font:r,L.lZa(e,s),l=L.fp(s),a===k||c?a!==k&&c&&(u=n?l:O(e,r,a),c=!1):u=D(u,n?l:O(e,r,a));return u}(a,n,r,o))<=0){for(l=[],s=0;s<n.length;s++)I(n[s].text)||l.push({textLength:Oe.R_a([n[s]],r,1,o,!1,a),text:n[s].text,textInfos:[n[s]]});return l}for(u=Oe.N_a(e),c=Oe.O_a(u,Oe.P_a(n)),s=0;s<c.length;s++)if(h=Ne(c[s],t,r,o,a))if(0===h.length)d.push("");else for(f=0;f<h.length;f++)d.push(h[f]);return d},Oe.N_a=function(e){var t,r=[],n=e.split(/\r\n|\r|\n/);for(t=0;t<n.length;t++)r.push(ke(n[t]));return r},Oe.O_a=function(e,t){var r,n,o,i,a,s,l=[],u=0,c=0;for(r=0;r<e.length;r++){for(n=[],o=0;o<e[r].length&&u<t.length;o++)if((i=e[r][o]).length<=t[u].text.length-c)n.push([{style:t[u].style,text:i}]),c+=i.length;else{for((a=[]).push({style:t[u].style,text:t[u].text.substring(c)}),s=i.length-(t[u].text.length-c),u++;u<t.length;u++){if(s<t[u].text.length){a.push({style:t[u].style,text:i.substring(i.length-s)}),c=s;break}if(s===t[u].text.length){a.push({style:t[u].style,text:i.substring(i.length-s)}),u++,c=0;break}a.push({style:t[u].style,text:t[u].text}),s-=t[u].text.length}n.push(a)}l.push(n)}return l},Oe.Xn=function(e,t,r,n){var o,i=n||Ae();return i?(t&&L.lZa(i,t),o=r?Me(e):e,O(i,i.font,o)):0},Oe.P_a=function(e){var t,r=[];for(t=0;t<e.length;t++)r.push({style:e[t].style,text:e[t].text?e[t].text.replace(/\r\n|\r|\n/g,""):e[t].text});return r},Oe.R_a=function(e,t,r,n,o,i){var a,s,l,u,c,h=i||Ae();if(!h)return 0;for(s=a=0;s<e.length;s++)l=e[s].style&&e[s].style.font?e[s].style.font:t,L.lZa(h,l),u=s===e.length-1&&o?Me(e[s].text):e[s].text,c=0,n?c=L.fp(l)*u.length/r:I(e[s].text)||(c=O(h,h.font,e[s].text)/r),e[s].style&&e[s].style.vertAlign&&(c*=.7),a+=c;return a},Oe.mHb=function(e,t,r,n,o,i,a,s){var l=0,u=L.fp(i),c=Oe.Wn(o,(a-4-u*n)/r,i),h=c.length,f=u*r;return l=u/r*(h-1),(l+=Oe.Xn(c[0],i)/2*n+f)+(Oe.Xn(c[h-1],i)/2*n+f)},Oe.Rvb=function(e){return Me(e)},Oe.bm=function(){return Ae()},W=Oe,n.Vn=W,n.Zn=function(l){l.$n=function(e,t){var r,n;for(l._features||(l._features=[]),l._fc={},r=l._features,t.name=e,t.priority=t.priority||5e3,n=0;;n++)if(n>=r.length||t.priority>r[n].priority){r.splice(n,0,t);break}},l.ao=function(e,t,r,n){var o,i,a,s=l._features;if(s){if(!(o=l._fc[t]))for(o=l._fc[t]=[],i=0;i<s.length;i++)(a=s[i][t])&&o.push(a);for(i=0;i<o.length&&(o[i].call(e,r),!n||!n());i++);}}},Le.prototype.get=function(e,t){var r=this.JTa[e];return r?r[t]:C},Le.prototype.set=function(e,t,r){var n=this.JTa[e];(n=n||(this.JTa[e]={}))[t]=r},n.KTa=Le,Pe.processBackspaceAndLeftArrowKeyEvent=function(e,t){var r,n,o,i,a,s,l,u,c,h=f.getSelection();if(!(h.rangeCount<=0)){if(r=h.anchorNode,n=h.anchorOffset,o=e.target,L.browser.msie&&!L.browser.edge&&t&&function(e,t,r){if(1===t&&Be(r.firstChild)&&Be(r.firstChild.firstChild)){var n=r.firstChild.firstChild.lastChild,o=void 0;if(e===r)return 1===(o=n.textContent).length&&o[0]!==P&&je(n.previousSibling);if(n===e||je(n)&&e===n.previousSibling)return 1===(o=e.textContent).length&&o[0]!==P&&je(e.previousSibling)}}(r,n,o))return i=(parseFloat(L.browser.version)<10?function e(t,r,n,o,i,a){var s,l,u,c,h,f="",d=t.childNodes,p=d.length;for(s=0;s<p;s++)Be(l=d[s])?f+=e(l,r,n,o,i,a):He(l)?(u=r&&r.startContainer,c=r&&r.endContainer,h=l.textContent,l===u||l===c?u!==c?a=l===u?(f+=We(h,n,h.length,i),!0):(f+=We(h,0,o,""),!1):f+=We(h,n,o,i):a||(f+=h)):je(l)&&!a&&(f+="\n");return f}(o):o.innerText).slice(0,-1),o.innerHTML=i.replace(/\r/g,"").replace(/\n/g,"<br>"),h.selectAllChildren(o),0<h.rangeCount&&h.collapseToEnd(),void Q(e);if((a=function(e,t){var r,n,o,i,a,s=e.childNodes.length;if(!Ve(e.textContent[0])||0!==t&&1!==t)if(0===t)(n=e)===e.parentNode.firstChild&&(n=e.parentNode),o=ze(n,Ge),r=o&&o.lastChild;else{if(function(e){return e&&"DIV"===e.tagName}(e))return 1===s&&1===t?r=e.firstChild.firstChild.lastChild:1<s&&t===s&&(r=e.lastChild),Ue(r)?{zeroWidthCharNode:r,previousTextNode:r.previousSibling.previousSibling}:Ge(r)?{zeroWidthCharNode:r,previousTextNode:ze(n,He)}:E;!Be(e)||t!==s&&t!==s-1||(Ge(e)?r=e:Ge(e.lastChild)&&(r=e.lastChild))}else r=e;return r?(Be(r)?n=r:He(r)&&(i=r.previousSibling,a=r.parentNode,n=i===a.firstChild?a:i),{zeroWidthCharNode:r,previousTextNode:ze(n,He)}):E}(r,n))&&a.zeroWidthCharNode){if(s=a.zeroWidthCharNode,l=a.previousTextNode,t)if(Be(s))s.parentNode.removeChild(s);else{if(s.parentNode.removeChild(s.previousSibling),je(l))return void Q(e);(u=h.getRangeAt(0)).setStart(s,0),u.setEnd(s,1),u.deleteContents()}(c=y.createRange()).setStartAfter(l),c.setEndAfter(l),c.collapse(!1),h.removeAllRanges(),h.addRange(c),Q(e)}}},Pe.processDeleteAndRightArrowKeyEvent=function(e,t){var r,n,o,i,a,s=f.getSelection();s.rangeCount<=0||(r=function(e){var t,r,n=e.anchorNode,o=e.anchorOffset,i=n.textContent.length;if(o!==i)return E;if(t=function(e){for(var t,r=e;r;){if(t=r.parentNode,r!==t.lastChild)return r.nextSibling;r=t}return E}(n),r=void 0,!t)return E;if(Be(t)&&Ve(t.textContent[0])){for(;Be(t.firstChild);)t=t.firstChild;r=t.childNodes[1]}else je(t)&&Ve(t.nextSibling.textContent[0])&&(r=t.nextSibling);return{node:r,offset:1}}(s))&&r.node&&(n=r.node,o=r.offset,t?((i=s.getRangeAt(0)).setStart(n,0),i.setEnd(n,1),i.deleteContents(),n.parentNode.removeChild(n.previousSibling)):((a=y.createRange()).setStart(n,o),a.setEnd(n,o),a.collapse(!1),s.removeAllRanges(),s.addRange(a)),Q(e))},n.uHb=Pe,n.Rxb={touch:!1}},"./dist/core/util/domUtil.js":function(e,t,r){"use strict";var n,o,g,f,m,s,h,d,p,l,u,c,b,y,C,a,w,v,S,x,T,A,k,i,M;function I(e,t){var r,n;for(Array.call(this),"string"==typeof e?r=(t||h).querySelectorAll(e):e&&(r=o.Ca(e)||e instanceof HTMLCollection?e:[e]),n=0;r&&n<r.length;n++)this.push(r[n])}function E(e){return k.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}function R(e,t){var r=e.nodeName;return r&&r.toLowerCase()===t.toLowerCase()}function D(e,t){return 0<="top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(e)&&isFinite(t)?(0<="width height".split(" ").indexOf(e)&&t<0&&(t=0),t+"px"):t}function N(e,t,r){var n,o,i=e.nodeType;if(e&&3!==i&&8!==i&&2!==i)return 1!==i&&(o=w[t=a[t]||t]),H(r)?o&&"get"in o&&(n=o.get(e,t))!==m?n:e[t]:o&&"set"in o&&!H(n=o.set(e,r,t))?n:e[t]=r}function F(e){var t,r,n,o=e.nodeType;return(!o||1===o||9===o)&&(t={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},!(n=(r=e.nodeName)&&t[r.toLowerCase()])||!0!==n&&e.getAttribute("classid")===n)}function _(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function P(e,t,r,n){if(F(e)){var o,i,a=x,s=B(t),l=e.nodeType,u=l?S:e,c=l?e[a]:e[a]&&a;if(c&&u[c]&&(n||u[c].data)||!s||!H(r))return c||(l?(e[a]=c=T,T++):c=a),u[c]||(u[c]={},l||(u[c].toJSON=function(){})),!j(t)&&"function"!=typeof t||(n?u[c]=k.extend(u[c],t):u[c].data=k.extend(u[c].data,t)),o=u[c],n||(o.data||(o.data={}),o=o.data),H(r)||(o[_(t)]=r),s?(i=o[t])!==m&&i!==f||(i=o[_(t)]):i=o,i}}function L(e){var t;for(t in e)if(("data"!==t||!k.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function O(e,t){for(var r,n,o,i,a,s,l,u,c,h=0,f=x,d=S,p=e[h];p!==m&&void 0!==p;){if((t||F(p))&&(n=(r=p[f])&&d[r])){if(o=n.events)for(i in o)if(g(o,i)&&(a=o[i]))for(s in a)if(g(a,s)&&(l=a[s]))for(u=0,c=l.length;u<c;u++)q(p,i,l[u]);d[r]&&(delete d[r],delete p[f])}p=e[++h]}}function B(e){return"string"==typeof e}function j(e){return"object"==typeof e}function H(e){return typeof e==typeof f}function G(e){var a=e;return function(e){var t,r="border-box"===this.css("box-sizing"),n=a?l:u,o=a?"left":"top",i=a?"right":c;return 0===arguments.length?(t=Math.round(s(this.css(n)))||0,r&&(t-=s(this.css("padding-"+o))+s(this.css("padding-"+i))+s(this.css("border-"+o+"-"+l))+s(this.css("border-"+i+"-"+l))),t):(this.css(n,e),this)}}function U(e){var r=e;return function(){var e=r?"left":"top",t=r?"right":c;return r?this.width():this.height()+s(this.css("padding-"+e))+s(this.css("padding-"+t))}}function W(e){var o=e;return function(e){var t=o?"left":"top",r=o?"right":c,n=o?this.innerWidth():this.innerHeight();return n+=s(this.css("border-"+t+"-"+l))+s(this.css("border-"+r+"-"+l)),e&&(n+=s(this.css("margin-"+t))+s(this.css("margin-"+r))),n}}function V(e){var r=e;return function(t){return this.forEach(function(e){e.style[C]=r?"block":"none",t&&t.apply(e)}),this}}function z(e){var a=e;return function(e){var t="scrollLeft",r=a?t:"scrollTop",n=a?"pageXOffset":"pageYOffset",o=this[0],i=E(o);return H(e)?i?n in i?i[n]:h.documentElement[r]:o[r]:(i?i.scrollTo(a?e:k(i)[t](),a?k(i).scrollTop():e):o[r]=e,this)}}function q(e,t,r){e.removeEventListener(t,r)}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),o=n.Common.j,g=n.Common.D,f=void 0,m=null,s=parseFloat,h=document,d="_nonamespace",p="events",l="width",u="height",c="bottom",b="position",y="visibility",C="display",a={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},w={tabIndex:{get:function(e){var t=e.getAttributeNode("tabindex"),r=e.nodeName;return t&&t.specified?parseInt(t.value,10):/^(?:input|select|textarea|button|object)$/i.test(r)||/^(?:a|area)$/i.test(r)&&e.href?0:f}}},v={option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,r,n=e.options,o=e.selectedIndex,i="select-one"===e.type||o<0,a=i?m:[],s=i?o+1:n.length,l=i?o:0;for(o<0&&(l=s);l<s;l++)if(((r=n[l]).selected||l===o)&&!r.disabled&&(!r.parentNode.disabled||!R(r.parentNode,"optgroup"))){if(t=k(r).val(),i)return t;a.push(t)}return a},set:function(e,t){var r=k.makeArray(t);return k(e).find("option").getAll().forEach(function(e){e.selected=0<=k.inArray(k(e).val(),r)}),r.length||(e.selectedIndex=-1),r}}},S={},x="$"+(""+Math.random()).replace(/\D/g,""),T=1,A={},[u,l].forEach(function(c){A[c]={get:function(e){var t,r,n,o=getComputedStyle(e),i=e.style,a=i[b],s=i[y],l=i[C],u=0===e.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(o[C]);if(u&&(i[b]="absolute",i[y]="hidden",i[C]="block"),t=o&&o[c],u&&(i[b]=a,i[y]=s,i[C]=l),""===t){for(r=e.parentElement,n=h.body;r&&r!==n;)r=r.parentElement;r!==n&&(t=i[c])}return t}}}),k=function(e,t){return e instanceof I?e:new I(e,t)},t.GC$=k,i={get:function(e){return this[e]},getAll:function(){return this},bind:function(s,l,u){return H(u)&&(u=l,l=f),this.forEach(function(r){var e,t,n,o,i,a=P(r,p,f,!0);a||P(r,p,a={},!0),t=(e=s.split("."))[0],o=(o=a[n=e[1]||d])||(a[n]={}),(i=function(e){H(l)||(e.data=l);var t=u.apply(r,arguments);!1===(e.result=t)&&(e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!1,e.returnValue=!1))}).original=u,(o[t]||(o[t]=[])).push(i),r.addEventListener(t,i)}),this},unbind:function(c,h){return this.forEach(function(e){var t,r,n,o,i=c.split("."),a=i[0],s=i[1]||d,l=P(e,p,f,!0),u=l&&l[s];if(h){if(u&&a&&(t=u[a]))for(n=t.length,r=0;r<n;r++)if(t[r].original===h){q(e,a,t[r]),t.splice(r,1);break}}else if(u)if(a){if(t=u[a])for(n=t.length,r=0;r<n;r++)q(e,a,t[r]);u[a]=f}else{for(o in u)if(g(u,o)&&(t=u[o]))for(n=t.length,r=0;r<n;r++)q(e,o,t[r]);l[s]=f}}),this},trigger:function(e,t){var r,n,o,i,a,s,l,u,c,h;for(r=0,n=this.length;r<n;r++)if(i=P(o=this[r],p,f,!0))for(s in a=e.split(".")[0],i)if(g(i,s)&&(u=(l=i[s])&&l[a]))for(c=0,h=u.length;c<h;c++)u[c].apply(o,[{type:a},t]);return this},css:function(r,n){var e,t,o,i=this,a=arguments.length;function s(t,r){i.forEach(function(e){e.style[t]=D(t,r)})}if(1===a){if(!j(r))return e=this[0],(t=A[r])&&"get"in t?t.get(e):(o=getComputedStyle(e))&&o[r];i.forEach(function(e){for(var t in r)g(r,t)&&(e.style[t]=D(t,r[t]))})}else 2===a&&(Array.isArray(r)&&Array.isArray(n)&&r.length===n.length?r.forEach(function(e,t){s(e,n[t])}):s(r,n));return this},width:G(!0),height:G(),innerWidth:U(!0),innerHeight:U(),outerWidth:W(!0),outerHeight:W(),append:function(e){var t,r=[e];return e instanceof k&&(r=e.getAll()),t=this[0],r.forEach(function(e){e&&t.appendChild(e)}),this},appendTo:function(e){var t=e;return e instanceof k&&(t=e[0]),this.forEach(function(e){t.appendChild(e)}),this},prepend:function(e){var t=this[0];return t.insertBefore(e,t.firstChild),this},insertBefore:function(t){var r=t.parentElement;return this.forEach(function(e){r.insertBefore(e,t)}),this},addClass:function(e){var t,r,n,o,i,a=0,s=this.length,l=/[\t\r\n]/g;for(t=(e||"").match(/\S+/g)||[];a<s;a++)if(n=1===(r=this[a]).nodeType&&(r.className?(" "+r.className+" ").replace(l," "):" ")){for(o=t[i=0];o;)n.indexOf(" "+o+" ")<0&&(n+=o+" "),o=t[++i];r.className=k.trim(n)}return this},removeClass:function(e){var t,r,n,o,i,a=0,s=this.length,l=/[\t\r\n]/g;for(t=(e||"").match(/\S+/g)||[];a<s;a++)if(n=1===(r=this[a]).nodeType&&(r.className?(" "+r.className+" ").replace(l," "):"")){for(o=t[i=0];o;){for(;0<=n.indexOf(" "+o+" ");)n=n.replace(" "+o+" "," ");o=t[++i]}r.className=e?k.trim(n):""}return this},hasClass:function(e){var t,r=0,n=this.length,o=/[\t\r\n]/g;for(e=" "+e+" ";r<n;r++)if(1===(t=this[r]).nodeType&&0<=(" "+t.className+" ").replace(o," ").indexOf(e))return!0;return!1},toggle:function(){return"none"===this[0].style[C]?this.show():this.hide(),this},show:V(!0),hide:V(),attr:function(r,t){var e=this,n=arguments.length;if(1===n){if(!j(r))return this[0].getAttribute(r);e.forEach(function(e){for(var t in r)g(r,t)&&e.setAttribute(t,r[t])})}else 2===n&&e.forEach(function(e){e.setAttribute(r,t)});return this},removeAttr:function(t){return this.forEach(function(e){e.removeAttribute(t)}),this},prop:function(r,t){var e=this,n=arguments.length;if(1===n){if(!j(r))return N(this[0],r);e.forEach(function(e){for(var t in r)g(r,t)&&N(e,t,r[t])})}else 2===n&&e.forEach(function(e){N(e,r,t)});return this},removeProp:function(t){t=a[t]||t;return this.forEach(function(e){try{e[t]=f,delete e[t]}catch(e){}}),this},text:function(t){var e=this;return 0===arguments.length?this[0].textContent:(e.forEach(function(e){e.textContent=t}),this)},val:function(n){var o,e,t,i;return arguments.length?(i=k.isFunction(n),this.forEach(function(e,t){var r;1===e.nodeType&&((r=i?n.call(e,t,k(e).val()):n)===m||r===f?r="":"number"==typeof r?r+="":k.isArray(r)&&(r=k.map(r,function(e){return e===m||e===f?"":e+""})),(o=v[e.type]||v[e.nodeName.toLowerCase()])&&"set"in o&&!H(o.set(e,r,"value"))||(e.value=r))}),this):(t=void 0,(e=this[0])?(o=v[e.type]||v[e.nodeName.toLowerCase()])&&"get"in o&&!H(t=o.get(e,"value"))?t:B(t=e.value)?t.replace(/\r/g,""):t===m||t===f?"":t:void 0)},position:function(){var e,t,r,n,o=this[0];if(o){if(e={top:0,left:0},t={top:0,left:0},"fixed"===k(o).css(b))try{e=o.getBoundingClientRect()}catch(e){}else r=this.offsetParent(),e=this.offset(),R(n=r[0],"html")||((t=r.offset()).left-=n.scrollLeft,t.top-=n.scrollTop),t.top+=s(k(n).css("borderTopWidth")),t.left+=s(k(n).css("borderLeftWidth"));return{top:e.top-t.top-s(k(o).css("marginTop")),left:e.left-t.left-s(k(o).css("marginLeft"))}}},offsetParent:function(){var e=k.map(this,function(e){for(var t=h.documentElement,r=e.offsetParent||t;r&&!R(r,"html")&&"static"===k(r).css(b);)r=r.offsetParent;return r||t});return k(e)},offset:function(){var e,t,r={top:0,left:0},n=this[0],o=n&&n.ownerDocument;if(o){if(e=o.documentElement,!H(n.getBoundingClientRect))try{r=n.getBoundingClientRect()}catch(e){}return t=E(o),{top:r.top+(t.pageYOffset||e.scrollTop)-(e.clientTop||0),left:r.left+(t.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}}},scrollLeft:z(!0),scrollTop:z(),html:function(t){var e=this;return 0===arguments.length?this[0].innerHTML:(e.forEach(function(e){e.innerHTML=t}),this)},remove:function(){this.forEach(function(e){var t=e.parentElement;t&&(t.removeChild(e),O([e]))})},empty:function(){return this.forEach(function(e){k(e.children).remove()}),this},find:function(r){var n=[];return B(r)&&this.forEach(function(e){var t=e.querySelectorAll(r);k.merge(n,t)}),k(n)},parent:function(){var r=[];return this.forEach(function(e){var t=e.parentElement;t&&r.push(t)}),k(r)},index:function(e){var t=this[0];return e?B(e)?k.inArray(t,k(e).getAll()):k.inArray(e,this):t&&t.parentElement?k.inArray(t,t.parentElement.children):-1},focus:function(){var e=this[0];return e!==h.activeElement&&e.focus&&e.focus(),this},isVisible:function(){var r=0;return this.forEach(function(e){var t=getComputedStyle(e);"hidden"!==t[y]&&"none"!==t[C]&&r++}),0<r},data:function(n,o){var i=this,a=H(o);return a&&(i=void 0),k.each(this,function(e,t){var r=P(t,n,o);if(a)return i=r,!1}),i},removeData:function(r){return k.each(this,function(e,t){!function(e,t,r){if(F(e)){var n,o,i,a=e.nodeType,s=a?S:e,l=a?e[x]:x;if(s[l]){if(t&&(i=r?s[l]:s[l].data)){t=k.isArray(t)?t.concat(k.map(t,_)):t in i?[t]:(t=_(t))in i?[t]:t.split(" "),o=t.length;for(n=0;n<o;n++)delete i[t[n]];if(!(r?L:k.isEmptyObject)(i))return}(r||(delete s[l].data,L(s[l])))&&(a?O([e],!0):s!==s.window?delete s[l]:s[l]=m)}}}(t,r)}),this}},M=I.prototype=[],o.Ia(M,i),k.prototype=M,k.each=o.H,k.isEmptyObject=o.za,k.isFunction=o.Aa,k.isArray=o.Ca,k.isNumeric=o.Da,k.getType=o.Ba,k.inArray=o.Ea,k.merge=o.Ga,k.map=o.Ha,k.extend=o.Ia,k.inherit=o.G,k.isPlainObject=o.Ja,k.isArraylike=o.ya,k.isWindow=o.Ka,k.makeArray=o.La,k.trim=function(e){if(e.trim)return e.trim();return e===m||e===f?"":(e+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},k.Nl=function(e,t,r,n,o){var i=k(h.createElement(e));return t&&r&&i.css(t,r),n&&i.addClass(n),o&&(o instanceof k?o.append(i):k(o).append(i)),i}},"./dist/core/util/imageLoader.js":function(e,t,r){"use strict";var n,i,a;function o(e){this.bo=0,this.co=0,this.eo={};this.do=e}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/util/domUtil.js"),i=n.GC$,a=".gcSheet",o.prototype.fo=function(e){var t,r,n=this;function o(){n.ho(e,!1)}(t=n.eo)[e]||((r=i(document.createElement("img"))).bind("load"+a,function(){n.ho(e,!0)}),r.bind("error"+a,o),r.bind("abort"+a,o),n.bo++,t[e]={io:!1,jo:r[0],agc:!1},r[0].src=e)},o.prototype.ko=function(e){var t=this.eo[e];return!!t&&t.io},o.prototype.bgc=function(e){var t=this.eo[e];return!!t&&t.agc},o.prototype.lo=function(e){var t=this.eo[e];return t?t.jo:null},o.prototype.ho=function(e,t){this.co++,this.eo[e].io=!0,this.eo[e].agc=t,this.mo()&&this.do&&this.do()},o.prototype.mo=function(){return this.co>=this.bo},o.prototype.no=function(){var e,t=this.eo;if(t)for(e in t)t[e]&&i(t[e].jo).unbind(a);this.do=null},t.oo=o},"./dist/core/util/tasks.js":function(e,t,r){"use strict";var n;function o(e,t){this.tasks=[],this.nextTaskFunc=e.bind(this),this.isBusyFunc=t.bind(this)}function i(e,t){this.fn=e,this.args=t}Object.defineProperty(t,"__esModule",{value:!0}),i.prototype.run=function(){this.fn.apply(null,this.args)},n=i,t.Task=n,o.prototype.addTask=function(e,t){this.tasks.splice(0,0,new n(e,t))},o.prototype.pushTask=function(e,t){this.tasks.push(new n(e,t))},o.prototype.runNextTask=function(){var e=this,t=e.tasks;if(!e.isTerminated){if(t.length<1)return void(e.endingCallback&&e.endingCallback());if(e.isBusyFunc())return void setTimeout(function(){e.runNextTask()},100);e.nextTaskFunc().run(),setTimeout(function(){e.runNextTask()},10)}},o.prototype.start=function(){this.runNextTask()},o.prototype.terminate=function(){this.tasks=[],this.isTerminated=!0},t.Tasks=o},"./dist/core/util/theme.js":function(e,t,r){"use strict";var n,o,y,a,p,s,i,l,u,c,h,f,d,g,m,b;function C(t){var r=t;return function(e){return 0===arguments.length?this.po[r]:(this.po[t]=p(e),this)}}function w(){}function v(){}function S(e,t,r,n){this.name=i("name"),this.colors=i("colors"),this.headerFont=i("headerFont"),this.bodyFont=i("bodyFont");this.name(e),this.colors(t||new h(e)),this.headerFont(r),this.bodyFont(n)}function x(e,t,r,n,o,i,a,s,l,u,c,h,f){this.background1=C(0),this.background2=C(1),this.textColor1=C(2),this.textColor2=C(3),this.accent1=C(4),this.accent2=C(5),this.accent3=C(6),this.accent4=C(7),this.accent5=C(8),this.accent6=C(9),this.hyperlink=C(10),this.followedHyperlink=C(11),this.Cj=e,this.po=[];for(var d=1;d<13;d++)this.po.push(p(arguments[d]))}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),o=r("./dist/core/util/common.js"),y=n.Common.j.Fa,a=n.Common.pc,p=a.ec,s=parseInt,i=o.util.Pl,l="Gill Sans MT",u="Franklin Gothic Book",c="Trebuchet MS",x.prototype.name=function(e){return 0===arguments.length?this.Cj:(this.Cj=e,this)},x.prototype.getColor=function(e){var t,r,n,o,i;if(e&&"string"==typeof e&&(r=void 0,t=e.split(" "))){if(n=-1,1<(o=t.length)){if(!t[0])return e;"background"===(r=t[0].toLowerCase())?n=s(t[1],10)-1:"text"===r?n=s(t[1],10)+1:"accent"===r&&(n=s(t[1],10)+3)}else 1===o&&("hyperlink"===(r=t[0].toLowerCase())?n=10:"followedhyperlink"===r&&(n=11));if(0<=n&&n<=11)return 2<o?(i=s(t[2],10)/100,a.bc(a.jc(this.po[n],i))):a.bc(this.po[n])}return e},x.prototype.toJSON=function(){var e=this.po;return{name:this.Cj,background1:e[0],background2:e[1],text1:e[2],text2:e[3],accent1:e[4],accent2:e[5],accent3:e[6],accent4:e[7],accent5:e[8],accent6:e[9],hyperlink:e[10],followedHyperlink:e[11]}},x.prototype.fromJSON=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m;function b(e,t){y(t)||(r.po[e]={a:t.a,r:t.r,g:t.g,b:t.b})}e&&(r=this,p=t?(g=e.name?e.name:e._name,y(g)||(r.Cj=g),n=(m=e.colorList?e.colorList:e._colorList)[0],o=m[1],i=m[2],a=m[3],s=m[4],l=m[5],u=m[6],c=m[7],h=m[8],f=m[9],d=m[10],m[11]):(y(e.name)||(r.Cj=e.name),n=e.background1,o=e.background2,i=e.text1,a=e.text2,s=e.accent1,l=e.accent2,u=e.accent3,c=e.accent4,h=e.accent5,f=e.accent6,d=e.hyperlink,e.followedHyperlink),b(0,n),b(1,o),b(2,i),b(3,a),b(4,s),b(5,l),b(6,u),b(7,c),b(8,h),b(9,f),b(10,d),b(11,p))},x.prototype.e4=function(e){var t,r,n,o;if(this.name()!==e.name())return!1;for(r=0,n=(t=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"]).length;r<n;r++)if(o=t[r],!a.Pka(this[o](),e[o]()))return!1;return!0},h=x,t.ColorScheme=h,S.prototype.getColor=function(e){return this.colors().getColor(e)},S.prototype.getFont=function(e){return"Body"===e?this.bodyFont():"Headings"===e?this.headerFont():e},S.prototype.toJSON=function(){var e=this.name();return S.f4(this)?e:{name:e,themeColor:this.colors()?this.colors().toJSON():void 0,headingFont:this.headerFont(),bodyFont:this.bodyFont()}},S.f4=function(e){var t,r=e.name();return!!b[r]&&(t=b[r],e.bodyFont()===t.bodyFont()&&e.headerFont()===t.headerFont()&&e.colors().e4(t.colors()))},f=S,t.Theme=f,v.Default=new h("Default",g="#FFFFFF","#EEECE1",d="#000000","#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),v.Office2007=new h("Office2007",g,"#EEECE1",d,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),v.Office=new h("Office",g,"#E7E6E6",d,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),v.Apex=new h("Apex",g,"#C9C2D1",d,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),v.Aspect=new h("Aspect",g,"#E3DED1",d,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),v.Concourse=new h("Concourse",g,"#DEF5FA",d,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),v.Civic=new h("Civic",g,"#C5D1D7",d,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),v.Oriel=new h("Oriel",g,"#FFF39D",d,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),v.Origin=new h("Origin",g,"#DDE9EC",d,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),v.Paper=new h("Paper",g,"#FEFAC9",d,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),v.Solstice=new h("Solstice",g,"#E7DEC9",d,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),v.Technic=new h("Technic",g,"#D4D2D0",d,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),v.Trek=new h("Trek",g,"#FBEEC9",d,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),v.Urban=new h("Urban",g,"#DEDEDE",d,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),v.Verve=new h("Verve",g,"#D2D2D2",d,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),v.Equity=new h("Equity",g,"#E9E5DC",d,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),v.Flow=new h("Flow",g,"#DBF5F9",d,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),v.Foundry=new h("Foundry",g,"#EAEBDE",d,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),v.Median=new h("Median",g,"#EBDDC3",d,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),v.Metro=new h("Metro",g,"#D6ECFF",d,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),v.Module=new h("Module",g,"#D4D4D6",d,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),v.Opulent=new h("Opulent",g,"#F4E7ED",d,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),m=v,t.ThemeColors=m,w.Default=new f("Default",m.Default,"Cambria","Calibri"),w.Office=new f("Office",m.Office,"Calibri Light","Calibri"),w.Office2007=new f("Office2007",m.Office2007,"Cambria","Calibri"),w.Apex=new f("Apex",m.Apex,"Lucida Sans","Book Antiqua"),w.Aspect=new f("Aspect",m.Aspect,"Verdana","Verdana"),w.Concourse=new f("Concourse",m.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),w.Civic=new f("Civic",m.Civic,"Georgia","Georgia"),w.Oriel=new f("Oriel",m.Oriel,"Century Schoolbook","Century Schoolbook"),w.Origin=new f("Origin",m.Origin,"Bookman Old Style",l),w.Paper=new f("Paper",m.Paper,"Constantia","Constantia"),w.Solstice=new f("Solstice",m.Solstice,l,l),w.Technic=new f("Technic",m.Technic,u,"Arial"),w.Trek=new f("Trek",m.Trek,"Franklin Gothic Medium",u),w.Urban=new f("Urban",m.Urban,c,"Georgia"),w.Verve=new f("Verve",m.Verve,"Century Gothic","Century Gothic"),w.Equity=new f("Equity",m.Equity,u,"Perpetua"),w.Flow=new f("Flow",m.Flow,"Calibri","Constantia"),w.Foundry=new f("Foundry",m.Foundry,"Rockwell","Rockwell"),w.Median=new f("Median",m.Median,"Tw Cen MT","Tw Cen MT"),w.Metro=new f("Metro",m.Metro,"Consolas","Corbel"),w.Module=new f("Module",m.Module,"Corbel","Corbel"),w.Opulent=new f("Opulent",m.Opulent,c,c),b=w,t.Themes=b},"./dist/core/workbook/sheettab.js":function(e,t,r){"use strict";var n,m,b,o,y,i,a,s,l,u,c=this&&this.__extends||(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function h(e){var t=u.call(this,e)||this,r=t;return r.EC=13,r.GC=12,r.HC=0,r.kw=30,r.IC=28,r.JC=28,r.KC=28,r.LC=0,r._font="10pt Segoe UI",t}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),m=r("./dist/core/util/common.js"),b=r("./dist/core/worksheet/stylehelper.js"),o=r("./dist/core/workbook/sheettabbase.js"),y=r("./dist/core/core.enum.js"),i=n.Common.pc,a=i.ic,s=i.ec,u=o.DC,c(h,u),h.prototype.NC=function(){var e=this.OC,t=e&&e.options;return t&&t.tabNavigationVisible?this.IC*(t.useTouchLayout?1.5:1):0},h.prototype.PC=function(){var e=this.OC;return e&&e.options.tabNavigationVisible?e.Jv():0},h.prototype.QC=function(){return this.JC},h.prototype.RC=function(){return this.SC?0:this.JC},h.prototype.TC=function(){return this.SC?0:this.KC},h.prototype.UC=function(){var e,t,r=this.OC.sheets,n=this.VC(),o=this.WC,i=this.Dr(),a=i.x+i.width-this.kw-this.TC()-this.RC();for(e=this.gq,t=r.length;e<t;e++)if(r[e].visible()&&(n+=o[e]),a<n){n=a;break}return n},h.prototype.VC=function(){return 2*this.NC()+this.QC()+this.XC()},h.prototype.XC=function(){var e=this.OC;return e&&e.options.tabNavigationVisible?this.kw/2:0},h.prototype.getResizeBarBounds=function(){var e=this.Dr();return{x:e.x+e.width-this.kw,y:null,width:this.kw,height:null}},h.prototype.getNavButtonBounds=function(){return{x:this.kw/2,y:null,width:this.NC(),height:null,endIndex:3,startIndex:1}},h.prototype.getSheetTabBounds=function(){var e=this.Dr(),t=this.RC();return{x:this.VC(),y:null,height:null,secondMoreTabWidth:this.RC(),moreTabPos:e.x+e.width-this.kw-this.TC()-t}},h.prototype.getPreMoreTabBounds=function(){return{x:this.VC()-this.QC(),width:this.QC()}},h.prototype.YC=function(){return this.ZC+this.WC[this.$C]>this._C()},h.prototype._C=function(){return this.Dr().width-this.kw-this.TC()-this.RC()},h.prototype.aD=function(){return 6},h.prototype.Via=function(){return["blank","nextButton"]},h.prototype.cD=function(){return this.VC()},h.prototype.dD=function(e,t){e.save(),e.beginPath();var r=m.Im.Km(0,"gc-tabStripBackground");this.eD=s(r.backgroundColor),e.fillStyle=r.backgroundColor,e.fillRect(t.x,t.y,t.width,t.height),e.beginPath(),e.strokeStyle=r.borderTopColor,e.moveTo(t.x,t.y+.5),e.lineTo(t.x+t.width,t.y+.5),e.stroke(),e.restore()},h.prototype.fD=function(e,t,r,n){var o,i,a=this,s=a.OC.options.newTabVisible,l=a.IC,u=a.RC();r+=u,a.KC=s?l:0,(o=t.x+t.width-a.kw-a.TC())<r&&((i=(r=o)-u)<n&&(r=(i=n)+l),a.gD(e,i,0,u,t.height)),s&&a.hD(e,r,0,l,t.height,-2===a.iD)},h.prototype.jD=function(e,t,r,n){var o=this.QC();this.gD(e,n-o,0,o,t.height)},h.prototype.kD=function(e,t,r){var n=this.NC(),o=this.PC(),i=this.kw/2+n/2,a=o/2,s=this.lD;this.mD(e,i,a,i+5,5+a,i+5,a-5,!0,null,1===s),i+=n,this.mD(e,i,a,i-5,5+a,i-5,a-5,!1,null,2===s)},h.prototype.nD=function(e,t){var r,n,o=this.kw,i=m.Im.Km(0,"gc-tabStripResizeBarInner");this.OC.options.showHorizontalScrollbar&&(e.beginPath(),e.rect(t.x+t.width-o,0,o,t.height),e.clip(),r=t.x+t.width-o/2,n=t.y+t.height/2,e.fillStyle=i.color,e.fillRect(r,n,2,2),e.fillRect(r,n-4,2,2),e.fillRect(r,n+4,2,2))},h.prototype.oD=function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p,g=y.VisualState.normal;s&&(g=y.VisualState.hover),u&&(g=y.VisualState.selected),a&&(g=y.VisualState.active),a&&!u&&(g=y.VisualState.activeNotSelected),c=m.Im.Km(g,"gc-tab-"+m.Im.Jm(g)),h=m.Im.Km(0,"gc-tab-"+m.Im.Jm(0)),e.save(),a&&u&&(e.fillStyle="white",e.fillRect(t,r,n,o-4)),u?(e.fillStyle="white",e.fillRect(t,r+1,n,o-4)):a&&(e.fillStyle="white",e.fillRect(t,r,n,1)),f=this.pD(e,a,l,c),e.fillStyle=f,e.fillRect(t+3,r+3,n-6+1,o-6),e.beginPath(),e.lineWidth=1,e.strokeStyle=h&&h.borderLeftColor,a?(e.moveTo(t+.5,r),e.lineTo(t+.5,r+o-4),e.moveTo(t+n+.5,r)):(e.moveTo(t+.5,r+4),e.lineTo(t+.5,r+o-4),e.moveTo(t+n+.5,r+4)),e.lineTo(t+n+.5,r+o-4),e.stroke(),u&&(e.beginPath(),e.strokeStyle=c&&c.borderBottomColor,e.lineWidth=2,e.moveTo(t,r+o-4),e.lineTo(t+n+1,r+o-4),e.stroke()),e.textBaseline="top","string"==typeof f&&(d=f),e.fillStyle=this.qD(c,d),(s||a||u)&&(e.font=b.To.Ro(e.font,"bold")),p=this.EC,e.textBaseline="middle",e.fillText(l,t+p,r+o/2-1),e.restore()},h.prototype.mD=function(e,t,r,n,o,i,a,s,l,u){var c,h,f;e.save(),c=y.VisualState.highlight,u&&(c=y.VisualState.hover),s?(t-=2,n-=2,-1===this.rw(this.gq)&&(c=y.VisualState.normal)):(t+=2,n+=2,-1===this.rD(this.sD())&&(c=y.VisualState.normal)),h=m.Im.Km(c,"gc-navButton-"+m.Im.Jm(c)),e.strokeStyle=this.tD(h.borderTopColor),e.beginPath(),f=1,n<t&&(f=-1),e.moveTo(t-.5,r),e.lineTo(t-.5,r+1),e.moveTo(t+f-.5,r-1),e.lineTo(t+f-.5,r+2),e.moveTo(t+2*f-.5,r-2),e.lineTo(t+2*f-.5,r+3),e.moveTo(t+3*f-.5,r-3),e.lineTo(t+3*f-.5,r+4),e.stroke(),e.restore()},h.prototype.hD=function(e,t,r,n,o,i){var a,s,l;e.save(),e.beginPath(),a=(o-14)/2,s=y.VisualState.highlight,i&&(s=y.VisualState.hover),l=m.Im.Km(s,"gc-tabStripNewTab-"+m.Im.Jm(s)),e.lineWidth=1.5,e.strokeStyle=this.tD(l.borderTopColor),e.arc(t+n/2,r+o/2,a,0,2*Math.PI),e.stroke(),e.beginPath(),e.lineWidth=2,e.moveTo(t+n/2-4,r+o/2),e.lineTo(t+n/2+4,r+o/2),e.moveTo(t+n/2,r+o/2-4),e.lineTo(t+n/2,r+o/2+4),e.stroke(),e.restore()},h.prototype.gD=function(e,t,r,n,o){var i,a,s;e.save(),e.beginPath(),i=y.VisualState.highlight,5!==(a=this.lD)&&6!==a||(i=y.VisualState.hover),s=m.Im.Km(i,"gc-navMoreButton-"+m.Im.Jm(i)),e.fillStyle=this.tD(s.borderTopColor),e.fillRect(t+n/2,r+o/2,2,2),e.fillRect(t+n/2-4,r+o/2,2,2),e.fillRect(t+n/2+4,r+o/2,2,2),e.restore()},h.prototype.tD=function(e){var t=s(e),r=this.eD;return t.a<=.01?a(r):i.hc(r,t)?a(t):e},t.iv=h},"./dist/core/workbook/sheettab2007.js":function(e,t,r){"use strict";var n,o,S,i,g,x,T,a,s,l,u,c=this&&this.__extends||(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function h(e){var t=u.call(this,e)||this,r=t;return r.EC=12,r.GC=8,r.HC=3,r.kw=12,r.KC=48,r.LC=5,r._font="10pt Arial",t}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/core.ns.js"),o=r("@grapecity/js-sheets-common"),S=r("./dist/core/util/common.js"),i=r("./dist/core/workbook/sheettabbase.js"),g=r("./dist/core/worksheet/stylehelper.js"),x=S.Ul.wl,T=Math.min,a=new o.Common.ResourceManager(n.SR),s=a.getResource.bind(a),u=i.DC,c(h,u),h.prototype.NC=function(){var e=this.OC,t=e&&e.options;return t&&t.tabNavigationVisible?e.Wv()*(t.useTouchLayout?2:1):0},h.prototype.PC=function(){var e=this.OC;return e&&e.options.tabNavigationVisible?e.Wv():0},h.prototype.VC=function(){return 4*this.NC()+this.lE()},h.prototype.lE=function(){var e=this.OC;return e&&e.options.tabNavigationVisible?2:0},h.prototype.getResizeBarBounds=function(){var e=this.Dr();return{x:e.x+e.width-this.kw,y:null,width:this.kw,height:null}},h.prototype.getNavButtonBounds=function(){return{x:0,y:null,width:this.NC(),height:null,endIndex:4,startIndex:0}},h.prototype.getSheetTabBounds=function(){return{x:this.VC(),y:null,height:null,secondMoreTabWidth:0,moreTabPos:0}},h.prototype.getPreMoreTabBounds=function(){return{x:this.VC(),width:this.HC+this.LC}},h.prototype.YC=function(){return this.ZC+this.WC[this.$C]+this.TC()>this._C()},h.prototype._C=function(){return this.Dr().width-this.kw},h.prototype.aD=function(){return 1},h.prototype.Via=function(){return["newSheet"]},h.prototype.cD=function(){var e=this.VC()+this.Dr().height;return this.OC.options.newTabVisible&&(e+=this.TC(),e+=this.HC),e},h.prototype.dD=function(e,t){var r,n,o,i,a,s,l,u;if(e.save(),e.beginPath(),r=e.createLinearGradient(t.x,t.y,t.width,t.height),o=(n=S.Im.Km(0,"gc-tabStripBackground"))&&n.backgroundImage,i=n&&n.backgroundColor,o&&-1!==o.indexOf("linear-gradient"))for(s=0,l=(a=x(o)).length;s<l;s++)u=a[s],r.addColorStop(u.point,u.color);else i&&(r.addColorStop(0,"#DDDDDD"),r.addColorStop(1,i));e.fillStyle=r,e.fillRect(t.x,t.y,t.width,t.height),e.restore()},h.prototype.fD=function(e,t,r,n){var o=this.OC,i=s().NewTab;o.options.newTabVisible&&(this.KC=e.measureText(i).width+this.EC,this.oD(e,r,0,this.TC(),t.height,5,!1,-2===this.iD,i,!1))},h.prototype.jD=function(e,t,r,n){var o=r-1,i=this.WC[o];this.oD(e,n+this.LC-i-this.HC,0,i,t.height,5,this.$C===o,this.iD===o,"",!1)},h.prototype.kD=function(e,t,r){var n,o,i,a;e.fillStyle="#92A5C7",e.fillRect(t.x,t.y,r-1,t.height),o=(n=this.NC())/2,i=this.PC()/2,a=this.lD,this.mD(e,o,i,o+5,5+i,o+5,i-5,!0,o-5,0===a),o+=n,this.mD(e,o,i,o+5,5+i,o+5,i-5,!0,null,1===a),o+=n,this.mD(e,o,i,o-5,5+i,o-5,i-5,!1,null,2===a),o+=n,this.mD(e,o,i,o-5,5+i,o-5,i-5,!1,o+4,3===a)},h.prototype.nD=function(e,t){var r,n=this.OC,o=this.kw,i=S.Im.Km,a=i(4,"gc-tabStripResizeBarInner"),s=i(0,"gc-tabStripResizeBarOuter");n.options.showHorizontalScrollbar&&(r=t.x+t.width-o,e.fillStyle=s.backgroundColor,e.fillRect(r,t.y,o,t.height),e.fillStyle=a.backgroundColor,e.fillRect(1+r,t.y+1,o-2,t.height-2),e.fillStyle=a.color,e.fillRect(r+o/2-1,t.y+4,2,t.height-8))},h.prototype.oD=function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p;e.save(),e.beginPath(),e.moveTo(t,r),e.lineTo(t,r+o-i),e.arcTo(t,r+o,t+n,r+o,i),e.lineTo(t+n,r+o),e.lineTo(t+n+o,r),a||e.lineTo(t,r),c=0,(s||u)&&(c=4),h=S.Im.Km(c,"gc-tab-"+S.Im.Jm(c)),f=this.pD(e,u||s,l,h),e.fillStyle=f,e.fill(),e.strokeStyle="#92A5C7",e.stroke(),e.textBaseline="top","string"==typeof f&&(d=f),e.fillStyle=this.qD(h,d),a&&(e.font=g.To.Ro(e.font,"bold")),p=this.EC,e.textBaseline="middle",e.fillText(l,t+p,r+o/2),e.restore()},h.prototype.mD=function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p,g,m,b,y,C,w,v;if(e.save(),c=this.Dr(),h=this.NC(),d=(f=S.Im.Km)(4,"gc-navButton-hover"),g=(p=f(0,"gc-navButton-normal"))&&p.backgroundColor,u)e.fillStyle=d.backgroundColor,e.fillRect(t-h/2+2,c.y+2,h-4,c.height-4);else{if((m=p&&p.backgroundImage)&&-1!==m.indexOf("linear-gradient")){for(b=e.createLinearGradient(c.x+.7*c.height,c.y+0,.7*c.height,c.height),C=0,w=(y=x(m)).length;C<w;C++)v=y[C],b.addColorStop(v.point,v.color);e.fillStyle=b}else g&&(e.fillStyle=g);e.fillRect(t-h/2,c.y+1,h,c.height-2)}e.fillStyle=u?d.color:p.color,null!=l&&e.fillRect(l,T(o,a),1,Math.max(o,a)-T(o,a)),s?(t-=2,n-=2,i-=2):(t+=2,n+=2,i+=2),e.beginPath(),e.moveTo(t,r),e.lineTo(n,o),e.lineTo(i,a),e.lineTo(t,r),e.fill(),e.restore()},t.jv=h},"./dist/core/workbook/sheettabbase.js":function(e,t,r){"use strict";var n,o,g,m,p,v,i,b,s,y,C,w,S,a,x,T,A,k,l,u,c,h,f,d,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U;function W(e,t,r){e.Wq(m.Events.SheetTabClick,{sheet:t,sheetName:t?t.name():x,sheetTabIndex:y(r)?-1:r})}function V(e){this.Cj=e,this.SC=!1,this.LC=0,this.HC=0,this.buffer=null;var t=this;t.OC=x,t.$C=0,t.gq=0,t.ZC=70,t.lD=-1,t.iD=-1,t._font="",t.WC=[],t.uD=-1,t.vD=-1,t.wD=x,t.xD=0,t.Us(new m.Rect(0,0,200,28))}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/core.ns.js"),o=r("@grapecity/js-sheets-common"),g=r("./dist/core/util/domUtil.js"),m=r("./dist/core/util/common.js"),p=r("./dist/core/worksheet/stylehelper.js"),v=r("./dist/core/core.enum.js"),i=o.Common.pc,b=m.Ul.wl,s=m.Ul.bq,y=o.Common.j.Fa,C=m.Ul.Nl,w=m.Ul.lZa,S=window,a=document,x=null,T=Math.max,A=Math.min,k=Math.pow,u="mousedown"+(l=".gcTab"),c="mousemove"+l,h="mouseup"+l,f="mouseout"+l,d="dblclick"+l,M="mousemove.spliter",I="mouseup.spliter",R="keydown"+(E=".tabNameEditor"),D="focus"+E,N="blur"+E,F="resize",P="tab",L="newSheet",O="white",B=_="navButton",j="sheetTab",H=new o.Common.ResourceManager(n.SR),G=H.getResource.bind(H),V.prototype.ws=function(e){var t,r=this;r.Xs&&r.no(!0),t=C("canvas"),m.En.Kn(t,r.OC),t.setAttribute("id",r.Cj),r.yD=r.zD(),e.appendChild(r.yD[0]),e.appendChild(t),r.Xs=t,g.GC$(t).bind(u,function(e){return r.AD(e)}).bind(c,function(e){return r.BD(e)}).bind(h,function(e){return r.CD(e)}).bind(f,function(e){return r.DD(e)}).bind(d,function(e){return r.ED(e)}),r.fq(),V.ao(r,"setHost")},V.prototype.Yv=function(e){var t=e.options.font;(this.OC=e)&&t&&0<t.length&&(this._font=t)},V.prototype.RIc=function(e){this.fw(),this.SIc(e),this.gw()},V.prototype.SIc=function(e){var t,r=-1,n=this.sD();if(!(n.length<=0))for(;;){if(r===(t=this.TIc().tabsInfo)[0].index)return;if(r=t[0].index,t[0].index>e)this.$D(n);else{if(!(t[t.length-1].index<e||t[t.length-1].index===e&&1<t.length))return;this._D(n)}}},V.prototype.Dr=function(){var e=this.Zs;return new m.Rect(e.x,e.y,e.width,e.height)},V.prototype.Us=function(e){var t=this.Zs=new m.Rect(0,0,0,0);t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},V.prototype.TC=function(){return this.KC},V.prototype.UC=function(){var e=this.Dr();return e.x+e.width-this.kw},V.prototype.VC=function(){return 0},V.prototype.fq=function(){var e,t,r,n,o=this.Ws();o&&o.parentNode&&0!==(e=g.GC$(o.parentNode)).width()&&0!==e.height()&&(t=T(e.width(),0),r=T(e.height(),0),o.style.display="none",o.width=t,o.height=r,o.style.display="",o.style.width=t+"px",o.style.height=r+"px",t=o.clientWidth||o.width,r=o.clientHeight||o.height,n=this.Dr(),this.Us(new m.Rect(n.x,n.y,t,r)),m.En.Pn(o,t,r),this.repaint())},V.prototype.YC=function(){return!1},V.prototype._C=function(){return 0},V.prototype.aD=function(){return 0},V.prototype.Via=function(){return[]},V.prototype.cD=function(){return 0},V.prototype.zD=function(){var e="transparent";return g.GC$(C("div")).css({position:"absolute","border-style":"solid","border-color":"black","border-width":"4px",display:"none",width:0,"border-bottom":0,"border-left-color":e,"border-right-color":e})},V.prototype.no=function(e){var t,r=this.Xs;r&&(t=r.parentNode,g.GC$(r).unbind(u).unbind(c).unbind(h).unbind(d).unbind(f),t&&t.removeChild(r)),g.GC$(this.yD).remove(),V.ao(this,"dispose"),e||(this.OC=x)},V.prototype.hitTest=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m=this,b=m.OC,y=b.options.scrollbarAppearance===v.ScrollbarAppearance.mobile,C=m.Dr(),w=m.getResizeBarBounds();if(b.options.showHorizontalScrollbar&&!y&&e>w.x&&e<C.x+C.width)return{type:"resize",element:F};for(n=-1,o=(r=m.getNavButtonBounds()).startIndex,i=r.x,a=r.endIndex,s=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],l=o;l<a;l++){if(i<e&&e<i+r.width){_=s[n=l];break}i+=r.width}if(-1!==n)return{type:B,element:_,index:l};if(i=(u=m.getPreMoreTabBounds()).x,c=0,-1!==m.rw(m.gq)){if(i<=e&&e<i+u.width)return{type:B,element:_=s[5],index:5,position:i};c=m.LC}if(h=m.getSheetTabBounds(),f=b.sheets,d=m.WC,p=m.HC,g=0,i=h.x+c,-1<m.gq)for(l=m.gq;l<f.length&&l<d.length;l++)if(f[l].visible()){if(g=d[l],i<e&&e<i+g+p){if(0<h.moreTabPos&&e<h.moreTabPos)return{type:j,element:P,index:l,position:i};if(0===h.moreTabPos)return{type:j,element:P,index:l,position:i}}i+=g+p}if(i>h.moreTabPos&&0<h.moreTabPos&&(i=h.moreTabPos),-1!==m.rD(m.sD())){if(i<e&&e<i+h.secondMoreTabWidth)return{type:B,element:_=s[6],index:6,position:i}}else if(i<e&&e<i+h.secondMoreTabWidth)return{element:"blank",position:i};return i+=h.secondMoreTabWidth,b.options.newTabVisible&&i<e&&e<i+m.TC()?{type:j,element:L,position:i,index:-1}:{element:"blank"}},V.prototype.AD=function(e){var t,r,n,o,i,a,s,l=this,u={e:e,r:x};return V.ao(l,"preProcessMouseDown",u),y(t=u.r)?(r=g.GC$(l.Ws()).offset(),n=e.pageX-r.left,o=e.pageY-r.top,i=l.OC.getActiveSheet(),l.FD&&l.GD(i,!1),s=(a=l.hitTest(n,o)).element,0===e.button&&(s===F?(l.HD=!0,l.ID=e.pageX,l.tC()):s===_?l.JD(a.index):s===P?(l.KD(a.index,a.position,e),l.LD(e,a)):s===L&&l.MD(a.position),(i=l.OC.getActiveSheet())&&i._eventHandler&&!i.isEditing()&&i.zt()),!(l.ND=!0)):t},V.prototype.BD=function(e){var t,r,n,o,i,a,s,l,u,c,h,f=this,d=f.OC,p={e:e,r:x};if(V.ao(f,"preProcessMouseMove",p),!y(t=p.r))return t;if(r=f.Xs.style,f.OD&&!f.PD&&10<Math.sqrt(k(f.OD.x-e.pageX,2)+k(f.OD.y-e.pageY,2))&&(f.PD=!0),f.HD)r.cursor="w-resize",n=e.pageX-f.ID,o=f.OC.xs.clientWidth,d.options.tabStripRatio=d.Iv()+n/o,i=f.kw/o,d.Iv()<i?(d.options.tabStripRatio=i,f.ID=f.kw):1<=d.Iv()?(d.options.tabStripRatio=1,f.ID=o):f.ID=e.pageX,d.aq();else if(f.PD)f.QD(e.pageX,e.pageY),f.RD(e);else{if(f.lD=-1,f.iD=-1,a=g.GC$(f.Ws()).offset(),s=e.pageX-a.left,l=e.pageY-a.top,c=(u=f.hitTest(s,l)).element,f.OC&&f.OC.options.enableAccessibility&&(h=f.cgc(u),f.OC.dgc(h)),""===c)return r.cursor="default",f.repaint(),!1;c===F?r.cursor="w-resize":(r.cursor="default",c===_?f.lD=u.index:c===P?f.iD=u.index:c===L&&(f.iD=-2)),f.repaint()}return!1},V.prototype.cgc=function(e){var t=G(),r="",n=e.element;return n===F?r=t.ARIA_Resize:n===_?r={first:t.ARIA_First,prevArrow:t.ARIA_PreviousArrow,nextArrow:t.ARIA_NextArrow,last:t.ARIA_Last,prevButton:t.ARIA_PreviousButton,nextButton:t.ARIA_NextButton}[_]||"":n===P?r=t.ARIA_SheetTab+" "+this.OC.getSheet(e.index).name().replace(/([0-9]+)/," $1 "):n===L?r=t.ARIA_NewSheet:"blank"===n&&(r=t.ARIA_Blank),r},V.prototype.CD=function(e){var t,r=this,n={e:e,r:x};return V.ao(r,"preProcessMouseUp",n),y(t=n.r)?(r.HD&&(r.HD=!1,r.OC.aq()),r.SD(),r.PD&&(r.PD=!1,r.TD.remove(),r.UD(),r.yD.hide()),r.OD=x,r.VD(),r.uC(),!r.ND||(r.ND=!1)):t},V.prototype.DD=function(e){var t,r,n,o={e:e,r:x};return V.ao(this,"preProcessMouseOut",o),y(t=o.r)?(this.VD(),r=this.lD,this.lD=-1,n=this.iD,this.iD=-1,this.lD===r&&this.iD===n||this.repaint(),!1):t},V.prototype.tC=function(){var e,t=this;t.WD||(g.GC$(a).bind(M,function(e){t.BD(e)}).bind(I,function(e){t.CD(e)}),(e=t.OC.getActiveSheet())&&(e.XD=!0),t.WD=!0)},V.prototype.uC=function(){if(this.WD){this.WD=!1,g.GC$(a).unbind(M).unbind(I);var e=this.OC.getActiveSheet();e&&delete e.XD}},V.prototype.JD=function(e,t){var r,n=this;n.VD(),(r=n.sD()).length<=0||(0==(e%=4)?n.YD(r):1===e?(t||(n.ZD=S.setTimeout(function(){n.JD(1)},200)),n.$D(r)):2===e?(t||(n.ZD=S.setTimeout(function(){n.JD(2)},200)),n._D(r)):3===e&&n.aE(r))},V.prototype.KD=function(e,t,r){var n,o,i,a=this.OC;this.$C=e,this.ZC=t,a.suspendPaint(),n=a.getActiveSheet(),(o=a.getSheet(e))&&o.isEditing()&&o!==n&&(i=n&&n._formulaTextBox&&n._formulaTextBox._isSelectMode,!o._endEditImp(void 0,void 0,i))||(W(a,o,e),this.iw(e,r),a.resumePaint(),this.repaint())},V.prototype.BHb=function(e,t,r,n,o,i){var a={oldValue:r,newValue:n,sheetName:o,propertyName:"isSelected",cancel:!1,sheetIndex:i};e.Wq(m.Events.SheetChanging,a),a.cancel||(t._modelManager.CHb(n),e&&e.hq&&e.hq.repaint(),delete a.cancel,e.Wq(m.Events.SheetChanged,a))},V.prototype.MD=function(e){var t,r,n,o,i=this,a=i.OC,s=a.getActiveSheet();if((!i.bE||i.bE(s))&&(W(a,x,x),t=a.sheets.length,r=a.vv(a._getDefaultSheetName(t)),a.sheets.forEach(function(e){e.DHb(!1,!0)}),o={sheetName:n=r.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:t},i.BHb(a,r,!1,!0,n,t),a.Wq(m.Events.SheetChanging,o),!o.cancel)){for(a.ow(t,1,r),a.Wq(m.Events.SheetChanged,{sheetName:r.name(),propertyName:"insertSheet",sheetIndex:t}),i.$C=t,i.ZC=e,a.dq(t,1,!1,!0);i.$C>i.gq&&(i.YC()||i.gq<i.jw(-1));)i.hE(i.gq)&&(i.ZC-=i.WC[i.gq]),i.gq++;i.repaint()}},V.prototype.iw=function(r,e){var t,n,o,i,a,s,l,u=this,c=u.OC,h=c.sheets,f=c.getActiveSheet(),d=!1;f&&f._formulaTextBox&&f._formulaTextBox._isSelectMode&&(d=!0),e&&(t=m.Ul.sl()?e.metaKey:e.ctrlKey,n=e.shiftKey),r!==c.eq?(t?(i=(o=h[r]).name(),o.DHb()?u.BHb(c,o,!0,!1,i,r):(u.BHb(c,o,!1,!0,i,r),f.DHb()||(i=f.name(),u.BHb(c,f,!1,!0,i,r)))):n?(a=h.slice(A(c.eq,r),T(c.eq,r)+1),h.forEach(function(e){var t=e.name();e.visible()&&(-1!==a.indexOf(e)?e.DHb()||u.BHb(c,e,!1,!0,t,c.getSheetIndex(t)):e.DHb()&&u.BHb(c,e,!0,!1,t,c.getSheetIndex(t)))})):(s=h.every(function(e){return!e.visible()||e.isSelected()}),h[r].DHb()&&!s||h.forEach(function(e){e.DHb(!1,!0)}),i=(o=h[r]).name(),o.DHb()||u.BHb(c,o,!1,!0,i,r),c.dq(r,1,d,!0)),l=u.jw(u.gq),u.$C>u.gq&&u.ZC+u.WC[u.$C]>u._C()&&-1!==l&&(u.gq=l)):n&&h.forEach(function(e){var t=e.name();c.getSheetIndex(t)!==c.eq&&e.DHb()&&e.visible()&&u.BHb(c,e,!0,!1,t,r)}),u.$C<u.gq&&(u.gq=u.rw(u.gq))},V.prototype.cE=function(e,t){var r,n,o,i,a,s,l,u,c,h=this,f=h.OC,d=h.hitTest(e,t);if(d.element===P){if(r=h.$C,n=f.sheets[r],d.index!==r)return;if(f.Wq(m.Events.SheetTabDoubleClick,{sheet:n,sheetName:n.name(),sheetTabIndex:r}),!f.options.tabEditable)return!1;if((o=m.Vl.Xl())&&o.endEdit&&!o.endEdit())return;m.Vl.Zl(x),i=h.WC[r],a=g.GC$(h.Ws()).offset(),s=f.xv(),l=g.GC$(s).offset(),c=(u=C("input")).style,u.type="text",u.value=n.name(),u.setAttribute("contentEditable","true"),u.setAttribute("autocomplete","off"),c.position="absolute",c.margin="0px",c.padding="0px",c.left=a.left-l.left+h.ZC+h.EC+"px",c.top=a.top-l.top+h.aD()+"px",c.width=i-h.EC-h.GC+2+"px",c.backgroundColor=O,c.borderWidth="0px",c.outline="none",g.GC$(u).appendTo(s),h.FD=u,g.GC$(u).addClass("gc-sheetTabEditor").bind(R,function(e){return 13===e.keyCode?(h.GD(n,!1),!1):27===e.keyCode?(h.GD(n,!0),!1):void 0}).bind(D,function(){u.selectionStart=0,u.selectionEnd=u.value.length}).bind(N,function(){h.GD(n,!1)}),u.focus()}return!1},V.prototype.ED=function(e){var t,r,n,o,i={e:e,r:x};return V.ao(this,"preProcessMouseDbClick",i),y(t=i.r)?(r=g.GC$(this.Ws()).offset(),n=e.pageX-r.left,o=e.pageY-r.top,this.cE(n,o)):t},V.prototype.GD=function(e,t){var r,n,o,i,a=this.FD;a&&(g.GC$(a).unbind(R).unbind(D).unbind(N),r=a.value,!1!==t||r!==(n=e.name())&&(!y(r)&&""!==r&&s(r,this.OC.sheets,e)?(o={sheet:e,oldValue:n,newValue:r,cancel:!1},e.Wq(m.Events.SheetNameChanging,o),!1===o.cancel&&(e.wu().execute({cmd:"renameSheet",sheetName:n,name:r}),i={sheet:e,oldValue:n,newValue:r},e.Wq(m.Events.SheetNameChanged,i))):e.Wq(m.Events.InvalidOperation,{sheet:e,sheetName:e.name(),invalidType:5,message:G().Exp_SheetNameInvalid})),a.parentNode.removeChild(a),delete this.FD)},V.prototype.dE=function(){return this.OC.options.allowSheetReorder},V.prototype.LD=function(e,t){this.dE()?(this.vD=t.index,this.TD=this.eE(this.vD),this.OD=new m.Point(e.pageX,e.pageY),this.tC()):this.PD=!1},V.prototype.eE=function(e){var t,r,n=this.OC.sheets;if(!(n.length<=e||e<0))return t=(t=n[e].name())||"sheet",(r=g.GC$(C("span")).text(t).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"})).addClass("ui-widget-header gc-tab-tip-span btn-primary"),r},V.prototype.VD=function(){var e=this.ZD;e&&(clearTimeout(e),this.ZD=x)},V.prototype.QD=function(e,t){var r,n,o=this.TD;o&&0===g.GC$(".gc-tab-tip-span").length&&(o.appendTo(a.body),o.hide()),r=o.width(),n=o.height(),o.css({left:e-r/2,top:t-n/2}),o.show()},V.prototype.RD=function(e){var t=this,r=g.GC$(t.Ws()),n=r.position(),o=r.offset(),i=e.pageX-o.left,a=e.pageY-o.top,s=t.hitTest(i,a),l=s.element,u=t.Dr(),c=t.VC(),h=t.OC.sheets.length,f=u.x+t._C(),d=t.yD;f<i?t.wD===x&&t.uD<h&&(t.wD=S.setInterval(function(){t._D(t.sD()),t.uD===h?(t.SD(),d.css({left:n.left+t.fE()-4,top:n.top-4}),d.show()):(t.uD++,d.hide())},100)):i<c?t.wD===x&&0<t.uD&&(t.wD=S.setInterval(function(){t.$D(t.sD()),0===t.uD?(t.SD(),d.css({left:n.left+c-4,top:n.top-4}),d.show()):(t.uD--,d.hide())},100)):(t.SD(),l!==P&&-1===t.Via().indexOf(l)||(l!==P||y(s.index)?t.uD=t.OC.sheets.length:t.uD=s.index,d.css({left:n.left+s.position-4,top:n.top-4}),d.show()))},V.prototype.fE=function(){var e,t=this.WC,r=this.sD(),n=this.gE(this.gq,r),o=this.VC()+this.LC;for(e=n;e<r.length;e++)o+=t[r[e]],o+=this.HC;return o},V.prototype.SD=function(){var e=this.wD;e&&(clearInterval(e),this.wD=x)},V.prototype.UD=function(){var e,t,r,n,o,i,a,s,l=this.OC,u=this.uD,c=this.vD,h=-1,f=l.getActiveSheet(),d=c,p=u;if(c<u-1&&(p=u-1),-1!==u&&-1!==c&&c!==u&&c!==u-1&&this.yD.isVisible()){if(e={sheet:f,sheetName:f.name(),oldIndex:d,newIndex:p,cancel:!1},s=e,l.Wq(m.Events.SheetMoving,s),e.cancel)return;if(r=void 0,n=(t=l.sheets)[c],u<c){for(r=c;u<r;r--)t[r]=t[r-1];t[u]=n,h=u}else if(c<u-1){for(r=c;r<u-1;r++)t[r]=t[r+1];t[u-1]=n,h=u-1}l.eq=h,this.fq(),o=f,i=d,a=p,l.Wq(m.Events.SheetMoved,{sheet:o,sheetName:o?o.name():x,oldIndex:i,newIndex:a})}},V.prototype.sD=function(){var e,t=[];for(e=0;e<this.OC.sheets.length;e++)this.hE(e)&&t.push(e);return t},V.prototype.YD=function(e){0<e.length&&this.gq!==e[0]&&this.OC.startSheetIndex(e[0])},V.prototype.$D=function(e){var t;0<e.length&&this.gq>e[0]&&-1!==(t=this.rw(this.gq))&&this.OC.startSheetIndex(t)},V.prototype._D=function(e){0<e.length&&this.gq<e[e.length-1]&&-1!==this.rD(e)&&this.OC.startSheetIndex(this.jw(this.gq))},V.prototype.aE=function(e){if(0<e.length&&this.gq<e[e.length-1]){var t=this.rD(e);-1!==t&&this.OC.startSheetIndex(t)}},V.prototype.rD=function(e){var t,r,n,o,i,a,s,l;if(0<e.length)for(t=this._C(),r=0,n=this.WC,o=void 0,i=this.cD(),-1===(a=this.gE(this.gq,e))&&(a=0),o=e.length-1;a<=o;o--)if(r+=n[e[o]],o!==e.length-1&&(r+=this.HC),s=i+r,0!==o&&(s+=this.LC),t<s)return l=o+1<e.length?e[o+1]:e[e.length-1],this.gq<l?l:-1;return-1},V.prototype.rw=function(e){var t;for(t=e-1;0<=t;t--)if(this.hE(t))return t;return-1},V.prototype.jw=function(e){var t,r=this.OC.sheets.length;for(t=e+1;t<r;t++)if(this.hE(t))return t;return-1},V.prototype.gE=function(e,t){var r;for(r=0;r<=t.length-1;r++)if(e===t[r])return r;return-1},V.prototype.hE=function(e){var t=this.OC.sheets[e];return t&&t.visible()},V.prototype.fw=function(){this.xD++},V.prototype.gw=function(){this.xD--,this.xD<=0&&(this.xD=0,this.repaint())},V.prototype.repaint=function(e){var t=this.Ws();t&&t.getContext&&this.jp(t.getContext("2d"),e)},V.prototype.jp=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g=this;if(!(0<g.xD)){if(r=g.Dr(),n=g.Xs,t){if(t.x>=r.x+r.width)return;if(t.y>=r.y+r.height)return;if(t.x+t.width>r.width&&(t.width=r.width-t.x,t.width<=0))return;if(t.y+t.height>r.height&&(t.height=r.height-t.y,t.height<=0))return;if(t.width<=0||t.height<=0)return}if((i=g.buffer)&&(!i||i.width===n.width&&i.height===n.height)&&(i||i.width===r.width&&i.height===r.height)||(i&&m.En.Rn(g.OC,i),g.buffer=i=C("canvas"),m.En.Kn(i,g.OC),m.En.Pn(i,r.width,r.height)),!(r.width<=0||r.height<=0||t&&(t.width<=0||t.height<=0))){(o=g.buffer.getContext("2d")).clearRect(0,0,r.width,r.height),m.Bn.Dn(o,-r.x,-r.y),g.iE(o,t),m.Bn.Dn(o,r.x,r.y),l=a=0<=r.x?0:-r.x,u=s=0<=r.y?0:-r.y,t&&(l=r.x+t.x,u=r.y+t.y,r=new m.Rect(l,u,t.width,t.height)),a=0<=r.x?r.x:0,s=0<=r.y?r.y:0,f=x,d=m.En.Ln(n),p=m.En.Mn(n),n&&1!==d&&(l*=d,u*=p,r.x*=d,r.y*=p,r.width*=d,r.height*=p);try{h=n?t?(c=T(r.width-l,0),T(r.height-u,0)):(c=A(r.width-l,T(n.width-r.x,3)),A(r.height-u,T(n.height-r.y,3))):(l=t.x,u=t.y,c=t.width,t.height),n?(m.Bn.Cn(e,1,1),e.clearRect(a,s,c,h),e.drawImage(g.buffer,l,u,c,h,a,s,c,h),m.Bn.Cn(e,d,p)):f=(o=g.buffer.getContext("2d")).getImageData(l,u,c,h)}catch(e){return}!n&&f&&0<r.width&&0<r.height&&e.putImageData(f,a,s)}}},V.prototype.iE=function(e,t){var r,n,o,i,a,s,l,u,c,h=this,f=h.OC,d=f.options.scrollbarAppearance===v.ScrollbarAppearance.mobile;if(e&&f){for(r=h.Dr(),e.save(),w(e,h._font),t?e.rect(t.x,t.y,t.width,t.height):e.rect(r.x,r.y,r.width,r.height),e.clip(),e.beginPath(),i=o=h.VC(),e.save(),e.font=p.To.Ro(e.font,"bold"),h.WC=[],s=f.sheets,a=0;a<s.length;a++)n=Math.round(e.measureText(s[a].name()).width)+h.GC+h.EC,h.WC.push(n);for(e.restore(),l=[],0<(u=h.gq)&&0<=h.rw(u)&&(i+=h.LC),u<0&&(u=0),a=u;a<s.length&&(c=s[a].visible(),n=h.WC[a],!(i>r.x+r.width));a++)l.push({i:a,x:i,w:n,t:s[a].name(),visible:c}),c&&(i+=n+h.HC);h.dD(e,r),h.fD(e,r,i,o),h.jE(e,r,l,u,o),h.OC&&h.OC.options.tabNavigationVisible&&h.kD(e,r,o),d||h.nD(e,r),e.beginPath(),e.restore()}},V.prototype.dD=function(e,t){},V.prototype.fD=function(e,t,r,n){},V.prototype.TIc=function(){var e,t,r,n=this.OC.sheets,o=this.Dr(),i=[],a=this.VC(),s=this.gq;for(0<s&&0<=this.rw(s)&&(a+=this.LC),s<0&&(s=0),t=s;t<n.length&&(r=n[t].visible(),e=this.WC[t],!(a>o.x+o.width));t++)i.push({index:t,position:a,width:e,text:n[t].name(),visible:r}),r&&(a+=e+this.HC);return{tabsInfo:i,newTabStartPosition:a}},V.prototype.jE=function(e,t,r,n,o){var i,a,s,l,u,c,h,f=this.OC,d=f.sheets,p=this.iD;if(this.$C=f.getActiveSheetIndex(),i=this.$C,0<d.length){for(e.save(),e.beginPath(),a=t.x+this._C(),e.rect(o,0,a-o,t.height),e.clip(),s=r.length-1;0<=s;s--)(l=r[s]).i!==i&&l.visible&&(u=f.getSheetFromName(l.t).DHb(),this.oD(e,l.x,0,l.w,t.height,5,!1,l.i===p,l.t,u));c=r[i-n],n<=i&&i<d.length&&c&&c.visible&&(h=f.getActiveSheet().isSelected(),this.oD(e,c.x,0,c.w,t.height,5,!0,!1,c.t,h)),e.restore(),e.save(),e.beginPath(),0<n&&0<=this.rw(n)&&this.jD(e,t,n,o),e.restore()}},V.prototype.jD=function(e,t,r,n){},V.prototype.kD=function(e,t,r){},V.prototype.nD=function(e,t){},V.prototype.mD=function(e,t,r,n,o,i,a,s,l,u){},V.prototype.oD=function(e,t,r,n,o,i,a,s,l,u){},V.prototype.Ws=function(){return this.Xs},V.prototype.kE=function(e,t){var r,n,o,i,a=e.createLinearGradient(t.x,t.y,t.width,t.height),s=m.Im.Km(v.VisualState.normal,"gc-tabStripBackground"),l=s&&s.backgroundImage,u=s&&s.backgroundColor;if(l&&-1!==l.indexOf("linear-gradient"))for(n=0,o=(r=b(l)).length;n<o;n++)i=r[n],a.addColorStop(i.point,i.color);else u&&(a.addColorStop(0,"#DDDDDD"),a.addColorStop(1,u));return a},V.prototype.pD=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d=this.Dr(),p=e.createLinearGradient(d.x+.7*d.height,d.y+0,.7*d.height,d.height),g=this.OC.getSheetFromName(r);if(""===r&&0<this.gq&&(g=this.OC.getSheet(this.gq-1)),o=g&&g.options.sheetTabColor)e.fillStyle="rgba(0, 0, 0, 0)",i=e.fillStyle,e.fillStyle=m.Rm.Om(g,o),(a=e.fillStyle)!==i&&(t?(p.addColorStop(0,O),p.addColorStop(.45,"#F1F6FD"),p.addColorStop(.9,a),p.addColorStop(1,O)):p=a);else if(n)if(s=n.backgroundImage,l=n.backgroundColor,s&&-1!==s.indexOf("linear-gradient"))for(c=0,h=(u=b(s)).length;c<h;c++)f=u[c],p.addColorStop(f.point,f.color);else l&&p.addColorStop(0,l);return p},V.prototype.qD=function(e,t){var r="black";return e&&(r=e.color),t&&i.dc(i.ec(t))<127.5&&(r=O),r},U=V,t.DC=U,m.Zn(U)},"./dist/core/workbook/workbook-json.js":function(e,t,r){"use strict";var F,_,T,P,n,L,A,O,B,j,H,G,U,W,i;function V(e,t){return e.hasOwnProperty(t)}function z(e){var t,r,n,o;if(!e||"string"!=typeof e)return 1;if(3<(r=(t=e.split(".")).length))return 3;if(n=i(t[0]),r<=2)return isNaN(n)?1:n;if(o=i(t[1]),10<=n)return n;if(3<=n){if(20143<=o)return 3;if(20142<=o)return 2}return 1}function q(e,t){var r,n,o,i,a=t&&t.frozenColumnsAsRowHeaders,s=t&&t.frozenRowsAsColumnHeaders,l=0,u=e.sheets;if(s||a)for(n in u)"string"==typeof n&&(o=u[n],i=W(o.index)?o.index:o.mi,r=this.sheets[W(i)?i:l],s&&W(o.frozenRowCount)&&(r.$Bb=!0,r.deleteRows(0,o.frozenRowCount)),a&&W(o.frozenColCount)&&r.deleteColumns(0,o.frozenColCount),l++)}Object.defineProperty(t,"__esModule",{value:!0}),F=r("./dist/core/workbook/workbook.js"),_=r("./dist/core/worksheet/style.js"),T=r("./dist/core/util/domUtil.js"),P=r("./dist/core/util/tasks.js"),n=r("@grapecity/js-sheets-common"),L=r("./dist/core/util/common.js"),A=r("@grapecity/js-calc"),O=!!A,B=_.Style.kxb,j=n.Commands.UndoManager,H=n.Common.CultureManager,G=n.Common.j.C4,U=T.GC$.each,W=L.Ul.Ol,i=parseFloat,F.Workbook.prototype.toJSON=function(r){var e,t,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C=this,w={version:L.productInfo.productVersion},v=r&&r.rowHeadersAsFrozenColumns,S=r&&r.columnHeadersAsFrozenRows,x=v||S;if(x&&(r.Yec=!0),C.EHb&&(w.docProps=G(C.EHb)),O&&((e=A.Functions.setLanguagepackage)&&(t=e(),e("en"))),(n=C.getSheetCount())!==F.Workbook.nv&&(w.sheetCount=n),x)for((o=new F.Workbook).fromJSON(C.toJSON({includeBindingSource:!0})),C=o,i=0;i<n;i++)s=(a=C.getSheet(i)).getRowCount(1),l=a.getColumnCount(2),c=S&&0<s,(u=v&&0<l)&&a.addColumns(0,l),c&&a.addRows(0,s,c),u&&a.Zec(l,c?s:0),c&&a.$ec(s,u?l:0);for(C.mv=!0,C.suspendPaint(),C.suspendEvent(),O&&((h=C.Wu).calcOnDemand&&(h.calcOnDemand=!1,C.FHb(),h.suspend(!0),h.resume(!0),h.calcOnDemand=!0),h.suspend(!0)),(f=C.startSheetIndex())&&(w.startSheetIndex=f),U(C.options,function(e,t){"_ps"!==e&&F.Workbook.Qp[e]!==t&&(w[e]=t)}),(d=C.getActiveSheetIndex())!==F.Workbook.ov&&(w.activeSheetIndex=d),p={},g=0;g<n;g++)p[(a=C.getSheet(g)).name()]=a.toJSON(r),p[a.name()].index=g;if(T.GC$.isEmptyObject(p)||(w.sheets=p),m=[],b=C.Lq){for(y in b)V(b,y)&&m.push(b[y]);0<m.length&&(w.namedStyles=m)}return F.Workbook._features&&U(F.Workbook._features,function(e,t){t.toJson&&t.toJson.call(C,w,r)}),O&&e&&e(t),C.mv=!1,O&&C.Wu.resume(!1),C.resumeEvent(),C.resumePaint(),x&&delete r.Yec,w},F.Workbook.prototype.fromJSON=function(n,o){var i,e,a,t,r,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D;if(n){if(o&&o.incrementalLoading)return!0===o.incrementalLoading&&(o.incrementalLoading={}),this.egc(n,o);i=this,e=z(n.version),t={noSchema:a=e<3,version:e},r=L.Vl.Xl(),i.mv=!0,i.suspendPaint(),i.suspendEvent(),s=H.culture(),H.culture("");try{for(f in i.T3(),i.pv=new j(i,-1,i.options.allowUndo),O&&i.qv(!0),O&&i.Wu.suspendAdjust(),i._availableSheetIndex=-1,i.clearSheets(),l=i.options,u=n.canUserEditFormula,W(u)&&(l.allowUserEditFormula=u),c=n.allowDragDrop,W(c)&&(l.allowUserDragDrop=c),h=n.allowDragFill,W(h)&&(l.allowUserDragFill=h),l)V(l,f)&&(d=n[f],W(d)&&(l[f]=d));if(i.EHb=G(n.docProps),F.Workbook._features&&U(F.Workbook._features,function(e,t){var r=t.preFromJson;r&&r.call(i,n,a,o)}),p=n.sheetCount,W(p)||(p=F.Workbook.nv),i.sw(p,0),i.Lq={},g=n.namedStyles)for(m=0,b=g;m<b.length;m++)y=b[m],C=new _.Style,B(y,i),C.fromJSON(y,a,i),i.Kq(C);if(w=0,v=n.sheets,x=S=void 0,A=!(T=!1),v)for(k in v)"string"==typeof k&&(M=v[k],I=W(M.index)?M.index:M.mi,i.sheets[W(I)?I:w].fromJSON(M,!1,t,o,!0),w++,x=M.allowUndo,T?A=A&&x===S:(S=x,T=!0));W(S)&&A&&(l.allowUndo=S),E=n.activeSheetIndex,W(E)||(E=F.Workbook.ov),i.dq(E,0),(R=i.sheets[E])&&R.DHb(!0,!1),D=n.startSheetIndex,W(D)&&i.startSheetIndex(D),F.Workbook._features&&U(F.Workbook._features,function(e,t){var r=t.fromJson;r&&r.call(i,n,a,o)}),O&&i.Wu.resumeAdjust(),q.call(i,n,o)}finally{O&&i.Wu.resumeAdjust(),H.culture(s),i.mv=!1,R=i.getActiveSheet(),r&&R&&R.zt(),i.resumeEvent(),i.fq(),i.resumePaint(),R&&i.Wq(L.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:R})}}},F.Workbook.prototype.egc=function(r,n){var e,t,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N=this;N.fgc&&N.fgc.terminate(),N.fgc=new P.Tasks(function(){var e,t,r,n=N.getActiveSheet();if(!n.loaded)for(e=this.tasks.length-1;0<=e;e--)if((t=this.tasks[e].args[0])&&t._modelManager&&t.name&&t.name()===n.name())return r=this.tasks[e],this.tasks.splice(e,1),r;return this.tasks.pop()},function(){var e=N.getActiveSheet();return e&&(N.ku.Gw||e.isEditing()||e._eventHandler._isWorking||e._eventHandler.xG||e._eventHandler.eG)}),e=z(r.version),o={noSchema:t=e<3,version:e},i=L.Vl.Xl(),N.mv=!0,N.suspendPaint(),N.suspendEvent(),a=H.culture(),H.culture("");try{for(h in N.T3(),N.pv=new j(N,-1,N.options.allowUndo),O&&N.qv(!0),O&&N.Wu.suspendAdjust(),N._availableSheetIndex=-1,N.clearSheets(),s=N.options,l=r.canUserEditFormula,W(l)&&(s.allowUserEditFormula=l),u=r.allowDragDrop,W(u)&&(s.allowUserDragDrop=u),c=r.allowDragFill,W(c)&&(s.allowUserDragFill=c),s)V(s,h)&&(f=r[h],W(f)&&(s[h]=f));if(N.EHb=G(r.docProps),d=r.sheetCount,W(d)||(d=F.Workbook.nv),N.sw(d,0),N.Lq={},p=r.namedStyles)for(g=0;g<p.length;g++)m=p[g],b=new _.Style,B(m,N),b.fromJSON(m,t,N),N.Kq(b);if(y=0,w=r.sheets,S=v=void 0,T=!(x=!1),w)for(k in A={total:0,valuesLoad:0,formulaLoad:0},y=0,n.incrementLoadTask=N.fgc,n.incrementalLoading.loadStatus=A,w)"string"==typeof k&&(M=w[k],I=W(M.index)?M.index:M.mi,(C=N.sheets[W(I)?I:y]).loading=!0,C.cq(M.name+"",!0),C.DHb(M.isSelected),C.setRowCount(M.rowCount),C.setColumnCount(M.columnCount),A.total+=C.getRowCount(),N.fgc.addTask(function(e,t){e.egc(t,!1,o,n,!0)},[C,M]),y++,S=M.allowUndo,x?T=T&&S===v:(v=S,x=!0));W(v)&&T&&(s.allowUndo=v),E=r.activeSheetIndex,W(E)||(E=F.Workbook.ov),N.dq(E,0),(R=N.sheets[E])&&R.DHb(!0,!1),D=r.startSheetIndex,W(D)&&N.startSheetIndex(D),N.fgc.endingCallback=function(){F.Workbook._features&&U(F.Workbook._features,function(e,o){o.egc?N.fgc.addTask(function(e,t,r,n){o.egc.call(e,t,r,n)},[N,r,t,n]):o.fromJson&&o.fromJson.call(N,r,t,n)}),N.fgc.endingCallback=function(){var e,t;for(O&&N.Wu.resumeAdjust(),q.call(N,r,n),e=0;e<N.sheets.length;e++)delete N.sheets[e].loading;(C=N.getActiveSheet())&&N.Wq(L.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:C}),n&&n.incrementalLoading&&n.incrementalLoading.loading&&n.incrementalLoading.loading(1),(t=n&&n.incrementalLoading&&n.incrementalLoading.loaded)&&t()},N.fgc.start()},N.fgc.start()}finally{H.culture(a),N.mv=!1,R=N.getActiveSheet(),i&&R&&R.zt(),N.resumeEvent(),N.fq(),N.resumePaint()}}},"./dist/core/workbook/workbook.js":function(e,t,r){"use strict";var x,n,o,j,D,u,s,E,R,c,l,i,a,H,h,f,d,p,g,m,k,T,b,y,C,w,N,F,A,G,M,v,_,S,I,P,L,O,B,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce;function he(e){return e.getActiveSheet()}function fe(e){return D.En.npb()%1!=0||e.zoom()%1!=0}function de(e,t){return F.setTimeout(function(){e.invalidateLayout(),e.repaint(),t.GHb=G},200)}function pe(e){this.yw=e}function ge(e,t){var r,n,o=this;o.name="",o.kv=!1,o._availableSheetIndex=-1,o.eq=0,o.mv=!1,o.options=y(ue,function(e,t,r){o.Op(e,t,r)}),o.T3(t),t&&"white"===t.backColor?o.Sxb=!0:o.Sxb=!1,r=1,!t||"number"==typeof(n=t.sheetCount)&&(r=n),o._host=e,o.ad(r,e)}Object.defineProperty(t,"__esModule",{value:!0}),x=r("./dist/core/workbook/workbookpanelex.js"),n=r("./dist/core/core.ns.js"),o=r("@grapecity/js-sheets-common"),j=r("./dist/core/util/domUtil.js"),D=r("./dist/core/util/common.js"),u=r("./dist/core/util/imageLoader.js"),s=r("./dist/core/worksheet/worksheet-actions.js"),E=r("./dist/core/workbook/sheettab.js"),R=r("./dist/core/workbook/sheettab2007.js"),c=r("./dist/core/worksheet/stylehelper.js"),l=r("./dist/core/worksheet/clipboardhelper.js"),i=r("./dist/core/worksheet/worksheet.js"),a=!!r("@grapecity/js-calc"),H=r("./dist/core/core.enum.js"),h=o.Common.u,f=o.Commands.UndoManager,d=o.Commands.CommandManager,p=j.GC$.each,g=j.GC$.extend,m=a,k=o.Common.j.Fa,T=D.Ul.Nl,b=D.Ul.Pl,y=D.Ul.Ql,C=D.Ul.hZa,w=o.Common.CultureManager,N=parseInt,parseFloat,F=window,A=document,G=null,M=Math.round,v=Math.min,_=Math.abs,S="mouseenter",I="mouseleave",P="resize",L=".gcSpread",O=".gcSpreadInternal",B=".gcScrollbar",U="div",W="px",V="gc-scroll-handle",z="gc-scroll-bar",q="none",Z="content-box",Y=" ui-widget-header ui-state-default btn btn-default",K="gc-scroll-mobile-container",X="gc-scroll-mobile-container-horizontal",J="gc-scroll-mobile-container-vertical",Q="gc-scroll-mobile-spread-hovering",$="gc-scroll-mobile-state-hide",ee="gc-scroll-mobile-state-hover",te=F.jQuery,re="cultureChanged",ne="workbook",oe="gcUIElement",ie="gc-no-user-select",ae=new o.Common.ResourceManager(n.SR),se=ae.getResource.bind(ae),pe.Lv=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=e.data,A=T.ku;if(A.HHb&&(F.clearTimeout(A.HHb),A.HHb=G),(r=he(T))&&t){if(n=r.zoom(),o=t.newValue,i=t.oldValue,a=t.scrollEventType,s=T.options.scrollByPixel,l=T.options.scrollPixel,c=u=void 0,i=t.oldValue=k(i)?0:s?M(i):N(i+"",10),r.oq=!1,h=r.$t(),f=r.ps(),d=T.options.scrollbarShowMax,p=0,s){for(g=(o=M(o))-i,a!==H.Nxb.thumbTrack&&(o=i+(g*=l*n))<0&&(o=0),d||(r.oq=!0,a===H.Nxb.smallIncrement&&o===i?o+=l*n:t.ignoreUpdatePosition=!0),b=(m=r.frozenColumnCount())+(r.getColumnCount()-r.frozenTrailingColumnCount()-m)-1,C=y=0,w=m;w<=b;w++)if(o<=(y+=C=r.Tl(w))){p=y-o-C,u=w;break}k(u)&&(u=b,p=-r.Tl(b),o=y)}else u=N(o+"",10),u=r.du(u),a===H.Nxb.largeDecrement||a===H.Nxb.smallDecrement?(a===H.Nxb.largeDecrement&&(u=r.zw()),-1!==(c=r.Ot(u,!0))&&c!==u&&(u=c),d||(r.oq=!0,t.ignoreUpdatePosition=!0)):a!==H.Nxb.largeIncrement&&a!==H.Nxb.smallIncrement||(a===H.Nxb.largeIncrement&&(u=r.Aw())===r.qq&&u++,d||(r.oq=!0,a===H.Nxb.smallIncrement&&o===i&&u++),-1!==(c=r.Ot(u))&&c!==u&&(u=c)),u<h&&(u=h),f<u&&(u=f);v=s?M(o):r.Qt(u),t.newValue!==v&&(t.newValue=v),S=v,0!==(x=r.Tl(u))&&(S+=_(p)/x),t.newValueWithOffset=s?v:S,i===v&&!s||T.ku.Bw(u,p,!0)}},pe.Mv=function(e){var t,r,n,o=e.data,i=he(o),a=o.Pt;i&&a&&(a.QB===H.ScrollType.pixels||(t=i.du(a.value()),r=i.$t(),n=i.ps(),t<r?a.value(i.Qt(r)):n<t&&a.value(i.Qt(n))),o.xw(),o.options.scrollbarShowMax||(o.ku.scrolling?i.oq=!0:o.Ut()))},pe.Nv=function(e){var t,r,n,o,i,a=e.data;!a||(t=he(a))&&((r=a.Pt.xR)&&r.mR&&(t.CH=!0),t.zt(),1!==(n=a.options.showScrollTip)&&3!==n||(i=(o=j.GC$(e.srcElement||e.target)).parent(),(o&&(o.hasClass(V)||o.hasClass(z))||i&&(i.hasClass(V)||i.hasClass(z)))&&a.ku.Dw(!1,e)))},pe.Dv=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=e.data,A=T.ku;if(A.HHb&&(F.clearTimeout(A.HHb),A.HHb=G),(r=he(T))&&t){if(n=r.zoom(),o=t.newValue,i=t.oldValue,a=t.scrollEventType,s=T.options.scrollByPixel,l=T.options.scrollPixel,c=u=void 0,i=t.oldValue=k(i)?0:s?M(i):N(i+"",10),r.jq=!1,h=r._t(),f=r.ns(),d=T.options.scrollbarShowMax,p=0,s){for(g=(o=M(o))-i,a!==H.Nxb.thumbTrack&&(o=i+(g*=l*n))<0&&(o=0),d||(r.jq=!0,a===H.Nxb.smallIncrement&&o===i?o+=l*n:t.ignoreUpdatePosition=!0),b=(m=r.frozenRowCount())+(r.getRowCount()-r.frozenTrailingRowCount()-m)-1,C=y=0,w=m;w<=b;w++)if(o<=(y+=C=r.Sl(w))){p=y-o-C,u=w;break}k(u)&&(u=b,p=-r.Sl(b),o=y)}else u=N(o+"",10),u=r.cu(u),a===H.Nxb.largeDecrement||a===H.Nxb.smallDecrement?(a===H.Nxb.largeDecrement&&(u=r.Ew()),-1!==(c=r.Rt(u,!0))&&c!==u&&(u=c),d||(r.jq=!0,t.ignoreUpdatePosition=!0)):a!==H.Nxb.largeIncrement&&a!==H.Nxb.smallIncrement||(a===H.Nxb.largeIncrement&&(u=r.Fw())===r.lq&&u++,d||(r.jq=!0,a===H.Nxb.smallIncrement&&o===i&&u++),-1!==(c=r.Rt(u))&&c!==u&&(u=c)),u<h&&(u=h),f<u&&(u=f);v=s?M(o):r.Tt(u),t.newValue!==v&&(t.newValue=v),S=v,0!==(x=r.Sl(u))&&(S+=_(p)/x),t.newValueWithOffset=s?v:S,i===v&&!s||T.ku.Bw(u,p)}},pe.Ev=function(e){var t,r,n,o=e.data,i=he(o),a=o.St;i&&a&&(a.QB===H.ScrollType.pixels||(t=i.cu(a.value()),r=i._t(),n=i.ns(),t<r?a.value(i.Tt(r)):n<t&&a.value(i.Tt(n))),o.xw(),o.options.scrollbarShowMax||(o.ku.scrolling?i.jq=!0:o.Xt()))},pe.Fv=function(e){var t,r,n,o,i,a=e.data;!a||(t=he(a))&&((r=a.St.xR)&&r.mR&&(t.CH=!0),t.zt(),2!==(n=a.options.showScrollTip)&&3!==n||(o=j.GC$(e.srcElement||e.target))&&(i=o.parent(),(o.hasClass(V)||i&&i.hasClass(V)||o.hasClass(z)||i&&i.hasClass(z))&&a.ku.Dw(!0,e)))},pe.Gv=function(e){var t=e.data;t&&t.xw()},pe.ggc=function(e){var t,r,n,o=se(),i=e.data,a=e.scrollbar;i.options.enableAccessibility&&(t=j.GC$(a.Bv()).offset(),r=a.hitTest(e.x-t.left,e.y-t.top),n={thumbButton:o.ARIA_Scrollbar_Thumb_Button,trackButton:o.ARIA_Scrollbar_TRACK_Button,leftButton:o.ARIA_Scrollbar_Left_Button,rightButton:o.ARIA_Scrollbar_Right_Button,upButton:o.ARIA_Scrollbar_Top_Button,downButton:o.ARIA_Scrollbar_Bottom_Button}[r.element],i.dgc(n))},pe.prototype.no=function(){this.yw=G},pe.prototype.Bw=function(e,t,r){var n=this,o=he(n.yw);o&&(n.Gw=!0,n.Hw=r?o.lq:e,n.bCb=r?o.cCb:t,n.Iw=r?e:o.qq,n.dCb=r?t:o.eCb,F.setTimeout(function(){n.Kw()},0))},pe.prototype.Kw=function(){he(this.yw)&&this.Gw&&(this.Gw=!1,this.Lw())},pe.prototype.Lw=function(){var e,t,r,n,o,i,a,s=this;s.Mw||(s.Mw=!0,(t=he(e=s.yw))&&(r=e.options.showScrollTip,n=s.Hw,o=s.bCb,i=s.Iw,a=s.dCb,n!==t.lq||o!==t.cCb?(s.ju(n,o),2!==r&&3!==r||e.ww(s.Nw(!0))):i===t.qq&&a===t.eCb||(s.lu(i,a),1!==r&&3!==r||e.ww(s.Nw(!1)))),s.Mw=!1)},pe.prototype.ju=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I;if(this.GHb&&(F.clearTimeout(this.GHb),this.GHb=G),n=he(this.yw)){if(o=n.lq,i=n.cCb,!r&&e===o&&t===i)return;if(n.lq=e,n.cCb=t,0<n.Xq)return void n.Wq(D.Events.TopRowChanged,{sheet:n,sheetName:n.name(),oldTopRow:o,newTopRow:e});if(a=!1,u=(l=(s=n.options).sheetAreaOffset.top)+2,c=n.Zs,f=(h=n.am()).qt,d=h.jr,g=p=void 0,m=h.width+s.sheetAreaOffset.left,b=void 0,C=(y=n._render).bm(),n.tables&&0===n.frozenRowCount()&&(w=n.tables.KHb())&&(w.x=w.x-2,w.width=w.width+4,w.y=l,w.height=f,y.AI(C,w)),o<e||e===o&&_(t)>_(i)){if(S=v=void 0,(x=n.Gr(1))&&0<x.length&&(v=x.findRow(e)),v){for(S=x[T=x.length-1];S&&S.y+S.height>f+d;)S=x[--T];S&&S.row>e&&(a=!0,p=c?c.x:h.x,g=v.y+_(t),b=S.y+S.height-g-u,y.Ow(p,g,m,b,p,f),s.colHeaderVisible||(n.invalidateLayout(),y._l(C,new D.Rect(p,0,m,l))),n.invalidateLayout(),y._l(C,new D.Rect(p,f+b,m,d-b)),y.Pw(C,new D.Rect(p,f-2,m,d+2)))}}else{for(A=0,k=e;k<o&&A<d;k++)A+=n.Sl(k);(A+=_(i)-_(t))<d&&(a=!0,p=c?c.x:h.x,g=f,b=d-A,0<n.frozenTrailingRowCount()&&--b,y.Ow(p,g,m,b,p,g+A),n.invalidateLayout(),M=n.rowOutlines&&!n.rowOutlines.iT()?n.rowOutlines.s0a()+l+1:0,y._l(C,new D.Rect(p,g-l,m,A+l+M+5)),y.Pw(C,new D.Rect(p,f-2,m,d+2)))}a||(n.invalidateLayout(),n.repaint()),n.Wq(D.Events.TopRowChanged,{sheet:n,sheetName:n.name(),oldTopRow:o,newTopRow:e}),(I=n._eventHandler)&&I._updateEditingEditor(),a&&fe(n)&&(this.GHb=de(n,this))}},pe.prototype.lu=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M;if(this.GHb&&(F.clearTimeout(this.GHb),this.GHb=G),n=he(this.yw)){if(o=n.qq,i=n.eCb,!r&&e===o&&t===i)return;if(n.qq=e,n.eCb=t,0<n.Xq)return void n.Wq(D.Events.LeftColumnChanged,{sheet:n,sheetName:n.name(),oldLeftCol:o,newLeftCol:e});if(a=!1,u=(l=(s=n.options).sheetAreaOffset.left)+2,c=n.Zs,f=(h=n.am()).pt,d=h.er,m=g=p=void 0,b=h.height+s.sheetAreaOffset.top,C=(y=n._render).bm(),o<e||e===o&&_(t)>_(i)){if(v=w=void 0,(S=n.Hr(1))&&0<S.length&&(w=S.findCol(e)),w){for(v=S[x=S.length-1];v&&v.x+v.width>f+d;)v=S[--x];v&&v.col>e&&(a=!0,p=w.x+_(t),g=c?c.y:h.y,m=v.x+v.width-p-u,y.Ow(p,g,m,b,f,g),s.rowHeaderVisible||(n.invalidateLayout(),y._l(C,new D.Rect(0,g,l,b))),n.invalidateLayout(),y._l(C,new D.Rect(f+m,g,d-m,b)),y.Pw(C,new D.Rect(f-2,g,d+2,b)))}}else{for(T=0,A=e;A<o&&T<d;A++)T+=n.Tl(A);(T+=_(i)-_(t))<d&&(a=!0,p=f,g=c?c.y:h.y,m=d-T,0<n.frozenTrailingColumnCount()&&--m,y.Ow(p,g,m,b,p+T,g),n.invalidateLayout(),k=n.columnOutlines&&!n.columnOutlines.iT()?n.columnOutlines.s0a()+l+1:0,y._l(C,new D.Rect(p-l,g,T+l+k+5,b)),y.Pw(C,new D.Rect(f-2,g,d+2,b)))}a||(n.invalidateLayout(),n.repaint()),n.Wq(D.Events.LeftColumnChanged,{sheet:n,sheetName:n.name(),oldLeftCol:o,newLeftCol:e}),(M=n._eventHandler)&&M._updateEditingEditor(),a&&fe(n)&&(this.GHb=de(n,this))}},pe.prototype.Rw=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=this.yw,A=he(T),k=!1,M=T.St,I=T.Pt,E=T.options.scrollbarShowMax,R=T.options.scrollbarAppearance===H.ScrollbarAppearance.mobile;if(A){if(n=A.name(),e.ctrlKey){if(!T.options.allowUserZoom)return!0;if(o=A.zoom(),void 0===x&&(x=12),i=+parseFloat((o-.05*t).toPrecision(x)),A.isEditing()&&!A.endEdit())return;if(a={sheet:A,sheetName:A.name(),oldZoomFactor:o,newZoomFactor:i,cancel:!1},A.Wq(D.Events.ViewZooming,a),a&&!0===a.cancel)return!1;s={cmd:"zoom",sheetName:n,oldZoomFactor:o,zoomFactor:a.newZoomFactor},A.wu().execute(s),o!==(i=A.zoom())&&(delete a.cancel,A.Wq(D.Events.ViewZoomed,a),A.Wq(D.Events.UserZooming,a))}else r=r||0,l=A.lq,u=A.cCb,h=(c=this.ms(A,t)).cj,f=c.UP,l!==h||u!==f?(R&&(M.Jwa(H.ScrollbarState.show),this.Rdc(!0)),this.ju(h,f),A.os(),E||A.es()):k=!0,d=A.qq,p=A.eCb,m=(g=this.Sw(A,r)).dj,b=g.UP,d===m&&p===b||(R&&(I.Jwa(H.ScrollbarState.show),this.Rdc(!1)),this.lu(m,b),A.qs(),E||A.ds());y=A.Vs(),C=A.hitTest(e.pageX-y.left,e.pageY-y.top),(v=(w=A.yt)&&w.cellTypeHitInfo)&&(v.cellRect=A.getCellRect(w.row,w.col)),(S=A._eventHandler).Tw(C),S.Uw(C)}return k&&0===r},pe.prototype.aCb=function(e,t){var r,n,o,i,a,s,l,u,c=e.lq,h=e.cCb,f=e.parent,d=e.zoom(),p=M(t*f.options.scrollPixel*d),g=0,m=e.am().qt,b=e.jt(1).findRow(c);if(b)if(p<0){for(r=e.Rt(-1),g=-(m-b.y);r<c&&p<=g;)c--,g-=e.Sl(c);h=g-p,c===r&&0<h&&(h=0)}else if(0<p){for(n=e.ns(),g=b.y+b.height-m;c<n&&g<=p;)c++,g+=e.Sl(c);h=g-p-(o=e.Sl(c)),f.options.scrollbarMaxAlign?(i=e.am(),a=e.frozenRowCount(),s=e.getRowCount()-e.frozenTrailingRowCount()-1,n=(l=e.LHb(i.jr,a,s)).cj,u=l.UP,n<c?(c=n,h=u):c===n&&_(h)>_(u)&&(h=u)):c<n&&g-p==0?(c++,h=0):c===n&&g-p<0&&(h=-o)}return{cj:c,UP:h}},pe.prototype.ms=function(e,t){var r,n,o,i,a=e.lq,s=e.cCb,l=e.parent;return l&&l.options.scrollByPixel?l.ku.aCb(e,t):(0<(r=e.frozenRowCount())&&(0===a&&0<t?a=r:t<0&&a===r-t&&(a=0)),-1!==(n=e.Rt(a+t,t<0))?a=n:a+=t,o=e._t(),i=e.ns(),e.getRowCount()-r-e.frozenTrailingRowCount()<=0||o===G?a=e.lq:(a<o?a=o:i<a&&(a=i),a===G&&(a=-1)),{cj:a,UP:s})},pe.prototype._Bb=function(e,t){var r,n,o,i,a,s,l,u,c=e.qq,h=e.eCb,f=e.parent,d=e.zoom(),p=M(t*f.options.scrollPixel*d),g=0,m=e.am().pt,b=e.it(1).findCol(c);if(b)if(p<0){for(r=e.Ot(-1),g=-(m-b.x);r<c&&p<=g;)c--,g-=e.Tl(c);h=g-p,c===r&&0<h&&(h=0)}else if(0<p){for(n=e.ps(),g=b.x+b.width-m;c<n&&g<=p;)c++,g+=e.Tl(c);h=g-p-(o=e.Tl(c)),f.options.scrollbarMaxAlign?(i=e.am(),a=e.frozenColumnCount(),s=e.getColumnCount()-e.frozenTrailingColumnCount()-1,n=(l=e.MHb(i.er,a,s)).dj,u=l.UP,n<c?(c=n,h=u):c===n&&_(h)>_(u)&&(h=u)):c<n&&g-p==0?(c++,h=0):c===n&&g-p<0&&(h=-o)}return{dj:c,UP:h}},pe.prototype.Sw=function(e,t){var r,n,o,i,a=e.qq,s=e.eCb,l=e.parent;return l&&l.options.scrollByPixel?l.ku._Bb(e,t):(0<(r=e.frozenColumnCount())&&(0===a&&0<t?a=r:t<0&&a===r-t&&(a=0)),-1!==(n=e.Ot(a+t,t<0))?a=n:a+=t,o=e.$t(),i=e.ps(),e.getColumnCount()-r-e.frozenTrailingColumnCount()<=0||o===G?a=e.qq:(a<o?a=o:i<a&&(a=i),a===G&&(a=-1)),{dj:a,UP:s})},pe.prototype.Dw=function(e,t){var r,n,o=this.yw;he(o)&&(n=e?(r=t.pageY,t.pageX-100):(r=t.pageY-40,t.pageX-30),o.uw(this.Nw(e),n,r,!0))},pe.prototype.Nw=function(e){var t,r=he(this.yw),n=r.qq+1;return r&&(t=e?se().Tip_Row+(r.lq+1):(1!==r.options.colHeaderAutoText&&(n=D.Ul.xq(n)),se().Tip_Column+n)),t},pe.prototype.Sdc=function(e){j.GC$(e).addClass($)},pe.prototype.Tdc=function(e){j.GC$(e).removeClass($)},pe.prototype.Udc=function(e){j.GC$(e).addClass(ee)},pe.prototype.Vdc=function(e){j.GC$(e).removeClass(ee)},pe.prototype.Rdc=function(e,t){var r,n,o,i;void 0===t&&(t=1e3),n=(r=this).yw,o=e?n.Cv:n.Kv,i=function(){r.Vdc(o),r.Sdc(o)},(n.options.scrollbarAppearance=H.ScrollbarAppearance.mobile)&&(r.Wdc(e),e?r.Xdc=setTimeout(i,t):r.Ydc=setTimeout(i,t))},pe.prototype.Wdc=function(e){e&&this.Xdc?(clearTimeout(this.Xdc),this.Xdc=null):!e&&this.Ydc&&(clearTimeout(this.Ydc),this.Ydc=null)},le=pe,ue={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabEditable:!0,newTabVisible:!0,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:G,backgroundImageLayout:0,showResizeTip:H.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:H.ShowScrollTip.none,grayAreaBackColor:G,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:H.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,autoFitType:H.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:H.CopyPasteHeaderOptions.allHeaders,allowUserDragMerge:!1,rowResizeMode:H.ResizeMode.normal,columnResizeMode:H.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:H.ScrollbarAppearance.skin,font:G,customList:[],numbersFitMode:H.NumbersFitMode.mask},ge.prototype.commandManager=function(){return this.wu},ge.prototype.undoManager=function(){return this.pv},ge.prototype.Txb=function(){var e=this.Uxb(),t=this.Vxb;return t instanceof Array?t.concat(e):e},ge.prototype.Uxb=function(){var e=w.culture(),t=[],r=[],n=w.q4("en-US").DateTimeFormat,o=w.q4(e).DateTimeFormat;return t=this.Wxb(n),"en-US"!==e&&(r=this.Wxb(o)),t.concat(r)},ge.prototype.Wxb=function(t){var r,n,o=[];return this.Xxb=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.Xxb.forEach(function(e){(r=t[e])instanceof Array&&0<r.length&&(n=-1<e.indexOf("month")||-1<e.indexOf("Month"),r=n?r.slice(0,12):r,o.push(r))}),o},ge.prototype.FHb=function(){var e=m&&this.Cf();e&&e.NHb(),this.sheets.forEach(function(e){e.yj().OHb()})},ge.prototype.Op=function(e,t,r){var n,o=this,i=he(o),a=m&&o.Cf();switch(e){case"allowUndo":o.pv&&(o.pv.zc=t);break;case"backColor":o.Sxb=!0,i&&i.$p();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":i&&i.$p();break;case"backgroundImage":case"backgroundImageLayout":o.Ys(),i&&i.$p();break;case"newTabVisible":case"tabNavigationVisible":(n=o.hq)&&n.repaint();break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":o.fq();break;case"tabStripRatio":o.aq();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":i&&(i.oq=!0,i.jq=!0,i.$p());break;case"scrollByPixel":i&&(i.oq=!0,i.jq=!0,i.cCb=0,i.eCb=0,i.$p());break;case"scrollPixel":t<=0&&(o.options.scrollPixel=r);break;case"scrollbarAppearance":o.ku&&t!==r&&o.Zdc(t);break;case"calcOnDemand":a&&(!t&&a.calcOnDemand&&o.FHb(),a.calcOnDemand=t);break;case"customList":o.Vxb=t;break;case"referenceStyle":case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":o.PHb(e,t),i&&i.$p()}},ge.prototype.Zdc=function(e){var t;k(e)&&(e=H.ScrollbarAppearance.skin),t=e===H.ScrollbarAppearance.mobile,this.St.$dc(e),this.Pt.$dc(e),this._dc(),t?this.aec():this.bec(),this.refresh()},ge.prototype.PHb=function(e,t){var r=m&&this.Cf();if(r)switch(e){case"referenceStyle":r.useR1C1=1===t;break;case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":r[e]=t}},ge.prototype.ad=function(e,t){var r,n,o,i,a=this;for(m&&a.qv(),a.rv=[],a.sv=T("input"),a.jm=0,a.xD=0,a.tv={fromSheet:G,isCutting:!1},a.mmb={fromSheet:G,isCutting:!1},a.Ks=G,a.sheets=[],a.Lq={},a.Vxb=a.options.customList,a.pv=new f(a,-1,a.options.allowUndo),(r=a.wu=new d(a)).addListener("workbookUndo",function(e){var t,r,n=e.command,o=s.Commands.aWa(n),i=a.wu[n.cmd];i&&i.canUndo()&&!o&&!n.yTa&&((t=a.getSheetFromName(n.sheetName))&&(n.sheetId=t.yn),a.undoManager().Cc(n,e.s4)),1!==e.s4&&2!==e.s4||((r=a.getActiveSheet())&&r.name())!==n.sheetName&&a.setActiveSheet(n.sheetName)}),s.Commands.uv(r),ge.ao(a,"init"),n=0;n<e;n++)o=a.vv(a._getDefaultSheetName(n)),a.sheets.push(o),o.Ls(a);(i=a.sheets[a.eq])&&i.isSelected(!0),a.suspendPaint(),t&&a.ws(t),a.uu=new l.S4(a),a.resumePaint()},ge.prototype.hitTest=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N=this,F=N.getActiveSheet(),_=N.hq,P=N.Pt,L=N.St,O=j.GC$(N.getHost()).width(),B=j.GC$(N.getHost()).height();if(e<0||O<e||t<0||B<t)return G;if(n=N.oia(),N.options.scrollbarAppearance===H.ScrollbarAppearance.mobile){if(o=function(e,t,r,n,o){var i=e.pia(),a=t.left-r.left,s=t.top-r.top;if(a<n&&n<i.width+a&&s<o&&o<i.height+s)return{horizontalScrollBarHitInfo:{element:e.hitTest(n-a,o-s).element},x:n,y:o}}(P,j.GC$(N.Kv).offset(),n,e,t))return o;if(i=function(e,t,r,n,o){var i=e.pia(),a=t.left-r.left,s=t.top-r.top;if(a<n&&n<i.width+a&&s<o&&o<i.height+s)return{verticalScrollBarHitInfo:{element:e.hitTest(n-a,o-s).element},x:n,y:o}}(L,j.GC$(N.Cv).offset(),n,e,t))return i}if(F&&(a=F.Vs(),s=F.Dr(),l=a.left-n.left,u=a.top-n.top,l<e&&e<s.width+l&&u<t&&t<s.height+u))return{worksheetHitInfo:F.hitTest(e-l,t-u,!1,r),x:e,y:t};if(c=j.GC$(_.Ws()).offset(),h=_.Dr(),f=c.left-n.left,d=c.top-n.top,f<e&&e<h.width+f&&d<t&&t<h.height+d){switch(g={},m=(p=_.hitTest(e-f,t-d)).index,y=(b=N.sheets[m])&&b.name(),p.type){case"navButton":g={navButton:p.element};break;case"sheetTab":g={sheetTab:{sheetName:y||p.element,sheetIndex:m}};break;case"resize":g={resize:!0};break;default:g={blank:!0}}return{tabStripHitInfo:g,x:e,y:t}}return C=j.GC$(P.Bv()).offset(),w=P.pia(),v=C.left-n.left,S=C.top-n.top,v<e&&e<w.width+v&&S<t&&t<w.height+S?{horizontalScrollBarHitInfo:{element:P.hitTest(e-v,t-S).element},x:e,y:t}:(x=j.GC$(L.Bv()).offset(),T=L.pia(),A=x.left-n.left,k=x.top-n.top,A<e&&e<T.width+A&&k<t&&t<T.height+k?{verticalScrollBarHitInfo:{element:L.hitTest(e-A,t-k).element},x:e,y:t}:(M=j.GC$(N.Ov).offset(),I=parseInt(N.Ov.style.width.substr(0,N.Ov.style.width.indexOf("px")),10),E=parseInt(N.Ov.style.height.substr(0,N.Ov.style.height.indexOf("px")),10),R=M.left-n.left,D=M.top-n.top,R<e&&e<I+R&&D<t&&t<E+D?{footerCornerHitInfo:{element:"footerCorner"},x:e,y:t}:void 0))},ge.prototype.oia=function(){var e;return(e=te?te(this._host).offset():j.GC$(this._host).offset())?(e.top+=A.body.clientTop||0,e.left+=A.body.clientLeft||0):e={top:0,left:0},e},ge.prototype.T3=function(e){var r=this.options,t=e||{};t=g(!0,{},ue,t),p(t,function(e,t){r.hasOwnProperty(e)&&(r[e]=t)})},ge.prototype.xv=function(){return!this.Ks&&this._host&&(this.Ks=T(U),j.GC$(this.Ks).css({position:"relative",left:0,top:0,height:0}),j.GC$(this._host).prepend(this.Ks)),this.Ks},ge.prototype._getDefaultSheetName=function(e){var t,r,n,o,i,a,s=this.getSheetCount();this._availableSheetIndex<s?this._availableSheetIndex=s:this._availableSheetIndex++,(k(e)||e<this._availableSheetIndex)&&(e=this._availableSheetIndex),t=!1,n=this.sheets;do{for(r=(se().SHEET_NAME||"Sheet")+(e+1),o=n.length,i=0;i<o;i++)if(a=n[i]){if(a.name().toUpperCase()===r.toUpperCase()){e++,t=!0;break}t=t&&!1}}while(t);return r},ge.prototype.vv=function(e){return new i.Worksheet(e)},ge.prototype.ws=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S=this;if(e){for(S._host=e,te&&te(e).data(ne,S),j.GC$(e).data(ne,S).attr(oe,"gcSpread").addClass(ie).css("overflow","visible"),F.Yl.qm(),S.cultureChangedHandler=function(){S.Av()},A.addEventListener(re,S.cultureChangedHandler),r=(t=T("table")).style,s=a=i=o=n=void 0,l=S.options.scrollbarAppearance,u=S.options.scrollByPixel,t.cellSpacing="0px",t.cellPadding="0px",t.border="0",r.width="100%",r.height="100%",r.border="0",r.margin="0",r.borderCollapse="collapse",n=0;n<2;n++){for(i=T("tr"),o=0;o<2;o++)(s=(a=T("td")).style).padding=0,s.border=0,i.appendChild(a);t.appendChild(i)}for(e.appendChild(t),S.xs=T(U),S.xs.id=e.id+"vp",j.GC$(t.rows[0].cells[0]).append(S.xs),c=l===H.ScrollbarAppearance.mobile,h=u?H.ScrollType.pixels:H.ScrollType.continuous,S.St=new x.hv(!1,G,G,G,G,G,h,l,function(){S.cec(!0)}),f=S.St.Bv(),d=S.Cv=T(U),j.GC$(d).append(f),S.dec=t.rows[0].cells[1],j.GC$(f).bind("scroll"+B,function(e,t){var r=t.scrollEventType;e.data=S,1===t.scrollOrientation&&(0===r||1===r||2===r||3===r||5===r?le.Dv(e,t):4===r&&le.Ev(e))}).bind("mousedown"+B,function(e){e.data=S,le.Fv(e)}).bind("mouseup"+B,function(e){e.data=S,le.Gv(e)}).bind("mousemove"+B,function(e){e.data=S,e.scrollbar=S.St,le.ggc(e)}),g=(p=T("table")).style,p.cellSpacing="0",p.cellPadding="0",p.border="0",g.border="0",g.margin="0",j.GC$(p).css("user-select",q),i=T("tr"),o=0;o<2;o++)(s=(a=T("td")).style).padding=0,s.border=0,i.appendChild(a);p.appendChild(i),j.GC$(t.rows[1].cells[0]).append(p),b=void 0,(b=(m=S.Hv=T(U)).style).width=S.Iv()*j.GC$(e).width()+W,b.height=S.Jv()+W,b.fontSize="10pt",b.fontFamily="Arial",j.GC$(p.rows[0].cells[0]).append(m),S.Pt=new x.hv(!0,G,G,G,G,G,h,l,function(){S.cec(!1)}),y=S.Pt.Bv(),C=S.Kv=T(U),j.GC$(C).append(y),S.eec=p.rows[0].cells[1],j.GC$(y).bind("scroll"+B,function(e,t){var r=t.scrollEventType;e.data=S,0===t.scrollOrientation&&(0===r||1===r||2===r||3===r||5===r?le.Lv(e,t):4===r&&le.Mv(e))}).bind("mousedown"+B,function(e){e.data=S,le.Nv(e)}).bind("mouseup"+B,function(e){e.data=S,le.Gv(e)}).bind("mousemove"+B,function(e){e.data=S,e.scrollbar=S.Pt,le.ggc(e)}),S.Ov=T(U),j.GC$(t.rows[1].cells[1]).append(S.Ov),S.ku=new le(this),c&&S.aec(),S._dc(),w=S.oTa=function(){S.Pv()},j.GC$(F).bind(P+L,w),(v=he(S))&&v.ws(S.xs),S.Qv(),S.fq(),S.Rv(e),ge.ao(S,"setHost",e)}},ge.prototype._dc=function(){var e,t,r,n,o,i=this._host;this.ku&&(e=this.options.scrollbarAppearance===H.ScrollbarAppearance.mobile,t=this.dec,r=this.eec,n=this.Cv,o=this.Kv,j.GC$(n).removeAttr("style"),j.GC$(o).removeAttr("style"),e?(n.style.position="absolute",n.style.top="0px",n.style.left="0px",j.GC$(n).addClass(K+" "+J),j.GC$(i).css("position","relative").append(n),o.style.position="absolute",o.style.top="0px",o.style.left="0px",j.GC$(o).addClass(K+" "+X),j.GC$(i).append(o)):(j.GC$(t).append(n),j.GC$(r).append(o),j.GC$(n).removeClass(K+" "+$+" "+J+" "+ee),j.GC$(o).removeClass(K+" "+$+" "+X+" "+ee),j.GC$(i).css("position","auto")))},ge.prototype.aec=function(){var e=this,t=e._host,r=e.Cv,n=e.Kv;j.GC$(r).bind(S,function(){e.St.Jwa(H.ScrollbarState.active)}).bind(I,function(){e.St.Jwa(H.ScrollbarState.unactive)}),j.GC$(n).bind(S,function(){e.Pt.Jwa(H.ScrollbarState.active)}).bind(I,function(){e.Pt.Jwa(H.ScrollbarState.unactive)}),j.GC$(t).bind(S,e.fec).bind(I,e.gec)},ge.prototype.bec=function(){var e=this.Cv,t=this.Kv;e&&(j.GC$(e).unbind(S).unbind(I),this.ku.Wdc(!0)),t&&(j.GC$(t).unbind(S).unbind(I),this.ku.Wdc(!1)),j.GC$(this._host).unbind(S,this.fec).bind(I,this.gec)},ge.prototype.fec=function(){j.GC$(this).find("."+K).addClass(Q)},ge.prototype.gec=function(){j.GC$(this).find("."+K).removeClass(Q)},ge.prototype.Rv=function(e){var t=this,r=N(j.GC$(e).attr("tabindex"),10)||0,n=T(U);j.GC$(n).css({position:"absolute",overflow:"hidden"}).attr(oe,"gcSheetFocusElementForTab").attr("tabindex",r).bind("focus",function(){t.Sv||he(t).zt(),t.Sv=!1}),e.insertBefore(n,G),t.Tv=n},ge.prototype.Uv=function(){var e=this.Tv;e&&(this.Sv=!0,e.focus())},ge.prototype.hgc=function(){var e,t,r,n,o,i=this.getActiveSheet();if(i)if(D.Vl.Wl(i)){if(t=this._host)for(r=document.activeElement,n=document.body,o=r;o;){if(o===t){e=r;break}if(o===n)break;o=o.parentElement}}else i.Xs&&(e=i.Xs);return e},ge.prototype.dgc=function(t){var r=this;r.igc&&(F.clearTimeout(r.igc),r.igc=G),r.igc=F.setTimeout(function(){var e=r.hgc();e&&e.setAttribute("aria-label",t),F.clearTimeout(r.igc),r.igc=G},50)},ge.prototype.no=function(){var e,t,r,n,o,i=this,a=i.Pt,s=i.St,l=i.sheets,u=i.options.scrollbarAppearance===H.ScrollbarAppearance.mobile;for(D.En.Tn(i),D.Ul.no(),i.oTa&&j.GC$(F).unbind(P+L,i.oTa),i.oTa=G,i.Zv&&clearTimeout(i.Zv),a&&a.dispose(),s&&s.dispose(),i.mu(),D.Vl.Xl()===i.getActiveSheet()&&D.Vl.Zl(G),e=0;e<l.length;e++)l[e].no(!0);l.splice(0,l.length),(t=i.uu)&&(t.no(),i.uu=G),o="unselectable",(r=i._host)&&(n=j.GC$(r),A.removeEventListener(re,i.cultureChangedHandler),n.html("").removeAttr(oe).removeClass(ie),n.attr("class")||n.removeAttr("class"),n.attr(o)||n.removeAttr(o),n.data(ne)&&n.data(ne,G),te&&te(r).data(ne)&&te(r).data(ne,G)),u&&i.bec(),i.Kv=G,i.Cv=G,i.pv&&(i.pv.no(),i.pv=G),i.hq&&(i.hq.no(),i.hq=G),ge.ao(i,"dispose"),i.Tv&&(j.GC$(i.Tv).unbind("focus"),i.Tv=G),i.Wu&&(i.Wu.dispose(),i.Wu=G,i.yv=G,i.zv=G),i.bt&&(i.bt.no(),i.bt=G),c.To.no(),i.wu&&(i.wu.no(),i.wu=G),i.ku&&(i.ku.no(),i.ku=G)},ge.prototype.mu=function(){var e,t=this.sheets;for(j.GC$(this.sv).unbind(L),e=0;e<t.length;e++)t[e].mu()},ge.prototype.Qv=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x=this,T=N(D.Im.Lm("").zIndex),A=T!==x.Vv,k=x.options.scrollbarAppearance===H.ScrollbarAppearance.mobile,M=x._host.getAttribute("id")+"_tabStrip",I=x.hq;A&&(x.Vv=T),e=x.Jv(),t=x.Wv(),r=x.Xv(),I&&!A?I.repaint():(I&&I.no(),(I=x.hq=2007<T?new E.iv(M):new R.jv(M)).Yv(x),I.ws(x.Hv)),k?x.hec():(g=x.Cv,m=r,b=t,w=D.Im.Lm("gc-vertical-scrollbar"+Y),v=2007<N(w.zIndex)?1:0,C=(S=m-b)%2==0?(y=S/2)-v:y=(S-v)/2,j.GC$(g).css({"box-sizing":Z,border:q,"border-color":q,"border-left-style":"solid","border-left-width":v+W,"border-left-color":w.borderLeftColor,"background-color":w.backgroundColor,width:b,padding:"0px "+y+"px 0px "+C+W,margin:0}),s=x.Kv,l=e,u=t,f=D.Im.Lm("gc-horizontal-scrollbar"+Y),d=2007<N(f.zIndex)?1:0,h=(p=l-u)%2==0?(c=p/2)-d:c=(p-d)/2,j.GC$(s).css({"box-sizing":Z,border:q,"border-color":q,"border-top-style":"solid","border-top-width":d+W,"border-top-color":f.borderTopColor,"background-color":f.backgroundColor,height:u,padding:h+"px 0px "+c+"px 0px",margin:0})),n=x.Ov,o=r,i=e,a=D.Im.Lm("gc-footer-corner"+Y),j.GC$(n).css({border:q,padding:0,margin:0,width:o+W,height:i+W,"background-color":a.backgroundColor})},ge.prototype.Pv=function(){var e=this,t=e.Zv;t&&clearTimeout(t),e.Zv=F.setTimeout(function(){D.En.Un(),e.fq(),e.Zv=G},100)},ge.prototype.fq=function(){this.kv||(this.kv=!0,this.$v(),this.kv=!1)},ge.prototype.$v=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=this,v="display",S="block",x=w.Jv(),T=w.Wv(),A=w.Xv(),k=w._host;k&&(t=(e=w.options).showVerticalScrollbar,r=e.showHorizontalScrollbar,n=e.tabStripVisible,o=e.scrollbarAppearance===H.ScrollbarAppearance.mobile,i=r||n,s=(a=j.GC$(k)).width(),l=a.height(),u=w.Ov,c=w.Pt,h=w.St,f=w.xs.style,d=w.Hv.style,o&&!n&&r&&(x=0),j.GC$(u).css(v,o?n?S:q:i?S:q),f.width=s-(t&&!o?A:0)+W,j.GC$(w.Cv).css(v,t?S:q),j.GC$(u).css("width",(t&&!o?A:0)+W),p=l-(i?x:0),f.height=(2<=p?p:2)+W,j.GC$(w.Kv).css(v,i?S:q),j.GC$(u).css("height",i?x:"0px"),r?j.GC$(c.Bv()).show():j.GC$(c.Bv()).hide(),g=j.GC$(w.xs).width(),(m=M(w.Iv()*g))===g&&(m=g-1),d.width=m+W,d.height=x+W,h.Vo(T),h._v(j.GC$(w.xs).height()),b=s-(n&&!o?m:0)-(t?A:0),c.Vo(0<b?b:1),c._v(T),(y=he(w))&&(0===y.lq&&(y.lq=y._t()),0===y.qq&&(y.qq=y.$t()),y.fq()),o&&w.hec(),w.Ut(),w.Xt(),o&&(w.St.Jwa(H.ScrollbarState.hide),w.Pt.Jwa(H.ScrollbarState.hide)),y&&(y.invalidateLayout(),y.repaint()),n?j.GC$(w.Hv).show():j.GC$(w.Hv).hide(),w.hq&&w.hq.fq(),s!==(C=a.width())&&2<_(s-C)&&!w.aw&&(w.aw=!0,setTimeout(function(){delete w.aw,w.$v()},1)))},ge.prototype.hec=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=this;k(w._host)||(e=j.GC$(w._host),(t=w.getActiveSheet())&&(r=t.am(),n=w.options.showVerticalScrollbar,o=j.GC$(w.Cv),i=j.GC$(w.Kv),a=e.width(),s=e.height(),l=w.options.tabStripVisible?w.Jv():0,u=r.x+r.Br,c=r.y+r.Cr,h=n?o.width():0,p=(f=s-l-(d=c))-N(o.css("padding-top"))-N(o.css("padding-bottom")),g=a-h-u,m=i.height(),b=l,y=u,C=g-N(i.css("padding-left"))-N(i.css("padding-right"))-2,w.St.Vo(h),w.St._v(p),w.Pt.Vo(C),w.Pt._v(m),o.css(["height","left","right","top"],[f,"auto",0,d]),i.css(["width","top","bottom","left"],[g,"auto",b,y])))},ge.prototype.Ut=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C=he(this),w=this.options;C&&(t=(e=this.Pt)&&e.QB===H.ScrollType.pixels,r=C.frozenColumnCount(),n=C.getColumnCount()-C.frozenTrailingColumnCount()-r,o=r,i=C.am(),a=0==n?o:o+n-1,s=C.qq,l=C.eCb,u=void 0,c=0,w.scrollbarMaxAlign?(t?(u=(h=C.MHb(i.er,o,a)).dj,c=h.UP):u=C.fu(i.er,o,a),a=u):t&&(c=-C.Tl(a)),w.scrollbarShowMax?t&&!w.scrollbarMaxAlign&&(c=-C.Tl(a)):(f=C.iu().lastNonNullCol,(d=C.fu(i.er,o,f))!==o||a<++d&&(d=a),a=d<s?s<a?s:a:d,c=l),a<s?(C.qq=a,C.eCb=t?c:0):s===a&&l<c&&(C.eCb=t?c:0),-1!==(p=C.Ot(C.qq))&&p!==C.qq&&(C.qq=p),e&&(y=b=m=g=0,t?(g=C.jgc(o),m=C.jgc(a)-c,b=i.er,y=C.jgc(C.qq)-C.eCb):(g=C.Qt(o),m=C.Qt(a),b=C.gu(),y=C.Qt(C.qq),b<1&&(b=1)),e.bw(g),e.cw(m),e.dw(b),e.ew(),e.value(y)))},ge.prototype.Xt=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C=he(this),w=this.options;C&&(t=(e=this.St)&&e.QB===H.ScrollType.pixels,r=C.frozenRowCount(),n=C.getRowCount()-C.frozenTrailingRowCount()-r,o=r,i=C.am(),a=0==n?o:o+n-1,s=C.lq,l=C.cCb,u=void 0,c=0,w.scrollbarMaxAlign?(t?(u=(h=C.LHb(i.jr,o,a)).cj,c=h.UP):u=C.eu(i.jr,o,a),a=u):t&&(c=-C.Sl(a)),w.scrollbarShowMax?t&&!w.scrollbarMaxAlign&&(c=-C.Sl(a)):(f=C.iu().lastNonNullRow,(d=C.eu(i.jr,o,f))!==o||a<++d&&(d=a),a=d<s?s<a?s:a:d,c=l),a<s?(C.lq=a,C.cCb=t?c:0):s===a&&l<c&&(C.cCb=t?c:0),-1!==(p=C.Rt(C.lq))&&p!==C.lq&&(C.lq=p),e&&(y=b=m=g=0,t?(g=C.kgc(o),m=C.kgc(a)-c,b=i.jr,y=C.kgc(C.lq)-C.cCb):(g=C.Tt(o),m=C.Tt(a),b=C.hu(),y=C.Tt(C.lq),b<1&&(b=1)),e.bw(g),e.cw(m),e.dw(b),e.ew(),e.value(y)))},ge.prototype.aq=function(){var e,t,r,n,o,i,a,s,l,u=this,c=u.Jv(),h=u.Wv(),f=u.Xv(),d=u._host,p=u.options.scrollbarAppearance===H.ScrollbarAppearance.mobile;d&&(t=(e=u.options).tabStripVisible,r=j.GC$(d).width(),n=u.Pt,o=u.Hv.style,i=j.GC$(u.xs).width(),(a=M(u.Iv()*i))===i&&(a=i-1),o.width=a+W,o.height=c+W,s=r-(t&&!p?a:0)-(e.showVerticalScrollbar?f:0),n.Vo(0<s?s:1),n._v(h),(l=he(u))&&0===l.qq&&(l.qq=l.$t()),u.Ut(),t?j.GC$(u.Hv).show():j.GC$(u.Hv).hide(),u.hq&&u.hq.fq())},ge.prototype.suspendPaint=function(){var e,t,r=this.hq,n=this.sheets;for(this.xD++,e=0,t=n;e<t.length;e++)t[e].suspendPaint();r&&r.fw()},ge.prototype.resumePaint=function(){var e,t,r=this.hq,n=this.sheets;for(this.xD-=0<this.xD?1:0,e=0,t=n;e<t.length;e++)t[e].resumePaint();r&&r.gw()},ge.prototype.isPaintSuspended=function(){return 0<this.xD},ge.prototype.Ys=function(){var e,t,r,n,o,i=this,a=i.options.backgroundImage,s=i.options.backgroundImageLayout,l=he(i);if(l&&a&&(e=void 0,j.GC$(l.Ws()).css({"background-image":"url('"+a+"')","background-repeat":"no-repeat"}),!k(s))){e=(e=i.bt)||(i.bt=new u.oo(function(){i.bt&&i.Ys()}));try{e.ko(a)?(t=e.lo(a),n=(r=l.Dr()).width,o=r.height,D.Ul.ql(l.Ws(),n,o,t.width,t.height,s)):e.fo(a)}catch(e){}}},ge.prototype.hw=function(e){this.hq.iw(this.getSheetIndex(e.name()))},ge.prototype.startSheetIndex=function(e){var t=this.hq;return 0===arguments.length?t?t.gq:0:(t&&(t.hE(e)||-1===(e=t.jw(e))&&(e=t.rw(e)),t.gq=e),this.aq(),this)},ge.prototype.Iv=function(){var e,t,r,n,o,i=this.options,a=this.options.scrollbarAppearance===H.ScrollbarAppearance.mobile;return i.showHorizontalScrollbar&&!a?(e=i.tabStripRatio,isNaN(e)?.5:(t=0,r=this.xs,n=this.hq,r&&n&&(o=j.GC$(r).width(),t=n.kw/o),e<t?e=t:1<e&&(e=1),e)):1},ge.prototype.destroy=function(){this.oTa&&j.GC$(F).unbind(P+L,this.oTa),this.no()},ge.prototype.repaint=function(){var e,t=this.hq;t&&t.repaint(),(e=he(this))&&e.repaint()},ge.prototype.refresh=function(){this._host&&(D.Im.Nm(),this.Qv(),this.fq(),this.repaint())},ge.prototype.getHost=function(){return this._host},ge.prototype.invalidateLayout=function(){var e=he(this);e&&e.invalidateLayout()},ge.prototype.addNamedStyle=function(e){this.Kq(e);var t=he(this);t&&t.$p()},ge.prototype.Kq=function(e){if(e){if(!e.name)throw Error(se().Exp_EmptyNamedStyle);var t=e.name.toUpperCase();this.Lq[t]=e}},ge.prototype.getNamedStyle=function(e){return this.Mq(e,!0)},ge.prototype.Mq=function(e,t){var r,n=this.Lq;return n&&e?((r=n[e=e.toUpperCase()])&&t&&this.Jq(),r):G},ge.prototype.Jq=function(){var e,t;for(e=0,t=this.sheets;e<t.length;e++)t[e].Jq()},ge.prototype.removeNamedStyle=function(e){var t,r,n=this.Lq;n&&e&&(e=e.toUpperCase(),n.hasOwnProperty(e)&&((t=n[e].formatter)&&"string"==typeof t&&this.QHb[t]&&this.RHb(t),delete n[e],this.Jq(),(r=he(this))&&r.$p()))},ge.prototype.getNamedStyles=function(){var r=[],e=this.Lq;return e&&p(e,function(e,t){r.push(t)}),this.Jq(),r},ge.prototype.getActiveSheet=function(){return this.sheets&&0<this.sheets.length?this.sheets[this.eq]:G},ge.prototype.setActiveSheet=function(e){this.lw(e,2)},ge.prototype.lw=function(e,t){var r,n=this.sheets,o=this.getActiveSheet();for(r=0;r<n.length;r++)n[r].name()===e&&this.dq(r,t);this.SHb(o)},ge.prototype.getActiveSheetIndex=function(){return this.eq},ge.prototype.setActiveSheetIndex=function(e){var t=this.getActiveSheet();this.dq(e,2),this.SHb(t)},ge.prototype.dq=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p;"number"==typeof e&&(e===(o=this).eq||(i=o.sheets[e])&&i.visible()&&(((a=D.Ul.rl()).ipad||a.iphone)&&(s=o.mw)&&(new Date).valueOf()-s<300||(c={oldSheet:l=he(o),newSheet:i,cancel:!(u={oldSheet:l,newSheet:i,needTriggerSheetChange:!0})},(h=u.needTriggerSheetChange&&n)&&(p=c,o.Wq(D.Events.ActiveSheetChanging,p)),!1===c.cancel&&(o.eq=e,i!==l&&(l&&(l.no(!1),l.charts&&l.charts.all().forEach(function(e){e.clearflexDVs()})),o.nw(i,t,!1,h,r)),o.fq(),h&&(f=l,d=i,o.Wq(D.Events.ActiveSheetChanged,{oldSheet:f,newSheet:d}))),(a.ipad||a.iphone)&&(o.mw=(new Date).valueOf()))))},ge.prototype.nw=function(e,t,r,n,o){var i,a,s;r||e.ws(this.xs),a=(i=D.Vl.Xl())&&i.parent===this,s=2===t?a:1===t,D.Vl.Zl(G),!this.mv&&s&&e.zt(o),e.qs(),e.os()},ge.prototype.SHb=function(e){var t=this.getActiveSheet();e&&e.DHb(!1,!1),t&&t.DHb(!0,!1)},ge.prototype.addSheet=function(e,t){var r=this.getActiveSheet();this.ow(e,2,t),this.SHb(r)},ge.prototype.ow=function(e,t,r){var n,o,i,a,s,l,u,c,h=this;if(r=r||h.vv(h._getDefaultSheetName(e)),i=(o=h.sheets).length,r.name()){for(n=0;n<i;n++)if(o[n].name()===r.name())throw se().Exp_NotSupported}else r.cq(h._getDefaultSheetName(e));for(h.pw(r),a=he(h),s=h.eq,l=i-e,u=[],n=0;n<l&&0<i;n++)u.push(o.pop());for(o.push(r),r.Ls(h);0<u.length;)o.push(u.pop());1===(i=o.length)?(h.xs&&r.ws(h.xs),h.eq=0):(s<0&&h.hq&&(s=h.hq.jw(s)),h.eq=s),(c=he(h))!==a&&(a&&a.no(!1),c&&h.nw(c,t,1===i,!0),h.fq()),h.hq&&(h.hq.gq<0&&(h.hq.gq=h.eq),h.hq.repaint())},ge.prototype.removeSheet=function(e){this.qw(e,2)},ge.prototype.qw=function(e,t){var r,n,o,i,a,s,l,u=this,c=u.sheets,h=u.Wu,f=u.hq,d=c.length;if(isNaN(e)||e<0||d<=e)throw Error(se().Exp_IndexOutOfRange);if(r=e<=u.eq||e===d-1,n=he(u),e<u.eq&&u.eq--,(o=c[e]).mu(),c.splice(e,1),0===(d=c.length))u.eq=-1;else if(u.eq>=d)u.eq=f.rw(d);else{for(i=void 0,i=u.eq;i<d;i++)if(c[i].visible()){u.eq=i;break}d<=i&&(u.eq=f.rw(d))}!r||n!==(a=c[u.eq])&&(n&&n.no(!1),a&&u.nw(a,t,!1,!0)),h&&((s=o.yj()).VDc=e,h.removeSource(s)),o.no(!0,-1!==u.eq),m&&!h._parserContext&&u.sheets&&0<u.sheets.length&&(l=u.sheets[0],h.initParserContext(l.yj())),f&&(f.gq>=d?u.startSheetIndex(f.rw(d)):f.gq<0?u.startSheetIndex(f.jw(-1)):u.fq())},ge.prototype.clearSheets=function(){var e,t,r,n=this.sheets,o=this.Wu,i=this.hq;for(e=0,t=n;e<t.length;e++)(r=t[e]).mu(),r.no(!0);n.splice(0,n.length),o&&o.clearSource(),this.eq=-1,i&&(i.gq=-1,i.repaint())},ge.prototype.getSheet=function(e){var t=this.sheets;return 0<=e&&e<t.length?t[e]:G},ge.prototype.getSheetFromName=function(e){var t,r,n;for(t=0,r=this.sheets;t<r.length;t++)if((n=r[t]).name()===e)return n;return G},ge.prototype.getSheetIndex=function(e){var t,r=this.sheets;for(t=0;t<r.length;t++)if(r[t].name()===e)return t;return G},ge.prototype.getSheetCount=function(){return this.sheets.length},ge.prototype.setSheetCount=function(e){this.sw(e,2)},ge.prototype.sw=function(e,t){var r,n;if(e<0)throw se().Exp_ArgumentOutOfRange;if(0===e&&this.clearSheets(),e<(r=this.sheets.length))for(n=r-1;e<=n;n--)this.qw(n,t);else if(r<e)for(n=r;n<e;n++)this.ow(n,t)},ge.prototype.bind=function(e,t,r){var n,o,i=this.sheets;for(this.rv.push({type:e,data:t,fn:r}),j.GC$(this.sv).bind(e+L,t,r),n=0,o=i;n<o.length;n++)o[n].bind(e,t,r)},ge.prototype.unbind=function(e,t){var r,n,o,i=this.sheets,a=this.rv;for(r=0;r<a.length;r++)a[r].type===e&&a.splice(r,1);for(j.GC$(this.sv).unbind(e+L,t),n=0,o=i;n<o.length;n++)o[n].unbind(e,t)},ge.prototype.unbindAll=function(){var e,t,r=this.sheets;for(this.rv.length=0,j.GC$(this.sv).unbind(L),e=0,t=r;e<t.length;e++)t[e].unbindAll()},ge.prototype._bind=function(e,t,r){var n,o,i=this.sheets;for(this.rv.push({type:e,data:t,fn:r}),j.GC$(this.sv).bind(e+O,t,r),n=0,o=i;n<o.length;n++)o[n]._bind(e,t,r)},ge.prototype._unbind=function(e,t){var r,n,o,i=this.sheets,a=this.rv;for(r=0;r<a.length;r++)a[r].type===e&&a.splice(r,1);for(j.GC$(this.sv).unbind(e+O,t),n=0,o=i;n<o.length;n++)o[n]._unbind(e,t)},ge.prototype.nu=function(){var e,t,r=this.sheets;for(this.rv.length=0,j.GC$(this.sv).unbind(O),e=0,t=r;e<t.length;e++)t[e].nu()},ge.prototype.Wq=function(e,t){0===this.jm&&j.GC$(this.sv).trigger(e,t)},ge.prototype.tw=function(e,t,r,n){this.Wq(D.Events.ButtonClicked,{sheet:e,sheetName:e.name(),row:t,col:r,sheetArea:n})},ge.prototype.pw=function(e){var t,r,n;for(t=0,r=this.rv;t<r.length;t++)n=r[t],e.bind(n.type,n.data,n.fn)},ge.prototype.suspendEvent=function(){var e,t,r=this.sheets;for(this.jm++,e=0,t=r;e<t.length;e++)t[e].suspendEvent()},ge.prototype.resumeEvent=function(){var e,t,r=this.sheets;for(this.jm--,this.jm<0&&(this.jm=0),e=0,t=r;e<t.length;e++)t[e].resumeEvent()},ge.prototype.focus=function(e){if(!1===e)D.Vl.Zl(G);else{var t=he(this);t&&t.zt()}},ge.prototype.Wv=function(){return 2007<this.Vv?15:18},ge.prototype.Xv=function(){return 2007<this.Vv?22:this.Wv()},ge.prototype.cec=function(e){var t,r=e?this.Cv:this.Kv,n=e?this.St:this.Pt,o=this.options.scrollbarAppearance===H.ScrollbarAppearance.mobile;if(r&&n&&o)switch(t=this.ku,n.iec){case H.ScrollbarState.hide:t.Rdc(e);break;case H.ScrollbarState.show:t.Tdc(r),t.Wdc(e);break;case H.ScrollbarState.active:t.Tdc(r),t.Wdc(e),t.Udc(r);break;case H.ScrollbarState.unactive:t.Vdc(r),t.Rdc(e)}},ge.prototype.Jv=function(){return 2007<this.Vv?28:this.Wv()},ge.prototype.uw=function(e,t,r,n){var o;this.vw||(o=T(U),j.GC$(o).addClass("gc-spread-toolTip ui-state-default ui-widget-content btn-default").css({position:"absolute",padding:"0px 3px 0px 3px",font:C("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap"}).width("auto").height("auto").appendTo(A.body),this.vw=o),this.ww(e,t,r,n)},ge.prototype.ww=function(e,t,r,n){var o,i,a,s,l,u,c=he(this);!c||(o=this.vw)&&(i=j.GC$(o),e?(i.html(h.Ob(e)),i.show()):i.hide(),a=c.Vs(),n&&(r-=a.top,t-=a.left),l=(s=c.Dr()).x+s.width-i.outerWidth(),u=s.y+s.height-i.outerHeight(),l<0?t=0:u<0?r=0:(r=v(r,u),t=v(t,l)),k(r)||i.css("top",r+a.top),k(t)||i.css("left",t+a.left))},ge.prototype.xw=function(){var e=this.vw;e&&(j.GC$(e).remove(),this.vw=G)},ge.prototype.Av=function(){var e,t,r,n,o,i,a,s,l,u=this.sheets;for(D.mn.wn(),this.invalidateLayout(),e=0,t=u.length;e<t;e++)for(n=(r=u[e]).getRowCount(),o=r.getColumnCount(),i=0;i<n;i++)for(a=0;a<o;a++)(s=r.getValue(i,a))instanceof Date&&((l=r.getStyle(i,a))&&l.$o(s),r.Nq(i,a,l));this.repaint(),ge.ao(this,"onCultureChanged")},ge.prototype.getTab=function(){return this.hq},ge.Qp=ue,ge.nv=1,ge.ov=0,ce=ge,t.Workbook=ce,D.Zn(ce),ce.prototype.nextControl=b("nextControl",G),ce.prototype.previousControl=b("previousControl",G)},"./dist/core/workbook/workbookpanelex.js":function(e,t,r){"use strict";var _,n,o,P,i,d,y,s,L,a,l,c,O,C,B,j,H,G,u,U,W,V,h,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,f,p,g,m,b,w,v,oe,ie,S,x,T,A,k,M,I,E;function R(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function D(e,t,r,n,o,i,a,s,l){this.updateStateFn=l;var u=this;u.jec=s,u.JB=!1,u.KB=!1,u.LB=null,u.MB=null,u.NB=300,u.OB=70,u.PB=e,u.Jwa(P.ScrollbarState.show),u.Vo("number"==typeof t?t:0),u._v("number"==typeof r?r:0),u.dw("number"==typeof n?n:0),u.cw("number"==typeof o?o:0),u.bw("number"==typeof i?i:0),u.QB="number"==typeof a?a:1,u.RB=!1,u.SB=0,u.Qb=u.bw(),u.ew()}function N(e,t){this.fB=!0,this.gB=!0,this.hB=18,this.iB=e&&_.GC$(e),this.jB=t&&_.GC$(t),this.ew(!0)}Object.defineProperty(t,"__esModule",{value:!0}),_=r("./dist/core/util/domUtil.js"),n=r("./dist/core/util/common.js"),o=r("@grapecity/js-sheets-common"),P=r("./dist/core/core.enum.js"),i=r("./dist/core/workbook/sheettabbase.js"),d=o.Common.j.Fa,y=n.Ul.Ml,s=n.Ul.nl,L=n.Ul.Nl,a=n.Ul.Pl,l=document,c=window,O=Math.round,C=Math.ceil,B="gc-scroll-arrow",j="gc-scrollbar-wrapper",H="gc-scroll-mobile-track",G="gc-scroll-mobile-thumb",u="gc-scroll-mobile-state-active",U="gc-no-user-select",W="width",V="height",h="gc-scrollbar-stateActive ui-state-active",z="left",q="top",Z="position",Y="border",K="padding",X="margin",J="overflow",Q="display",$="100%",ee="borderWidth",te="boxSizing",re="absolute",ne="relative",p="mousedown"+(f=".gcScrollbar"),g="mouseup"+f,m="mousemove"+f,b="mouseover"+f,w="mouseout"+f,v="mousewheel",oe="inline-block",ie="content-box",S="DOMMouseScroll",x="scroll"+f,(E=T=T||{})[E.horizontalScroll=0]="horizontalScroll",E[E.verticalScroll=1]="verticalScroll",D.prototype.Bv=function(){return this.TB},D.prototype.Jwa=function(e){e===P.ScrollbarState.unactive&&this.JB||(this.iec=e,this.updateStateFn&&this.updateStateFn())},D.prototype.value=function(e){var t;return 0===arguments.length?this.Qb:("number"==typeof e&&e<=this.cw()&&e>=this.bw()&&(t=((this.Qb=e)-this.bw())*this.UB,this.scrollTo(t,!0)),this)},D.prototype.ew=function(){var e,t,r,n,o,i,a,s,l,u,c=this,h=0,f=0,d=!1,p=c.jec===P.ScrollbarAppearance.mobile,g=p?0:2,m="ui-widget ui-corner-all",b=c._v(),y=c.Vo(),C=p?0:b,w=y-2*C,v=C,S=z,x="right",T="gc-scroll-arrowLeft",A="gc-scroll-arrowRight",k="gc-scrollbar-horizontal",M="margin-left",I="ui-button ui-state-default ui-corner-bl btn btn-default",E="ui-icon ui-icon-triangle-1-w",R="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",D="ui-icon ui-icon-grip-solid-vertical",N="ui-button ui-state-default ui-corner-br btn btn-default",F="ui-icon ui-icon-triangle-1-e";c.VB=w,c.PB||(v=b-2*(w=C=p?0:y),S=q,x="bottom",T="gc-scroll-arrowUp",A="gc-scroll-arrowDown",k="gc-scrollbar-vertical",M="margin-top",I="ui-button ui-state-default ui-corner-tr btn btn-default",E="ui-icon ui-icon-triangle-1-n",R="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",D="ui-icon ui-icon-grip-solid-horizontal",N="ui-button ui-state-default ui-corner-br btn btn-default",F="ui-icon ui-icon-triangle-1-s",c.VB=v),e=c.VB,t=c.cw()-c.bw(),c.dC=c.dw()*e/(t+c.dw()),c.dC>e&&(c.dC=e),c.dC<10&&(c.dC=10),r=c.dC,c.UB=0==t?1:(e-r)/t,f=c.PB?(h=r,C):(h=C,r),c.WB||(d=!0,c.TB=L("div"),c.WB=_.GC$(c.TB),c.WB.css([Z,z,q,J,"outline",K,X],[ne,0,0,"hidden","none",0,0]).addClass("gc-scroll-container gc-scroll-corner-all "+m+" ")),p?c.WB.addClass(H):c.WB.removeClass(H),c.XB||(u=c.WB,c.XB=_.GC$.Nl("div",[Z,Q,ee,K,X,te],[re,oe,"1px",0,0,ie],B+" "+I,u),c.YB=_.GC$.Nl("span",[Q,Y,K,X],["block","none",0,0],T+" "+E,c.XB)),c.ZB||(l=c.WB,c.ZB=_.GC$.Nl("div",[Z,Q,te,Y,K,X],[re,oe,ie,"none",0,0],j+" "+j,l)),c.$B?c.$B.removeAttr("style"):(s=c.ZB,c.$B=_.GC$.Nl("div",[],[],U+" "+R+" gc-scroll-bar",s),c._B=_.GC$.Nl("span",[Q,Y,K,X],["block","none",0,0],k+" "+D,c.$B)),p?c.$B.css(Z,re).addClass(G):c.$B.css([Z,ee,K,X,te],[re,"1px",0,0,ie]).removeClass(G),c.aC||(a=c.WB,c.aC=_.GC$.Nl("div",[Z,Q,ee,K,X,te],[re,oe,"1px",0,0,ie],B+" "+N,a),c.bC=_.GC$.Nl("span",[Q,Y,K,X],["block","none",0,0],A+" "+F,c.aC)),p?(n=c.WB,o="border",(i=n.get(0))&&(i.style[o]=""),c.PB?(c.WB.css([W,V],[$,$]),c.ZB.css([S,W,V],[C,$,$]),c.$B.css([S,W,V],[c.SB,O(h-g),$])):(c.WB.css([W,V],[$,$]),c.ZB.css([S,W,V],[C,$,$]),c.$B.css([S,W,V],[c.SB,$,O(f-g)])),c._B.remove(),c.XB.remove(),c.aC.remove()):(c.WB.css([W,V,Y],[y,b,"none"]),c.ZB.css([S,W,V],[C,w,v]),c.$B.css([S,W,V],[c.SB,O(h-g),O(f-g)]),c.XB.css([S,W,V],[0,C-g,C-g]),c.YB.css([W,V],[$,$]),c.aC.css([x,W,V],[0,C-g,C-g]),c.bC.css([W,V],[$,$]),c._B.css([W,V,M],[C-g,C-g,Math.floor((c.dC-C)/2)]),c.$B.append(c._B),c.WB.append(c.XB),c.WB.append(c.aC)),d&&c.eC()},D.prototype.eC=function(){var n=this;function e(e,t){e.bind(p,function(e){n.fC(e,t)}).bind(g,function(e){n.gC(e,t)}).bind(b,function(e){n.hC(e,t)}).bind(w,function(e){n.iC(e,t)})}e(n.XB,!0),e(n.aC,!1),n.$B.bind(p,function(e){n.jC(e)}).bind(m,function(e){n.kC(e)}).bind(g,function(e){n.lC(e)}).bind(b,function(e){n.mC(e)}).bind(w,function(e){n.nC(e)}),n.ZB.bind(p,function(e){var t,r;y&&y.mozilla&&(t=(new Date).valueOf(),r=n.oC,n.oC=t,r&&t-r<100)||n.pC(e)}).bind(g,function(e){n.qC(e)}),n.GB=function(e){n.sC(e)},n.WB.bind(v,n.GB),n.WB.bind(S,n.GB),D.ao(n,"initEvents",n.TB)},D.prototype.$dc=function(e){this.jec=e},D.prototype.dispose=function(){var e=this;function t(e){e&&e.unbind(f)}t(e.aC),t(e.$B),t(e.XB),t(e.ZB),e.WB&&(e.GB&&(e.WB.unbind(v,e.GB),e.WB.unbind(S,e.GB)),D.ao(e,"dispose",e.TB),e.WB.unbind(f).remove())},D.prototype.tC=function(){var t=this;t.RB||(_.GC$(l).bind(m,function(e){t.kC(e)}).bind(g,function(e){t.lC(e)}),t.RB=!0)},D.prototype.uC=function(){this.RB&&(this.RB=!1,_.GC$(l).unbind(m).unbind(g))},D.prototype.fC=function(e,t){var r,n=0,o=this,i=!0;o.KB=!0,null===o.LB&&(t?(o.XB.addClass(h),n=0-o.qB(),o.vC=P.Nxb.smallDecrement):(o.aC.addClass(h),n=o.qB(),o.vC=1),(r=function(){o.scrollTo(o.SB+n*o.UB,!1),o.LB=c.setTimeout(r,i?o.NB:o.OB),i=!1})(),R(e))},D.prototype.gC=function(e,t){(t?this.XB:this.aC).removeClass(h),this.wC(),R(e)},D.prototype.hC=function(e,t){(t?this.XB:this.aC).addClass("gc-scroll-arrow-hover ui-state-hover"),R(e)},D.prototype.iC=function(e,t){(t?this.XB:this.aC).removeClass("gc-scroll-arrow-hover ui-state-hover "+h),this.wC(),R(e)},D.prototype.jC=function(e){var t,r,n,o,i,a,s=this;0===e.button&&(s.JB=!0,s.xC={x:e.pageX,y:e.pageY},s.Jwa(P.ScrollbarState.show),s.tC(),s.WB.addClass(u),s.$B.addClass(h),t=s.$B.offset(),r=s.$B.outerWidth(!0),n=s.$B.outerHeight(!0),o=s.ZB.offset(),i=s.ZB.outerWidth(!0),a=s.ZB.outerHeight(!0),s.yC={isBeyondEdge:!1,startEdgePosition:{x:o.left+e.pageX-t.left,y:o.top+e.pageY-t.top},endEdgePosition:{x:o.left+i-(r-e.pageX+t.left),y:o.top+a-(n-e.pageY+t.top)}}),R(e)},D.prototype.kC=function(e){this.JB&&(this.Jwa(P.ScrollbarState.active),this.zC={x:e.pageX,y:e.pageY},this.AC(),this.xC=this.zC,_.GC$(l.body).attr("unselectable","on").addClass(U)),R(e)},D.prototype.lC=function(e){var t,r,n,o=this;o.JB=!1,o.vC=P.Nxb.thumbPosition,o.yC=null,o.WB.trigger(x,{newValue:o.Qb,oldValue:o.Qb,scrollOrientation:o.PB?T.horizontalScroll:T.verticalScroll,scrollEventType:o.vC}),t=(o.Qb-o.bw())*o.UB,r="left",n=e.target.classList.contains(G),o.PB||(r="top"),n?o.Jwa(P.ScrollbarState.hide):o.Jwa(P.ScrollbarState.unactive),o.SB=t,o.$B.css(r,O(t)),o.uC(),_.GC$(l.body).removeClass(U),_.GC$(l.body).attr("unselectable")&&_.GC$(l.body).removeAttr("unselectable"),o.$B.removeClass(h),o.WB.removeClass(u),o.vC=6,o.WB.trigger(x,{newValue:o.Qb,oldValue:o.Qb,scrollOrientation:o.PB?T.horizontalScroll:T.verticalScroll,scrollEventType:o.vC}),R(e)},D.prototype.mC=function(e){this.$B.addClass("gc-scrollbar-stateHover ui-state-hover"),R(e)},D.prototype.nC=function(e){this.$B.removeClass("gc-scrollbar-stateHover ui-state-hover"),R(e)},D.prototype.sC=function(e){var t,r,n=this;d(e.wheelDelta)&&d(e.detail)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail),t=(e.detail?e.detail:e.wheelDelta/-40)/3*n.qB()*n.UB,n.vC=0<=t?1:0,n.scrollTo(n.SB+t,!1),n.vC=6,r={newValue:n.Qb,oldValue:n.Qb,scrollOrientation:n.PB?T.horizontalScroll:T.verticalScroll,scrollEventType:n.vC},n.WB.trigger(x,r),R(e)},D.prototype.pC=function(e){var r,n=this,o=!0,i=e.pageX,a=e.pageY,s=0,l=n.ZB.offset(),u=n.rB();null===n.MB&&(s=n.PB?i-l.left-n.SB:a-l.top-n.SB,(r=function(){var e,t=n.SB;if((e=n.PB?i-l.left-t:a-l.top-t)*s<0||0<=e&&e<n.dC)n.CC();else{if(s<0)n.vC=P.Nxb.largeDecrement,n.scrollTo(t-u*n.UB,!1);else{if(!(0<s))return void n.CC();n.vC=P.Nxb.largeIncrement,n.scrollTo(t+u*n.UB,!1)}n.MB=c.setTimeout(r,o?n.NB:n.OB),o=!1}})(),R(e))},D.prototype.qC=function(e){this.CC(),R(e)},D.prototype.CC=function(){var e;this.MB&&clearTimeout(this.MB),this.MB=null,this.vC=P.Nxb.endScroll,e={newValue:this.Qb,oldValue:this.Qb,scrollOrientation:this.PB?T.horizontalScroll:T.verticalScroll,scrollEventType:this.vC},this.WB.trigger(x,e)},D.prototype.wC=function(){var e,t=this;t.KB&&(t.KB=!1,t.LB&&clearTimeout(t.LB),t.LB=null,t.vC=6,e={newValue:t.Qb,oldValue:t.Qb,scrollOrientation:t.PB?T.horizontalScroll:T.verticalScroll,scrollEventType:t.vC},t.WB.trigger(x,e))},D.prototype.AC=function(){var e,t,r,n,o,i=this,a=i.SB,s=i.zC,l=i.yC;function u(e){return i.PB?e.x:e.y}function c(e,t){i.PB?e.x=t:e.y=t}if(e=u(s),t=u(i.xC),l&&l.isBeyondEdge){if(r=u(l.startEdgePosition),n=u(l.endEdgePosition),e<r||n<e)return;t<r&&c(i.xC,r),n<t&&c(i.xC,n)}(o=a+(e-t))!==a&&(i.vC=5,i.scrollTo(o,!1))},D.prototype.scrollTo=function(e,t){var r,n,o,i,a,s,l,u,c=this,h=q,f=c.VB-c.dC;c.PB&&(h=z),o=n=r=!1,f<e&&(e=f,n=o=!0),e<0&&(r=o=!(e=0)),c.yC&&(c.yC.isBeyondEdge=o),i=c.QB===P.ScrollType.continuous?O(e/c.UB)+c.bw():e/c.UB+c.bw(),a=c.Qb,s=!1,t||(u={newValue:i,oldValue:a,scrollOrientation:c.PB?T.horizontalScroll:T.verticalScroll,scrollEventType:c.vC,isBeyondMaxEdge:n,isBeyondMinEdge:r},c.WB.trigger(x,u),s=u.ignoreUpdatePosition,u.newValue>c.cw()&&(u.newValue=c.cw()),i=u.newValue,l=u.newValueWithOffset),d(l)&&(l=i),c.Qb=i,5!==c.vC&&(e=(l-c.bw())*c.UB),c.SB=e,s||c.$B.css(h,O(e))},D.prototype.hitTest=function(e,t){var r,n,o,i,a=this.$B.outerWidth(),s=this.XB.outerWidth(),l=this.ZB.outerWidth(),u=this.$B.offset(),c=_.GC$(this.Bv()).offset(),h=u.left-c.left-18;return this.PB?e<0+l+s&&0+s<e?e<h+a+s&&h<e?{element:P.Oxb.ThumbButton,x:e,y:t}:{element:P.Oxb.TrackButton}:e<=0+s&&0<e?{element:P.Oxb.LeftButton,x:e,y:t}:{element:P.Oxb.RightButton,x:e,y:t}:(r=this.$B.outerHeight(),n=this.XB.outerHeight(),o=this.ZB.outerHeight(),i=u.top-c.top-18,t<0+o+n&&0+n<t?t<i+r+n&&i<t?{element:P.Oxb.ThumbButton,x:e,y:t}:{element:P.Oxb.TrackButton}:t<=0+n&&0<t?{element:P.Oxb.UpButton,x:e,y:t}:{element:P.Oxb.DownButton,x:e,y:t})},D.prototype.pia=function(){return{x:0,y:0,width:this.Vo(),height:this._v()}},D.prototype.show=function(){this.ZB.show()},D.prototype.hide=function(){this.ZB.hide()},D.prototype.wDc=function(e){var t=this.WB.parent()&&this.WB.parent().parent();return t?e?t.height():t.width():null},A=D,t.hv=A,n.Zn(A),(k=A.prototype).qB=a("smallChange",1),k.rB=a("largeChange",10),k.dw=a("pageValue",10,function(e){e<=0&&this.dw(1)}),k.cw=a("maximum",100,function(e){e<=0&&this.cw(0)}),k.bw=a("minimum",0,function(e){e<=0&&this.bw(0)}),k.Vo=a("width",0),k._v=a("height",0),N.prototype.ew=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p=this;function g(e){return e===re?_.GC$.Nl("div",[Z,z,q,Y,K,X],[re,0,0,"none",0,0]):e===ne?_.GC$.Nl("div",[Z,z,q,Y,K,X],[ne,0,0,"none",0,0]):null}function m(e,t){var r,n,o,i=t?p.mB:p.nB;return i||(r=new A(t),n=_.GC$.Nl("div"),t?(p.oB=n,p.mB=r,n.css([Z,z,"bottom",Y,K,X],[re,0,0,"none",0,0])):(p.pB=n,p.nB=r,n.css([Z,"right",q,Y,K,X],[re,0,0,"none",0,0])),o=(t?p.mB:p.nB).Bv(),n.append(o),e.append(n),r)}function b(e,t,r,n,o,i){i?(p.oB.css([W,V],[t,n]),e.Vo(t),e._v(n)):(p.pB.css([W,V],[n,t]),e.Vo(n),e._v(t)),e.bw(0),e.cw(o-t),e.dw(t),e.qB(i?p.kB():p.lB()),e.rB(t),e.ew(),_.GC$(e.Bv()).bind(x,function(e,t){r.css(i?z:q,0-t.newValue)}),i?p.oB.show():p.pB.show()}p.iB&&p.jB&&(t=p.hB,r=p.jB.width(),n=p.jB.height(),a=(o=p.iB.width())-t,s=(i=p.iB.height())-t,l=!1,p.uB||(p.uB=g(ne),p.uB.css([Z,J],[ne,"hidden"]),l=!0),p.uB.css(V,i),d=p.uB,p.sB||(p.sB=g(ne),p.sB.css([J,Q],["hidden",oe]),d.append(p.sB)),f=p.sB,p.tB||(p.tB=_.GC$.Nl("div",Z,ne,null,f)),e&&p.tB.append(p.jB).css([q,z],[0,0]),y.chrome&&(r=O(r),n=O(n),o=C(o),i=C(i)),c=(u=p.vB(r,n,o,i)).wB,(h=u.xB)?(c||(a+=t),b(m(p.uB,!0),a,p.tB,t,r,!0)):p.oB&&p.oB.hide(),c?(h||(s+=t),b(m(p.uB,!1),s,p.tB,t,n,!1)):p.pB&&p.pB.hide(),h||c||(a+=t,s+=t),p.fB=h,p.gB=c,p.yB=a,p.zB=s,p.sB.css(V,s),l&&(p.iB.append(p.uB),p.AB()))},N.prototype.BB=function(e){var t=this.CB(e),r=t.EB,n=t.FB;!d(r)&&this.mB&&this.lu(r),!d(n)&&this.nB&&this.ju(n)},N.prototype.lu=function(e){var t,r;this.mB.value(e),t=this.yB,r=this.jB.width(),0<=e&&e<=r-t&&this.tB.css(z,0-e)},N.prototype.ju=function(e){var t,r;this.nB.value(e),t=this.zB,r=this.jB.height(),0<=e&&e<=r-t&&this.tB.css(q,0-e)},N.prototype.vB=function(e,t,r,n){var o=r,i=n-this.hB,a={xB:!1,wB:!1};return r<e&&(a.xB=!0,a.wB=i<t),n<t&&(a.wB=!0,a.xB=o<e),a},N.prototype.CB=function(e){var t,r,n,o,i,a,s,l=_.GC$(e),u=this.sB,c=this.tB,h={EB:null,FB:null};return e&&(t=l.offset(),r=c.offset(),n=u.offset(),t.leftWidth=t.left+l.outerWidth(),t.topHeight=t.top+l.outerHeight(),n.leftWidth=n.left+u.outerWidth(),n.topHeight=n.top+u.outerHeight(),o=t.left-r.left,t.left<n.left?h.EB=o:t.leftWidth>n.leftWidth&&(i=t.leftWidth-r.left-u.innerWidth(),h.EB=o<i?o:i),a=t.top-r.top,t.top<n.top?h.FB=a:t.topHeight>n.topHeight&&(s=t.topHeight-r.top-u.innerHeight(),h.FB=a<s?a:s)),h},N.prototype.AB=function(){var t=this;this.tB&&(t.GB=function(e){t.HB(e)},t.tB.bind(v,t.GB),t.tB.bind(S,t.GB))},N.prototype.HB=function(e){var t,r,n,o,i,a;d(e.wheelDelta)&&d(e.detail)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail),t=e.detail?e.detail:e.wheelDelta/-40,r=this.nB,n=parseInt(this.tB.css(q),10),o=this.zB,(i=this.jB.height())<o&&(i=o),isNaN(n)&&(n=0),0<=(a=n-t*this.lB())&&(a=0),a<0&&i-o<0-a&&(a=0-(i-o)),a!==n&&(this.tB.css(q,a),this.gB&&r.value(0-a)),s(e)},N.prototype.dispose=function(){var e=this;e.uB&&(e.mB&&e.mB.dispose(),e.nB&&e.nB.dispose(),e.tB&&e.GB&&(e.tB.unbind(v,e.GB),e.tB.unbind(S,e.GB)),_.GC$(e.uB).remove())},M=N,(I=(t.IB=M).prototype).kB=a("horizontalSmallChange",10),I.lB=a("verticalSmallChange",10),i.DC.$n("scrollbar",{preProcessMouseMove:function(e){var t=this.OC;(t.St.JB||t.Pt.JB)&&(e.r=!0)}})},"./dist/core/worksheet/clipboardhelper.js":function(e,t,r){"use strict";var $,n,w,v,R,ee,h,te,re,ne,oe;function a(e){return e&&e.options.allowCopyPasteExcelStyle}function d(e,t){var r,n;if(te.msie){for(r=[],n=0;n<e.length;n++)t&&""===e[n].trim()||r.push(e[n]);return r.join("")}return e.join("")}function D(e,t,r,n){var o,i,a=[];for(o=0,i=r;o<i;o++)a[o]=e.getRowHeight(t+o,n);return a}function N(e,t,r,n){var o,i,a=[];for(o=0,i=r;o<i;o++)a[o]=e.getColumnWidth(t+o,n);return a}function ie(e,t,r){var n,o=-1;if(r)for(n=o=0;n<t;n++)o+=r[e+n]||0;return o}function ae(e,t,r){var n,o=-1;if(r)for(n=o=0;n<t;n++)o+=r[e+n]||0;return o}function se(e){this.PA=oe,this.n5=oe,this.G4=!1,this.tc=e,this.Nl()}Object.defineProperty(t,"__esModule",{value:!0}),$=r("./dist/core/util/common.js"),n=r("@grapecity/js-sheets-common"),w=r("./dist/core/worksheet/stylehelper.js"),v=r("./dist/core/worksheet/style.js"),R=r("./dist/core/core.enum.js"),ee=n.Common.u,h=/<img[^>]+>/g,te=$.Ul.Ml,re=n.Common.j.Fa,ne=n.Common.k.Bb,oe=null,se.prototype.Nl=function(){var e,t,r,c=this,n=document.createElement("div");n.style.position="fixed",n.style.top="0px",n.style.left="0px",n.style.width="0px",n.style.height="0px",n.style.overflow="hidden",(e=document.createElement("div")).setAttribute("contenteditable","true"),e.setAttribute("gcUIElement","gcSheetClipboard"),e.setAttribute("tabindex","-1"),e.style.position="absolute",e.style.overflow="hidden",e.style.background="white",e.style.webkitUserSelect="text",n.appendChild(e),c.KM=e,(t=document.createElement("textarea")).setAttribute("gcUIElement","gcSheetClipboard"),c.tc&&c.tc.options.enableAccessibility&&t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","-1"),t.style.position="absolute",t.style.overflow="hidden",t.style.background="white",t.style.webkitUserSelect="text",n.appendChild(t),c.qka=t,(r=c.tc.getHost())&&r.appendChild(n),te.msie||te.edge||(c.H4=function(e){var r,t,n,o,i,a,s,l=c.tc.getActiveSheet(),u=e.clipboardData;if(u)if(r=(r=u.getData("text/html")).replace(h,""),(t=c.I4()).innerHTML=r,n=r?c.EZa(t,!0):se.formatClipboardData(u.getData("text/plain")),t.innerHTML="",n||r)l.J4(n,r);else{for(o=void 0,i=u.items,a=0;a<i.length;a++)if(0===i[a].type.indexOf("image")){o=i[a].getAsFile();break}o&&((s=new FileReader).onload=function(e){var t=new Image;t.src=e.target.result,t.onload=function(){l.J4(n,r,t.src)}},s.readAsDataURL(o))}e.preventDefault()},e.addEventListener("paste",c.H4),c.rka=function(e){var t,r,n,o=c.tc.getActiveSheet(),i=e.clipboardData;i&&((t=se.formatClipboardData(i.getData("text/plain")))||(r=i.getData("text/html"))&&((n=c.I4()).innerHTML=r,t=c.EZa(n,!1),n.innerHTML=""),o.J4(t,"")),e.preventDefault()},t.addEventListener("paste",c.rka))},se.prototype.no=function(){var e,t,r,n,o,i,a=this,s=a.KM;s&&(te.msie||te.edge||(s.removeEventListener("paste",a.H4),a.qka.removeEventListener("paste",a.rka)),!(e=s.parentElement)||(t=e.parentElement)&&t.removeChild(e),a.KM=oe,a.qka=oe),(r=a.K4)&&((n=r.parentElement)&&n.removeChild(r),a.K4=oe),(o=a.FZa)&&((i=o.parentElement)&&i.removeChild(o),a.FZa=oe),a.tc=oe},se.prototype.ska=function(e){a(this.tc)?this.KM.innerHTML=e:this.qka.value=e},se.prototype.M4=function(){a(this.tc)?this.KM.focus():this.qka.focus()},se.prototype.N4=function(){a(this.tc)?document.execCommand("selectAll"):this.qka.select()},se.prototype.wx=function(){var e,t,r,n="",o="",i="";return o=a(this.tc)?((e=this.KM)&&(0<(t=e.getElementsByTagName("table")).length?n=t[0].outerHTML:0<(r=e.getElementsByTagName("img")).length&&(i=r[0].src)),this.EZa(this.KM,!0)):se.formatClipboardData(this.qka.value),{html:n,text:o,image:i}},se.Q4=function(e,t,r,n,o,i,a,s,l,u,c,h,f,d){var p,g,m,b,y,C,w,v,S,x,T,A=e.Tq($.kf(r,o,n,i),a),k=RegExp(String.fromCharCode(32),"g"),M="&nbsp;",I=!1,E=!1;return a===R.SheetArea.viewport&&(r<0&&2==(2&t)&&(I=!0),o<0&&1==(1&t)&&(E=!0)),r=A.row,o=A.col,n=A.rowCount,i=A.colCount,p=c?e.options.gridline:oe,g=c?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:oe,m=f?D(e,r,n,a):oe,b=f?N(e,o,i,a):oe,a===R.SheetArea.viewport?(C=y=void 0,v=w=oe,S=se.Ema(e,r,n,o,i,3,l,u,s,A,k,M,p,h,m,b,d),E&&(y=f?N(e,o,i,2):oe,x=e.getColumnCount(2),w=se.Ema(e,r,n,0,x,2,l,[],s,A,k,M,g,h,m,y,d)),I&&(C=f?D(e,r,n,1):oe,T=e.getRowCount(1),v=se.Ema(e,0,T,o,i,1,[],u,s,A,k,M,g,h,C,b,d)),se.yb(S,w,v,d)):a===R.SheetArea.rowHeader?(w=se.Ema(e,r,n,o,i,2,l,u,s,A,k,M,g,h,m,b,d),se.yb(w,oe,oe,d)):a===R.SheetArea.colHeader?(v=se.Ema(e,r,n,o,i,1,l,u,s,A,k,M,g,h,m,b,d),se.yb(v,oe,oe,d)):void 0},se.yb=function(e,t,r,n){function o(e,t){var r,n=[],o=e.length;for(r=0;r<o;r++)n.push(e[r].concat(t[r]));return n}var i,a=e,s=0;return t&&(s=t[0].length,a=o(t,e)),r&&(i=r.length,s&&(r=o(se.Ema(oe,0,i,0,s,oe,[],[],!1,oe,oe,oe,oe,!1,[],[],n),r)),a=r.concat(a)),se.Fma(a,n)},se.Fma=function(e,t){var r,n,o="",i=e.length;for(o+=t?'<table style="border-collapse: collapse">':"<table>",r=0;r<i;r++){for(o+="<tr>",n=0;n<e[r].length;n++)o+=e[r][n];o+="</tr>"}return o+"</table>"},se.Ema=function(e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m){var b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q;for(f&&(b=f.color,y=f.showHorizontalGridline,C=f.showVerticalGridline),w=[],v=0;v<r;v++)if(!ne(a,S=t+v)){for(x=[],T=0;T<o;T++)ne(s,A=n+T)||(k="",I=M=void 0,R=E=1,l&&e&&((M=e.getSpan(S,A,i))&&se.isPartSpan(M,u,a,s)&&(M=oe),M&&(M.row!==S||M.col!==A))||(k+="<td",D=e&&e.getValue(S,A,i),l&&e&&(M&&(1<(E=M.rowCount)&&(k+=" rowSpan="+E),1<(R=M.colCount)&&(k+=" colSpan="+R)),I=e.getActualStyle(S,A,i),N=se.convertVAlign,F=se.convertHAlign,_=se.convertLineBorder,k+=m?' style="padding: 0; word-break: break-all; ':' style="',P=y,L=C,(O=I.backColor)&&(k+="background-color: "+O+";",L=P=!1),(B=I.foreColor)&&(k+="color: "+B+";"),(j=I.font)&&(d&&(j=j+", "+$.FallbackFontFamily),k+="font: "+j.replace(/"/g,"'")+";"),H=I.vAlign,re(H)||(k+="vertical-align: "+N(H)+";"),G=I.hAlign,re(G)||(m&&(G=$.Ul.ol(G,D)),(U=F(G))&&(k+="text-align: "+U+";")),(W=I.borderLeft)&&(k+="border-left: "+_(W)+";",L=!1),(V=I.borderRight)&&(k+="border-right: "+_(V)+";",L=!1),(z=I.borderTop)&&(k+="border-top: "+_(z)+";",P=!1),(q=I.borderBottom)&&(k+="border-bottom: "+_(q)+";",P=!1),P&&L?k+="border: 1px solid "+b+";":P?(k+="border-top: 1px solid "+b+";",k+="border-bottom: 1px solid "+b+";"):L&&(k+="border-left: 1px solid "+b+";",k+="border-right: 1px solid "+b+";"),k+='"'),k+=">",Y=Z=void 0,l&&e&&((Z=2==(2&(K=I.textDecoration)))&&(k+="<s>"),(Y=(Y=1==(1&K))||8==(8&K))&&(k+="<u>")),(X=e?e.getText(S,A,i):"")?(" "!==X[0]&&" "!==X[X.length-1]||"number"!=typeof D||(X=X.trim()),X=ee.Ob(X).replace(c,h)):te.chrome?X=" ":te.safari&&(X="&nbsp;"),0<(J=ie(v,E,p))&&--J,0<(Q=ae(T,R,g))&&--Q,k+=0<=J&&0<=Q?'<div style="overflow: hidden; height: '+J+"px; width: "+Q+'px;">'+X+"</div>":X,l&&(Y&&(k+="</u>"),Z&&(k+="</s>")),k+="</td>",x.push(k)));w.push(x)}return w},se.prototype.I4=function(){var e,t;return this.K4||((e=document.createElement("div")).style.display="none",(t=this.tc.getHost())&&t.appendChild(e),this.K4=e),this.K4},se.prototype.GZa=function(){var e,t;return this.FZa||((e=document.createElement("div")).style.display="none",(t=this.tc.getHost())&&t.appendChild(e),this.FZa=e),this.FZa},se.prototype.R4=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g=this.I4();if(g.innerHTML=e,0<(o=g.getElementsByTagName("table")).length)for(i=this.HZa(o[0],!0),a=0;a<i.length;a++)for(s=i[a],l=r+a,u=0;u<s.length;u++)(c=s[u])&&(h=n+u,t.Pq(l,h,c.style),f=c.rowSpan,d=c.colSpan,(1<f||1<d)&&((p=t.getSpan(l,h))?(p.row=l,p.col=h,p.rowCount=f,p.colCount=d):t.addSpan(l,h,f,d)));g.innerHTML=""},se.prototype.lgc=function(e,t,r,n){var o,i,a=t.pictures;a&&(o=function(e){for(var t=1,r="picture"+t;e.get(r);)r="picture"+ ++t;return r}(a),(i=a.add(o,e,0,0)).startRow(r),i.startColumn(n))},se.prototype.HZa=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d=this.GZa(),p=[],g=/ +/g;for(r=0;r<e.rows.length;r++)for(n=e.rows[r],p[r]||(p[r]=[]),o=p[r],a=i=0;i<n.cells.length;i++){for(s=n.cells[i];o[a];)a++;for(l=o[a]={},u=void 0,t&&(u=se.getStyleFromDOM(s),l.style=u),d.innerHTML=s.innerHTML.replace(g," "),l.text=d.innerText,l.rowSpan=s.rowSpan,(c=s.getAttribute("style"))&&0<=c.indexOf("mso-ignore:colspan;")?l.colSpan=1:l.colSpan=s.colSpan,h=0;h<s.rowSpan;h++)for(f=0;f<s.colSpan;f++)0===h&&0===f||(p[r+h]||(p[r+h]=[]),p[r+h][a+f]={style:u,text:"",rowSpan:1,colSpan:1});a+=s.colSpan}return d.innerHTML="",p},se.prototype.EZa=function(e,t){var r,n,o,i,a,s,l,u,c,h,f=[];if(e)if(0<(r=e.getElementsByTagName("table")).length)for(n=this.HZa(r[0],!1),o=RegExp(String.fromCharCode(160),"g"),i=String.fromCharCode(32),a=0,s=n.length;a<s;a++){for(u=0,c=(l=n[a]).length;u<c;u++)0<=(h=l[u]?l[u].text:"").indexOf("\n")&&(h=t?(0<=h.indexOf("\r\n")&&(h=d(h.split("\r\n"),!0)),d(h.split("\n"),!0)):'"'+h+'"'),f.push(h.replace(o,i)),u<c-1&&f.push("\t");a<s-1&&f.push("\r\n")}else f.push(function(e){var t,r,n;if(!e)return e;for(t=0;t<e.length&&!((r=e.indexOf("\x3c!--",t))<0)&&(t=r,!((n=e.indexOf("--\x3e",t))<0));)t=n,e=e.substring(0,r)+e.substring(n+3);return e}(e.innerText).trim());return f.join("")},se.prototype.hZ=function(e){this.PA=oe,this.n5=oe,this.G4=!1,this.tc.Wq("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!e})},se.isPartSpan=function(e,t,r,n){var o,i,a,s,l,u;if(!t.containsRange(e))return!0;for(o=0,i=r;o<i.length;o++)if(a=i[o],e.row<=a&&a<e.row+e.rowCount)return!0;for(s=0,l=n;s<l.length;s++)if(u=l[s],e.col<=u&&u<e.col+e.colCount)return!0;return!1},se.formatClipboardData=function(e){var t,r,n,o,i=[];if(e){for(t=!1,r=0;r<e.length;r++)n=0<r?e[r-1]:"",'"'===(o=e[r])?(t=!t,i.push('"')):t||"\n"!==o||"\r"===n?i.push(o):i.push("\r\n");return i.join("")}return""},se.convertHAlign=function(e){return{0:"left",1:"center",2:"right"}[e]},se.convertVAlign=function(e){return{0:"top",1:"middle",2:"bottom"}[e]},se.convertLineBorder=function(e){return{9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5}[e.style]+"pt "+{0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"}[e.style]+" "+e.color},se.convertToHAlign=function(e){return{left:0,center:1,right:2}[e]},se.convertToVAlign=function(e){return{top:0,middle:1,bottom:2}[e]},se.convertToLineBorder=function(e,t,r){var n={none:0,solid:1,dashed:3,dotted:4,double:6};return(te.msie||te.edge)&&"2px"===r?n.solid=5:(r=Math.round(10*parseFloat(r)*3/4)/10)<=.8?n.solid=1:r<=1?(n.solid=2,n.dashed=8):r<=1.5&&(n.solid=5),new v.LineBorder(e,n[t])},se.convertToTextDecoration=function(e){return{underline:1,"line-through":2,none:0}[e]},se.isTransparent=function(e){return 0===n.Common.pc.ec(e).a},se.isBlack=function(e){var t=n.Common.pc.ec(e);return 0!==t.a&&0===t.r&&0===t.g&&0===t.b},se.getStyleFromDOM=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g=e.getElementsByTagName("font")[0],m=getComputedStyle(e),b=e.style,y=new v.Style,C=m.backgroundColor;return C&&!se.isTransparent(C)&&(y.backColor=C),t=m.color,g&&(t=g.color),t&&!se.isBlack(t)&&(y.foreColor=t),g?y.font=w.To.F4(getComputedStyle(g)):(r=w.To.F4(m))&&(y.font=r),n=m.verticalAlign,o=se.convertToVAlign,i=se.convertToHAlign,a=se.convertToLineBorder,s=se.convertToTextDecoration,n&&(y.vAlign=o(n)),l=b.textAlign,u=m.textAlign,te.msie||te.edge?y.hAlign=i(""!==l?l:"general"):u&&(y.hAlign=i(u)),"none"!==(c=m.borderLeftStyle)&&(y.borderLeft=a(m.borderLeftColor,c,m.borderLeftWidth)),"none"!==(h=m.borderRightStyle)&&(y.borderRight=a(m.borderRightColor,h,m.borderRightWidth)),"none"!==(f=m.borderTopStyle)&&(y.borderTop=a(m.borderTopColor,f,m.borderTopWidth)),"none"!==(d=m.borderBottomStyle)&&(y.borderBottom=a(m.borderBottomColor,d,m.borderBottomWidth)),p=s(m.textDecorationLine||m.textDecoration),0<e.getElementsByTagName("u").length&&(p|=s("underline")),0<e.getElementsByTagName("s").length&&(p|=s("line-through")),0!==p&&(y.textDecoration=p),y},t.S4=se},"./dist/core/worksheet/style.js":function(e,t,r){"use strict";var l,a,u,c,h,n,o,s,m,b,f,d,p,g,y,C,i,w,v;function S(){var e,t;if(this.yn=S.Wo,S.Wo++,0!==(e=arguments).length)for(t=0;t<C.length;t++)this[C[t]]=e[t]}function x(e,t,r){this.color=e||"black",this.style=t||0,this.level=r}function T(e,t,r,n){var o,i,a,s=t;if(r&&t){if(t.gQa&&t.gQa())return void(e.cellType=s);t.toJSON&&(t=t.toJSON()),o=h._o,i=t.typeName,(a=o[t.type]||o[i]||u.getTypeFromString(i))?(s=new a).fromJSON(t,n):s=b}e.cellType=s}function A(e,t,r){var n,o,i,a,s=t;r&&t&&"object"==typeof t&&(t.toJSON&&(t=t.toJSON()),(o=(n=l.Formatter)&&n.GeneralFormatter)&&((i=t.typeName)?(a=u.getTypeFromString(i))&&(s=new a).fromJSON(t):s=new o(t.formatCached,t.customerCultureName))),e.formatter=s}function k(e,t,r){var n,o,i=t;r&&t&&(t.toJSON&&(t=t.toJSON()),(o=(n=l.Formatter)&&n.GeneralFormatter)&&((i=new o(t.formatCached,t.customerCultureName)).isAuto=!0)),e._autoFormatter=i}function M(e,t,r){t&&((t=e.getColor(t))&&r(t))}function I(e,t,r){return"hAlign"===e?2===r||1===r?1===t:3===t:"vAlign"===e?2===r||1===r?1===t:0===t:"imeMode"===e?1===t:e===f&&t===b}Object.defineProperty(t,"__esModule",{value:!0}),l=r("@grapecity/js-sheets-common"),a=r("./dist/core/util/domUtil.js"),u=r("./dist/core/util/common.js"),c=r("./dist/core/worksheet/stylehelper.js"),h=r("./dist/core/celltype/celltype.ns.js"),n=a.GC$.each,o=u.Ul,s=o.Ol,m=l.Common.j.C4,b=void 0,Math.sin,Math.cos,Math.abs,Math.max,f="autoFormatter",d="labelOptions",p="cellButtons",g={borderLeft:!0,borderRight:!0,borderTop:!0,borderBottom:!0,diagonalDown:!0,diagonalUp:!0},(v=t.LineStyle||(t.LineStyle={}))[v.empty=0]="empty",v[v.thin=1]="thin",v[v.medium=2]="medium",v[v.dashed=3]="dashed",v[v.dotted=4]="dotted",v[v.thick=5]="thick",v[v.double=6]="double",v[v.hair=7]="hair",v[v.mediumDashed=8]="mediumDashed",v[v.dashDot=9]="dashDot",v[v.mediumDashDot=10]="mediumDashDot",v[v.dashDotDot=11]="dashDotDot",v[v.mediumDashDotDot=12]="mediumDashDotDot",v[v.slantedDashDot=13]="slantedDashDot",(w=t.LineBorderComposeLevel||(t.LineBorderComposeLevel={}))[w.conditionalFormat=1]="conditionalFormat",w[w.cell=10]="cell",w[w.table=20]="table",w[w.row=30]="row",w[w.column=40]="column",w[w.sheet=50]="sheet",x.prototype.Uo=function(){return new x(this.color,this.style,this.level)},x.prototype.toJSON=function(){var e={},t=this.color,r=this.style;return"black"!==t&&(e.color=t),0!==r&&(e.style=r),e},x.prototype.fromJSON=function(e,t){if(e){var r=e.color,n=e.style;s(r)&&(this.color=r),s(n)&&(this.style=n)}},x.Vo=function(e){return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[e&&e.style]||0},y=x,t.LineBorder=y,C=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding",d,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",p,"dropDowns","textOrientation"],S.kxb=function(e,t){var r=e.parentName;r&&!t.getNamedStyle(r)&&delete e.parentName},S.prototype.Yo=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d=this,p=e.labelOptions,g=e.cellButtons;if(e.cellButtons&&0<e.cellButtons.length)for(g=[],c=0;c<e.cellButtons.length;c++)g.push(m(e.cellButtons[c]));if(h=e.dropDowns,e.dropDowns&&0<e.dropDowns.length)for(h=[],c=0;c<e.dropDowns.length;c++)h.push(m(e.dropDowns[c]));t?(d._autoFormatter=e._autoFormatter,d.backgroundImage=e.backgroundImage,d.backgroundImageLayout=e.backgroundImageLayout,d.backColor=e.backColor,d.foreColor=e.foreColor,d.hAlign=e.hAlign,d.vAlign=e.vAlign,d.font=e.font,d.themeFont=e.themeFont,d.formatter=e.formatter,d.showEllipsis=e.showEllipsis,d.THb=e.THb,o=e.borderLeft,d.borderLeft=o&&o.Uo()||o,d.borderLeft&&r&&(d.borderLeft.level=r),i=e.borderTop,d.borderTop=i&&i.Uo()||i,d.borderTop&&r&&(d.borderTop.level=r),a=e.borderRight,d.borderRight=a&&a.Uo()||a,d.borderRight&&r&&(d.borderRight.level=r),s=e.borderBottom,d.borderBottom=s&&s.Uo()||s,d.borderBottom&&r&&(d.borderBottom.level=r),l=e.diagonalDown,d.diagonalDown=l&&l.Uo()||l,d.diagonalDown&&r&&(d.diagonalDown.level=r),u=e.diagonalUp,d.diagonalUp=u&&u.Uo()||u,d.diagonalUp&&r&&(d.diagonalUp.level=r),d.locked=e.locked,d.textIndent=e.textIndent,d.wordWrap=e.wordWrap,d.shrinkToFit=e.shrinkToFit,d.cellType=e.cellType,d.name=e.name,d.parentName=e.parentName,d.tabStop=e.tabStop,d.textDecoration=e.textDecoration,d.imeMode=e.imeMode,d.watermark=e.watermark,d.cellPadding=e.cellPadding,d.isVerticalText=e.isVerticalText,d.textOrientation=e.textOrientation,p&&(d.labelOptions={alignment:p.alignment,font:p.font,foreColor:p.foreColor,visibility:p.visibility,margin:p.margin}),d.quotePrefix=e.quotePrefix,d.cellButtons=g,d.dropDowns=h):(d.backgroundImage===b&&(d.backgroundImage=e.backgroundImage),d.backgroundImageLayout===b&&(d.backgroundImageLayout=e.backgroundImageLayout),d.backColor===b&&(d.backColor=e.backColor),d.foreColor===b&&(d.foreColor=e.foreColor),d.hAlign===b&&(d.hAlign=e.hAlign),d.vAlign===b&&(d.vAlign=e.vAlign),d.themeFont===b&&d.font===b?(d.themeFont=e.themeFont,d.font=e.font):d.themeFont!==b&&d.font===b&&(d.font=e.font),d.formatter===b&&(d.formatter=e.formatter),d.showEllipsis===b&&(d.showEllipsis=e.showEllipsis),d.THb===b&&(d.THb=e.THb),d._autoFormatter===b&&(d._autoFormatter=e._autoFormatter),d.borderLeft===b&&(o=e.borderLeft,d.borderLeft=o&&o.Uo()||o,d.borderLeft&&r&&(d.borderLeft.level=r)),d.borderTop===b&&(i=e.borderTop,d.borderTop=i&&i.Uo()||i,d.borderTop&&r&&(d.borderTop.level=r)),d.borderRight===b&&(a=e.borderRight,d.borderRight=a&&a.Uo()||a,d.borderRight&&r&&(d.borderRight.level=r)),d.borderBottom===b&&(s=e.borderBottom,d.borderBottom=s&&s.Uo()||s,d.borderBottom&&r&&(d.borderBottom.level=r)),d.diagonalDown===b&&(l=e.diagonalDown,d.diagonalDown=l&&l.Uo()||l,d.diagonalDown&&r&&(d.diagonalDown.level=r)),d.diagonalUp===b&&(u=e.diagonalUp,d.diagonalUp=u&&u.Uo()||u,d.diagonalUp&&r&&(d.diagonalUp.level=r)),d.locked===b&&(d.locked=e.locked),d.textIndent===b&&(d.textIndent=e.textIndent),d.wordWrap===b&&(d.wordWrap=e.wordWrap),d.shrinkToFit===b&&(d.shrinkToFit=e.shrinkToFit),d.cellType===b&&(d.cellType=e.cellType),d.tabStop===b&&(d.tabStop=e.tabStop),d.textDecoration===b&&(d.textDecoration=e.textDecoration),d.imeMode===b&&(d.imeMode=e.imeMode),d.name===b&&(d.name=e.name),d.parentName===b&&(d.parentName=e.parentName),d.watermark===b&&(d.watermark=e.watermark),d.cellPadding===b&&(d.cellPadding=e.cellPadding),!d.labelOptions&&p&&(d.labelOptions={}),(f=d.labelOptions)&&p&&(f.alignment===b&&(f.alignment=p.alignment),f.font===b&&(f.font=p.font),f.foreColor===b&&(f.foreColor=p.foreColor),f.visibility===b&&(f.visibility=p.visibility),f.margin===b&&(f.margin=p.margin)),n||d.quotePrefix!==b||(d.quotePrefix=e.quotePrefix),d.isVerticalText===b&&(d.isVerticalText=e.isVerticalText),d.textOrientation===b&&(d.textOrientation=e.textOrientation),d.cellButtons===b&&(d.cellButtons=g),d.dropDowns===b&&(d.dropDowns=h))},S.prototype.$b=function(e){var r=this;0===arguments.length?n(C,function(e,t){r[t]=b}):r[e]=b},S.prototype.clone=function(e){var t=this,r=t.borderLeft,n=t.borderTop,o=t.borderRight,i=t.borderBottom,a=t.diagonalDown,s=t.diagonalUp,l=new S;return l.backColor=t.backColor,l.foreColor=t.foreColor,l.hAlign=t.hAlign,l.vAlign=t.vAlign,l.font=t.font,l.themeFont=t.themeFont,l.formatter=b,l.borderLeft=r&&!e&&r.Uo()||r,l.borderTop=n&&!e&&n.Uo()||n,l.borderRight=o&&!e&&o.Uo()||o,l.borderBottom=i&&!e&&i.Uo()||i,l.locked=t.locked,l.textIndent=t.textIndent,l.wordWrap=t.wordWrap,l.shrinkToFit=t.shrinkToFit,l.backgroundImage=t.backgroundImage,l.cellType=b,l.backgroundImageLayout=t.backgroundImageLayout,l.tabStop=t.tabStop,l.textDecoration=t.textDecoration,l.imeMode=t.imeMode,l.name=t.name,l.parentName=t.parentName,l.watermark=t.watermark,l.cellPadding=t.cellPadding,l.labelOptions=t.labelOptions,l.quotePrefix=t.quotePrefix,l.diagonalDown=a&&!e&&a.Uo()||a,l.diagonalUp=s&&!e&&s.Uo()||s,l.isVerticalText=t.isVerticalText,l.showEllipsis=t.showEllipsis,l.THb=t.THb,l.textOrientation=t.textOrientation,A(l,t.formatter,!e),k(l,t._autoFormatter,!e),T(l,t.cellType,!e,!0),function(e,t,r){var n,o;if(t){if(n=t,r)for(n=[],o=0;o<t.length;o++)n.push(m(t[o]));e.cellButtons=n}}(l,t.cellButtons,!e),function(e,t,r){var n,o;if(t&&(e.dropDowns=t.slice()),t){if(n=t.slice(),r)for(n=[],o=0;o<t.length;o++)n.push(m(t[o]));e.dropDowns=n}}(l,t.dropDowns,!e),l},S.prototype.Zo=function(n){var r,e,t,o,i,a,s,l,u=this;if(n&&n.getColor){if(M(n,u.foreColor,function(e){u.foreColor=e}),"string"==typeof(r=u.backColor))M(n,r,function(e){u.backColor=e});else if(r&&(r.backgroundColor&&M(n,r.backgroundColor,function(e){r.backgroundColor=e}),r.patternColor&&M(n,r.patternColor,function(e){r.patternColor=e}),r.stops))for(e=function(t){M(n,r.stops[t].color,function(e){r.stops[t].color=e})},t=0;t<r.stops.length;t++)e(t);for(i=function(e,t){var r=o[e];r&&r.color&&M(n,r.color,function(e){r.color=e})},t=0,a=(o=[u.borderLeft,u.borderTop,u.borderRight,u.borderBottom,u.diagonalDown,u.diagonalUp]).length;t<a;t++)i(t)}return s=u.themeFont,l=u.font,n&&n.getFont&&(s?u.font=c.To.Io(l,n.getFont(s)):l||(u.font=c.To.Io(l,n.bodyFont()))),u},S.prototype.$o=function(e){var t,r=this._autoFormatter;r&&null!==e&&((t=r.getPreferredEditingFormatter(e)).isAuto=!0,this._autoFormatter=t)},S.prototype.toJSON=function(e,t){var r,n,o={},i=this._autoFormatter;for(!s(i)||t&&I(f,i,e)||(i.toJSON&&(i=i.toJSON()),a.GC$.isEmptyObject(i)||(o[f]=i)),r=0;r<C.length;r++)i=this[n=C[r]],n!==d||a.GC$.isEmptyObject(i)?"dropDowns"!==n&&n!==p||a.GC$.isEmptyObject(i)?!s(i)||t&&I(n,i,e)||(o[n]=i&&i.toJSON?i.toJSON():i):o[n]=i:o[d]=i;return a.GC$.isEmptyObject(o)?b:o},S.prototype.fromJSON=function(e,t,r){var n,o,i,a;if(e)for(n in e)if(e.hasOwnProperty(n)){if(o=e[n],!s(o))continue;(i={p:n,v:o,r:!1}).noSchema=t,i.context=r,S.ao(this,"fromJson",i),i.r||("formatter"===n?A(this,o,!0):"autoFormatter"===n?k(this,o,!0):"cellType"===n?T(this,o,!0,t):g[n]?null===o?this[n]=null:((a=new y).fromJSON(o,t),this[n]=a):this[n]=o)}},i=S,t.Style=i,u.Zn(i),i.Wo=0},"./dist/core/worksheet/stylehelper.js":function(e,s,t){"use strict";var l,u,f,d,r,g,m,b,y,C,w,v,S,x;function n(e){return e=d(e=e||0,0),r(e,1)}function p(){}Object.defineProperty(s,"__esModule",{value:!0}),l=t("./dist/core/util/domUtil.js"),u=t("./dist/core/util/common.js"),f=document,d=Math.max,r=Math.min,g="#FFFFFF",m="#000000",b=Math.abs,y=Math.PI,C=Math.cos,w=Math.sin,v=Math.atan,S=Math.tan,s.Ho="11pt",x={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]},p.Io=function(e,t){return t?p.Jo(e,t):e},p.Ko=function(e){var t,r;return e?((t=p.Lo()).style.font=e,{fontFamily:(r=t.style).fontFamily,fontSize:r.fontSize,fontStyle:r.fontStyle,fontWeight:r.fontWeight}):{}},p.F4=function(e){var t,r,n,o,i,a;return u.Ul.Ml.safari?e.font:(t="",r="normal",n=e.fontStyle,o=e.fontVariant,i=e.fontWeight,a=e.lineHeight,n&&n!==r&&(t=n),o&&o!==r&&(t+=(t?" ":"")+o),i&&i!==r&&"400"!==i&&(t+=(t?" ":"")+i),t+=(t?" ":"")+(e.fontSize||"11pt"),a&&a!==r&&(t+="/"+a),t+=" "+(e.fontFamily||"Calibri"))},p.Jo=function(e,t){var r,n,o,i,a;if(!e&&!t)return e;if(e){if(o=p.Mo[n=t?e+"+"+t:e])return o;r=p.Lo(),l.GC$(r).css("font",e)}else{if(o=p.Mo[n=t])return o;r=p.Lo(),l.GC$(r).css("fontSize",s.Ho)}return t&&l.GC$(r).css("fontFamily",t),i=r.currentStyle,(a=f.defaultView)&&a.getComputedStyle&&(i=a.getComputedStyle(r,"")),o=p.F4(i),p.Mo[n]=o,p.Mo[o]=o},p.No=function(e,t,r,n){var o,i,a,s,l,u,c,h=p.Oo[t];if(!n)if(h){if(o=h[e])return o}else h=p.Oo[t]={};return(i=p.Lo()).style.font=e,a=i.currentStyle,(s=f.defaultView)&&s.getComputedStyle&&(a=s.getComputedStyle(i,"")),-1!==(l=a.fontSize).indexOf("px")&&(u=d(1,parseFloat(l.replace("px",""))*t),r&&1===u&&(r.value=!0),l=u+"px"),-1!==(c=a.lineHeight).indexOf("px")&&(c=d(1,parseFloat(c.replace("px",""))*t)+"px"),o=1===t?{font:e,fontFamily:i.style.fontFamily,fontSize:u}:(i.style.fontSize=l,i.style.lineHeight=c,{font:i.style.font,fontFamily:i.style.fontFamily,fontSize:u}),n||(h[e]=o),o},p.Lo=function(){var e,t;return p.Po?p.Po.style.cssText=p.Qo:((t=(e=u.Ul.Nl("span")).style).visibility="hidden",t.top="-10000px",t.left="-10000px",t.lineHeight="normal",t.position="absolute",t.fontWeight="normal",t.fontStretch="normal",t.fontVariant="normal",t.fontStyle="normal",f.body.insertBefore(e,null),p.Po=e,p.Qo=t.cssText),p.Po},p.no=function(){var e=p.Po;e&&(l.GC$(e).remove(),p.Po=void 0,p.Qo=void 0)},p.stringFontCatch={},p.Ro=function(e,t){var r,n=e+","+t,o=p.stringFontCatch,i=o[n];return i||((r=p.Lo()).style.font=e,t&&(r.style.fontWeight=t),i=o[n]=r.style.font),i},p.Mo={},p.Oo={},p.So=function(e){if(e<=0)return"none";var t="";return(1|e)===e&&(t+="underline "),(2|e)===e&&(t+="line-through "),(4|e)===e&&(t+="overline "),t.trim()},p.setFillStyle=function(e,t,r,n,o,i,a){"string"==typeof t?(e.fillStyle!==t&&(e.fillStyle=t),a()):"path"===t.type?p.setFillStyle_Path(e,t,r,n,o,i,a):t.stops?p.setFillStyle_Gradient(e,t,r,n,o,i,a):t.type&&p.setFillStyle_patternFill(e,t,r,n,o,i,a)},p.setFillStyle_patternFill=function(e,t,r,n,o,i,a){var s,l,u,c,h=x[t.type],f=h.length,d=h[0].length,p=document.createElement("canvas");for(p.width=d,p.height=f,(s=p.getContext("2d")).fillStyle=t.backgroundColor||g,s.fillRect(0,0,d,f),s.fillStyle=t.patternColor||m,l=0;l<f;l++)for(u=0;u<d;u++)h[l][u]&&s.fillRect(u,l,1,1);e.createPattern(p,"repeat"),c=e.createPattern(p,"repeat"),e.fillStyle=c,a()},p.processStops=function(e){var t,r;if(e.stops||"path"===e.type){if(t=e.stops)if(0===t.length)t=[{position:0,color:m},{position:1,color:m}];else{for((t=t.filter(function(e,t,r){return e.position<=1&&0<=e.position})).sort(function(e,t){return e.position-t.position}),r=0;r<t.length;r++)t[r].color=t[r].color||m;0!==t[0].position&&t.splice(0,0,{position:0,color:m}),1!==t[t.length-1].position&&t.push({position:1,color:m})}else t=[{position:0,color:g},{position:1,color:g}];e.stops=t}"path"===e.type?(e.left=n(e.left),e.right=n(e.right),e.top=n(e.top),e.bottom=n(e.bottom)):e.stops&&(delete e.type,e.degree=e.degree||0)},p.setFillStyle_Gradient=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p=t.degree||0;for(p%90==0?(l=p/180*y,u=b(p%180/180*y)-v(i/o)):(l=v(o/i*S(p/180*y)),u=b(l)-v(i/o),l=Math.round(p/180)*y+l),c=Math.sqrt(o*o+i*i)/2,s=e.createLinearGradient(r+o/2-c*C(u)*C(l),n+i/2-c*C(u)*w(l),r+o/2+c*C(u)*C(l),n+i/2+c*C(u)*w(l)),f=0,d=(h=t.stops).length;f<d;f++)s.addColorStop(h[f].position,h[f].color||g);e.fillStyle=s,a()},p.setFillStyle_Path=function(e,t,r,n,o,i,a){var s,l,u,c=t.left||0,h=t.right||0,f=t.top||0,d=t.bottom||0,p=t.stops;if(h<c&&(h=c),d<f&&(d=f),0<c){for(e.save(),e.beginPath(),s=e.createLinearGradient(r+o*c,0,r,0),l=0,u=p.length;l<u;l++)s.addColorStop(p[l].position,p[l].color||g);e.fillStyle=s,e.moveTo(r,n-1),e.lineTo(r+o*c+1,n+i*f),e.lineTo(r+o*c+1,n+i*d),e.lineTo(r,n+i+1),e.clip(),a(),e.restore()}if(h<1){for(e.save(),e.beginPath(),s=e.createLinearGradient(r+o*h,0,r+o,0),l=0,u=p.length;l<u;l++)s.addColorStop(p[l].position,p[l].color||g);e.fillStyle=s,e.moveTo(r+o,n-1),e.lineTo(r+o,n+i+1),e.lineTo(r+o*h-1,n+i*d),e.lineTo(r+o*h-1,n+i*f),e.clip(),a(),e.restore()}if(0<f){for(e.save(),e.beginPath(),s=e.createLinearGradient(0,n+i*f,0,n),l=0,u=p.length;l<u;l++)s.addColorStop(p[l].position,p[l].color||g);e.fillStyle=s,e.moveTo(r,n),e.lineTo(r+o,n),e.lineTo(r+o*h,n+i*f+1),e.lineTo(r+o*c,n+i*f+1),e.clip(),a(),e.restore()}if(d<1){for(e.save(),e.beginPath(),s=e.createLinearGradient(0,n+i*d,0,n+i),l=0,u=p.length;l<u;l++)s.addColorStop(p[l].position,p[l].color||g);e.fillStyle=s,e.moveTo(r+o,n+i),e.lineTo(r,n+i),e.lineTo(r+o*c,n+i*d-1),e.lineTo(r+o*h,n+i*d-1),e.clip(),a(),e.restore()}c<h&&f<d&&(e.save(),e.beginPath(),e.fillStyle=p[0].color,e.rect(r+o*c,n+i*f,o*(h-c),i*(d-f)),e.clip(),a(),e.restore())},s.To=p},"./dist/core/worksheet/worksheet-actions.js":function(e,t,r){"use strict";var n,k,g,C,w,U,f,o,W,m,M,v,E,O,B,i,y,a,b,S,x,T,d,s,l,R,V,u,I,p,c,h,z,q,A,D,N,F,_,P,L,j,H,G,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,Ee,Re,De,Ne,Fe,_e,Pe,Le,Oe,Be,je,He,Ge,Ue,We,Ve,ze,qe,Ze,Ye,Ke,Xe,Je,Qe,$e,et,tt,rt,nt,ot,it,at,st,lt,ut,ct,ht,ft,dt=this&&this.__extends||(Qe=function(e,t){return(Qe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}Qe(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function pt(e,t){return e.getRowCount(t)}function gt(e,t){return e.getColumnCount(t)}function mt(e){return e.rowCount}function bt(e){return e.colCount}function yt(e){var t=e.parent;return t&&t.options.allowExtendPasteRange}function Ct(e){var t=e.parent;return t&&t.options.allowCopyPasteExcelStyle}function wt(e){var t=e.parent;return t&&t.options.copyPasteHeaderOptions}function vt(e,t,r,n){throw Error(i.Kb(z().Exp_InvalidAndSpace,[e,t,r,n]))}function St(e){e.suspendPaint()}function xt(e){e.resumePaint()}function Tt(e){e.suspendEvent()}function At(e){e.resumeEvent()}function kt(e,t){e&&E&&e.suspendCalcService(t)}function Mt(e,t){e&&E&&e.resumeCalcService(t)}function It(e){this.Vw=1==(1&e),this.Ww=2==(2&e),this.Xw=8==(8&e),this.Yw=E&&16==(16&e),this.Zw=!0,this.$w=!0}function Et(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b;if(O(e)||""===e)return R;for(!O(t)&&""!==t||(t="\r\n"),!O(r)&&""!==r||(r="\t"),!O(n)&&""!==n||(n='"'),y(e,t)||(e+=t),o=[],a="",l=!(i=[]),u=n.length,c=t.length,h="\n".length,f=r.length,d=e.length,p=0;p<d;p++)u<=(s=(a+=e[p]).length)&&n===a.substr(s-u,u)?l&&p+1+u<=d&&n===e.substr(p+1,u)?p+=u:l?(a=a.substr(0,s-u),l=!1):0===a.indexOf(n)&&(a=a.substr(0,s-u),l=!0):!l&&f<=s&&r===a.substr(s-f,f)?(a=a.substr(0,s-f),i.push(""+a),a=""):!l&&c<=s&&t===a.substr(s-c,c)?(a=a.substr(0,s-c),i.push(""+a),o.push(i),i=[],a=""):!l&&h<=s&&"\n"===a.substr(s-h,h)?(a=a.substr(0,s-h),i.push(""+a),o.push(i),i=[],a=""):l&&p+1+f<=d&&r===e.substr(p+1,f)&&","!==r&&(p+=u);if(l){if(0<i.length){for(g=void 0,g=0;g<o.length&&o[g]!==i;g++);g>=o.length&&o.push(i)}(m=""+a)&&(m=m.replace(RegExp(r,"g"),""),y(m,t)&&(m=m.substr(0,m.length-c)),0===o.length&&o.push([m]))}return 0===o.length&&(y(b=e,t)&&(b=b.substr(0,b.length-c)),o.push([b])),function(e){var t,r;if(e){for(t=0;t<e.length&&((r=e[t])&&1===r.length);t++);if(t===e.length)return 1}return}(o)&&/^(\s)*$/.test(e)&&"\n"===e.substr(e.length-h,h)&&o.push([""]),o}function Rt(e,t,r,n,o,i,a){for(var s=0,l=n;s<t.length;s++,l++)0<o&&l<gt(e,i)&&Dt(e,i,r,l,t[s],a)}function Dt(t,r,n,o,i,e){var a,s,l,u,c,h,f,d=i,p=R;if(!1===e.Xw&&(a={value:R},d=U.Ul.ul(R,i,!e.Xw,a),p=a.value),O(d))t.setValue(n,o,d,r);else if(""!==i)if(e.Yw&&"="===i[0]&&1<i.length)try{t.setFormula(n,o,i.substr(1))}catch(e){t.setText(n,o,i,r)}else s=t.tq(n,o,"formatter",r),!1===e.Xw&&p?s?s&&("string"==typeof s&&g.Formatter&&(s=new g.Formatter.GeneralFormatter(s)),f=s.parse&&s.parse(i),d=O(f)?d:f):(p.isAuto=!0,t.getCell(n,o,r)._w("_autoFormatter",p),l=i,u=t.getCellType(n,o,r),c=p.formatString(),u&&"7"===u.typeName&&(h={sheet:t,row:n,col:o,sheetArea:r},l=u.parse(i,c,h),d=O(l)?i:l)):s&&t.getCell(n,o,r).formatter(R),t.setValue(n,o,d,r);else t.setValue(n,o,R,r)}function Nt(e){var t,r,n=0;for(t=0;t<(e&&e.length);t++)r=e[t],n=u(r.length,n);return n}function Ft(e,t,r,n,o,i,a,s){if(!e)throw Error(z().Exp_SheetIsNull);if((t<-1||t>=pt(e))&&vt("row",t,"-1",pt(e)-1),(r<-1||r>=gt(e))&&vt("column",r,"-1",gt(e)-1),!O(n)&&""!==n){-1===t&&(t=0),-1===r&&(r=0);var l=Et(n,o,i,a);l&&0<l.length&&function(e,t,r,n,o){var i,a,s,l,u,c,h,f=n.length,d=Nt(n);if(0!==f&&0!==d)for(i=new It(o),e&&(gt(e,2)<=0&&(i.Vw=!1),pt(e,1)<=0&&(i.Ww=!1)),(d-=a=i.Vw?gt(e,2):0)<=(l=0)&&(d=0),(f-=s=i.Ww?pt(e,1):0)<=0&&(l=0),(f-=l)<=0&&(f=0),i.Zw&&t+f>pt(e)&&e.setRowCount(t+f),i.$w&&r+d>gt(e)&&e.setColumnCount(r+d),c=u=0;u<n.length;u++,c++)(h=n[u]).length<=0||(0<s&&u<s?Rt(e,h,c,r,d,1,i):0<f&&c<pt(e)&&(u===s&&(c=t),Rt(e,h,c,0,a,2,i),h.splice(0,a),Rt(e,h,c,r,d,3,i)))}(e,t,r,l,s)}}function _t(e,t,r,n,o,i,a,s,l,u,c,h,f,d){var p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_;if(!e)throw Error(z().Exp_SheetIsNull);return p=pt(e),g=gt(e),(t<-1||p<=t)&&vt("row",t,"-1",p-1),(r<-1||p<t+r)&&vt("rowCount",r,"-1",p-t),(n<-1||g<=n)&&vt("column",n,"-1",g-1),(o<-1||g<n+o)&&vt("columnCount",o,"-1",g-n),C=y=!(b=m=-1),b=-1===t&&-1===n&&-1===r&&-1===o?(n=t=0,m=pt(e)-1,gt(e)-1):(-1===t&&(t=0,2==(2&wt(e))&&(y=!0)),-1===n&&(n=0,1==(1&wt(e))&&(C=!0)),-1===r&&(r=pt(e)-t),-1===o&&(o=gt(e)-n),m=t+r-1,n+o-1),!O(i)&&""!==i||(i="\r\n"),!O(a)&&""!==a||(a="\t"),!O(s)&&""!==s||(s='"'),S=v=null,x=Pt(e,t,m,n,b,3,u,c,i,a,s,w=RegExp(s,"g"),l,h,f,d),C&&(T=e.getColumnCount(2),v=Pt(e,t,m,0,T-1,2,u,c,i,a,s,w,l,h,f,d)),y&&(A=e.getRowCount(1),S=Pt(e,0,A-1,n,b,1,u,c,i,a,s,w,l,h,f,d)),I=S,E=i,R=a,F=k=x,_=0,(M=v)&&(_=M[0].length,F=P(M,k)),I&&(D=I.length,N=null,_&&(N=Pt(null,0,D-1,0,_-1,null,[],[],E,R,null,null,null,!1,!1),I=P(N,I)),F=I.concat(F)),function(e,t,r){var n,o,i="",a=e.length;for(n=0;n<a;n++){for(o=0;o<e[n].length;o++)0!==o&&(i+=r),i+=e[n][o];i+=t}return i}(F,E,R);function P(e,t){var r,n=[],o=e.length;for(r=0;r<o;r++)n.push(e[r].concat(t[r]));return n}}function Pt(e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g){var m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P=[],L=e&&Ct(e);for(m=t;m<=r;m++)if(!a||!B(a,m)){for(y=[],b=n;b<=o;b++)s&&B(s,b)||(C="",e&&(R=m,D=b,N=i,F=d,!(_=e.getSpan(R,D,N))||!F||_.row===R&&_.col===D)&&(C=e.getText(m,b,i),g&&L&&C&&(" "===C[0]||" "===C[C.length-1])&&"number"==typeof e.getValue(m,b,i)&&(C=C.trim())),v=d,S=L,x=h,T=c,A=p,k=f,M=u,I=l,E=void 0,E="",O(w=C)||(E=w,v||(E=E.replace(x,T+T))),A&&!E&&(E=" "),v&&S?E=E.replace(/\n/g," "):!k&&-1===E.indexOf(T)&&-1===E.indexOf(M)&&-1===E.indexOf(I)&&-1===E.indexOf("\n")||(E=T+E+T),C=E,y.push(C));P.push(y)}return P}function Lt(e,t){return e.sheets?e.getSheetFromName(t.sheetName):e}function Ot(e,t,r,n){var o=Lt(e,r),i=new t(o,r,n);return n?i.undo(o):i.execute(o)}function Bt(e){var n=e;return function(e,t){var r=Lt(e,t);return q.Ox(r,n)}}function jt(e,t){var n=e,o=t;return function(e,t){var r=Lt(e,t);return q.Rx(r,n,o)}}function Ht(e,t){var r,n,o,i=e.parent;i&&(r=i.getSheetCount(),o=void 0,n=o=i.getActiveSheetIndex(),t?o<r-1&&o++:0<o&&o--,n!==o&&(i.dq(o,1),i.repaint()))}function Gt(e,t){e.Tx=!0,e.Hx?e.Ex(t):e.yx(t,!0),e.Tx=!1}function Ut(e,t){var r,n,o,i;return!!e.endEdit()&&((r=e._eventHandler).Ux(),r.Vx(),U.Vl.Zl(R),n=!1,(o=e.parent)&&((i=t.call(o))&&i.focus?(i.focus(),n=!0):o.Uv()),{ignoreCancelDefault:!n})}function Wt(e,t,r){this.kj=e,this.my=t,this.ny=r,this.oy=[],this.Iu=[],this.py()}function Vt(t,e){var r=[];return"string"==typeof e?r.push(t.getSheetFromName(e)):Array.isArray(e)&&e.forEach(function(e){r.push(t.getSheetFromName(e))}),r}function zt(e,t){St(e),t||Tt(e)}function qt(e,t){t||At(e),xt(e)}function Zt(e,t){this.Lz=zt,this.Mz=qt;this.kj=e,this.VQ=t}function Yt(e,t){O(e.lq)&&(e.lq=t.lq,e.qq=t.qq)}function Kt(e,t){var r=et.call(this,e,t)||this,n=r,o=e.parent;return n.Wz=t.columnHeader?1:3,s(t.autoFitType)||(t.autoFitType=o?o.options.autoFitType:0),r}function Xt(e,t){var r=tt.call(this,e,t)||this,n=r,o=e.parent;return n.Wz=t.rowHeader?2:3,s(t.autoFitType)||(t.autoFitType=o?o.options.autoFitType:0),r}function Jt(e,t){var r=rt.call(this)||this,n=r;return n.kj=e,n.VQ=t,r}function Qt(e,t){var r=nt.call(this)||this,n=r;return n.kj=e,n.VQ=t,r}function $t(e,t){var r=ot.call(this,e,t)||this;return Yt(t,e),r}function er(e,t){var r=it.call(this,e,t)||this;return Yt(t,e),r}function tr(e,t){"value"===t.propertyName&&e.xu(t.row,t.col,t.oldValue,t.newValue)}function rr(e,t){var r,n,o=at.call(this,e,t)||this;return E&&t.ranges&&1===t.endEditType&&(r=e.Tq(t.ranges[0]),1===mt(t.ranges[0]=r)&&1===bt(r)&&((n=e.Ms(r.row,r.col,1,1))&&n.ranges&&0<n.ranges.length&&(t.ranges=[n.ranges[0]]))),o}function nr(e){var t=e.parent,r=t&&t.hq;r&&r.repaint()}function or(e,t){return st.call(this,e,t)||this}function ir(e,t){return lt.call(this,e,t)||this}function ar(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M=ut.call(this,e,t)||this;if(!r){if(n=e,o=t.fromSheet,!n)throw Error(z().Exp_DestSheetIsNull);if((a=(i=t).pastedRanges)&&0<a.length)if(t.MA=[],l=(s=i.fromRanges||[i.fromRange]).length,u=i.isCutting,c=i.clipboardText,h=i.clipboardHtml,f=i.clipboardImage,d=i.pasteOption,p={},g=a[0],!u&&o&&o.r5(s,p)&&g.equals(o.q5(s,g))){for(b=p.inSameCol,(m=p.inSameRow)?s.sort(function(e,t){return e.col-t.col}):b&&s.sort(function(e,t){return e.row-t.row}),y=g.row,C=g.col,w=0;w<l;w++)S=(v=s[w]).rowCount,x=v.colCount,T={sourceRange:v,targetRange:U.kf(y,C,S,x),isCutting:u,clipboardText:c,clipboardHtml:h,clipboardImage:f,includeFilteredOutRow:!0},t.MA[w]=new Xe(e,{fromSheet:o,toSheet:n,pasteExtent:T,pasteOption:d}),m?C+=x:b&&(y+=S);t.s5=!0}else for(A=0;A<a.length;A++)k={sourceRange:s[0],targetRange:a[A],isCutting:u,clipboardText:c,clipboardHtml:h,clipboardImage:f},t.MA[A]=new Xe(e,{fromSheet:o,toSheet:n,pasteExtent:k,pasteOption:d})}return M}function sr(e,t){return ct.call(this,e,t)||this}function lr(e,t,r){var n,o,i=ht.call(this,e,t)||this;if(!r&&(t.MA=[],(n=t.ranges)&&0<n.length))for(o=0;o<n.length;o++)t.MA[o]=new Ye(e,{clearRange:n[o]});return i}function ur(e,t){return ft.call(this,e,t)||this}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/core.ns.js"),k=r("@grapecity/js-sheets-common"),g=r("@grapecity/js-sheets-common"),C=r("./dist/core/worksheet/style.js"),w=r("./dist/core/worksheet/worksheet.js"),U=r("./dist/core/util/common.js"),f=r("./dist/core/worksheet/clipboardhelper.js"),o=r("./dist/core/util/domUtil.js"),W=r("./dist/core/core.enum.js"),m=o.GC$,M=r("./dist/core/worksheet/worksheet-static.js"),v=r("@grapecity/js-calc"),E=!!v,O=k.Common.j.Fa,B=k.Common.k.Bb,i=k.Common.u,y=i.jb,a=U.Events.CellChanged,b=U.Events.ColumnWidthChanging,S=U.Events.ColumnWidthChanged,x=U.Events.RowHeightChanging,T=U.Events.RowHeightChanged,d=U.Ul.Ml,s=U.Ul.Ol,l=m.extend,m.inherit,R=null,V=void 0,u=Math.max,Math.min,I=Math.floor,p=Math.ceil,Number.MAX_VALUE,isNaN,($e=c=t.CopyToOptions||(t.CopyToOptions={}))[$e.value=1]="value",$e[$e.formula=2]="formula",$e[$e.comment=4]="comment",$e[$e.outline=8]="outline",$e[$e.sparkline=16]="sparkline",$e[$e.span=32]="span",$e[$e.style=64]="style",$e[$e.tag=128]="tag",$e[$e.bindingPath=256]="bindingPath",$e[$e.conditionalFormat=512]="conditionalFormat",$e[$e.hyperlink=1024]="hyperlink",$e[$e.all=2047]="all",h=new k.Common.ResourceManager(n.SR),z=h.getResource.bind(h),l(w.Worksheet.prototype,{autoFitColumn:function(e){0<=e&&e<gt(this)&&this.wu().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:e}],rowHeader:!1})},autoFitRow:function(e){0<=e&&e<pt(this)&&this.wu().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:e}],columnHeader:!1})},setCsv:function(e,t,r,n,o,i){St(this),Tt(this),Ft(this,e,t,r,n,o,'"',i),At(this),xt(this)},getCsv:function(e,t,r,n,o,i){return _t(this,e,r,t,n,o,i,'"',!0)},copyTo:function(e,t,r,n,o,i,a){this.ax(e,t,r,n,o,i,a)},ax:function(e,t,r,n,o,i,a,s){St(this),Tt(this),M.staticMembers.copyTo(this,e,t,this,r,n,o,i,a,s,0),At(this),xt(this)},moveTo:function(e,t,r,n,o,i,a,s){if(!(E&&a&c.formula)||this.Vq(e,t,o,i,!0)&&this.Vq(r,n,o,i,!0))try{St(this),Tt(this),M.staticMembers.moveTo(this,e,t,this,r,n,o,i,a,s)}finally{At(this),xt(this)}},bx:function(e,t,r){var n,o,i,a,s,l,u,c=this,h=c.o5(e);if(h){n=c.J5(e),o=c._eventHandler,i=_t(c,h.row,mt(h),h.col,bt(h),"\r\n","\t",'"',!1,n.rows,n.cols,!0),(a=c.tu()).PA=c,a.n5=e,a.G4=t,c.tu().UHb=!0,s=wt(c),l=f.S4.Q4(c,s,h.row,mt(h),h.col,bt(h),W.SheetArea.viewport,Ct(c),n.rows,n.cols,!1,!1,!1,!1),c.ex&&c.ex(),c.Sob&&c.Sob();try{if(u={sheet:c,sheetName:c.name(),copyData:{text:i,html:l},cancel:!1},c.Wq(U.Events.ClipboardChanging,u),!1===u.cancel)return o&&!r&&o.gx(Ct(c)?l:i),c.Wq(U.Events.ClipboardChanged,{sheet:c,sheetName:c.name(),copyData:{text:i,html:l}}),setTimeout(function(){!o||r||c.Js||o.hx()},100),{copyText:i,copyHtml:l};a.hZ()}catch(e){}}},ix:function(e,t,r,n,o,i,a,s){var l,u,c=z().Exp_PasteSourceCellsLocked;if(i.pastedInternal=!1,i.pastedRange=R,l=!o&&!s,!e&&l)return!1;if(u=this.J5(t),this.jx(e,this.o5(t),this,o,u.rows,u.cols)||l){if(i.pastedInternal=!0,n&&e.options.isProtected&&e.p5(t))return this.Os(1,c),!1;i.pastedRange=this.kx(e,t,this,r,n)}else i.pastedRange=this.lx(r,o);return this.mx(e,t,r,n,i,a)},mx:function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=z().Exp_InvalidCopyPasteSize,v=z().Exp_PasteDestinationCellsLocked,S=z().Exp_PasteChangeMergeCell,x=z().Exp_ChangePartOfArray,T=this,A=T,k=o.pastedRange;if(!k)return T.Os(1,w),!1;if(!A.Y3(k.row,k.col,mt(k),bt(k),v,x,V,i))return!1;if(o.pastedInternal){if(1===(a=t.length)){if(s=t[0],n&&!e.Y3(s.row,s.col,mt(s),bt(s),v,x))return!1;if(e.qu(s.row,s.col,mt(s),bt(s)))return T.Os(1,S),!1;if(l=k.row<0?pt(A):mt(k),u=k.col<0?gt(A):bt(k),c=s.row<0?pt(e):mt(s),h=s.col<0?gt(e):bt(s),c<l||h<u){for(f=r.row,d=r.col,r.row<0&&c<pt(A)&&(f=0),r.col<0&&h<gt(A)&&(d=0),l%c==0&&1===u?(u=h,k=o.pastedRange=new U.Range(f,d,l,u)):1===l&&u%h==0?(l=c,k=o.pastedRange=new U.Range(f,d,l,u)):l%c==0&&u%h==0||(l=c,u=h,k=o.pastedRange=new U.Range(f,d,l,u)),p=I(l/c),g=I(u/h),m=0;m<p;m++)for(b=0;b<g;b++)if(!T.nx(s,k)&&A.qu(f<0?-1:f+m*c,d<0?-1:d+b*h,f<0?-1:c,d<0?-1:h))return T.Os(1,S),!1}else if(i===V&&!T.nx(s,k)&&A.qu(k.row,k.col,mt(k),bt(k)))return T.Os(1,S),!1}else if(1<a){for(y=0;y<a;y++)if(C=t[y],e.qu(C.row,C.col,mt(C),bt(C)))return T.Os(1,S),!1;if(A.qu(k.row,k.col,mt(k),bt(k)))return T.Os(1,S),!1}}else{if(A.qu(k.row,k.col,mt(k),bt(k)))return T.Os(1,S),!1;if(!A.l5(k.row,k.col,mt(k),bt(k)))return T.Os(1,w),!1}return!0},nx:function(e,t){if(e&&1===mt(e)&&1===bt(e)){var r=this.getSpan(t.row,t.col);if(r&&r.equals(t))return!0}return!1},jx:function(e,t,r,n,o,i){var a,s;if(e&&t&&r)try{return(s=(a=_t(e,t.row,mt(t),t.col,bt(t),"\r\n","\t",'"',!1,o,i,!0,d.safari,!0))===n)||(!(s=a===n+"\r\n")&&d.chrome&&(s=a===n+"\t\r\n"),s||!d.safari&&Ct(r)||(s=a.replace(/\s/g,"")===n.replace(/\s/g,"")),s=s||a.replace(/\s+$/,"")===n.replace(/\s+$/,"")),s}catch(e){return!1}return!1},kx:function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g=t.length;if(1!==g)return 1<g?this.q5(t,n):R;if(a=(i=t[0]).row<0?0:i.row,s=i.col<0?0:i.col,l=i.row<0?pt(e):mt(i),u=i.col<0?gt(e):bt(i),c=n.row<0?0:n.row,h=n.col<0?0:n.col,f=n.row<0?pt(r):mt(n),d=n.col<0?gt(r):bt(n),o?(f=l,d=u):f%l==0&&1===d?d=u:1===f&&d%u==0?f=l:f%l==0&&d%u==0||(f=l,d=u),!this.pu(a,s,l,u,pt(e),gt(e)))return R;if(!r.l5(c,h,f,d))return R;if(p=new U.Range(c,h,f,d),!o&&e.name()===r.name())if(p.contains(a,s,l,u)){if((a-c)%l!=0||(s-h)%u!=0)return R}else if(p.intersect(a,s,l,u)&&(l<f||u<d))return R;return-1===n.row&&(f=c=-1),-1===n.col&&(d=h=-1),new U.Range(c,h,f,d)},q5:function(e,t){var r,n,o,i,a,s;if(1<e.length){if(r=e[0],n=e[1],o=r.rowCount,i=r.colCount,r.row===n.row&&o===n.rowCount)return a=0,e.forEach(function(e){a+=e.colCount}),U.kf(t.row,t.col,o,a);if(r.col===n.col&&i===n.colCount)return s=0,e.forEach(function(e){s+=e.rowCount}),U.kf(t.row,t.col,s,i)}return R},lx:function(e,t){var r,n,o=e.row<0?0:e.row,i=e.col<0?0:e.col,a=new U.Range(o,i,1,1),s=function(e,t,r,n){var o,i,a,s,l,u=R,c=Et(e,t,r,n);if(c){for(o=c.length,i=Nt(c),a=[],s=0;s<o;s++)for(a[s]=[],l=0;l<i;l++)l<c[s].length?a[s][l]=c[s][l]:a[s][l]=R;u=a}return u}(t,"\r\n","\t",'"');return s&&(r=s.length,n=Nt(s),0<r&&0<n&&(a=new U.Range(o,i,r,n))),a},ox:function(){var e=this.tu();e&&e.hZ()},px:function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A;if(e&&r.name()===e.name()&&r.parent&&!B(r.parent.sheets,e))e.ox();else{m=Xe.qx(l),kt(e),kt(r);try{if(e&&t){if(0!=(2&m)&&o&&E&&(e.Ns(t.row,t.col,mt(t),bt(t))||r.Ns(n.row,n.col,mt(n),bt(n))))throw z().Exp_ChangePartOfArray;if(o)M.staticMembers.moveTo(e,t.row,t.col,r,n.row,n.col,mt(t),bt(t),m,!0),e.ox();else if(b=n.row<0?pt(r):mt(n),y=n.col<0?gt(r):bt(n),f=t.row<0?pt(e):mt(t),d=t.col<0?gt(e):bt(t),f<b||d<y)for(c=n.row,h=n.col,n.row<0&&f<pt(r)&&(c=0),n.col<0&&d<gt(r)&&(h=0),b%f==0&&1===y?y=d:1===b&&y%d==0?b=f:b%f==0&&y%d==0||(b=f,y=d),C=I(b/f),w=I(y/d),p=0;p<C;p++)for(g=0;g<w;g++)M.staticMembers.copyTo(e,t.row,t.col,r,c<0?-1:c+p*f,h<0?-1:h+g*d,c<0?-1:f,h<0?-1:d,m,u,wt(e));else M.staticMembers.copyTo(e,t.row,t.col,r,n.row,n.col,mt(t),bt(t),m,u,wt(e))}else{for(c=n.row,h=n.col,f=mt(n),d=bt(n),x=(S=(v=r._modelManager).getSpans(U.kf(c,h,f,d))).length-1;0<=x;x--)v.do("removeSpan",S[x]);if(E&&0<(1&m)&&r.clearFormula(c,h,f,d,function(e,t){return!e.Ps||!e.Ps(t)}),T=r.tu(),A=0===l||2===l,i&&""!==i)r.parent.options.allowAutoCreateHyperlink&&1===f&&1===d&&(k.Common.q.qb("^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$").test(i)||k.Common.q.qb("^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$").test(i))&&r.setHyperlink&&r.setHyperlink(c,h,{url:i,tooltip:i}),r.setCsv(c,h,i,"\r\n","\t",16);else{for(p=0;p<f;p++)for(g=0;g<d;g++)r.setValue(c+p,h+g,R);T&&A&&s&&T.lgc(s,r,c,h)}T&&A&&a&&T.R4(a,r,c,h)}}finally{Mt(e,!1),Mt(r,!1)}}},sx:function(e){if(!this.isEditing()){var t=this.getSelections();if(t&&1===t.length)return this.bx(t,!0,e)}return R},r5:function(e,t){var r,n,o,i,a,s,l;if(e&&1<(r=e.length)){for(n=void 0,n=0;n<r;n++)for(o=e[n],i=n+1;i<r;i++)if(a=e[i],o.intersect(a.row,a.col,a.rowCount,a.colCount))return!1;for(s=e[0],l=void 0,n=1;n<r&&(l=e[n],s.row===l.row&&s.rowCount===l.rowCount);n++);if(r<=n)return t&&(t.inSameRow=!0),!0;for(n=1;n<r&&(l=e[n],s.col===l.col&&s.colCount===l.colCount);n++);if(r<=n)return t&&(t.inSameCol=!0),!0}return!1},o5:function(e){var t,r,n,o,i;if(e){if(1===(t=e.length))return e[0];if(1<t){if(r=e[0],n=e[t-1],i=o=void 0,r.row===n.row&&r.rowCount===n.rowCount){for(o=0;o<t;o++)(i=e[o]).col<r.col&&(r=i),i.col>n.col&&(n=i);return U.kf(r.row,r.col,r.rowCount,n.col+n.colCount-r.col)}if(r.col===n.col&&r.colCount===n.colCount){for(o=0;o<t;o++)(i=e[o]).row<r.row&&(r=i),i.row>n.row&&(n=i);return U.kf(r.row,r.col,n.row+n.rowCount-r.row,r.colCount)}}}return R},J5:function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d=[],p=[];if(e&&(1<(t=e.length)&&(r=e[0],n=e[t-1],o=r.row===n.row&&r.rowCount===n.rowCount,i=r.col===n.col&&r.colCount===n.colCount,o||i)))for(e.sort(o?function(e,t){return e.col-t.col}:function(e,t){return e.row-t.row}),a=1;a<t;a++)for(s=e[a-1],l=e[a],u=o?s.col+s.colCount:s.row+s.rowCount,c=o?l.col:l.row,h=o?p:d,f=u;f<c;f++)h.push(f);return{rows:d,cols:p}},ux:function(e){var t,r,n,o,i,a,s=this;if(!s.isEditing()){if((t=s.getSelections())&&1===t.length){if(s.tu().UHb=!0,-1!==(r=t[0]).row&&s.Nu&&s.Nu()){for(n=[],o=-1,i=0;i<r.rowCount;i++)a=r.row+i,s.Ps(a)?-1!==o&&(n.push(U.kf(o,r.col,a-o,r.colCount)),o=-1):-1===o&&(o=a);-1!==o&&n.push(U.kf(o,r.col,r.row+r.rowCount-o,r.colCount)),t=n}return s.bx(t,!1,e)}if(s.r5(t))return s.bx(t,!1,e);s.Os(1,z().Exp_MultipleSelections)}return R},vx:function(e){var i,a,s,l,u,c,h=this,f=h._eventHandler;h.isEditing()||(e&&(i=e.pasteText,a=e.pasteHtml,s=e.callback,l=e.shiftCells,u=h.getSelections()[0]),f&&!i&&f.gx(""),(c=h.tu())&&(c.VHb=!1),setTimeout(function(){var e,t,r,n,o;h.Js||(e=i||"",t=a||"",f&&!i&&(c&&(e=(o=c.wx()).text,t=o.html,n=o.image,r=c.n5&&c.n5[0]),f.hx()),(d.msie||d.edge||i||!e&&!t&&!c.VHb)&&(h.J4(e,t,n,l,u,r),s&&s()),h._eventHandler.Qq())},100))},J4:function(e,t,r,n,o,i){var a,s=this.tu();if(s&&(s.VHb=!0),!(a=this.xx(e,n,t))){if(!r)return;a={pasteOption:this.options.clipBoardOptions,pastedRanges:[U.kf(this.getActiveRowIndex(),this.getActiveColumnIndex(),1,1)],clipboardText:""}}n!==V&&(a.WHb=n),o&&(a.XHb=o),i&&(a.YHb=i),a.cmd="clipboardPaste",a.sheetName=this.name(),Ct(this)&&(a.clipboardHtml=t,a.clipboardImage=r),this.wu().execute(a)},xx:function(e,t,r){var n,o,i,a,s,l,u,c,h,f=this,d=z().Exp_InvalidPastedArea,p=f.tu(),g=p.PA,m=p.n5,b=p.G4;if(b&&g&&m&&g.options.isProtected&&g.p5(m)&&(b=!1),n={pastedRange:R,pastedInternal:!1},o=[],1<(i=f.getSelections()).length)for(s=0;s<i.length;s++){if(a=i[s],!f.ix(g,m,a,b,e,n,V,r))return;if(a.containsRange(n.pastedRange)&&!a.equals(n.pastedRange))return void f.Os(1,d);o.push(n.pastedRange)}else{if(a=0<i.length?i[0]:f._modelManager.getSpan(f.Jl,f.Kl),!f.ix(g,m,a,b,e,n,t,r))return;o.push(n.pastedRange)}if((l=f.at)&&l.jx(n.pastedInternal),n.pastedInternal||(m=g=R,b=!1),u=f.options.clipBoardOptions,b&&(u=0),m&&1===m.length)for(c=0;c<o.length;c++)h=o[c],f.nx(m[0],h)&&(h.rowCount=1,h.colCount=1);return(!m||1<m.length)&&1<o.length?void f.Os(1,z().Exp_MultipleSelections):{fromSheet:g,fromRanges:m,isCutting:b,pasteOption:u,pastedRanges:o,clipboardText:e}},l5:function(e,t,r,n,o){var i=pt(this),a=gt(this);return yt(this)?-1<=e&&(o||e<i)&&-1<=t&&(o||t<a):this.pu(e,t,r,n,i,a)},p5:function(e){for(var t=0;t<e.length;t++)if(this.ou(e[t]))return!0;return!1},yx:function(e,t,r,n){var o,i,a,s=this;s.endEdit&&!s.endEdit()||(o={sheet:s,sheetName:s.name(),row:s.Jl,col:s.Kl,cancel:!1},s.Wq(U.Events.LeaveCell,o),!0!==o.cancel&&(i=s.Jl,a=s.Kl,O(r)&&(r=s.Jl),O(n)&&(n=s.Kl),3===e?s.zx(r,n,t):4===e?s.Rs(r,n,t):1===e?s.Ax(r,n,t):2===e?s.Bx(r,n,t):5===e?s.Cx():6===e&&s.Dx(),s.Ss(e,i,a)))},Ex:function(e){var t,r,n,o=this;o.endEdit()&&(t={sheet:o,sheetName:o.name(),row:o.Jl,col:o.Kl,cancel:!1},o.Wq(U.Events.LeaveCell,t),!0!==t.cancel&&(r=o.Jl,n=o.Kl,3===e?o.Fx(o.Jl,o.Kl):4===e&&o.Gx(o.Jl,o.Kl),o.Ss(e,r,n)))},Ss:function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S=this,x=S._eventHandler,T=S._modelManager.getSelections(),A=!1;S.Hx||(n=S.Tq(S._getActiveSelectedRange()),(1<T.length||1<mt(n)||1<bt(n))&&(A=!0),!A&&S.mJb&&S.mJb.mgc(n)&&(A=!0),S.Tr()),o=S.Jl,i=S.Kl,a=S._modelManager.getSpan(o,i),S.Lr=mt(a),S.Mr=bt(a),S.Hx||(s=S.Jx(o,i),l=S.selectionPolicy(),u=S.selectionUnit(),0!==l&&1!==l||S._modelManager.do("clearSelection"),1===u?(s.col=-1,s.colCount=-1):2===u&&(s.row=-1,s.rowCount=-1),S.Kx(s.row,s.col,mt(s),bt(s),!1),c=S._modelManager.getSelections(),x.zu(T,c)&&(S.yu(T,c),S.Au(T))),S.Yq(o,i),t===o||(h=S.wq)&&h.Lx(),f=S._render,A?(p=(d=S.am()).zr,g=d.Ar,m=d.width-p,b=d.height-g,f.Mx(p,g,m,b),f.repaint(new U.Rect(p,g,m,d.Cr)),f.repaint(new U.Rect(p,g,d.Br,b)),f.Pw(f.bm())):(C=mt(y=S._modelManager.getSpan(t,r)),w=bt(y),f.im(new U.Range(o,i,S.Lr,S.Mr).union(new U.Range(t,r,C,w)))),v={sheet:S,sheetName:S.name(),row:o,col:i},S.Wq(U.Events.EnterCell,v),S.Wq(U.Events.FormulatextboxEnterCell,v),x.cs&&x.cs(o,i)},Nx:function(e,t){var r=this.getDataValidator&&this.getDataValidator(e,t),n={sheet:this,sheetName:this.name(),row:e,col:t,validator:r,validationResult:0};return this.Wq(U.Events.ValidationError,n),n.validationResult}}),q={},(t.Commands=q).Ox=function(e,t){return!!e&&2!==e._editorStatus&&(e.yx(t,!1),!0)},q.Qx=function(e,t,r,n){return!!e&&2!==e._editorStatus&&(e.yx(t,!1,r,n),!0)},q.Rx=function(e,t,r){return!(!e||2===e._editorStatus||e.endEdit&&!e.endEdit()||(e.Sx(t,r),0))},A="navigationLeft",D="navigationRight",N="navigationUp",F="navigationDown",_="navigationHome2",P="navigationEnd2",L="navigationTop",j="navigationBottom",H="navigationHome",G="navigationFirst",Z="navigationEnd",Y="navigationLast",K="moveToNextCell",X="moveToPreviousCell",J="navigationPageUp",Q="navigationPageDown",$="navigationPreviousSheet",ee="navigationNextSheet",te="clear",re="clearAndEditing",ne="commitInputNavigationDown",oe="commitInputNavigationUp",ie="cancelInput",ae="commitArrayFormula",se="selectionLeft",le="selectionRight",ue="selectionUp",ce="selectionDown",he="selectionHome",fe="selectionEnd",de="selectionPageUp",pe="selectionPageDown",ge="selectionTop",me="selectionBottom",be="selectionFirst",ye="selectionLast",Ce="redo",we="resizeColumn",ve="resizeRow",Se="splitResizeRow",xe="splitResizeColumn",Te="autoFitColumn",Ae="autoFitRow",ke="editCell",Me="renameSheet",Ie="clearValues",Ee="clipboardPaste",Re="selectNextControl",De="selectPreviousControl",Ne="moveToNextCellThenControl",Fe="moveToPreviousCellThenControl",_e="changeFormulaReference",q.bT=Lt,q.h4=Ot,q.uv=function(e){var t=U.Ul.sl(),r=!t,n=t;e.register(A,q[A],37,!1,!1,!1,!1),e.register(D,q[D],39,!1,!1,!1,!1),e.register(N,q[N],38,!1,!1,!1,!1),e.register(F,q[F],40,!1,!1,!1,!1),e.register(_,q[_],37,r,!1,!1,n),e.register(P,q[P],39,r,!1,!1,n),e.register(L,q[L],38,r,!1,!1,n),e.register(j,q[j],40,r,!1,!1,n),e.register(H,q[H],36,!1,!1,!1,!1),e.register(G,q[G],36,!0,!1,!1,!1),e.register(Z,q[Z],35,!1,!1,!1,!1),e.register(Y,q[Y],35,!0,!1,!1,!1),e.register(K,q[K],9,!1,!1,!1,!1),e.register(X,q[X],9,!1,!0,!1,!1),e.register(J,q[J],33,!1,!1,!1,!1),e.register(Q,q[Q],34,!1,!1,!1,!1),e.register($,q[$],33,r,!1,!1,n),e.register(ee,q[ee],34,r,!1,!1,n),e.register(te,q[te],46,!1,!1,!1,!1),e.register(re,q[re],8,!1,!1,!1,!1),e.register(ne,q[ne],13,!1,!1,!1,!1),e.register(oe,q[oe],13,!1,!0,!1,!1),e.register(ie,q[ie],27,!1,!1,!1,!1),e.register(ae,q[ae],13,!0,!0,!1,!1),e.register(se,q[se],37,!1,!0,!1,!1),e.register(le,q[le],39,!1,!0,!1,!1),e.register(ue,q[ue],38,!1,!0,!1,!1),e.register(ce,q[ce],40,!1,!0,!1,!1),e.register(he,q[he],36,!1,!0,!1,!1),e.register(fe,q[fe],35,!1,!0,!1,!1),e.register(de,q[de],33,!1,!0,!1,!1),e.register(pe,q[pe],34,!1,!0,!1,!1),e.register(he,q[he],37,r,!0,!1,n),e.register(fe,q[fe],39,r,!0,!1,n),e.register(ge,q[ge],38,r,!0,!1,n),e.register(me,q[me],40,r,!0,!1,n),e.register(be,q[be],36,!0,!0,!1,!1),e.register(ye,q[ye],35,!0,!0,!1,!1),e.register("copy",q.copy,67,r,!1,!1,n),e.register("cut",q.cut,88,r,!1,!1,n),e.register("paste",q.paste,86,r,!1,!1,n),e.register("undo",q.undo,90,r,!1,!1,n),e.register(Ce,q.redo,89,r,!1,!1,n),t&&e.register(Ce,q.redo,90,r,!0,!1,n),e.register(Re,q[Re]),e.register(De,q[De]),e.register(Ne,q[Ne]),e.register(Fe,q[Fe]),e.register(_e,q[_e]),e.register(we,q[we]),e.register(ve,q[ve]),e.register(xe,q[xe]),e.register(Se,q[Se]),e.register(Te,q[Te]),e.register(Ae,q[Ae]),e.register(ke,q[ke]),e.register(Me,q[Me]),e.register("zoom",q.zoom),e.register(Ie,q[Ie]),e.register(Ee,q[Ee])},Pe={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",1:"value"},Le=".cellEditAction",q[A]={canUndo:!1,execute:Bt(3)},q[D]={canUndo:!1,execute:Bt(4)},q[N]={canUndo:!1,execute:Bt(1)},q[F]={canUndo:!1,execute:Bt(2)},q[ae]={canUndo:!1,execute:function(e,t){var r=Lt(e,t),n=q.Wx;return n&&(r=n.fv(r)),r.fv&&r.fv(),!0}},q[ne]={canUndo:!1,execute:function(e,t){var r=Lt(e,t),n=q.Wx;return n&&(r=n.Xx(r)),r.yx(2,!1),!0}},q[oe]={canUndo:!1,execute:function(e,t){var r=Lt(e,t),n=q.Wx;return n&&(r=n.Yx(r)),r.yx(1,!1),!0}},q[H]={canUndo:!1,execute:function(e,t){var r=Lt(e,t);return q.Qx(r,4,R,r.frozenColumnCount()-1)}},q[_]={canUndo:!1,execute:function(e,t){var r=Lt(e,t);return q.Qx(r,4,R,-1)}},q[Z]={canUndo:!1,execute:function(e,t){var r=Lt(e,t);return q.Qx(r,3,R,gt(r)-r.frozenTrailingColumnCount())}},q[P]={canUndo:!1,execute:function(e,t){var r=Lt(e,t);return q.Qx(r,3,R,gt(r))}},q[L]={canUndo:!1,execute:function(e,t){var r=Lt(e,t);return q.Qx(r,2,-1,R)}},q[j]={canUndo:!1,execute:function(e,t){var r=Lt(e,t);return q.Qx(r,1,pt(r),R)}},q[J]={canUndo:!1,execute:function(e,t){var r,n,o,i,a,s=Lt(e,t);if(!s||2===s._editorStatus)return!1;if((r=s.Ew())===R||r===s.lq)return!0;if(n=s.Gr(1,3),(o=s._q(s.Jl-n.length))<r&&(o=r),i=q.Wx){if((a=i.Zx(s,o,r)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.Qs(o,s.getActiveColumnIndex())&&(s.Jr(o,R),s.Qr=o,s.yx()),s.mq(r,0),!0)}},q[Q]={canUndo:!1,execute:function(e,t){var r,n,o,i,a,s=Lt(e,t);if(!s||2===s._editorStatus)return!1;if((r=s.$x())===R||r===s.lq)return!0;if(n=s.Gr(1,3),(o=s.gr(s.Jl+n.length))<r&&(o=r),i=q.Wx){if((a=i._x(s,o,r)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.Qs(o,s.getActiveColumnIndex())&&(s.Jr(o,R),s.Qr=o,s.yx()),s.mq(r,0),!0)}},q[ee]={canUndo:!1,execute:function(e,t){Ht(Lt(e,t),!0)}},q[$]={canUndo:!1,execute:function(e,t){Ht(Lt(e,t),!1)}},q[G]={canUndo:!1,execute:function(e,t){var r,n,o=Lt(e,t);if(!o||2===o._editorStatus)return!1;if(r=q.Wx){if((n=r.ay(o)).r)return!0;o=n.sheet}return o.yx(5,!1,o.Jl,o.Kl),!0}},q[Y]={canUndo:!1,execute:function(e,t){var r,n,o=Lt(e,t);if(!o||2===o._editorStatus)return!1;if(r=q.Wx){if((n=r.by(o)).r)return!0;o=n.sheet}return o.yx(6,!1,o.Jl,o.Kl),!0}},q[Re]={canUndo:!1,execute:function(e,t){var r=Lt(e,t);return!!r.parent&&Ut(r,r.parent.nextControl)}},q[De]={canUndo:!1,execute:function(e,t){var r=Lt(e,t);return!!r.parent&&Ut(r,r.parent.previousControl)}},q[K]={canUndo:!1,execute:function(e,t){var r=Lt(e,t),n=q.Wx;return n&&(r=n.ey(r)),Gt(r,4),!0}},q[X]={canUndo:!1,execute:function(e,t){var r=Lt(e,t),n=q.Wx;return n&&(r=n.gy(r)),Gt(r,3),!0}},q[Ne]={canUndo:!1,execute:function(e,t){var r,n=Lt(e,t),o=n.Qr,i=n.getActiveColumnIndex();return n.Tx=!0,r=n.hy(n.getActiveRowIndex(),i,!0,o),n.Tx=!1,!r||r.leadingCellRow<o||r.leadingCellRow===o&&i>r.col?q[Re].execute(e,t):q[K].execute(e,t)}},q[Fe]={canUndo:!1,execute:function(e,t){var r,n=Lt(e,t),o=n.Qr,i=n.getActiveColumnIndex();return n.Tx=!0,r=n.iy(n.getActiveRowIndex(),i,!0,o),n.Tx=!1,!r||r.leadingCellRow>o||r.leadingCellRow===o&&i<r.col?q[De].execute(e,t):q[X].execute(e,t)}},q[ie]={canUndo:!1,execute:function(e,t){var r,n,o,i,a,s,l,u=Lt(e,t),c=q.Wx;return c&&(r=c.jy(u)),u.isEditing()?(n=u.Jl,o=u.Kl,i=u.getValue(n,o,3,1),!!u.endEdit(!0)&&((s=(a=u._modelManager)&&a.ZHb)&&s.getAnchorCell(n,o)||u.setValue(n,o,i,3,!0),!0)):O(r)?(q.Yxb(u.parent),u.uu=R,u.parent.uu.hZ(),(l=u).ex&&l.ex(),void(l.Sob&&l.Sob())):r}},q.Yxb=function(e){var t,r,n,o=e&&e.sheets;if(o)for(t=0,r=o.length;t<r;t++)(n=o[t])&&n.at&&n.at.ky()},q[te]={canUndo:!1,execute:function(e,t){var r,n=Lt(e,t);return!n.isEditing()&&(r=n.getSelections(),n.wu().execute({cmd:Ie,sheetName:n.name(),ranges:r}),!0)}},q[re]={canUndo:!1,execute:function(e,t){var r=Lt(e,t);return!r.isEditing()&&(U.Ul.sl()?q[te].execute(e,t):r.startEdit(!0,""),!0)}},q.copy={canUndo:!1,execute:function(e,t){var r=Lt(e,t),n=t.copyData=r.ux(t.ignoreClipboard);return t.callback&&t.callback(),!n||V}},q.cut={canUndo:!1,execute:function(e,t){var r=Lt(e,t),n=t.cutData=r.sx(t.ignoreClipboard);return t.callback&&t.callback(),!n||V}},q.paste={canUndo:!1,execute:function(e,t){Lt(e,t).vx(t)}},q[se]={canUndo:!1,execute:jt(37)},q[le]={canUndo:!1,execute:jt(39)},q[ue]={canUndo:!1,execute:jt(38)},q[ce]={canUndo:!1,execute:jt(40)},q[he]={canUndo:!1,execute:jt(37,!0)},q[fe]={canUndo:!1,execute:jt(39,!0)},q[de]={canUndo:!1,execute:jt(33)},q[pe]={canUndo:!1,execute:jt(34)},q[ge]={canUndo:!1,execute:jt(38,!0)},q[me]={canUndo:!1,execute:jt(40,!0)},q[be]={canUndo:!1,execute:jt(36,!0)},q[ye]={canUndo:!1,execute:jt(35,!0)},q[_e]={canUndo:!1,execute:function(e,t){var r=Lt(e,t),n=r&&r._eventHandler;if(n){St(r);try{n.ly&&n.ly()}finally{xt(r)}}}},q.undo={canUndo:!1,execute:function(e){var t;!e||(t=e.undoManager())&&t.canUndo()&&t.undo()}},q.redo={canUndo:!1,execute:function(e){var t;!e||(t=e.undoManager())&&t.canRedo()&&t.redo()}},q[we]={canUndo:!0,execute:function(e,t,r){return Ot(e,je,t,r)}},q[ve]={canUndo:!0,execute:function(e,t,r){return Ot(e,He,t,r)}},q[xe]={canUndo:!0,execute:function(e,t,r){return Ot(e,Ge,t,r)}},q[Se]={canUndo:!0,execute:function(e,t,r){return Ot(e,Ue,t,r)}},q[Te]={canUndo:!0,execute:function(e,t,r){return Ot(e,We,t,r)}},q[Ae]={canUndo:!0,execute:function(e,t,r){return Ot(e,Ve,t,r)}},q[ke]={canUndo:!0,execute:function(e,t,r){return Ot(e,ze,t,r)}},q[Me]={canUndo:!0,execute:function(e,t,r){return Ot(e,qe,t,r)}},q.zoom={canUndo:!0,execute:function(e,t,r){return Ot(e,Ze,t,r)}},q[Ie]={canUndo:!0,execute:function(e,t,r){return Ot(e,Ke,t,r)}},q[Ee]={canUndo:!0,execute:function(e,t,r){return Ot(e,Je,t,r)}},Wt.prototype.py=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k=this,M=k.my,I=k.kj;if(I&&M){if(e=k.ny,t=M.row,r=M.col,n=mt(M),o=bt(M),i=k.oy,a=!1,-1===t&&(a=!0,t=0,n=pt(I)),-1===r&&(a=!0,r=0,o=gt(I)),l=[],0<(64&e))for(c=0;c<o;c++)l[c]=I.Aj(-1,c)||R;for(h=0;h<n;h++)for(f=t+h,0<(64&e)&&(s=I.Aj(f,-1)||R),d=0;d<o;d++){if(p=void 0,g=r+d,E&&0<(2&e)&&I.getFormulaInformation&&(p=I.getFormulaInformation(f,g)).hasFormula)if(p.isArrayFormula){if((m=p.baseRange).row===f&&m.col===g)for(b=m.row,y=m.row+mt(m);b<y;b++)for(C=m.col,w=m.col+bt(m);C<w;C++)k.qy(i,b-t,C-r,p,2)}else k.qy(i,h,d,p.formula,2);!(0<(1&e))||p&&p.hasFormula||k.qy(i,h,d,I.getValue(f,g,3),1),0<(16&e)&&I.getSparkline&&(v=I.getSparkline(f,g),S=R,v&&(S=v.data()),v&&S&&k.qy(i,h,d,v,16)),0<(64&e)&&(x=void 0,x=a?I.getActualStyle(f,g,3):(u=I.Aj(f,g)||R,I.Dq(f,g,3,u,s,l[d])),T=V,x&&x.toJSON&&(T=JSON.stringify(x.toJSON(3,!0))),k.qy(i,h,d,T,64)),A=I._modelManager.Ky,0<(4&e)&&A&&k.qy(i,h,d,A.get(f,g),4),0<(128&e)&&k.qy(i,h,d,I.getTag(f,g,3),128),0<(256&e)&&k.qy(i,h,d,I.getBindingPath&&I.getBindingPath(f,g,3),256),0<(1024&e)&&k.qy(i,h,d,I.getHyperlink&&I.getHyperlink(h,d,3),1024)}}},Wt.prototype.sy=function(){return this.oy},Wt.prototype.qy=function(e,t,r,n,o){!O(n)&&e&&(e[t]===V&&(e[t]=[]),e[t][r]===V&&(e[t][r]={}),e[t][r][Pe[o]]=n)},Wt.prototype.uy=function(e){var t,r,n,o,i,a,s,l;if(e)for(t=this.oy,r=0,n=e.length;r<n;r++)if(o=e[r])for(i=0,a=o.length;i<a;i++)(s=o[i])&&(t[r]||(t[r]=[]),(l=t[r][i])?this.vy(s,l)&&(t[r][i]=V):t[r][i]=s)},Wt.prototype.vy=function(e,t){var r,n,o,i=this.ny,a=[];for(256&i&&a.push(Pe[256]),4&i&&a.push(Pe[4]),2&i&&a.push(Pe[2]),16&i&&a.push(Pe[16]),64&i&&a.push(Pe[64]),128&i&&a.push(Pe[128]),1024&i&&a.push(Pe[1024]),1&i&&a.push(Pe[1]),r=0,n=a.length;r<n;r++)if(e[o=a[r]]!==t[o])return!1;return!0},Wt.prototype.wy=function(){var e,t,r,n,o,i=this.my.row,a=this.my.col,s=this.oy,l=this.Iu;if(l&&0<l.length)return l;for(l=[],i=-1===i?0:i,a=-1===a?0:a,e=0,t=s.length;e<t;e++)if(r=s[e])for(n=0,o=r.length;n<o;n++)r[n]&&l.push({row:e+i,col:n+a});return this.Iu=l},Oe=Wt,q.xy=Oe,q.Bu=function(e,t,r,n,o,i,a,s,l){e&&(t<0&&(t=0,n=pt(e)),r<0&&(r=0,o=gt(e)),e.Bu(t,r,n,o,i,a,V,V,s,l))},q.bWa=function(e){return"changes"+e},q.cWa=function(e){return e&&(0!==e.length||!m.isEmptyObject(e))},q.aWa=function(n){var e,t=n.sheetName;return"string"==typeof t?e=[t]:Array.isArray(t)&&(e=t),!!e&&e.every(function(e){var t=q.bWa(e),r=n[t];return r&&0===r.length&&m.isEmptyObject(r)})},q.startTransaction=function(e,t){Vt(e,t.sheetName).forEach(function(e){e._modelManager.startTransaction()})},q.endTransaction=function(e,r){Vt(e,r.sheetName).forEach(function(e){var t=q.bWa(e.name());r[t]=e._modelManager.endTransaction()})},q.undoTransaction=function(e,r){Vt(e,r.sheetName).forEach(function(e){var t=q.bWa(e.name());e._modelManager.undo(r[t]),e.$p()})},q.Zxb=function(e){e.forEach(function(e){e._modelManager.startTransaction()})},q.$xb=function(e,r){e.forEach(function(e){var t=q.bWa(e.name());r[t]=e._modelManager.endTransaction()})},q._xb=function(e,r){e.forEach(function(e){var t=q.bWa(e.name());e._modelManager.undo(r[t])})},Zt.prototype.execute=function(){},Zt.prototype.canExecute=function(){return!0},Zt.prototype.canUndo=function(){return!0},Zt.prototype.undo=function(){return!0},Be=Zt,q.ActionBase=Be,dt(er,it=Be),er.prototype.execute=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p=!1;if(this.canExecute()&&(e=this.VQ,t=this.kj,r=e.columns,n=e.rowHeader,o=r&&r.length,t&&0<o)){if(i=this.Sz(r),a={sheet:t,sheetName:t.name(),colList:i,header:n,cancel:!1},t.Wq(b,a),!0===a.cancel)return p;e.Tz=!0,t._modelManager.startTransaction(),zt(t);try{for(s=gt(t,n?2:3),t.qq=e.qq,l=e.size,u=0;u<o;u++)for(h=(c=r[u]).firstCol,f=c.lastCol,d=h;d<=f;d++)0<=d&&d<s&&(n&&t.getColumnResizable(d,2)&&l!==t.$r(d,2)?(t.setColumnWidth(d,l,2),p=!0):!n&&t.getColumnResizable(d,3)&&l!==t.$r(d,3)&&(t.setColumnWidth(d,l,3),p=!0))}finally{At(t),m[m.sd]({tc:t.parent}),t.Wq(S,{sheet:t,sheetName:t.name(),colList:i,header:e.rowHeader}),xt(t),e[q.bWa(t.name())]=t._modelManager.endTransaction()}t.qs()}return p},er.prototype.undo=function(){var e,t,r,n,o,i,a,s,l=!1;if(this.canUndo()&&(e=this.VQ,t=this.kj,r=e.columns,n=e.rowHeader,o=r&&r.length,t&&0<o)){if(i=this.Sz(r),a={sheet:t,sheetName:t.name(),colList:i,header:n,cancel:!1},t.Wq(b,a),!0===a.cancel)return l;zt(t);try{s=q.bWa(t.name()),t._modelManager.undo(e[s]),t.oq=!0,t.showCell(t.getActiveRowIndex(),t.getActiveColumnIndex(),1,1),l=!0}finally{At(t),m[m.sd]({tc:t.parent}),t.Wq(S,{sheet:t,sheetName:t.name(),colList:i,header:e.rowHeader}),xt(t)}}return l},er.prototype.Sz=function(e){var t,r,n,o,i,a,s=[];for(t=0,r=e.length;t<r;t++)for(o=(n=e[t]).firstCol,i=n.lastCol,a=o;a<=i;a++)s.push(a);return s},er.prototype.canUndo=function(){return this.VQ.Tz},je=er,dt($t,ot=Be),$t.prototype.execute=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p=!1;if(this.canExecute()&&(e=this.kj,n=(r=(t=this.VQ).rows)&&r.length,e&&0<n)){if(o=this.Vz(r),i={sheet:e,sheetName:e.name(),rowList:o,header:t.columnHeader,cancel:!1},e.Wq(x,i),!0===i.cancel)return p;t.Tz=!0,e._modelManager.startTransaction(),zt(e);try{for(s=pt(e,(a=t.columnHeader)?1:3),e.lq=t.lq,l=t.size,u=0;u<n;u++)for(h=(c=r[u]).firstRow,f=c.lastRow,d=h;d<=f;d++)0<=d&&d<s&&(a&&e.getRowResizable(d,1)&&l!==e.Yr(d,1)?(e.setRowHeight(d,l,1),p=!0):!a&&e.getRowResizable(d,3)&&l!==e.Yr(d,3)&&(e.setRowHeight(d,l,3),p=!0))}finally{At(e),m[m.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.name(),rowList:o,header:t.columnHeader}),xt(e),t[q.bWa(e.name())]=e._modelManager.endTransaction()}e.os()}return p},$t.prototype.undo=function(){var e,t,r,n,o,i,a,s=!1;if(this.canUndo()&&(e=this.kj,n=(r=(t=this.VQ).rows)&&r.length,e&&0<n)){if(o=this.Vz(r),i={sheet:e,sheetName:e.name(),rowList:o,header:t.columnHeader,cancel:!1},e.Wq(x,i),!0===i.cancel)return s;zt(e);try{a=q.bWa(e.name()),e._modelManager.undo(t[a]),e.jq=!0,e.showCell(e.getActiveRowIndex(),e.getActiveColumnIndex(),1,1),s=!0}finally{At(e),m[m.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.name(),rowList:o,header:t.columnHeader}),xt(e)}}return s},$t.prototype.Vz=function(e){var t,r,n,o,i,a,s=[];for(t=0,r=e.length;t<r;t++)for(o=(n=e[t]).firstRow,i=n.lastRow,a=o;a<=i;a++)s.push(a);return s},$t.prototype.canUndo=function(){return this.VQ.Tz},He=$t,dt(Qt,nt=Be),Qt.prototype.execute=function(){var e,t,r,n,o,i,a,s=!1,l=this.VQ,u=this.kj,c=l.columns,h=l.rowHeader,f=this.Sz(c);if(u&&c&&0<c.length){if(e={sheet:u,sheetName:u.Cj,colList:f,header:h,cancel:!1},u.Wq(b,e),!0===e.cancel)return s;u._modelManager.startTransaction(),this.Lz(u);try{t=p(l.size),r=h?2:3,n=c[0].firstCol,a=i=void 0,t!==(o=u.$r(n,r))&&(i=t-o,a=u.Zq(n,r),u.setColumnWidth(n,t,r),u.setColumnWidth(a,u.$r(a,r)-i,r)),s=!0}finally{At(u),m[m.sd]({tc:u.parent}),u.Wq(S,{sheet:u,sheetName:u.Cj,colList:f,header:l.rowHeader}),xt(u),l[q.bWa(u.name())]=u._modelManager.endTransaction()}}return s},Qt.prototype.undo=function(){var e,t=this.kj,r=this.VQ.columns,n=!1,o=this.VQ,i=this.VQ.rowHeader,a=this.Sz(r),s={sheet:t,sheetName:t.Cj,colList:a,header:i,cancel:!1};if(t.Wq(b,s),!0===s.cancel)return n;zt(t);try{e=q.bWa(t.name()),t._modelManager.undo(o[e]),n=!0}finally{At(t),m[m.sd]({tc:t.parent}),t.Wq(S,{sheet:t,sheetName:t.Cj,colList:a,header:o.rowHeader}),xt(t)}return n},Qt.prototype.Sz=function(e){var t,r,n,o,i,a,s=[];for(t=0,r=e.length;t<r;t++)for(o=(n=e[t]).firstCol,i=n.lastCol,a=o;a<=i;a++)s.push(a);return s},Ge=Qt,dt(Jt,rt=Be),Jt.prototype.execute=function(){var e,t,r,n,o,i,a,s=!1,l=this.VQ,u=this.kj,c=l.rows,h=l.columnHeader,f=this.Vz(c);if(u&&c&&0<c.length){if(e={sheet:u,sheetName:u.Cj,rowList:f,header:h,cancel:!1},u.Wq(x,e),!0===e.cancel)return s;u._modelManager.startTransaction(),this.Lz(u);try{t=p(l.size),r=h?1:3,n=c[0].firstRow,a=i=void 0,t!==(o=u.Yr(n,r))&&(i=t-o,a=u._q(n,r),u.setRowHeight(n,t,r),u.setRowHeight(a,u.Yr(a,r)-i,r)),s=!0}finally{At(u),m[m.sd]({tc:u.parent}),u.Wq(T,{sheet:u,sheetName:u.Cj,rowList:f,header:l.columnHeader}),xt(u),l[q.bWa(u.name())]=u._modelManager.endTransaction()}}return s},Jt.prototype.undo=function(){var e,t=this.kj,r=this.VQ.rows,n=!1,o=this.VQ,i=this.VQ.columnHeader,a=this.Vz(r),s={sheet:t,sheetName:t.Cj,rowList:a,header:i,cancel:!1};if(t.Wq(x,s),!0===s.cancel)return n;zt(t);try{e=q.bWa(t.name()),t._modelManager.undo(o[e]),n=!0}finally{At(t),m[m.sd]({tc:t.parent}),t.Wq(T,{sheet:t,sheetName:t.Cj,rowList:a,header:o.columnHeader}),xt(t)}return n},Jt.prototype.Vz=function(e){var t,r,n,o,i,a,s=[];for(t=0,r=e.length;t<r;t++)for(o=(n=e[t]).firstRow,i=n.lastRow,a=o;a<=i;a++)s.push(a);return s},Ue=Jt,dt(Xt,tt=Be),Xt.prototype.canExecute=function(){var e=this.VQ;return this.kj&&e.columns&&0<e.columns.length},Xt.prototype.execute=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p=!1;if(this.canExecute()){if(e=this.VQ,t=this.kj,r=this.Wz,n=this.Sz(e.columns),o=2===r,i={sheet:t,sheetName:t.name(),colList:n,header:o,cancel:!1},t.Wq(b,i),!0===i.cancel)return p;for(e.Tz=!0,s=(a=gt(t,r))-1,u=void(l=0),c=0,h=e.columns.length;c<h;c++)s=(u=e.columns[c].col)<s?u:s,l=l<u?u:l;U.mn.qn(t,0,s,pt(t)-1,l),t._modelManager.startTransaction(),zt(t);try{for(f=void 0,c=0,h=e.columns.length;c<h;c++)0<=(d=e.columns[c].col)&&d<a&&t.getColumnResizable(d,r)&&((f=this.xl(d))===t.getColumnWidth(d,r)&&O(t.getColumnWidth(d,r,!0))||(t.setColumnWidth(d,f,r),p=!0))}finally{U.mn.Nm(),At(t),m[m.sd]({tc:t.parent}),t.Wq(S,{sheet:t,sheetName:t.name(),colList:n,header:o}),xt(t),e[q.bWa(t.name())]=t._modelManager.endTransaction()}}return p},Xt.prototype.undo=function(){var e,t,r,n,o,i,a,s=!1;if(this.canUndo()){if(e=this.VQ,t=this.kj,r=this.Wz,n=this.Sz(e.columns),o=2===r,i={sheet:t,sheetName:t.name(),colList:n,header:o,cancel:!1},t.Wq(b,i),!0===i.cancel)return s;zt(t);try{a=q.bWa(t.name()),t._modelManager.undo(e[a]),s=!0}finally{At(t),m[m.sd]({tc:t.parent}),t.Wq(S,{sheet:t,sheetName:t.name(),colList:n,header:o}),xt(t)}}return s},Xt.prototype.Sz=function(e){var t,r,n=[];for(t=0;t<e.length;t++)r=e[t],n.push(r.col);return n},Xt.prototype.xl=function(e){return U.Ul.xl(e,this.kj,this.Wz,this.VQ.autoFitType)},Xt.prototype.canUndo=function(){return this.VQ.Tz},We=Xt,dt(Kt,et=Be),Kt.prototype.canExecute=function(){var e=this.VQ;return this.kj&&e.rows&&0<e.rows.length},Kt.prototype.execute=function(){var e,t,r,n,o,i,a,s,l,u,c,h=!1;if(this.canExecute()){if(e=this.VQ,t=this.kj,r=this.Vz(e.rows),n=this.Wz,o=1===this.Wz,i={sheet:t,sheetName:t.name(),rowList:r,header:o,cancel:!1},t.Wq(x,i),!0===i.cancel)return h;e.Tz=!0,t._modelManager.startTransaction(),zt(t);try{for(a=pt(t,n),s=void 0,l=0,u=e.rows.length;l<u;l++)0<=(c=e.rows[l].row)&&c<a&&t.getRowResizable(c,n)&&((s=this.Fl(c))===t.getRowHeight(c,n)&&O(t.getRowHeight(c,n,!0))||(t.setRowHeight(c,s,n),h=!0))}finally{At(t),m[m.sd]({tc:t.parent}),t.Wq(T,{sheet:t,sheetName:t.name(),rowList:r,header:o}),xt(t),e[q.bWa(t.name())]=t._modelManager.endTransaction()}}return h},Kt.prototype.undo=function(){var e,t,r,n,o,i,a=!1;if(this.canUndo()){if(e=this.VQ,t=this.kj,r=this.Vz(e.rows),n=1===this.Wz,o={sheet:t,sheetName:t.name(),rowList:r,header:n,cancel:!1},t.Wq(x,o),!0===o.cancel)return a;zt(t);try{i=q.bWa(t.name()),t._modelManager.undo(e[i]),a=!0}finally{At(t),m[m.sd]({tc:t.parent}),t.Wq(T,{sheet:t,sheetName:t.name(),rowList:r,header:n}),xt(t)}}return a},Kt.prototype.Vz=function(e){var t,r,n,o=[];for(t=0,r=e.length;t<r;t++)n=e[t],o.push(n.row);return o},Kt.prototype.Fl=function(e){return U.Ul.Fl(e,this.kj,this.Wz,this.VQ.autoFitType)},Kt.prototype.canUndo=function(){return this.VQ.Tz},Ve=Kt,dt(rr,at=Be),rr.prototype.canExecute=function(){var e,t,r=this.kj,n=this.VQ,o=n.ranges,i=n.row,a=n.col;if(o){for(e=0;e<o.length;e++)if(t=o[e],!r.Y3(t.row,t.col,mt(t),bt(t)))return!1}else if(!r.Y3(i,a,1,1))return!1;return!0},rr.prototype.yA=function(e){var t,r,n,o,i=this.VQ,a=i.ranges;if(a)for(t=0;t<a.length;t++)for(n=(r=a[t]).row;n<r.row+mt(r);n++)for(o=r.col;o<r.col+bt(r);o++)e(n,o);else e(i.row,i.col)},rr.prototype.undo=function(){var r,e,t;if(this.canUndo()){r=this.kj,e=this.VQ,zt(r,!0);try{r._bind(a+Le,function(e,t){tr(r,t)}),t=q.bWa(r.name()),r._modelManager.undo(e[t])}catch(r){return!1}finally{r._unbind(a+Le),qt(r,!0)}return!0}return!1},rr.prototype.execute=function(){var r,e,t,n,o=!1;if(this.canExecute()){(r=this.kj)._modelManager.startTransaction(),zt(r,!0);try{r._bind(a+Le,function(e,t){tr(r,t)}),this.VQ.applyResult=this.AA(),o=!0}catch(r){o=!1}finally{r._unbind(a+Le),qt(r,!0),e=q.bWa(r.name()),this.VQ[e]=r._modelManager.endTransaction()}t=r.am(),n=new U.Rect(t.kt,t.nt,t.width-t.kt,t.height-t.nt),r.repaint(n)}return o},rr.prototype.zA=function(e,t){return e+"_"+t},rr.prototype.BA=function(e){var t,r,n,o,i,a=0,s=this.kj,l=this.VQ,u=l.row,c=l.col,h=l.newValue,f=!l.hasOwnProperty("autoFormat")||l.autoFormat;return E&&h&&0<h.length&&"="===h[0]?s.getDataValidator&&s.getDataValidator(u,c)&&""!==(t=h.substring(1))&&t!==s.getFormula(u,c)&&(r=s.Cf())&&(n=r.parse(s.yj(),t,0<=u?u:0,0<=c?c:0,!0))&&(o=r._evaluateParsedFormula(s.yj(),n,{row:u,col:c}),s.isValid&&!s.isValid(u,c,o)&&(a=s.Nx(u,c))):(i=this.CA(u,c,h,f,e),!s.isValid||s.isValid(u,c,i)||(a=s.Nx(u,c),s._eventHandler.DA=!0)),a},rr.prototype.AA=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p=this.kj,g=this.VQ,m=g.newValue,b={tka:!1,uka:!1,_autoFormatter:V,quotePrefix:V},y=this.BA(b);if(1===y||2===y)return y;if(t=!g.hasOwnProperty("autoFormat")||g.autoFormat,r=0<=(r=g.row)?r:0,n=0<=(n=g.col)?n:0,E&&v&&v.Parser)if(a=p.Cf(),l=(s=p.parent)&&s.options.allowUserEditFormula,"@"!==p.getFormatter(r,n)&&l&&a&&m&&0<m.length&&"="===m[0])try{if(g.ranges&&1===g.endEditType)return i=g.ranges[0],p.setArrayFormula(i.row,i.col,mt(i),bt(i),m.substring(1)),y;o=a.parse(p.yj(),m.substring(1),r,n,!0)}catch(e){throw p.Os(0,"string"==typeof e?e:e.message),e}else g.ranges&&1===g.endEditType&&(i=g.ranges[0],p.getRange(i.row,i.col,mt(i),bt(i),3).clear(1));return o||(m&&"'"===m[0]?this.Uia(r,n,!0,b):this.Uia(r,n,V,b),e=this.CA(r,n,m,t,b)),this.yA(function(t,r){if(o)try{p._u(t,r,a.unparse(p.yj(),o,t,r),o),p.Wq(U.Events.UserFormulaEntered,{sheet:p,sheetName:p.name(),row:t,col:r,isCircularReference:p.ngc(t,r),formula:m.substring(1).toUpperCase()})}catch(e){throw p.Os(0,"string"==typeof e?e:e.message),e}else{try{p.hasFormula&&p.hasFormula(t,r)&&p.setFormula(t,r,R)}catch(e){throw p.Os(0,"string"==typeof e?e:e.message),e}try{p.uq(t,r,e,g.sheetArea),"string"!=typeof e&&null!==e||w.Worksheet.ao(p,"setHyperlinkWhenEditing",{url:e,row:t,col:r,sheetArea:g.sheetArea})}catch(e){p.setValue(t,r,m)}}}),c=b.uka,((u=b.tka)||c)&&(f="string"==typeof(h=p.Aj(r,n)),h&&!f||(d=new C.Style,f&&(d.parentName=h),h=d),u&&(h._autoFormatter=b._autoFormatter),c&&(h.quotePrefix=b.quotePrefix),p.setStyle(r,n,h)),y},rr.prototype.canUndo=function(){return 0===this.VQ.applyResult},rr.prototype.CA=function(e,t,r,n,o){var i,a,s,l=this.kj,u=this.VQ,c=u.ignoreFormatting,h=l.getActualStyle(e,t),f={};return i="string"!=typeof r||c?r:r&&"'"===r[0]?r.substring(1):U.Ul.ul(h,r,n,f,u.editingFormatter),o.quotePrefix?(o._autoFormatter=V,o.tka=!0):(a=f.value,n&&a&&((i===(s=R)||"General"===a.formatString())&&h._autoFormatter||(a.isAuto=!0,s=a),s&&(o.tka=!0,o._autoFormatter=s))),i},rr.prototype.Uia=function(e,t,r,n){var o,i=this.kj.Aj(e,t),a="string"==typeof i;i&&!a||(o=new C.Style,a&&(o.parentName=i),i=o),i.quotePrefix!==r&&(n.uka=!0,n.quotePrefix=r)},ze=rr,dt(ir,lt=Be),ir.prototype.canUndo=function(){return!!this.VQ.FA},ir.prototype.canExecute=function(){var e=this.VQ;return this.kj&&e.name&&e.name!==e.FA},ir.prototype.execute=function(){var e=this.kj,t=this.VQ,r=t.name,n=!1;return this.canExecute()&&(t.FA=e.name(),e._modelManager.startTransaction(),zt(e,!0),kt(e),e.cq(r),nr(e),t[q.bWa(e.name())]=e._modelManager.endTransaction(),n=!0,t.sheetName=r,Mt(e,!1),qt(e,!0)),n},ir.prototype.undo=function(){var e,t,r;return!(!this.canUndo()||(e=this.kj,t=this.VQ,!e)||(zt(e,!0),kt(e),r=q.bWa(e.name()),e._modelManager.undo(t[r]),nr(e),t.sheetName=t.FA,Mt(e,!1),qt(e,!0),0))},qe=ir,dt(or,st=Be),or.prototype.canExecute=function(){return this.kj&&this.kj.parent.options.allowUserZoom&&this.kj.zoom()!==this.VQ.zoomFactor},or.prototype.execute=function(){var e,t,r,n,o,i=this.VQ,a=!1;return this.canExecute()&&(t=(e=this.kj)._modelManager,r=i.zoomFactor,t.startTransaction(),o=r,a=!(!0===(n=e).isEditing()&&!n.endEdit()||(n.suspendPaint(),n.zoom(o),n.resumePaint(),0)),t.ZVa(["zoomChanged",r,i.oldZoomFactor]),i[q.bWa(e.name())]=e._modelManager.endTransaction()),a},or.prototype.undo=function(){var e,t=this.kj;if(this.canUndo())return!(!0===t.isEditing()&&!t.endEdit()||(t.suspendPaint(),e=q.bWa(t.name()),t._modelManager.undo(this.VQ[e]),t.resumePaint(),0))},Ze=or,dt(ur,ft=Be),ur.prototype.execute=function(){var e,t,r,n,o,i,a,s,l,u;this.canExecute()&&(e=this.kj,t=this.VQ.clearRange,r=e.tables&&e.tables.$Hb&&e.tables.$Hb(t.row,t.col,t.rowCount,t.colCount),e.isDirtySuspended()||(this.VQ.Iu=new Oe(e,e.Tq(t),3)),r&&0<r.length&&(this.VQ.tableNames=r),o=(n=e.Tq(t)).row,i=n.col,a=mt(n),0<(s=bt(n))&&0<a&&(e._modelManager.startTransaction(),zt(e),e.vxb=!0,e.cg(o,i,a,s,3,1,!0),qt(e),e.vxb=!1,l=q.bWa(e.name()),this.VQ[l]=e._modelManager.endTransaction(),u=this.VQ.Iu,q.Bu(e,o,i,a,s,u?u.wy():[],2,r)))},ur.prototype.canExecute=function(){var e=this.VQ.clearRange;return this.kj.Y3(e.row,e.col,mt(e),bt(e))},ur.prototype.canUndo=function(){var e=q.bWa(this.kj.name()),t=this.VQ[e];return q.cWa(t)},ur.prototype.undo=function(){var e,t,r,n=this.kj;if(this.canUndo()&&n&&0<bt(e=n.Tq(this.VQ.clearRange))&&0<mt(e)){zt(n);try{t=q.bWa(n.name()),n._modelManager.undo(this.VQ[t])}finally{qt(n)}return r=this.VQ.Iu,q.Bu(n,e.row,e.col,mt(e),bt(e),r?r.wy():[],2,this.VQ.tableNames,!0),!0}return!1},Ye=ur,dt(lr,ht=Be),lr.prototype.canExecute=function(){var e,t=this.VQ.MA;if(t){for(e=0;e<t.length;e++)if(!t[e].canExecute())return!1;return!0}return!1},lr.prototype.execute=function(){var e,t,r;if(this.canExecute()&&(e=this.VQ.MA,t=this.kj,e)){for(zt(t,!0),r=0;r<e.length;r++)e[r].execute();return qt(t,!0),!0}return!1},lr.prototype.canUndo=function(){var e,t=this.VQ.MA;if(t){for(e=0;e<t.length;e++)if(!t[e].canUndo())return!1;return!0}return!1},lr.prototype.undo=function(){var e,t,r,n,o=this.VQ.MA;if(this.canUndo()){for(e=this.kj,t=o.length-1;0<=t;t--)if(r=o[t],zt(e,!0),n=r.undo(),qt(e,!0),!n)return!1;return!0}return!1},Ke=lr,q.OA=Ke,dt(sr,ct=Be),sr.qx=function(e){var t=0;return 0!==e&&1!==e||(t|=1),0!==e&&2!==e||(t|=64,t|=32),0!==e&&3!==e||(t|=2),0!==e&&4!==e||(t|=1,t|=64,t|=32),0!==e&&5!==e||(t|=64,t|=32,t|=2),0===e&&(t|=32,t|=16,t|=256,t|=4,t|=512,t|=128,t|=1024),t},sr.prototype.canExecute=function(){var e=this.VQ,t=e.pasteExtent,r=t.targetRange,n=t.sourceRange;return e.toSheet.Y3(r.row,r.col,mt(r),bt(r))&&(!t.isCutting||e.fromSheet.Y3(n.row,n.col,mt(n),bt(n)))},sr.prototype.oUa=function(){var e=this.VQ.pasteExtent,t=this.VQ.io={},r=e.isCutting,n=sr.qx(this.VQ.pasteOption),o=e.sourceRange,i=e.targetRange,a=this.VQ.fromSheet,s=this.VQ.toSheet;a&&o&&r&&!a.isDirtySuspended()&&(t.cA=new Oe(a,o,n)),s.isDirtySuspended()||(t.fA=new Oe(s,i,n))},sr.prototype.VA=function(){return this.VQ.pasteExtent.targetRange},sr.prototype._Hb=function(e,t,r,n,o){var i,a=!1,s=t.row,l=t.col,u=t.rowCount,c=t.colCount,h=!1,f=!1,d=!1,p=!1,g=yt(o),m=!1,b=!1;if(e||u%r.rowCount!=0||c%r.colCount!=0){if(n===W.InsertShiftCell.right){if(s!==r.row&&r.intersect(s,l,r.rowCount,o.getColumnCount()-l))return o.Os(1,z().Exp_InsertCopiedCutCells),{returnFunc:b=!0};if(l>r.col&&l<=r.col+r.colCount-1&&s>r.row&&s<=r.row+r.rowCount-1)return o.Os(1,z().Exp_InsertCopiedCutCells),{returnFunc:b=!0};if(this.aIb(o,s,l,r.rowCount,o.getColumnCount()-l))return o.Os(1,z().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:b=!0};if((m=this.bIb(o,s,o.getColumnCount()-r.colCount,r.rowCount,r.colCount))&&!g)return o.Os(1,z().Exp_InsertCopiedCutCellsNoRange),{returnFunc:b=!0};s===r.row&&l<=r.col&&(r.col=r.col+r.colCount,h=!0)}else if(n===W.InsertShiftCell.down){if(l!==r.col&&r.intersect(s,l,o.getRowCount()-s,r.colCount))return o.Os(1,z().Exp_InsertCopiedCutCells),{returnFunc:b=!0};if(s>r.row&&s<=r.row+r.rowCount-1&&l>r.col&&l<=r.col+r.colCount-1)return o.Os(1,z().Exp_InsertCopiedCutCells),{returnFunc:b=!0};if(this.cIb(o,s,l,o.getRowCount()-s,r.colCount))return o.Os(1,z().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:b=!0};if((m=this.bIb(o,o.getRowCount()-r.rowCount,l,r.rowCount,r.colCount))&&!g)return o.Os(1,z().Exp_InsertCopiedCutCellsNoRange),{returnFunc:b=!0};l===r.col&&s<=r.row&&(r.row=r.row+r.rowCount,f=!0)}}else if(a=!0,n===W.InsertShiftCell.right){if(i=!1,s<=r.row&&s+u>=r.row+r.rowCount&&(i=!0),l>r.col&&l<=r.col+r.colCount-1&&s>r.row&&s<=r.row+r.rowCount-1)return o.Os(1,z().Exp_InsertCopiedCutCells),{returnFunc:b=!0};if(!i&&r.intersect(s,l,u,o.getColumnCount()-l))return o.Os(1,z().Exp_InsertCopiedCutCells),{returnFunc:b=!0};if(this.aIb(o,s,l,u,o.getColumnCount()-l))return o.Os(1,z().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:b=!0};if((m=this.bIb(o,s,o.getColumnCount()-c,u,c))&&!g)return o.Os(1,z().Exp_InsertCopiedCutCellsNoRange),{returnFunc:b=!0};i&&l<=r.col&&(r.col=r.col+c,d=!0)}else if(n===W.InsertShiftCell.down){if(i=!1,l<=r.col&&l+c>=r.col+r.colCount&&(i=!0),s>r.row&&s<=r.row+r.rowCount-1&&l>r.col&&l<=r.col+r.colCount-1)return o.Os(1,z().Exp_InsertCopiedCutCells),{returnFunc:b=!0};if(!i&&r.intersect(s,l,o.getRowCount()-s,c))return o.Os(1,z().Exp_InsertCopiedCutCells),{returnFunc:b=!0};if(this.cIb(o,s,l,o.getRowCount()-s,c))return o.Os(1,z().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:b=!0};if((m=this.bIb(o,o.getRowCount()-u,l,u,c))&&!g)return o.Os(1,z().Exp_InsertCopiedCutCellsNoRange),{returnFunc:b=!0};i&&s<=r.row&&(r.row=r.row+u,p=!0)}return{changePasteDataRangeCol:h,changePasteDataRangeRow:f,changePasteDataRangeCols:d,changePasteDataRangeRows:p,moveRangeHaveValue:m,returnFunc:b,selectRange:a}},sr.prototype.dIb=function(e,t,r,n,o,i,a,s,l){var u,c,h=!1,f=!1;return e?t===W.InsertShiftCell.right?r.Vq(i,a+l,s,r.getColumnCount()-a-l,!0)?a+l<r.getColumnCount()?(r.moveTo(i,a,i,a+l,s,r.getColumnCount()-a-l,1023,!0),(c=(u=r.rowFilter())&&u.range)&&-1===i&&1<c.colCount&&a>c.col&&a<=c.col+c.colCount-1&&(c.colCount=c.colCount+o.colCount)):a+l>r.getColumnCount()&&(f=h=!0):f=h=!0:t===W.InsertShiftCell.down&&(r.Vq(i+s,a,r.getRowCount()-i-s,l,!0)?i+s<r.getRowCount()?r.moveTo(i,a,i+s,a,r.getRowCount()-i-s,l,1023,!0):i+s>r.getRowCount()&&(f=h=!0):f=h=!0):t===W.InsertShiftCell.right?r.Vq(i,a+o.colCount,o.rowCount,r.getColumnCount()-a-o.colCount,!0)?a+o.colCount<r.getColumnCount()?(r.moveTo(i,a,i,a+o.colCount,o.rowCount,r.getColumnCount()-a-o.colCount,1023,!0),(c=(u=r.rowFilter())&&u.range)&&-1===i&&1<c.colCount&&a>c.col&&a<=c.col+c.colCount-1&&(c.colCount=c.colCount+o.colCount)):a+o.colCount>r.getColumnCount()&&(f=h=!0):f=h=!0:t===W.InsertShiftCell.down&&(r.Vq(i+o.rowCount,a,r.getRowCount()-i-o.rowCount,o.colCount,!0)?i+o.rowCount<r.getRowCount()?r.moveTo(i,a,i+o.rowCount,a,r.getRowCount()-i-o.rowCount,o.colCount,1023,!0):i+o.rowCount>r.getRowCount()&&(f=h=!0):f=h=!0),{raiseInvalidOperation:h,returnFunc:f}},sr.prototype.ogc=function(e,t,r,n,o,i,a){e&&(t.col=t.col-t.colCount),r&&(t.row=t.row-t.rowCount),n&&(t.col=t.col-i),o&&(t.row=t.row-a)},sr.prototype.execute=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G=this;if(G.canExecute()){if(e=G.VQ.fromSheet,t=G.VQ.toSheet,r=G.VQ.pasteExtent,n=G.VQ.pasteOption,o=r.sourceRange,i=r.targetRange,a=r.isCutting,e&&o&&!e.pu(o.row,o.col,mt(o),bt(o),pt(e),gt(e)))return;if(!(t&&i&&t.l5(i.row,i.col,mt(i),bt(i),!0)))return;if(t.tables&&t.tables.zxb(e,o,t,i,a))return;if(u=l=s=void 0,e&&(u=e.tu(),s=G.WHb,l=G.YHb),p=d=f=h=c=void 0,G.XHb&&(c=G.XHb.row,h=G.XHb.col,f=G.XHb.rowCount,d=G.XHb.colCount),y=b=m=g=!1,C=yt(t),w=!1,s!==V&&l){if((v=this._Hb(a,G.XHb,l,s,t)).returnFunc)return;g=v.changePasteDataRangeCol,m=v.changePasteDataRangeRow,b=v.changePasteDataRangeCols,y=v.changePasteDataRangeRows,w=v.moveRangeHaveValue,p=v.selectRange}G.oUa(),S=t.parent.sheets,q.Zxb(S),St(t),Tt(t),x=!(t.vxb=!0),e&&(Tt(e),e.vxb=!0);try{if(C&&((A=T=-1)!==i.row?T=i.row+mt(i):-1===o.row&&(T=pt(e)),M=T-(k=pt(t)),k<T&&G.vTa(o,i)?s===W.InsertShiftCell.down&&w?t.addRows(k,k-c+M):t.addRows(k,M):w||c+i.rowCount!==pt(t)||s!==W.InsertShiftCell.down?w&&s===W.InsertShiftCell.down&&t.addRows(k,k-c+M):t.addRows(k,k-c+M-l.rowCount),-1!==i.col?A=i.col+bt(i):-1===o.col&&(A=gt(e)),A>gt(t)&&G.vTa(o,i)?s===W.InsertShiftCell.right&&w?t.setColumnCount(A+t.getColumnCount()-h):t.setColumnCount(A):w||h+i.colCount!==gt(t)||s!==W.InsertShiftCell.right?w&&s===W.InsertShiftCell.right&&t.setColumnCount(A+t.getColumnCount()-h):t.setColumnCount(A+t.getColumnCount()-h-l.colCount)),x=(I=s!==V&&this.dIb(p,s,t,G.XHb,l,c,h,f,d)).raiseInvalidOperation,I.returnFunc)return;o&&U.mn.qn(e,o.row,o.col,o.row+mt(o)-1,o.col+bt(o)-1);try{if(E=!1,e)for(R=o.row;R<o.row+o.rowCount&&!E;R++)for(D=o.col;D<o.col+o.colCount;D++)if(e.getValue(R,D)){E=!0;break}t.tables&&(E||r.clipboardText.replace(/[\r\n\t]/gi,""))&&t.tables.fIb(i,o)}catch(e){return t.Os(6,e.message),void t.resumePaint()}t.px(e,o,t,i,r.isCutting,r.clipboardText,r.clipboardHtml,r.clipboardImage,n,!r.includeFilteredOutRow)}finally{o&&U.mn.Nm(),At(t),t.vxb=!1,e&&(At(e),e.vxb=!1),xt(t),q.$xb(S,G.VQ),N=G.VQ.io,F=sr.qx(n),r.isCutting&&e&&(_=[],e.isDirtySuspended()||((P=new Oe(e,o,F)).uy(N.cA.sy()),_=(N._z=P).wy()),q.Bu(e,o.row,o.col,mt(o),bt(o),_,3)),t&&(L=[],t.isDirtySuspended()||((O=new Oe(t,i,F)).uy(N.fA.sy()),L=(N.dA=O).wy()),B=t.tables&&t.tables.$Hb&&t.tables.$Hb(i.row,i.col,i.rowCount,i.colCount),j=mt(i),H=bt(i),q.Bu(t,i.row,i.col,j,H,L,3,B),G.tableNamesObj={r:i.row,c:i.col,rc:j,cc:H,tableNames:B}),G.pgc={changePasteDataRangeCol:g,changePasteDataRangeRow:m,changePasteDataRangeCols:b,changePasteDataRangeRows:y,acColCount:d,acRowCount:f},u&&delete u.UHb,x&&t.Os(1,z().Exp_InsertCopiedCutCellsNoRange)}}},sr.prototype.aIb=function(e,t,r,n,o){var i,a,s,l=e._modelManager.getSpans(),u=e.tables.l$;for(i=0;i<l.length;i++)if(!(t<=(a=l[i]).row&&r<=a.col&&t+n>=a.row+a.rowCount&&r+o>=a.col+a.colCount||a.row>t+n||a.row+a.rowCount-1<t||a.row>t+n-1||a.row+a.rowCount-1<t||a.col+a.colCount-1<r))return!0;for(i=0;i<u.length;i++)if(!(t<=(s=u[i]).cj&&r<=s.dj&&t+n>=s.cj+s.Xj&&r+o>=s.dj+s.OZ||s.cj>t+n||s.cj+s.Xj-1<t||s.cj>t+n-1||s.cj+s.Xj-1<t||s.dj+s.OZ-1<r))return!0;return!1},sr.prototype.cIb=function(e,t,r,n,o){var i,a,s,l=e._modelManager.getSpans(),u=e.tables.l$;for(i=0;i<l.length;i++)if(!(t<=(a=l[i]).row&&r<=a.col&&t+n>=a.row+a.rowCount&&r+o>=a.col+a.colCount||a.col>r+o||a.col+a.colCount-1<r||a.col>r+o-1||a.col+a.colCount-1<r||a.row+a.rowCount-1<t))return!0;for(i=0;i<u.length;i++)if(!(t<=(s=u[i]).cj&&r<=s.dj&&t+n>=s.cj+s.Xj&&r+o>=s.dj+s.OZ||s.dj>r+o||s.dj+s.OZ-1<r||s.dj>r+o-1||s.dj+s.OZ-1<r||s.cj+s.Xj-1<t))return!0;return!1},sr.prototype.bIb=function(e,t,r,n,o){var i,a,s,l,u,c,h,f=e._modelManager.getSpans(),d=e.tables.l$;for(i=t;i<t+n;i++)for(a=r;a<r+o;a++){if(s=e.getCell(i,a),!O(s.value())||s.backColor()||s.comment()||s.tag())return!0;for(l=0;l<f.length;l++)if(i>=(u=f[l]).row&&i<=u.row+u.rowCount-1&&a>=u.col&&a<=u.col+u.colCount-1)return!0;for(c=0;c<d.length;c++)if(i>=(h=d[c]).cj&&i<=h.cj+h.Xj-1&&a>=h.dj&&a<=h.dj+h.OZ-1)return!0}return!1},sr.prototype.vTa=function(e,t){var r,n,o,i;return!e||(r=e.row,n=e.col,o=t.row,i=t.col,-1!==r&&-1!==n||-1===r&&-1!==n&&o<=0||-1===n&&-1!==r&&i<=0||-1===r&&-1===n&&o<=0&&i<=0)},sr.prototype.undo=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S;if(this.canUndo()){if(e=this.VQ.fromSheet,t=this.VQ.toSheet,n=(r=this.VQ.pasteExtent).sourceRange,o=r.targetRange,!t||!o)return!1;if(this.pgc&&(i=this.pgc,this.ogc(i.changePasteDataRangeCol,n,i.changePasteDataRangeRow,i.changePasteDataRangeCols,i.changePasteDataRangeRows,i.acColCount,i.acRowCount)),!t.pu(o.row,o.col,mt(o),bt(o),pt(t),gt(t)))return!1;if(e&&n){if(!e.pu(n.row,n.col,mt(n),bt(n),pt(e),gt(e)))return!1;if(e&&e.name()===t.name()&&t.parent&&!B(t.parent.sheets,e))return!1}a=this.VQ.io,St(t);try{s=o.row<0?0:o.row,l=o.col<0?0:o.col,u=o.row<0?pt(t):mt(o),c=o.col<0?gt(t):bt(o),h=t.parent.sheets,q._xb(h,this.VQ),(d=(f=t.rowFilter())&&f.range)&&-1===o.row&&d.col<o.col&&d.col+d.colCount>=o.col+o.colCount&&(d.colCount=d.colCount-o.colCount),b=m=g=p=0,e&&n&&(p=n.row<0?0:n.row,g=n.col<0?0:n.col,m=n.row<0?pt(e):mt(n),b=n.col<0?gt(e):bt(n)),y=[],C=[],(w=this.tableNamesObj)&&(t&&w.r===s&&w.c===l&&w.rc===u&&w.cc===c&&(C=w.tableNames),e&&w.r===p&&w.c===g&&w.rc===m&&w.cc===b&&(y=w.tableNames)),t&&(v=a.dA,q.Bu(t,s,l,u,c,v?v.wy():[],3,y,!0)),e&&(S=a._z,q.Bu(e,p,g,m,b,S?S.wy():[],3,C,!0))}finally{xt(t)}}return!0},Xe=sr,dt(ar,ut=Be),ar.prototype.execute=function(){var e,t,r,n,o,i,a,s,l=this.VQ,u=l.MA,c=!1;if(this.canExecute()&&u){zt(t=(e=this.kj).parent.getActiveSheet(),!0);try{for(r=!1,n=0;n<u.length;n++)(o=u[n]).WHb=l.WHb,o.XHb=l.XHb,o.YHb=l.YHb,e?(i=o.VQ.pasteExtent,a={sheet:e,sheetName:e.name(),cellRange:o.VA(),pasteOption:o.VQ.pasteOption,pasteData:{text:i.clipboardText,html:i.clipboardHtml},shiftCells:l.WHb,cancel:!1},(s=i.clipboardImage)&&(a.pasteData.image=s),e.Wq(U.Events.ClipboardPasting,a),a.cancel||(c=o.execute(),delete a.cancel,r=!0,e.Wq(U.Events.ClipboardPasted,a))):c=o.execute();r&&this.WA()}finally{qt(t,!0)}}return c},ar.prototype.WA=function(){var e,t,r,n,o,i=this.VQ,a=i.MA,s=this.kj;if(s&&a){if(e=s.getSelections(),s.Tr(),i.s5)t=i.pastedRanges[0],s.addSelection(t.row,t.col,mt(t),bt(t));else if(1<a.length)for(r=0;r<a.length;r++)n=a[r].VA(),s.addSelection(n.row,n.col,mt(n),bt(n));else 0<a.length&&(o=a[0].VA(),s.addSelection(o.row,o.col,mt(o),bt(o)),o.contains(s.Jl,s.Kl)||s.Jr(o.row,o.col));s.yu(e,s.getSelections())&&s.Au(e)}},ar.prototype.canExecute=function(){var e,t=this.VQ.MA;if(t){for(e=0;e<t.length;e++)if(!t[e].canExecute())return!1;return!0}return!1},ar.prototype.canUndo=function(){var e,t=this.VQ.MA;if(t){for(e=0;e<t.length;e++)if(!t[e].canUndo())return!1;return!0}return!1},ar.prototype.undo=function(){var e,t,r,n,o=this.VQ.MA;if(this.canUndo()&&o){e=!0,zt(t=this.kj.parent.getActiveSheet(),!0);try{for(r=o.length-1;0<=r;r--)n=o[r],e=e&&n.undo()}finally{qt(t,!0)}return e}return!1},Je=ar},"./dist/core/worksheet/worksheet-border.js":function(e,t,r){"use strict";var n,o,_,D,d,p,g,P,L,O,i,w,S,a,c,s,l,h,u,N,f,m,b,y,C,v,x=this&&this.__extends||(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function T(e,t,r,n,o,i){var a=m.call(this)||this,s=a,l=0,u=0;return e===r&&(l=1),t===n&&(u=1),e!==r&&t!==n?i?(l=2,s.AE=new c(e-l,t,r-l,n,o,1,i),s.BE=new c(e+l,t,r+l,n,o,1,i)):(u=l=2,r<e?(s.AE=new h(e-l,t,r,n-u,o,!1,i),s.BE=new h(e,t+u,r+l,n,o,!1,i)):(s.AE=new h(e,t+u,r-l,n,o,!0,i),s.BE=new h(e+l,t,r,n-u,o,!0,i))):(s.AE=new c(e-l,t-u,r-l,n-u,o,1,i),s.BE=new c(e+l,t+u,r+l,n+u,o,1,i)),s.gIb=i,s.tE=o,s.uE=1,a}function A(e,t,r,n,o,i,a){var s=b.call(this)||this,l=s;return l.qE=e,l.sE=t,l.oE=r,l.rE=n,l.tE=o,l.iWa=i,l.gIb=a,l.AE=new c(l.qE,l.sE,l.oE,l.rE,o,1,a),l.BE=null,s}function k(e,t,r,n,o,i,a,s,l){var u,c=y.call(this)||this;return i?(--e,--r):(--t,--n),(u=c).qE=e,u.sE=t,u.oE=r,u.rE=n,u.tE=o,u.xE=i,u.uE=1,u.yE=a,u.zE=s,u.gIb=l,c}function M(e,t,r,n,o,i,a,s){var l,u=C.call(this)||this;return i%2||(e!==r?(t-=.5,n-=.5):(e-=.5,r-=.5)),(l=u).qE=e,l.sE=t,l.oE=r,l.rE=n,l.tE=o,l.uE=i,l.wE=a,l.gIb=s,u}function I(e,t,r,n,o,i,a){var s,l=v.call(this)||this;return i%2||(e!==r?(t-=.5,n-=.5):(e-=.5,r-=.5)),(s=l).qE=e,s.sE=t,s.oE=r,s.rE=n,s.tE=o,s.uE=i,s.gIb=a,l}function E(){}function B(e,t,r,n,o,i,a){switch(i!==_&&i!==D||(i=1),i){case 1:return new c(e,t,r,n,o,1,a);case 2:return new c(e,t,r,n,o,2,a);case 5:return new c(e,t,r,n,o,3,a);case 3:return new s(e,t,r,n,o,1,[3,1],a);case 9:return new s(e,t,r,n,o,1,[8,2,2,2],a);case 4:return new s(e,t,r,n,o,1,[2,2],a);case 11:return new s(e,t,r,n,o,1,[9,3,3,3,3,3],a);case 13:return new l(e,t,r,n,o,e!==r,[11,1,5,1],[10,2,4,2],a);case 10:return new s(e,t,r,n,o,2,[9,3,3,3],a);case 12:return new s(e,t,r,n,o,2,[9,3,3,3,3,3],a);case 8:return new s(e,t,r,n,o,2,[9,3],a);case 7:return new s(e,t,r,n,o,1,[1],a);case 6:return new u(e,t,r,n,o,a)}return D}function R(e,t,r,n){this.UE=!1,this.VE=!1,this.kj=e,this.Wz=n,this.hIb=t,this.pJ=r}function F(){}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/worksheet/style.js"),o=r("./dist/core/util/domUtil.js"),_=void 0,D=null,d=Math.sqrt,p=Math.pow,g=Math.min,P=Math.abs,L=Math.tan,Math.floor,O=Math.PI,o.GC$.inherit,i=o.GC$.isEmptyObject,w={LEFT_TOP:0,RIGHT_TOP:1,RIGHT_BOTTOM:2,LEFT_BOTTOM:3},S={H_TOP_LEFT:0,H_TOP_Right:1,V_RIGHT_TOP:2,V_RIGHT_BOTTOM:3,H_BOTTOM_RIGHT:4,H_BOTTOM_LEFT:5,V_LEFT_BOTTOM:6,V_LEFT_TOP:7},E.prototype.mE=function(e){0===e._orientation?(e.nE&&(this.oE+=e.nE),e.pE&&(this.qE+=e.pE)):(e.nE&&(this.rE+=e.nE),e.pE&&(this.sE+=e.pE))},E.prototype.jp=function(e){var t=this.tE||"#9eb6ce",r=this.uE,n=e.lineWidth,o=e.strokeStyle;n===r&&o===t||(n!==r&&(e.lineWidth=r),o!==t&&(e.strokeStyle=t)),this.hWa(e)},E.prototype.hWa=function(e){var t,r,n=this;n.qE===n.oE||n.sE===n.rE?(e.beginPath(),n.vE(e),e.stroke()):(e.save(),t=Math.min(n.qE,n.oE),r=Math.min(n.sE,n.rE),e.rect(t,r,Math.abs(n.oE-n.qE),Math.abs(n.rE-n.sE)),e.clip(),e.beginPath(),n.vE(e),e.stroke(),e.beginPath(),e.restore())},E.prototype.vE=function(e){e.moveTo(this.qE,this.sE),e.lineTo(this.oE,this.rE)},x(I,v=a=E),c=I,x(M,C=a),M.prototype.vE=function(e){M._render(e,this.qE,this.sE,this.oE,this.rE,this.wE)},M._render=function(e,t,r,n,o,i){var a,s,l=d(p(n-t,2)+p(o-r,2)),u=(n-t)/l,c=(o-r)/l,h=0,f=0;for(i=i&&i.length?i:[4,4];h<l;)h+=a=g(i[f%i.length],l-h),(s=++f%2)&&e.moveTo(t,r),t+=a*u,r+=a*c,s&&e.lineTo(t,r)},s=M,x(k,y=a),k.prototype.vE=function(e){var t=this,r=t.xE?0:1,n=t.xE?1:0;s._render(e,t.qE-r,t.sE-n,t.oE-r,t.rE-n,t.yE),s._render(e,t.qE,t.sE,t.oE,t.rE,t.zE)},l=k,x(A,b=a),A.prototype.hWa=function(e){this.AE&&this.AE.hWa(e),this.BE&&this.BE.hWa(e)},A.prototype.mE=function(e){this.BE?(e.pE&&this.AE&&this.AE.mE(e),e.nE&&this.BE.mE(e)):this.AE&&this.AE.mE(e)},A.prototype.jWa=function(e){var t,r,n,o,i,a,s,l,u=this;e&&e.severX&&e.severY?(t=e.severX||0,r=e.severY||0,t=u.iWa?t:-t,i=(n=parseInt(u.qE+(u.oE-u.qE)/2,10))-t,a=(o=parseInt(u.sE+(u.rE-u.sE)/2,10))-r,s=n+t,l=o+r,u.AE=new c(u.qE,u.sE,i,a,u.tE,1,u.gIb),u.BE=new c(s,l,u.oE,u.rE,u.tE,1,u.gIb)):(u.AE=new c(u.qE,u.sE,u.oE,u.rE,u.tE,1,u.gIb),u.BE=null)},h=A,x(T,m=a),T.prototype.hWa=function(e){this.AE.hWa(e),this.BE.hWa(e)},T.prototype.mE=function(e){e.CE?1===e.CE?this.AE.mE(e):2===e.CE&&this.BE.mE(e):(this.AE.mE(e),this.BE.mE(e))},T.prototype.jWa=function(){var e={severX:1,severY:1},t=this.AE,r=this.BE;t.jWa(e),r.jWa(e)},u=T,t.zF=B,F.DE=function(e,t,r){var n,o;return e?t?0!=(o=(n=F.EE)[e.style]-n[t.style])||r?o:t.level-e.level:1:t?-1:0},F.FE=function(e){if(e){if(e.isGridLine)return 1;if(e.style)return n.LineBorder.Vo(e.style)}return 0},F.GE=function(e){return e&&6===e.style},F.HE=function(e){return e&&13===e.style},F.IE=function(e,t){return e&&(!t||0<=F.DE(e.style,t.style))?e:t},F.JE=function(e,t){e&&e.line&&e.line.mE(t)},F.KE=function(e,t,r){return e===t?0:e?t?e.isGridLine?t.isGridLine?0:-1:t.isGridLine?1:F.DE(e.style,t.style,r):1:-1},F.LE=function(e){return e&&e.style&&6===e.style.style},F.ME=function(e,t,r,n){if(e.style&&6===e.style.style)return!0;var o=0;return o+=t&&t.style&&6===t.style.style?1:0,o+=r&&r.style&&6===r.style.style?1:0,(o+=n&&n.style&&6===n.style.style?1:0)<2},F.NE=function(e,t,r,n,o,i){var a={_orientation:i?1:0,pE:0,nE:0},s=this.KE(e,r),l=this.KE(e,n);0<=s&&0<=l?0===s&&0===l?-1!==o&&1===o&&(a.nE-=o):-1===o?a.pE-=o:1===o&&(a.nE-=2*o):0<=l?(a.CE=2,a.pE+=o):0<=s&&(a.CE=1,a.pE+=o),this.JE(e,a)},F.OE=function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b={_orientation:s?1:0,CE:l?2:1,pE:0,nE:0},y={_orientation:s?1:0,CE:l?1:2,pE:0,nE:0},C=1===i?n:o,w=1===a?r:t;this.LE(w)?0===(u=this.KE(e,C))?0===(c=this.KE(e,w))?1===a&&(y.nE-=a):0<c&&(-1===a?y.pE-=2*a:1===a&&(y.nE-=2*a)):0<u?0===(h=this.KE(e,w))?1===a&&(y.nE-=a):0<h&&(-1===a?y.pE-=2*a:1===a&&(y.nE-=2*a)):0===(f=this.KE(e,w))?-1===a?b.pE+=2*a:1===a&&(b.nE+=2*a):0<f&&(-1===a?b.pE-=3*a:1===a&&(b.nE-=3*a)):0<=this.KE(e,C)?-1===a?y.pE-=2*a:1===a&&(y.nE-=2*a):-1===a?b.pE+=2*a:1===a&&(b.nE+=2*a),d=1==(1===i?2:1)?n:o,p=!1,g=0,this.LE(d)&&0<this.KE(d,e)&&(p=!0,m=F.FE(d),0<this.KE(d,C)?0<m&&(g=1===a&&this.LE(r)?2<=m?2:1:-1===a&&this.LE(t)?3<=m?2:1:3===m?3:2):g=3===m?3:2),p||this.LE(w)||!(w&&!w.isGridLine||d&&!d.isGridLine)||(p=!0,g=-1===a?2:1),p&&(-1===a?(b.pE+=a*g,y.pE+=a*g):1===a&&(b.nE+=a*g,y.nE+=a*g)),(b.pE||b.nE)&&this.JE(e,b),(y.pE||y.nE)&&this.JE(e,y)},F.PE=function(e,t,r,n,o,i){if(0<=this.KE(e,r)&&0<=this.KE(e,n)){var a={_orientation:i?1:0,pE:0,nE:0};-1===o?(a.pE-=2*o,this.LE(e)&&0<this.KE(t,e)&&--a.pE):1===o&&(a.nE-=2*o,this.LE(e)&&0<this.KE(t,e)&&(a.nE+=1)),this.JE(e,a)}},F.QE=function(e,t,r,n,o,i){var a,s,l;this.LE(e)&&(!(a=this.IE(r,n))||a.isGridLine||0<(s=F.FE(a))&&(l={_orientation:i?1:0,pE:0,nE:0},-1===o?l.pE+=s*o:l.nE+=s*o,(l.pE||l.nE)&&this.JE(e,l)))},F.RE=function(e,t,r,n,o,i,a){var s,l,u,c,h=F;(t||r||n)&&(u=h.IE(r,n),h.ME(e,t,r,n)?0<(l=h.KE(u,e,!0))?(s=h.FE(u),h.LE(e)&&(h.LE(r)||h.LE(n)||h.LE(t))||3===s&&h.JE(e,{_orientation:0,pE:1})):u&&l<0?0<(l=h.KE(e,t,!0))?3===(s=h.FE(u))||2===s?h.JE(e,{_orientation:0,pE:-2}):1===s&&h.JE(e,{_orientation:0,pE:-1}):0!==l&&0<h.KE(t,u,!0)&&3===(s=h.FE(u))&&h.JE(e,{_orientation:0,pE:1}):0===l&&(!t||0<h.KE(e,t,!0))&&(3===(s=h.FE(u))||2===s?h.JE(e,{_orientation:0,pE:-2}):1===s&&h.JE(e,{_orientation:0,pE:-1})):h.JE(e,{_orientation:0,pE:1})),(o||i||a)&&(c=h.IE(i,a),h.ME(e,o,i,a)?0<(l=h.KE(c,e,!0))?(s=h.FE(c),h.LE(e)&&(h.LE(i)||h.LE(a)||h.LE(o))||(3===s?h.JE(e,{_orientation:0,nE:-2}):2!==s&&1!==s||h.JE(e,{_orientation:0,nE:-1}))):l<=0&&(0<(l=h.KE(e,o,!0))?3===(s=h.FE(c))&&h.JE(e,{_orientation:0,nE:1}):0!==l&&h.JE(e,{_orientation:0,nE:-1})):h.JE(e,{_orientation:0,nE:-2}))},F.SE=function(e,t,r,n,o,i,a){var s,l,u,c,h=F;(t||r||n)&&(u=h.IE(r,n),l=h.KE(u,e,!0),h.ME(e,t,r,n)?0<l?(s=h.FE(u),h.LE(e)&&(h.LE(r)||h.LE(n)||h.LE(t))||3===s&&h.JE(e,{_orientation:1,pE:1})):l<0?0<(l=h.KE(e,t,!0))?3===(s=h.FE(u))||2===s?h.JE(e,{_orientation:1,pE:-2}):1===s&&h.JE(e,{_orientation:1,pE:-1}):0!==l&&0<h.KE(t,u,!0)&&3===(s=h.FE(u))&&h.JE(e,{_orientation:1,pE:1}):0===l&&0<h.KE(e,t,!0)&&(3===(s=h.FE(u))||2===s?h.JE(e,{_orientation:1,pE:-2}):1===s&&h.JE(e,{_orientation:1,pE:-1})):h.JE(e,{_orientation:1,pE:1})),(o||i||a)&&(c=h.IE(i,a),l=h.KE(e,c,!0),h.ME(e,o,i,a)?l<0?(s=h.FE(c),h.LE(e)&&(h.LE(i)||h.LE(a)||h.LE(o))||(3===s||2===s?h.JE(e,{_orientation:1,nE:-2}):1===s&&h.JE(e,{_orientation:1,nE:-1}))):c!==D&&0<=l&&(0<(l=h.KE(e,o,!0))?3===(s=h.FE(c))&&h.JE(e,{_orientation:1,nE:1}):0!==l&&h.JE(e,{_orientation:1,nE:-1})):h.JE(e,{_orientation:1,nE:-2}))},F.TE=function(e,t,r,n,o,i,a,s){var l,u,c,h,f=F;s?this.SE(e,t,r,n,o,i,a):this.RE(e,t,r,n,o,i,a),l=f.LE(r),u=f.LE(n),c=f.LE(t),l&&u&&c?f.NE(e,t,r,n,-1,s):l&&!u?f.OE(e,t,o,r,n,1,-1,s,!0):!l&&u?f.OE(e,t,o,r,n,2,-1,s,!1):l&&u&&!c?f.PE(e,t,r,n,-1,s):c&&f.QE(e,t,r,n,-1,s),l=f.LE(i),u=f.LE(a),h=f.LE(o),l&&u&&h?f.NE(e,o,i,a,1,s):l&&!u?f.OE(e,t,o,i,a,1,1,s,!0):!l&&u?f.OE(e,t,o,i,a,2,1,s,!1):l&&u&&!h?f.PE(e,o,i,a,1,s):h&&f.QE(e,o,i,a,1,s)},F.EE=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],F.kWa=function(e,t){return!(!e||!t||e.color!==t.color||e.level!==t.level||e.style!==t.style)},N=F,R.prototype.YE=function(){var e,t,r,n,o,i,a,s,l,u,c=this;if(c.ZE=[],c.$E=[],c._E=[],c.aF=[],c.bF=[],c.cF={},c.dF={},c.eF={},c.fF={},c.lWa={},c.mWa={},c.C$a={},e=c.hIb,t=c.pJ,e&&0<e.length&&t&&0<t.length){for(r=c.$E,n=e.length,o=void 0,i=0;i<n;i++)0<(o=e[i]).height&&r.push(o.row);for(r.push(r[r.length-1]+1),a=c._E,s=t.length,l=void 0,u=0;u<s;u++)0<(l=t[u]).width&&a.push(l.col);a.push(a[a.length-1]+1)}c.UE=!0},R.prototype.gF=function(e,t,r,n,o,i,a,s){if(r){var l={cj:e,dj:t,hF:r.startColumn,iF:r.endColumn,Wqa:n,XHa:o,YHa:i,Vo:a,_v:s};this.aF.push(l)}},R.prototype.jF=function(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y,C,w;this.UE||this.YE(),s?this.ZE.push(s):(w=C=y=b=m=g=p=d=f=h=void 0,a&&(h=a.borderLeft,f=a.borderTop,d=a.borderRight,p=a.borderBottom,w=a.backColor,g=a.diagonalDown,m=a.diagonalUp,b=a.textOrientation,y=a.isVerticalText,C=a.textIndent),!w||h||d||f||p||this.bF.push({r:e,c:t,rc:1,cc:1}),this.kF(e,t,r,n,o,i,h,f,d,p,g,m,w,!1,!1,l,u,b,y,C&&0!==C,c))},R.prototype.kF=function(e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w){var v,S,x,T,A,k,M=this,I=!1,E=!1,R=!1,D=!1,N=b!==_&&b&&-90<=b&&b<=90,F=r;N&&(a||s||l||u)&&!y&&!C&&w&&(v=P(b*O/180),S=L(v),x=Math.floor(i/S),-90<b&&b<0&&(F=r-x),0<b&&b<90&&(F=r+x)),c&&!N&&M.lF(e,t,r-1,n-1,r+o,n+i,c,M.lWa),h&&!N&&M.lF(e,t,r+o,n-1,r-1,n+i,h,M.mWa),s&&0<i&&(I=M.lF(e,t,F,n-.5,F+o,n-.5,s,M.eF,N)),a&&0<o&&(E=M.lF(e,t,F-.5,n,r-.5,n+i,a,M.fF,N)),l&&0<o&&(D=M.lF(e,t+1,F+o-.5,n,r+o-.5,n+i,l,M.fF,N)),u&&0<i&&(R=M.lF(e+1,t,r,n+i-.5,r+o,n+i-.5,u,M.eF,N)),T=M.kj,f&&0!==T.ss.Sl(e)&&0!==T.ss._m(t)||(k=!D&&!p,((A=!R&&!d)||k||!I&&!d||!E&&!p)&&M.mF(e,t,r,n,o,i,A,k,g,m)),!I&&!f||N||M.nF(e-1,t,M.cF),(E||f)&&M.nF(e,t-1,M.dF),!f||a||l||s||u||(M.oF(e-1,t-1,M.dF,!1),M.oF(e-1,t-1,M.cF,!0))},R.prototype.lF=function(e,t,r,n,o,i,a,s,l){if(a){var u=this.pF(e,t,s,!0);return u?(l||6!==u.style.style&&(6===a.style||0<N.DE(a,u.style)))&&(u.line=B(r,n,o,i,a.color,a.style,l),u.style=a):((u=this.pF(e,t,s)).line=B(r,n,o,i,a.color,a.style,l),u.style=a),u.line!==D}return!1},R.prototype.mF=function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p,g=this,m=3===g.Wz,b=g.kj.options.gridline;m&&b&&(c=b.color,b.showHorizontalGridline&&(a&&((h=g.pF(e,t,g.cF)).isGridLine=!0,h.line=B(r,n+i-.5,r+o,n+i-.5,c)),l&&((f=g.pF(-1,t,g.cF,!1,!0)).isGridLine=!0,f.line=B(r,n-.5,r+o,n-.5,c))),b.showVerticalGridline&&(s&&((d=g.pF(e,t,g.dF)).isGridLine=!0,d.line=B(r+o-.5,n,r+o-.5,n+i,c)),u&&((p=g.pF(e,-1,g.dF,!1,!0)).isGridLine=!0,p.line=B(r-.5,n,r-.5,n+i,c))))},R.prototype.oF=function(e,t,r,n){var o=this.pF(e,t,r,!0);!o||o.line&&o.line.mE({_orientation:n?0:1,nE:-1})},R.prototype.nF=function(e,t,r){var n;(0<=e&&0<=t||0===e&&-1===t||-1===e&&0===t)&&(!(n=r[e])||n[t]&&delete n[t])},R.prototype.pF=function(e,t,r,n,o){var i,a;if(!o&&(-1===e||-1===t))return D;if(!(i=r[e])){if(n)return D;r[e]=i={}}if(!(a=i[t])){if(n)return D;i[t]=a={}}return a},R.prototype.qF=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M=this,I=M.aF,E=I.length,R=M.fF,D=M.eF,N=M.dF,F=M.cF;for(e=0;e<E;e++)if(r=(t=I[e]).cj,n=t.dj,o=t.hF,i=t.Wqa,a=t.iF,s=t.XHa,l=t.Vo,u=t._v,c=s,h=void 0,f=i.textOrientation,d=i.borderTop,!(p=I[e-1])||p.cj!==r||p.hF!==o||p.iF!==a){for(g=o;g<a;g++)M.pF(r,g+1,R,!0)&&!f?M.nF(r,g+1,R):M.pF(r,g,N,!0)&&M.nF(r,g,N);if(m=M.pF(r,n,D,!0),f&&d&&!m)for(b=u/Math.tan(Math.abs(f*Math.PI/180)),-90<f&&f<0&&(c=s-b),0<f&&f<90&&(c=s+b),h=c+l,y=o;y<a+1;y++)if(w=(C=M.pF(r-1,y,F,!0))&&C.line)for(C.splitLines||(C.splitLines=[],C.splitLines.push(w)),v=0;v<C.splitLines.length;v++)if(x=(S=C.splitLines[v]).qE,T=S.oE,A=S.sE,k=S.rE,x<c&&T<h&&c<T)S.oE=c;else if(c<x&&T<h)M.nF(r-1,y,M.cF);else if(c<x&&h<T&&x<h)S.qE=h;else if(x<c&&h<T){C.splitLines.splice(v,1,B(x,A,c,A,S.color),B(h,k,T,k,S.color));break}}},R.prototype.rF=function(){var e,t,r=this.ZE,n=r.length;if(0<n)for(t=0;t<n;t++)e=r[t],this.sF(e)},R.prototype.D$a=function(){var e,t,r,n,o,i,a,s;if(this.C$a={},0<(t=(e=this.ZE).length))for(n=0;n<t;n++)for(r=e[n],o=0;o<r.rowCount;o++)for(i=o+r.row,this.C$a[i]=this.C$a[i]||{},a=0;a<r.colCount;a++)s=a+r.col,this.C$a[i][s]=r},R.prototype.sF=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b=this,y=e.row,C=e.col,w=e.x,v=e.y,S=e.spanSizeInfo,x=S.styleList[0][0],T=x?x.backColor:D,A=w,k=v,M=null,I=!0,E=null,R=!0;if(1===e.rowCount){for(a=y,l=S.rowSizes[0],i=0;i<e.colCount;i++)c=0===i,f=i===e.colCount-1,s=C+i,u=S.colSizes[i],p=S.styleList[0][i],a===e.row&&s===e.col&&(M=(g=p)&&g.diagonalDown,E=g&&g.diagonalUp),p?(t=p.borderLeft,r=p.borderTop,n=p.borderRight,o=p.borderBottom,I=I&&N.kWa(M,p.diagonalDown),R=R&&N.kWa(E,p.diagonalUp)):t=r=n=o=D,c?b.kF(a,s,A,k,u,l,t,r,D,o,D,D,T,!1,!0):f?b.kF(a,s,A,k,u,l,D,r,n,o,D,D,T,!1,!1):b.kF(a,s,A,k,u,l,D,r,D,o,D,D,T,!1,!0),A+=u;M=I?M:null,E=R?E:null,b.kF(e.row,e.col,e.x,e.y,e.width,e.height,D,D,D,D,M,E,D,!0,!0)}else if(1===e.colCount){for(s=C,u=S.colSizes[0],i=0;i<e.rowCount;i++)h=0===i,d=i===e.rowCount-1,a=y+i,l=S.rowSizes[i],p=S.styleList[i][0],a===e.row&&s===e.col&&(M=(g=p)&&g.diagonalDown,E=g&&g.diagonalUp),p?(t=p.borderLeft,r=p.borderTop,n=p.borderRight,o=p.borderBottom,I=I&&N.kWa(M,p.diagonalDown),R=R&&N.kWa(E,p.diagonalUp)):t=r=n=o=D,h?b.kF(a,s,A,k,u,l,t,r,n,D,D,D,T,!0,!1):d?b.kF(a,s,A,k,u,l,t,D,n,o,D,D,T,!1,!1):b.kF(a,s,A,k,u,l,t,D,n,D,D,D,T,!0,!1),k+=l;M=I?M:null,E=R?E:null,b.kF(e.row,e.col,e.x,e.y,e.width,e.height,D,D,D,D,M,E,D,!0,!0)}else{for(i=0;i<e.rowCount;i++){for(a=y+i,h=0===i,d=i===e.rowCount-1,l=S.rowSizes[i],m=0;m<e.colCount;m++)s=C+m,c=0===m,f=m===e.colCount-1,u=S.colSizes[m],p=S.styleList[i][m],a===e.row&&s===e.col&&(M=(g=p)&&g.diagonalDown,E=g&&g.diagonalUp),p?(t=p.borderLeft,r=p.borderTop,n=p.borderRight,o=p.borderBottom,I=I&&N.kWa(M,p.diagonalDown),R=R&&N.kWa(E,p.diagonalUp)):t=r=n=o=D,h?c?b.kF(a,s,A,k,u,l,t,r,D,D,D,D,T,!0,!0):f?b.kF(a,s,A,k,u,l,D,r,n,D,D,D,T,!0,!1):b.kF(a,s,A,k,u,l,D,r,D,D,D,D,T,!0,!0):d?c?b.kF(a,s,A,k,u,l,t,D,D,o,D,D,T,!1,!0):f?b.kF(a,s,A,k,u,l,D,D,n,o,D,D,T,!1,!1):b.kF(a,s,A,k,u,l,D,D,D,o,D,D,T,!1,!0):c?b.kF(a,s,A,k,u,l,t,D,D,D,D,D,T,!0,!0):f&&b.kF(a,s,A,k,u,l,D,D,n,D,D,D,T,!0,!1),A+=u;A=w,k+=l}M=I?M:null,E=R?E:null,b.kF(e.row,e.col,e.x,e.y,e.width,e.height,D,D,D,D,M,E,D,!0,!0)}!T||t||n||r||o||b.bF.push({r:y,c:C,rc:e.rowCount,cc:e.colCount})},R.prototype.mE=function(){var e=!1,t=!1,r=!1,n=!1;i(this.fF)||(e=!0),i(this.eF)||(t=!0),(e||t)&&(this.tF(),this.tWa()),i(this.lWa)||(r=!0),i(this.mWa)||(n=!0),(r||n)&&this.oWa(),0<this.bF.length&&this.uF()},R.prototype.E$a=function(e,t,r,n,o){var i=this.C$a[e]?this.C$a[e][t]:null;if(i)switch(o){case S.H_TOP_LEFT:return this.vF(e,t,r,n);case S.H_TOP_Right:case S.V_RIGHT_TOP:return this.vF(e,t+i.colCount-1,r,n);case S.V_RIGHT_BOTTOM:case S.H_BOTTOM_RIGHT:return this.vF(e+i.rowCount-1,t+i.colCount-1,r,n);case S.H_BOTTOM_LEFT:case S.V_LEFT_BOTTOM:return this.vF(e+i.rowCount-1,t,r,n);case S.V_LEFT_TOP:return this.vF(e,t,r,n)}return this.vF(e,t,r,n)},R.prototype.oWa=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g=this,m=g.$E,b=g._E,y=m.length,C=b.length,w={},v={};for(e=0;e<y;e++)for(r=m[e],t=0;t<C;t++)n=b[t],f=g.pF(r,n,g.lWa,!1),d=g.pF(r,n,g.mWa,!1),(f||d)&&(N.LE(f)&&N.LE(d)&&(f.line.jWa(),d.line.jWa()),p=[],(o=g.E$a(r,n,!1,w,S.H_TOP_LEFT))&&o.line&&!o.isGridLine&&(p=[1,1,2],g.pWa(p,o,f,!0,1)),(l=g.E$a(r,n,!1,w,S.H_TOP_Right))&&l.line&&!l.isGridLine&&(p=[1,1,2],g.pWa(p,l,d,!0,1)),(i=g.E$a(r,n,!0,v,S.V_LEFT_TOP))&&i.line&&!i.isGridLine&&(p=[1,1,2],g.pWa(p,i,f,!0,0)),(u=g.E$a(r,n,!0,v,S.V_LEFT_BOTTOM))&&u.line&&!u.isGridLine&&(p=[1,1,2],g.pWa(p,u,d,!1,0)),(a=g.E$a(r+1,n,!1,w,S.H_BOTTOM_LEFT))&&a.line&&!a.isGridLine&&(p=[-1,-2,-2],g.pWa(p,a,d,!1,1)),(c=g.E$a(r+1,n,!1,w,S.H_BOTTOM_RIGHT))&&c.line&&!c.isGridLine&&(p=[-1,-2,-2],g.pWa(p,c,f,!1,1)),(s=g.E$a(r,n+1,!0,v,S.V_RIGHT_TOP))&&s.line&&!s.isGridLine&&(p=[-1,-2,-2],g.pWa(p,s,d,!0,0)),(h=g.E$a(r,n+1,!0,v,S.V_RIGHT_BOTTOM))&&h.line&&!h.isGridLine&&(p=[-1,-2,-2],g.pWa(p,h,f,!1,0)))},R.prototype.pWa=function(e,t,r,n,o){var i,a,s=N.LE(t),l=N.HE(t),u=t.line.uE;s&&(u=3),l&&(u=2),i=e[u-1],r&&r.line&&(a={_orientation:o},n?a.pE=i:a.nE=i,r.line.mE(a))},R.prototype.uF=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f=this.bF,d=f.length;for(e=0;e<d;e++){for(i=(o=r=(t=f[e]).r)-1,a=(n=t.c)-1,s=n,1<t.rc&&(o+=t.rc-1),1<t.cc&&(s+=t.cc-1),u=l=!1,c=e+1;c<d&&((h=f[c]).c===s+1&&h.r===r&&(u=!0),h.r===o+1&&h.c===n&&(l=!0),!l||!u)&&!(h.r>r+1&&h.c>n+1);c++);l||this.oF(o,a,this.cF,!0),u||this.oF(i,s,this.dF,!1)}},R.prototype.tF=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y=this,C=y.$E,w=y._E,v=C.length,S=w.length,x={},T={};for(e=0;e<v;e++)for(r=C[e],t=0;t<S;t++){if(n=w[t],g=p=0,m=y.pF(r,n,y.fF,!0)){if(m.line&&m.line.gIb)continue;p++}else m=y.pF(r,n-1,y.dF,!0);(b=y.pF(r,n,y.eF,!0))?g++:b=y.pF(r-1,n,y.cF,!0),(m||b)&&((o=0===e?D:y.vF(C[e-1],n,!0,T))&&o.line&&!o.isGridLine&&(p++,g++),(i=0===t?D:y.vF(r,w[t-1],!1,x))&&i.line&&!i.isGridLine&&(p++,g++),m&&((a=y.vF(r,n,!1,x))&&a.line&&!a.isGridLine&&p++,e!==v-1&&(l=y.vF(C[e+1],n,!0,T))&&l.line&&!l.isGridLine&&p++,0!==t&&e!==v-1&&(u=y.vF(C[e+1],w[t-1],!1,x))&&u.line&&!u.isGridLine&&p++,e!==v-1&&(c=y.vF(C[e+1],n,!1,x))&&c.line&&!c.isGridLine&&p++,0<p&&(N.GE(m.style)?N.TE(m,o,i,a,l,u,c,!0):N.HE(m.style)||N.SE(m,o,i,a,l,u,c))),b&&((s=y.vF(r,n,!0,T))&&s.line&&!s.isGridLine&&g++,t!==S-1&&(h=y.vF(r,w[t+1],!1,x))&&h.line&&!h.isGridLine&&g++,0!==e&&t!==S-1&&(f=y.vF(C[e-1],w[t+1],!0,T))&&f.line&&!f.isGridLine&&g++,t!==S-1&&(d=y.vF(r,w[t+1],!0,T))&&d.line&&!d.isGridLine&&g++,0<g&&(N.GE(b.style)?N.TE(b,i,o,s,h,f,d,!1):N.HE(b.style)||N.RE(b,i,o,s,h,f,d))))}},R.prototype.F$a=function(e,t,r,n){var o=this.C$a[e]?this.C$a[e][t]:null,i=r?this.mWa:this.lWa;return o?e===o.row&&t===o.col&&n===w.LEFT_TOP||e===o.row&&t===o.col+o.colCount-1&&n===w.RIGHT_TOP||e===o.row+o.rowCount-1&&t===o.col+o.colCount-1&&n===w.RIGHT_BOTTOM||e===o.row+o.rowCount-1&&t===o.col&&n===w.LEFT_BOTTOM?this.pF(o.row,o.col,i,!1):void 0:this.pF(e,t,i,!1)},R.prototype.tWa=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g=this,m=g.$E,b=g._E,y=m.length,C=b.length;for(e=0;e<y;e++)for(r=m[e],t=0;t<C;t++)n=b[t],(d=g.pF(r,n,g.fF,!0))&&d.line&&d.line._noNeedAdjust||(d&&d.line&&N.LE(d)&&(o=g.F$a(r,n,!1,w.LEFT_TOP),i=g.F$a(r,n,!0,w.LEFT_BOTTOM),a=N.LE(o),s=N.LE(i),l=g.F$a(r,n-1,!1,w.RIGHT_BOTTOM),u=g.F$a(r,n-1,!0,w.RIGHT_TOP),c=N.LE(l),h=N.LE(u),o&&a&&(f={CE:2,_orientation:1,pE:2},d.line.mE(f)),i&&s&&(f={CE:2,_orientation:1,nE:-2},d.line.mE(f)),l&&c&&(f={CE:1,_orientation:1,nE:-2},d.line.mE(f)),u&&h&&(f={CE:1,_orientation:1,pE:2},d.line.mE(f))),(p=g.pF(r,n,g.eF,!0))&&p.line&&N.LE(p)&&(o=g.F$a(r,n,!1,w.LEFT_TOP),i=g.F$a(r,n,!0,w.RIGHT_TOP),a=N.LE(o),s=N.LE(i),l=g.F$a(r-1,n,!1,w.RIGHT_BOTTOM),u=g.F$a(r-1,n,!0,w.LEFT_BOTTOM),c=N.LE(l),h=N.LE(u),o&&a&&(f={CE:2,_orientation:0,pE:2},p.line.mE(f)),i&&s&&(f={CE:2,_orientation:0,nE:-2},p.line.mE(f)),l&&c&&(f={CE:1,_orientation:0,nE:-2},p.line.mE(f)),u&&h&&(f={CE:1,_orientation:0,pE:2},p.line.mE(f))))},R.prototype.vF=function(e,t,r,n){var o,i=n[e];return(o=(i=i||(n[e]={}))[t])===_&&(o=i[t]=this.wF(e,t,r)),o},R.prototype.wF=function(e,t,r){var n,o;if(e===_||e<0||t===_||t<0)return D;if(n=r?this.fF:this.eF,o=this.pF(e,t,n,!0))return o;if(n=r?this.dF:this.cF,r){if(--t<0)return D}else if(--e<0)return D;return(o=this.pF(e,t,n,!0))||D},R.prototype.paint=function(e){this.UE&&(this.VE||(this.D$a(),this.rF(),this.qF(),this.mE(),this.VE=!0),e.save(),e.beginPath(),this.jp(e),e.closePath(),e.stroke(),e.restore())},R.prototype.jp=function(e){this.xF(e),this.yF(e)},R.prototype.xF=function(e){this._d(e,this.cF),this._d(e,this.dF)},R.prototype.yF=function(e){this._d(e,this.eF),this._d(e,this.fF),this._d(e,this.lWa),this._d(e,this.mWa)},R.prototype._d=function(e,t){var r,n,o,i,a,s;for(r in t)if(t[r])for(n in o=t[r])if(o[n])if(i=o[n].line,(a=o[n].splitLines)&&0<a.length)for(s=0;s<a.length;s++)a[s]&&a[s].jp(e);else i&&i.jp(e)},t.AF=R},"./dist/core/worksheet/worksheet-edit.js":function(e,t,r){"use strict";var n,H,G,o,U,i,W,a,V,z,q,Z,g,Y,m,s,b,l;Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/core.ns.js"),H=r("./dist/core/worksheet/worksheet.js"),G=r("./dist/core/util/common.js"),o=r("./dist/core/util/domUtil.js"),U=o.GC$,i=r("@grapecity/js-sheets-common"),W=r("./dist/core/core.enum.js"),a=r("@grapecity/js-calc"),V=!!a,z=G.Ul.Ml,q=G.Ul.rl(),Z=i.Common.j.Fa,g=i.Common.u,Y=i.Common.CultureManager,m=G.Ul.K_a,s=new i.Common.ResourceManager(n.SR),b=s.getResource.bind(s),l={startEdit:function(e,t){this.EF(this.Ws(),this.Jl,this.Kl,null,null,e,t)},editorStatus:function(){return this._editorStatus||0},isEditing:function(){var e=this._editorStatus;return 1===e||2===e},endEdit:function(e){return this._endEditImp(e)},_endEditImp:function(e,t,r,n){if(!this.isEditing())return!0;this.suspendPaint();try{return this.Yoa(e,t,r,n)}finally{this.resumePaint()}},Yoa:function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y=this,C=y._eventHandler,w=y._editor,v=y.name(),S=y.Jl,x=y.Kl,T=y.getCellType(S,x),A={sheet:y,row:S,col:x,sheetArea:3,klb:w&&w.klb};if(T.isImeAware(A)||C.Qq(),w&&w.parentNode){if(a={sheet:y,sheetName:v,row:S,col:x,editor:w,editingText:i=T.getEditorValue(w,A),cancel:!1},y.Wq(G.Events.EditEnd,a),a.cancel&&!n)return;if(y.Wq(G.Events.EditEnding,a),a.cancel&&!n)return;if(l=(s=y.parent)&&s.CF,document.activeElement===(l&&l._host)&&C.Qq(),0<=S&&0<=x&&(u=w.Ep,c=y.getFormulaInformation&&y.getFormulaInformation(S,x),T.isEditingValueChanged(u,i,A)||1===t||c&&c.isArrayFormula&&1!==t))if(e)T.setEditorValue(w,u,A),T.selectAll(w,A);else if(h=T.DF,Z(h)&&(h=!0),f={cmd:"editCell",sheetName:v,row:S,col:x,newValue:i,autoFormat:h,editingFormatter:w.oja},1===t&&(f.ranges=[y._getActiveSelectedRange()],f.endEditType=t),null===i||e||y.tables&&y.tables.find&&(y.tables.find(S-1,x)||y.tables.find(S,x-1))&&y.tables.fIb(new G.Range(S,x,1,1),null,i,!0),y.wu().execute(f),2===(o=f.applyResult)&&(T.focus(w,A),!n))return!1;if(y.$l=!0,T.XBb(w,A,y.getCellRect(S,x)),T.isImeAware(A))z.msie&&9===parseFloat(z.version)?C.Qq():U(w.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(d=y.zo(),p=w;p;)p.parentNode===d?d.removeChild(p):p=p.parentNode}return y.Ll=!1,g={sheet:y,sheetName:v,row:S,col:x,editingText:i},m=U.extend({},g),y.Wq(G.Events.EditEnded,g),y.Wq(G.Events.FormulatextboxEditEnded,m),!(!0!==r&&m.ignore&&!n)&&(0!==y._editorStatus&&(b=y._editorStatus,y._editorStatus=0,y._raiseEditorStatusChanged(b,0)),y._modelManager.setCellState(S,x,W.CellStatesType.edit,!1,W.SheetArea.viewport),H.Worksheet.ao(y,"endEdit"),y._editor=null,1!==o)},FF:function(e,t,r){var n,o,i,a,s,l,u,c,h=this,f=h.hitTest(t,r);!f||f.cellTypeHitInfo&&(f.cellTypeHitInfo.outlineColumnHitInfo||f.cellTypeHitInfo.cellButtonHitInfo)||(n=f.row,o=f.col,0<=n&&0<=o&&0<=f.rowViewportIndex&&0<=f.colViewportIndex&&!f.resizeInfo&&!f.dragInfo&&n===h.Jl&&o===h.Kl&&(i=h.isEditing(),h.EF(e,n,o),!i&&h.isEditing()&&(a=f.hitTestType,(s=h.getCellType(n,o)).tw&&(l=h.getCellRect(n,o,1===a?-1:void 0,2===a?-1:void 0),u=h.getActualStyle(n,o,a),(c=s.h5(t,r,u,l,{sheet:h,row:n,col:o,sheetArea:a}))&&c.isReservedLocation&&s.tw(h,n,o,3)))))},inputFormulaAndSelectFormulaRange:function(e,t,r,n){var o,i,a,s,l,u=this,c=u.options,h=u.getCellRect(e,t),f=u.getActualStyle(e,t),d=u.getCellType(e,t),p=u._eventHandler;p.zt(),o={sheet:u,row:e,col:t,sheetArea:3},(i=p.GF)&&i.firstChild&&(a=i.firstChild.firstChild),a&&(u._editor=a,s=u.am(),d.isImeAware(o)&&p.JF(),d._activateEditorWrapper(i,f,h,o),u.KF(d,a,e,t,f,void 0,void 0),d._updateEditorWrapper(i,f,h,o),c.allowCellOverflow&&((l=h.clone()).y-=2,l.height+=4,l.x=s.kt,l.width=s.er,u.repaint(l)),H.Worksheet.ao(u,"startEdit",{element:d.getEditingElement()}),u._editorStatus=2,u._formulaTextBox.text(n),u._formulaTextBox.caret(n.length-1),r&&u._formulaTextBox.iIb(3,4),u._formulaTextBox._openFuncHelp(),G.Vl.Zl(u))},EF:function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j;if(U[U.sd]({tc:this.parent}),!(t<0||r<0||(c=(u=this).name(),h=u.options,u.isEditing()||(!(f=u.getCellRect(t,r))||Z(f.width)||Z(f.height)||Z(f.x)||Z(f.y)||f.width<=0||f.height<=0)))){if((d=u._modelManager).setCellState(t,r,W.CellStatesType.edit,!0,W.SheetArea.viewport),p=u.getActualStyle(t,r),h.isProtected&&!1!==p.locked)return void d.setCellState(t,r,W.CellStatesType.edit,!1,W.SheetArea.viewport);if(!(g=u.getCellType(t,r)))return void d.setCellState(t,r,W.CellStatesType.edit,!1,W.SheetArea.viewport);if((m=u._eventHandler).zt(),b={sheet:u,row:t,col:r,sheetArea:3},(y=g.isImeAware(b)?m.GF:g._createCellTypeElement(b))&&y.firstChild&&(C=y.firstChild.firstChild),!C)return void d.setCellState(t,r,W.CellStatesType.edit,!1,W.SheetArea.viewport);if(w=u.getActualStyle(t,r),v=!1,x=Y.culture(),(w.formatter&&G.util.yIc(w.formatter,x)||w._autoFormatter&&w._autoFormatter.formatCached&&G.util.yIc(w._autoFormatter,x))&&(T=l&&l.keyCode,A=l&&l.code,l&&T&&!l.shiftKey&&(96<=T&&T<=105||48<=T&&T<=57)&&(v=!0),(109===T||107===T||l&&(!l.shiftKey&&189===T||l.shiftKey&&187===T))&&(g.probabilityAddPercent=!0),229===T&&!l.shiftKey&&0<A.length-A.replace(/[0-9]/,"").length&&(v=!0),229===T&&!l.shiftKey&&(0<A.length-A.replace("Minus","").length||0<A.length-A.replace("Subtract","").length||0<A.length-A.replace("Add","").length)&&(g.probabilityAddPercentSpec=!0),229===T&&l.shiftKey&&0<A.length-A.replace("Equal","").length&&(g.probabilityAddPercentSpec=!0),k=y.innerText,z.msie&&(k=k.replace("\r\n","")),M=Y.q4(Y.culture()).NumberFormat.numberDecimalSeparator,I=RegExp("^[-]?[0-9]+(\\"+M+"[0-9]+)?$"),!l&&k&&I.test(k)&&(S=!0)),u._editor=C,E={sheet:u,sheetName:c,row:t,col:r,cancel:!1},u.Wq(G.Events.EditStarting,E),E.cancel)return q.ipad&&m.Qq(),void d.setCellState(t,r,W.CellStatesType.edit,!1,W.SheetArea.viewport);u.showCell(u.Jl,u.Kl,3,3),u.jIb=!0,R=u.getValue(t,r),D=V&&u.getFormula(t,r),N=u._editorStatus,u.HF||Z(R)&&Z(D)?u._editorStatus=1:u._editorStatus=2,u._raiseEditorStatusChanged(N,u._editorStatus),F=u.am(),f=u.getCellRect(t,r,n,o),g.isImeAware(b)&&m.JF(),g._activateEditorWrapper(y,p,f,b),u.KF(g,C,t,r,p,a,s,v,S),_=u.zo(),g.isImeAware(b)||_.insertBefore(y,null),delete u.jIb,g._updateEditorWrapper(y,p,f,b),g.isImeAware(b)&&i||g.focus(C,b),h.allowCellOverflow&&((P=f.clone()).y-=2,P.height+=4,P.x=F.kt,P.width=F.er,u.repaint(P)),H.Worksheet.ao(u,"startEdit",{element:g.getEditingElement()}),!v&&i&&g.selectAll(C,b),v&&(L=window.getSelection(),(O=document.createRange()).setStart(C,0),L.removeAllRanges(),L.addRange(O)),S&&(L=window.getSelection(),(B=document.createElement("span")).innerText="%",O=document.createRange(),u.parent.options.enableFormulaTextbox&&u.parent.options.allowUserEditFormula?(C.firstChild.appendChild(B),O.setStart(C.firstChild,1)):(C.appendChild(B),O.setStart(C,1)),L.removeAllRanges(),L.addRange(O)),G.Vl.Zl(u),j={sheet:u,sheetName:c,row:t,col:r},u.Wq(G.Events.EditStarted,j),u.Wq(G.Events.FormulatextboxEditStarted,j)}},KF:function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p=V&&this.getFormula(r,n,3,!0);c={sheet:this,row:r,col:n,sheetArea:3,isImeInput:a},(u=p=p&&"="+p)&&0!==p.length||((p=this.getValue(r,n,3,1))&&p.richText&&(t.klb=!0,p=m(p)),h=this.parent,f=V&&h&&h.options.allowUserEditFormula,"string"==typeof p&&o.quotePrefix||p&&0<p.length&&"="===p[0]&&f?u=p="'"+p:(u=p,p=e.kp(t,o,p,c))),t.Ep=p,Z(i)||(p=i),l&&(p=this.kIb(p)),e.setEditorValue(t,p,c,s),this.parent&&this.parent.options.enableAccessibility&&(d=b(),t.setAttribute("aria-label",d.ARIA_Cell+"("+r+","+n+") "+g.Kb(d.ARIA_HasValue,[p]))),t.LF=u},kIb:function(e){var t,r,n,o,i,a,s,l=Y.q4(Y.culture()).NumberFormat,u=l.negativeSign,c=l.numberDecimalSeparator;if(1<e.split("e").length)return t=e.split("e")[0],r=e.split("e")[1],t+"e+"+(parseInt(r.split("+")[1],10)+2);if(1<e.split(c).length){for(n=!1,e.charAt(0)===u&&(e=e.substr(1,e.length-1),n=!0),o=(e+="00").indexOf(c),a=(i=(e=(e=e.split(c).join("")).substr(0,o+2)+c+e.substr(o+2,e.length-1)).split(c))[0],s=i[1];a&&"0"===a.charAt(0);)a=a.substr(1,a.length-1);for(;s&&"0"===s.charAt(s.length-1);)s=s.substr(0,s.length-2);return n&&a&&(a=u+a),a&&s?a+c+s:!a&&s?(n?u+"0"+c:"0"+c)+s:a&&!s?a:"0"}return e+"00"}},U.extend(H.Worksheet.prototype,l)},"./dist/core/worksheet/worksheet-event.js":function(e,t,r){"use strict";var n,T,d,h,v,A,g,S,p,y,C,m,b,w,o,s,k,i,l,u,c,f,x,M,I,E,R,D,N,F,_,P,L,O,a,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne;function oe(e,t,r){var n,o,i,a,s,l,u,c,h,f,d=!1,p=e.am();return t&&(n=he(t),o=fe(t),(n<0||o<0)&&((i=e.getCellRect(t.row,t.col,n,o))&&0<i.width&&0<i.height&&(a=p.x,s=p.y,(i.x<p.Br+a||i.y<p.Cr+s||i.y>=p.height-p.Bt)&&(l=new A.Rect(i.x-2,i.y-2,i.width+4,i.height+4),u=n<0&&o<0?p.em():n<0?p.gm(o):p.fm(n),l=l.getIntersectRect(u),r.VF(l.x,l.y,l.width,l.height),c=e,f=3,he(h=t)<0&&(f=1),fe(h)<0&&(f=2),d=!(3===f||!c.vp(h.row,h.col,f,!0)))))),d}function ie(e){return e.isEditing()}function ae(e){return e.endEdit()}function se(e){return e.frozenRowCount()}function le(e){return e.frozenColumnCount()}function ue(e,t){return e.getRowCount(t)}function ce(e,t){return e.getColumnCount(t)}function he(e){return e.rowViewportIndex}function fe(e){return e.colViewportIndex}function de(e){return e.hitTestType}function pe(e){return e.getActiveRowIndex()}function ge(e){return e.getActiveColumnIndex()}function me(e){return e.keyCode}function be(e){return e.ctrlKey}function ye(e){return e.shiftKey}function Ce(e){return e.altKey}function we(e){return e.metaKey}function ve(e){return e.colCount}function Se(e){return e.rowCount}function xe(e,t,r){return{action:e,index:t,sheetArea:r}}function Te(e,t,r,n,o,i){var a={sheet:e,sheetName:t,sheetArea:o,row:r,col:n};return i&&(a.cancel=!1),a}function Ae(e,t,r,n,o,i){var a=e.kj,s=Te(a,a.name(),a.Jl,a.Kl,D,!0);return a.Wq(A.Events.LeaveCell,s),!(!s||!0!==s.cancel)||(a.Kr(t,r,n,o,i),a.Wq(A.Events.EnterCell,Te(a,a.name(),t,r)),a.Wq(A.Events.FormulatextboxEnterCell,Te(a,a.name(),t,r)),void(e.cs&&e.cs(t,r)))}function ke(e,t,r,n,o,i,a){var s=e.kj,l=t.call(s,i.sheetArea);return(a&&!s.getRowVisible(i.index,i.sheetArea)||!a&&!s.getColumnVisible(i.index,i.sheetArea))&&(i.index=r.call(e,i.index,i.sheetArea)),n.call(l,i.index)||n.call(l,o)}function Me(e,t,r,n,o){var i,a=n?"movingY":"movingX",s=n?"startY":"startX";e[a]=t,e[a]<e[s]&&(e[a]=e[s]),i=n?r.y+r.height:r.x+r.width,e[a]>i&&(e[a]=i),o!==R&&e[a]>e[s]+o&&(e[a]=e[s]+o)}function Ie(e,t){var r=t.row,n=t.rowCount,o=t.col,i=t.colCount,a=e.getColumnCount(),s=e.getRowCount();return a<i+o&&(i=a-o),s<n+r&&(n=s-r),{row:r,col:o,rowCount:n,colCount:i}}function Ee(e,t,r){var n=e.parent.options.rowResizeMode;return r&&0===n&&(n=1),t.action!==Y&&1===n&&!function(e,t){var r,n=e.getViewportBottomRow(e.Er(t));if(-1===n&&(n=e.ir()),t<n)for(r=n;t<r;r--)if(0!==e.getRowHeight(r))return;return 1}(e,t.index)&&!(!e.getRowResizable(t.index,t.sheetArea)||!e.getRowResizable(t.index+1,t.sheetArea))&&function(o){var i,a,e=o._modelManager.getSelections();if(0<e.length)return i=0,a=o.getRowCount(),e.every(function(e){var t,r=Ie(o,e),n=!1;return 1===r.rowCount&&(n=(i+=1)<=1),t=r.row<a,-1!==r.col||n&&t})}(e)}function Re(e,t,r){var n=e.parent.options.columnResizeMode;return r&&0===n&&(n=1),t.action!==J&&1===n&&!function(e,t){var r,n=e.getViewportRightColumn(e.Fr(t));if(-1===n&&(n=e.dr()),t<n)for(r=n;t<r;r--)if(0!==e.getColumnWidth(r))return;return 1}(e,t.index)&&!(!e.getColumnResizable(t.index,t.sheetArea)||!e.getColumnResizable(t.index+1,t.sheetArea))&&function(o){var i,a,e=o._modelManager.getSelections();if(0<e.length)return i=0,a=o.getColumnCount(),e.every(function(e){var t,r=Ie(o,e),n=!1;return 1===r.colCount&&(n=(i+=1)<=1),t=r.col<a,-1!==r.row||n&&t})}(e)}function De(e,t,r){var n,o,i,a=r?e.frozenRowCount():e.frozenColumnCount(),s=r?e.lq:e.qq,l=!1,u=s-1;if(0<a&&a<s)for(n=s-1;a<=n;){if(r?e.getRowVisible(n):e.getColumnVisible(n)){if(o=r?e.getRowHeight(n):e.getColumnWidth(n),n===u&&0===o)break;if(0<o){l=!0;break}}else u--;n--}for(i=l?a:t,i--;0<=i;){if(r?e.getRowVisible(i):e.getColumnVisible(i))return i;i--}return-1}function Ne(e){this.mIb=0;this.WF=0,this.XF=!1,this.Gma=!1,this.gA={},this.kj=e,this.nIb="gcEvent"+e.yn}function Fe(e){this._host=e,this.jI=R,this.kI=R,this.lI=R,this.Fi=R,this.mI=!1,this.nI=!1}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/core.ns.js"),T=r("./dist/core/worksheet/worksheet.js"),d=r("@grapecity/js-sheets-common"),h=r("./dist/core/worksheet/worksheet-model.js"),v=r("./dist/core/util/domUtil.js"),A=r("./dist/core/util/common.js"),g=r("./dist/core/core.enum.js"),S=window,p=document,y=v.GC$.each,C=A.Ul.Ml,m=A.Ul.rl(),b=A.Ul.nl,w=A.Ul.Nl,o=d.Common.u.Kb,s=A.kf,k=d.Common.j.Fa,l="mousedown"+(i={lIb:".handler"}).lIb,u="mouseup"+i.lIb,c="mousemove"+i.lIb,f="mousewheel"+i.lIb,x="DOMMouseScroll"+i.lIb,M="wheel"+i.lIb,I="mouseout"+i.lIb,E="dblclick"+i.lIb,R=null,D=void 0,N=isNaN,F=parseInt,_=Math.max,P=Math.floor,L=Math.min,O=Math.abs,a=Math.ceil,B="position",j="absolute",H="border",G="overflow",U="left",W="height",V="hidden",z="none",q="gcUIElement",Z="corner",Y="sizeHiddenRow",K="sizeRow",X="sizeCol",J="sizeHiddenCol",Q="default",$=m.iphone||m.ipad||m.android,ee=new d.Common.ResourceManager(n.SR),te=ee.getResource.bind(ee),Fe.prototype.tG=function(e){"function"==typeof e&&(this.kI=e)},Fe.prototype.PG=function(e){N(e)||0===e?this.SG():(this.nI=0<e,e=O(e),this.jI!==(this.jI=e)&&this.oI())},Fe.prototype.oI=function(){var e=this;e.$b(),N(e.jI)||(e.lI=S.setInterval(function(){e.pI()},e.jI))},Fe.prototype.pI=function(){var e=this.kI;this.mI=!0,"function"==typeof e&&(this.Fi=e.call(this._host,this.nI))},Fe.prototype.SG=function(){this.$b(),this.jI=R,this.lI=R,this.Fi=R,this.mI=!1},Fe.prototype.$b=function(){var e=this.lI;e&&clearInterval(e)},Fe.prototype.no=function(){this.SG()},re=Fe,Ne.prototype.no=function(){this.YF&&this.YF.no(),this.ZF&&this.ZF.no(),this.$F=R},Ne.prototype._F=function(){return this.YF||(this.YF=new re(this)),this.YF},Ne.prototype.aG=function(){return this.ZF||(this.ZF=new re(this)),this.ZF},Ne.prototype.Vs=function(){return this.kj.Vs()},Ne.prototype.bG=function(){var e=v.GC$(this.kj.Ws()).position();return e=e||{top:0,left:0}},Ne.prototype.AD=function(e){var t,r,n,o,i,a,s,l,u,c=A.Ul.sl(),h=be(e),f=c&&!0===h&&0===e.button;return!(2!==e.button&&!f&&(t=this.kj,this.tC(),C&&C.msie&&e.offsetX!==D&&e.offsetY!==D&&(n=r=0,o=t.Xs,e.target!==o&&(r=(i=A.Ul.Z3(e.target,o)).EB,n=i.FB),o&&(a=e.pageX-(e.offsetX+r),s=e.pageY-(e.offsetY+n),o.canvasOffset={top:s,left:a})),l=t.Vs(),u=this.cG(e,e.pageX-l.left,e.pageY-l.top),ie(t)||u||this.zt(),t.dG=!0))},Ne.prototype.tC=function(){var t=this;t.RB||(v.GC$(p).bind("mousemove.gcSheet."+t.nIb,function(e){t.BD(e)}).bind("mouseup.gcSheet."+t.nIb,function(e){t.CD(e)}),t.RB=!0)},Ne.prototype.uC=function(){this.RB&&(this.RB=!1,v.GC$(p).unbind("mousemove.gcSheet."+this.nIb).unbind("mouseup.gcSheet."+this.nIb))},Ne.prototype.cG=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p=this,g=p.kj,m=g.hitTest(t,r),b=m.row,y=m.col,C=m.dragInfo,w=m.formulaRangeHitInfo,v=m.cellTypeHitInfo,S=m.resizeTableHitInfo,x={hitInfo:m,e:e,r:R};if(T.Worksheet.ao(g,"processMouseDown",x),!x.r&&t>=(n=g.am()).x&&r>=n.y)if(g.yt=m,p.eG=!0,m.tableSelectInfo&&!g._formulaTextBox)this.oIb(m,g);else if(m.resizeInfo){if(!ae(g))return;p.fG(m)}else if(m.dragMergeInfo){if(!ae(g))return;p.Zia&&p.Zia(m)}else if(C&&C.side&&C.side!==Z){if(!ae(g))return;p.gG&&p.gG(m),p.lG(e)}else if(C&&C.side===Z){if(!ae(g))return;p.hG&&p.hG(m)}else if(m.filterButtonHitInfo)ae(g);else if(w)w.inBorder?p.iG(m):(w.inTopLeft||w.inTopRight||w.inBottomLeft||w.inBottomRight)&&p.jG(m);else if(S)p.pIb&&p.pIb(m);else if(g.Qs(he(m)<0?-1:b,fe(m)<0?-1:y)){if(m.tableSelectInfo&&g._formulaTextBox&&(o=g._formulaTextBox,i=this.qgc(m,g),m.tableSelectInfo.tableSelection=i,o.rgc(i)),p.kG&&p.kG(g,m))return;if(a=pe(g),s=ge(g),v){if(l=g.getCellType(v.row,v.col,de(m)),v.sheet||(v.sheet=g),p.Sia(l,v)&&(u=v.sheetArea,(k(u)||3===u)&&(b!==a||y!==s))){g.suspendPaint();try{if(!ae(g))return;if(c=Te(g,g.name(),a,s,D,!0),g.Wq(A.Events.LeaveCell,c),c&&!0===c.cancel)return;h=g._modelManager.getSelections(),f=g._modelManager.getSpan(b,y),d=[new A.Range(f.row,f.col,f.rowCount,f.colCount)],g.Wq(A.Events.FloatingElementSelected,{type:"worksheet"}),g.yu(h,d),g.Sr(b,y,D,D,1),g.Wq(A.Events.EnterCell,Te(g,g.name(),b,y)),g.Wq(A.Events.FormulatextboxEnterCell,Te(g,g.name(),b,y)),g.Au(h),g.Uja=!0,p.cs&&p.cs(b,y)}finally{g.resumePaint()}}l.processCellAndPaddingMouseDown(v)}if(v&&v.isReservedLocation)return!0;p.lG(e),p.Ala(g,m,b,y)}},Ne.prototype.Ala=function(e,t,r,n){var o,i;try{if(this.mG=t,ie(e)&&!ae(e))return}finally{this.mG=R}k(r)||k(n)||(3===de(t)&&this.cs&&this.cs(r,n),e.Wq(A.Events.FloatingElementSelected,{type:"worksheet"}),o=e._modelManager.getSelections(),this.nG(t,o),i=e._modelManager.getSelections(),e.yu(o,i))},Ne.prototype.Sia=function(e,t){return e&&t&&t.isReservedLocation&&(!e.activeOnClick||e.activeOnClick())},Ne.prototype.oG=function(e){var t,r=this.kj;return!r||(t=r.am(),k(e.x)||k(e.y)||k(e.width)||k(e.height)||e.x+e.width>t.pt+t.er+t.js||e.y+e.height>t.qt+t.jr+t.gs)},Ne.prototype.pG=function(e,t,r,n,o){var i,a,s,l,u,c,h,f=this.kj;for(a=0,l=(s=e.options).length;a<l;a++)if(s[a].selected){i=n[a].value;break}u=!1,!f.options.isProtected||(c=f.getActualStyle(t,r))&&(u=c.locked),i===D||u||(h={cmd:"editCell",sheetName:f.name(),row:t,col:r,newValue:i,autoFormat:!0,ignoreFormatting:o},f.wu().execute(h)),v.GC$(e).hide()},Ne.prototype.qG=function(){var e;this.rG&&(3!==(e=this.rG.sG)&&2!==e||this.aG().tG(this.uG),3!==e&&1!==e||this._F().tG(this.vG))},Ne.prototype.wG=function(){var e=this;e.xG&&e.yG(),e.$ia&&e._ia&&e._ia(),e.zG&&e.AG&&e.AG(),e.BG&&e.CG&&e.CG(),e.DG&&e.EG(),e.FG&&e.GG(),e.HG&&e.IG(),e.qIb&&e.rIb&&e.rIb()},Ne.prototype.uG=function(e){var t,r,n,o,i,a,s,l;this.JG()||(t=this.rG,r=this.kj,n=t.KG,o=r.getViewportTopRow(n),i=r.getViewportBottomRow(n),e?i<ue(r)-r.frozenTrailingRowCount()-1?r.mq(r._q(o)):(a=r.Gr(n))&&0<a.length&&(s=r.am(),(l=a[a.length-1]).y+l.height>=s.qt+s.jr&&r.mq(r._q(o))):o>se(r)&&r.mq(r.gr(o))),this.wG()},Ne.prototype.vG=function(e){var t,r,n,o,i,a,s;this.LG()||(t=this.kj,r=this.rG.MG,n=t.getViewportLeftColumn(r),o=t.getViewportRightColumn(r),e?o<ce(t)-t.frozenTrailingColumnCount()-1?t.rq(t.Zq(n)):(i=t.Hr(r))&&0<i.length&&(a=t.am(),(s=i[i.length-1]).x+s.width>=a.pt+a.er&&t.rq(t.Zq(n))):n>le(t)&&t.rq(t.br(n))),this.wG()},Ne.prototype.JG=function(){var e,t,r,n,o,i,a=this.kj,s=a.am(),l=se(a),u=a.frozenTrailingRowCount(),c=this.$F,h=this.rG,f=h.KG;if(0===f){if(c.y>s.qt)return a.mq(a._t()),h.KG=1,!0}else if(1===f){if((e=a.Gr(1))&&0<e.length){if(t=e[0],0<l&&c.y<s.qt&&t.row<=a._t())return!(h.KG=0);if(t=e[e.length-1],0<u&&c.y>s.ot&&t.row>=a.ir()&&t.y+t.height<=s.ot)return h.KG=2,!0}}else if(2===f&&(e=a.Gr(1))&&0<e.length&&c.y<s.ot){if((t=e[e.length-1]).y+t.height>s.ot){for(r=s.jr,o=0,i=n=ue(a)-u-1;l<=i;i--)if(r<(o+=a.Sl(i))){n=L(i+1,n);break}a.mq(a._q(n-1))}return h.KG=1,!0}return!1},Ne.prototype.LG=function(){var e,t,r,n,o,i,a=this.kj,s=a.frozenTrailingColumnCount(),l=le(a),u=a.am(),c=this.$F,h=this.rG,f=h.MG;if(0===f){if(c.x>u.pt)return a.rq(a.$t()),h.MG=1,!0}else if(1===f){if((e=a.Hr(1))&&0<e.length){if(t=e[0],0<l&&c.x<u.pt&&t.col<=a.$t())return!(h.MG=0);if(t=e[e.length-1],0<s&&c.x>u.lt&&t.col>=a.dr()&&t.x+t.width<=u.lt)return h.MG=2,!0}}else if(2===f&&(e=a.Hr(1))&&0<e.length&&c.x<u.lt){if((t=e[e.length-1]).x+t.width>u.lt){for(r=u.er,o=0,i=n=ce(a)-s-1;l<=i;i--)if(r<(o+=a.Tl(i))){n=L(i+1,n);break}a.rq(a.Zq(n-1))}return h.MG=1,!0}return!1},Ne.prototype.NG=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p=this;(p._isWorking||p.O3||p.lV)&&(t=(e=p.kj).am(),n=(r=p.rG).KG,o=r.MG,i=p.$F,a=R,0<=n&&0<=o?(a=t.Ft(n,o),0===n&&e.lq===e.frozenRowCount()&&(s=t.Ft(1,o),a.height+=s.height),0===o&&e.qq===e.frozenColumnCount()&&(s=t.Ft(n,1),a.width+=s.width)):0<=n?a=t.fm(n):0<=o&&(a=t.gm(o)),a&&(u=(l=e.parent)&&l.options.scrollbarAppearance===g.ScrollbarAppearance.mobile,h=c=0,d=f=!1,i.x<=a.x?(c=i.x-a.x,u&&(d=!0)):i.x>=a.x+a.width?(0==(c=i.x-(a.x+a.width))&&(c=50),u&&(d=!0)):u&&i.x===a.x+a.width-1&&(c=50,d=!0),i.y<=a.y?(h=i.y-a.y,u&&(f=!0)):i.y>=a.y+a.height&&(h=i.y-(a.y+a.height),u&&(f=!0)),l&&u&&(f&&(l.St.Jwa(g.ScrollbarState.show),l.ku.Rdc(!0)),d&&(l.Pt.Jwa(g.ScrollbarState.show),l.ku.Rdc(!1))),p._F().PG(p.QG(c)),p.aG().PG(p.QG(h))))},Ne.prototype.RG=function(){this._F().SG(),this.aG().SG()},Ne.prototype.fG=function(e){var t,r,n,o,i,a,s=this,l=h.yp.prototype,u=s.kj,c=e.resizeInfo;c.action===K||c.action===Y?(t=ke(s,u.Jt,s.TG,l.findRow,e.row,c,!0),c.startY=t.y):(r=ke(s,u.Kt,s.UG,l.findCol,e.col,c,!1),c.startX=r.x),n=u.parent,o=e.x,i=e.y,n&&((1!==(a=n.options.showResizeTip)||c.action!==X&&c.action!==J)&&(2!==a||c.action!==K&&c.action!==Y)&&3!==a||(i-30<0?i+=15:i-=30,n.uw(s.VG(),o,i))),s.isResizing=!0,s._isWorking=!0,s.ctrl&&(s.fCb=!0)},Ne.prototype.WG=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C=this.kj,w=C.yt,v=w.resizeInfo,S=this.$F,x=S.x,T=S.y,A=C.am(),k=C.parent,M=v.sheetArea;v&&this._isWorking&&this.isResizing&&(w.x===x&&w.y===T||(v.action===K||v.action===Y?(h=C,f=v,d=M,p=T,g=this.fCb,b=f.index,y=h.am(),Ee(h,f,g)?(m=h._q(b,d),Me(f,p,y,!0,h.Sl(b,d)+h.Sl(m,d))):Me(f,p,y,!0)):(n=C,o=v,i=M,a=x,s=this.fCb,u=o.index,c=n.am(),Re(n,o,s)?(l=n.Zq(u,i),Me(o,a,c,!1,n.Tl(u,i)+n.Tl(l,i))):Me(o,a,c,!1)),t=(e=C._render).bm(),e.Mx(A.x,A.y,A.width,A.height),e.Pw(t),k&&((1!==(r=k.options.showResizeTip)||v.action!==X&&v.action!==J)&&(2!==r||v.action!==K&&v.action!==Y)&&3!==r||k.ww(this.XG(v)))))},Ne.prototype.YG=function(){var e,n,t,o,r,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=this;w.isResizing=!1,e=!(w._isWorking=!1),t=(n=w.kj).yt,(o=t.resizeInfo)&&(w.xw(),o.action===K||o.action===Y?k(o.movingY)?e=!1:(r=_(0,(o.movingY-o.startY)/n.zoom()),i=[],a="resizeRow",n.tp(o.index)?v.GC$.each(n._modelManager.getSelections(),function(e,t){if(-1===t.col)if(1===o.sheetArea)i.push({firstRow:o.index,lastRow:o.index});else{var r=n.Tq(t);i.push({firstRow:r.row,lastRow:r.row+Se(r)-1})}}):i.push({firstRow:o.index,lastRow:o.index}),m=n,b=o,y=i,C=w.fCb,Ee(m,b,C)&&1===y.length&&y[0].firstRow===y[0].lastRow&&(a="splitResizeRow"),s=1===o.sheetArea,n.wu().execute({cmd:a,sheetName:n.name(),rows:i,size:r,columnHeader:s})):k(o.movingX)?e=!1:(r=_(0,(o.movingX-o.startX)/n.zoom()),l=[],u="resizeColumn",n.sp(o.index)?v.GC$.each(n._modelManager.getSelections(),function(e,t){if(-1===t.row){var r=n.Tq(t);2===o.sheetArea?l.push({firstCol:o.index,lastCol:o.index}):l.push({firstCol:r.col,lastCol:r.col+ve(r)-1})}}):l.push({firstCol:o.index,lastCol:o.index}),f=n,d=o,p=l,g=w.fCb,Re(f,d,g)&&1===p.length&&p[0].firstColumn===p[0].lastColumn&&(u="splitResizeColumn"),c=2===o.sheetArea,n.wu().execute({cmd:u,sheetName:n.name(),columns:l,size:r,rowHeader:c})),(h=n.hitTest(w.$F.x,w.$F.y))&&w.Tw(h),e||n.repaint(),w.fCb=!1)},Ne.prototype.ZG=function(e,t){var r,n,o,i,a,s,l=0,u=0,c=0,h=0,f=this,d=f.kj,p=d.wq,g=se(d),m=le(d),b=de(e);if(f.o4=f.$G=d._modelManager.getSelections(),d.isCtrlPressed(b)||f.shift||d.Tr(),0===b){if(!f.shift&&Ae(f,r=g?d.ar():d.lq,m?d.$q():d.qq,1,1,t))return;d.isCtrlPressed(b)||d.Tr(),d.Ur(-1,-1,ue(d),ce(d),!0)}else if(1===b){if(!f.shift&&(r=g?d.ar():d.lq,n=f._G(r,e.col,!1),Ae(f,n.row,n.col,1,fe(e),t)))return;f.shift||d.n_a?(l=L(d.Kl,e.col),h=O(d.Kl-e.col)+1,d.Kx(-1,l,ue(d),h,!0)):d.Ur(-1,d.Kl,ue(d),1,!0)}else if(2===b){if(!f.shift){if(i=m?d.$q():d.qq,n=f._G(e.row,i,!0),o=d.Jl!==n.row,Ae(f,n.row,n.col,he(e),1,t))return;o&&p&&p.Lx()}f.shift||d.n_a?(u=L(d.Jl,e.row),c=O(d.Jl-e.row)+1,d.Kx(u,-1,c,ce(d),!0)):d.Ur(d.Jl,-1,1,ce(d),!0)}else if(3===b)if(N(e.row)||N(e.col))ie(d)&&(s=d.getCellRect(d.Jl,d.Kl,d.Nr,d.Pr),d._render.VF(s.x,s.y,s.width,s.height));else{if(!f.shift&&(d.Jl!==e.row||d.Kl!==e.col)){if(o=d.Jl!==e.row,Ae(f,e.row,e.col,he(e),fe(e),t))return;o&&p&&p.Lx()}f.shift?d.aH(e.row,e.col,!0):(a=d._modelManager.getSpan(e.row,e.col),d.n_a||d.Ur(a.row,a.col,Se(a),ve(a),!0))}},Ne.prototype.bH=function(e){!e||3===de(e)&&(N(e.row)||N(e.col))||(this._isWorking=!0,this.xG=!0,this.rG={KG:he(e),MG:fe(e),sG:de(e)},this.qG())},Ne.prototype.ayb=function(e,t){var r=this.kj,n=r.getSpan(e,t),o=e,i=t,a=1,s=1,l=r.selectionUnit(),u=!1;return 1===l?(s=i=-1,o=n?n.row:o,a=n?n.rowCount:a):2===l?(a=o=-1,i=n?n.col:i,s=n?n.colCount:s):u=!0,n&&u?n:new A.Range(o,i,a,s)},Ne.prototype.nG=function(e,t){var r=this.kj,n=e.row,o=e.col;r.n_a=this.I0a(n,o,t,de(e))&&r.parent.options.allowUserDeselect,r.n_a&&(r.s_a=r.Jl,r.t_a=r.Kl,r.p_a=this.ayb(n,o)),this.ZG(e),this.bH(e)},Ne.prototype.I0a=function(e,t,r,n){var o=this.kj;return this.o_a(e,t,r,n)&&2===o.selectionPolicy()},Ne.prototype.o_a=function(e,t,r,n){var o,i,a,s=this.kj,l=s.getRowCount(),u=s.getColumnCount();if(!s.isCtrlPressed(n))return!1;for(o=!1,i=r.length,a=0;a<i;a++)if(3===n){if(r[a].contains(e,t,1,1)){o=!0;break}}else if(2===n){if(r[a].contains(e,-1,1,u)||r[a].contains(e,0,1,u)){o=!0;break}}else if(1===n&&(r[a].contains(-1,t,l,1)||r[a].contains(0,t,l,1))){o=!0;break}return o},Ne.prototype.yG=function(){var e;this.rG&&this._isWorking&&!0!==this.DA&&(3===(e=this.rG.sG)?this.cH():2===e?this.dH():1===e&&this.eH())},Ne.prototype.cH=function(){var e,t,r,n,o=this.kj,i=this.fH(),a=this.gH();if(0<=i&&0<=a&&o.Qs(i,a)){if(this.NG(),1===(e=o._modelManager.getSelections()).length&&(t=o.Jx(i,a,o.Jl,o.Kl),r=e[0],!o.n_a&&t.equals(r)))return;o.aH(i,a,!0),n=o._modelManager.getSelections(),o.yu(e,n)}},Ne.prototype.dH=function(){var e,t,r,n,o,i=this.kj,a=this.fH(!0);if(0<=a&&i.Qs(a,-1)){if(e=L(i.Jl,a),t=_(i.Jl,a)-e+1,r=ce(i),0===i.selectionPolicy())return;2===i.selectionUnit()&&(t=e=-1),n=i._modelManager.getSelections(),i.Kx(e,-1,t,r,!0),o=i._modelManager.getSelections(),i.yu(n,o)}this.NG()},Ne.prototype.eH=function(){var e,t,r,n,o,i=this.kj,a=this.gH(!0);if(0<=a&&i.Qs(-1,a)){if(e=L(i.Kl,a),t=_(i.Kl,a)-e+1,r=ue(i),0===i.selectionPolicy())return;1===i.selectionUnit()&&(t=e=-1),n=i._modelManager.getSelections(),i.Kx(-1,e,r,t,!0),o=i._modelManager.getSelections(),i.yu(n,o)}this.NG()},Ne.prototype.hH=function(){var e,t,r,n,o=this;o.rG=R,o.RG(),o.DA=R,o._isWorking=!1,o.xG=!1,0!==(e=o.kj)._modelManager.getSelections().length&&(e.n_a&&(e.n_a=!1,t=e.p_a,e.p_a=null,e.u_a(e._modelManager.getSelections(),t),delete e.s_a,delete e.t_a),e.Uja?delete e.Uja:((r=!o.$G)||(n=e._modelManager.getSelections(),r=o.zu(o.$G,n)),r&&e.Au(o.o4)),o.$G=e._modelManager.getSelections())},Ne.prototype.iH=function(){var e,t,r,n=this.kj,o=(e=n,t=this.$F.y,r=e.am(),0<se(e)&&t<r.nt+r.fs?0:0<e.frozenTrailingRowCount()&&t>r.ot?2:1),i=this.rG.KG,a=n.Gr(1);return(0===o&&0<i&&0<a.length&&a[0].row>n._t()||2===o&&i<2&&0<a.length&&a[a.length-1].row<n.ir())&&(o=1),o},Ne.prototype.jH=function(){var e,t,r,n=this.kj,o=(e=n,t=this.$F.x,r=e.am(),0<le(e)&&t<r.kt+r.hs?0:0<e.frozenTrailingColumnCount()&&t>r.lt?2:1),i=this.rG.MG,a=n.Hr(1);return(0===o&&0<i&&0<a.length&&a[0].col>n.$t()||2===o&&i<2&&0<a.length&&a[a.length-1].col<n.dr())&&(o=1),o},Ne.prototype.fH=function(e){var t,r,n,o,i,a,s=this.kj,l=this.$F.y,u=this.iH(),c=(o=u,i=l,(a=s.Gr(o))?a.findNearY(i):R);if(c){if(t=s.am(),r=c.row,1===u&&l<t.qt){if((n=s._t())<r)return s._q(r-1)||r;if(r===n&&e)return 0}else if(0===u&&l<t.nt&&e)return 0;return 1===u&&l>t.ot&&r>s.hr()&&s.gr(r)||r}return-1},Ne.prototype.gH=function(e){var t,r,n,o,i,a,s=this.kj,l=this.$F.x,u=this.jH(),c=(o=u,i=l,(a=s.Hr(o))?a.findNearX(i):R);if(c){if(t=s.am(),r=c.col,1===u&&l<t.pt){if((n=s.$t())<r)return s.Zq(r-1)||r;if(r===n&&e)return 0}else if(0===u&&l<t.kt&&e)return 0;return 1===u&&l>t.lt&&r>s.cr()&&s.br(r)||r}return-1},Ne.prototype.QG=function(e){var t,r=0;return N(e)||0===e||(t=e<0,r=a(500/O(e)),200<(r=_(20,10*r))&&(r=200),t&&(r=-r)),r},Ne.prototype.TG=function(e,t){var r=this.kj.gr(e,t);return r!==R?r:e},Ne.prototype.UG=function(e,t){var r=this.kj.br(e,t);return r!==R?r:e},Ne.prototype.kH=function(e,t,r){for(var n=this.kj;t<e;)if(e--,n.getRowVisible(e,r))return e;return e},Ne.prototype.lH=function(e,t,r){for(var n=this.kj;t<e;)if(e--,n.getColumnVisible(e,r))return e;return e},Ne.prototype.mH=function(e,t,r,n,o){var i,a,s,l,u,c,h,f=R;return(h=e).options.isProtected&&!h.options.protectionOptions.allowResizeRows||(!(i=e.Gr(he(t),n))||N(t.row)||N(t.col)||(e.getRowVisible(t.row,n)||(t.row=this.TG(t.row,n)),(a=i.findRow(t.row))&&(a.y+a.height-r<=o&&o<=a.y+a.height+r?(f=xe(K,t.row,n),0<=(s=i[i.length-1].row)&&(l=e.ir(n),f.index===l&&f.index!==s&&a.y+a.height-r/2<=o&&(f=xe(this.nH(e,s,n),s,n)))):a.y-r<=o&&o<=a.y+r&&0<d.Common.k.Cb(i,a)&&(u=this.kH(t.row,0,n),f=xe(this.nH(e,u,n),u,n))),!f&&1===he(t)&&0<i.length&&(a=i[0],_(0,a.y-r)<=o&&o<=a.y+r&&0<=(c=De(e,t.row,!0))&&(f=xe(this.nH(e,c,n),c,n)))),f&&!e.getRowResizable(f.index,n)&&(f=R)),f},Ne.prototype.nH=function(e,t,r){var n=e.parent;return n&&1===n.options.resizeZeroIndicator&&e.getRowVisible(t)&&0===e.Yr(t,r)?Y:K},Ne.prototype.oH=function(e,t,r,n,o){var i,a,s,l,u,c,h,f=R;return(h=e).options.isProtected&&!h.options.protectionOptions.allowResizeColumns||(!(i=e.Hr(fe(t),n))||N(t.col)||N(t.row)||(e.getColumnVisible(t.col,n)||(t.col=this.UG(t.col,n)),(a=i.findCol(t.col))&&(a.x+a.width-r<=o&&o<=a.x+a.width+r?(f=xe(X,t.col,n),0<=(s=i[i.length-1].col)&&(l=e.dr(n),f.index===l&&f.index!==s&&a.x+a.width-r/2<=o&&(f=xe(this.pH(e,s,n),s,n)))):a.x-r<=o&&o<=a.x+r&&0<d.Common.k.Cb(i,a)&&(u=this.lH(t.col,0,n),f=xe(this.pH(e,u,n),u,n))),!f&&1===fe(t)&&0<i.length&&(a=i[0],_(0,a.x-r)<=o&&o<=a.x+r&&0<=(c=De(e,t.col,!1))&&(f=xe(this.pH(e,c,n),c,n)))),f&&!e.getColumnResizable(f.index,n)&&(f=R)),f},Ne.prototype.pH=function(e,t,r){var n=e.parent;return n&&1===n.options.resizeZeroIndicator&&e.getColumnVisible(t)&&0===e.$r(t,r)?J:X},Ne.prototype.ur=function(e,t,r,n){var o,i,a,s,l,u,c,h=this.kj,f=h.parent,d=h.options,p=d.colHeaderVisible,g=d.rowHeaderVisible,m=R;return f&&!f.options.allowUserResize||(a=h.am(),he(e)<0&&0<=fe(e)&&p?m=(m=this.oH(h,e,n,1,t))||this.mH(h,e,n,1,r):0<=he(e)&&fe(e)<0&&g?m=(m=this.mH(h,e,n,2,r))||this.oH(h,e,n,2,t):he(e)<0&&fe(e)<0?h.ir(2)===R&&O(r-a.Cr)<=n?(s=h.Gr(1))&&0<s.length&&0<=(o=s[s.length-1].row)&&h.getRowResizable(o,2)&&(m=xe(this.nH(h,o,2),o,2)):h.dr(1)===R&&O(t-a.Br)<=n&&(l=h.Hr(1))&&0<l.length&&0<=(i=l[l.length-1].col)&&h.getColumnResizable(i,1)&&(m=xe(this.pH(h,i,1),i,1)):0<=he(e)&&0<=fe(e)&&(o=ue(h,1)-1,i=ce(h,2)-1,u=h.options.sheetAreaOffset.top,c=h.options.sheetAreaOffset.left,0<=o&&0===a.Cr&&u<=r&&r<=n+u&&p?m=xe(this.nH(h,o,1),o,1):0<=i&&0===a.Br&&c<=t&&t<=n+c&&g&&(m=xe(this.pH(h,i,2),i,2)))),m},Ne.prototype.qH=function(e,t,r,n){var o,i,a,s,l=this.kj,u=l.am().Ft(1,1);if(1===t)if((o=l.Hr(t))&&0<o.length){if((i=o[o.length-1]).x+i.width<=r&&r<u.x+u.width)return!0}else if(u.contains(r,n))return!0;if(1===e)if((a=l.Gr(e))&&0<a.length){if((s=a[a.length-1]).y+s.height<=n&&n<u.y+u.height)return!0}else if(u.contains(r,n))return!0;return!1},Ne.prototype.BD=function(e){var t=this.Vs();this.sH(e,e.pageX-t.left,e.pageY-t.top)},Ne.prototype.DD=function(){var e,t,r,n,o,i=this.kj,a=i.yt;!a||(e=a.cellTypeHitInfo)&&i.getCellType(e.row,e.col,de(a)).ZBb(e),this._isWorking||(t={x:-1e4,y:-1e4,rowViewportIndex:R,colViewportIndex:R,row:-1,col:-1,resizeInfo:R,hitTestType:R},this.Uw(t),a&&(r=a.row,n=a.col,o=i.getActualStyle(r,n),i.parent&&o&&o.showEllipsis&&i.parent.xw()))},Ne.prototype.sH=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d=this;return d.$F={e:e,x:t,y:r},n=d.kj,d.eG&&!A.Vl.Wl(n)&&A.Vl.Zl(n),d.eG&&d._isWorking?void(d.isResizing?d.WG():d.$ia?d._ia&&d._ia():d.zG?d.AG&&d.AG():d.BG?d.CG&&d.CG():d.DG?d.EG():d.FG?d.GG():d.HG?d.IG():d.qIb?d.rIb&&d.rIb():d.xG&&d.yG()):(o=n.hitTest(t,r),d.sIb(n,o,d),void(o&&(0===d.mIb&&o.tableSelectInfo&&d.eG&&d.tIb(n,d,o),i=n.parent,a=o.row,s=o.col,l=n.sr(o.rowViewportIndex,o.colViewportIndex),i&&(u=n._modelManager.uIb(a,s,l),c=n.getActualStyle(a,s,l),u&&!1!==c.THb&&l?(h=n.getCellRect(a,s,o.rowViewportIndex,o.colViewportIndex),i.uw(u,h.x+h.width+5,h.y+h.height+5)):i.options.showScrollTip&&(i.St.JB||i.Pt.JB)||i.xw()),d.Tw(o),i&&i.options.enableAccessibility&&(f=n.cgc(o),i.dgc(f)),d.Uw(o))))},Ne.prototype.sIb=function(e,t,r){var n,o,i,a,s;1===r.mIb?(n=r.vIb.row,o=r.vIb.col,i=t.col,a=e.getSelections()[0],e.Kx(n,i<o?i:o,a.rowCount,0<o-i?o-i+1:i-o+1,!0)):2===r.mIb&&(n=r.vIb.row,o=r.vIb.col,s=t.row,a=e.getSelections()[0],e.Kx(s<n?s:n,o,0<n-s?n-s+1:s-n+1,a.colCount,!0))},Ne.prototype.tIb=function(e,t,r){var n,o=e.getActiveRowIndex(),i=e.getActiveColumnIndex();t.vIb={row:o,col:i},"tableColSelect"===(n=r.tableSelectInfo.action)?t.mIb=1:"tableRowSelect"===n&&(t.mIb=2)},Ne.prototype.Tw=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b=this.kj,y=b.Ws();y&&(n=!(t=b.yt)||e.row!==t.row||e.col!==t.col||de(e)!==de(t)||e.resizeInfo&&!t.resizeInfo||!e.resizeInfo&&t.resizeInfo||e.resizeInfo&&e.resizeInfo.action!==t.resizeInfo.action||e.dragInfo&&!t.dragInfo||!e.dragInfo&&t.dragInfo||e.dragInfo&&e.dragInfo.action!==t.dragInfo.action||e.resizeTableHitInfo&&!t.resizeTableHitInfo,t&&n&&(o=t.cellTypeHitInfo)&&(r=b.getCellType(o.row,o.col,de(t))).ZBb(o),i=e.resizeInfo,a=e.dragMergeInfo,s=e.dragInfo,l=e.formulaRangeHitInfo,u=e.cellTypeHitInfo,c=b._render,h=e.resizeTableHitInfo,(f=e.tableSelectInfo)?"tableRowSelect"===f.action?y.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAATQAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAACtAAAAkAAAAAsAAAAAAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD5AAAAngAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAPkAAACeAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAAAAAAAAAAAAAAAAAAFAAAArQAAAJAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAUAAABNAAAAEQAAAAAAAAAA4wAAAOEAAAAAAAAAAAAAAAAAAAAAAAAA4QAAAOMAAAA=) 8 4,auto":"tableColSelect"===f.action?y.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAACKAAAAigAAAAgAAAAAAAAAAAAAAAAAAAAHAAAAfAAAAPYAAAD2AAAAewAAAAcAAAAAAAAACAAAAHwAAAD3AAAA/wAAAP8AAAD3AAAAfAAAAAgAAAAVAAAAVwAAAJ8AAAD/AAAA/wAAAJ4AAABXAAAAFQAAAAAAAAAAAAAAYAAAAP8AAAD/AAAAYAAAAAAAAAAAAAAAAAAAAAAAAABgAAAA/wAAAP8AAABgAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAD/AAAA/wAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAXwAAAPwAAAD8AAAAXwAAAAAAAAAAwwAAAIEAAAAAAAAAAAAAAMMAAADDAAAAwwAAAMMAAAA=) 8 4,auto":"tableCornerSelect"===f.action?y.style.cursor="url(data:image/ico;base64,AAABAAEACgoAAAEAIADgAQAAFgAAACgAAAAKAAAAFAAAAAEAIAAAAAAAkAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAACTAAAA/QAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAEwAAAJ8AAAD8AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAoAAAA3AAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAATAAAAngAAAPwAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAASAAAAnwAAAP0AAAD/AAAA+gAAANwAAAD6AAAA/wAAAAAAAAASAAAAnwAAAP0AAAD/AAAA/QAAAJ4AAAAlAAAAnwAAAP0AAAAVAAAAngAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAABQAAACTAAAApwAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAAAAAAAAAAAAACgAAAG0AAADqAAAA/gAAAJ4AAAASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAbQAAAKgAAAAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAOAAAADwAAAA4AAAAMAAAACAAAAAAQAAAAOAAAAHwAAAD8AAAA==) 10 5,auto":"tableSelect"===f.action?y.style.cursor="move":"default"===f.action&&(y.style.cursor=""):i?i.action===X?y.style.cursor=A.CursorResource.ResizeCol:i.action===K?y.style.cursor=A.CursorResource.ResizeRow:i.action===J?y.style.cursor=A.CursorResource.ResizeHiddenCol:i.action===Y?y.style.cursor=A.CursorResource.ResizeHiddenRow:y.style.cursor=Q:a?a.left||a.right?y.style.cursor="w-resize":(a.top||a.bottom)&&(y.style.cursor="n-resize"):s&&"drag"===s.action?s.side===Z?y.style.cursor="crosshair":s.side?y.style.cursor="move":y.style.cursor=Q:l?(l.inBorder?y.style.cursor="move":l.inTopLeft?y.style.cursor="nw-resize":l.inTopRight?y.style.cursor="ne-resize":l.inBottomLeft?y.style.cursor="sw-resize":l.inBottomRight&&(y.style.cursor="se-resize"),d=this.isFormulaRangeHoving,g=(p=this.tH)&&p.paramRange,m=l.paramRange,this.isFormulaRangeHoving=!0,this.tH={paramRange:m},d&&m.index===g.index||c._paintFormulaTextBox()):h?y.style.cursor="se-resize":(u&&(r=b.getCellType(u.row,u.col,de(e)),u.sheet=b,n&&r.processMouseEnter(u),r.YBb(u)),!n&&u&&u.isReservedLocation||(y.style.cursor=Q),this.isFormulaRangeHoving&&(this.isFormulaRangeHoving=!1,this.tH=R,c._paintFormulaTextBox())))},Ne.prototype.CD=function(e){var t=this.kj;return this.uC(),!t.dG||(t.dG=!1,this.vH(e),!1)},Ne.prototype.vH=function(e){var t,r,n,o=this,i=o.kj,a=A.Vl.Xl();o.eG=!1,o.mIb=0,a&&a!==i&&a.endEdit&&(qe&&qe._legacyWynbi&&qe._legacyWynbi.spreadChartEditState&&qe._legacyWynbi.spreadChartEditState.enableReferenceCrossSpread||a._formulaTextBox&&a._formulaTextBox._isSelectMode||(a.endEdit(),a.repaint())),A.Vl.Zl(i),o.isResizing?o.YG():o.$ia?o.aja&&o.aja():o.zG?o.wH&&o.wH():o.BG?o.xH&&o.xH():o.DG?o.yH():o.FG?o.zH():o.HG?o.AH():o.qIb?o.wIb&&o.wIb():i.yt&&(r=(t=i.yt).cellTypeHitInfo,!t.filterButtonHitInfo&&!t.resizeInfo&&0<=t.row&&0<=t.col&&(r&&(n=i.getCellType(r.row,r.col,de(t)),r.sheet||(r.sheet=i),n.XGb(r)),r&&r.isReservedLocation||i.Wq(A.Events.CellClick,Te(i,i.name(),t.row,t.col,de(t))),o.hH(),i.sgc&&i.tgc&&i.tgc())),o.lG(e)},Ne.prototype._startEdit=function(e,t,r){var n,o=this.kj;o.isEditing&&o===A.Vl.Xl()&&(n=o.Ws(),ye(e)||be(e)||o.FF(n,t,r))},Ne.prototype.nm=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d=this.kj;if(d){if(t=pe(d),r=ge(d),n=d.getCellType(t,r),o={isEditing:ie(d),sheet:d,row:t,col:r,sheetArea:3},i={sheet:d,row:t,col:r,sheetArea:3},n&&n.isReservedKey(e,o))return void(ie(d)||n.processKeyDown(e,i));if((a=d._formulaTextBox)&&a.BH(e))return;if((s=d.parent&&d.parent.CF)&&s.BH(e,o))return}if(l=!(ie(d)||be(e)||we(e)||34!==me(e)&&33!==me(e)&&37!==me(e)&&39!==me(e)&&9!==me(e)&&13!==me(e)&&38!==me(e)&&40!==me(e)),d.CH&&(d.CH=!1,d._render.DH()),h=13===(c=me(e)),f=27===c,d.sgc&&d.ugc&&(h||f)?d.ugc(f):u=this.EH(e),l&&u&&A.Vl.Wl(d)){if(this.Uoa=new Date,this.FH)return this.GH<25&&this.GH++,void b(e);this.FH=!0,this.GH=1,this.HH(e,!0)}},Ne.prototype.VG=function(){var e,t,r=this.kj,n=r.yt.resizeInfo;return n.action===K||n.action===Y?(e=r.getRowHeight(n.index),o(te().Tip_Height,[e])):(t=r.getColumnWidth(n.index),o(te().Tip_Width,[t]))},Ne.prototype.XG=function(e){var t=this.kj;return e.action===K||e.action===Y?o(te().Tip_Height,[_(0,P((e.movingY-e.startY)/t.zoom()))]):o(te().Tip_Width,[_(0,P((e.movingX-e.startX)/t.zoom()))])},Ne.prototype.HH=function(e,t){var r=this;if(r.FH){if(100<new Date-r.Uoa)return void r.Ux();t||r.EH(e),r.FH&&(r.WF=S.setTimeout(function(){r.HH(e)},500/r.GH))}},Ne.prototype.IH=function(e,t){var r,n,o,i=this.kj,a=i.Ws();if(a){i.HF=!0;try{r=ie(i),i.EF&&i.EF(a,i.Jl,i.Kl,R,R,!0,R,t,e),!r&&ie(i)&&(!(n=i.getCellType(i.Jl,i.Kl)).tw||32!==me(e)||be(e)||ye(e)||Ce(e)||n.tw(i,i.Jl,i.Kl,3),n.JH&&n.JH(e))}finally{i.HF=!1,(o=i.tu()).UHb&&delete o.UHb}}},Ne.prototype.EH=function(e){var t,r,n,o,i,a,s,l,u,c,h=this.kj;if(this.lG(e),ie(h)||27!==me(e)||Ce(e)||be(e)||ye(e)||!h.KH||(v.GC$(h.KH).remove(),h.KH=R),t=h.tu(),ie(h)||27!==me(e)||Ce(e)||be(e)||ye(e)||!t.UHb||delete t.UHb,ie(h)||34!==me(e)&&33!==me(e)&&35!==me(e)&&36!==me(e)&&38!==me(e)&&40!==me(e)||b(e),ie(h)||37!==me(e)&&39!==me(e)||b(e),ie(h)&&be(e)&&(89===me(e)||90===me(e)))return b(e),!1;if(n=(r=h.wu()).getShortcutKey(me(e),be(e),ye(e),Ce(e),we(e)),o=r.getCommands(n))for(i=0;i<o.length;i++)if(a={sheetName:h.name()},(s=o[i].execute(h.parent,a))||a.vgc)return s.ignoreCancelDefault||b(e),!0;return l={e:e,r:R},T.Worksheet.ao(h,"processKeyDown",l),!!l.r||(this.LH(e)&&((u=h._formulaTextBox)&&u.MH&&u._stopAppending(),ie(h)||(c=S.Yl.Bm(e.target))&&"gcAttachedFormulaTextBox"===c.getAttribute(q)||this.IH(e)),!1)},Ne.prototype.Ux=function(){this.FH=!1,0<this.WF&&(clearTimeout(this.WF),this.WF=0)},Ne.prototype.om=function(e){var t,r,n,o,i,a,s,l;if(this.Ux(),t=this.kj){if(r=pe(t),n=ge(t),o=t.getCellType(r,n),i={isEditing:ie(t),sheet:t,row:r,col:n,sheetArea:3},a={sheet:t,row:r,col:n,sheetArea:3},o&&o.isReservedKey(e,i))return void(ie(t)||o.processKeyUp(e,a));if((s=t._formulaTextBox)&&s.BH(e))return;if((l=t.parent&&t.parent.CF)&&l.BH(e))return}this.lG(e)},Ne.prototype.pm=function(e){this.IH(e,!0)},Ne.prototype.LH=function(e){return!(be(e)||Ce(e)||we(e))&&(65<=me(e)&&me(e)<=90||48<=me(e)&&me(e)<=57||96<=me(e)&&me(e)<=105||186<=me(e)&&me(e)<=192||220<=me(e)&&me(e)<=222||219===me(e)||106<=me(e)&&me(e)<=111||32===me(e)||61===me(e)||173===me(e)||229===me(e)||0===me(e)||8===me(e))},Ne.prototype.lG=function(e){var t,r,n,o,i,a=this,s=a.kj,l=(A.Ul.sl()?we:be)(e);a.ctrl=l&&!ye(e),a.shift=ye(e)&&!l,s.Hx=!1,9===me(e)&&(1<(t=s._modelManager.getSelections().length)?s.Hx=!0:(r=s._getActiveSelectedRange())&&0<t&&(s.Hx=!(s.Jl===r.row&&s.Kl===r.col&&s.Lr>=Se(r)&&s.Mr>=ve(r)))),!0===a.zG&&(n=s._getActiveSelectedRange(),o=a.OH,i=a.PH,-1===n.row||-1===n.col?a.OH=ye(e):a.OH=!1,a.PH=l,o===a.OH&&i===a.PH||s._render.QH&&s._render.QH()),a.RH=l},Ne.prototype.Vx=function(){this.shift=!1,this.ctrl=!1,this.kj.Hx=!1,this.zG=!1,this.OH=!1,this.PH=!1,this.RH=!1},Ne.prototype._updateEditingEditor=function(e){var t,r,n,o,i,a,s,l,u,c,h,f;e&&e.sheet?(t=e.sheet,r=e.editor,n=e.canvasOffset):r=(t=this.kj)._editor,ie(t)&&(o=t.Jl,i=t.Kl,a=t.getCellType(o,i),s=t.am(),l=t.getActualStyle(o,i),u=t.getCellRect(o,i),r&&r.parentNode&&(c=r.parentNode.parentNode,u&&0<u.width&&0<u.height&&u.x>=s.kt&&u.y>=s.nt&&u.x+u.width<=s.lt+s.js&&u.y+u.height<=s.ot+s.gs?(h={sheet:t,row:o,col:i,sheetArea:3,canvasOffset:n},a._updateEditorWrapper(c,l,u,h,!0)):v.GC$(c).css({top:-1e4,left:-1e4})),(f=t._formulaTextBox)&&f._position())},Ne.prototype.TH=function(e,t){var r,n;if(!e)return R;for(r=e.firstChild;r;){if(r.id===t||r.name===t)return r;if(n=this.TH(r,t))return n;r=r.nextSibling}return R},Ne.prototype.zu=function(e,t){var r,n,o,i=!0;if(e.length===t.length)for(r=0;r<e.length;r++){if(n=e[r],o=t[r],n.row!==o.row||n.col!==o.col||Se(n)!==Se(o)||ve(n)!==ve(o)){i=!0;break}i=!1}return i},Ne.prototype.UH=function(e,t,r,n){var o,i,a,s,l,u,c=this,h=c.kj,f={sheet:h,row:t,col:r,sheetArea:3},d=h.zo(),p=e.isImeAware(f),g=$?j:"fixed";return n&&c.VH(),p&&!c.GF&&(i=(o=e._createCellTypeElement(f)).style,c.WH||(c.WH={overflow:"visible",border:z,position:j}),c.WH.overflow=i.overflow,c.WH.border=i.border,c.WH.position=i.position,v.GC$(o).css([B,G,"top",U,"width",W,H],[g,V,"0px","0px","0px","0px",z]),h.KF&&o.firstChild&&(a=o.firstChild.firstChild,h.KF(e,a,t,r,h.getActualStyle(t,r)),s=e.getEditorValue(a,f),C.safari&&(""===s||k(s))&&e.setEditorValue(a," ",f)),d&&d.insertBefore(o,R),c.GF=o),c.XH||(o=w("div"),v.GC$(o).css([B,G,"top",U,"width",W],[g,V,"0px","0px","0px","0px"]),c.XH=o,l=w("textarea"),v.GC$(l).attr(q,"gcSheetFocusInput").attr("tabindex",-1).css([B,G,H,"resize"],[j,V,z,z]),l.value=" ",o.insertBefore(l,R),c.YH=l,u=w("div"),v.GC$(u).css(B,j).css(G,V).attr(q,"gcSheetFocusInput").attr("tabindex",-1),o.insertBefore(u,R),c.ZH=u,d&&d.insertBefore(o,R)),$&&(c.GF&&c.$H(h,c.GF),c.$H(h,c.XH)),p?c.GF:c.YH},Ne.prototype.JF=function(){this.GF&&this.WH&&v.GC$(this.GF).css(G,this.WH.overflow).css(H,this.WH.border).css(B,this.WH.position)},Ne.prototype.VH=function(){this.GF&&(this.GF.parentElement&&this.GF.parentElement.removeChild(this.GF),this.GF.comboBox&&(this.GF.comboBox=R),this.GF=R)},Ne.prototype.zt=function(e){A.Vl.Wl(this.kj)||this._H(!0,!0,e)},Ne.prototype.Cm=function(){var e=this.ZH;e&&e.focus()},Ne.prototype.Qq=function(){this._H(!0,!0)},Ne.prototype.aI=function(){this.bI&&(clearTimeout(this.bI),this.bI=R)},Ne.prototype._H=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d;0===arguments.length&&(e=!0),(n=this).Gma||(n.XF=!1,n.aI(),o=n.kj,i=pe(o),a=ge(o),s=o.getCellType(i,a),n.UH(s,i,a,t),l={sheet:o,row:i,col:a,sheetArea:3},u=s.isImeAware(l)&&n.GF.firstChild?n.GF.firstChild.firstChild:n.YH,c=u,t&&!C.msie&&s.setImeMode(c,o.getActualStyle(i,a).imeMode,l),p.body.focus(),h=function(){t&&C.msie&&s.setImeMode(c,o.getActualStyle(i,a).imeMode,l),function(){try{s.isImeAware(l)?(s.focus(c,l),s.selectAll(c,l)):(u.focus(),u.select())}catch(e){}}()},f=C.metroMode||m.ipad||m.iphone||m.android,!o.CH&&!f||!e&&s.isImeAware(l)?!1===o._enhanceIme||r||h():!ie(o)&&f?t&&(d=n.GF&&n.GF.firstChild&&n.GF.firstChild.firstChild,s.setImeMode(d,o.getActualStyle(i,a).imeMode,l)):n.bI=S.setTimeout(function(){n.aI(),ie(o)||!1===o._enhanceIme||r||h()},200),A.Vl.Wl(o)||A.Vl.Zl(o),n.byb(o)||n.cs&&n.cs(o.Jl,o.Kl))},Ne.prototype.$H=function(e,t){var r,n,o,i,a,s,l,u=pe(e),c=ge(e),h=e.Nr,f=e.Pr,d=e.getCellRect(u,c,h,f),p=e.Vs(),g=this.bG(),m=this.GF,b=0,y=0,C=0,w=0;m&&(o=v.GC$(m),b=parseInt(o.css("top"),10),y=parseInt(o.css(U),10),C=parseInt(o.css(W),10),w=parseInt(o.css("width"),10)),n=this.oG(d)?(r=b,y):(r=d.y+g.top-2,d.x+g.left-2),i=S.pageYOffset-p.top+g.top,a=S.innerHeight+i-C,s=S.pageXOffset-p.left+g.left,l=S.innerWidth+s-w,(N(r)||r<i||a<r)&&(r=i),(N(n)||n<s||l<n)&&(n=s),v.GC$(t).css("top",r).css(U,n)},Ne.prototype.cI=function(e){var t,r,n,o;this.aI(),ie(this.kj)||this.XF&&p.activeElement===this.ZH||(t=this.kj,n=e?(r=e.row,e.col):(r=t.Jl,t.Kl),o=t.getCellType(r,n),this.UH(o,r,n,!1),this.ZH.focus(),this.XF=!0)},Ne.prototype.dI=function(e,t){this.XF&&(this.XF=!1,t||this._H(e))},Ne.prototype.gx=function(e){var t=this.kj.tu();t&&(t.ska(e),t.M4(),this.Gma=!0,e&&t.N4())},Ne.prototype.hx=function(){var e=this.kj.tu();e&&e.ska(""),this.Gma=!1,this._H(!0,!1)},Ne.prototype.MF=function(){var e;this.aI(),(e=this.GF)&&(v.GC$(e).remove(),this.GF=D),(e=this.XH)&&(v.GC$(e).remove(),this.YH=D,this.XH=R,this.ZH=R)},Ne.prototype.uw=function(e,t,r,n){var o=this.kj.parent;o&&o.uw(e,t,r,n)},Ne.prototype.ww=function(e,t,r,n){var o=this.kj.parent;o&&o.ww(e,t,r,n)},Ne.prototype.xw=function(){var e=this.kj.parent;e&&e.xw()},Ne.prototype.Uw=function(e){var t,r,n,o,i,a,s,l,u,c,h;r=(t=this.kj).hCb,n=t.iCb,i=!1,(o=t.yt)||(i=!0),i||e||(i=!0),i=i||e.col!==o.col||e.row!==o.row||fe(e)!==fe(o)||he(e)!==he(o)||de(e)!==de(o)||(u=e.resizeInfo,c=o.resizeInfo,h=!1,u||c?u&&c&&(h=u.action===c.action&&u.index===c.index&&u.sheetArea===c.sheetArea):h=!0,!h),t.yt=e,i&&(o&&!k(o.hitTestType)&&(t._modelManager.setCellState(r,n,g.CellStatesType.hover,!1,o.hitTestType),t.xIb&&t.xIb(g.CellStatesType.hover,r,n,o.hitTestType,o.rowViewportIndex,o.colViewportIndex)),e&&!k(e.hitTestType)&&(t.hCb=e.row,t.iCb=e.col,e.resizeInfo||(t._modelManager.setCellState(e.row,e.col,g.CellStatesType.hover,!0,e.hitTestType),t.xIb&&t.xIb(g.CellStatesType.hover,e.row,e.col,e.hitTestType,e.rowViewportIndex,e.colViewportIndex))),t.fI=!0,s=oe(t,o,a=t._render),l=oe(t,e,a),s=s||l,t.fI=!1,s&&a.im())},Ne.prototype._G=function(e,t,r){var n=this.gI(e,t,r);return this.hI(n)},Ne.prototype.gI=function(e,t,r){var n=this.kj._modelManager.getSpan(e,t),o=Se(n),i=ve(n);return 1===o&&1===i||r&&1===o||!r&&1===i?n:(r?t++:e++,this.gI(e,t,r))},Ne.prototype.hI=function(e){var t,r,n,o=this.kj,i=e.row,a=ue(o);for(t=i;t<a&&!0!==o.getRowVisible(t);t++);for(t<a&&(i=t),r=e.col,n=ce(o),t=r;t<n&&!0!==o.getColumnVisible(t);t++);return t<n&&(r=t),s(i,r,Se(e),ve(e))},Ne.prototype.byb=function(e){var t,r,n=e.floatingObjects&&e.floatingObjects.all(),o=e.shapes&&e.shapes.all();if(!k(n))for(t=0;t<n.length;t++)if(n[t].isSelected())return!0;if(!k(o))for(r=0;r<o.length;r++)if(o[r].isSelected())return!0},ne=Ne,t.iI=ne,T.Worksheet.$n("eventHandler",{beforeSetHost:function(){this._eventHandler=new ne(this)},dispose:function(e){var t,r,n,o,i=this,a=i._eventHandler;a&&(a.uC(),t=a.nIb,v.GC$(i.Ws()).unbind(l+"."+t).unbind(u+"."+t).unbind(c+"."+t).unbind(f+"."+t).unbind(I+"."+t).unbind(E+"."+t),C.mozilla&&(r="onwheel"in document?M:x,v.GC$(i.Ws()).unbind(r+"."+t)),a.no(),a.MF()),(n=i._editor)&&v.GC$(n).remove(),(o=i.NF)&&o.close(),!1!==e.clearCache&&(i.OF=R,i.PF=R,i.QF=R,i.RF=R,i.SF=R,i.TF=R,i._eventHandler=R)},setHost:function(e){var m,b,t,r;e&&(b=(m=this)._eventHandler,m.OF=function(e){var t={e:e,r:R};if(T.Worksheet.ao(m,"preProcessMouseDown",t),!t.r)return b.AD(e)},m.PF=function(e){var t={e:e,r:R};T.Worksheet.ao(m,"preProcessMouseMove",t),t.r||b.RB||b.BD(e)},m.QF=function(e){var t={e:e,r:R};if(T.Worksheet.ao(m,"preProcessMouseUp",t),!t.r&&!m.XD){if(b.RB)return;return b.CD(e)}},m.RF=function(e){var t,r,n,o,i,a,s,l,u,c;if(t={e:e=e||S.event,r:R},T.Worksheet.ao(m,"preProcessMouseWheel",t),!t.r)return n=(r=m.parent)&&r.options.scrollByPixel,o=e.detail?e.detail:e.wheelDelta/-40,i=0,"wheel"===e.type?(o=e.deltaY,i=e.deltaX,n||(O(o)>=O(i)?i=0:o=0)):(a=(new Date).valueOf(),s=e.wheelDeltaY,l=e.wheelDeltaX,n||(O(s)>=O(l)?l=0:s=0),u=!m.nka||200<a-m.nka,(C.safari||C.chrome)&&(c=C.safari?-4:-40,k(s)||(u?(o=(0<=(o=s/c)?1:-1)*P(O(o)),m.oka=0):(o=s/c,m.oka+=o,o=(0<=o?1:-1)*P(O(m.oka)),m.oka-=o)),k(l)||(u?(i=(0<=(i=l/c)?1:-1)*P(O(i)),m.pka=0):(i=l/c,m.pka+=i,i=(0<=i?1:-1)*P(O(m.pka)),m.pka-=i))),m.nka=a),(0!==o||0!==i)&&(!!m.parent.ku.Rw(e,F(o,10)||0,F(i,10)||0)&&void 0)},m.SF=function(e){var t={e:e,r:R};if(T.Worksheet.ao(m,"preProcessMouseOut",t),!t.r)return b.DD(e)},m.TF=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g={e:e,r:R};T.Worksheet.ao(m,"preProcessMouseDbClick",g),g.r||(t=m.yt)&&(r=!1,3===de(t)?(l=b,u=e,c=m.Vs(),h=u.pageX-c.left,f=u.pageY-c.top,d=m.hitTest(h,f),p=d.dragInfo,d.tableSelectInfo||(p&&l.cyb&&"corner"===p.side?l.cyb():l._startEdit(u,h,f))):(n=t,a=b.kj,r=!!(s=n.resizeInfo)&&(s.action===K||s.action===Y?(o=[],a.tp(s.index)?y(a._modelManager.getSelections(),function(e,t){var r,n;if(-1===t.col)for(r=a.Tq(t),n=0;n<Se(r);n++)o.push({row:r.row+n})}):o.push({row:s.index}),a.wu().execute({cmd:"autoFitRow",sheetName:a.name(),rows:o,columnHeader:1===s.sheetArea})):(i=[],a.sp(s.index)?y(a._modelManager.getSelections(),function(e,t){var r,n;if(-1===t.row)for(r=a.Tq(t),n=0;n<ve(r);n++)i.push({col:r.col+n})}):i.push({col:s.index}),a.wu().execute({cmd:"autoFitColumn",sheetName:a.name(),columns:i,rowHeader:2===s.sheetArea})),!0)),r||m.Wq(A.Events.CellDoubleClick,Te(m,m.name(),t.row,t.col,de(t))))},t=b.nIb,e.bind(l+"."+t,function(e){return m.OF(e)}).bind(u+"."+t,function(e){return m.QF(e)}).bind(c+"."+t,function(e){return m.PF(e)}).bind(f+"."+t,function(e){return m.RF(e)}).bind(I+"."+t,function(e){return m.SF(e)}).bind(E+"."+t,function(e){return m.TF(e)}),C.mozilla&&(r="onwheel"in document?M:x,e.bind(r+"."+t,function(e){return m.RF(e)})))}})},"./dist/core/worksheet/worksheet-formatter.js":function(e,t,r){"use strict";var n,o,i,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/util/domUtil.js"),o=r("./dist/core/worksheet/worksheet.js"),i=r("./dist/core/worksheet/style.js"),a=r("./dist/core/util/common.js"),s=r("@grapecity/js-sheets-common"),n.GC$.extend(o.Worksheet.prototype,{getFormatter:function(e,t,r){return this.tq(e,t,"formatter",r)},setFormatter:function(e,t,r,n){var o=this.Iq(e,t,n);(o=o||new i.Style).formatter=r,this.setStyle(e,t,o,n)}}),o.Worksheet.$n("formatter",{settingText:function(e){var t,r=a.util.tl(e.value),n=s.Formatter&&s.Formatter.GeneralFormatter;n&&r&&(t={},(new n).getPreferredDisplayFormatter(e.value,t),"number"==typeof t.value&&(e.value=t.value))}})},"./dist/core/worksheet/worksheet-json.js":function(e,t,r){"use strict";var n,H,G,U,T,W,o,A,V,i,z,q,k,Z,M,I,Y,E,K,X,J;function p(e,t,r,n){var o,i;if(e.dataTable&&(t.dataTable||(t.dataTable={}),o=e.dataTable[r])){if(t.dataTable[r]||(t.dataTable[r]={}),!(i=o[n]))return;t.dataTable[r][n]||(t.dataTable[r][n]={}),i.formula&&(t.dataTable[r][n].formula=i.formula)}}function Q(e,t,r,n){var o,i,a=e._modelManager,s=a._getSheetModel(),l=a._getSheetModel(V.SheetArea.colHeader),u=a.YTa(!0),c=a.YTa(!0,V.SheetArea.colHeader),h=a.zl(),f=a.zl(V.SheetArea.colHeader),d=s.getColumnCount();for(E(t.colHeaderData)&&(t.colHeaderData={}),l.setRowCount(r),o=0;o<r;o++)for(l.setNode(o,-1,s.RTa(o,-1)),c.Kp(o,u.Jp(o)),i=n;i<d;i++)l.setNode(o,i,s.RTa(o,i)),p(t.data,t.colHeaderData,o,i);h.getSpans(T.kf(0,0,r,d)).forEach(function(e){f.add(e)}),e.frozenRowCount(0)}function $(e,t,r,n){var o,i,a=e._modelManager,s=a._getSheetModel(),l=a._getSheetModel(V.SheetArea.rowHeader),u=a.YTa(!1),c=a.YTa(!1,V.SheetArea.rowHeader),h=a.zl(),f=a.zl(V.SheetArea.rowHeader),d=s.getRowCount();for(E(t.rowHeaderData)&&(t.rowHeaderData={}),l.setColumnCount(r),o=0;o<r;o++)for(l.setNode(-1,o,s.RTa(-1,o)),c.Kp(o,u.Jp(o)),i=n;i<d;i++)l.setNode(i,o,s.RTa(i,o)),p(t.data,t.rowHeaderData,i,o);h.getSpans(T.kf(0,0,d,r)).forEach(function(e){f.add(e)}),e.frozenColumnCount(0)}function R(e,t){switch(e){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===t;case"rowCount":return 200===t;case"columnCount":return 20===t;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===t;case"visible":return!0===t}}function ee(e,t){return Z(e)?e:t}function te(e,t,r){Z(r)&&t.call(e,r,!1)}function re(n,o,i,a,s){k&&M(k,function(e,t){var r=t.fromJson;r&&r.call(n,o,i,a,!Z(s)||s)})}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),H=r("./dist/core/worksheet/worksheet.js"),G=r("./dist/core/worksheet/style.js"),U=G.Style.kxb,T=r("./dist/core/util/common.js"),W=r("./dist/core/util/theme.js"),o=r("./dist/core/util/domUtil.js"),A=r("./dist/core/worksheet/stylehelper.js"),V=r("./dist/core/core.enum.js"),i=r("@grapecity/js-calc"),z=!!i,q=n.Common.CultureManager,k=H.Worksheet._features,Z=T.util.Ol,M=o.GC$.each,I=o.GC$.isEmptyObject,Y=n.Common.D,E=n.Common.j.Fa,K=parseInt,X=isNaN,J=void 0,o.GC$.extend(H.Worksheet.prototype,{qI:function(e,t,r,n){var o;e[t]||(e[t]={}),(o=e[t])[r]||(o[r]={}),o[r].value=n},$ec:function(e,t){var r,n,o,i,a=this._modelManager,s=a._getSheetModel(),l=a._getSheetModel(V.SheetArea.colHeader),u=a.YTa(!0),c=a.YTa(!0,V.SheetArea.colHeader),h=a.zl(),f=a.zl(V.SheetArea.colHeader),d=s.getColumnCount();for(r=0;r<e;r++)for(s.setNode(r,-1,l.RTa(r,-1)),u.Kp(r,c.Jp(r)),n=t;n<d;n++)(o=(o=l.RTa(r,n))||{}).style=this.getActualStyle(r,n,V.SheetArea.colHeader),s.setNode(r,n,o),(i=this.getFormula(r,n,V.SheetArea.colHeader))&&this.setFormula(r,n,i,V.SheetArea.viewport);f.getSpans().forEach(function(e){h.add(e)}),this.frozenRowCount(e),a.dWa(H.Worksheet.Vp,d,V.SheetArea.colHeader),a.fWa(!1,V.SheetArea.colHeader),a.eWa(V.SheetArea.colHeader),this.Bj(V.SheetArea.colHeader).clearAll()},Zec:function(e,t){var r,n,o,i,a=this._modelManager,s=a._getSheetModel(),l=a._getSheetModel(V.SheetArea.rowHeader),u=a.YTa(!1),c=a.YTa(!1,V.SheetArea.rowHeader),h=a.zl(),f=a.zl(V.SheetArea.rowHeader),d=s.getRowCount();for(r=0;r<e;r++)for(s.setNode(-1,r,l.RTa(-1,r)),u.Kp(r,c.Jp(r)),n=t;n<d;n++)(o=(o=l.RTa(n,r))||{}).style=this.getActualStyle(n,r,V.SheetArea.rowHeader),s.setNode(n,r,o),(i=this.getFormula(n,r,V.SheetArea.rowHeader))&&this.setFormula(n,r,i,V.SheetArea.viewport);f.getSpans().forEach(function(e){h.add(e)}),this.frozenColumnCount(e),a.dWa(d,H.Worksheet.Tp,V.SheetArea.rowHeader),a.fWa(!1,V.SheetArea.rowHeader),a.eWa(V.SheetArea.rowHeader),this.Bj(V.SheetArea.rowHeader).clearAll()},toJSON:function(r){var e,t,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S=this,x=r&&r.ignoreStyle;for(f in r&&!r.Yec&&(e=S.getRowCount(V.SheetArea.colHeader),t=S.getColumnCount(V.SheetArea.rowHeader),n=r.rowHeadersAsFrozenColumns,i=r.columnHeadersAsFrozenRows&&0<e,(o=n&&0<t)&&S.addColumns(0,t),i&&S.addRows(0,e,i),o&&S.Zec(t,i?e:0),i&&S.$ec(e,o?t:0)),a=S.getRowCount(),s=S.getColumnCount(),l=S.getRowCount(V.SheetArea.colHeader),u=S.getColumnCount(V.SheetArea.rowHeader),c={name:S.name(),isSelected:S.DHb(),rowCount:a,columnCount:s,activeRow:S.Jl,activeCol:S.Kl,zoomFactor:S.zoom(),rowHeaderColCount:u,colHeaderRowCount:l,visible:S.visible()},x||(c.frozenRowCount=S.frozenRowCount(),c.frozenColCount=S.frozenColumnCount(),c.frozenTrailingRowCount=S.frozenTrailingRowCount(),c.frozenTrailingColCount=S.frozenTrailingColumnCount(),c.theme=S.Pm.toJSON()),h=S._modelManager.toJSON(r))c[f]=h[f];for(p in k&&M(k,function(e,t){t.toJson&&t.toJson.call(S,c,r)}),d={},c)Y(c,p)&&(g=c[p],E(g)||R(p,g)||(d[p]=g));if(function(e,t){var r,n,o,i,a,s,l,u,c,h=e._modelManager.ZHb.anchors;for(r in h)if(n=+r,o=h[r],i=t[n],o&&i)for(a in o)s=+a,(l=o[a])&&((u=i[s])&&(c={row:l.row,rowCount:l.rowCount,col:l.col,colCount:l.colCount,isDynamicArray:!0},l.isValid||(c.isInvalid=!0),u.arrayInfo=c))}(S,c.data.dataTable),M(S.options,function(e,t){var r,n,o,i=t;"gridline"===e&&(i={},r=t.color,n=t.showHorizontalGridline,o=t.showVerticalGridline,r&&r!==T.Im.Lm("gc-gridlineColor").borderTopColor&&(i.color=r),!1===n&&(i.showHorizontalGridline=n),!1===o&&(i.showVerticalGridline=o)),"sheetAreaOffset"===e&&(i={},t.left&&(i.left=t.left),t.top&&(i.top=t.top)),"_ps"===e||E(i)||H.Worksheet.Qp[e]===i||"object"==typeof i&&I(i)||(d[e]=i)}),m=[],b=S.Lq){for(y in b)Y(b,y)&&((C=b[y])&&(w=C.toJSON(),v=C.font,I(w)||(v&&(w.font=A.To.Jo(v)),m.push(w))));0<m.length&&(d.namedStyles=m)}return d},fromJSON:function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j;if(r&&(i=r.noSchema,a=r.version),e){l=(s=this)._modelManager,u=n&&n.ignoreStyle,s.T3(),H.Worksheet.ao(s,"preFromJson"),s.suspendPaint(),l.wgc(),l.xgc(),c=q.culture(),q.culture(""),h=ee(e.rowCount,H.Worksheet.Rp),f=ee(e.columnCount,H.Worksheet.Sp);try{if(s.cq(e.name+"",!0),s.DHb(e.isSelected),s.setRowCount(h),s.setColumnCount(f),s.Lq={},d=e.namedStyles)for(p=0;p<d.length;p++)g=d[p],m=new G.Style,U(g,s),m.fromJSON(g,i,s),s.Kq(m);for(y in b=s.options)if(Y(b,y)&&(C=e[y],"protectionOptions"===y?C=C||e.protectionOption:"allowCellOverflow"===y&&(C=Z(e[y])?e[y]:!a||11<=a),Z(C)))if("object"==typeof C)for(w in C)Y(C,w)&&(b[y][w]=C[w]);else"borderWidth"===y?(b.sheetAreaOffset.left=C,b.sheetAreaOffset.top=C):b[y]=C;if(v=ee(e.activeRow,s.Jl),S=ee(e.activeCol,s.Kl),s.Kr(v,S,J,J,!0),u||(te(s,s.frozenRowCount,e.frozenRowCount),te(s,s.frozenColumnCount,e.frozenColCount),te(s,s.frozenTrailingRowCount,e.frozenTrailingRowCount),te(s,s.frozenTrailingColumnCount,e.frozenTrailingColCount)),!u){if(x=e.colStyles)for(T in x)X(T)||s.setStyle(-1,K(T,10),x[T],V.SheetArea.viewport);if(A=e.rowStyles)for(k in A)X(k)||s.setStyle(K(k,10),-1,A[k],V.SheetArea.viewport)}M=ee(e.rowHeaderColCount,H.Worksheet.Tp),I=ee(e.colHeaderRowCount,H.Worksheet.Vp),s.setColumnCount(M,V.SheetArea.rowHeader),s.setRowCount(I,V.SheetArea.colHeader),s.XSa(ee(e._zoomFactor||e.zoomFactor,s.zoom())),te(s,s.visible,e.visible),E=s.uja,R={sheet:s,setValidator:function(e,t,r){E&&E.vja(e,t,r)},ignoreStyle:u},l.fromJSON(e,i,R),s.defaults=l.defaults,E&&E.QV(!0),(D=e.theme)&&!u&&("string"!=typeof(N=D)&&Z(N)&&(F=N.themeColor||N._themeColor,(_=new W.ColorScheme(F.name||F._name)).fromJSON(F,i),N=new W.Theme(N.name||N.Cj,_,N.headingFont||N.Vaa,N.bodyFont||N.Waa)),s.currentTheme(N)),re(s,e,i,n,t),P=n&&n.frozenColumnsAsRowHeaders,O=(L=n&&n.frozenRowsAsColumnHeaders)&&e.frozenRowCount||0,B=P&&e.frozenColCount||0,L&&0<O&&Q(s,e,O,B),P&&0<B&&$(s,e,B,O),z&&(j=s.yj(),0<O&&(j.cDc=O),0<B&&(j.dDc=B)),o||(0<O&&s.deleteRows(0,O),0<B&&s.deleteColumns(0,B)),s.clearPendingChanges()}finally{q.culture(c),l.ygc(),s.resumePaint()}}},egc:function(u,c,e,h,f){var d,t,p,g,m,b,r,n,o,i,a,s,l,y,C,w,v,S,x,T,A,k,M,I;if(e&&(d=e.noSchema,t=e.version),u){g=(p=this)._modelManager,m=h.ignoreStyle,p.T3(),H.Worksheet.ao(p,"preFromJson"),g.wgc(),g.xgc(),b=q.culture(),q.culture(""),ee(u.rowCount,H.Worksheet.Rp),ee(u.columnCount,H.Worksheet.Sp);try{if(p.Lq={},r=u.namedStyles)for(n=0;n<r.length;n++)o=r[n],i=new G.Style,U(o,p),i.fromJSON(o,d,p),p.Kq(i);for(s in a=p.options)if(Y(a,s)&&(l=u[s],"protectionOptions"===s?l=l||u.protectionOption:"allowCellOverflow"===s&&(l=Z(u[s])?u[s]:!t||11<=t),Z(l)))if("object"==typeof l)for(y in l)Y(l,y)&&(a[s][y]=l[y]);else"borderWidth"===s?(a.sheetAreaOffset.left=l,a.sheetAreaOffset.top=l):a[s]=l;if(C=ee(u.activeRow,p.Jl),w=ee(u.activeCol,p.Kl),p.Kr(C,w,J,J,!0),m||(te(p,p.frozenRowCount,u.frozenRowCount),te(p,p.frozenColumnCount,u.frozenColCount),te(p,p.frozenTrailingRowCount,u.frozenTrailingRowCount),te(p,p.frozenTrailingColumnCount,u.frozenTrailingColCount)),!m){if(v=u.colStyles)for(S in v)X(S)||p.setStyle(-1,K(S,10),v[S],V.SheetArea.viewport);if(x=u.rowStyles)for(T in x)X(T)||p.setStyle(K(T,10),-1,x[T],V.SheetArea.viewport)}A=ee(u.rowHeaderColCount,H.Worksheet.Tp),k=ee(u.colHeaderRowCount,H.Worksheet.Vp),p.setColumnCount(A,V.SheetArea.rowHeader),p.setRowCount(k,V.SheetArea.colHeader),p.XSa(ee(u._zoomFactor||u.zoomFactor,p.zoom())),te(p,p.visible,u.visible),M=p.uja,I={sheet:p,setValidator:function(e,t,r){M&&M.vja(e,t,r)},ignoreStyle:m,incrementalLoading:h.incrementalLoading,incrementLoadTask:h.incrementLoadTask},g.fromJSON(u,d,I,function(){var e,t,r,n,o,i,a,s,l;p.defaults=g.defaults,M&&M.QV(!0),(e=u.theme)&&!m&&("string"!=typeof(t=e)&&Z(t)&&(r=t.themeColor||t._themeColor,(n=new W.ColorScheme(r.name||r._name)).fromJSON(r,d),t=new W.Theme(t.name||t.Cj,n,t.headingFont||t.Vaa,t.bodyFont||t.Waa)),p.currentTheme(t)),re(p,u,d,h,c),o=h&&h.frozenColumnsAsRowHeaders,a=(i=h&&h.frozenRowsAsColumnHeaders)&&u.frozenRowCount||0,s=o&&u.frozenColCount||0,i&&0<a&&Q(p,u,a,s),o&&0<s&&$(p,u,s,a),z&&(l=p.yj(),0<a&&(l.cDc=a),0<s&&(l.dDc=s)),f||(0<a&&p.deleteRows(0,a),0<s&&p.deleteColumns(0,s)),p.clearPendingChanges(),q.culture(b),g.ygc(),p.loaded=!0})}finally{}}}})},"./dist/core/worksheet/worksheet-model.js":function(e,t,r){"use strict";var n,b,C,E,T,y,o,M,i,h,R,p,I,a,D,N,F,w,v,_,s,P,c,d,g,S,l,f,L,u,x,O,B,m,A,k,j,H,G,U,W,V,z,q,Z,Y,K=this&&this.__extends||(q=function(e,t){return(q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}q(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),X=this&&this.__rest||function(e,t){var r,n,o={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&(o[r[n]]=e[r[n]]);return o};function J(e,t){return L(e)?t:e}function Q(e,t){return e.hasOwnProperty(t)}function $(e){return e.rowCount}function ee(e){return e.colCount}function te(e,r,t,n){var o=t;Object.defineProperty(e,r,{get:function(){return o},set:function(e){var t=o;n(this,o=e,r,t)}})}function re(t,e){t.cache={},e&&e.forEach(function(e){ne(t,e)})}function ne(e,t){var r,n;if(e.Ef=s(e.Ef,t.row+$(t)-1),e.Ff=s(e.Ff,t.col+ee(t)-1),!e.suspendUpdatingCache)for(r=0;r<t.rowCount;r++)for(n=0;n<t.colCount;n++)e.cache[t.row+r+"_"+(t.col+n)]=t}function oe(e,t){var r,n;if(!e.suspendUpdatingCache)for(r=0;r<t.rowCount;r++)for(n=0;n<t.colCount;n++)e.cache[t.row+r+"_"+(t.col+n)]=F}function ie(e,t,r,n,o,i,a,s){this.column=e,this.startColumn=t,this.endColumn=r,this.valueWidth=n,this.columnWidth=o,this.backgroundWidth=i,this.backgroundLeftWidth=a,this.backgroundRightWidth=s}function ae(){var e=Z.call(this)||this;return e.headingOverflowlayouts=N,e.trailingOverflowLayouts=N,e}function se(){Array.apply(this,arguments)}function le(){te(this,"spans",[],re),this.Ff=-1,this.Ef=-1,this.cache={},this.suspendUpdatingCache=!1}function ue(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}function ce(e,t,r,n,o){var i,a,s=e.length;for(a=0;a<s;a++)if(i=e[a],L(t)||L(r)?L(t)?L(r)?L(n)?i.containsY(o):i.containsX(n):i.col===r:i.row===t:i.contains(t,r))return i;return N}function he(e,t,r){var n=N,o=e.length,i=!L(t);return 0<o&&(n=(n=i?e.findX(t):e.findY(r))||(i&&t<e[0].x||!i&&r<e[0].y?e[0]:e[o-1])),n}function fe(e,t,r,n,o,i,a,s,l){this.rowCount=a,this.colCount=s,this.row=e,this.col=t,this.x=r,this.y=n,this.width=o,this.height=i,this.isAutoMerge=l}function de(){return Y.call(this)||this}function pe(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S=o&&o.incrementLoadTask;if(S&&!S.isTerminated){for(l=S.isBusyFunc,u=a=a||0,c=!1,h=new Date;u<r;){if(f=t[u])for(d=0;d<n;d++)(p=f[d])&&(c=!0,Ce(p,e.RTa(u,d,!0),i,u,d,o));if(u++,l&&l())break;if(30<new Date-h)break}if(c){if(g=o&&o.sheet,0!==a&&g.parent.getActiveSheet()===g)for(m=a;m<u;m++)if(g.as.viewport[1].findRow(m)){g.repaint();break}(b=o&&o.incrementalLoading)&&b.loading&&(b.loadStatus.valuesLoad+=u-a,C=b.loadStatus,w=o.doNotRecalculateAfterLoad,v=C.valuesLoad/C.total,y=w?.4*v+.1:.3*v+.1,b.loading(y))}u<r?o.incrementLoadTask.pushTask(pe,[e,t,r,n,o,i,u,s]):s&&o.incrementLoadTask.pushTask(s,[])}}function ge(e,t,r,n,o,i,a,s){0<=r&&0<=n?(i[r]||(i[r]={}),i[r][n]=o):0<=r&&-1===n&&0<=e&&-1===t?a[r]=o:0<=n&&-1===r&&0<=t&&-1===e&&(s[n]=o)}function me(e,t,r,n,o,i,a){if(0<=r&&0<=n){i[r]||(i[r]={}),i[r].rs="e";var s=i[r];s.originalItem=a,s[n]=o}}function be(){this.infos=[]}function ye(e,t){this.Xj=e,this.OZ=t,this.ad()}function Ce(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m;e&&((a=e.value)!==F&&((a=a)===N||!(a._calcError||a._error&&!L(a._code))||(s=R&&E.CalcError.parse(a._calcError||a._error))!==F&&(a=s=x(s)),t.value=a),l=e.style,u=i&&i.sheet,l===F||i.ignoreStyle||(c=N,typeof l===w?(t.style=l,c=u&&(u.Mq(l,!1)||u.parent&&u.parent.Mq(l,!1))):l&&((c=new b.Style).fromJSON(l,r),c.name=F,t.style=c),c&&c.validator&&i&&i.setValidator&&i.setValidator(n,o,c.validator)),(h=e.visualState)!==F&&(t.visualState=h),(f=e.bindingPath)!==F&&(t.bindingPath=f),(d=e.tag)!==F&&(typeof(p=d.typeName)===w&&(!(g=y.getTypeFromString(p))||(d=new g).fromJSON&&d.fromJSON(e.tag)),t.tag=d),(m=e.hyperlink)!==F&&(t.hyperlink=B(m)))}function we(e,t){for(var r,n,o,i,a,s=t[0],l=e,u=0;u<s.length-1;u++){if(L(l))return;l=(r=s[u])===c?l.Ap:l[r]}l[s[u]]=t[1],n=s[s.length-1],i=s[s.length-2],a=s[1],"size"===n?o=s[0]===d?M.AxisInfoChangeType.setRowHeight:M.AxisInfoChangeType.setColumnWidth:"visible"===n&&(o=s[0]===d?M.AxisInfoChangeType.setRowVisible:M.AxisInfoChangeType.setColumnVisible),L(o)||e.zgc({type:o,index:i,sheetArea:a})}function ve(e,t,r){var n=0<e.WTa?[["selectionModel"],F]:F;e.selectionModel.setProperty(t,r,n),n&&e.zTa.push(n)}function Se(e,t,r,n,o){void 0===o&&(o=!1);var i=e[t];return o?void(i&&delete i[r]):void((i=i||(e[t]={}))[r]=n)}function xe(e,t,r,n){Se(e,t,r,{value:n})}function Te(e,t,r,n,o,i){Se(e,t,r,{value:n,oldValue:o,isAnchorCell:i})}function Ae(e,t,r,n){var o,i=e[t],a=i&&i[r];return a?a.value:(xe(e,t,r,o=n.getValue(t,r)),o)}function ke(e,t){return[e,t].join(",")}function Me(e,t){var r,n=Array(t);for(r=0;r<t;r++)n[r]=e;return n}function Ie(e,t,r){var n=e[t];return n&&n[r]}function Ee(e,t){var r=t.split(",").map(function(e){return+e}),n=r[0],o=r[1],i=e[n];return i&&i[o]}function Re(e,t,r,n){var o=e[t];o&&delete o[r],n&&I(o)&&delete e[t]}function De(e){this.modelManager=e,this.anchors={},this.cells={},this.invalidAnchors={}}function Ne(e,t,r,n,o){var i,a,s,l,u,c,h,f,d=e._getSheetModel(3),p=e.ZHb,g=p.anchors,m=[];for(i in g)if(g.hasOwnProperty(i)&&(a=g[i]))for(s in a)a.hasOwnProperty(s)&&((l=a[s])&&(u=l.row,c=l.col,h=l.rowCount,f=l.colCount,t<=(o?u+h:c+f)&&(l.isValid&&d.yIb(l),(o?u:c)<t&&m.push(l))));m.length&&E.markAnchorCellDirty(m,e.kj.Bj(),p)}function Fe(e){return e?e.filter(function(e){return!e.isAutoMerge}):e}function _e(e,t,r,n,o,i){var a,s,l,u;function c(e,t,r,n){0<a.WTa&&a.zTa.push([["defaults",r],n]),a.kj.$p()}this.LIb=[],(a=this).kj=e,a.sheetModels=[F,new G(n,r),new G(t,o),new G(t,r)],(s=a.rowInfos=[])[0]=s[1]=new U,s[2]=s[3]=new U,(l=a.colInfos=[])[0]=l[2]=new U,l[1]=l[3]=new U,a.spanModels=[F,new k,new k,new k],a.selectionModel=new H,a.ZHb=new V(a),a.name=i||"",a.isSelected=!1,a.zoomFactor=1,te(u=a.defaults={},"rowHeight",20,c),te(u,"colWidth",62,c),te(u,"rowHeaderColWidth",40,c),te(u,"colHeaderRowHeight",20,c),te(u,"_isExcelDefaultColumnWidth",!1,c),a.WTa=0,_e.ao(this,"init"),a.Agc(t,r)}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/core.ns.js"),b=r("./dist/core/worksheet/style.js"),C=r("@grapecity/js-sheets-common"),E=r("@grapecity/js-calc"),T=r("./dist/core/util/common.js"),y=r("./dist/core/util/common.js"),o=r("./dist/core/util/domUtil.js"),M=r("./dist/core/core.enum.js"),i=r("@grapecity/js-calc"),h=r("./dist/core/celltype/celltype.ns.js"),R=!!i,p=o.GC$.each,I=o.GC$.isEmptyObject,a=o.GC$.extend,D=RegExp("^\\d*(\\.\\d+)?\\*$"),N=null,F=void 0,w="string",v=Math.min,_=Math.floor,s=Math.max,P=Math.ceil,c="dirtyNodes",d="rowInfos",g="colInfos",S="default_size",l=C.Common.A,f=C.Common.B,L=C.Common.j.Fa,u=T.util.K_a,x=T.util.n0a,O=T.util.lHb,B=C.Common.j.C4,m=new C.Common.ResourceManager(n.SR),A=m.getResource.bind(m),le.prototype.find=function(e,t){return this.cache[e+"_"+t]||N},le.prototype.get=function(e,t){return this.find(e,t)||T.kf(e,t,1,1)},le.prototype.remove=function(e,t){var r=this.spans.indexOf(e);0<=r?(t&&(t[0].push("spans"),t[1]=[].concat(this.spans)),this.removeSpan(r,1)):t&&(t.length=0)},le.prototype.removeSpan=function(e,t){for(var r=0;r<t;r++)oe(this,this.spans[e+r]);this.spans.splice(e,t)},le.prototype.update=function(e,t){oe(this,this.spans[e]),this.spans[e]=t,ne(this,t)},le.prototype.add=function(e,t){t&&(t[0].push("spans"),t[1]=[].concat(this.spans)),ne(this,e),this.spans.push(e)},le.prototype.Zz=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p=!1;for(a&&(s=[].concat(this.spans)),l=this.spans.length,d=[],f=0;f<l;f++)h=(u=this.spans[f]).col,c=u.row,(-1===e||e<=c&&c<e+o)&&(-1===t||t<=h&&h<t+i)?(d.push(T.kf(-1===e?c:r+c-e,-1===t?h:n+h-t,$(u),ee(u))),p=!0):(-1===e||r<=c&&c<r+o)&&(-1===t||n<=h&&h<n+i)&&(this.removeSpan(f,1),f--,l--,p=!0);for(f=0;f<d.length;f++){if(u=d[f],!this.LTa(this.spans,0,this.spans.length,u))throw Error(A().Exp_OverlappingSpans);this.add(u)}a&&(p?(a[0].push("spans"),a[1]=s):a.length=0)},le.prototype.LTa=function(e,t,r,n){for(var o=t;o<r&&o<e.length;o++)if(e[o].intersect(n.row,n.col,$(n),ee(n)))return!1;return!0},le.prototype.getSpans=function(e){var t,r,n,o=this.spans;if(!e)return[].concat(o);for(t=[],r=0;r<o.length;r++)(n=o[r]).intersect(e.row,e.col,$(e),ee(e))&&t.push(n);return t},le.prototype.qu=function(e,t,r,n){var o,i,a=this.spans;for(o=0;o<a.length;o++)if((i=a[o]).intersect(e,t,r,n)&&(-1!==e&&(i.row<e||i.row+$(i)>e+r)||-1!==t&&(i.col<t||i.col+ee(i)>t+n)))return!0;return!1},le.prototype.MTa=function(e,t,r,n){var o,i,a=!1,s=this.spans;for(o=0,i=s.length;o<i;o++){if(0<=e||0<=t)for(;o<i&&!s[o].intersect(e,t,r,n);)o++;if(o<i){a=!0;break}}return a},le.prototype.$b=function(e,t,r,n,o){var i,a,s,l,u,c=this.spans,h=!1;for(o&&(i=[].concat(c)),a=0;a<c.length;a++)l=(s=c[a]).row,u=s.col,(-1===e||e<=l&&l<e+r)&&(-1===t||t<=u&&u<t+n)&&(this.removeSpan(a,1),a--,h=!0);o&&(h?(o[0].push("spans"),o[1]=i):o.length=0)},le.prototype.aB=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m=!1;for(a&&(s=[].concat(this.spans)),l=[],u=[],c=this.spans.length,p=0;p<c;p++)f=(h=this.spans[p]).row,d=h.col,(-1===e||e<=f&&f<e+o)&&(-1===t||t<=d&&d<t+i)?(g=T.kf(-1===e?f:r+f-e,-1===t?d:n+d-t,$(h),ee(h)),u.push(g),m=!0):(-1===e||r<=f&&f<r+o)&&(-1===t||n<=d&&d<n+i)?m=!0:l.push(h);if(m){if(0<u.length)for(p=0;p<u.length;p++){if(g=u[p],!this.LTa(l,0,l.length,g))throw Error(A().Exp_OverlappingSpans);l.push(g)}for(this.spans.length=0,this.cache={},p=0;p<l.length;p++)this.add(l[p]);a&&(a[0].push("spans"),a[1]=s)}else a&&(a.length=0)},le.prototype.NTa=function(e,t,r){var n,o,i,a,s,l,u,c,h,f=this.spans;for(n=!(this.suspendUpdatingCache=!0),r&&(o=[].concat(f)),i=f.length,a=0;a<i;a++)l=(s=f[a]).row,u=s.col,c=$(s),h=ee(s),e<=l?(this.update(a,T.kf(l+t,u,c,h)),n=!0):e<l+c&&(this.update(a,T.kf(l,u,c+t,h)),n=!0);this.suspendUpdatingCache=!1,n&&re(this,f),r&&(n?(r[0].push("spans"),r[1]=o):r.length=0)},le.prototype.OTa=function(e,t,r){var n,o,i,a,s,l,u,c,h,f=this.spans;for(n=!(this.suspendUpdatingCache=!0),r&&(o=[].concat(f)),i=f.length,a=0;a<i;a++)l=(s=f[a]).row,u=s.col,c=$(s),h=ee(s),e<=u?(this.update(a,T.kf(l,u+t,c,h)),n=!0):e<u+h&&(this.update(a,T.kf(l,u,c,h+t)),n=!0);this.suspendUpdatingCache=!1,n&&re(this,f),r&&(n?(r[0].push("spans"),r[1]=o):r.length=0)},le.prototype.PTa=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g=this.spans;for(n=!(this.suspendUpdatingCache=!0),r&&(o=[].concat(g)),i=[],a=g.length,s=0;s<a;s++)u=(l=g[s]).row,c=l.col,h=$(l),f=ee(l),e<=u?(u<e+t?u+h<=e+t?i.push(s):this.update(s,T.kf(e,c,u+h-(e+t),f)):this.update(s,T.kf(u-t,c,h,f)),n=!0):e<u+h&&(d=T.kf(u,c,h-v(u+h-e,t),f),this.update(s,d),1===d.rowCount&&1===d.colCount&&i.push(s),n=!0);for(s=i.length-1;0<=s;s--)p=i[s],this.removeSpan(p,1);this.suspendUpdatingCache=!1,n&&re(this,g),r&&(n?(r[0].push("spans"),r[1]=o):r.length=0)},le.prototype.QTa=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g=this.spans;for(n=!(this.suspendUpdatingCache=!0),r&&(o=[].concat(g)),i=[],a=g.length,s=0;s<a;s++)u=(l=g[s]).row,c=l.col,h=$(l),f=ee(l),e<=c?(c<e+t?c+f<=e+t?i.push(s):this.update(s,T.kf(u,e,h,c+f-(e+t))):this.update(s,T.kf(u,c-t,h,f)),n=!0):e<c+f&&(d=T.kf(u,c,h,f-v(c+f-e,t)),this.update(s,d),1===d.rowCount&&1===d.colCount&&i.push(s),n=!0);for(s=i.length-1;0<=s;s--)p=i[s],this.removeSpan(p,1);this.suspendUpdatingCache=!1,n&&re(this,g),r&&(n?(r[0].push("spans"),r[1]=o):r.length=0)},le.prototype.toJSON=function(){var e=[].concat(this.spans);return 0===e.length?F:e},le.prototype.fromJSON=function(e){var t,r,n;if(e)for(this.spans=[],t=e,r=0;r<t.length;r++)n=t[r],this.add(T.kf(n.row,n.col,$(n),ee(n)))},k=le,se.prototype.pop=function(){return N},se.prototype.push=function(e){return 0},se.prototype.splice=function(e,t){var r,n=[];for(r=2;r<arguments.length;r++)n[r-2]=arguments[r];return N},se.prototype.slice=function(e,t){return null},(j=se).prototype=[],K(ae,Z=j),ae.prototype.find=function(e){var t,r,n=this.length,o=[];for(r=0;r<n;r++)(t=this[r]).contains(e)&&o.push(t);return o},t.np=ae,ie.prototype.contains=function(e){return e>=this.startColumn&&e<=this.endColumn},t.op=ie,ue.prototype.getProperty=function(e){return this[e]},ue.prototype.setProperty=function(e,t,r){r&&(r[0].push(e),r[1]=this[e]),this[e]=t},ue.prototype.clear=function(e){e&&(e.push(["selections",this.get()]),e.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},ue.prototype.add=function(e,t,r,n,o){o&&(o.push(["selections",this.get()]),o.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var i=this.selectionPolicy,a=this.selectionUnit;0===i?(r=v(r,1),n=v(n,1),this.clear()):1===i&&this.clear(),1===a?n=t=-1:2===a&&(r=e=-1),this.selections.push(T.kf(e,t,r,n)),this.activeSelectedRangeIndex=this.selections.length-1},ue.prototype.get=function(){return[].concat(this.selections)},ue.prototype.set=function(e,t){t&&(t.push(["selections",this.get()]),t.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=e,this.activeSelectedRangeIndex>=e.length&&(this.activeSelectedRangeIndex=0)},ue.prototype.toJSON=function(){var e,t={},r=this.selectionPolicy,n=this.selectionUnit,o=this.activeSelectedRangeIndex,i=this.selections.length;for(2!==r&&(t.selectionPolicy=r),0!==n&&(t.selectionUnit=n),0!==o&&(t.activeSelectedRangeIndex=o),t.length=i,e=0;e<i;e++)t[e]=this.selections[e];return I(t)?F:t},ue.prototype.fromJSON=function(e){var t,r,n,o,i;if(e){for(this.clear(),t=e.selectionPolicy,r=e.selectionUnit,n=e.length,L(n)&&(n=1),o=0;o<n;o++)i=e[o],this.selections.push(T.kf(i?i.row:0,i?i.col:0,i?$(i):1,i?ee(i):1));this.activeSelectedRangeIndex=e.activeSelectedRangeIndex||0,L(t)||(this.selectionPolicy=t),L(r)||(this.selectionUnit=r)}},ue.prototype.sp=function(e){var t,r,n,o=this.selections;for(t=0;t<o.length;t++)if(n=-1===(r=o[t]).col?0:r.col,-1===r.row&&n<=e&&e<n+ee(r))return!0;return!1},ue.prototype.tp=function(e){var t,r,n,o=this.selections;for(t=0;t<o.length;t++)if(n=-1===(r=o[t]).row?0:r.row,-1===r.col&&n<=e&&e<n+$(r))return!0;return!1},ue.prototype.vp=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v=!1,S=this.selections,x=i?1:0;for(a=0,s=S.length;a<s&&(l=S[a],d=l,p=n,g=o,w=C=y=b=m=void 0,w=T.kf(-1,-1,-1,-1),d&&(m=d.col,y=-1===(b=d.row),C=-1===m,w.row=y?0:b,w.rowCount=y?p:$(d),w.col=C?0:m,w.colCount=C?g:ee(d)),u=w.row,c=w.col,h=u-x<=e&&e<u+$(w)+x,f=c-x<=t&&t<c+ee(w)+x,3===r||L(r)?v=h&&f:2===r?v=h:1===r?v=f:0===r&&(v=-1===l.row&&-1===l.col),!v);a++);return v},ue.prototype.wp=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g=this.selections,m=!1;for(i=0;i<g.length&&(s=(a=g[i]).row,l=a.col,u=$(a),c=ee(a),h=-1===l,f=-1===s,L(r)||3===r||(2===r?(d=f?0:s,m=h&&d<=e&&e<d+u):1===r?(p=h?0:l,m=f&&p<=t&&t<p+c):0===r&&(m=f&&h&&u===n&&c===o),!m));i++);return m},H=ue,K(de,Y=j),de.prototype.findCell=function(e,t){var r,n,o=this.length;for(n=0;n<o;n++)if((r=this[n]).contains(e,t))return r;return N},de.prototype.findRow=function(e){var t,r,n=this.length;for(r=0;r<n;r++)if((t=this[r]).row===e)return t;return N},de.prototype.findCol=function(e){var t,r,n=this.length;for(r=0;r<n;r++)if((t=this[r]).col===e)return t;return N},de.prototype.findX=function(e){return ce(this,F,F,e)},de.prototype.findY=function(e){return ce(this,F,F,F,e)},de.prototype.findNearX=function(e){return he(this,e)},de.prototype.findNearY=function(e){return he(this,F,e)},t.yp=de,fe.prototype.contains=function(e,t){return e<this.row+$(this)&&this.row<=e&&t<this.col+ee(this)&&this.col<=t},fe.prototype.intersect=function(e){return(this.x<0||e.x<this.x+this.width&&this.x<e.x+e.width)&&(this.y<0||e.y<this.y+this.height&&this.y<e.y+e.height)},fe.prototype.containsX=function(e){return this.x<=e&&e<this.x+this.width},fe.prototype.containsY=function(e){return this.y<=e&&e<this.y+this.height},t.zp=fe,ye.prototype.ad=function(){this.dataTable={},this.rowDataArray=[],this.columnDataArray=[],this.defaultDataNode=N,this.Ap={},this.gga=0,this.Ff=-1,this.Ef=-1},ye.prototype.getRowCount=function(){return this.Xj},ye.prototype.getColumnCount=function(){return this.OZ},ye.prototype.setRowCount=function(e){this.Xj=e},ye.prototype.setColumnCount=function(e){this.OZ=e},ye.prototype.Cp=function(e,t,r,n){var o,i,a,s,l=this.Ap;0<this.gga||0<=e&&0<=t&&(n&&(n.type="updateDirty",n.row=e,n.col=t,l[e]?l[e][t]||(n.isEmptyCol=!0):n.isEmptyRow=!0),l[e]||(l[e]={}),(o=l[e])[t]||(o[t]={}),i=o[t],"n"!==o.rs&&(o.rs="e"),a=r.Dp,s=r.Ep,L(a)||(n&&(n.originalItem=o.originalItem),o.originalItem=a),L(s)||(n&&(n.oldValue=i.oldValue),i.oldValue=s))},ye.prototype.gWa=function(e){var t=this.Ap,r=e.row,n=e.col;e.isEmptyRow&&t?delete t[r]:e.isEmptyCol&&t[r]?delete t[r][n]:(e.hasOwnProperty("originalItem")&&(L(e.originalItem)&&!L(t[r].originalItem)?delete t[r].originalItem:t[r].originalItem=e.originalItem),e.hasOwnProperty("oldValue")&&(L(e.oldValue)&&!L(t[r][n].oldValue)?delete t[r][n].oldValue:t[r][n].oldValue=e.oldValue))},ye.prototype.getValue=function(e,t,r){var n=this.RTa(e,t);return n&&!L(n.value)?1!==r?u(n.value):L(n.value.richText)?n.value:a(!0,{},n.value):N},ye.prototype.setValue=function(e,t,r,n,o){var i,a=this.RTa(e,t,!0,n?n[0]:F);!a||L(a.value)&&L(r)||a.value===r?n&&(n.length=0):(i=a.value,a.value=r,this.Cp(e,t,{Ep:i},o),n&&(n[0].push("value"),n[1]=i))},ye.prototype.getStyle=function(e,t,r){var n=this.RTa(e,t),o=n&&n.style;return o&&r&&o.clone&&(o=o.clone(!0)),o},ye.prototype.setStyle=function(e,t,r,n){var o,i=this.RTa(e,t,!0,n?n[0]:F);i&&i.style!==r?(o=i.style,i.style=r,n&&(n[0].push("style"),n[1]=o)):n&&(n.length=0)},ye.prototype.getCellState=function(e,t){var r=this.RTa(e,t);return r?r.cellState:N},ye.prototype.setCellState=function(e,t,r,n){var o,i,a=this.getCellState(e,t)||0;0!=(o=n?a|r:a&~r)?(i=this.RTa(e,t,!0,F,!0))&&(i.cellState=o):((i=this.RTa(e,t))&&delete i.cellState,I(i)&&(Re(this.dataTable,e,t),I(this.dataTable[e])&&delete this.dataTable[e]))},ye.prototype.getValueForKey=function(e,t,r){var n=this.RTa(e,t);return n&&n[r]},ye.prototype.setValueForKey=function(e,t,r,n,o){var i,a=this.RTa(e,t,!0,o?o[0]:F);a&&a[r]!==n?(i=a[r],a[r]=n,o&&(o[0].push(r),o[1]=i)):o&&(o.length=0)},ye.prototype.NTa=function(e,t,r){var n,o=this.Xj,i=this.dataTable,a=this.Ap;if(0<=e&&e<=o&&0<=t&&(l(i,o,e,t),l(this.rowDataArray,o,e,t),l(a,o,e,t),this.Xj+=t,!r))for(n=0;n<t;n++)i[e+n]={rs:"n"},a[e+n]={rs:"n"}},ye.prototype.STa=function(e,t,r){var n,o,i=this.Xj;if(0<=e&&e<i&&0<t){if(i<e+t&&(t=i-e),r)for(n=0;n<t;n++)o=e+n,r.push([["dataTable",o],this.dataTable[o]]),r.push([["rowDataArray",o],this.rowDataArray[o]]),r.push([[c,o],this.Ap[o]]);f(this.dataTable,i,e,t),f(this.rowDataArray,i,e,t),f(this.Ap,i,e,t),this.Xj-=t}},ye.prototype.OTa=function(e,t){var r,n,o=this.OZ;if(0<=e&&e<=o&&0<=t){for(r=0;r<this.Xj;r++)(n=this.dataTable[r])&&e<o&&l(n,o,e,t);l(this.columnDataArray,o,e,t),this.OZ+=t}},ye.prototype.TTa=function(e,t,r){var n,o,i,a,s,l,u=this.OZ;if(0<=e&&e<u&&0<t){for(n=0;n<this.Xj;n++)if(o=this.dataTable[n]){if(r)for(i=0;i<t;i++)a=e+i,r.push([["dataTable",n,a],o[a]]);f(o,u,e,t)}if(r)for(s=0;s<t;s++)l=e+s,r.push([["columnDataArray",l],this.columnDataArray[l]]);f(this.columnDataArray,u,e,t),u<e+t&&(t=u-e),this.OZ-=t}},ye.prototype.RTa=function(e,t,r,n,o){var i,a=this,s=a.dataTable,l=a.columnDataArray,u=a.rowDataArray,c=N;return e<a.Xj&&t<a.OZ&&(0<=e&&0<=t?(i=s[e],r&&(i=i||(s[e]={}),!o&&e>a.Ef&&(a.Ef=e)),i&&(c=i[t],r&&(c=c||(i[t]={}),!o&&a.Ff<t&&(a.Ff=t))),n&&n.push("dataTable",e,t)):-1===e&&0<=t?(c=l[t],r&&(c=c||(l[t]={}),!o&&a.Ff<t&&(a.Ff=t)),n&&n.push("columnDataArray",t)):0<=e&&-1===t?(c=u[e],r&&(c=c||(u[e]={}),!o&&a.Ef<e&&(a.Ef=e)),n&&n.push("rowDataArray",e)):-1===e&&-1===t&&(c=a.defaultDataNode,r&&!c&&(c=a.defaultDataNode={}),n&&n.push("defaultDataNode"))),c},ye.prototype.setNode=function(e,t,r){var n=this.dataTable,o=this.columnDataArray,i=this.rowDataArray;e<this.Xj&&t<this.OZ&&(0<=e&&0<=t?(n[e]||(n[e]={}))[t]=r:-1===e&&0<=t?o[t]=r:-1===t&&0<=e&&(i[e]=r))},ye.prototype._f=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m;o&&(i=[],a=[]),s=this.dataTable,l=this.rowDataArray,u=this.columnDataArray,c=this.Ap,h=this.RTa(e,t,F,i),f=c[e]&&c[e][t],d=c[e]&&c[e].originalItem,p=this.RTa(r,n,F,a),g=c[r]&&c[r][n],m=c[r]&&c[r].originalItem,o&&(o.push([i,h]),o.push([a,p])),h?ge(e,t,r,n,h,s,l,u):p&&ge(e,t,r,n,N,s,l,u),p?ge(r,n,e,t,p,s,l,u):h&&ge(r,n,e,t,N,s,l,u),f?me(0,0,r,n,f,c,d):g&&me(0,0,r,n,N,c,d),g?me(0,0,e,t,g,c,m):f&&me(0,0,e,t,N,c,m)},ye.prototype.Yea=function(e){e++;for(var t=this.Xj,r=this.dataTable;0<=e&&e<t&&!r[e];)e++;return e<t?e:-1},ye.prototype.Hl=function(e,t){var r=N,n=this.OZ;if(0<=e&&e<this.Xj&&(r=this.dataTable[e]),r){for(t++;0<=t&&t<n&&!r[t];)t++;if(t<n)return t}return-1},ye.prototype.yIb=function(e){var t,r,n,o,i,a=e.row,s=e.col,l=e.rowCount,u=e.colCount;for(t=a,r=0;r<l;r++,t++)for(n=s,o=0;o<u;o++,n++)(i=this.RTa(t,n))&&(i.value=N)},ye.prototype._Sb=function(e,t,r){var n=r&&r.getFormatter(e,t);return!!O(n)&&n},ye.prototype.clear=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p=this.Xj,g=this.OZ,m=[],b=!!a,y=[];if(0<=e&&0<=t){if(r=v(r,p-e),n=v(n,g-t),0<r&&0<n)for(u=e;u<e+r;u++)if(!i||C.Common.k.Cb(i,u)<0)for(l=t;l<t+n;l++)b&&(c=[]),(s=this.RTa(u,l,F,c))&&(m.push(s),b&&y.push(c),0<(1&o)&&!L(s.value)&&(h=void 0,b&&(h={}),this.Cp(u,l,{Ep:s.value},h),h&&a.push(h)))}else if(0<=e&&-1===t){if(0<(r=v(r,p-e)))for(u=e;u<e+r;u++)b&&(c=[]),(s=this.RTa(u,-1,F,c))&&(m.push(s),b&&y.push(c))}else if(-1===e&&0<=t){if(0<(n=v(n,g-t)))for(l=t;l<t+n;l++)b&&(c=[]),(s=this.RTa(-1,l,F,c))&&(m.push(s),b&&y.push(c))}else-1===e&&-1===t&&(b&&(c=[]),(s=this.RTa(-1,-1,F,c))&&(m.push(s),b&&y.push(c)));for(f=function(r){if(s=m[r]){var e=b?[]:F;0<(8&o)&&(e&&e.push(["tag",s.tag]),s.tag=N),0<(2&o)&&(e&&e.push(["style",s.style]),s.style=N),0<(1&o)&&(e&&e.push(["value",s.value]),s.value=N),0<(16&o)&&(e&&e.push(["sparkline",s.sparkline]),s.sparkline=N),0<(64&o)&&(e&&e.push(["bindingPath",s.bindingPath]),s.bindingPath=N),0<(256&o)&&(e&&e.push(["hyperlink",s.hyperlink]),s.hyperlink=N),0<(4&o)&&(e&&e.push(["comment",s.comment]),s.comment=N),b&&e.forEach(function(e){var t=[].concat(y[r]);t.push(e[0]),e[0]=t,a.push(e)})}},d=0;d<m.length;d++)f(d)},ye.prototype.toJSON=function(e,g,m){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,b,y,C,w,v,S,x,T,A,k=m&&m.parent&&!I(m.parent.QHb);function M(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p;return r?(a={},s=r.value,L(s)||(a.value=s),g&&g.saveAsView&&(l=void 0,i?l=i:k&&(l=m&&m.getFormatter(e,t)),O(l)&&(u=m.aHb(e,t,l,s),L(u)||(a.value=u))),g&&g.ignoreStyle||("string"==typeof(c=r.style)?a.style=c:c&&(h=c.toJSON(n,o))&&(h.name=F,a.style=h)),f=r.bindingPath,L(f)||(a.bindingPath=f),d=r.tag,L(d)||(a.tag=d),p=r.hyperlink,L(p)||(a.hyperlink=B(p)),a):N}if(r={},n={},o=(t=this).Xj,i=t.OZ,a=t.dataTable,s=t.rowDataArray,l=t.columnDataArray,g&&g.saveAsView)for(h=0;h<o;){for(d=!(f={}),p=a[h],b=0;b<i;)y={},p&&p[b]||l[b]?y=M(h,b,t.RTa(h,b,!0)):3===e&&k&&(C=this._Sb(h,b,m))&&(y=M(h,b,t.RTa(h,b,!0),3,!1,C)),I(y)||(f[b]=y,d=!0),b++;d&&(n[h]=f),h++}else for(u=t.Yea(-1);0<=u;){for(d=!(f={}),c=t.Hl(u,-1);0<=c;)(w=t.RTa(u,c))&&(y=M(u,c,w),I(y)||(f[c]=y,d=!0)),c=t.Hl(u,c);d&&(n[u]=f),u=t.Yea(u)}for(I(n)||(r.dataTable=n),v=[],u=0;u<o;u++)Q(s,u)&&s[u]&&(S=M(u,-1,s[u]),I(S)||(v[u]=S));for(0<v.length&&(r.rowDataArray=v),x=[],c=0;c<i;c++)Q(l,c)&&l[c]&&(T=M(-1,c,l[c]),I(T)||(x[c]=T));return 0<x.length&&(r.columnDataArray=x),A=M(-1,-1,t.defaultDataNode,e,!0),I(A)||(r.defaultDataNode=A),r},ye.prototype.fromJSON=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p=r&&r.incrementalLoading;if(e){if((i=this).ad(),i.gga++,a=e.dataTable,u=i.Xj,c=i.OZ,a?p&&3===n?pe(i,a,u,c,r,t,F,o):function(e,t,r,n,o,i){var a,s,l,u;for(a=0;a<r;a++)if(s=t[a])for(l=0;l<n;l++)(u=s[l])&&Ce(u,e.RTa(a,l,!0),i,a,l,o)}(i,a,u,c,r,t):p&&o&&setTimeout(o,0),h=e.rowDataArray||e.Hf)for(s=0;s<u;s++)Q(h,s)&&h[s]&&Ce(h[s],i.RTa(s,-1,!0),t,s,-1,r);if(f=e.columnDataArray||e.If)for(l=0;l<c;l++)Q(f,l)&&f[l]&&Ce(f[l],i.RTa(-1,l,!0),t,-1,l,r);(d=e.defaultDataNode||e.Jf)&&Ce(d,i.RTa(-1,-1,!0),t,-1,-1,r),i.gga--}else p&&o&&setTimeout(o,0)},G=ye,be.prototype.uL=function(e,t){var r=this.infos,n=r.length;0<=e&&e<=n&&0<t&&l(r,n,e,t)},be.prototype.UTa=function(e,t,r){var n,o,i=this.infos,a=i.length;if(0<=e&&e<a&&0<t){if(t=v(t,a-e),r)for(n=0;n<t;n++)o=e+n,r.push([["infos",o],i[o]]);f(i,a,e,t)}},be.prototype.VTa=function(){return this.infos.length},be.prototype.Hp=function(){return this.infos},be.prototype.Jp=function(e){return this.infos[e]},be.prototype.Kp=function(e,t,r){var n=this.infos[e];this.infos[e]=t,r&&(r[0].push("infos",e),r[1]=n)},be.prototype.getSize=function(e){var t=this.infos[e],r=N;return t&&(!1===t.visible?r=0:"number"==typeof t.size&&(r=_(t.size))),r},be.prototype.getActualSize=function(e){var t=this.infos[e];return t?_(t.size):N},be.prototype.setSize=function(e,t,r){var n,o=this.infos,i=o[e];(n=(i=i||(o[e]={})).size)!==t&&(i.size=t),r&&(r[0].push("infos",e,"size"),r[1]=n)},be.prototype.getStarSize=function(e){var t=this.infos[e];return t?t.starSize:F},be.prototype.setStarSize=function(e,t,r){var n,o=this.infos,i=this.infos[e];n=(i=i||(o[e]={})).starSize,L(t)&&L(n)||(n!==t&&(L(t)?delete i.starSize:i.starSize=t),r&&(r[0].push("infos",e,"starSize"),r[1]=n))},be.prototype.toJSON=function(e){var t,r,n,o,i,a,s,l,u=this.infos,c=[];if(e&&e.ignoreStarSize)for(t=0;t<u.length;t++)L(u[t])||(n=(r=u[t]).cellType,o=X(r,["cellType"]),c[t]=B(o),n&&(n.toJSON&&(n=n.toJSON()),i=h._o,a=n.typeName,(s=i[n.type]||i[a]||y.getTypeFromString(a))&&((l=new s).fromJSON(n,e),c[t].cellType=l)),delete c[t].starSize);else for(t=0;t<u.length;t++)L(u[t])||(c[t]=u[t]);return 0<c.length?c:F},be.prototype.fromJSON=function(e){e&&(this.infos=e)},W=(U=be).prototype,p({visible:!0,resizable:!0,pageBreak:!1},function(a,n){var e=a[0].toUpperCase()+a.substr(1);W["get"+e]=function(e){var t=n,r=this.infos[e];return r&&!L(r[a])&&(t=r[a]),t},W["set"+e]=function(e,t,r){var n,o=this.infos,i=o[e];(n=(i=i||(o[e]={}))[a])!==t&&(i[a]=t),r&&(r[0].push("infos",e,a),r[1]=n)}}),De.prototype.no=function(){this.modelManager=N},De.prototype.getAnchorCell=function(e,t){return Ie(this.anchors,e,t)},De.prototype.getAnchorItem=function(e,t){return Ie(this.cells,e,t)},De.prototype.getAnchorInfo=function(e,t,r){var n,o,i,a,s=this.anchors,l=this.getAnchorCell(e,t);if(l)return l;if(n=this.getAnchorItem(e,t))for(i in o=n.anchorRefs)if(o[i]&&(a=Ee(s,i),r||a.isValid))return a},De.prototype.isCellHasItsOwnValue=function(e,t,r){var n,o,i,a,s=this.getAnchorItem(e,t);if(s){if(!L(s.value)||s.AIb)return!0;for(i in n=s.anchorRefs,o=this.anchors,n)if(r!==i&&n[i]&&(a=Ee(o,i))&&a.isValid)return!0}return!1},De.prototype.removeRef=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b=this.cells,y=t.isValid,C=t.row,w=t.col,v=t.rowCount,S=t.colCount,x=1;for(a=0,s=C;a<v;a++,s++){for(l=w+x;x<S;x++,l++){if(c=(u=Ie(b,s,l))&&u.anchorRefs,h=!0,y){if(f=e.getValue(s,l),d=u&&u.value,L(d)){if(g=!(p=u&&u.AIb)||p===r,c)for(m in c)if(m!==r&&c[m]){h=!1;break}g?Te(n,s,l,N,f,t.row===s&&t.col===l):d=f}o&&xe(o,s,l,d)}c&&(delete c[r],h&&i&&I(c)&&Re(b,s,l,!0))}x=0}},De.prototype.BIb=function(e,t,r,n,o){var i,a,s,l=e.getRowCount(),u=e.getColumnCount();return!(l<t+n||u<r+o||5e5<n*o||(i=e.getSheet(),a=T.kf(t,r,n,o),i._modelManager.getSpans(a).length||(s=i.tables)&&s.rn&&s.rn(t,r,n,o)))},De.prototype.setArray=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=this,A=ke(t,r),k=T.anchors,M=Ie(k,t,r),I=T.cells;if(M&&!i)return[M,(a=T.updateItem(e,t,r))[0],a[1]];if(s={},u=!(l={}),M&&M.isValid&&(u=!0,T.removeRef(e,M,A,s,l,!0)),c=M,Se(k,t,r,M={row:t,col:r,rowCount:n,colCount:o,values:i,isValid:!1}),h=e.getCalcService().CIb,M.CIb=h,f=c&&c.CIb===h&&(n!==c.rowCount||o!==c.colCount),(d=e.q$a)&&Ie(T.invalidAnchors,t,r))Te(s,t,r,R&&E.Errors.Spill,N,M.row===t&&M.col===r),T.DIb(t,r,n,o,I,d,l,e,A,!0);else if(i){if(p=Ae(l,t,r,e),(g=!f&&T.BIb(e,t,r,n,o))&&(T.DIb(t,r,n,o,I,d,l,e,A),!d))for(m=1,b=0,y=t;b<n;b++,y++){for(C=r+m;m<o;m++,C++)if(w=Ae(l,y,C,e),!L(w)&&T.isCellHasItsOwnValue(y,C,A)){if(g=!1,!u)break;Se(s,y,C,w,!0)}if(!u&&!g)break;m=0}if(g)for(b=0,y=t;b<n;b++,y++)for(v=i[b],m=0,C=r;m<o;m++,C++)w=Ae(l,y,C,e),S=v[m],L(x=S)?x=0:R&&(E.Convert.Ca(S)||E.Convert._isReference(S))&&(x=1===S.getRowCount()&&1===S.getColumnCount()?E.Convert.Ca(S)?S.getValue(0,0):S.getValue(0,0,0):E.Errors.Calc),Te(s,y,C,x,w,M.row===y&&M.col===C),(b||m)&&(Ie(I,y,C).AIb=A);else Te(s,t,r,R&&E.Errors.Spill,p,M.row===t&&M.col===r);M.isValid=g,c&&g!==c.isValid&&T.modelManager.EIb(t,r,!g)}return[M,s,[c]]},De.prototype.DIb=function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p=1;for(c=0;c<r;c++){for(h=e+c;p<n;p++)f=t+p,(d=!u&&Ie(o,h,f))||(d={anchorRefs:{}},i&&!u||(d.value=Ae(a,h,f,s)),Se(o,h,f,d)),d.anchorRefs[l]=!0;p=0}},De.prototype.updateItem=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p;if(void 0===o&&(o={}),void 0===i&&(i=[]),a=ke(t,r),(l=Ie(s=this.anchors,t,r))&&(this.removeRef(e,l,a,o,F,!0),Re(o,t,r),Re(s,t,r,!0)),u=Ie(this.cells,t,r))for(h in this.modelManager.FIb(t,r,u.value),u.value=n,delete u.AIb,c=u.anchorRefs)c[h]&&(f=Ee(s,h),p=f,-1===(d=i).indexOf(p)&&d.push(p));if(l||u)return[l&&o,i]},De.prototype.GIb=function(e,t){Se(this.invalidAnchors,e,t,!0)},De.prototype.HIb=function(){this.invalidAnchors={}},De.prototype.IIb=function(t,e,r){var n,o,i,a,s,l,u,c=this,h=c.anchors,f=[];for(n in h)if(h.hasOwnProperty(n))for(s in i=e<=(o=+n),a=h[n])a.hasOwnProperty(s)&&(l=+s,(i=i||(u=a[s])&&u.rowCount+o>=e)&&f.push([o,l]));f.length&&f.forEach(function(e){c.updateItem(t,e[0],e[1],F)})},De.prototype.NTa=function(e,t,r){this.IIb(e,t,r)},De.prototype.PTa=function(e,t,r){this.IIb(e,t,r)},De.prototype.JIb=function(t,e){var r,n,o,i,a,s,l,u=this,c=u.anchors,h=[];for(r in c)if(c.hasOwnProperty(r))for(i in n=+r,o=c[r])o.hasOwnProperty(i)&&((s=e<=(a=+i))||(s=(l=o[i])&&l.colCount+a>=e),s&&h.push([n,a]));h.length&&h.forEach(function(e){u.updateItem(t,e[0],e[1],F)})},De.prototype.OTa=function(e,t,r){this.JIb(e,t)},De.prototype.QTa=function(e,t,r){this.JIb(e,t)},V=De,t.KIb=V,t.clearSpillValuesOnAddRemove=Ne,_e.prototype.Agc=function(e,t){this.zgc({type:M.AxisInfoChangeType.setRowCount,count:e}),this.zgc({type:M.AxisInfoChangeType.setColumnCount,count:t})},_e.prototype.zgc=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p=this.kj,g=e.type,m=e.sheetArea;if((void 0===m?M.SheetArea.viewport:m)===M.SheetArea.viewport){if(L(this.Bgc)&&(this.Bgc=[]),L(this.Cgc)&&(this.Cgc=[]),this.Dgc)return void this.Egc(e);switch(t=this.Bgc,r=this.Cgc,g){case M.AxisInfoChangeType.setRowCount:if(0<(i=(n=e.count)-(o=t.length)))for(a=Me(S,i),s=0;s<a.length;s++)t.splice(o+s,0,a[s]);else t.length=n;break;case M.AxisInfoChangeType.setColumnCount:if(0<(i=(n=e.count)-(o=r.length)))for(a=Me(S,i),s=0;s<a.length;s++)r.splice(o+s,0,a[s]);else r.length=n;break;case M.AxisInfoChangeType.addRows:for(l=e.index,n=e.count,u=Me(S,n),s=0;s<u.length;s++)t.splice(l+s,0,u[s]);break;case M.AxisInfoChangeType.deleteRows:l=e.index,n=e.count,t.splice(l,n);break;case M.AxisInfoChangeType.addColumns:for(l=e.index,n=e.count,u=Me(S,n),s=0;s<u.length;s++)r.splice(l+s,0,u[s]);break;case M.AxisInfoChangeType.deleteColumns:l=e.index,n=e.count,r.splice(l,n);break;case M.AxisInfoChangeType.setRowHeight:case M.AxisInfoChangeType.setRowVisible:l=e.index,c=e.value,t[l]=c;break;case M.AxisInfoChangeType.setColumnWidth:case M.AxisInfoChangeType.setColumnVisible:l=e.index,c=e.value,r[l]=c;break;case M.AxisInfoChangeType.filterRows:for(f=0,d=h=e.index;f<d.length;f++)l=d[f],c=p.getRowHeight(l),t[l]=c;break;case M.AxisInfoChangeType.outlineExpandRows:for(h=e.index,s=0;s<h.length;s++)l=h[s],c=p.getRowHeight(l),t[l]=c;break;case M.AxisInfoChangeType.outlineExpandColumns:for(h=e.index,s=0;s<h.length;s++)l=h[s],c=p.getColumnWidth(l),r[l]=c}}},_e.prototype.Fgc=function(e){if(this.Bgc){var t=this.Bgc[e];return t===S?this.defaults.rowHeight:t}},_e.prototype.Ggc=function(e){if(this.Cgc){var t=this.Cgc[e];return t===S?this.defaults.colWidth:t}},_e.prototype.wgc=function(){this.Dgc=[]},_e.prototype.ygc=function(){var e,t,r,n=this.Dgc;if(this.Dgc=N,n)for(e=0,t=n;e<t.length;e++)r=t[e],this.zgc(r)},_e.prototype.Egc=function(e){this.Dgc&&this.Dgc.push(e)},_e.prototype.xgc=function(){this.Bgc=N,this.Cgc=N},_e.prototype.no=function(e){!1!==e&&(this.kj=N,this.sheetModels=N,this.ZHb&&(this.ZHb.no(),this.ZHb=N),this.xgc()),_e.ao(this,"dispose",{clearCache:e})},_e.prototype.addRows=function(e,t,r,n){var o,i=this;0<i.WTa&&(o={row:e,rowCount:t,type:"addRows"},i.zTa.push(o)),i._getSheetModel(3).NTa(e,t,n),i._getSheetModel(2).NTa(e,t,n),i.zl(3).NTa(e,t),i.zl(2).NTa(e,t),i.YTa(!0,3).uL(e,t),R&&i.ZHb.NTa(i.kj.yj(),e,t),r||_e.ao(i,"addRows",{row:e,rowCount:t,changes:i.zTa}),i.zgc({type:M.AxisInfoChangeType.addRows,index:e,count:t})},_e.prototype.ZTa=function(e){var t=e.row,r=e.rowCount;Ne(this,t,0,0,!0),this.deleteRows(t,r,!0),_e.ao(this,"undoAddRows",{row:t,rowCount:r})},_e.prototype.deleteRows=function(e,t,r){var n,o,i,a,s,l,u,c,h,f=this;if(0<f.WTa&&(o=[],i=[],a=[["spanModels",3],F],s=[["spanModels",2],F],l=[],n={row:e,rowCount:t,type:"deleteRows"},f.zTa.push(n)),f._getSheetModel(3).STa(e,t,o),f._getSheetModel(2).STa(e,t,i),f.zl(3).PTa(e,t,a),f.zl(2).PTa(e,t,s),f.YTa(!0,3).UTa(e,t,l),R&&f.ZHb.PTa(f.kj.yj(),e,t),r||_e.ao(f,"deleteRows",{row:e,rowCount:t,changes:f.zTa}),n){for(u=n.changes=[],c=["sheetModels",3],h=0;h<o.length;h++)o[h][0]=c.concat(o[h][0]),u.push(o[h]);for(c=["sheetModels",2],h=0;h<i.length;h++)i[h][0]=c.concat(i[h][0]),u.push(i[h]);for(0<a.length&&u.push(a),0<s.length&&u.push(s),c=[d,3],h=0;h<l.length;h++)l[h][0]=c.concat(l[h][0]),u.push(l[h])}f.zgc({type:M.AxisInfoChangeType.deleteRows,index:e,count:t})},_e.prototype.$Ta=function(e){var t,r,n,o=e.row,i=e.rowCount;for(Ne(this,o,0,0,!0),this.addRows(o,i,!0,!0),r=(t=e.changes).length-1;0<=r;r--)we(this,t[r]);(n=this.kj&&this.kj.Ts)&&n.splice(n.length-i,i)},_e.prototype.addColumns=function(e,t,r){var n,o=this;0<o.WTa&&(n={col:e,colCount:t,type:"addColumns"},o.zTa.push(n)),o._getSheetModel(3).OTa(e,t),o._getSheetModel(1).OTa(e,t),o.zl(3).OTa(e,t),o.zl(1).OTa(e,t),o.YTa(!1,3).uL(e,t),R&&o.ZHb.OTa(o.kj.yj(),e,t),r||_e.ao(o,"addColumns",{col:e,colCount:t,changes:o.zTa}),o.zgc({type:M.AxisInfoChangeType.addColumns,index:e,count:t})},_e.prototype._Ta=function(e){var t=e.col,r=e.colCount;Ne(this,t,0,0,!1),this.deleteColumns(t,r,!0)},_e.prototype.deleteColumns=function(e,t,r){var n,o,i,a,s,l,u,c,h,f=this;if(0<f.WTa&&(o=[],i=[],a=[["spanModels",3],F],s=[["spanModels",1],F],l=[],n={col:e,colCount:t,type:"deleteColumns"},f.zTa.push(n)),f._getSheetModel(3).TTa(e,t,o),f._getSheetModel(1).TTa(e,t,i),f.zl(3).QTa(e,t,a),f.zl(1).QTa(e,t,s),f.YTa(!1,3).UTa(e,t,l),R&&f.ZHb.QTa(f.kj.yj(),e,t),r||_e.ao(f,"deleteColumns",{col:e,colCount:t,changes:f.zTa}),n){for(u=n.changes=[],c=["sheetModels",3],h=0;h<o.length;h++)o[h][0]=c.concat(o[h][0]),u.push(o[h]);for(c=["sheetModels",1],h=0;h<i.length;h++)i[h][0]=c.concat(i[h][0]),u.push(i[h]);for(0<a.length&&u.push(a),0<s.length&&u.push(s),c=[g,3],h=0;h<l.length;h++)l[h][0]=c.concat(l[h][0]),u.push(l[h])}f.zgc({type:M.AxisInfoChangeType.deleteColumns,index:e,count:t})},_e.prototype.aUa=function(e){var t,r,n=e.col,o=e.colCount;for(Ne(this,n,0,0,!1),this.addColumns(n,o,!0),r=(t=e.changes).length-1;0<=r;r--)we(this,t[r])},_e.prototype.getRowCount=function(e){return this._getSheetModel(e).getRowCount()},_e.prototype.setRowCount=function(e,t,r){var n=this.getRowCount(t);0<this.WTa&&this.zTa.push({oldRowCount:n,sheetArea:t,type:"setRowCount"}),3===t||2===t?(e<n&&this.deleteRows(e,n-e,r),this._getSheetModel(3).setRowCount(e),this._getSheetModel(2).setRowCount(e)):1===t&&(e<n&&this.YTa(!0,t).UTa(e,n-e),this._getSheetModel(t).setRowCount(e)),this.zgc({type:M.AxisInfoChangeType.setRowCount,count:e,sheetArea:t})},_e.prototype.bUa=function(e){this.setRowCount(e.oldRowCount,e.sheetArea,!0)},_e.prototype.getColumnCount=function(e){return this._getSheetModel(e).getColumnCount()},_e.prototype.setColumnCount=function(e,t,r){var n=this.getColumnCount(t);0<this.WTa&&this.zTa.push({oldColCount:n,sheetArea:t,type:"setColumnCount"}),3===t||1===t?(e<n&&this.deleteColumns(e,n-e,r),this._getSheetModel(3).setColumnCount(e),this._getSheetModel(1).setColumnCount(e)):2===t&&(e<n&&this.YTa(!1,t).UTa(e,n-e),this._getSheetModel(t).setColumnCount(e)),this.zgc({type:M.AxisInfoChangeType.setColumnCount,count:e,sheetArea:t})},_e.prototype.cUa=function(e){this.setColumnCount(e.oldColCount,e.sheetArea,!0)},_e.prototype.getLastNonNullRow=function(e,t){var r=t?0:this.YTa(!0,e).VTa()-1;return s(this._getSheetModel(e).Ef,this.zl(e).Ef,r)},_e.prototype.getLastNonNullCol=function(e,t){var r=t?0:this.YTa(!1,e).VTa()-1;return s(this._getSheetModel(e).Ff,this.zl(e).Ff,r)},_e.prototype.$Gb=function(){var s=this.kj,e=0!==s.Dr().height&&this._Gb(!0,s.defaults.rowHeight),t=0!==s.Dr().width&&this._Gb(!1,s.defaults.colWidth);function r(e,t){var r,n,o,i,a=t.length;for(r=0;r<a;r++)n=t[r][0],o=t[r][1],(i=t[r][2])!==o&&(e?s.kq(n,3,"height",o,i):s.pq(n,3,"width",o,i))}e&&r(!0,e),t&&r(!1,t)},_e.prototype._Gb=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=this.kj,v=[],S=w.zoom(),x=e?w.getRowCount():w.getColumnCount(),T=this.YTa(e,3),A=0,k=0;if(w.Gt&&(k=e?w.Gt().height:w.Gt().width),e){if(w.options.colHeaderVisible)for(n=0;n<w.getRowCount(1);n++)A+=P(S*w.getRowHeight(n,1));r=w.Dr().height-w.options.sheetAreaOffset.top-k-A}else{if(w.options.rowHeaderVisible)for(n=0;n<w.getColumnCount(2);n++)A+=P(S*w.getColumnWidth(n,2));r=w.Dr().width-w.options.sheetAreaOffset.left-k-A}for(o=[],i=[],a=[],s=0,l=e?w.getRowVisible:w.getColumnVisible,n=0;n<x;n++)if(u=l.call(w,n),c=w._modelManager.getSize(e,3,n),h=w._modelManager.getStarSize(e,3,n),D.test(h))f="*"===h?1:parseFloat(h.replace("*","")),u&&0<f?(s+=f,o.push(n),i.push(f),a.push(c)):v.push([n,0,c]);else if(c="number"==typeof c?Math.floor(c):t,u&&(r-=P(S*c))<1)return;if(!(s+v.length===0||r<1)){for(d=o.length,n=0;n<d-1;n++)if(p=r/s/S,f=i[n],c=_(p*f),g=P(S*c),v.push([o[n],c,a[n]]),r-=g,s-=f,g<1||r<1)return;for(m=P((r-1e-4)/S),v.push([o[d-1],m,a[d-1]]),n=0;n<v.length;n++)b=v[n][0],y=v[n][1],T.setSize(b,y),C=e?M.AxisInfoChangeType.setRowHeight:M.AxisInfoChangeType.setColumnWidth,this.zgc({type:C,index:b});return v}},_e.prototype.setCellState=function(e,t,r,n,o){var i=this._getSheetModel(o);i&&i.setCellState(e,t,r,n)},_e.prototype.toJSON=function(e){var t,r,n,o=this,i={};return i.data=o._getSheetModel(3).toJSON(3,e,o.kj),i.rowHeaderData=o._getSheetModel(2).toJSON(2,e),i.colHeaderData=o._getSheetModel(1).toJSON(1,e),i.rows=o.YTa(!0,3).toJSON(e),i.columns=o.YTa(!1,3).toJSON(e),i.rowHeaderColInfos=o.YTa(!1,2).toJSON(e),i.colHeaderRowInfos=o.YTa(!0,1).toJSON(e),t=o.kj,i.leftCellIndex=t.getViewportLeftColumn(1),i.topCellIndex=t.getViewportTopRow(1),e&&e.ignoreStyle||(i.spans=Fe(o.zl(3).toJSON()),i.rowHeaderSpan=Fe(o.zl(2).toJSON()),i.colHeaderSpan=Fe(o.zl(1).toJSON())),i.selections=o.selectionModel.toJSON(),i.tag=o.getValueForKey(-1,-1,"tag",3),20===(n={colHeaderRowHeight:(r=o.defaults).colHeaderRowHeight,colWidth:r.colWidth,rowHeaderColWidth:r.rowHeaderColWidth,rowHeight:r.rowHeight,_isExcelDefaultColumnWidth:r._isExcelDefaultColumnWidth}).rowHeight&&62===n.colWidth&&40===n.rowHeaderColWidth&&20===n.colHeaderRowHeight||(i.defaults=n),i},_e.prototype.fromJSON=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g=this;if(g._getSheetModel(3).fromJSON(e.data,t,r,3,n),g._getSheetModel(2).fromJSON(e.rowHeaderData,t,r),g._getSheetModel(1).fromJSON(e.colHeaderData,t,r),g.kj.showCell(e.topCellIndex||0,e.leftCellIndex||0,M.VerticalPosition.top,M.HorizontalPosition.left),g.YTa(!0,3).fromJSON(e.rows),g.YTa(!1,3).fromJSON(e.columns),g.YTa(!1,2).fromJSON(e.rowHeaderColInfos),g.YTa(!0,1).fromJSON(e.colHeaderRowInfos),e&&e.rows)for(o=0,i=Object.keys(e.rows);o<i.length;o++)a=i[o],s=e.rows[a],L(s)||g.zgc({type:M.AxisInfoChangeType.setRowHeight,index:+a});if(e&&e.columns)for(l=0,u=Object.keys(e.columns);l<u.length;l++)a=u[l],s=e.columns[a],L(s)||g.zgc({type:M.AxisInfoChangeType.setColumnWidth,index:+a});r&&r.ignoreStyle||(g.zl(3).fromJSON(e.spans),g.zl(2).fromJSON(e.rowHeaderSpan),g.zl(1).fromJSON(e.colHeaderSpan)),g.selectionModel.fromJSON(e.selections),(c=e.tag)!==F&&(typeof(h=c.typeName)===w&&(!(f=y.getTypeFromString(h))||(c=new f).fromJSON&&c.fromJSON(e.tag)),g.do("setValueForKey",-1,-1,"tag",c,3)),(d=e.defaults)!==F&&((p=g.defaults).colHeaderRowHeight=J(d.colHeaderRowHeight,20),p.colWidth=J(d.colWidth,62),p.rowHeaderColWidth=J(d.rowHeaderColWidth,40),p.rowHeight=J(d.rowHeight,20),p._isExcelDefaultColumnWidth=d._isExcelDefaultColumnWidth)},_e.prototype.startTransaction=function(){0===this.WTa&&(this.zTa=[],this.kj.isEventSuspended()||(this.zTa.events=[]),_e.ao(this,"startTransaction")),this.WTa++},_e.prototype.endTransaction=function(){var e,t;return this.WTa--,0===this.WTa?(_e.ao(this,"endTransaction"),e=this.zTa,this.zTa=F,(t=e.events)&&0===t.length&&delete e.events,e):[]},_e.prototype.dUa=function(){var e=this.zTa;if(e)return e.calc||(e.calc=[]),e.calc},_e.prototype.EIb=function(e,t,r){var n=this.zTa;n&&n.push({type:"setIsValid",value:[e,t,r]})},_e.prototype.FIb=function(e,t,r){var n=this.zTa;n&&n.push({type:"dirtyItem",value:[e,t,r]})},_e.prototype.MIb=function(e){var t,r,n=e.value;!n||(t=this.ZHb.getAnchorCell(n[0],n[1]))&&(r=n[2],t.isValid=r)},_e.prototype.NIb=function(e){var t,r,n,o,i=e.value;i&&(t=i[0],r=i[1],n=i[2],(o=this.ZHb.getAnchorItem(t,r))&&(o.value=n))},_e.prototype.undo=function(e){var t,r,n,o,i,a,s,l,u=[],c=e&&e.events;for(c&&this.YVa(c,!0),t=e.length-1;0<=t;t--)(n=(r=e[t]).type)?"addRows"===n?this.ZTa(r):"addColumns"===n?this._Ta(r):"deleteRows"===n?this.$Ta(r):"deleteColumns"===n?this.aUa(r):"setRowCount"===n?this.bUa(r):"setColumnCount"===n?this.cUa(r):"setZoomFactor"===n?this.fUa(r.value):"updateDirty"===n?(this.gWa(r),u.push(r)):"setName"===n?this.pZa(r.value):"sortRange"===n?this.yxb(r):"setIsValid"===n?this.MIb(r):"dirtyItem"===n&&this.NIb(r):we(this,r);(o=this.kj).Oq={},o.Jq(),(i=0<u.length)&&((a=o.Wu)&&a.suspend(),u.forEach(function(e){o.eyb(e.row,e.col,3,!1)})),(s=e&&e.uVa)&&0<s.length&&(_e.ao(this,"undo",{uVa:s}),delete e.uVa),(l=e&&e.calc)&&l.length&&o.gUa(l),_e.ao(this,"undo",e),i&&(a&&a.resume(!1),o.fyb()),c&&this.YVa(c,!1)},_e.prototype.do=function(e){var t,r,n=[];for(t=1;t<arguments.length;t++)n[t-1]=arguments[t];!e||(r=this[e])&&r.apply(this,n)},_e.prototype._getSheetModel=function(e){return L(e)&&(e=3),this.sheetModels[e]},_e.prototype.dWa=function(e,t,r){L(r)&&(r=3),this.sheetModels[r]=new G(e,t)},_e.prototype.ZVa=function(e){var t=this.zTa,r=t&&t.events;r&&r.push(e)},_e.prototype.YVa=function(e,t){var r,n,o,i,a=this.kj;for(a.OIb=!0,r=e.length-1;0<=r;r--)i=void 0,"cellChanged"!==(o=(n=e[r])[0])||t?"rowChanged"!==o||t?"columnChanged"!==o||t?"zoomChanged"!==o||t?"rowChanging"===o&&t?i=a.pCb:"columnChanging"===o&&t?i=a.qCb:"tableRowsChanged"!==o||t?"tableColumnsChanged"!==o||t?"rangeChanged"!==o||t||(i=a.RIb):i=a.QIb:i=a.PIb:i=a.gyb:i=a.pq:i=a.kq:i=a.Bq,i&&([].splice.call(e,r,1),i.apply(a,[].slice.call(n,1)));a.OIb=!1},_e.prototype.getValue=function(e,t,r,n,o){if(L(r)&&(r=3),!n){var i={row:e,col:t,sheetArea:r,isValueGet:!1,value:F};if(_e.ao(this,"getValue",i,function(){return i.isValueGet}),i.isValueGet)return i.value}return this._getSheetModel(r).getValue(e,t,o)},_e.prototype.setValue=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g;L(n)&&(n=3),u=(l=this).kj,(c=!i&&!u.isEventSuspended())&&(s=u.getValue(e,t,n,1)),h=!1,R&&u.getCalcService().allowDynamicArray&&!l.SIb&&3===n&&(l.LIb.push(l.ZHb.updateItem(u.yj(),e,t,r)),h=!0),f=!1,o||(d={row:e,col:t,value:r,sheetArea:n,isValueSet:!1,changes:l.zTa},_e.ao(l,"setValue",d,function(){return d.isValueSet}),f=d.isValueSet),f||(g=p=void 0,0<l.WTa&&!a&&(p=[["sheetModels",n],F],g={sheetArea:n}),l._getSheetModel(n).setValue(e,t,r,p,g),p&&0<p.length&&l.zTa.push(p),g&&g.type&&l.zTa.push(g),u.fyb()),c&&s!==r&&u.Bq("value",e,t,n,s,r),h&&l.applyDynamicChanges()},_e.prototype.applyDynamicChanges=function(){var e,t,r,n,o,i=this.LIb,a=this.kj;if(!this.SIb&&i.length){for(this.SIb=!0,e=a.yj(),t=a.Bj(),r=0,n=i;r<n.length;r++)(o=n[r])&&(E.setSpillValues(o[0],e),E.markAnchorCellDirty(o[1],t,this.ZHb));i.length=0,this.SIb=!1}},_e.prototype.getDynamicArrayInfo=function(e,t){return this.ZHb.getAnchorInfo(e,t)},_e.prototype.getStyle=function(e,t,r){return this._getSheetModel(r).getStyle(e,t,0<this.WTa)},_e.prototype.setStyle=function(e,t,r,n){L(n)&&(n=3);var o=0<this.WTa?[["sheetModels",n],F]:F;this._getSheetModel(n).setStyle(e,t,r,o),o&&0<o.length&&this.zTa.push(o)},_e.prototype.getValueForKey=function(e,t,r,n){return this._getSheetModel(n).getValueForKey(e,t,r)},_e.prototype.setValueForKey=function(e,t,r,n,o){L(o)&&(o=3);var i=0<this.WTa?[["sheetModels",o],F]:F;this._getSheetModel(o).setValueForKey(e,t,r,n,i),i&&0<i.length&&this.zTa.push(i)},_e.prototype.clear=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C;if(L(a)&&(a=3),s=0<this.WTa?[]:F,l=!1,R&&!this.SIb&&3===a){for(u=this.kj.yj(),c=this.LIb,h=this.ZHb,f={},d=[],p=0;p<r;p++)for(g=0;g<n;g++)h.updateItem(u,e+p,t+g,N,f,d);c.push([f,d]),l=!0}if(this._getSheetModel(a).clear(e,t,r,n,o,i,s),_e.ao(this,"clear",{row:e,col:t,rowCount:r,colCount:n,type:o,ignoredRowList:i,sheetArea:a,changes:this.zTa}),s)for(m=["sheetModels",a],b=0,y=s.length;b<y;b++)(C=s[b])[0]=m.concat(C[0]),this.zTa.push(C);l&&this.applyDynamicChanges()},_e.prototype.swapNode=function(e,t,r,n,o){var i,a,s,l,u;if(L(o)&&(o=3),i=0<this.WTa?[]:F,this._getSheetModel(o)._f(e,t,r,n,i),i)for(a=["sheetModels",o],s=0,l=i.length;s<l;s++)(u=i[s])[0]=a.concat(u[0]),this.zTa.push(u)},_e.prototype.Cp=function(e,t,r,n){var o;0<this.WTa&&(o={sheetArea:n},L(n)&&(o.sheetArea=3)),this._getSheetModel(n).Cp(e,t,r,o),o&&this.zTa.push(o)},_e.prototype.gWa=function(e){this._getSheetModel(e.sheetArea).gWa(e)},_e.prototype.hUa=function(e){return this._getSheetModel(e).Ap},_e.prototype.iUa=function(e){this._getSheetModel(e).Ap={}},_e.prototype.Lec=function(e,t,r,n){var o,i,a,s=this.hUa();if(s)for(o in s)Q(s,o)&&(i=s[o],a=parseInt(o,10),i&&"n"===i.rs&&(e||t&&r<=a&&a<r+n)&&(s[o]={}))},_e.prototype.Mec=function(i,e,a,t,s){var r,n,o,l,u,c,h=this.hUa(),f=this.kj,d=f.tables;if(!I(h)){if(r=[],0<=e)for(n=e;n<e+t;n++)r.push(n);else for(o in h)Q(h,o)&&r.push(parseInt(o,10));l=[],u=[],d&&(l=d.Nec(e,a,t,s),u=d.Oec(e,a,t,s),0<l.length&&_e.ao(this,"clearPendingChanges",{tableList:l})),p(r,function(e,t){var r,n,o;if((c=h[t])&&"e"===c.rs)if(r=u.length,i)if(d&&0!==r&&d.Pec(u,t,-1))for(n=f.getColumnCount(),o=0;o<n;o++)d&&0!==r&&d.Pec(u,t,o)||c[o]&&delete c[o];else h[t]={};else for(o=a;o<a+s;o++)d&&0!==r&&d.Pec(u,t,o)||c[o]&&delete c[o]})}},_e.prototype.Qec=function(){var e,t=this.hUa();for(e in t)Q(t,e)&&"e"===t[e].rs&&(t[e]={})},_e.prototype.jUa=function(e){this._getSheetModel(e).gga++},_e.prototype.kUa=function(e){var t=this._getSheetModel(e);t.gga--,t.gga<0&&(t.gga=0)},_e.prototype.getName=function(){return this.name||""},_e.prototype.setName=function(e){0<this.WTa&&this.zTa.push({type:"setName",value:this.name}),this.name=e},_e.prototype.TIb=function(){return this.isSelected},_e.prototype.CHb=function(e){this.isSelected=e},_e.prototype.pZa=function(e){this.kj.name(e)},_e.prototype.yxb=function(e){var r,n=[];r=e.byRows?e.row:e.column,e.array.map(function(e,t){n[e-r]=t+r}),this.kj.sortRange(e.row,e.column,e.rowCount,e.columnCount,e.byRows,e.sortInfo,N,n)},_e.prototype.getZoomFactor=function(){return this.zoomFactor},_e.prototype.setZoomFactor=function(e){0<this.WTa&&this.zTa.push({type:"setZoomFactor",value:this.zoomFactor}),this.zoomFactor=e},_e.prototype.fUa=function(e){this.kj.zoom(e)},_e.prototype.zl=function(e){return L(e)&&(e=3),this.spanModels[e]},_e.prototype.eWa=function(e){L(e)&&(e=3),this.spanModels[e]=new k},_e.prototype.getSpans=function(e,t,r){var n=this.zl(t).getSpans(e);return r&&(n=n.filter(function(e){return!e.isAutoMerge})),n},_e.prototype.getSpan=function(e,t,r){return this.zl(r).get(e,t)},_e.prototype.uIb=function(e,t,r){var n,o;return L(r)&&(r=3),(n=this._getSheetModel(r))&&n.RTa&&(o=n.RTa(e,t))&&o.tipContent?o.tipContent:null},_e.prototype.qHb=function(e,t,r,n){L(n)&&(n=3);var o=this._getSheetModel(n).RTa(e,t);!r&&o?delete o.tipContent:r&&o?o.tipContent=r:r&&!o&&((o=this._getSheetModel(n).RTa(e,t,!0)).tipContent=r)},_e.prototype.MTa=function(e,t,r,n,o){return this.zl(o).MTa(e,t,r,n)},_e.prototype.qu=function(e,t,r,n,o){return this.zl(o).qu(e,t,r,n)},_e.prototype.findSpan=function(e,t,r){return this.zl(r).find(e,t)},_e.prototype.removeSpan=function(e,t){L(t)&&(t=3);var r=0<this.WTa?[["spanModels",t],F]:F;this.zl(t).remove(e,r),r&&0<r.length&&this.zTa.push(r)},_e.prototype.addSpan=function(e,t){L(t)&&(t=3);var r=0<this.WTa?[["spanModels",t],F]:F;this.zl(t).add(e,r),r&&0<r.length&&this.zTa.push(r)},_e.prototype.clearSpan=function(e,t,r,n,o){L(o)&&(o=3);var i=0<this.WTa?[["spanModels",o],F]:F;this.zl(o).$b(e,t,r,n,i),i&&0<i.length&&this.zTa.push(i)},_e.prototype.moveSpan=function(e,t,r,n,o,i,a){L(a)&&(a=3);var s=0<this.WTa?[["spanModels",a],F]:F;this.zl(a).aB(e,t,r,n,o,i,s),s&&0<s.length&&this.zTa.push(s)},_e.prototype.copySpan=function(e,t,r,n,o,i,a){L(a)&&(a=3);var s=0<this.WTa?[["spanModels",a],F]:F;this.zl(a).Zz(e,t,r,n,o,i,s),s&&0<s.length&&this.zTa.push(s)},_e.prototype.addSelection=function(e,t,r,n){var o,i,a=0<this.WTa?[]:F;if(this.selectionModel.add(e,t,r,n,a),a)for(o=0;o<a.length;o++)(i=a[o])[0]=["selectionModel"].concat(i[0]),this.zTa.push(i)},_e.prototype.getSelections=function(){return this.selectionModel.get()},_e.prototype.setSelections=function(e){var t,r,n=0<this.WTa?[]:F;if(this.selectionModel.set(e,n),n)for(t=0;t<n.length;t++)(r=n[t])[0]=["selectionModel"].concat(r[0]),this.zTa.push(r)},_e.prototype.clearSelection=function(){var e,t,r=0<this.WTa?[]:F;if(this.selectionModel.clear(r),r)for(e=0;e<r.length;e++)(t=r[e])[0]=["selectionModel"].concat(t[0]),this.zTa.push(t)},_e.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},_e.prototype.setActiveSelectedRangeIndex=function(e){var t=0<this.WTa?[["selectionModel"],F]:F;this.selectionModel.setProperty("activeSelectedRangeIndex",e,t),t&&this.zTa.push(t)},_e.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},_e.prototype.setSelectionPolicy=function(e){ve(this,"selectionPolicy",e)},_e.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},_e.prototype.setSelectionUnit=function(e){ve(this,"selectionUnit",e)},_e.prototype.sp=function(e){return this.selectionModel.sp(e)},_e.prototype.tp=function(e){return this.selectionModel.tp(e)},_e.prototype.vp=function(e,t,r,n,o,i){return this.selectionModel.vp(e,t,r,n,o,i)},_e.prototype.wp=function(e,t,r,n,o){return this.selectionModel.wp(e,t,r,n,o)},_e.prototype.YTa=function(e,t){return L(t)&&(t=3),(e?this.rowInfos:this.colInfos)[t]},_e.prototype.fWa=function(e,t){L(t)&&(t=3),(e?this.rowInfos:this.colInfos)[t]=new U},_e.prototype.getPageBreak=function(e,t,r){return this.YTa(e,t).getPageBreak(r)},_e.prototype.setPageBreak=function(e,t,r,n){var o;L(t)&&(t=3),o=0<this.WTa?[[e?d:g,t],F]:F,this.YTa(e,t).setPageBreak(r,n,o),o&&this.zTa.push(o)},_e.prototype.getVisible=function(e,t,r){return this.YTa(e,t).getVisible(r)},_e.prototype.setVisible=function(e,t,r,n){var o,i;L(t)&&(t=3),o=0<this.WTa?[[e?d:g,t],F]:F,this.YTa(e,t).setVisible(r,n,o),o&&this.zTa.push(o),i=e?M.AxisInfoChangeType.setRowVisible:M.AxisInfoChangeType.setColumnVisible,this.zgc({type:i,index:r,sheetArea:t})},_e.prototype.getResizable=function(e,t,r){return this.YTa(e,t).getResizable(r)},_e.prototype.setResizable=function(e,t,r,n){var o;L(t)&&(t=3),o=0<this.WTa?[[e?d:g,t],F]:F,this.YTa(e,t).setResizable(r,n,o),o&&this.zTa.push(o)},_e.prototype.getSize=function(e,t,r){return this.YTa(e,t).getSize(r)},_e.prototype.getStarSize=function(e,t,r){return this.YTa(e,t).getStarSize(r)},_e.prototype.getActualSize=function(e,t,r){return this.YTa(e,t).getActualSize(r)},_e.prototype.setSize=function(e,t,r,n){var o,i;L(t)&&(t=3),o=0<this.WTa?[[e?d:g,t],F]:F,this.YTa(e,t).setSize(r,n,o),o&&this.zTa.push(o),this.setStarSize(e,t,r,N),i=e?M.AxisInfoChangeType.setRowHeight:M.AxisInfoChangeType.setColumnWidth,this.zgc({type:i,index:r,value:n,sheetArea:t})},_e.prototype.setStarSize=function(e,t,r,n){var o;L(t)&&(t=3),o=0<this.WTa?[[e?d:g,t],F]:F,this.YTa(e,t).setStarSize(r,n,o),o&&!L(o[1])&&this.zTa.push(o)},_e.prototype.VTa=function(e,t){return this.YTa(e,t).VTa()},_e.prototype.Hp=function(e,t){return this.YTa(e,t).Hp()},_e.prototype.Jp=function(e,t,r){return this.YTa(e,t).Jp(r)},_e.prototype.setItem=function(e,t,r,n){var o,i;L(t)&&(t=3),o=0<this.WTa?[[e?d:g,t],F]:F,this.YTa(e,t).Kp(r,n,o),n&&(L(n.size)||(i=e?M.AxisInfoChangeType.setRowHeight:M.AxisInfoChangeType.setColumnWidth,this.zgc({type:i,index:r,value:n.size,sheetArea:t})),L(n.visible)||(i=e?M.AxisInfoChangeType.setRowVisible:M.AxisInfoChangeType.setColumnVisible,this.zgc({type:i,index:r,sheetArea:t}))),o&&this.zTa.push(o)},z=_e,t.lUa=z,T.Zn(z)},"./dist/core/worksheet/worksheet-render.js":function(e,t,be){"use strict";var r,ye,V,n,D,Ce,N,we,ve,F,z,q,Se,xe,T,o,Z,Y,A,k,M,I,E,R,_,C,P,s,g,L,Te,i,l,h,f,d,p,m,b,y,w,v,S,a;function Ae(e){return e.height}function ke(e){return e.width}function x(e,t,r,n,o,i,a){e.beginPath(),e.lineWidth=t,e.strokeStyle=r,e.moveTo(n,o),e.lineTo(i,a),e.stroke()}function O(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w=o.zoom(),v=r.font,S=r.textIndent,x=r.textOrientation,T=r.isVerticalText,A=r.textIndent&&0!==r.textIndent,k=0!==x&&!xe(x);return v=v?Z(v,w).font:n,c=0,c=e&&e.richText?(function(e,t,r){var n,o,i,a,s;for(n=0,o=e;n<o.length;n++)(i=o[n]).style=i.style||{},s=i.style,a=s.font?Z(s.font,r).font:t,s.font=a}(y=e.richText,C=v,w),V.Vn.R_a(y,C,1)):e&&k&&!T&&!A?(s=M(x*Math.PI/180),l=I(s),u=E(s),r.wordWrap?(h=o.ss.Sl(i),V.Vn.mHb(i,a,l,u,t,v,h)):(f=z(v),V.Vn.Xn(t,v)*u+f*l)):V.Vn.Xn(t,v),(c+=function(e,t,r,n){if(!xe(r)&&!xe(n)&&e.outlineColumn){var o=e.outlineColumn.LRa(r,n);if(o)return o}return t?8*t:0}(o,S,i,a)+L)+(d=r.cellPadding,p=w,b=0,"string"==typeof d&&(1===(m=(g=d.split(" ",4)).length)?b=2*P(g[0]):2===m||3===m?b=2*P(g[1]):4===m&&(b=P(g[1])+P(g[3]))),b*p)}function u(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b,y,C,w,v,S,x;if(T(o.data)&&e.parent&&e.parent.options.numbersFitMode!==N.NumbersFitMode.overflow)return Y;if(u=e.ss,c=ke(o),h=ke(o),d=o.style,g=o.text,y=d.watermark,C=d.wordWrap,w=d.textOrientation,v=e.options.allowCellOverflow,t.findCell(i,a))return Y;if(d.cellButtons&&0<d.cellButtons.length)return Y;if(!(d.cellType||r).allowOverflow||!g&&!y||!w&&C&&e.parent&&e.parent.options.numbersFitMode!==N.NumbersFitMode.overflow)return Y;if(g=g||y,!v&&!w)return Y;if((m=O(o.data,g,d,n,e,i,a))<=h)return Y;for(p=(x=S=a)+(l?1:-1);(l?p<=s:s<=p)&&!t.findCell(i,p)&&(b=u.Ym(i,p),f=u.zHb(i,p,3,1,b),b.textOrientation||xe(f))&&!b.watermark&&!(b.cellType&&"1"!==b.cellType.typeName||b.cellButtons&&0<b.cellButtons.length)&&(l?x=p:S=p,!(m<=(h+=u._m(p))));p+=l?1:-1);return l&&x===a||!l&&S===a?Y:new D.op(a,S,x,m,c,h,l?-1:h,l?h:-1)}function c(e,t,r){this.kj=e,this.pJ=e.Hr(r),this.qJ=e.Ir(t,r,N.SheetArea.viewport,!0),this.yI=Z(e._render.Bl(),e.zoom()).font,this.Rq=e.Al(),this.rJ={}}function B(e){var t=e.parent,r={nps:!0};return ye.Worksheet.ao(e,"needPaintSelection",r),(V.Vl.Wl(e)||t&&!t.options.hideSelection)&&r.nps}function K(e){var t=e.parent;return t&&t.options.backColor||"white"}function j(e){this.yJ=!1,this.zJ=!1,this.kj=e,this.AJ()}function H(e){this.kj=e}Object.defineProperty(t,"__esModule",{value:!0}),r=be("@grapecity/js-sheets-common"),ye=be("./dist/core/worksheet/worksheet.js"),V=be("./dist/core/util/common.js"),n=be("./dist/core/worksheet/stylehelper.js"),D=be("./dist/core/worksheet/worksheet-model.js"),Ce=be("./dist/core/worksheet/worksheet-border.js"),N=be("./dist/core/core.enum.js"),we=function(e){return e.getSparkline},ve=r.Common.k,F=V.Ul.ol,z=V.Ul.fp,q=V.Ul.lZa,Se=V.Ul.lHb,xe=r.Common.j.Fa,T=V.Ul.Fxb,o=n.Ho,Z=n.To.No,Y=null,A=Math.min,k=Math.max,M=Math.abs,I=Math.sin,E=Math.cos,R=Math.tan,_=Math.floor,C=Math.round,P=parseInt,s="transparent",g="columnHeader",L=2,c.prototype.nJ=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E=this,R=E.rJ[e];if(R)return R;if(n=(r=E.kj).ss,i=(o=E.pJ).length,b=new D.np,t=t||V.Vn.bm(),0<i){for(b.headingOverflowlayouts=E.sJ(e,t),C=o[0].col,w=o[i-1].col,v=0;v<i;v++)ke(u=o[v])<=0||(c=u.col,h=n.Ym(e,c),f=n.zHb(e,c,3,1),a=h.textOrientation,s=h.isVerticalText,l=h.textIndent&&0!==h.textIndent,S=h&&(h.borderLeft||h.borderTop||h.borderRight||h.borderBottom),xe(f)&&!h.watermark||h.shrinkToFit||!a&&h.wordWrap&&r.parent&&r.parent.options.numbersFitMode===N.NumbersFitMode.mask||s||(x=r.conditionalFormats)&&(A=(T=x.oRa(r,e,c,f)).dataBar,k=T.iconSet,A&&A.showBarOnly||k&&k.showIconOnly)||(d=n._m(c),p=n.Sl(e),M=h.cellType||E.Rq,I={},m=V.mn.vn(r,h,f,I,{row:e,col:c,sheet:r}),I.content&&0<I.content.length&&!h.shrinkToFit&&a&&(m=M.sHb(t,I.content,p-4,h.font)),3===(g=h.hAlign)&&(g=F(g,f,h.formatter,a)),S&&a&&!s&&!l?a<0&&-90<a?(y=E.UIb({data:f,style:h,width:d,text:m},e,c,C))&&b.push(y):0<a&&a<90&&(y=E.UIb({data:f,style:h,width:d,text:m},e,c,w,!0))&&b.push(y):0===g?(y=E.tJ({data:f,style:h,width:d,text:m},e,c,w))&&b.push(y):2===g?(y=E.uJ({data:f,style:h,width:d,text:m},e,c,C))&&b.push(y):1===g&&(y=E.vJ({data:f,style:h,width:d,text:m},e,c,C,w))&&b.push(y)));b.trailingOverflowLayouts=E.wJ(e,t)}return E.rJ[e]=b},c.prototype.tJ=function(e,t,r,n){return u(this.kj,this.qJ,this.Rq,this.yI,e,t,r,n,!0)},c.prototype.uJ=function(e,t,r,n){return u(this.kj,this.qJ,this.Rq,this.yI,e,t,r,n)},c.prototype.UIb=function(e,t,r,n,o){var i,a,s,l,u,c=this.kj,h=this.qJ,f=this.Rq,d=this.yI,p=c.ss,g=ke(e),m=ke(e),b=e.style,y=e.text,C=b.watermark,w=b.wordWrap,v=b.textOrientation,S=b&&(b.borderLeft||b.borderTop||b.borderRight||b.borderBottom),x=b.isVerticalText,T=b.textIndent&&0!==b.textIndent,A=c.options.allowCellOverflow;if(h.findCell(t,r))return Y;if(b.cellButtons&&0<b.cellButtons.length)return Y;if(!(b.cellType||f).allowOverflow||!y&&!C||!v&&w)return Y;if(y=y||C,!A&&!v)return Y;if((a=!S||x||T?O(e.data,y,b,d,c,t,r):function(e,t,r){if(e&&-90<=e&&e<=90)return _(r/R(M(e*Math.PI/180)))+t+4}(v,p._m(r),p.Sl(t)))<=m)return Y;for(i=(u=l=r)+(o?1:-1);!(!(o?i<=n:n<=i)||h.findCell(t,i)||(s=p.Ym(t,i)).watermark||s.cellType&&"1"!==s.cellType.typeName||s.cellButtons&&0<s.cellButtons.length||(o?u=i:l=i,a<=(m+=p._m(i))));i+=o?1:-1);return o&&u===r||!o&&l===r?Y:new D.op(r,l,u,a,g,m,o?-1:m,o?m:-1)},c.prototype.vJ=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x;if(T(e.data)&&this.kj.parent&&this.kj.parent.options.numbersFitMode!==N.NumbersFitMode.overflow)return Y;if(a=(i=this.kj).ss,s=this.qJ,l=ke(e),u=ke(e),h=e.style,d=e.text,m=h.textOrientation,b=h.watermark,y=h.wordWrap,C=i.options.allowCellOverflow,s.findCell(t,r))return Y;if(h.cellButtons&&0<h.cellButtons.length)return Y;if(!(h.cellType||this.Rq).allowOverflow||!d&&!b||!m&&y&&i.parent&&i.parent.options.numbersFitMode!==N.NumbersFitMode.overflow)return Y;if(d=d||b,!C&&!m)return Y;if((p=O(e.data,d,h,this.yI,i,t,r))<=u)return Y;for(v=u/2,f=(w=r)-1;n<=f&&!s.findCell(t,f)&&(g=a.Ym(t,f),c=a.zHb(t,f,3,1,g),g.textOrientation||xe(c))&&!g.watermark&&!(g.cellType&&"1"!==g.cellType.typeName||g.cellButtons&&0<g.cellButtons.length)&&(w=f,!(p/2<=(v+=a._m(f))));f--);for(x=u/2,f=(S=r)+1;f<=o&&!s.findCell(t,f)&&(g=a.Ym(t,f),c=a.zHb(t,f,3,1,g),g.textOrientation||xe(c))&&!g.watermark&&!(g.cellType&&"1"!==g.cellType.typeName||g.cellButtons&&0<g.cellButtons.length)&&(S=f,!(p/2<=(x+=a._m(f))));f++);return w===S?Y:new D.op(r,w,S,p,l,v+x,v,x)},c.prototype.sJ=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p=this.kj,g=p.ss,m=this.pJ,b=m[0].col,y=m[m.length-1].col,C=p._modelManager,w=[];for(d=1;d<100;d++){if((s=b-d)<0)return w;if(C.findSpan(e,s)||p.mJb&&p.mJb.oJb(e,s,N.SheetArea.viewport))return w;n=g.zHb(e,s,3,1),0<(o=g._m(s))&&!xe(n)&&(3===(a=(r=g.Ym(e,s)).hAlign)&&(a=F(a,n,void 0,r.textOrientation)),i=g.Sl(e),h=r.cellType||this.Rq,f={},u=V.mn.vn(p,r,n,f,{row:e,col:s,sheet:p}),f.content&&0<f.content.length&&!r.shrinkToFit&&r.textOrientation&&(u=h.sHb(t,f.content,i-4,r.font)),c={data:n,style:r,width:o,text:u},0<r.textOrientation&&r.textOrientation<90?l=this.UIb(c,e,s,y,!0):0===a?l=this.tJ(c,e,s,y):1===a&&(l=this.vJ(c,e,s,b,y)),l&&l.endColumn>=b&&w.push(l))}return w},c.prototype.wJ=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p=this.kj,g=p.ss,m=this.pJ,b=m[0].col,y=m[m.length-1].col,C=p._modelManager,w=p.getColumnCount(),v=[];for(d=1;d<100;d++){if(w<=(u=y+d))return v;if(C.findSpan(e,u)||p.mJb&&p.mJb.oJb(e,u,N.SheetArea.viewport))return v;n=g.zHb(e,u,3,1),0<(o=g._m(u))&&!xe(n)&&(3===(a=(r=g.Ym(e,u)).hAlign)&&(a=F(a,n,void 0,r.textOrientation)),i=g.Sl(e),s=r.cellType||this.Rq,l={},h=V.mn.vn(p,r,n,l,{row:e,col:u,sheet:p}),l.content&&0<l.content.length&&!r.shrinkToFit&&r.textOrientation&&(h=s.sHb(t,l.content,i-4,r.font)),f={data:n,style:r,width:o,text:h},r.textOrientation<0&&-90<r.textOrientation?c=this.UIb(f,e,u,b,!1):2===a?c=this.uJ(f,e,u,b):1===a&&(c=this.vJ(f,e,u,b,y)),c&&c.startColumn<=y&&v.push(c))}return v},Te=c,t.xJ=Te,t.needPaintSelection=B,H.prototype.bm=function(){var e=this.kj,t=Y,r=e.Ws();return r&&r.getContext&&(t=r.getContext("2d")),t},H.prototype.vI=function(){var e,t=this.kj,r=t.Dr(),n=t.Xs,o=ke(n),i=Ae(n),a=this.wI;return a&&ke(a)===o&&Ae(a)===i||(a&&V.En.Qn(t,a),this.wI=a=V.Ul.Nl("canvas"),a.getContext&&(this.xI=a.getContext("2d"),V.En.Kn(a,Y,t),V.En.Pn(a,ke(r),Ae(r)))),(e=this.xI)&&(e.beginPath(),q(e,this.Cl(this.Bl())),e.name="bufferContext"),e},H.prototype.Bl=function(){return this.yI||(this.yI=o+" "+this.kj.currentTheme().bodyFont()),this.yI},H.prototype.us=function(){this.yI=Y},H.prototype.zI=function(e){var t=this.kj,r=t.parent,n=r?r.options.grayAreaBackColor||V.Im.Mm("gc-grayArea").backgroundColor:"gray",o=V.Rm.Om(t,n);return e&&(r?r.options.backgroundImage:Y)&&(o=s),o},H.prototype.Cl=function(e){var t=this.kj.zoom();return 1===t?e:Z(e,t).font},H.prototype.Mx=function(e,t,r,n,o){var i,a,s,l,u,c=this.wI,h=this.bm();r<=0||n<=0||!c||!h||(o=o||this.kj.Dr(),i=V.En.Ln(c),a=V.En.Mn(c),1!==i&&(e*=i,t*=a,r*=i,n*=a,o=new V.Rect(o.x*i,o.y*a,ke(o)*i,Ae(o)*a)),(s=o.getIntersect(e,t,r,n))&&(s.round(),e=s.x,t=s.y,r=ke(s),n=Ae(s),(l=ke(c))&&l<e+r&&(e=l-r)<0&&(r+=e,e=0),(u=Ae(c))&&u<t+n&&(t=u-n)<0&&(n+=t,t=0),V.Bn.Cn(h,1,1),h.clearRect(e,t,r,n),h.drawImage(c,e,t,r,n,e,t,r,n),V.Bn.Cn(h,i,a)))},H.prototype.dm=function(e,t){e&&this.Mx(e.x,e.y,ke(e),Ae(e),t)},H.prototype.Ow=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y;if(0<r&&0<n)try{a=this.kj,s=this.bm(),l=a.Ws(),u=this.vI(),c=this.wI,h=o,f=i,d=r,p=n,g=V.En.Ln(l),m=V.En.Mn(l),e=C(e*g),t=C(t*m),r=C(r*g),n=C(n*m),h=C(h*g),f=C(f*m),d=C(d*g),p=C(p*m),b=ke(c),y=Ae(c),b&&b<e+r&&(e=b-r)<0&&(r+=e,e=0),y&&y<t+n&&(t=y-n)<0&&(n+=t,t=0),b&&b<h+d&&(h=b-d)<0&&(d+=h,h=0),y&&y<f+p&&(f=y-p)<0&&(p+=f,f=0),V.Bn.Cn(s,1,1),V.Bn.Cn(u,1,1),s.clearRect(h,f,d,p),s.drawImage(c,e,t,r,n,h,f,d,p),u.clearRect(h,f,d,p),u.drawImage(l,h,f,d,p,h,f,d,p),V.Bn.Cn(s,g,m),V.Bn.Cn(u,g,m)}catch(e){}},H.prototype.im=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x;if(r=r||this.bm(),o=!1,i=this.kj,a=V.kf(-1,-1,-1,-1),s=i.Hx,l=i._modelManager,e&&(a=i.options.allowCellOverflow?V.kf(e.row,0,e.rowCount,i.getColumnCount()):V.kf(e.row,e.col,e.rowCount,e.colCount),!s)){if(0<=a.col){for(c=a.col,h=a.col+a.colCount-1,f=i.getRowCount(1),d=0;d<f;d++)(u=l.findSpan(d,a.col,1))?c=A(u.col,c):i.p_a&&(c=A(i.p_a.col,c)),(u=l.findSpan(d,a.col+a.colCount-1,1))?h=k(u.col+u.colCount-1,h):i.p_a&&(h=k(i.p_a.col+i.p_a.colCount-1,h));a.col=c,a.colCount=h-c+1}if(0<=a.row){for(p=a.row,g=a.row+a.rowCount-1,m=i.getColumnCount(2),b=0;b<m;b++)(u=l.findSpan(a.row,b,2))?p=A(u.row,p):i.p_a&&(p=A(i.p_a.row,p)),(u=l.findSpan(a.row+a.rowCount-1,b,2))?g=k(u.row+u.rowCount-1,g):i.p_a&&(g=k(i.p_a.row+i.p_a.rowCount-1,g));a.row=p,a.rowCount=g-p+1}}if(y=i.cm(a),i.cellStates&&i.cellStates.hasIntersectInSeletionState(a.row,a.col,a.rowCount,a.colCount)&&i.repaint(y),C=ke(y),w=Ae(y),v=y.x,S=y.y,0<=C||0<=w){if(y.x-=9,y.y-=9,y.width+=18,y.height+=30,t&&!(y=y.getIntersectRect(t)))return;x=i.am(),0<w&&!s&&(i.$l=!0,this.jp(r,new V.Rect(x.x,k(x.nt,S),x.Br,w),n)),0<C&&!s&&(i.$l=!0,this.jp(r,new V.Rect(k(x.kt,v),x.y,C,x.Cr),n)),-1!==a.row||-1!==a.col||s||(i.$l=!0,this.jp(r,x.em(),n)),0<C&&0<w&&this.jp(r,y,n),o=!0}return o},H.prototype.VF=function(e,t,r,n,o){var i,a=this.kj;a.Xq<=0&&(i=this.bm())&&(o||(a.$l=!0),this.jp(i,new V.Rect(e,t,r,n)))},H.prototype.repaint=function(e){var t,r=this.kj;0<r.Xq||(t=this.bm())&&(r.$l=!0,this.jp(t,e))},H.prototype.jp=function(e,t,r){e&&this.kj.Xq<=0&&(r||this._l(e,t),this.Pw(e,t))},H.prototype._l=function(e,t,r){var n,o,i,a=this.kj;e&&a.Xq<=0&&(o=(n=this.vI())||e,i=a.Dr(),(t=t||i)&&t.round(),r&&r.round(),a.$l&&(a.$l=!1,n&&(n.clearRect(t.x,t.y,ke(t),Ae(t)),r&&n.clearRect(r.x,r.y,ke(r),Ae(r)),V.Bn.Dn(n,-i.x,-i.y)),this.AI(o,t),r&&this.AI(o,r),n&&V.Bn.Dn(n,i.x,i.y)),n&&(this.dm(t),r&&this.dm(r)))},H.prototype.Pw=function(e,t){var r,n,o,i,a,s=this.kj,l=s.CH;if(e&&!(0<s.Xq)&&(t&&t.round(),r=s.am(),ye.Worksheet.ao(s,"beforePaintAdornment",{ctx:e,clipRect:t}),!s.fI)){if(l){for(n=r.em(),this.dm(n),i=0;i<=2;i++)(n=r.fm(i))&&0!==ke(n)&&0!==Ae(n)&&this.dm(n);for(a=0;a<=2;a++)(n=r.gm(a))&&0!==ke(n)&&0!==Ae(n)&&this.dm(n)}for(i=0;i<=2;i++)for(a=0;a<=2;a++)(n=r.Ft(i,a))&&0!==ke(n)&&0!==Ae(n)&&(o=t,(l&&(1!==i||1!==a)||s.parent&&s.parent.options.allowUserDragMerge)&&(this.dm(n),o=n),o&&!n.intersectRect(o)||this.BI(e,i,a,o));this.CI(e),ye.Worksheet.ao(s,"paintAdornment",{ctx:e,clipRect:t})}},H.prototype.dD=function(e,t){var r=this.kj,n=r.parent,o=n?n.options:{},i=K(r),a=V.Rm.Om(r,i);o.backgroundImage&&(a=s),e.save(),e.fillStyle=a,e.fillRect(t.x,t.y,ke(t),Ae(t)),e.restore()},H.prototype.z0a=function(e){var t=this.kj;return 0===t.am().Cr&&e===t.ar(3)},H.prototype.A0a=function(e){var t=this.kj;return 0===t.am().Br&&e===t.$q(3)},H.prototype.DI=function(e,t,r){var n,o,i,a,s,l,u,c=this.kj,h=c.options,f=c.am(),d=h.sheetAreaOffset.top,p=h.sheetAreaOffset.left,g=0!==f.Cr,m=0!==f.Br,b=c.Gt&&c.Gt()||{x:h.sheetAreaOffset.left,y:h.sheetAreaOffset.top,width:0,height:0},y=0===b.width,C=0===b.height;for(o=0;o<=2;o++)(a=f.gm(o))&&(g&&C&&(a.y=a.y-d,a.height=a.height+d,!m&&y&&(a.x=a.x-p,a.width=a.width+p)),(i=t?a.getIntersectRect(t):a)&&this.EI(e,o,i,r));for(n=0;n<=2;n++)for((s=f.fm(n))&&(m&&y&&(s.x=s.x-p,s.width=s.width+p,!g&&C&&(s.y=s.y-d,s.height=s.height+d)),(i=t?s.getIntersectRect(t):s)&&this.FI(e,n,i,r)),o=0;o<=2;o++)l=f.Ft(n,o),this.z0a(c.jCb(n))&&C&&(l.y=l.y-d,l.height=l.height+d),this.A0a(c.kCb(o))&&y&&(l.x=l.x-p,l.width=l.width+p),l&&(i=t?l.getIntersectRect(t):l)&&this.GI(e,n,o,i,r);!(u=f.em())||(i=t?u.getIntersectRect(t):u)&&this.HI(e,i,r)},H.prototype.II=function(e){var t,r,n,o,i,a=this.kj,s=a.am(),l=s.zr,u=s.Ar,c=s.lt,h=s.ot,f=ke(s),d=Ae(s),p=s.qt,g=s.pt,m=0,b=a.Gr(1);0<b.length?(m=r=(t=b[b.length-1]).y+Ae(t))<h&&(e.fillStyle=this.zI(!1),e.fillRect(l,r,f,h-r)):0===b.length&&(e.fillStyle=this.zI(!1),e.fillRect(l,p,f,h-p),m=p),0<(n=a.Hr(1)).length?(i=(o=n[n.length-1]).x+ke(o))<c&&(e.fillStyle=this.zI(!1),e.fillRect(i,u,c-i,m),e.fillRect(i,h,c-i,d-h)):0===n.length&&(e.fillStyle=this.zI(!1),e.fillRect(g,u,c-g,m),e.fillRect(g,h,c-g,d-m))},H.prototype.B0a=function(e,t){var r=this.kj,n=this.zI(!1),o=r.options,i=o.sheetAreaOffset.left,a=o.sheetAreaOffset.top,s=t.x,l=t.y,u=ke(t),c=Ae(t);e.save(),0<i&&x(e,i,n,s+i/2,0<a?l+a:l,s+i/2,l+k(0,c)),0<a&&x(e,a,n,0<i?s+i:s,l+a/2,s+k(0,u),l+a/2),0<i&&0<a&&(e.fillStyle=this.zI(!1),e.fillRect(s,l,i,a)),e.beginPath(),e.restore()},H.prototype.AI=function(e,t){var r,n=this.kj;!e||0<n.Xq||(r=n.Dr(),e.save(),t?e.rect(t.x,t.y,ke(t),Ae(t)):e.rect(r.x,r.y,ke(r),Ae(r)),e.clip(),e.beginPath(),this.dD(e,r),ye.Worksheet.ao(n,"paint",{ctx:e,clipRect:t}),this.B0a(e,r),this.DI(e,t,!1),this.II(e),this.KI(e),ye.Worksheet.ao(n,"paintSheetEnd",{ctx:e,clipRect:t}),e.beginPath(),e.restore())},H.prototype.LI=function(e,t){var r,n,o=this.kj;e&&(r=o.Dr(),e.save(),n=t||new V.Rect(r.x,r.y,ke(r),Ae(r)),e.rect(n.x,n.y,ke(n),Ae(n)),e.clip(),e.beginPath(),this.dD(e,r),this.DI(e,n,!0),e.beginPath(),e.restore())},H.prototype.CI=function(e){var t,r,n,o,i,a,s,l,u=this.kj,c=u._eventHandler,h=u.yt;if(c&&c.isResizing&&h&&(s=h.resizeInfo)){if(l=u.am(),e.save(),"black"!==e.strokeStyle&&(e.strokeStyle="black"),1!==e.lineWidth&&(e.lineWidth=1),e.beginPath(),"sizeRow"===s.action||"sizeHiddenRow"===s.action)for(r=k(0,s.startY-.5),o=s.movingY-.5,i=l.x+ke(l),t=l.x;t<i;t+=2)e.moveTo(t,r),e.lineTo(t+1,r),e.moveTo(t,o),e.lineTo(t+1,o);else for(t=k(0,s.startX-.5),n=s.movingX-.5,a=l.y+Ae(l),r=l.y;r<a;r+=2)e.moveTo(t,r),e.lineTo(t,r+1),e.moveTo(n,r),e.lineTo(n,r+1);e.stroke(),e.beginPath(),e.restore()}},H.prototype.HI=function(e,t,r){var n,o,i,a,s,l,u,c=this.kj;e.beginPath(),o=(n=c.am().em()).x,i=n.y,a=ke(n),s=Ae(n),l=c.getActualStyle(-1,-1,0),this.SI(e,[{data:Y,row:-1,col:-1,x:o,y:i,width:a,height:s,style:l.clone()}],0,r),(u=new Ce.AF(c,c.Gr(0,0),c.Hr(0,0),0)).jF(0,0,o,i,a,s),u.paint(e)},H.prototype.KI=function(e){var t,r,n,o,i,a,s,l,u,c=this.kj,h=c.frozenRowCount(),f=c.frozenColumnCount(),d=c.frozenTrailingRowCount(),p=c.frozenTrailingColumnCount();(h||f||d||p)&&(r=(t=c.am()).pt,n=t.qt,o=t.lt,i=t.ot,a=t.x,s=t.y,l=ke(t),u=Ae(t),e.save(),e.strokeStyle=V.Rm.Om(c,c.options.frozenlineColor),e.lineWidth=1,e.beginPath(),f&&(e.moveTo(r-.5,s),e.lineTo(r-.5,s+u)),h&&(e.moveTo(a,n-.5),e.lineTo(a+l,n-.5)),p&&(e.moveTo(o-.5,s),e.lineTo(o-.5,s+u)),d&&(e.moveTo(a,i-.5),e.lineTo(a+l,i-.5)),e.stroke(),e.restore())},H.prototype.EI=function(e,t,r,n){this.TI(e,-1,t,1,r,n)},H.prototype.FI=function(e,t,r,n){this.TI(e,t,-1,2,r,n)},H.prototype.GI=function(e,t,r,n,o){var i,a,s,l=this.kj.et;!l||(i=l.getCalcService())&&i.calcOnDemand&&(a=l._source).clearValueCache&&a.clearValueCache(),this.TI(e,t,r,3,n,o),(s=this.kj.at)&&s.UI(e,n,t,r)},H.prototype.VIb=function(e,t,r,n,o){var i,a,s,l=this.kj,u=l.getRangeRect(t,r,V.kf(o.row,o.col,o.rowCount,o.colCount));(u=u.getIntersectRect(l.am().Ft(t,r)))&&(u.round(),i=o.isValid,e.save(),e.lineWidth=1,e.strokeStyle="mediumblue",i||e.setLineDash([6,2]),a=u.x+.5,s=u.y+.5,e.strokeRect(a,s,ke(u),Ae(u)),e.beginPath(),e.restore())},H.prototype.BI=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D=this.kj;if(B(D)){if(!D.addSelection)return;if(s=D._modelManager,l=D._eventHandler,c=(u=s.getSelections()).length,!(n=this.VI(t,r,n)))return;if(h=V.Im.Lm("gc-selection"),2007<(f=P(h.zIndex))&&this.WI(e,t,r,n),(d=s.WIb=s.ZHb.getAnchorInfo(D.getActiveRowIndex(),D.getActiveColumnIndex()))&&this.VIb(e,t,r,n,d),m=void 0,(g=(p=this.XI(t,r,u,n)).length)<=0)return;for(b=this.XI(t,r,[D.p_a],n)[0],y=!1,C=void 0,C=0;C<g;C++)if(m=p[C],!n.containsRect(m)){y=!0;break}if(b&&!n.containsRect(b)&&(y=!0),e.save(),y&&(e.rect(n.x,n.y,ke(n),Ae(n)),e.clip()),e.beginPath(),0<g)for(a=V.Rm.Om(D,D.getSelectionBackColor()),e.fillStyle!==a&&(e.fillStyle=a),i=o=0,2007<f&&(o=1,i=-3),C=0;C<g;C++)m=p[C],e.fillRect(m.x+o,m.y+o,ke(m)+i,Ae(m)+i);D.sgc||(w=D.Jl,v=D.Kl,b&&(w=D.s_a,v=D.t_a),k=A=T=x=void 0,(S=D.getCellRect(w,v,t,r))&&S.intersectRect(n)&&(x=S.x,T=S.y,A=ke(S),k=Ae(S),o=1,i=-2,2007<f&&(i=o=0),this.Mx(x+o,T+o,A+i,k+i),1<c&&(e.strokeStyle="black",e.lineWidth=1,e.strokeRect(x+1.5,T+1.5,A-4,k-4)))),e.restore(),e.save(),e.beginPath(),1===c&&(l&&l.BG&&l.ZI&&l.ZI()&&!l.$I&&(M=l._I&&l._I(),E=ke(I=D.getRangeRect(t,r,M)),R=Ae(I),I&&0<E&&0<R&&(e.fillStyle=h&&h.color,e.fillRect(I.x,I.y,E,R))),m&&0<=ke(m)&&0<=Ae(m)&&(this.YI(n,D,t,r,f),this.aJ(e,t,r,m,n,u[0]))),b&&(e.save(),y&&(e.rect(n.x,n.y,ke(n),Ae(n)),e.clip()),e.beginPath(),e.fillStyle="rgba(255,255,255,0.4)",e.fillRect(b.x+o,b.y+o,ke(b)+i,Ae(b)+i),e.fillStyle=a,e.strokeStyle="rgb(124,124,124)",e.lineWidth=1,e.strokeRect(b.x-.5,b.y-.5,ke(b),Ae(b)),e.restore()),e.beginPath(),e.restore()}},H.prototype.YI=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m=t.frozenTrailingRowCount(),b=t.frozenTrailingColumnCount(),y=t.getSelections(),C=t.am(),w=t.getRowCount()-m-1,v=t.getColumnCount()-b-1,S=t.Hr(1,3),x=t.Gr(1,3);1===y.length&&2007<o&&(i=t.frozenRowCount(),a=t.frozenColumnCount(),l=(s=y[0]).row,u=s.col,c=s.rowCount,h=s.colCount,0<i&&(i<=l&&t.gr(l)<i?(e.y-=2,e.height+=2):l+c<=i&&t._q(l+c-1)===t.lq&&(e.height+=2)),0<a&&(a<=u&&t.br(u)<a?(e.x-=2,e.width+=2):u+h<=a&&t.Zq(u+h-1)===t.qq&&(e.width+=2)),0===l&&0===u&&(e.x-=2,e.y-=2,e.width+=2,e.height+=2),-1===l&&(l=0,c=t.getRowCount()),-1===u&&(u=0,h=t.getColumnCount()),d=f=!1,p=x.findRow(w),g=S.findCol(v),p&&p.y+Ae(p)<C.qt+C.jr&&(f=!0),g&&g.x+ke(g)<C.pt+C.er&&(d=!0),f&&l+c-1==w&&(e.height+=2),d&&u+h-1==v&&(e.width+=2))},H.prototype.WI=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D=this.kj,N=D._modelManager.getSelections(),F=D.am(),_=F.kt,P=F.nt,L=N.length,O=0!==F.Cr,B=0!==F.Br;if(!(L<=0)){if(i=(o=N[0]).row,a=o.rowCount,s=o.col,l=o.colCount,-1===i&&(i=0),-1===s&&(s=0),-1===a&&(a=D.getRowCount()),-1===l&&(l=D.getColumnCount()),e.save(),e.beginPath(),e.lineWidth=2,e.strokeStyle=D.getSelectionBorderColor(),u=n.x,c=n.y,h=ke(n),f=Ae(n),d=D.frozenRowCount(),O&&(1!==L||0!==d||D.lq<=i||D.lq>=i+a))for(g=0,m=(p=this.bJ(r)).length;g<m;g++)C=y=0,w=(b=p[g]).x,v=b.x+ke(b),b.x<u+h&&u<b.x+ke(b)&&(1===L&&(0===d&&D.lq===i||0<d&&0===i)&&(y=-1,C=1),b.x<u&&(y=0,w=u),b.x+ke(b)>u+h&&(C=0,v=u+h),e.moveTo(w+y-1,P-1),e.lineTo(v+C,P-1),e.stroke());if(S=D.frozenColumnCount(),B&&(1!==L||0!==S||D.qq<=s||D.qq>=s+l))for(T=0,A=(x=this.cJ(t)).length;T<A;T++)I=M=0,E=(k=x[T]).y,R=k.y+Ae(k),k.y<c+f&&c<k.y+Ae(k)&&(1===L&&(0===S&&D.qq===s||0<S&&0===s)&&(M=-1,I=1),k.y<c&&(M=0,E=c),k.y+Ae(k)>c+f&&(I=0,R=c+f),e.moveTo(_-1,E+M-1),e.lineTo(_-1,R+I),e.stroke());e.beginPath(),e.restore()}},H.prototype.bJ=function(e){var t,r,n,o,i,a,s,l,u,c,h,f=this.kj,d=f._modelManager.getSelections(),p=d.length,g=f.Hr(e),m=[];for(t=0;t<p;t++)(r=d[t])&&(-1===(n=r.col)?(o=f.Hr(0,3),i=f.Hr(1,3),a=f.Hr(2,3),l=s=-1,0<o.length&&(s=o[0].x,l=o[o.length-1].x+o[o.length-1].width-s,m.push(new V.Rect(s,-1,l,-1))),0<i.length&&(s=i[0].x,l=i[i.length-1].x+i[i.length-1].width-s,m.push(new V.Rect(s,-1,l,-1))),0<a.length&&(s=a[0].x,l=a[a.length-1].x+a[a.length-1].width-s,m.push(new V.Rect(s,-1,l,-1)))):g&&(u=g.findCol(n),c=g.findCol(n+r.colCount-1),(u||c)&&((h=new V.Rect(-1,-1,-1,-1)).x=u?u.x:g[0].x,h.width=c?c.x+ke(c)-h.x:g[g.length-1].x+g[g.length-1].width-h.x,m.push(h))));return m},H.prototype.cJ=function(e){var t,r,n,o,i,a,s,l,u,c,h,f=this.kj,d=f._modelManager.getSelections(),p=d.length,g=f.Gr(e),m=[];for(t=0;t<p;t++)(r=d[t])&&(-1===(n=r.row)?(o=f.Gr(0,3),i=f.Gr(1,3),a=f.Gr(2,3),l=s=-1,0<o.length&&(s=o[0].y,l=o[o.length-1].y+o[o.length-1].height-s,m.push(new V.Rect(-1,s,-1,l))),0<i.length&&(s=i[0].y,l=i[i.length-1].y+i[i.length-1].height-s,m.push(new V.Rect(-1,s,-1,l))),0<a.length&&(s=a[0].y,l=a[a.length-1].y+a[a.length-1].height-s,m.push(new V.Rect(-1,s,-1,l)))):g&&(u=g.findRow(n),c=g.findRow(n+r.rowCount-1),(u||c)&&((h=new V.Rect(-1,-1,-1,-1)).y=u?u.y:g[0].y,h.height=c?c.y+Ae(c)-h.y:g[g.length-1].y+g[g.length-1].height-h.y,m.push(h))));return m},H.prototype.aJ=function(e,t,r,n,o,i){var a,s=this.kj,l=s.parent,u=s._eventHandler,c=n.x,h=n.y,f=ke(n),d=Ae(n),p=s.getViewportTopRow(t),g=s.getViewportLeftColumn(r),m=s.getViewportBottomRow(t),b=s.getViewportRightColumn(r),y=0,C=0,w=s.am(),v=0!==w.Cr;0!==w.Br||i.col!==g&&-1!==i.col||(y=2),v||i.row!==p&&-1!==i.row||(C=2),i.row+i.rowCount===m+1&&(o.height=o.height+1),i.col+i.colCount===b+1&&(o.width=o.width+1),0<=f&&0<=d&&(!o||n.intersect(o.x-1,o.y-1,ke(o)+2,Ae(o)+2))&&(e.save(),o&&!o.containsRect(n)&&(e.rect(o.x-y,o.y-C,ke(o),Ae(o)),e.clip()),e.beginPath(),e.strokeStyle=V.Rm.Om(s,s.getSelectionBorderColor()),e.lineWidth=2,0<f&&0<d?(u&&u.BG?2===(a=u.dJ)?(e.moveTo(c+.5,h-.5),e.lineTo(c+f-1,h-.5)):3===a?(e.moveTo(c+.5,h+d-.5),e.lineTo(c+f-1,h+d-.5)):0===a?(e.moveTo(c-.5,h+.5),e.lineTo(c-.5,h+d-1)):1===a&&(e.moveTo(c+f-.5,h+.5),e.lineTo(c+f-.5,h+d-1)):2007<(l&&l.Vv)?e.rect(c-1,h-1,f+1,d+1):e.rect(c-.5,h-.5,f,d),e.stroke(),l&&l.options.allowUserDragFill&&this.eJ&&this.eJ(e,t,r,n,o)):0!==f&&0!==d||e.strokeRect(c-1,h-1,f+1,d+1),e.beginPath(),e.restore())},H.prototype.VI=function(e,t,r){var n,o,i,a,s=this.kj,l=s.am(),u=l.Ft(e,t);return 1===t&&(o=0<(n=s.Hr(t)).length?n[n.length-1]:Y)&&(u.width=A(ke(u),o.x+ke(o)-l.pt)),1===e&&(a=0<(i=s.Gr(e)).length?i[i.length-1]:Y)&&(u.height=A(Ae(u),a.y+Ae(a)-l.qt)),r?r.getIntersect(u.x,u.y,ke(u),Ae(u)):u},H.prototype.XI=function(e,t,r,n){var o,i,a,s,l=this.kj,u=l._modelManager,c=r.length,h=[];for(s=0;s<c;s++)(i=r[s])&&((o=u.findSpan(i.row,i.col))&&o.containsRange(i)&&(i=o),(a=l.getRangeRect(e,t,i))&&a.x<=n.x+ke(n)&&a.y<=n.y+Ae(n)&&n.x<=a.x+ke(a)&&n.y<=a.y+Ae(a)&&h.push(a));return h},H.prototype.fJ=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d;if(e.save(),n=t.x,o=t.y,i=ke(t),a=Ae(t),s=[6,6],e.setLineDash)e.beginPath(),e.lineWidth=2,e.strokeStyle=r,e.setLineDash(s),e.rect(n,o,i-1,a-1),e.stroke();else{for(e.beginPath(),e.lineWidth=2,e.strokeStyle=r,l=s[0],u=s[1],d=f=h=c=void 0,c=n,h=o,f=i;0<f;)if(l+u<=f)e.moveTo(c,h),e.lineTo(c+l,h),c=c+l+u,f=f-l-u;else{if(l<=f){e.moveTo(c,h),e.lineTo(c+l,h),f=f-l-u;break}if(0<f){e.moveTo(c,h),e.lineTo(c+f,h),f=f-l-u;break}}for(c=n+i-1,h=o+1,d=a-1,f<0&&(u<(f=M(f))&&(e.moveTo(c,h-2),e.lineTo(c,h+(f-u))),h+=f,d-=f);0<d;)l+u<=d?(e.moveTo(c,h),e.lineTo(c,h+l),h=h+l+u,d=d-l-u):l<=d?(e.moveTo(c,h),e.lineTo(c,h+l),d=d-l-u):0<d&&(e.moveTo(c,h),e.lineTo(c,h+d),d=d-l-u);for(c=n+i-2,h=o+a-1,f=i-1,d<0&&(u<(d=M(d))&&(e.moveTo(c+2,h),e.lineTo(c-(d-u),h)),c-=d,f-=d);0<f;)if(l+u<=f)e.moveTo(c,h),e.lineTo(c-l,h),c=c-l-u,f=f-l-u;else{if(l<=f){e.moveTo(c,h),e.lineTo(c-l,h),f=f-l-u;break}if(0<f){e.moveTo(c,h),e.lineTo(c-f,h),f=f-l-u;break}}for(c=n,h=o+a-2,d=a-1,f<0&&(u<(f=M(f))&&(e.moveTo(c,h+2),e.lineTo(c,h-(f-u))),h-=f,d-=f);0<d;)l+u<=d?(e.moveTo(c,h),e.lineTo(c,h-l),h=h-l-u,d=d-l-u):l<=d?(e.moveTo(c,h),h-l===o?e.lineTo(c,h-l-1):e.lineTo(c,h-l),d=d-l-u):0<d&&(o<h&&(e.moveTo(c,h),e.lineTo(c,h-d)),d=d-l-u);e.stroke()}e.beginPath(),e.restore()},H.prototype.XIb=function(e,t,r,n,o,i,a){var s,l,u,c,h;0!==t.length&&(s=t[0].col-1,l=t[t.length-1].col+1,u=r.zHb(n.row,s,a,1),o&&0<=s&&i.isValid&&!i.isValid(n.row,s,u)&&e.push({style:i.getDataValidator(n.row,s).highlightStyle(),x:t[0].x-i.getColumnWidth(s),y:n.y,width:i.getColumnWidth(s),height:n.height}),c=r.zHb(n.row,l,a,1),o&&i.isValid&&!i.isValid(n.row,l,c)&&(h=t[t.length-1],e.push({style:i.getDataValidator(n.row,l).highlightStyle(),x:h.x+h.width,y:n.y,width:i.getColumnWidth(l),height:n.height})))},H.prototype.YIb=function(e,t,r){var n,o,i,a,s=t.ss,l=e.row,u=e.col,c={},h={},f=[],d=e.rowCount,p=e.colCount;for(n=0;n<p;n++)h[n]=t.Tl(n+u,r);for(o=0;o<d;o++){for(c[o]=t.Sl(o+l,r),i=[],a=0;a<p;a++)i.push(s.Ym(l+o,u+a,r));f.push(i)}return{rowSizes:c,colSizes:h,styleList:f}},H.prototype.TI=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me;if(xe(n)&&(n=3),s=(a=this.kj).parent,l=a.am().Ft(t,r),u=s&&s.options.resizeZeroIndicator,c=a.Gr(t,n),h=a.Hr(r,n),f=a.options.sheetAreaOffset,d=a.Gt&&a.Gt()||{x:f.left,y:f.top,width:0,height:0},p=c.length,g=h.length,!(p<0||g<0)){for(b=0<(m=a.Ir(t,r,n,!0)).length,v=a.ss,M=k=A=T=0,R=new Ce.AF(a,c,h,n),D=[],N=[],F=[],_=[],P=!i&&3===n&&s&&s.options.highlightInvalidData,e.save(),e.beginPath(),L=[],B=O=-1,j=a.ar(3),H=a.$q(3),U=0===(G=a.am()).Cr&&0===d.height,W=0===G.Br&&0===d.width,V=!!we(this.kj),z=be("SheetsCalc"),q=a.getActiveRowIndex(),Z=a.getActiveColumnIndex(),Y=this.ZIb(n,a,q,Z),K=0;K<p;K++)for(y=c[K],this.XIb(_,h,v,y,P,a,n),X=0;X<g;X++)if(C=h[X],(w=b&&m.findCell(y.row,C.col))?(S=w.row,x=w.col,T=w.x,A=w.y,k=ke(w),M=Ae(w),w.isAutoMerge&&(T=(J=this.$Ib(w,t,r,n)).x,A=J.y,k=J.width,M=J.height),w.spanSizeInfo||(w.spanSizeInfo=this.YIb(w,a,n))):(S=y.row,x=C.col,T=C.x,A=y.y,k=ke(C),M=Ae(y)),1===u&&(-1===t&&a.getColumnVisible(x)&&0===a.$r(x)&&((B<0||B!==x-1)&&L.push({x1:T,y1:A,x2:T,y2:A+M,horizontal:!1}),B=x),-1===r&&a.getRowVisible(S)&&0===a.Yr(S)&&((O<0||O!==S-1)&&L.push({x1:T,y1:A,x2:T+k,y2:A,horizontal:!0}),O=S)),!(o&&(T+k<=o.x||T>=o.x+ke(o)||A+M<=o.y||A>=o.y+Ae(o))||0===k||0===M||(Q=!1,w&&ve.Bb(D,w)))){if($=!1,I=v.zHb(S,x,n,1),ee=a.jZ&&a.jZ(),Y&&0===S&&x>=Y.dj&&Y.cj+Y.Xj>a.lq&&x<Y.dj+Y.OZ){if(I=a.getCell(Y.cj,x).text()+"",Q=!0,$=Y.filterButtonVisible(),ee)for(te=0;te<ee.length;te++)if(ee[te].col===x&&ee[te].rowFilter.sj===Y){this._Ib(ee[te],1,0,!0);break}}else if(ee&&0<ee.length)for(re=ee[0].rowFilter&&ee[0].rowFilter.sj,te=ee.length-1;0<=te;te--)if(ee[te].tableColumnHeaderFilter&&ee[te].col===x){this._Ib(ee[te],3,re.cj,!1);break}E=v.Ym(S,x,n),P&&a.isValid&&!a.isValid(S,x,I)&&_.push({style:a.getDataValidator(S,x).highlightStyle(),x:T,y:A,width:k,height:M}),3===n&&(ne=E.formatter,z&&!i&&ne&&Se(ne)&&(oe=a.parent&&a.parent.aJb(ne))&&(ie=oe.getExpression(),I=z.evaluateExpression(a,ie,S,x))),R.jF(S,x,T,A,k,M,E,w,S===j&&U,x===H&&W,I),Q&&(E.hAlign=0),N.push({data:I,row:S,col:x,x:T,y:A,width:k,sparkline:V&&a.getSparkline(S,x),height:M,style:E,cellLayout:w,tableFilter:$}),w&&D.push(w)}if(0<N.length){if(3===n&&a.options.allowCellOverflow&&(ae=v.Sm(t,r,function(){return new Te(a,t,r)}),0<(F=this.hJ(e,ae,N,R)).length)){for(se=o.x,le=o.x+o.width,K=0;K<F.length;K++)(ue=F[K])&&(ce=ue.row,he=ue.col,(fe=ue.cellOverflowLayout&&ue.cellOverflowLayout.layout)&&((de=fe.x)<se&&(se=de),le<(pe=de+fe.width)&&(le=pe)),R.jF(ce,he,ue.x,ue.y,ue.width,ue.height,ue.style,ue.cellLayout,ce===j&&U,he===H&&W,ue.data));N=N.concat(F),o.x=se,o.width=le-se,!i&&l&&(o=o?l.getIntersectRect(o):l)}o&&(ge=a.printInfo&&a.printInfo(),i&&ge&&(0<ge.columnStart()||0<ge.rowStart())&&!ge.showBorder()?e.rect(o.x-(0<ge.columnStart()?2:0),o.y-(0<ge.rowStart()?2:0),ke(o)+(0<ge.columnStart()?4:0),Ae(o)+(0<ge.rowStart()?4:0)):e.rect(o.x,o.y,ke(o),Ae(o)),e.clip()),this.SI(e,N,n,i)}ye.Worksheet.ao(a,"paintViewport",{ctx:e,rowViewportIndex:t,colViewportIndex:r,sheetArea:n,clipRect:o,isPrinting:i}),R.paint(e),0<L.length&&this.iJ(e,L,1,3),0<_.length&&(me=l.getIntersectRect(o),e.rect(me.x,me.y,ke(me),Ae(me)),e.clip(),this.jJ(e,_)),e.restore()}},H.prototype._Ib=function(e,t,r,n){e.sheetArea=t,e.row=r,e.tableColumnHeaderFilter=n},H.prototype.ZIb=function(e,t,r,n){if(t.tables&&1===e&&0===t.frozenRowCount()&&0===t.frozenColumnCount()){var o=t.tables.find(r,n);if(o&&o.MZ&&o.cj<t.lq)return o}return null},H.prototype.$Ib=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d=e.row,p=e.col,g=e.x,m=e.y,b=e.width,y=e.height,C=this.kj,w=C.am();return 1!==t||3!==n&&2!==n||(o=w.fm(t),i=C.frozenRowCount(),a=C.getRowCount(n)-C.frozenTrailingRowCount()-1,m<(s=o.y)&&i<=d&&d<=a&&(y-=s-m,m=s),s+(l=o.height)<m+y&&i<=d+e.rowCount-1&&d+e.rowCount-1<=a&&(y-=m+y-(s+l))),1!==r||3!==n&&1!==n||(o=w.gm(r),u=C.frozenColumnCount(),c=C.getColumnCount(n)-C.frozenTrailingColumnCount()-1,g<(h=o.x)&&u<=p&&p<=c&&(b-=h-g,g=h),h+(f=o.width)<g+b&&u<=p+e.colCount-1&&p+e.colCount-1<=c&&(b-=g+b-(h+f))),new V.Rect(g,m,b,y)},H.prototype.iJ=function(e,t,r,n){var o,i,a,s,l,u,c,h;if(0!==t.length)for(o=0,i=t.length;o<i;o++)s=(a=t[o]).x1,l=a.y1,u=a.x2,c=a.y2,h=a.horizontal,e.beginPath(),e.save(),e.lineWidth=r,e.strokeStyle=this.kJ(e,h,s,l,u,c),e.fillStyle=this.lJ(e,h,s,l,u,c),h?(e.fillRect(s,l+-3,u-s-1,n+2*r),l+=.5,c+=.5,e.moveTo(s+-1,l+-3),e.lineTo(u+-2,c+-3),e.moveTo(s+-1,l+1),e.lineTo(u+-2,c+1)):(e.fillRect(s+-3,l+0,n+2*r,c-l-1),s+=.5,u+=.5,e.moveTo(s+-3,l+0),e.lineTo(u+-3,c+-1),e.moveTo(s+1,l+0),e.lineTo(u+1,c+-1)),e.stroke(),e.restore()},H.prototype.lJ=function(e,t,r,n,o,i){var a,s,l,u,c,h=t?"rowHeader":g,f=V.Im.Km(0,"gc-"+h+"-normal"),d=f&&f.backgroundColor,p=f&&f.backgroundImage;if(!t&&p&&-1!==p.indexOf("linear-gradient"))for(s=V.Ul.wl(p),a=e.createLinearGradient(r,n,o,i),l=0,u=s.length;l<u;l++)c=s[l],a.addColorStop(c.point,c.color);else d&&(a=d);return a},H.prototype.kJ=function(e,t,r,n,o,i){var a=e.createLinearGradient(r,n,o,i),s=t?"rowHeader":g,l=V.Im.Km(0,"gc-"+s+"-normal");return t?(a.addColorStop(0,l.borderTopColor),a.addColorStop(1,l.borderBottomColor)):(a.addColorStop(0,l.borderLeftColor),a.addColorStop(1,l.borderRightColor)),a},H.prototype.jJ=function(e,t){var r,n,o,i,a,s,l,u,c,h=this.kj.vu();if(t)for(r=t.length,n=0;n<r;n++)i=(o=t[n]).x,a=o.y,s=o.width,l=o.height,0===(c=(u=o.style).type)&&this.hyb(e,i,a,s,l,u),1===c&&this.iyb(e,i,a,s,l,u),2===c&&this.jyb(e,i,a,s,l,u,h)},H.prototype.hyb=function(e,t,r,n,o,i){var a=i.color,s=t-4,l=r-4,u=n+8,c=o+8,h=u/2*.5522848,f=c/2*.5522848,d=s+u,p=l+c,g=s+u/2,m=l+c/2;e.save(),e.lineWidth=2,e.strokeStyle=a,e.beginPath(),e.moveTo(s,m),e.bezierCurveTo(s,m-f,g-h,l,g,l),e.bezierCurveTo(g+h,l,d,m-f,d,m),e.bezierCurveTo(d,m+f,g+h,p,g,p),e.bezierCurveTo(g-h,p,s,m+f,s,m),e.closePath(),e.stroke(),e.restore()},H.prototype.iyb=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p;t-=.5,r-=.5,f=Math.min(n/2,o/2),d=i.color,p=i.position,e.save(),e.lineWidth=2,e.strokeStyle=d,e.beginPath(),e.rect(t,r,n,o),e.stroke(),e.restore(),e.save(),e.beginPath(),0===p?(l=a=t,u=(s=r)+f,c=a+f,h=s):2===p?(u=(s=r+o)-f,c=(l=a=t+n)-f,h=s):3===p?(l=a=t,u=(s=r+o)-f,c=a+f,h=s):1===p&&(u=(s=r)+f,c=(l=a=t+n)-f,h=s),e.moveTo(a,s),e.lineTo(l,u),e.lineTo(c,h),e.fillStyle=d,e.fill(),e.closePath(),e.restore()},H.prototype.jyb=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d;if(t-=.5,r-=.5,s=this.kj.zoom(),c=i.image,h=i.position,f=i.color,e.save(),e.beginPath(),e.lineWidth=2,e.strokeStyle=f,e.rect(t,r,n,o),e.stroke(),c&&"none"!==c&&a){4===h?l=t-18:5===h&&(l=t+n+3);try{a.ko(c)?(d=a.lo(c),u=r+o/2-7.5,e.drawImage(d,l,u,15,15)):a.fo(c)}catch(e){}}else 4===h?l=t-18*s:5===h&&(l=t+n+3*s),u=r+o/2-15*s/2,e.translate(l,u),e.scale(.015*s,.015*s),e.beginPath(),e.moveTo(512,0),e.bezierCurveTo(229.248,0,0,229.184,0,512),e.bezierCurveTo(0,794.816,229.248,1024,512,1024),e.bezierCurveTo(794.752,1024,1024,794.752,1024,512),e.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),e.closePath(),e.moveTo(783.488,692.992),e.lineTo(692.9920000000001,783.4879999999999),e.lineTo(512,602.496),e.lineTo(331.00800000000004,783.4879999999999),e.lineTo(240.51200000000006,692.992),e.lineTo(421.504,512),e.lineTo(240.512,330.944),e.lineTo(331.008,240.44800000000004),e.lineTo(512,421.44),e.lineTo(692.992,240.384),e.lineTo(783.4879999999999,330.88),e.lineTo(602.496,512),e.lineTo(783.488,692.992),e.closePath(),e.fillStyle=f,e.fill(),e.stroke();e.restore()},H.prototype.SI=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W;for(void 0===i&&(i=0),void 0===a&&(a=0),l=3===r,u=(s=this.kj).zoom(),c=Z(this.Bl(),u),h=s.getDefaultStyle(r),f=s.Al(r),d=this.kj.conditionalFormats,p=K(s),g=s.$q(2),m=s.ar(1),b=o?o.vu():s.vu(),e.save(),e.beginPath(),e.fillStyle=h&&h.foreColor||"black",q(e,c.font),e.textAlign=l?"right":"center",w=t.length,L=[],B={sheet:s,row:-1,col:-1,fontInfo:Y,lineHeight:-1,imageLoader:b,conditionalFormats:d,sheetArea:r,parentBackColor:p},y=0;y<w;y++)x=(v=t[y]).data,D=v.tableFilter,T=v.row,A=v.col,k=v.x,M=v.y,I=ke(v),E=Ae(v),R=v.style,N=v.cellOverflowLayout,_=R.font?Z(R.font,u):c,R.font=_.font,0<I&&0<E&&(S=R.cellType||f,k--,M--,I++,E++,l?B.sparkline=v.sparkline:(F=n?0:this.mJ(T,A,r),B.visualState=F),P=z(_.font),B.lineHeight=P,B.row=T+i,B.col=A+a,B.fontInfo=_,B.cellOverflowLayout=N,B.needTopGridline=1===r&&T===m||0===r,B.needLeftGridline=2===r&&A===g||0===r,B.isPrinting=n,S.jp(e,x,k,M,I,E,R,B,D),N&&!B.showBarIconOnly&&(j=new V.Rect(k,M,I,E),H=S.Ama?S.Ama(e,j,R,B):j,L.push({cellType:S,data:x,x:H.x,y:H.y,width:H.width,height:H.height,style:R,richText:void 0,options:{sheet:s,row:T,col:A,fontInfo:_,lineHeight:P,cellOverflowLayout:N,parentBackColor:p,imageLoader:b}})));if(0<(w=L.length))for(G=s.isEditing(),U=s.Jl,W=s.Kl,C=0;C<w;C++)x=(O=L[C]).data,B=O.options,G&&B.row===U&&B.col===W||we(this.kj)&&x&&"SparklineExValue"===x.typeName||this.BWa(e,O);for(e.restore(),w=t.length,y=0;y<w;y++)v=t[y],ye.Worksheet.ao(s,"paintCell",{ctx:e,sheetArea:r,cell:v,isPrinting:n})},H.prototype.BWa=function(e,t){var r,n,o=t.cellType,i=t.data,a=t.x,s=t.y,l=ke(t),u=Ae(t),c=t.style,h=t.options,f=h.cellOverflowLayout;f&&o.uxb&&(r=f.layout,n=new V.Rect(r?r.x:a,r?r.y:s,r?r.width:l,r?r.height:u),o.uxb(e,n,h,i)),o.paintValue&&o.paintValue(e,i,a,s,l,u,c,h)},H.prototype.mJ=function(e,t,r){var n=this.kj,o=0;return B(n)&&(3===r||xe(r)?!n.isEditing()&&n.wt(e,t)?o=3:n.vp(e,t,r)&&(o=2):(n.vp(e,t,r)&&(o=1,n.wp(e,t,r)&&(o=2)),n.xt(e,t,r)&&(o=4))),o},H.prototype.hJ=function(m,b,y,C){function e(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g;if(w=y[e],x=w.row,T=w.col,A=w.y,M=Ae(w),N=b.nJ(x,m),F=N.headingOverflowlayouts,_=N.trailingOverflowLayouts,!j[x]){for(t={},r=0,n=N;r<n.length;r++)o=n[r],t[o.column]=!1;F&&F.forEach(function(e){t[e.column]=!1}),_&&_.forEach(function(e){t[e.column]=!1}),j[x]=t}for(i=j[x],P=N.find(T),a=0;a<P.length;a++)if(s=P[a]){if(l=L.getCellRect(x,s.column,Y,Y,!0),!i[s.column]){if(u=s.column,(S=O.Ym(x,u)).showEllipsis)continue;v=O.zHb(x,u,3,1,S),k=s.columnWidth,I=s.backgroundWidth,E=s.backgroundLeftWidth<0?l.x:s.backgroundRightWidth<0?l.x+ke(l)-I:l.x+ke(l)/2-s.backgroundLeftWidth,D={data:v,row:x,col:u,x:l.x,y:A,width:k,height:M,cellOverflowLayout:s,style:S},B.push(D),s.layout=new V.Rect(E,A,I,M),S=O.Ym(x,u),C.gF(x,u,s,S,l.x,A,k,M),i[s.column]=!0}s.column===T&&i[s.column]&&H.push(e)}if(F)for(c=0;c<F.length;c++)if((h=F[c])&&!i[h.column]&&h.contains(w.col)){if(T=h.column,(S=O.Ym(x,T)).showEllipsis)continue;v=O.zHb(x,T,3,1,S),k=h.columnWidth,I=h.backgroundWidth,f=L.getCellRect(x,h.endColumn,Y,Y,!0),E=f.x+ke(f)-I,D={data:v,row:x,col:T,x:E,y:A,width:k,height:M,style:S,cellOverflowLayout:h},B.push(D),h.layout=new V.Rect(E,A,I,M),i[h.column]=!0,C.gF(x,T,h,S,E,A,k,M)}if(_)for(d=0;d<_.length;d++)if((p=_[d])&&!i[p.column]&&p.contains(w.col)){if(T=p.column,(S=O.Ym(x,T)).showEllipsis)continue;v=O.zHb(x,T,3,1,S),k=p.columnWidth,I=p.backgroundWidth,g=L.getCellRect(x,p.startColumn,Y,Y,!0),E=g.x,R=g.x+I-k,D={data:v,row:x,col:T,x:R,y:A,width:k,height:M,style:S,cellOverflowLayout:p},B.push(D),p.layout=new V.Rect(E,A,I,M),C.gF(x,T,p,S,E,A,k,M),i[p.column]=!0}}var w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,t,r,L=this.kj,O=L.ss,n=y.length,B=[],j={},H=[];for(t=0;t<n;t++)e(t);if(0<H.length)for(r=H.length-1;0<=r;r--)y.splice(H[r],1);return 0<B.length&&B.sort(function(e,t){var r=e.row,n=t.row,o=e.col,i=t.col;return r!==n?r-n:o!==i?o-i:void 0}),B},i=H,t.oJ=i,l=".cutCopyIndicator",h=V.Events.CellChanged,f=V.Events.ClipboardChanged,d=V.Events.ValueChanged,p=V.Events.ColumnChanged,m=V.Events.RowChanged,b=V.Events.RangeChanged,y=V.Events.ClipboardPasting,w=V.Events.ClipboardPasted,v=V.Events.DragMerging,S=V.Events.FloatingElementSelected,j.prototype.jx=function(e){return 0===arguments.length?this.zJ:void(this.zJ=e)},j.prototype.BJ=function(e,t){var r,n=this;return 0===arguments.length?n.yJ:void((n.yJ!==e||e||t)&&(n.yJ=e,(r=n.kj)&&(r.$p(),xe(n.Lfc)||clearTimeout(n.Lfc),n.Lfc=setTimeout(function(){if(!n.yJ){var e=r.tu();e&&e.hZ(t)}n.Lfc=Y}))))},j.prototype.AJ=function(){var u=this,r=u.kj,c=!1,n="resizable",o="isVisible";function i(){u.yJ&&u.BJ(!1)}function a(e,t){e!==n&&e!==t&&e!==o&&i()}r._bind(f+l,function(){u.BJ(!0)}),r._bind(d+l,i),r._bind(h+l,i),r._bind(p+l,function(e,t){a(t.propertyName,"width")}),r._bind(m+l,function(e,t){a(t.propertyName,"height")}),r._bind(b+l,i),r._bind(y+l,function(){c=u.BJ()}),r._bind(w+l,function(e,t){var r,n,o,i=t.cellRange,a=t.sheet.tu(),s=a.n5,l=c;if(i&&s&&a.PA){if(u.jx()){for(n=0,o=s;n<o.length;n++)if(o[n].intersect(i.row,i.col,i.rowCount,i.colCount)){l=!1;break}}else r=!(l=!1);u.BJ(l,r)}}),r._bind(v+l,i),r._bind(S+l,function(e,t){"worksheet"!==t.type&&(r.endEdit(),V.Vl.kmb(r))})},j.prototype.UI=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m;if(this.yJ&&(i=(o=this.kj)._render,s=(a=o.parent)?a.options:{},u=(l=o.tu()).n5,c=s.cutCopyIndicatorVisible,xe(c)&&(c=!0),h=V.Rm.Om(o,s.cutCopyIndicatorBorderColor||"blue"),c&&l.PA===o&&u&&(f=i.VI(r,n,Y),(d=i.XI(r,n,u,t))&&f))){for(e.save(),e.rect(f.x,f.y,ke(f),Ae(f)),e.clip(),p=0,g=d;p<g.length;p++)m=g[p],i.fJ(e,m,h);e.beginPath(),e.restore()}},j.prototype.rI=function(){this.BJ(!1)},j.prototype.sI=function(){this.BJ(!1)},j.prototype.tI=function(){this.BJ(!1)},j.prototype.uI=function(){this.BJ(!1)},j.prototype.ky=function(){this.BJ(!1)},j.prototype.no=function(){var e=this.kj;e._unbind(h+l),e._unbind(f+l),e._unbind(d+l),e._unbind(p+l),e._unbind(m+l),e._unbind(b+l),e._unbind(y+l),e._unbind(w+l),e._unbind(v+l),e._unbind(S+l)},a=j,t.CJ=a,ye.Worksheet.$n("render",{init:function(){this._render=new i(this),this.at=new a(this)},dispose:function(e){var t;!1!==e.clearCache&&(this._render&&(this._render.kj=Y,this._render=Y),(t=this.at)&&(t.no(),this.at=Y))},onLayoutChanged:function(e){var t,r=this.at;r&&("addRows"===(t=e.changeType)?r.rI():"deleteRows"===t?r.sI():"addColumns"===t?r.tI():"deleteColumns"===t&&r.uI())}})},"./dist/core/worksheet/worksheet-selection.js":function(e,t,r){"use strict";var n,w,o,i,a,g,m,v,S,x,s;function T(e,t){return e.getColumnCount(t)}function A(e,t){return e.getRowCount(t)}function k(e){return e.rowCount}function M(e){return e.colCount}function h(e,t,r){var n,o,i=[],a=e.length;for(o=0;o<a;o++)n=e[o],o===t?i=i.concat(r):i.push(n);return i}function I(e,t,r){for(var n=r-1;0<=n;n--)if(e.getColumnVisible(t+n))return t+n;return t+r-1}function E(e,t,r){for(var n=r-1;0<=n;n--)if(e.getRowVisible(t+n))return t+n;return t+r-1}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/core/worksheet/worksheet.js"),w=r("./dist/core/util/common.js"),o=r("@grapecity/js-sheets-common"),i=r("./dist/core/util/domUtil.js"),a=r("./dist/core/core.enum.js"),g=o.Common.j.Fa,m=o.Common.k.ac,v=null,S=Math.max,x=Math.min,s="gc-selection",i.GC$.extend(n.Worksheet.prototype,{addSelection:function(e,t,r,n){var o,i,a=e,s=t,l=r,u=n;-1===a||-1===s||(o=this._modelManager.getSpans())&&0<m(o)&&(a=(i=this.su(o,w.kf(e,t,r,n))).row,s=i.col,l=k(i),u=M(i)),this._modelManager.do("addSelection",a,s,l,u),this.$p()},setSelection:function(e,t,r,n){this.DJ(e,t,r,n,2)},DJ:function(e,t,r,n,o){var i,a,s,l=A(this),u=T(this);l<=e&&(e=l-1),u<=t&&(t=u-1),i=S(0,e),a=S(0,t),this.Tr(),s=2===o?w.Vl.Wl(this):1===o,this.Kr(i,a,this.Er(i),this.Fr(a),!s),this.addSelection(e,t,r,n)},getSelections:function(){return this._modelManager.getSelections()},clearSelection:function(){this.Tr(),this.Kr(0,0),n.Worksheet.ao(this,"clearSelection"),this.$p()},Tr:function(){this._modelManager.do("clearSelection")},Qs:function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d=this.options,p=d.protectionOptions,g=!1!==p.allowSelectLockedCells,m=!1!==p.allowSelectUnlockedCells;if(!d.isProtected||g&&m)return!0;if(!g&&!m)return!1;if(o=t<0,i=e<0,g===(n=r?r.locked:this.tq(e,t,"locked"))&&(i||o)){for(a=i?A(this):1,e=i?0:e,s=o?T(this):1,t=o?0:t,l=this._modelManager,u=e+a-1,c=t+s-1,f=h=void 0,h=e;h<=u;h++)for(f=t;f<=c;f++)if((r=l.getStyle(h,f))&&g!==r.locked)return!1;if(i)for(h=e;h<=u;h++)if((r=l.getStyle(h,-1))&&g!==r.locked)return!1;if(o)for(f=t;f<=c;f++)if((r=l.getStyle(-1,f))&&g!==r.locked)return!1}return g===n},SZa:function(e,t,r,n){var o,i;for(t=t<0?0:t,o=e=e<0?0:e;o<e+r;o++)for(i=t;i<t+n;i++)if(this.tq(o,i,"locked"))return!0},ZZa:function(){var e,t=this.getSelections();for(e=0;e<t.length;e++)if(-1!==t[e].col)return!1;return!0},$Za:function(){var e,t=this.getSelections();for(e=0;e<t.length;e++)if(-1!==t[e].row)return!1;return!0},selectionPolicy:function(e){var t=this._modelManager;return 0===arguments.length?t.getSelectionPolicy():(t.do("setSelectionPolicy",e),this)},selectionUnit:function(e){var t=this._modelManager;return 0===arguments.length?t.getSelectionUnit():(t.do("setSelectionUnit",e),this)},getSelectionBackColor:function(){return this.options.selectionBackColor||w.Im.Lm(s).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||w.Im.Lm(s).borderTopColor},m_a:function(e){return e?void(this.options.m_a=e):this.options.m_a},EJ:function(){var e,t,r=this._modelManager.getSelections();0<m(r)&&(e={selections:r},0!==(t=this._modelManager.getActiveSelectedRangeIndex())&&(e.activeSelectedRangeIndex=t),this.FJ=e,this.Tr(),this._render.im())},GJ:function(){var e=this.FJ,t=e&&e.selections;t&&(this._modelManager.do("setSelections",t),this._modelManager.do("setActiveSelectedRangeIndex",e.activeSelectedRangeIndex||0))},Ax:function(e,t,r){var n,o,i,a=this.HJ(e,t,r,this.Rr||0);a&&(n=a.row,o=a.col,i=a.leadingCellCol,this.IJ(n,o)&&(this.Qr=n,this.Rr=i,this.Jr(n,o)))},HJ:function(e,t,r,n){var o,i,a=A(this),s=T(this),l=e;return 0===l&&!r||0===a||0===s?v:(i=this.JJ(l,n),r||this.KJ(i),l=i.r,o=i.c,l<0&&r&&(((o=this.br(o))<0||g(o))&&(o=this.br(s)),n=o,l=(i=this.JJ(a,o)).r,(o=i.c)===t&&l<=e)?v:{row:l,col:o,leadingCellCol:n})},Bx:function(e,t,r){var n,o,i,a=this.LJ(e,t,r,this.Rr||0);!a||a.row===e&&a.col===t||(n=a.row,o=a.col,i=a.leadingCellCol,this.IJ(n,o)&&(this.Qr=n,this.Rr=i,this.Jr(n,o)))},LJ:function(e,t,r,n){var o,i,a=A(this),s=T(this),l=e;if((l!==a-1||r)&&0!==a&&0!==s&&(i=this.MJ(l,n),r||this.KJ(i),l=i.r,o=i.c,!(l===a&&r&&((s<=(o=this.Zq(o))||g(o))&&(o=this.Zq(-1)),n=o,l=(i=this.MJ(-1,o)).r,(o=i.c)===t&&e<=l))))return{row:l,col:o,leadingCellCol:n}},Dx:function(){var e,t,r=this.NJ();r&&(e=r.row,t=r.col,this.Qr=e,this.Rr=t,this.Jr(e,t))},NJ:function(){var e,t,r,n,o=this.ir(),i=this.dr(),a=i;if(!o&&!a)return v;if(r=!1!==(t=(e=this.options).protectionOptions).allowSelectLockedCells,n=!1!==t.allowSelectUnlockedCells,!e.isProtected||r&&n)return{row:o,col:a};if(!r&&!n)return v;for(;o!==v&&0<=o;o=this.gr(o))for(a=i;a!==v&&0<=a;a=this.br(a))if(r===this.tq(o,a,"locked"))return{row:o,col:a};return v},Cx:function(){var e,t,r=this.OJ();r&&(e=r.row,t=r.col,this.Qr=e,this.Rr=t,this.Jr(e,t))},OJ:function(){var e,t,r,n,o=this,i=o._q(o.frozenRowCount()-1),a=o.Zq(o.frozenColumnCount()-1),s=a,l=o.ir(),u=o.dr();if(i===v||s===v)return v;if(r=!1!==(t=(e=o.options).protectionOptions).allowSelectLockedCells,n=!1!==t.allowSelectUnlockedCells,!e.isProtected||r&&n)return{row:i,col:s};if(!r&&!n)return v;for(;i!==v&&i<=l;i=o._q(i))for(s=a;s!==v&&s<=u;s=o.Zq(s))if(r===o.tq(i,s,"locked"))return{row:i,col:s};return v},zx:function(e,t,r){var n,o,i,a,s=this.tables;(n=r?(n=s&&s.bJb(e,t))||this.iy(e,t,r,this.Qr||0):this.iy(e,t,r,this.Qr||0))&&(o=n.row,i=n.col,a=n.leadingCellRow,this.IJ(o,i)&&(this.Qr=a,this.Rr=i,this.Jr(o,i)))},iy:function(e,t,r,n){var o,i,a,s=A(this),l=T(this),u=t;if(0===u&&!r||0===s||0===l)return v;for(i=this.PJ(n,u),a=n,r||this.KJ(i),o=i.r,u=i.c;u<0&&r;){if(((o=this.gr(o,3,!0))<0||g(o))&&(o=this.gr(s,3,!0)),n=o,o=(i=this.PJ(n,l)).r,u=i.c,o===e&&u<t)return v;if(o===e&&u===t){if(n===a)return v;o=(i=this.PJ(n,u)).r,u=i.c}}return{row:o,col:u,leadingCellRow:n}},KJ:function(e){var t,r=!1;e.r<0?e.r=this.ar():e.r>=A(this)&&(e.r=this.ir(),r=!0),e.c<0?e.c=this.$q():e.c>=T(this)&&(e.c=this.dr(),r=!0),r&&((t=this._modelManager.getSpan(e.r,e.c)).row!==e.r&&(e.r=t.row),t.col!==e.c&&(e.c=t.col))},Fx:function(e,t){for(var r,n,o=this._modelManager,i=o.getActiveSelectedRangeIndex(),a=-1,s=this.Tq(this._getActiveSelectedRange()),l=s.row,u=s.col,c=s.col+M(s)-1,h=e,f=t;h=(r=this.QJ(h,f)).r,!(u<=(f=r.c));){if(a===i&&h===e&&f<=t)return;f=l<=--h?c+1:(n=this.Tq(this._getActiveSelectedRange(3)),a=o.getActiveSelectedRangeIndex(),l=n.row,u=n.col,c=n.col+M(n)-1,h=n.row+k(n)-1,n.col+M(n))}0<=h&&(this.Jr(h,f),this.Qr=h,this.Rr=f)},Gx:function(e,t){for(var r,n,o=this._modelManager,i=o.getActiveSelectedRangeIndex(),a=-1,s=this.Tq(this._getActiveSelectedRange()),l=s.col,u=s.row+k(s)-1,c=s.col+M(s)-1,h=e,f=t;h=(r=this.RJ(h,f)).r,!((f=r.c)<=c);){if(a===i&&h===e&&t<=f)return;f=++h<=u?l-1:(n=this.Tq(this._getActiveSelectedRange(4)),a=o.getActiveSelectedRangeIndex(),l=n.col,u=n.row+k(n)-1,c=n.col+M(n)-1,h=n.row,n.col-1)}0<=h&&(this.Jr(h,f),this.Qr=h,this.Rr=f)},Rs:function(e,t,r){var n,o,i,a,s=this.tables;!(n=r?(n=s&&s.cJb(e,t))||this.hy(e,t,r,this.Qr||0):this.hy(e,t,r,this.Qr||0))||n.row===e&&n.col===t||(o=n.row,i=n.col,a=n.leadingCellRow,this.IJ(o,i)&&(this.Qr=a,this.Rr=i,this.Jr(o,i)))},hy:function(e,t,r,n){var o,i,a,s=this,l=A(s),u=T(s),c=t;if(c===u-1&&!r||0===l||0===u)return v;for(i=s.SJ(n,c),a=n,r||s.KJ(i),o=i.r,c=i.c;c===u&&r;){if(!(e!==l-1||e!==o||s.getRowVisible(o,3)&&0<s.Sl(o,3)))return v;if((l<=(o=s._q(o,3,!0))||g(o))&&(o=s._q(-1,3,!0)),n=o,o=(i=s.SJ(n,-1)).r,c=i.c,o===e&&t<c)return v;if(o===e&&c===t){if(n===a)return v;o=(i=s.SJ(n,c)).r,c=i.c}}return{row:o,col:c,leadingCellRow:n}},PJ:function(e,t){for(var r,n,o,i=t;0<=i&&(r=e,!(--i<0));)if((n=this._modelManager.getSpans(w.kf(r,i,1,1)))&&0<m(n)&&(i>=(o=n[0]).col&&(i=o.col,r=o.row)),this.IJ(r,i))return{r:r,c:i};return{r:r,c:i}},QJ:function(e,t){for(var r,n;0<=t&&!(--t<0);){if(r=this._modelManager.findSpan(e,t)){if(!((n=this._getActiveSelectedRange()).row<=r.row&&r.row+k(r)<=n.row+k(n)&&n.col<=r.col&&r.col+M(r)<=n.col+M(n)))continue;if(r.row!==e||r.col!==t)continue;t>=r.col&&(t=r.col,e=r.row)}if(this.IJ(e,t))return{r:e,c:t}}return{r:e,c:t}},SJ:function(e,t){for(var r,n,o,i,a=T(this),s=t;s<a&&(r=e,!(a<=(s=(n=this._modelManager.getSpan(r,s)).col+M(n))));)if((o=this._modelManager.getSpans(w.kf(r,s,1,1)))&&0<m(o)&&(s>(i=o[0]).col?s=S(s,i.col+M(i)):r=i.row),this.IJ(r,s))return{r:r,c:s};return{r:r,c:s}},RJ:function(e,t){for(var r,n,o,i=this._modelManager,a=T(this);t<a&&!(a<=(t=(r=i.getSpan(e,t)).col+M(r)));){if(n=i.findSpan(e,t)){if(!((o=this._getActiveSelectedRange()).row<=n.row&&n.row+k(n)<=o.row+k(o)&&o.col<=n.col&&n.col+M(n)<=o.col+M(o)))continue;if(n.row!==e||n.col!==t)continue;t>n.col?t=S(t,n.col+M(n)):e=n.row}if(this.IJ(e,t))return{r:e,c:t}}return{r:e,c:t}},IJ:function(e,t){var r,n;return!!this.Qs(e,t)&&(r=0<=e&&e<A(this)&&0<=t&&t<T(this)&&this.getRowVisible(e)&&this.getColumnVisible(t)&&0<this.Sl(e)&&0<this.Tl(t),n=!!this.Tx,!0===r&&!0==n&&(!1===this.tq(e,t,"tabStop")&&(r=!1)),r)},JJ:function(e,t){for(var r,n;0<=e&&!(--e<0);)if((r=this._modelManager.getSpans(w.kf(e,t,1,1)))&&0<m(r)&&(e>=(n=r[0]).row&&(e=n.row,t=n.col)),this.IJ(e,t))return{r:e,c:t};return{r:e,c:t}},MJ:function(e,t){for(var r,n,o,i=A(this);e<i&&!(i<=(e=(r=this._modelManager.getSpan(e,t)).row+k(r)));)if((n=this._modelManager.getSpans(w.kf(e,t,1,1)))&&0<m(n)&&(e>(o=n[0]).row?e=S(e,o.row+k(o)):t=o.col),this.IJ(e,t))return{r:e,c:t};return{r:e,c:t}},Ur:function(e,t,r,n,o){this._modelManager.do("addSelection",e,t,r,n),o&&this.Xq<=0&&this._render.im()},aH:function(e,t,r){var n=this.Jx(e,t,this.Jl,this.Kl),o=n.row,i=n.col,a=k(n),s=M(n),l=this.selectionPolicy(),u=this.selectionUnit();0!==l&&(1===l&&this._modelManager.do("clearSelection"),1===u?s=i=-1:2===u&&(a=o=-1),this.Kx(o,i,a,s,r))},Jx:function(e,t,r,n,o){var i,a,s,l,u;return g(r)&&(r=this.Jl),g(n)&&(n=this.Kl),a=(i=this._modelManager).getSpan(r,n),s=i.getSpan(e,t),o&&a.equals(s)?new w.Range(a.row,a.col,1,1):(l=a.union(s),(u=this._modelManager.getSpans())&&0<m(u)&&(l=this.TJ(u,l)),l)},Kx:function(e,t,r,n,o){var i,a,s,l,u,c,h=this,f=h._modelManager,d=h._getActiveSelectedRange();if(0<m(f.getSelections())?(a=w.kf(e,t,r,n),h.n_a?(i=h.p_a,h.p_a=a):((s=f.getSelections())[f.getActiveSelectedRangeIndex()]=a,f.do("setSelections",s))):h.n_a||f.do("addSelection",e,t,r,n),o&&h.Xq<=0){if(l=h._getActiveSelectedRange(),!h.n_a&&l.row===d.row&&l.col===d.col&&k(l)===k(d)&&M(l)===M(d))return;u=h._render,h.n_a&&(c=h.p_a,i&&i.containsRange(c)?c=i:i&&(c=i.union(c)),d=(c=c.union(w.kf(h.getActiveRowIndex(),h.getActiveColumnIndex(),1,1))).union(d),l=c.union(l)),d.containsRange(l)?u.im(d):l.containsRange(d)?u.im(l):(u.im(d),u.im(l),u.im(h.p_a))}},kyb:function(e){var t=[];return e&&(t=this._modelManager.getSpans(e)),t},lyb:function(e,t){var r=e.row,n=e.col,o=e.rowCount,i=e.colCount,a=t.row,s=t.col,l=t.rowCount,u=t.colCount,c=r+o,h=n+i,f=a+l,d=s+u,p=!1,g=!1;return e.intersect(a,s,l,u)&&(g=!(p=a<r||s<n||c<f||h<d)),t.myb=t.myb||g,p},nyb:function(e,t,r,n){var o,i=[],a=[];for(o=0;o<e.length;o++)a=this.oyb(e[o],t,r,n),i=i.concat(a);return i},oyb:function(e,t,r,n){var o,i,a,s,l,u=[],c=t.length;for(u.push(e),s=c-1;0<=s;s--)for(i=t[s],l=0;l<u.length;)o=u[l],this.lyb(o,i)?(u=h(u,l,a=this.v_a(o,i,r,n)),l+=a.length):l++;return u},pyb:function(e,t){var r=t.row,n=t.col,o=t.rowCount,i=t.colCount;return e.intersect(r,n,o,i)},qyb:function(e,t){var r,n,o=[];for(n=e.length-1;0<=n;n--)r=e[n],this.pyb(r,t)||o.push(r);return o},ryb:function(e){var t=!1,r=this._modelManager.getSpans(e);return 1===r.length&&(t=e.equals(r[0])),t},syb:function(e,t){var r,n,o,i=e,a=t.length,s=i.length,l=!0;for(n=a-1;0<=n;n--){for(r=t[n],o=s-1;0<=o;o--)if(i[o].equals(r)){l=!1;break}l&&i.push(r)}return i},tyb:function(e){var t,r,n,o,i=[];for(r=e.length-1;0<=r;r--)(t=e[r]).myb&&(delete t.myb,i.push(r));for(n=i.length,o=0;o<n;o++)e.splice(i[o],1)},v_a:function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m;return t=this.Tq(t),o=[],i=e.getIntersect(t,r,n),e&&i?(a=0<=e.row?e.row:0,s=0<=e.col?e.col:0,l=e.rowCount,u=e.colCount,c=i.row,h=i.col,f=i.rowCount,p=s+u,m=h+i.colCount,0<(d=a+l)-(g=c+f)&&o.push(w.kf(g,s,d-g,u)),0<p-m&&o.push(w.kf(c,m,f,p-m)),0<h-s&&o.push(w.kf(c,s,f,h-s)),0<c-a&&o.push(w.kf(a,s,c-a,u))):o.push(e),o},u_a:function(e,t){var r,n,o,i,a,s,l,u,c,h,f=[],d=this.getRowCount(3),p=this.getColumnCount(3),g=this.deselectIgnoreSpan();if(e&&0<e.length){for(n=[],o=[],s=a=void 0,r=!(i=[]),l=e.length-1;0<=l;l--)a=e[l],g||!this.ryb(a)||this.pyb(a,t)?(n=this.v_a(a,t,d,p),g||0<(s=this.kyb(a)).length&&(n=this.nyb(n,s,d,p),i=this.qyb(s,t),o=this.syb(o,i),this.tyb(o)),u=m(n),!r&&0<u&&(this.setSelection(n[u-1].row,n[u-1].col,1,1),r=!0),f=n.concat(f)):o=this.syb(o,[a]);g||(f=o.concat(f))}for(this.Tr(),c=f.length,this.suspendPaint(),h=0;h<c;h++)this.addSelection(f[h].row,f[h].col,f[h].rowCount,f[h].colCount);r||this.setActiveCell(this.Jl,this.Kl),this.resumePaint()},Sx:function(e,t){var r,n,o,i,a,s,l,u,c,h=this,f=h._modelManager.getSelections();if(!(m(f)<=0)&&(r=h._getActiveSelectedRange(),n=h.UJ(r,e,t))){if(o=n.row,i=n.col,a=k(n),s=M(n),l=h.selectionPolicy(),u=h.selectionUnit(),0===l)return;1===l&&h._modelManager.do("clearSelection"),1===u?s=i=-1:2===u&&(a=o=-1),h.Kx(o,i,a,s,!0),c=h._modelManager.getSelections(),h._eventHandler.zu(f,c)&&(h.yu(f,c),h.Au(f))}},UJ:function(e,t,r,n,o){var i=this,a=i.Tq(e),s=v;return 37===t?s=r?i.VJ(a,!1,n,o):i.WJ(a,n,o):39===t?s=r?i.XJ(a,!1,n,o):i.YJ(a,n,o):38===t?s=r?i.ZJ(a,!1,n,o):i.$J(a,n,o):40===t?s=r?i._J(a,!1,n,o):i.aK(a,n,o):36===t?s=r?i.bK(a,n,o):i.cK(a,n,o):35===t?s=r?i.dK(a,n,o):i.eK(a,n,o):33===t?s=i.fK(a,n,o):34===t&&(s=i.gK(a,n,o)),s&&(e.row<0&&(s.row=-1,s.rowCount=i.getRowCount()),e.col<0&&(s.col=-1,s.colCount=i.getColumnCount())),s},WJ:function(e,t,r){for(var n,o,i,a,s,l,u,c,h=this,f=e.row,d=e.col,p=k(e),g=M(e),m=d+g-1,b=E(h,f,p);0<m;)if(m--,h.IJ(b,m)&&(n=h.Jx(b,m,t,r),o=x(f,n.row),i=x(d,n.col),s=S(f+p-1,n.row+k(n)-1)-o+1,l=(a=x(d+g-1,n.col+M(n)-1))-i+1,o!==f||i!==d||s!==p||l!==g))return u=h.qq,d<(c=h.Kl)?i<=u&&h.rq(i):d===c&&a<=u&&h.rq(a),h.parent&&h.parent.options.scrollByPixel&&i===u&&0!==h.eCb&&h.rq(i,0),w.kf(o,i,s,l);return v},VJ:function(e,t,r,n){var o,i,a,s,l,u=e.row,c=e.col,h=this.frozenColumnCount(),f=h?this.Zq(h-1):this.$q(),d=t?f:this.$q();if(!g(d))return(h<=0||t)&&this.rq(d),o=this.Jx(u,d,r,n),i=x(u,o.row),a=x(c,o.col),s=S(u+k(e)-1,o.row+k(o)-1)-i+1,l=x(c+M(e)-1,o.col+M(o)-1)-a+1,w.kf(i,a,s,l)},lCb:function(e){var t,r,n,o,i;if(this.parent&&this.parent.options.scrollByPixel){for(n=this.ss,o=this.Fr(e),i=this.getViewportWidth(o);0<=e&&!((i-=n._m(e))<0);e--);t=e,r=i}else t=this.ks(e,2),r=0;return{dj:t,UP:r}},YJ:function(e,t,r){for(var n,o,i,a,s,l,u,c,h,f=this,d=e.row,p=e.col,g=k(e),m=M(e),b=p,y=T(f)-1,C=E(f,d,g);b<y;)if(b++,f.IJ(C,b)&&(n=f.Jx(C,b,t,r),o=x(d,n.row),i=S(p,n.col),s=S(d+g-1,n.row+k(n)-1)-o+1,l=(a=S(p+m-1,n.col+M(n)-1))-i+1,o!==d||i!==p||s!==g||l!==m))return u=f.Aw(),p<(c=f.Kl)?u<=i&&(h=f.lCb(i),f.rq(h.dj,h.UP)):p===c&&u<=a&&(h=f.lCb(a),f.rq(h.dj,h.UP)),w.kf(o,i,s,l);return v},XJ:function(e,t,r,n){var o,i,a,s,l,u,c=e.row,h=e.col,f=this.lr();if(!g(f))return this.rq(f),o=this.dr(),t||(o+=this.frozenTrailingColumnCount()),i=this.Jx(c,o,r,n),a=x(c,i.row),s=S(h,i.col),l=S(c+k(e)-1,i.row+k(i)-1)-a+1,u=S(h+M(e)-1,i.col+M(i)-1)-s+1,w.kf(a,s,l,u)},$J:function(e,t,r){for(var n,o,i,a,s,l,u,c,h=this,f=e.row,d=e.col,p=k(e),g=M(e),m=f+p-1,b=I(h,d,g);0<m;)if(m--,h.IJ(m,b)&&(n=h.Jx(m,b,t,r),o=x(f,n.row),i=x(d,n.col),s=(a=x(f+p-1,n.row+k(n)-1))-o+1,l=S(d+g-1,n.col+M(n)-1)-i+1,o!==f||i!==d||s!==p||l!==g))return u=h.lq,f<(c=h.Jl)?o<=u&&h.mq(o):f===c&&a<=u&&h.mq(a),h.parent&&h.parent.options.scrollByPixel&&o===u&&0!==h.cCb&&h.mq(o,0),w.kf(o,i,s,l);return v},ZJ:function(e,t,r,n){var o,i,a,s,l,u=e.row,c=e.col,h=this.frozenRowCount(),f=h?this._q(h-1):this.ar(),d=t?f:this.ar();if(!g(d))return(h<=0||t)&&this.mq(d),o=this.Jx(d,c,r,n),i=x(u,o.row),a=x(c,o.col),s=x(u+k(e)-1,o.row+k(o)-1)-i+1,l=S(c+M(e)-1,o.col+M(o)-1)-a+1,w.kf(i,a,s,l)},mCb:function(e){var t,r,n,o,i;if(this.parent&&this.parent.options.scrollByPixel){for(n=this.ss,o=this.Er(e),i=this.getViewportHeight(o);0<=e&&!((i-=n.Sl(e))<0);e--);t=e,r=i}else t=this.ms(e,2),r=0;return{cj:t,UP:r}},aK:function(e,t,r){for(var n,o,i,a,s,l,u,c,h,f=this,d=e.row,p=e.col,g=k(e),m=M(e),b=d,y=A(f)-1,C=I(f,p,m);b<y;)if(b++,f.IJ(b,C)&&(n=f.Jx(b,C,t,r),o=S(d,n.row),i=x(p,n.col),s=(a=S(d+g-1,n.row+k(n)-1))-o+1,l=S(p+m-1,n.col+M(n)-1)-i+1,o!==d||i!==p||s!==g||l!==m))return u=f.Fw(),d<(c=f.Jl)?u<=o&&(h=f.mCb(o),f.mq(h.cj,h.UP)):d===c&&u<=a&&(h=f.mCb(a),f.mq(h.cj,h.UP)),w.kf(o,i,s,l);return v},_J:function(e,t,r,n){var o,i,a,s,l,u,c=e.row,h=e.col,f=this.kr();if(!g(f))return this.mq(f),o=this.ir(),t||(o+=this.frozenTrailingRowCount()),i=this.Jx(o,h,r,n),a=S(c,i.row),s=x(h,i.col),l=S(c+k(e)-1,i.row+k(i)-1)-a+1,u=S(h+M(e)-1,i.col+M(i)-1)-s+1,w.kf(a,s,l,u)},cK:function(e,t,r){for(var n,o,i,a,s,l=e.row,u=e.col,c=k(e),h=M(e),f=this.frozenColumnCount()-1,d=this.Kl,p=l+c-1;f<d;)if(f++,this.IJ(p,f)){if(u<=f&&u+h-1===this.Kl)break;return n=this.Jx(p,f,t,r),o=x(l,n.row),i=x(u,n.col),a=S(l+c-1,n.row+k(n)-1)-o+1,s=x(u+h-1,n.col+M(n)-1)-i+1,this.rq(this.$q()),w.kf(o,i,a,s)}return v},bK:function(e,t,r){return e=this.VJ(e,!0,t,r),this.ZJ(e,!0,t,r)},eK:function(e,t,r){for(var n,o,i,a,s,l=e.row,u=e.col,c=k(e),h=M(e),f=T(this),d=this.Kl,p=l+c-1;d<f;)if(f--,this.IJ(p,f)){if(f<=u+h-1&&u===this.Kl)break;return n=this.Jx(p,f,t,r),o=x(l,n.row),i=S(u,n.col),a=S(l+c-1,n.row+k(n)-1)-o+1,s=S(u+h-1,n.col+M(n)-1)-i+1,this.rq(this.lr()),w.kf(o,i,a,s)}return v},dK:function(e,t,r){return e=this.XJ(e,!0,t,r),this._J(e,!0,t,r)},fK:function(e,t,r){var n,o,i,a,s,l,u,c=this,h=e.row,f=e.col,d=k(e),p=c.Ew();return g(p)?v:(n=c.Gr(1),o=-1,c.mq(p)?o=c._q(h+d-1-m(n)):c.frozenRowCount()<=0&&(o=c.ar()),o<c.lq?o=c.lq:o>=c.Fw()&&(o=c.gr(c.Fw())),i=c.Jx(o,f,t,r),a=x(h,i.row),s=x(f,i.col),l=x(h+d-1,i.row+k(i)-1)-a+1,u=S(f+M(e)-1,i.col+M(i)-1)-s+1,w.kf(a,s,l,u))},gK:function(e,t,r){var n,o,i,a,s,l,u,c=this,h=e.row,f=e.col,d=k(e),p=c.$x();return g(p)?v:(n=c.Gr(1),c.mq(p),(o=c.gr(h+d-1+m(n)))<c.lq?o=c.lq:o>=c.Fw()&&(o=c.lq>=c.kr()?c.Fw():c.gr(c.Fw())),i=c.Jx(o,f,t,r),a=S(h,i.row),s=x(f,i.col),l=S(h+d-1,i.row+k(i)-1)-a+1,u=S(f+M(e)-1,i.col+M(i)-1)-s+1,w.kf(a,s,l,u))},Ew:function(){var e,t,r,n,o,i=this.Gr(1);if(!i||m(i)<=0)return v;for(t=(e=this.frozenRowCount())?this._q(e-1):this.ar(),r=0,n=this.lq,o=this.am();t<n&&(n--,!((r+=this.Sl(n))>o.jr)););return n},zw:function(){var e,t,r,n,o,i=this.Hr(1);if(!i||m(i)<=0)return v;for(t=(e=this.frozenColumnCount())?this.Zq(e-1):this.$q(),r=0,n=this.qq,o=this.am();t<n&&(n--,!((r+=this.Tl(n))>o.er)););return n},$x:function(){var e,t=this.Gr(1),r=m(t);return t&&0<r?(e=t[r-1].row,this.ir()<=e?this.lq:e):v},kr:function(){var e,t,r,n,o,i,a=this;if(a.ir()===a.Fw()&&(e=a.am(),t=a.Gr(1),r=m(t),t&&1<=r&&(n=t[r-1]).y+n.height<=e.qt+e.jr))return a.lq;o=a.lq;try{return a.lq=a.ir(),i=a.Ew(),i=a._q(i)}catch(e){}finally{a.lq=o}},lr:function(){var e,t,r,n,o,i;if(this.dr()===this.Aw()&&(e=this.am(),t=this.Hr(1),r=m(t),t&&1<=r&&(n=t[r-1]).x+n.width<=e.pt+e.width))return this.qq;for(e=this.am(),o=0,i=this.dr();0<i&&!((o+=this.Tl(i))>e.er);)i--;return 0<i&&(i=this.Zq(i)),i},Fw:function(){var e=this.Gr(1),t=m(e);return e&&0<t?e[t-1].row:v},Aw:function(){var e=this.Hr(1),t=m(e);return e&&0<t?e[t-1].col:v},hr:function(){var e,t,r=this.Gr(1),n=m(r);return r&&0<n?(e=this.am(),r[t=n-1].y+r[t].height<=e.qt+e.jr?r[t].row:r[S(t-1,0)].row):v},cr:function(){var e,t,r=this.Hr(1),n=m(r);return r&&0<n?(e=this.am(),r[t=n-1].x+r[t].width<=e.pt+e.er?r[t].col:r[S(t-1,0)].col):v},ir:function(e){g(e)&&(e=3);var t=A(this,e);return 3!==e&&2!==e||(t-=this.frozenTrailingRowCount()),this.gr(t,e)},dr:function(e){g(e)&&(e=3);var t=T(this,e);return 3!==e&&1!==e||(t-=this.frozenTrailingColumnCount()),this.br(t,e)},TJ:function(e,t){var r,n,o;if(e)for(r=0,n=m(e);r<n;r++)if(o=e[r],t.intersect(o.row,o.col,k(o),M(o)))return e.splice(r,1),r--,this.TJ(e,t.union(o));return t},_getActiveSelectedRange:function(e){var t,r=this._modelManager,n=m(r.getSelections()),o=w.kf(-1,-1,0,0);return n<=0||(t=r.getActiveSelectedRangeIndex(),3===e?(--t<0&&(t=n-1),r.do("setActiveSelectedRangeIndex",t)):4===e&&(n<=++t&&(t=0),r.do("setActiveSelectedRangeIndex",t)),0<=(t=r.getActiveSelectedRangeIndex())&&(o=r.getSelections()[t])),o}}),n.Worksheet.$n("selection",{init:function(){this._modelManager.do("addSelection",0,0,1,1),this._modelManager.setCellState(0,0,a.CellStatesType.active,!0,a.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(e,t,s){"use strict";var r,n,S,w,o,x,i,a,T,B,y,j,H,G,U,A;function R(e,t,r){for(var n=e[r-t];n<r;)n=e[n-t];return n}function W(e){return"object"==typeof e?JSON.stringify(e):r.Common.pc.bc(r.Common.pc.ec(e))}function d(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P=o,L=e,O=t;if(P)for(s=0;s<P.length&&(P[s]&&(l=P[s].ascending,0<=(u=P[s].index)&&(h=c=void 0,f=n?L:u,d=n?u:L,p=n?O:u,g=n?u:O,h=i?(c=i[f][d],i[p][g]):(c=r.getValue(f,d),r.getValue(p,g)),P[s].compareFunction?(a=P[s].compareFunction(c,h),l||(a*=-1)):j(P[s].color)?(y=j(c)||""===c||typeof c===U&&isNaN(c),C=j(h)||""===h||typeof h===U&&isNaN(h),y||C?y&&C?a=0:y&&!C?a=1:!y&&C&&(a=-1):(_=h,a=((F=c)instanceof Date&&_ instanceof Date?B(F)===B(_):typeof F===G&&typeof _===G?F.toLowerCase()===_.toLowerCase():F===_)?0:(M=h,N=D=R=E=I=void 0,(k=c)instanceof Date&&(k=B(k)),M instanceof Date&&(M=B(M)),R=(I=typeof k)===G,D=(E=typeof M)===G,N=E===U,(I==E||I!==U&&!N?I===H&&D||(!R||E!==H)&&(R&&D?k.toLowerCase()>M.toLowerCase():M<k):N)?l?1:-1:l?-1:1))):(0,m=r.getActualStyle(f,d,3,!1,!1,!0),b=r.getActualStyle(p,g,3,!1,!1,!0),w=m,v=b,S=P[s].color,x=P[s].isBackColor,A=T=void 0,j(w)||(T=x?w.backColor:w.foreColor,j(T)||(T=W(T))),j(v)||(A=x?v.backColor:v.foreColor,j(A)||(A=W(A))),a=(T=T||"")===(A=A||"")?0:T===S?1:A===S?-1:0,l||(a*=-1)))),0===a);s++);return a}function C(e,t,r,n,o){var i,a,s,l,u,c,h,f=e.length;if(f<=1)return e;for(a=e[i=Math.floor(f/2)],s=[],l=[],u=[],c=0;c<f;c++)i!==c?(h=d(e[c],a,t,r,n,o))<0?s.push(e[c]):0<h?l.push(e[c]):u.push(e[c]):u.push(e[c]);return C(s,t,r,n,o).concat(u,C(l,t,r,n,o))}function k(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p=i?n:o,g=i?t:r,m=[];for(u=0;u<p;u++)m[u]=g+u;for(c=s.ignoreHidden?function(e,t,r){var n,o,i=[];if(t)for(n=r.length-1;0<=n;n--)o=r[n],0===e.getRowHeight(o)&&(r.splice(n,1),i.push({mi:n,Qb:o}));else for(n=r.length-1;0<=n;n--)o=r[n],0===e.getColumnWidth(o)&&(r.splice(n,1),i.push({mi:n,Qb:o}));return i}(e,i,m):[],h=m.concat([]),f=!1,m=C(m,e,i,a,l),d=0;d<m.length;d++)if(m[d]!==h[d]){f=!0;break}return function(e,t){var r,n;for(r=e.length-1;0<=r;r--)n=e[r],t.splice(n.mi,0,n.Qb)}(c,m),{array:m,isChanged:f}}function M(e,t,r,n,o,i,a,s,l){var u,c,h,f,d=i?n:o,p=i?t:r,g=i?e.rowOutlines:e.columnOutlines,m=g.kec(p,d),b=g.lec(m,s.groupSort);if(!b){for(u=[],c=0;c<d;c++)u.push(p+c);b=[u]}for(c=0;c<b.length;c++)b[c]=C(b[c],e,i,a,l);return f=(h=g.mec(b,m,s.groupSort)).array,h.isChanged&&function(e,t,r,n,o,i,a){var s,l,u=t?e.rowOutlines:e.columnOutlines,c=[],h=[];if(t){for(s=i;s<i+a;s++)e.Ps(s)||e.rowOutlines&&e.rowOutlines.isCollapsed(s)||(e.getRowVisible(s,3,!0)?0===e.getRowHeight(s)&&(c.push(s),e.setRowHeight(s,e.defaults.rowHeight)):(h.push(s),e.setRowVisible(s,!0)));for(u.nec(r.groupSwap,r.array,o.start),s=0;s<h.length;s++)l=y.Cb(n,h[s])+i,e.setRowVisible(l,!1);for(s=0;s<c.length;s++)l=y.Cb(n,c[s])+i,e.setRowHeight(l,0)}else{for(s=i;s<i+a;s++)e.columnOutlines&&e.columnOutlines.isCollapsed(s)||(e.getColumnVisible(s,3)?0===e.getColumnWidth(s)&&(c.push(s),e.setColumnWidth(s,e.defaults.colWidth)):(h.push(s),e.setColumnVisible(s,!0)));for(u.nec(r.groupSwap,r.array,o.start),s=0;s<h.length;s++)l=y.Cb(n,h[s])+i,e.setColumnVisible(l,!1);for(s=0;s<c.length;s++)l=y.Cb(n,c[s])+i,e.setColumnWidth(l,0)}}(e,i,h,f,m,p,d),{array:f,isChanged:h.isChanged}}function D(e,t,r){var n=e.qg(t,r,!1);n&&n.hasListeners()&&n.Yg()}function N(e,t,r,n){var o,i,a=s("SheetsCalc");a&&(o=a.CalcOperatorAdjustor.zj(e._source,e._source,e.Kf(t,r),t,r,0,0),e.Rf(t,r,o,n),(i=e.qg(t,r,!!o))&&i.og())}function I(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y=[],C=e._modelManager.WTa;if(0<C&&t&&(e._modelManager.WTa=0,[].push.apply(e._modelManager.zTa,[{row:r,column:n,rowCount:o,columnCount:i,byRows:a,sortInfo:s,type:"sortRange",array:u.concat([])}])),h=x&&e.Bj(),f=x&&e.yj(),function(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C,w,v,S,x=e._modelManager,T=x.Ky,A=T&&0<T.sV.length,k=i?t:r,M=i?t+n:r+o,I=i?r:t,E=i?r+o:t+n;for(v=k;v<M;v++)if(v!==(w=R(s,k,v)))for(i?(f=v,p=w):(d=v,g=w),S=I;S<E;S++)i?g=d=S:p=f=S,a&&(m=l[f][d],b=l[p][g]),A&&(y=T.get(f,d),C=T.get(p,g)),c&&h&&(D(c,f,d),D(c,p,g),c._f(f,d,p,g),N(c,f,d),N(c,p,g)),x.do("swapNode",f,d,p,g),e.uja&&e.wja(f,d,p,g),A&&T.qUa(y,f,d,C,p,g),a&&(l[f][d]=b,l[p][g]=m),u.push({row:f,col:d}),u.push({row:p,col:g})}(e,r,n,o,i,a,l,u,c,y,h,f),l)for(d=r;d<r+o;d++)for(p=n;p<n+i;p++)e.setValue(d,p,c[d][p]);if(h){for(g=r;g<r+o;g++)for(m=n;m<n+i;m++)(b=h.Kf(g,m))&&h.fg(g,m,b,A);e.getCalcService().recalcRange(f,r,n,o,i)}return w.Worksheet.ao(e,"sortRangeChanged",{column:n,columnCount:i}),0<C&&(e._modelManager.WTa=C),y}Object.defineProperty(t,"__esModule",{value:!0}),r=s("@grapecity/js-sheets-common"),n=s("./dist/core/util/domUtil.js"),S=s("./dist/core/util/common.js"),w=s("./dist/core/worksheet/worksheet.js"),o=s("@grapecity/js-calc"),x=!!o,i=s("./dist/core/core.ns.js"),a=new r.Common.ResourceManager(i.SR),T=a.getResource.bind(a),B=r.Common.l.Ra,y=r.Common.k,j=r.Common.j.Fa,H="boolean",G="string",U="number",A=void 0,n.GC$.extend(w.Worksheet.prototype,{sortRange:function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b,y,C=this,w=C.getRowCount(),v=C.getColumnCount();if(-1===e&&(e=0),-1===r&&(r=w),-1===t&&(t=0),-1===n&&(n=v),e<0||w<=e||t<0||v<=t||r<0||w<e+r||n<0||v<t+n||!i)return!1;if(a=C.oec(S.kf(e,t,r,n),o,a),u=o?r:n,c=o?e:t,h=o?C.rowOutlines:C.columnOutlines,!s&&0<a.groupSort){if(!h)return!1;f=h.kec(c,u),o?(r=f.count,e=f.start):(n=f.count,t=f.start)}return x&&!C.Vq(e,t,r,n,!1)?(l&&C.Os(7,T().Exp_InvalidSortArrayFormulaInRange),!1):(d=C._modelManager.getSpans(S.kf(e,t,r,n)))&&0<d.length?(l&&C.Os(7,T().Exp_InvalidSortSpanInRange),!1):!(p=C.tables)||(m=1===(g=p.s$(e,t,r,n)).length&&g[0].dataRange().equals(S.kf(e,t,r,n)),g.length<=0||m)?((y=function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p,g;e.suspendPaint(),e.suspendEvent(),x&&e.suspendCalcService();try{if(u)for(h=[],f=t;f<t+n;f++)for(h[f]=[],d=r;d<r+o;d++)h[f][d]=e.getValue(f,d);return g=p=void 0,!!(p=l||(g=(0===s.groupSort?k:M)(e,t,r,n,o,i,a,s,h)).array)&&(c=I(e,g&&g.isChanged,t,r,n,o,i,a,u,p,h),!0)}finally{x&&e.resumeCalcService(!1),e.resumeEvent(),e.resumePaint(),e.Bu(t,r,n,o,c,4,A,A,A,!!l)}}(C,e,t,r,n,o,i,a,s,(b=C.wq)&&b.Ou||m&&g[0]&&g[0].LZ()))&&0!==a.groupSort&&C.xr&&C.xr.reFilter(),y):(l&&C.Os(7,T().Exp_InvalidSortPartTableOrMultiTableInRange),!1)},oec:function(e,t,r){var n,o=this.Tq(e),i=t?o.rowCount:o.colCount,a=t?o.row:o.col,s=t?this.rowOutlines:this.columnOutlines;return j(r)&&(r={}),this.outlineColumn&&this.outlineColumn.ZQa()&&t&&(n=this.outlineColumn.YQa.columnIndex,o.col<=n&&n<=o.col+o.colCount||(r.groupSort=0)),j(r.groupSort)&&(j(r.ignoreHidden)?r.groupSort=s&&s.pec(a,i)?1:0:r.groupSort=0),0===r.groupSort?r.ignoreHidden=!!j(r.ignoreHidden)||r.ignoreHidden:r.ignoreHidden=!1,r},hK:function(){var e=this.options;return!e.isProtected||e.protectionOptions.allowSort},wja:function(e,t,r,n){var o=this.getDataValidator(e,t),i=this.getDataValidator(r,n);this.setDataValidator(e,t,i),this.setDataValidator(r,n,o)}})},"./dist/core/worksheet/worksheet-static.js":function(e,t,it){"use strict";var r,at,o,n,st,lt,ut,ct,ht,ft,dt,pt,i,gt;function mt(e,t){return e.getRowCount(t)}function bt(e,t){return e.getColumnCount(t)}function yt(e,t,r){return e.$r(t,r)}function Ct(e,t,r){return e.Yr(t,r)}function wt(e,t,r,n){e.setColumnWidth(t,r,n)}function vt(e,t,r,n){e.setRowHeight(t,r,n)}function St(e,t,r,n){return e.getActualStyle(t,r,n)}function xt(e,t){return e.getDefaultStyle(t)}function Tt(e,t,r){e.setDefaultStyle(t,r)}function At(e,t,r,n,o){e.Pq(t,r,n,o)}function kt(e,t,r,n){throw Error(o.Common.u.Kb(gt().Exp_InvalidAndSpace,[e,t,r,n]))}function Mt(e,t,r){return t&&r.Ps&&r.Ps(e)}function E(e){if(!e)return e;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||ut(e))return e;if(e.clone)return e.clone();if(e instanceof Date)return new Date(e.valueOf());var t,r,n;for(r in t=e instanceof Object?new e.constructor:new e.constructor(e.valueOf()),e)e.hasOwnProperty(r)&&(n=e[r],e.hasOwnProperty(r)&&t[r]!==n&&(t[r]="object"==typeof n?E(n):n));return t.toString=e.toString,t.valueOf=e.valueOf,t}function It(e,t,r,n,o,i,a,s,l,u){var c=!(e===n&&e.name()===n.name()),h=e._modelManager,f=h.zl(u);c?(function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b,y=e.getSpans(ft,l),C=n.getSpans(ft,l),w=[];if(y)for(u=0;u<y.length;u++)h=(c=y[u]).row,f=c.col,d=c.rowCount,p=c.colCount,-1===t?r<=f&&f+p<=r+s&&w.push(at.kf(h,i+f-r,d,p)):-1===r?t<=h&&h+d<=t+a&&w.push(at.kf(o+h-t,f,d,p)):t<=h&&h<t+a&&r<=f&&f<r+s&&w.push(at.kf(o+h-t,i+f-r,d,p));if(C)for(u=0;u<C.length;u++)h=(c=C[u]).row,g=i<=(f=c.col)&&f<i+s,m=o<=h&&h<o+a,(-1===t?g:-1===r?m:m&&g)&&((b=n.findSpan(h,f,l))&&b.row===h&&b.col===f&&n.do("removeSpan",b,l));for(u=0;u<w.length;u++)n.do("addSpan",w[u],l)}(h,t,r,n._modelManager,o,i,a,s,u),l&&f&&h.do("clearSpan",t,r,a,s,u)):l?h.do("moveSpan",t,r,o,i,a,s,u):h.do("copySpan",t,r,o,i,a,s,u)}function Et(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I=!(e===n&&e.name()===n.name());if(2==(2&u)&&t<0)if(y=r,C=i,f=dt(mt(e,1),mt(n,1)),d=s,r<0&&(y=0,d=bt(e)),i<0&&(C=0),I)for(p=0;p<f;p++)for(g=0;g<d;g++)h(n,p,C+g,E(b=c(e,p,y+g,1)),1);else{for(m=new at.KTa,p=0;p<f;p++)for(g=0;g<d;g++)b=c(e,p,y+g,1),ut(b)||m.set(p,g,E(b));for(p=0;p<f;p++)for(g=0;g<d;g++)h(n,p,C+g,m.get(p,g),1)}if(1==(1&u)&&r<0)if(w=t,v=o,f=a,d=dt(bt(e,2),bt(n,2)),t<0&&(w=0,f=mt(e)),o<0&&(v=0),I)for(p=0;p<f;p++)for(g=0;g<d;g++)h(n,v+p,g,E(b=c(e,w+p,g,2)),2);else{for(m=new at.KTa,p=0;p<f;p++)for(g=0;g<d;g++)b=c(e,w+p,g,2),ut(b)||m.set(p,g,E(b));for(p=0;p<f;p++)for(g=0;g<d;g++)h(n,v+p,g,m.get(p,g),2)}if(x=r,T=o,A=i,k=a,M=s,(S=t)<0&&(S=0,k=dt(mt(e),mt(n))),r<0&&(x=0,M=dt(bt(e),bt(n))),o<0&&(T=0),i<0&&(A=0),I){for(p=0;p<k;p++)if(!Mt(T+p,l,n))for(g=0;g<M;g++)h(n,T+p,A+g,E(b=c(e,S+p,x+g,3)),3)}else{m=new at.KTa;try{for(p=0;p<k;p++)for(g=0;g<M;g++)b=c(e,S+p,x+g,3),ut(b)||m.set(p,g,E(b));for(p=0;p<k;p++)if(!Mt(T+p,l,n))for(g=0;g<M;g++)h(n,T+p,A+g,m.get(p,g),3)}catch(e){}}}function Rt(e,t,r,n,o,i,a,s,l,u,m,b){var y;m&&(y=at.kf(t,r,a,s)),Et(e,t,r,n,o,i,a,s,l,u,function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d=3===n,p=e._modelManager,g={};return d?(i=(m||b)&&p.getDynamicArrayInfo(t,r))&&i.isValid?(o=ht,m&&(g[a=[(f=i).row,f.col].join(",")]||(s=(g[a]=i).row,l=i.col,y.contains(s,l,1,1)&&p._getSheetModel(3).yIb(i)))):o=e.getValue(t,r,n,1):(o=p.getValue(t,r,n,!0,1),1===n&&ut(o)&&((u=e.wq)&&u.Ou&&(c=p.Jp(!1,3,r),h=e.options.colHeaderAutoTextIndex,c&&(0<=h&&t===h||-1===h&&t===mt(e,n)-1)&&(o=c.displayName||c.name)))),m&&(d?e.uq(t,r,ht,n,!1):e._modelManager.do("setValue",t,r,ht,n,!0,!0)),o},function(e,t,r,n,o){ut(n)?e.uq(t,r,ht,o,!1):e.uq(t,r,n,o,!1)})}function Dt(e,t,r){var n,o,i,a=e.Tq(t),s=a.row,l=a.col,u=a.rowCount,c=a.colCount;for(n=0;n<u;n++)for(o=r[s+n]=r[s+n]||{},i=0;i<c;i++)o[l+i]=!0}function Nt(e,t){return e===t&&e.name()===t.name()}function Ft(e){e.forEach(function(e){var t=e.sheet,r=e.r,n=e.c,o=e.value;t.setBindingPath&&t.setBindingPath(r,n,o)})}function h(e,t,r,n,o,i,a,s,l,u,c,h,f){var d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,Ee,Re,De,Ne,Fe,_e,Pe,Le,Oe,Be,je,He,Ge,Ue,We,Ve,ze,qe,Ze,Ye,Ke,Xe,Je,Qe,$e,et,tt,rt,nt,ot;if(function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g;if(!e)throw Error(gt().Exp_SrcIsNull);if(!n)throw Error(gt().Exp_DestIsNull);l=mt(e),u=bt(e),c=mt(n),h=bt(n),(t<-1||l<=t)&&kt("from row index",t,"-1",l-1),(r<-1||u<=r)&&kt("from column index",r,"-1",u-1),(o<-1||c<=o)&&kt("to row index",o,"-1",c-1),(i<-1||h<=i)&&kt("to column index",i,"-1",h-1),(f=r)<0&&(f=0,s=u),d=i<0?0:i,(s<1||u<f+s||h<d+s)&&kt("column count",s,"1",dt(u-f,h-d)),(p=t)<0&&(p=0,a=l),g=o<0?0:o,(a<1||l<p+a||c<g+a)&&kt("row count",a,"1",dt(l-p,c-g))}(e,t,r,n,o,i,a,s),h&&t<0)for(g=s,(p=r)<0&&(p=0,g=dt(bt(e),bt(n))),(m=i)<0&&(m=0),d=!0,b=0;b<g;b++)y=e._modelManager.Jp(!1,3,p+b),C=e._modelManager.Jp(!1,3,m+b),w=y&&y.name,v=C&&C.name,y&&C&&w&&v||(d=!1),(C=lt.GC$.extend(!0,{},n._modelManager.Jp(!1,3,m+b)||{})).displayName=y&&y.displayName,C.name=y&&y.name,n._modelManager.do("setItem",!1,3,m+b,C);0<(64&l)&&(function(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y={};if(e.tables)for(f=at.kf(t,r,a,s),d=at.kf(o,i,a,s),g=void 0,m=0,b=(p=e.tables.all()).length;m<b;m++)g=p[m].range(),f.containsRange(g)?Dt(e,g,y):g.containsRange(f)&&g.containsRange(d)?Dt(e,f,y):g.intersect(f.row,f.col,f.rowCount,f.colCount)&&g.containsRange(d)&&Dt(e,g.getIntersect(f),y);Et(e,t,r,n,o,i,a,s,l,u,function(e,t,r,n){var o=(3===n||ut(n))&&y[t]&&y[t][r],i=e.Dq(t,r,n,ft,ft,ft,ft,o,ft,ft,h);return c&&At(e,t,r,ht,n),i},function(e,t,r,n,o){At(e,t,r,n,o)})}(e,t,r,n,o,i,a,s,u,c,h,f),e.dJb||e.uja&&function(o,e,t,i,r,n,a,s,l,u){var c,h,f,d=o.uja.Dja;for(c in d)(h=d[c])&&((f=h.condition())&&f.initExpression());Et(o,e,t,i,r,n,a,s,l,0,function(e,t,r){var n=e.getDataValidator(t,r,3);return n&&(u&&e.setDataValidator(t,r,ht),Nt(o,i)&&(n.Nja=!0)),n},function(e,t,r,n){e.setDataValidator(t,r,n),Nt(o,i)&&n&&delete n.Nja})}(e,t,r,n,o,i,a,s,u,h)),0<(512&l)&&(U=t,W=r,V=n,z=o,q=i,Z=a,Y=s,K=h,J=(G=e).conditionalFormats,Q=V.conditionalFormats,$=Nt(G,V),J&&Q&&!G.dJb&&(X=J.XA(U,W,Q,z,q,Z,Y,$),K&&J.YA(U,W,Z,Y,X,$))),0<(1&l)&&0<(2&l)&&((x=e.tables)&&(S=x.dB(at.kf(pt(0,t),pt(0,r),t<0?dt(mt(e),mt(n)):a,r<0?dt(bt(e),bt(n)):s),h))),(T=st)&&(e.suspendCalcService(),n.suspendCalcService()),A=[],k=ht,M=[],0<(256&l)&&(B=h,j=[],H=[],Et(P=e,L=t,O=r,n,o,i,a,s,u,0,function(e,t,r){var n=e.getBindingPath&&e.getBindingPath(t,r);return n&&j.push({row:t-pt(0,L),col:r-pt(0,O),value:e.getValue(t,r)}),B&&P.setBindingPath&&P.setBindingPath(t,r,ht),n},function(e,t,r,n){H.push({sheet:e,r:t,c:r,value:n})}),A=(k={savedValues:j,bindingPathInfos:H}).savedValues,M=k.bindingPathInfos);try{if(0<(1&l)&&!d){if(Rt(e,t,r,n,o,i,a,s,u,c,h,0<(2&l)),Ft(M),st&&0==(2&l)&&n.clearFormula(o,i,a,s,function(e,t){return!u||!e.Ps||!e.Ps(t)}),0<(256&l))for(I=A.length,E=o<0?0:o,R=i<0?0:i,D=0;D<I;D++)N=A[D],!h&&Mt(E+N.row,u,n)||n.setValue(E+N.row,R+N.col,N.value)}else Ft(M);F=n.tables,0<(1&l)&&0<(2&l)&&F&&F.eB(S,pt(0,t),pt(0,r),pt(0,o),pt(0,i),h),st&&(h?(function(n,o,i,a,s,l,u,c){var h,f,d,p,e,g,t,r,m,b=it("SheetsCalc");if(b){if(h=b.uyb,p=n._modelManager.dUa(),!n.parent||!n.parent.sheets)return(e=n.getCustomNames())&&ct(e,function(e,t){f=t.getExpression(),(d=h(n,n,o,i,a,s,l,u,c,f))!==f&&t.fg(d,p)});for(g=n.parent.sheets,(t=n.parent.getCustomNames())&&ct(t,function(e,t){f=t.getExpression(),(d=h(null,n,o,i,a,s,l,u,c,f))!==f&&t.fg(d,p)}),r=function(r){var e=g[r].getCustomNames();e&&ct(e,function(e,t){f=t.getExpression(),(d=h(g[r],n,o,i,a,s,l,u,c,f))!==f&&t.fg(d,p)})},m=0;m<g.length;m++)r(m)}}(e,t,r,n,o,i,a,s),0<(2&l)&&(ee=e,te=t,re=r,ne=n,oe=o,ie=i,ae=a,se=s,(le=it("SheetsCalc"))&&le.CalcOperatorAdjustor.moveFormula(ee,te,re,ne,oe,ie,ae,se))):0<(2&l)&&((_=it("SheetsCalc"))&&_.vyb(e,t,r,n,o,i,a,s,u)),0<(1&l)&&0<(2&l)&&F&&F.R3(S))}finally{T&&(e.resumeCalcService(!1),n.resumeCalcService(!1))}if(0<(4&l)&&(ot=h,Et(e,t,r,n,o,i,a,s,u,0,function(e,t,r){var n=e._modelManager.Ky,o=n&&n.get(t,r);return o&&ot&&n.remove(t,r),o},function(e,t,r,n){var o=e._modelManager.Ky;o&&o.Cz(t,r,n)})),0<(128&l)&&(nt=h,Et(e,t,r,rt=n,o,i,a,s,u,c,function(e,t,r,n){var o=e.getTag(t,r,n);return!ut(o)&&nt&&e.setTag(t,r,ft),o},function(e,t,r,n,o){rt.setTag(t,r,n,o)})),0<(1024&l)&&(tt=h,Et(e,t,r,et=n,o,i,a,s,u,c,function(e,t,r,n){var o=e.getHyperlink&&e.getHyperlink(t,r,n);return!ut(o)&&tt&&e.setHyperlink&&e.setHyperlink(t,r,ft),o},function(e,t,r,n,o){et.setHyperlink&&et.setHyperlink(t,r,n,o)})),0<(16&l)&&(Ve=e,qe=r,Ze=n,Ye=o,Ke=i,Xe=a,Je=s,Qe=h,(ze=t)<0&&(ze=0,Xe=dt(mt(Ve),mt(Ze))),Ye<0&&(Ye=0),qe<0&&(qe=0,Je=dt(bt(Ve),bt(Ze))),Ke<0&&(Ke=0),!(Ve===Ze&&Ve.name()===Ze.name())?($e=Ze.ZA)&&(Qe?0<Ve.ZA.count()&&$e.$A(Ve,ze,qe,Ye,Ke,Xe,Je):$e._A(Ve,ze,qe,Ye,Ke,Xe,Je)):($e=Ve.ZA)&&(Qe?0<$e.count()&&$e.aB(ze,qe,Ye,Ke,Xe,Je):$e.Zz(ze,qe,Ye,Ke,Xe,Je))),0<(8&l)&&(t<0&&(Le=e,Be=n,je=i,He=s,Ge=h,(Oe=r)<0&&(Oe=0,He=dt(bt(Le),bt(Be))),je<0&&(je=0),Ue=Le.columnOutlines,We=Be.columnOutlines,!(Le===Be&&Le.name()===Be.name())?Ue&&We&&We.bB(Ue,Oe,je,He,Ge):Ue&&Ue.cB(Oe,je,He,Ge)),r<0&&(Me=e,Ee=n,Re=o,De=a,Ne=h,(Ie=t)<0&&(Ie=0,De=dt(mt(Me),mt(Ee))),Re<0&&(Re=0),Fe=!(Me===Ee&&Me.name()===Ee.name()),_e=Me.rowOutlines,Pe=Ee.rowOutlines,Fe?_e&&Pe&&Pe.bB(_e,Ie,Re,De,Ne):_e&&_e.cB(Ie,Re,De,Ne))),0<(32&l)&&(h||1!==a||1!==s)&&(me=e,Ce=n,we=o,ve=i,Se=a,xe=s,Te=h,ke=ye=r,(Ae=be=t)<0&&(Ae=0,Se=dt(mt(me),mt(Ce))),we<0&&(we=0),ke<0&&(ke=0,xe=dt(bt(me),bt(Ce))),ve<0&&(ve=0),be<0&&It(me,-1,ke,Ce,-1,ve,-1,xe,Te,1),ye<0&&It(me,Ae,-1,Ce,we,-1,Se,-1,Te,2),It(me,Ae,ke,Ce,we,ve,Se,xe,Te)),t<0&&o<=0&&function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p;for(t<0&&(t=0,o=dt(bt(e),bt(r))),n<0&&(n=0),s=0;s<o;s++)0<(64&i)&&(l=yt(e,s+t),ut(l)||(a&&wt(e,s+t,e.defaults.colWidth),wt(r,s+n,l)),u=e.getColumnVisible(s+t),ut(u)||(a&&e.setColumnVisible(s+t,!0),r.setColumnVisible(s+n,u)),(c=St(e,-1,s+t))?(At(r,-1,s+n,c.clone()),a&&At(e,-1,s+t,ht)):At(r,-1,s+n,ht),(c=St(e,-1,s+t,1))?(At(r,-1,s+n,c.clone(),1),a&&At(e,-1,s+t,ht,1)):At(r,-1,s+n,ht,1)),0<(128&i)&&(h=e.getTag(-1,s+t),ut(h)||(a&&e.setTag(-1,s+t,ft),r.setTag(-1,s+n,h)));for(f=dt(mt(e,1),mt(r,1)),d=0;d<f;d++)p=Ct(e,d,1),ut(p)||(a&&vt(e,d,e.defaults.colHeaderRowHeight,1),vt(r,d,p,1))}(e,r,n,i,s,l,h),r<0&&i<=0&&function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g;for(t<0&&(t=0,o=dt(mt(e),mt(r))),n<0&&(n=0),l=0;l<o;l++)!s&&Mt(n+l,a,r)||(0<(64&i)&&(u=Ct(e,l+t),ut(u)||(s&&vt(e,l+t,e.defaults.rowHeight),vt(r,l+n,u)),c=e.getRowVisible(l+t),ut(c)||(s&&e.setRowVisible(l+t,!0),r.setRowVisible(l+n,c)),(h=St(e,l+t,-1))?(At(r,l+n,-1,h.clone()),s&&At(e,l+t,-1,ht)):At(r,l+n,-1,ht),(h=St(e,l+t,-1,2))?(At(r,l+n,-1,h.clone(),2),s&&At(e,l+t,-1,ht,2)):At(r,l+n,-1,ht,2)),0<(128&i)&&(f=e.getTag(l+t,-1),ut(f)||(s&&e.setTag(l+t,-1,ft),r.setTag(l+n,-1,f))));for(d=dt(bt(e,2),bt(r,2)),p=0;p<d;p++)g=yt(e,p,2),ut(g)||(s&&wt(e,p,e.defaults.rowHeaderColWidth,2),wt(r,p,g,2))}(e,t,n,o,a,l,u,h),t<0&&o<=0&&r<0&&i<=0&&(he=l,fe=h,(ue=e)===(ce=n)&&ue.name()===ce.name()||(0<(64&he)&&(de=xt(ue),Tt(ce,fe?de:de.clone()),de=xt(ue,1),Tt(ce,fe?de:de.clone(),1),de=xt(ue,2),Tt(ce,fe?de:de.clone(),2),fe&&(Tt(ue,ht),Tt(ue,ht,1),Tt(ue,ht,2))),pe=ce.defaults,ge=ue.defaults,pe.colWidth=ge.colWidth,pe.rowHeight=ge.rowHeight,pe.rowHeaderColWidth=ge.rowHeaderColWidth,pe.colHeaderRowHeight=ge.colHeaderRowHeight,fe&&(ge.colWidth=62,ge.rowHeight=20,ge.rowHeaderColWidth=40,ge.colHeaderRowHeight=20))),h&&t<0)for(g=s,(p=r)<0&&(p=0,g=dt(bt(e),bt(n))),b=0;b<g;b++)e.getDataColumnName&&e.getDataColumnName(p+b)&&e._modelManager.do("setItem",!1,3,p+b,ht)}Object.defineProperty(t,"__esModule",{value:!0}),r=it("./dist/core/core.ns.js"),at=it("./dist/core/util/common.js"),o=it("@grapecity/js-sheets-common"),n=it("@grapecity/js-calc"),st=!!n,lt=it("./dist/core/util/domUtil.js"),ut=o.Common.j.Fa,ct=lt.GC$.each,ht=null,ft=void 0,dt=Math.min,pt=Math.max,i=new o.Common.ResourceManager(r.SR),gt=i.getResource.bind(i),t.staticMembers={copyTo:function(e,t,r,n,o,i,a,s,l,u,c){h(e,t,r,n,o,i,a,s,l,u,c,!1)},moveTo:function(e,t,r,n,o,i,a,s,l,u){h(e,t,r,n,o,i,a,s,l,ft,3,!0,u)}}},"./dist/core/worksheet/worksheet-ui.js":function(e,t,u){"use strict";var r,p,n,g,o,i,a,s,c,m,b,y,l,h;function C(e){return Math.abs(e)}function f(e,t){var s=e,l=t;return function(e){var t,r,n=this.sheet,o=this.row,i=this.col,a=this.sheetArea;if(0===arguments.length)return s.call(n,o,i,a);if(0<=o&&0<=i)for(t=o;t<o+this.rowCount;t++)for(r=i;r<i+this.colCount;r++)w(n,t,r,a)&&l.call(n,t,r,e,a);return this}}function w(e,t,r,n){var o=e.getRowCount(n),i=e.getColumnCount(n);return r<0&&0<=t&&t<o||t<0&&0<=r&&r<i||0<=t&&t<o&&0<=r&&r<i}function d(e,t,r,n,o,i){var a,s,l,u,c,h,f,d;w(e,t,r,i)&&("string"==typeof(a=(a=e.Aj(t,r,i))||new p.Style)&&(s=a,(a=new p.Style).parentName=s),"font"===n&&(u=o,y((l=a).themeFont)||(c=m(),h=c.style,f=l.font,h.font=f,d=f&&h.fontFamily,((h.font=u)&&h.fontFamily)!==d&&(l.themeFont=b))),a[n]=o,e.setStyle(t,r,a,i))}function v(e,t,r,n,o,i){t<0&&(t=n=-1),r<0&&(r=o=-1),this.sheet=e,this.row=t,this.rowCount=y(n)?1:n,this.col=r,this.colCount=y(o)?1:o,this.sheetArea=y(i)?3:i}function S(e){var t,r,n,o,i,a,s,l,u,c,h,f,d=e.split(":"),p=d[0],g=d[1],m=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(+p)){if((n=p.match(m))[3])return null;t=n[1],r=n[2]}else r=p;if(p&&!g){if(t&&r)return[o=x(r),T(t),1,1]}else if(p&&g){if(a=i=void 0,isNaN(+g)){if((s=g.match(m))[3])return null;i=s[1],a=s[2]}else a=g;if(!t&&r&&!i&&a)return l=x(r),u=x(a),[o=Math.min(l,u),-1,c=C(l-u)+1,-1];if(t&&!r&&i&&!a)return h=T(t),f=T(i),[-1,Math.min(h,f),-1,C(h-f)+1];if(t&&r&&i&&a)return l=x(r),u=x(a),h=T(t),f=T(i),o=Math.min(l,u),c=C(l-u)+1,[o,Math.min(h,f),c,C(h-f)+1]}return null}function x(e){return parseInt(e,10)-1}function T(e){var t,r,n=0,o=e.length;for(t=0;t<o;t++)r=e[t].charCodeAt(0)-64,n+=Math.pow(26,o-t-1)*r;return n-1}Object.defineProperty(t,"__esModule",{value:!0}),r=u("./dist/core/worksheet/worksheet.js"),p=u("./dist/core/worksheet/style.js"),n=u("./dist/core/util/domUtil.js"),g=u("./dist/core/util/common.js"),o=u("@grapecity/js-sheets-common"),i=u("./dist/core/core.enum.js"),a=u("@grapecity/js-calc"),s=u("./dist/core/worksheet/clipboardhelper.js"),c=!!a,m=g.util.tt,b=void 0,y=o.Common.j.Fa,l=r.Worksheet.prototype,v.prototype.tag=function(e){var t,r,n=this.sheet,o=this.row,i=this.col,a=this.rowCount,s=this.colCount,l=this.sheetArea;if(0===arguments.length)return n.getTag(o,i,l);if(0<=o&&0<=i)for(t=o;t<o+a;t++)for(r=i;r<i+s;r++)n.setTag(t,r,e,l);else if(0<=o)for(t=o;t<o+a;t++)n.setTag(t,-1,e,l);else if(0<=i)for(r=i;r<i+s;r++)n.setTag(-1,r,e,l);return this},v.prototype.width=function(e){var t,r=this.sheet,n=this.row,o=this.col,i=this.sheetArea;if(0!==arguments.length){if(n<0)for(t=0;t<this.colCount;t++)r.setColumnWidth(t+o,e,i);return this}if(n<0)return r.getColumnWidth(o,i)},v.prototype.height=function(e){var t,r=this.sheet,n=this.row,o=this.col,i=this.sheetArea;if(0!==arguments.length){if(o<0)for(t=0;t<this.rowCount;t++)r.setRowHeight(t+n,e,i);return this}if(o<0)return r.getRowHeight(n,i)},v.prototype.visible=function(e){var t,r,n=this.sheet,o=this.row,i=this.col,a=this.sheetArea;if(0===arguments.length)return i<0&&0<=o?n.getRowVisible(o,a):0<=i&&o<0?n.getColumnVisible(i,a):void 0;if(i<0&&0<=o)for(t=0;t<this.rowCount;t++)n.setRowVisible(t+o,e,a);else if(0<=i&&o<0)for(r=0;r<this.colCount;r++)n.setColumnVisible(r+i,e,a);return this},v.prototype.resizable=function(e){var t,r,n=this.sheet,o=this.row,i=this.col,a=this.sheetArea;if(0===arguments.length)return i<0&&0<=o?n.getRowResizable(o,a):0<=i&&o<0?n.getColumnResizable(i,a):void 0;if(i<0&&0<=o)for(t=0;t<this.rowCount;t++)n.setRowResizable(t+o,e,a);else if(0<=i&&o<0)for(r=0;r<this.colCount;r++)n.setColumnResizable(r+i,e,a);return this},v.prototype.tq=function(e){return this.sheet.tq(this.row,this.col,e,this.sheetArea)},v.prototype._w=function(e,t){var r,n,o=this.sheet,i=this.row,a=this.col,s=this.rowCount,l=this.colCount,u=this.sheetArea;if(0<=i&&0<=a)for(r=i;r<i+s;r++)for(n=a;n<a+l;n++)d(o,r,n,e,t,u);else if(0<=i)for(n=-1,r=i;r<i+s;r++)d(o,r,n,e,t,u);else if(0<=a)for(r=-1,n=a;n<a+l;n++)d(o,r,n,e,t,u);return this},v.prototype.clear=function(e){this.sheet.clear(this.row,this.col,this.rowCount,this.colCount,this.sheetArea,e)},v.prototype.setBorder=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d=this.sheet,p=this.sheetArea;d.suspendPaint();try{if(r=new g.Range(this.row,this.col,this.rowCount,this.colCount),o=(n=d.Tq(r,p)).row,i=n.col,a=n.rowCount,s=n.colCount,u=l=void 0,c=t.all,h=t.outline,f=t.inside,t.left||c||h)for(l=0;l<a;l++)d.getCell(o+l,i,p).borderLeft(e);if(t.top||c||h)for(u=0;u<s;u++)d.getCell(o,i+u,p).borderTop(e);if(t.right||c||h)for(l=0;l<a;l++)d.getCell(o+l,i+s-1,p).borderRight(e);if(t.bottom||c||h)for(u=0;u<s;u++)d.getCell(o+a-1,i+u,p).borderBottom(e);if(t.diagonalUp)for(l=0;l<a;l++)for(u=0;u<s;u++)d.getCell(o+l,i+u,p).diagonalUp(e);if(t.diagonalDown)for(l=0;l<a;l++)for(u=0;u<s;u++)d.getCell(o+l,i+u,p).diagonalDown(e);if(t.innerHorizontal||c||f)for(l=0;l<a-1;l++)for(u=0;u<s;u++)d.getCell(o+l,i+u,p).borderBottom(e),d.getCell(o+l+1,i+u,p).borderTop(e);if(t.innerVertical||c||f)for(u=0;u<s-1;u++)for(l=0;l<a;l++)d.getCell(o+l,i+u,p).borderRight(e),d.getCell(o+l,i+u+1,p).borderLeft(e)}finally{d.resumePaint()}},v.prototype.toHtml=function(e,t){return void 0===e&&(e=i.HeaderOptions.noHeaders),void 0===t&&(t=!0),this.sheetArea===i.SheetArea.corner?"":s.S4.Q4(this.sheet,e,this.row,this.rowCount,this.col,this.colCount,this.sheetArea,t,[],[],!0,!0,t,!0)},v.Pl=f,h=v,(t.CellRange=h).prototype.value=f(l.getValue,l.setValue),h.prototype.text=f(l.getText,l.setText),h.prototype.formula=f(function(e,t){return c&&this.getFormula(e,t)},function(e,t,r,n){c&&this.setFormula(e,t,r,n)}),h.prototype.styleName=f(l.getStyleName,l.setStyleName),n.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation"],function(e,t){h.prototype[t]=function(e){return 0===arguments.length?this.tq(t):this._w(t,e)}}),t.Hgc=S,t.Igc=T,n.GC$.extend(l,{getRange:function(){var e,t,r,n,o,i,a,s,l=arguments[0];if("string"==typeof l){if(i=l.toUpperCase(),this.parent&&1===this.parent.options.referenceStyle)return null;if(o=arguments[1],1<(i=i.replace(/[^\:]+\!/g,"").replace(/\$/g,"")).split(",").length)return null;if(c){if(!(a=u("SheetsCalc").formulaToRange(this,i,b,b,o)))return null;e=a.row,t=a.col,r=a.rowCount,n=a.colCount}else{if(!(s=S(i)))return null;e=s[0],t=s[1],r=s[2],n=s[3]}}else"number"==typeof l&&(e=l,t=arguments[1],r=arguments[2],n=arguments[3],o=arguments[4]);return new h(this,e,t,r,n,o)},getCell:function(e,t,r){return y(t)&&(t=-1),new h(this,e,t,1,1,r)}})},"./dist/core/worksheet/worksheet.js":function(e,t,c){"use strict";var r,O,n,o,B,D,h,i,f,a,M,s,l,T,d,u,p,g,m,j,b,y,C,w,v,S,x,A,k,I,E,R,N,F,_,H,G,P,L,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue;function ce(e,t){var r,n,o,i,a=[],s=e._modelManager.hUa();if(s)for(r in s)if(x(s,r)&&((n=s[r])&&(t||"n"!==n.rs||(o={row:+r,item:e.getDataItem&&e.getDataItem(+r)},a.push(o)),t&&"e"===n.rs)))for(i in n)if(!_(i)&&n[i]){(o={row:+r,item:e.getDataItem&&e.getDataItem(+r)}).originalItem=n.originalItem,a.push(o);break}return a}function he(e,t,r){var n,o=0;for(n=t;n<=r;n++)o+=e._m(n);return o}function fe(e,t,r){var n,o=0;for(n=t;n<=r;n++)o+=e.Sl(n);return o}function de(e){return e.getColumnCount()}function pe(e){return e.getRowCount()}function ge(e){return e.frozenTrailingColumnCount()}function me(e){return e.frozenTrailingRowCount()}function be(e){return e.frozenColumnCount()}function ye(e){return e.frozenRowCount()}function Ce(e,r,n){Object.defineProperty(e,r,{get:function(){return this["_"+r]},set:function(e){var t=this["_"+r];t!==e&&(this["_"+r]=e,n&&n(r,e,t))}})}function we(e,t,r,n){return{row:t,col:r,newValue:e.getValue(t,r),oldValue:n}}function ve(e){var n=this;n.yn=ve.Np,ve.Np++,n.options=C(ie,function(e,t,r){n.Op(e,t,r)}),n.ad(e),n.fgc=new o.Tasks(function(){return this.tasks.pop()},function(){var e=n.parent;return e&&e.ku.Gw||n._eventHandler._isWorking||n._eventHandler.xG||n._eventHandler.eG})}Object.defineProperty(t,"__esModule",{value:!0}),r=c("./dist/core/core.ns.js"),O=c("./dist/core/util/common.js"),n=c("./dist/core/util/imageLoader.js"),o=c("./dist/core/util/tasks.js"),B=c("./dist/core/worksheet/style.js"),D=c("./dist/core/worksheet/worksheet-model.js"),h=c("./dist/core/util/domUtil.js"),i=c("./dist/core/celltype/textcelltype.js"),f=c("@grapecity/js-calc"),a=c("./dist/core/celltype/headercelltype.js"),M=c("./dist/core/core.enum.js"),s=c("@grapecity/js-sheets-common"),l=c("@grapecity/js-calc"),T=!!l,u=c("./dist/core/util/theme.js"),p=c("./dist/core/worksheet/stylehelper.js"),g=O.util.n0a,m=O.util.lHb,j=s.Common.j.Fa,b=O.util.Nl,y=O.util.Pl,C=O.util.Ql,w=O.util.bq,v=h.GC$.each,S=h.GC$.isEmptyObject,x=s.Common.D,A=O.util.x0a,k=O.util.w0a,I=RegExp("^\\d*(\\.\\d+)?\\*$"),E=s.Common.u,R=document,N=parseInt,F=parseFloat,_=isNaN,H=null,G=void 0,P=Math.min,L=Math.max,U=Math.floor,W=Math.ceil,V="undefined",z="string",q="width",Z="height",Y="tag",K="onLayoutChanged",X="onPaintSuspend",J="isVisible",Q="resizable",$=".gcSheet",ee=".gcSheetInternal",te={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},re=new s.Common.ResourceManager(r.SR),ne=re.getResource.bind(re),(le=oe=t.ClearPendingChangeType||(t.ClearPendingChangeType={}))[le.dirty=1]="dirty",le[le.insert=2]="insert",le[le.delete=4]="delete",(ue=t.InvalidType||(t.InvalidType={}))[ue.setFormula=0]="setFormula",ue[ue.copyPaste=1]="copyPaste",ue[ue.dragFill=2]="dragFill",ue[ue.dragDrop=3]="dragDrop",ue[ue.changePartOfArrayFornula=4]="changePartOfArrayFornula",ue[ue.changeSheetName=5]="changeSheetName",ue[ue.table=6]="table",ue[ue.hideSheet=7]="hideSheet",ie={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:"black",rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:H,selectionBackColor:H,selectionBorderColor:H,allowCellOverflow:!0,showFormulas:!1,isProtected:!1,protectionOptions:{},gridline:{},sheetAreaOffset:{left:0,top:0}},ve.prototype.Op=function(e,r,t){var n,o,i,a,s=this,l=s.parent;switch(e){case"allowCellOverflow":case"showFormulas":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":s.$p();break;case"sheetAreaOffset":n=function(e,t){t<0&&(s.options.sheetAreaOffset[e]=0),s.$p()},o=s.options.sheetAreaOffset,["left","top"].forEach(function(e){var t=r[e];Ce(o,e,n),o[e]=t});break;case"gridline":i=function(){s.$p()},a=s.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach(function(e){var t=r[e];Ce(a,e,i),a[e]=t});break;case"isProtected":r&&l&&l.undoManager().PY(function(e){return e.sheetId!==s.yn}),s._p(),ve.ao(s,"onProtectChanged"),s.$p();break;case"protectionOptions":s._p(),ve.ao(s,"onProtectChanged");break;case"sheetTabColor":l&&l.aq()}},ve.prototype.name=function(e){var t=this.parent;if(0===arguments.length)return this._modelManager?this._modelManager.getName():"";if(!w(e,t?t.sheets:null,this))throw ne().Exp_NotSupported;return this.cq(e),t&&t.aq(),this},ve.prototype.isSelected=function(e){return this.DHb(e)},ve.prototype.DHb=function(e,t){var r,n,o=this,i=o.parent,a=!!o._modelManager&&o._modelManager.TIb();return j(e)?a:(e!==a&&(r=o.name(),n=void 0,t&&(n={oldValue:a,newValue:e,sheetName:r,propertyName:"isSelected",cancel:!1,sheetIndex:o.parent.getSheetIndex(r)},o.parent.Wq(O.Events.SheetChanging,n)),(!t||n&&!1===n.cancel)&&(o._modelManager.CHb(e),i&&i.hq&&i.hq.repaint(),t&&o.parent.Wq(O.Events.SheetChanged,{oldValue:a,newValue:e,sheetName:r,propertyName:"isSelected",sheetIndex:o.parent.getSheetIndex(r)}))),o)},ve.prototype.cq=function(e,t){var r=this.name();t||ve.ao(this,"beforeSetName",{oldName:r,newName:e}),this._modelManager.do("setName",e),t||ve.ao(this,"setName",{oldName:r,newName:e})},ve.prototype.addRows=function(e,t,r){var n,o,i,a;if(!(t<=0)){o=pe(n=this),(e<0||o<e)&&(e=o),0===n._modelManager.WTa&&n.parent&&n.parent.pv.clear(),n.suspendPaint();try{if(n.eJb(!1),i={changeType:"addingRows",row:e,rowCount:t,canAdd:!0},ve.ao(n,K,i),!i.canAdd)return;j(i.newRow)||(e=i.newRow),a="addRows",n.pCb(e,3,a,t,o),this._modelManager.do("addRows",e,t),n.jq=!0,ve.ao(n,K,{changeType:a,row:e,oldValue:o,rowCount:t,rowExpand:r}),ve.ao(n,K,{changeType:"addRows2",row:e,oldValue:o,rowCount:t}),n.tables&&n.tables.Cec(!0,e),n.kq(e,3,a,t,o)}finally{n.eJb(!0),n.resumePaint()}}},ve.prototype.eJb=function(e){var t=this.Jl,r=this.Kl;this._modelManager.setCellState(t,r,M.CellStatesType.active,e,M.SheetArea.viewport)},ve.prototype.deleteRows=function(e,t){var r,n,o,i,a,s,l,u=this,c=pe(u);if(!(e<0||c<=e||t<=0)){0===u._modelManager.WTa&&u.parent&&u.parent.pv.clear(),u.suspendPaint();try{if(u.eJb(!1),r={changeType:"deletingRows",row:e,rowCount:t,canDelete:!0},ve.ao(u,K,r),!r.canDelete)return;if(n="deleteRows",u.pCb(e,3,n,t,c),u.RIb(e,t,0,this.getColumnCount()),u._modelManager.do("deleteRows",e,t),0<=(o=u.lq)){for(i=-1,a=ye(u),s=o;a<=s;s--)if(u.getRowVisible(s)&&0<u.Sl(s)){i=s;break}-1===i&&(i=0),o!==i&&u.mq(i)}l=c,u.getActiveRowIndex()>=l&&u.setActiveCell(l-1,u.getActiveColumnIndex()),u.jq=!0,ve.ao(u,K,{changeType:n,row:e,oldValue:c,rowCount:t}),u.tables&&u.tables.Cec(!0,e),u.kq(e,3,n,t,c)}finally{u.eJb(!0),u.resumePaint()}}},ve.prototype.addColumns=function(e,t){var r,n,o,i;t<=0||(n=de(r=this),(e<0||n<e)&&(e=n),0===r._modelManager.WTa&&r.parent&&r.parent.pv.clear(),o={changeType:"addingColumns",col:e,colCount:t,canAdd:!0},ve.ao(r,K,o),o.canAdd&&(r.eJb(!1),i="addColumns",r.qCb(e,3,i,t,n),r._modelManager.do("addColumns",e,t),r.oq=!0,ve.ao(r,K,{changeType:i,col:e,oldValue:n,colCount:t}),ve.ao(r,K,{changeType:"addColumns2",col:e,oldValue:n,colCount:t}),r.tables&&r.tables.Cec(!1,e),r.pq(e,3,i,t,n),r.eJb(!0),r.$p()))},ve.prototype.deleteColumns=function(e,t){var r,n,o,i,a,s,l,u=this,c=de(u);if(!(e<0||c<=e||t<=0)&&(0===u._modelManager.WTa&&u.parent&&u.parent.pv.clear(),r={changeType:"deletingColumns",col:e,colCount:t,canDelete:!0},ve.ao(u,K,r),r.canDelete)){if(u.eJb(!1),n="deleteColumns",u.RIb(0,this.getRowCount(),e,t),u.qCb(e,3,n,t,c),u._modelManager.do("deleteColumns",e,t),0<=(o=u.qq)){for(i=-1,a=be(u),s=o;a<=s;s--)if(u.getColumnVisible(s)&&0<u.Tl(s)){i=s;break}-1===i&&(i=0),o!==i&&u.rq(i)}l=c,u.getActiveColumnIndex()>=l&&u.setActiveCell(u.getActiveRowIndex(),l-1),u.oq=!0,ve.ao(u,K,{changeType:n,col:e,oldValue:c,colCount:t}),ve.ao(u,K,{changeType:"deleteColumns2",col:e,oldValue:c,colCount:t}),u.tables&&u.tables.Cec(!1,e),u.pq(e,3,n,t,c),u.eJb(!0),u.$p()}},ve.prototype.getRowCount=function(e){return 0===e?0:this._modelManager.getRowCount(e)},ve.prototype.getColumnCount=function(e){return 0===e?0:this._modelManager.getColumnCount(e)},ve.prototype.setRowCount=function(e,t){var r;j(t)&&(t=3),r={changeType:"settingRowCount",rowCount:e,sheetArea:t,canSet:!0},ve.ao(this,K,r),r.canSet&&this.setRowCountCore(e,t)},ve.prototype.setRowCountCore=function(e,t){var r,n;e=N(e,10),_(e)||(j(t)&&(t=3),n=(r=this).getRowCount(t),e<0||e===n||(3===t||2===t?(r._modelManager.do("setRowCount",e,t),ye(r)>e&&r.frozenRowCount(e)):1===t&&r._modelManager.do("setRowCount",e,t),ve.ao(r,K,{changeType:"setRowCount",rowCount:e,sheetArea:t}),r.jq=!0,r.Jl>=e&&(3===t||2===t)&&r.setActiveCell(e-1,r.getActiveColumnIndex()),r.$p(),r.clearPendingChanges()))},ve.prototype.setColumnCount=function(e,t){var r,n;e=N(e,10),_(e)||(n=(r=this).getColumnCount(t),e<0||e===n||(j(t)&&(t=3),3===t||1===t?(r._modelManager.do("setColumnCount",e,t),be(r)>e&&r.frozenColumnCount(e)):2===t&&r._modelManager.do("setColumnCount",e,t),ve.ao(r,K,{changeType:"setColumnCount",colCount:e,sheetArea:t}),r.oq=!0,r.Kl>=e&&(3===t||1===t)&&r.setActiveCell(r.getActiveRowIndex(),e-1),r.$p(),r.clearPendingChanges()))},ve.prototype.aHb=function(e,t,r){var n,o;return(d=d||c("SheetsCalc"))&&(n="string"==typeof r&&this.parent&&this.parent.aJb(r))&&-1!==e&&-1!==t?(o=n.getExpression(),d.evaluateExpression(this,o,e,t)):G},ve.prototype.xHb=function(e,t,r){var n;if(this.options.showFormulas&&3===r){if(n=this.getFormula(e,t))return"="!==n[0]&&(n="="+n),n;if(this._modelManager&&this._modelManager.ZHb&&this._modelManager.ZHb.getAnchorInfo(e,t))return""}},ve.prototype.getText=function(e,t,r){var n,o,i,a,s,l;return j(r)&&(r=3),n=this.xHb(e,t,r),j(n)?(o=this.getCellType(e,t,r),i=this.getValue(e,t,r),a=(a=this.tq(e,t,"formatter",r))||this.tq(e,t,"_autoFormatter",r),s={},l=this.tq(e,t,"quotePrefix",r),(i=o.format(i,a,s,{sheet:this,row:e,col:t,sheetArea:r,quotePrefix:l}))&&"string"==typeof i&&(i=i.replace(/\r\n?/g,"\n")),i):n},ve.prototype.setText=function(e,t,r,n){var o,i,a,s,l,u;j(n)&&(n=3),i={value:o=r},ve.ao(this,"settingText",i),a=r=i.value,s=this.getCellType(e,t,n),l=this.getFormatter&&this.getFormatter(e,t,n),s&&l&&!m(l)&&(u={sheet:this,row:e,col:t,sheetArea:n},a=s.parse(o,l,u),a=j(a)?r:a),this.uq(e,t,a,n),this.$p()},ve.prototype.getValue=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p;return 0===r?H:(j(r)&&(r=3),o=this.options,a=(i=this._modelManager).getRowCount(r),s=i.getColumnCount(r),l=this.vq(i,e,t,r,n),1===r?j(l)&&((c=this.wq)&&c.Ou&&(h=this._modelManager.Jp(!1,3,t),f=o.colHeaderAutoTextIndex,h&&(0<=f&&e===f||-1===f&&e===a-1)&&(l=h.displayName||h.name)),j(l)&&(((u=o.colHeaderAutoTextIndex)<0||a<=u)&&(u=a-1),e===u&&(2===(d=o.colHeaderAutoText)?l=O.util.xq(t+1):1===d&&(l=t+1)))):2===r&&j(l)&&(((u=o.rowHeaderAutoTextIndex)<0||s<=u)&&(u=s-1),t===u&&(2===(p=o.rowHeaderAutoText)?l=O.util.xq(e+1):1===p&&(l=e+1))),l)},ve.prototype.setValue=function(e,t,r,n,o){var i,a;this.uq(e,t,r,n,o),(i=this.parent)?(a=i.getActiveSheet())&&a.$p():this.$p()},ve.prototype.eyb=function(e,t,r,n){!n&&T&&this.zq(e,t,r),this.t4&&this.t4(e,t,1,1,r)},ve.prototype.fyb=function(){var e=this.conditionalFormats;e&&e.Nm()},ve.prototype.uq=function(e,t,r,n,o){var i,a,s;0!==n&&(j(n)&&(n=3),a=(i=this._modelManager).getRowCount(n),s=i.getColumnCount(n),e<0||a<=e||t<0||s<=t||(r=A(r),r=g(r),i.do("setValue",e,t,r,n),this.eyb(e,t,n,o),this.fyb()))},ve.prototype.AHb=function(e,t,r,n,o,i){var a;return a=this.getActualStyle(e,t,r,n,o,i),function(e,t,r,n,o){if((-1!==t||-1!==r)&&(j(o)&&(o=3),3===o)){var i=e.tables&&e.tables.find(t,r);i&&i.NZ&&t===i.footerIndex()&&ae.ao(e,"composeTableFooterList",{table:i,row:t,col:r,style:n})}}(this,e,t,a,r),a},ve.prototype.getActualStyle=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L;if(j(r)&&(r=3),0===r)return new B.Style;if(-1===e&&-1===t)return this.getDefaultStyle(r);if(f=(a=this).Cq,v="__spreadJSDefault",S="__undefined",u=(x=this._modelManager).getStyle(e,t,r),c=x.getStyle(e,-1,r),h=x.getStyle(-1,t,r),u=u||H,c=c||H,h=h||H,y=S,T=a.parent&&a.parent.GBb,u&&(y=u.charAt?u:v+u.yn),C=S,c&&(C=c.charAt?c:v+c.yn),w=S,h&&(w=h.charAt?h:v+h.yn),d=(b=f[r])[y],A=a.tables,k=3===r&&A&&!i?A.find(e,t):H,M=3===r&&a.pivotTables&&a.pivotTables.Wic(e,t),k||M||((g=(d=d||(b[y]={}))[C])?m=g[w]:g=d[C]={}),m||(l=a.Dq(e,t,r,u,c,h,k,G,i,M)),3!==r||n||(m||(I=l.formatter)&&I.hasFormatedColor&&I.hasFormatedColor()&&!i&&(E={value:H},I.format(a.getValue(e,t),E),E.value&&((s=new B.Style).foreColor=E.value)),(R=a.conditionalFormats)&&(s=R.Eq(s,e,t,r))),s)p=m||l,s.Yo(p),s&&s.font&&p&&p.font&&s.font!==p.font&&(s.font=(F=s,_=p,P=O.util.Pxb(F.font),L=O.util.Pxb(_.font),P.fontStyle+" "+P.fontWeight+" "+L.fontSize+" "+L.fontFamily)),l=s;else if(m)return!a.cellStates||n||T||(D=a.cellStates.getStyle(e,t,r,H,m.locked))&&(D.Yo(m),(m=D).Zo(a.Pm)),o?m:m.clone(!0);return j(l.locked)&&(l.locked=!0),l=l.Zo(a.Pm),s||k||M||(g[w]=l.clone(!0)),!a.cellStates||n||T||(N=a.cellStates.getStyle(e,t,r,H,l.locked))&&(N.Yo(l),l=(l=N).Zo(a.Pm)),l},ve.prototype.tq=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b;if(0===n)return G;for(j(n)&&(n=3),s=this._modelManager,u=!1,3===n&&("foreColor"===r&&(h=this.tq(e,t,"formatter",n))&&h.hasFormatedColor&&h.hasFormatedColor()&&(f={value:H},h.format(this.getValue(e,t),f),f.value&&(l=f.value,u=!0)),(d=this.conditionalFormats)&&0<d.count()&&(u=(p=d.Fq(e,t,r,n)).v5,l=p.Fi)),g=0;!u&&g<=4;)if(0===g?o=s.getStyle(e,t,n):1===g?(m=this.tables,(b=3===n&&m?m.find(e,t):H)&&te[r]&&(o=b.Gq(e,t,r))):o=2===g?s.getStyle(e,-1,n):3===g?s.getStyle(-1,t,n):this.getDefaultStyle(n),g++,o&&o.charAt&&typeof o==z&&(o=this.Hq(o)),o){if("font"===r&&o.themeFont&&!c&&(c=o.themeFont),o[r]!==G){l=o[r],u=!0;break}for(i=o.parentName;i&&(a=this.Hq(i));){if(a[r]!==G){l=a[r],u=!0;break}i=a.parentName}}return"locked"===r?!!j(l)||l:u||c?("foreColor"!==r&&"backColor"!==r&&"font"!==r&&"borderLeft"!==r&&"borderTop"!==r&&"borderRight"!==r&&"borderBottom"!==r||((o=new B.Style)[r]=l,"font"===r&&c&&(o.themeFont=c),o.Zo(this.Pm),l=o[r]),l):G},ve.prototype.getStyle=function(e,t,r){return this.Iq(e,t,r,!0)},ve.prototype.Iq=function(e,t,r,n){var o,i,a;if(j(r)&&(r=3),0!==r){if((o=this._modelManager.getStyle(e,t,r))instanceof B.Style)return n&&this.Jq(),o;if(typeof o==z&&(i=this.Hq(o))!==H&&i!==G)return(a=new B.Style).Yo(i,!1),n&&this.Jq(),a}return H},ve.prototype.addNamedStyle=function(e){this.Kq(e),this.$p()},ve.prototype.Kq=function(e){if(e){if(!e.name)throw Error(ne().Exp_EmptyNamedStyle);var t=e.name.toUpperCase();this.Lq[t]=e}},ve.prototype.getNamedStyle=function(e){return this.Mq(e,!0)},ve.prototype.Mq=function(e,t){var r,n=this.Lq;return n&&e?((r=n[e=e.toUpperCase()])&&t&&this.Jq(),r):H},ve.prototype.Jq=function(){this.Cq=[{},{},{},{}]},ve.prototype.removeNamedStyle=function(e){var t,r=this.Lq;r&&e&&(e=e.toUpperCase(),x(r,e)&&((t=r[e].formatter)&&"string"==typeof t&&this.parent.QHb[t]&&this.parent.RHb(t),delete r[e],this.Jq(),this.$p()))},ve.prototype.getNamedStyles=function(){var r=[],e=this.Lq;return e&&v(e,function(e,t){r.push(t)}),this.Jq(),r},ve.prototype.setStyle=function(e,t,r,n){var o;j(n)&&(n=3),r&&r.backColor&&"object"==typeof r.backColor&&p.To.processStops(r.backColor),this.Nq(e,t,r,n),-1===e&&-1===t&&(this.Oq[n]=H),-1!==e&&-1!==t||(o=r&&r.validator)&&o.condition()&&4===o.condition().conType()&&o.condition().getExpected(this,e<0?0:e,t<0?0:t),this.Jq(),this.$p()},ve.prototype.Pq=function(e,t,r,n){var o,i;this.options.isProtected?(o=this.getStyle(e,t,n),i=void 0,r?(i=o?o.locked:G,r.locked!==i&&(r.locked=i),this.setStyle(e,t,r,n)):o&&((i=o.locked)!==G&&((r=new B.Style).locked=i),this.setStyle(e,t,r,n))):this.setStyle(e,t,r,n)},ve.prototype.getStyleName=function(e,t,r){var n=this.Aj(e,t,r);return n instanceof B.Style?n.name:n},ve.prototype.setStyleName=function(e,t,r,n){typeof r==z&&(this.Nq(e,t,r,n),this.$p())},ve.prototype.Aj=function(e,t,r){var n;return j(r)&&(r=3),0!==r&&(n=this._modelManager.getStyle(e,t,r)),n||H},ve.prototype.Nq=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p;if(j(n)&&(n=3),0!==n){if(i=(o=this).Aj(e,t,n),s=(a=o._modelManager).getRowCount(n),l=a.getColumnCount(n),e<-1||s<=e||t<-1||l<=t)return;u=r,c=a.getStyle(e,t,n),typeof u==z&&(u=o.Hq(u)),(h=u&&u.formatter)&&m(h)&&o.fJb(e,t,h),a.do("setStyle",e,t,r,n),f=i&&i.cellType&&i.cellType.typeName||H,d=r&&r.cellType&&r.cellType.typeName||H,e===o.Jl&&t===o.Kl&&f!==d&&O.Vl.Wl(o)&&o._eventHandler.Qq(),p="[styleinfo]",-1!==e&&-1!==t?o.Bq(p,e,t,n,c,r):-1!==e&&-1===t?o.kq(e,n,p,r,c):-1===e&&-1!==t&&o.pq(t,n,p,r,c)}},ve.prototype.fJb=function(e,t,r){var n,o,i,a,s,l,u;if(d=d||c("SheetsCalc")){if(-1===e&&(e=0),-1===t&&(t=0),n=this.getCell(e,t,3),o=d.rangeToFormula(n,e,t,3),"="===(i=r.trim()).charAt(0)&&0<=i.indexOf("@")&&(i=i.replace(/@/g,o)),0<=i.indexOf("{{")&&0<=i.indexOf("}}")){for(""===(a=i.split(/{{|}}/))[0]&&a.shift(),""===a[a.length-1]&&a.pop(),s=0;s<a.length;s++)-1===a[s].indexOf("=")?a[s]='"'+a[s]+'"':(0<=a[s].indexOf("@")&&(a[s]=a[s].replace(/@/g,o)),(l=d.evaluateFormula(this,a[s]))instanceof f.CalcError?a[s]='"'+l+'"':a[s]=a[s].replace(/=/g,""));i="=CONCAT("+a.join(",")+")"}(u=this.parent).aJb(r)||u.Yu(u.QHb,r,i,e,t,!0,"")}},ve.prototype.getDefaultStyle=function(e){var t,r,n,o,i,a;return j(e)&&(e=3),(r=(t=this.Oq)[e])?r:0!==e?(typeof(o=(n=this._modelManager).getStyle(-1,-1,e))==z&&(o=this.Hq(o)),o||(o=new B.Style,n.do("setStyle",-1,-1,o,e)),i=1===e||2===e,typeof(o=o).hAlign==V&&(o.hAlign=i?1:3),typeof o.vAlign==V&&(o.vAlign=i?1:0),typeof o.imeMode==V&&(o.imeMode=1),o.font||typeof o.themeFont!=V||(o.themeFont="Body"),t[e]=o):((a=new B.Style).locked=!0,t[e]=a)},ve.prototype.setDefaultStyle=function(e,t){j(t)&&(t=3),0!==t&&this._modelManager.do("setStyle",-1,-1,e,t),this.Oq[t]=H,this.Jq(),this.$p()},ve.prototype.Hq=function(e){var t,r=this.Mq(e,!1);return r||((t=this.parent)?t.Mq(e,!1):H)},ve.prototype.Dq=function(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y,C,w,v;if(j(r)&&(r=3),h=this,f=new B.Style,g=!1,0!==r){if(m=h._modelManager,b=h.tables,y=m.getRowCount(r),C=m.getColumnCount(r),w=void 0,0<=e&&e<y&&0<=t&&t<C&&((w=n!==G?n:m.getStyle(e,t,r))&&w.charAt&&(w=h.Hq(w)),w))for(f.Yo(w,!0,10),g=!0,p=w.parentName;p&&(d=h.Hq(p));)f.Yo(d,!1,10,!0),p=d.parentName;if(s)return f;if(a!==G||l||(a=3===r&&b?b.find(e,t):H),u===G&&3===r&&h.pivotTables&&(u=h.pivotTables.Wic(e,t)||H),a&&!l&&(a.Yo(e,t,f),g=!0),u&&(u.Yo(e,t,f),g=!0),0<=e&&e<y&&((w=o!==G?o:m.getStyle(e,-1,r))&&w.charAt&&(w=h.Hq(w)),w))for(f.Yo(w,!g,30),g=!0,p=w.parentName;p&&(d=h.Hq(p));)f.Yo(d,!1,30,!0),p=d.parentName;if(0<=t&&t<C&&((w=i!==G?i:m.getStyle(-1,t,r))&&w.charAt&&(w=h.Hq(w)),w))for(f.Yo(w,!g,40),g=!0,p=w.parentName;p&&(d=h.Hq(p));)f.Yo(d,!1,40,!0),p=d.parentName}if((v=h.getDefaultStyle(r))&&v.charAt&&(v=h.Hq(v)),v&&!c)for(f.Yo(v,!g,50),p=v.parentName;p&&(d=h.Hq(p));)f.Yo(d,!1,50,!0),p=d.parentName;return f},ve.prototype.getCellType=function(e,t,r){return this.tq(e,t,"cellType",r)||this.Al(r)},ve.prototype.Al=function(e){j(e)&&(e=3);var t=this.Rq;return t=t||(this.Rq=new i.Text),3===e?t:1===e?new a.ColumnHeader:2===e?new a.RowHeader:0===e?new a.Corner:t},ve.prototype.setCellType=function(e,t,r,n){var o=this.Iq(e,t,n);(o=o||new B.Style).cellType=r,this.setStyle(e,t,o,n)},ve.prototype.Sq=function(e,t,r,n,o){var i,a,s,l,u,c;if(j(o)&&(o=3),(i=this._modelManager).do("clearSpan",e,t,r,n,o),a=O.kf(e,t,r,n),s=this.Tq(a,o),l=this.Fia(s,o),i.do("addSpan",l,o),3===o){for(u=this.getSelections(),c=0;c<u.length;c++)u[c].intersect(e,t,r,n)&&(u[c]=u[c].union(a));i.do("setSelections",u)}this.$p()},ve.prototype.Fia=function(e,t){var r=this.getRowCount(t),n=this.getColumnCount(t),o=e.row,i=e.col,a=e.rowCount,s=e.colCount;return r<o+a&&(a=r-o),n<i+s&&(s=n-i),O.kf(o,i,a,s)},ve.prototype.addSpan=function(e,t,r,n,o){var i,a,s,l,u=this;if((1!==r||1!==n)&&0!==o&&(i=u.getRowCount(o),a=u.getColumnCount(o),!(i<=e||a<=t||e<-1||t<-1)&&(s=!0,T&&(3===o||j(o))&&(s=u.Vq(e,t,r,n,!1)),s))){if(u._modelManager.qu(e,t,r,n,o))throw Error(ne().Exp_InvalidRange);u.wyb&&u.wyb(e,t,r,n),u.Sq(e,t,r,n,o),l={sheet:u,row:e,col:t,rowCount:r,colCount:n,sheetArea:o,changeType:"addSpan"},ve.ao(u,K,l),u.Wq("spanChanged",l)}},ve.prototype.removeSpan=function(e,t,r){var n,o,i;j(r)&&(r=3),(o=(n=this._modelManager).findSpan(e,t,r))&&o.row===e&&o.col===t&&n.do("removeSpan",o,r),i={sheet:this,row:e,col:t,sheetArea:r,changeType:"removeSpan"},ve.ao(this,K,i),this.Wq("spanChanged",i),this.$p()},ve.prototype.getSpans=function(e,t){return 0===t?[]:this._modelManager.getSpans(e,t,!0)},ve.prototype.getSpan=function(e,t,r){return 0===r?H:this._modelManager.findSpan(e,t,r)},ve.prototype.repaint=function(e){this.Xq<=0&&this._render&&this._render.repaint(e)},ve.prototype.Yq=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b=this,y=b.parent,C=y&&y.options.scrollbarAppearance===M.ScrollbarAppearance.mobile,w=!1,v=!1,S=y&&y.options.scrollByPixel,x=ye(b),T=be(b),A=T?b.Zq(T-1):b.$q(),k=x?b._q(x-1):b.ar();if(t<b.qq&&A<=t?(w=!0,b.rq(b.br(t+1),0)):S&&t===b.qq&&0!==b.eCb&&(w=!0,b.rq(t,0)),t>b.cr()&&t<=b.dr()){for(r=0,n=t,o=b.am(),(i=b._modelManager.findSpan(e,n))&&(n=i.col+i.colCount-1);n>b.qq&&!((r+=b.Tl(n))>o.er);)n--;s=a=void 0,s=S?(n===b.qq&&r<o.er&&(r+=b.Tl(n)),a=n,o.er-r):(a=b.Zq(n),0),w=!0,b.rq(a,s)}if(e<b.lq&&k<=e?(v=!0,b.mq(b.gr(e+1),0)):S&&e===b.lq&&0!==b.cCb&&(v=!0,b.mq(e,0)),e>b.hr()&&e<=b.ir()){for(l=0,u=e,(c=b._modelManager.findSpan(u,t))&&(u=c.row+c.rowCount-1),h=b.am();u>b.lq&&!((l+=b.Sl(u))>h.jr);)u--;d=f=void 0,d=S?(u===b.lq&&l<h.jr&&(l+=b.Sl(u)),f=u,h.jr-l):(f=b._q(u),0),v=!0,b.mq(f,d)}S||t!==b.dr()||b.rq(b.lr(),0),C&&(p=y.St,g=y.Pt,m=y.ku,v&&(p.Jwa(M.ScrollbarState.show),m.Rdc(!0)),w&&(g.Jwa(M.ScrollbarState.show),m.Rdc(!1)))},ve.prototype.hitTest=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I=this;if(I.am(),o={x:e,y:t},i=I.rowOutlines,a=I.columnOutlines,i&&(s=i.hitTest(I,e,t)),!s&&a&&(s=a.hitTest(I,e,t)),s)o.outlineHitInfo=s;else{if(l=I.nr(t),u=I.or(e),o.rowViewportIndex=l,o.colViewportIndex=u,o.row=I.pr(t,l),o.col=I.qr(e,u),0<=l&&l<=2&&0<=u&&(c=I.rr(l,u,G,o.row,o.col))&&!0!==r&&(o.row=c.row,o.col=c.col),o.hitTestType=I.sr(l,u),h=I._eventHandler,d=(f=I.xr)&&f.hitTest(o,e,t),g=void 0,(p=I.tables)&&(g=-1===o.rowViewportIndex?p&&p.find(I.getActiveRowIndex(),I.getActiveColumnIndex()):p.find(o.row,o.col)),d=d||(m=g&&g.xr)&&m.hitTest(o,e,t),b=p&&!d&&p.gJb(e,t,o))return(o.tableSelectInfo=b).table&&b.table.xr&&(o.filterButtonHitInfo=d),o;(y=h.Yia&&h.Yia(o,e,t))?o.dragMergeInfo=y:(C=h.tr&&h.tr(o,e,t))?o.dragInfo=C:(w=h.ur(o,e,t,5))?o.resizeInfo=w:(v=h.vr?h.vr(o,e,t):H)?o.formulaRangeHitInfo=v:(x=(S=I._modelManager.Ky)&&S.hitTest(e,t))?o.commentHitInfo=x:(A=(T=I.wr)&&T.hitTest(e,t,n),k=void 0,I.shapes&&(k=I.shapes.hitTest(e,t)),k?o.shapeHitInfo=k:A?o.floatingObjectHitInfo=A:d?o.filterButtonHitInfo=d:(M=g&&!g.hJb()&&h.iJb&&h.iJb(o,g))?o.resizeTableHitInfo=M:o.cellTypeHitInfo=I.yr(o,e,t))}return o},ve.prototype.getCellRect=function(e,t,r,n,o){var i,a,s,l,u,c=3;return-1===r?c=1:-1===n&&(c=2),i=this.am(),-1===r&&-1===n?new O.Rect(i.zr,i.Ar,i.Br,i.Cr):(a=this.Dr(),j(r)&&(r=this.Er(e)),j(n)&&(n=this.Fr(t)),s=this.Gr(r,c).findRow(e),l=this.Hr(n,c).findCol(t),(u=this.Ir(r,n,c,o).findCell(e,t))?new O.Rect(u.x-a.x,u.y-a.y,u.width,u.height):s&&l?new O.Rect(l.x-a.x,s.y-a.y,l.width,s.height):new O.Rect)},ve.prototype.Jr=function(e,t,r){var n,o,i,a,s=this,l=s._eventHandler,u=!1,c=s.Jl,h=s.Kl;j(e)||(s.Jl=e,u=!0),j(t)||(s.Kl=t,u=!0),s._modelManager.setCellState(c,h,M.CellStatesType.active,!1,M.SheetArea.viewport),s.xIb&&s.xIb(M.CellStatesType.active,c,h,M.SheetArea.viewport),s._modelManager.setCellState(e,t,M.CellStatesType.active,!0,M.SheetArea.viewport),s.xIb&&s.xIb(M.CellStatesType.active,e,t,M.SheetArea.viewport),!r&&l&&u&&(l.Qq(),(o=(n=s._modelManager).getDynamicArrayInfo(e,t))!==(i=n.WIb)&&(n.WIb=o,s.Xq<=0&&(a=void 0,a=o&&i?O.getUnionRange(o,i):(o=o||i,O.kf(o.row,o.col,o.rowCount,o.colCount)),s._render.im(a))))},ve.prototype.gCb=function(e,t,r,n,o){var i=e.getCellRect(t,r,n,o),a=i.x,s=i.y,l=i.width,u=i.height;return i.x=a-2,i.y=s-2,i.width=l+4,i.height=u+4,i},ve.prototype.Kr=function(e,t,r,n,o){var i,a=this,s=a.Jl,l=a.Kl,u=a._modelManager,c=u.getSpan(e,t);a.Lr=c.rowCount,a.Mr=c.colCount,a.Xq<=0&&(i=u.getSpan(s,l),a._render.im(O.kf(s,l,i.rowCount,i.colCount))),a.Nr=r,a.Pr=n,a.Jr(e,t,o),a.Qr=e,a.Rr=t},ve.prototype.setActiveCell=function(e,t,r,n){this.Sr(e,t,r,n,2)},ve.prototype.Sr=function(e,t,r,n,o){var i,a,s=pe(this),l=de(this);e<0?e=0:s<=e&&(e=s-1),t<0?t=0:l<=t&&(t=l-1),this.Tr(),i=2===o?O.Vl.Wl(this):1===o,this.Kr(e,t,r,n,!i),a=this._modelManager.getSpan(e,t),this.Ur(a.row,a.col,a.rowCount,a.colCount),this.$p()},ve.prototype.getActiveRowIndex=function(){return this.Jl},ve.prototype.getActiveColumnIndex=function(){return this.Kl},ve.prototype.getRowResizable=function(e,t){return this._modelManager.getResizable(!0,t,e)},ve.prototype.setRowResizable=function(e,t,r){this.Vr(e,t,Q,!0,r)},ve.prototype.Vr=function(e,t,r,n,o){j(o)&&(o=3),r!==Z&&r!==q||!I.test(t)||(r="starSize");var i,a=this._modelManager;switch(r){case Q:i=a.getResizable(n,o,e);break;case"pageBreak":i=a.getPageBreak(n,o,e);break;case J:i=a.getVisible(n,o,e);break;case Z:i=a.getSize(n,o,e);break;case q:i=a.getSize(n,o,e)}switch(n?this.pCb(e,o,r,t,i):this.qCb(e,o,r,t,i),r){case Q:a.do("setResizable",n,o,e,t);break;case"pageBreak":a.do("setPageBreak",n,o,e,t);break;case J:a.do("setVisible",n,o,e,t),n&&T&&3===o&&i!==t&&this.recalcRows([e]);break;case Z:a.do("setSize",n,o,e,t),!T||3!==o||i===t||0!==i&&0!==t||this.recalcRows([e]);break;case q:a.do("setSize",n,o,e,t),!T||3!==o||i===t||0!==i&&0!==t||this.recalcCols([e]);break;case"starSize":a.do("setStarSize",n,o,e,t)}n?this.kq(e,o,r,t,i):this.pq(e,o,r,t,i)},ve.prototype.getColumnResizable=function(e,t){return this._modelManager.getResizable(!1,t,e)},ve.prototype.setColumnResizable=function(e,t,r){this.Vr(e,t,Q,!1,r)},ve.prototype.getRowHeight=function(e,t,r){var n,o,i,a,s,l;if(j(t)&&(t=3),r)return this._modelManager.getStarSize(!0,t,e);if(3===t||2===t){if(n=this.getRowCount(t),e<0||n<=e)return 0;for(o=this.Wr,i=0;i<o.length;i++)if(!o[i].Xr(e))return 0}return s=(a=this.defaults).rowHeight,1===t&&(s=a.colHeaderRowHeight),(l=this._modelManager.getSize(!0,t,e))||0===l?l:U(s)},ve.prototype.Yr=function(e,t){var r,n,o;return j(t)&&(t=3),n=(r=this.defaults).rowHeight,1===t&&(n=r.colHeaderRowHeight),(o=this._modelManager.getActualSize(!0,t,e))||0===o?o:U(n)},ve.prototype.setRowHeight=function(e,t,r){this.Vr(e,t,Z,!0,r),this.jq=!0,this.$p()},ve.prototype.getRowVisible=function(e,t,r){var n,o;if(j(t)&&(t=3),!r&&(3===t||2===t))for(n=this.Wr,o=0;o<n.length;o++)if(!n[o].Xr(e))return!1;return this._modelManager.getVisible(!0,t,e)},ve.prototype.setRowVisible=function(e,t,r){this.Vr(e,t,J,!0,r),this.jq=!0,this.$p()},ve.prototype.getColumnWidth=function(e,t,r){var n,o,i,a,s,l;if(j(t)&&(t=3),r)return this._modelManager.getStarSize(!1,t,e);if(o=(n=this.defaults).colWidth,2===t&&(o=n.rowHeaderColWidth),3===t||1===t){if(i=this.getColumnCount(t),e<0||i<=e)return 0;for(a=this.Zr,s=0;s<a.length;s++)if(!a[s].Xr(e))return 0}return(l=this._modelManager.getSize(!1,t,e))||0===l?l:U(o)},ve.prototype.$r=function(e,t){var r,n,o;return j(t)&&(t=3),n=(r=this.defaults).colWidth,2===t&&(n=r.rowHeaderColWidth),(o=this._modelManager.getActualSize(!1,t,e))||0===o?o:U(n)},ve.prototype.setColumnWidth=function(e,t,r){this.Vr(e,t,q,!1,r),this.oq=!0,this.$p()},ve.prototype.getColumnVisible=function(e,t){var r,n;if(j(t)&&(t=3),3===t||1===t)for(r=this.Zr,n=0;n<r.length;n++)if(!r[n].Xr(e))return!1;return this._modelManager.getVisible(!1,t,e)},ve.prototype.setColumnVisible=function(e,t,r){this.Vr(e,t,J,!1,r),this.oq=!0,this.$p()},ve.prototype.zoom=function(e){var t,r=this;return 0===arguments.length?r._modelManager.getZoomFactor():(e=F(e),!_(e)&&isFinite(e)&&(4<e?e=4:e<.25&&(e=.25),t=r._modelManager.getZoomFactor(),r.XSa(e),r.eCb=r.eCb/t*e,r.cCb=r.cCb/t*e,r.oq=!0,r.jq=!0,r.$p()),r)},ve.prototype.XSa=function(e){this._modelManager.do("setZoomFactor",e),ve.ao(this,K,{changeType:"zoomSheet"})},ve.prototype.x6a=function(){this._r=H,this.as={colHeader:H,viewport:H},this.bs={rowHeader:H,viewport:H}},ve.prototype.invalidateLayout=function(){var e,t,r=this,n=r._eventHandler;r._modelManager.$Gb(),r.x6a(),ve.ao(r,"beforeLayoutChanged",{changeType:"invalidateLayout"}),r.oq&&(r.ds(),r.oq=!1),r.jq&&(r.es(),r.jq=!1),r.x6a(),ve.ao(r,K,{changeType:"invalidateLayout"}),n&&n.cs&&O.Vl.Wl(r)&&!n.byb(r)&&n.cs(r.Jl,r.Kl),r.$l=!0,(e=r.parent)&&e.options.enableAccessibility&&(t=r.cgc(),e.dgc(t))},ve.prototype.$p=function(){this.Xq<=0&&(this.invalidateLayout(),this.repaint())},ve.prototype.getViewportHeight=function(e){var t=this.am();return 0===e?t.fs:1===e?t.jr:2===e?t.gs:0},ve.prototype.getViewportWidth=function(e){var t=this.am();return 0===e?t.hs:1===e?t.er:2===e?t.js:0},ve.prototype.getViewportTopRow=function(e){var t=ye(this);return 0===e?0:1===e?L(t,this.lq):2===e?L(t,pe(this)-me(this)):-1},ve.prototype.getViewportBottomRow=function(e){var t,r,n,o,i,a;if(2===e)return pe(this)-1;for(t=this.getViewportTopRow(e),r=this.getViewportHeight(e),n=1===e?this.cCb:0,o=0,i=pe(this)-me(this),0===e&&(i=P(ye(this),i)),a=t;a<i&&n<r;a++,o++)n+=this.Sl(a);return t+o-1},ve.prototype.jCb=function(e){var t,r=this.getViewportTopRow(e),n=this.getViewportBottomRow(e);for(t=r;t<n+1;t++)if(-1<t&&this.getRowVisible(t,3)&&0<this.Sl(t,3))return t;return-1},ve.prototype.getViewportLeftColumn=function(e){var t=be(this);return 0===e?0:1===e?L(t,this.qq):2===e?L(t,de(this)-ge(this)):-1},ve.prototype.getViewportRightColumn=function(e){var t,r,n,o,i,a;if(2===e)return de(this)-1;for(t=this.getViewportLeftColumn(e),r=this.getViewportWidth(e),n=0,o=1===e?this.eCb:0,i=de(this)-ge(this),0===e&&(i=P(be(this),i)),a=t;a<i&&o<r;a++,n++)o+=this.Tl(a);return t+n-1},ve.prototype.kCb=function(e){var t,r=this.getViewportLeftColumn(e),n=this.getViewportRightColumn(e);for(t=r;t<n+1;t++)if(-1<t&&this.getColumnVisible(t,3)&&0<this.Tl(t,3))return t;return-1},ve.prototype.showCell=function(e,t,r,n){var o,i,a,s,l,u,c=this;e<0||e>=pe(c)||t<0||t>=de(c)||(o=c.Fr(t),i=c.Er(e),a=c.getViewportTopRow(i),s=c.getViewportLeftColumn(o),1===o&&(t=c.ks(t,n)),1===i&&(e=c.ms(e,r)),l=!1,1===i&&e!==a&&(e=P(e,c.ns()),c.lq=e,c.cCb=0,c.os(),l=!0),1===o&&t!==s&&(t=P(t,c.ps()),c.qq=t,c.eCb=0,c.qs(),l=!0),l&&((u=c.parent)&&!u.options.scrollbarShowMax&&(c.oq=!0,c.jq=!0),c.$p()))},ve.prototype.Er=function(e){var t=1;return e<ye(this)?t=0:e>=pe(this)-me(this)&&(t=2),t},ve.prototype.Fr=function(e){var t=1;return e<be(this)?t=0:e>=de(this)-ge(this)&&(t=2),t},ve.prototype.ks=function(e,t){var r,n=this.ss,o=this.Fr(e),i=this.getViewportLeftColumn(o);if(0!==t)if(1===t)for(r=U((this.getViewportWidth(o)-n._m(e))/2);0<e&&!((r-=n._m(e-1))<0);e--);else if(2===t)for(r=this.getViewportWidth(o)-n._m(e);0<e&&!((r-=n._m(e-1))<0);e--);else if(3===t&&i<=e)for(r=this.getViewportWidth(o)-n._m(e);i<e&&!((r-=n._m(e-1))<0);e--);return e},ve.prototype.ms=function(e,t){var r,n=this.ss,o=this.Er(e),i=this.getViewportTopRow(o);if(0!==t)if(1===t)for(r=U((this.getViewportHeight(o)-n.Sl(e))/2);0<e&&!((r-=n.Sl(e-1))<0);e--);else if(2===t)for(r=this.getViewportHeight(o)-n.Sl(e);0<e&&!((r-=n.Sl(e-1))<0);e--);else if(3===t&&!(e<i||-1===i))for(r=this.getViewportHeight(o)-n.Sl(e);i<e&&!((r-=n.Sl(e-1))<0);e--);return e},ve.prototype.showColumn=function(e,t){this.showCell(this.lq,e,0,t)},ve.prototype.showRow=function(e,t){this.showCell(e,this.qq,t,0)},ve.prototype.suspendEvent=function(){this.jm++},ve.prototype.resumeEvent=function(){this.jm--,this.jm<0&&(this.jm=0)},ve.prototype.isEventSuspended=function(){return 0<this.jm},ve.prototype.currentTheme=function(e){return 0===arguments.length?(this.Pm||this.ts(),this.Pm):(typeof e==z&&(e=u.Themes[e]?u.Themes[e]:new u.Theme(e)),this.Pm=e,this._render.us(),this.Jq(),this.$p(),this)},ve.prototype.P3=function(){var e=O.Im.Lm(""),t=N(e.zIndex),r=u.Themes.Office2007;return 2007<t&&(r=u.Themes.Office),r},ve.prototype.ts=function(){this.Pm=this.P3(),this.Jq()},ve.prototype.reset=function(){this.vs(),this.$p()},ve.prototype.vs=function(){var e,t,r=this,n=r.DHb();r.Pp(),r.Nr=0,r.Pr=0,r.T3(),r._r=H,r.as={colHeader:H,viewport:H},r.bs={rowHeader:H,viewport:H},r.lq=0,r.cCb=0,r.qq=0,r.eCb=0,r.frozenRowCount(0),r.frozenColumnCount(0),r.frozenTrailingRowCount(0),r.frozenTrailingColumnCount(0),ve.ao(r,"beforeSetHost"),!(e=r.parent)||(t=e.getActiveSheet())&&r.name()===t.name()&&r.ws(e.xs),r.Cq=[{},{},{},{}],r.ss=new O.ln(r),r.Oq={},T&&r.resetCalc(),r._modelManager=new D.lUa(r,ve.Rp,ve.Sp,ve.Vp,ve.Tp,r.name()),r.defaults=r._modelManager.defaults,r.DHb(n),r.ts(),r.Lq={},r.oq=!0,r.jq=!0,r.parent&&r.parent.xD?r.Xq=r.parent.xD:r.Xq=0,r.parent&&r.parent.jm?r.jm=r.parent.jm:r.jm=0,r.gga=0,r.Js=!1,r.Ks=H,r.Wr=[],r.Zr=[],r.OIb=!1,ve.ao(r,"init")},ve.prototype.T3=function(){var n=this;v(ie,function(e,t){if(!j(t)){var r=t;"gridline"===e?r={color:O.Im.Lm("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof r&&(r=h.GC$.extend({},t)),n.options[e]=r}})},ve.prototype.Ls=function(e){var t;for(this.parent=e,t=this.Xq;t<e.xD;t++)this.suspendPaint();this.jm=e.jm,ve.ao(this,"attach",e)},ve.prototype.jJb=function(e,t){return e.row===t.row&&e.col===t.col&&e.rowCount===t.rowCount&&e.colCount===t.colCount},ve.prototype.kJb=function(e,t,r,n,o){var i,a,s=this.Ms(t,r,n,o).ranges;for(i=0;i<s.length;i++)for(a=0;a<e.length;a++)if(this.jJb(e[i],s[a]))return!0;return!1},ve.prototype.lJb=function(e,t,r,n,o){var i,a=!1;return void 0!==o?0===o?0<(i=this.Ms(e,t,r,this.getColumnCount()-t).ranges).length&&(0<e-1&&(a=this.kJb(i,e-1,t,1,this.getColumnCount()-t)),a=(a=a||this.kJb(i,e+r,t,1,this.getColumnCount()-t))||this.kJb(i,e,t,r,1)):0<(i=this.Ms(e,t,this.getRowCount()-e,n).ranges).length&&(0<e-1&&(a=this.kJb(i,e-1,t,this.getRowCount()-e,1)),a=(a=a||this.kJb(i,e+r,t,this.getRowCount()-e,1))||this.kJb(i,e,t,1,n)):a=!0,a},ve.prototype.Y3=function(e,t,r,n,o,i,a,s){var l;return!a&&this.options.isProtected&&this.ou(O.kf(e,t,r,n))?(o&&this.Os(1,o),!1):(l=this.lJb(e,t,r,n,s),!(T&&l&&!this.Vq(e,t,r,n)&&(i&&this.Os(1,i),1)))},ve.prototype.clear=function(e,t,r,n,o,i){0!==o&&this.cg(e,t,r,n,o,i)},ve.prototype.cg=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S=this,x=T;try{if(x&&S.suspendCalcService(),S.suspendPaint(),l=S.defaults,f=h=c=u=void 0,j(o)||3===o){if(x&&!S.Vq(e,t,r,n))return!1;if(1&i&&S.getDataSource&&S.getDataSource()){for(S.suspendEvent(),u=e;u<e+r;u++)if(!(a&&S.Ps&&S.Ps(u)))for(c=t;c<t+n;c++)S.setValue(u,c,H,o);S.resumeEvent()}}for(d={changeType:"clear",row:e,col:t,rowCount:r,colCount:n,sheetArea:o,type:i,ignoreTable:s},ve.ao(S,K,d),p=S._modelManager,g=x&&S.Bj(),u=-1===e?0:e,m=-1===e?p.getRowCount(o):r,c=-1===t?0:t,b=-1===t?p.getColumnCount(o):n,y=[],C=u;C<m+u;C++)a&&S.Ps&&S.Ps(C)&&y.push(C);if(p.do("clear",u,c,m,b,i,y,o),g&&1&i&&(g.Sg(u,c,m,b),g.clear(u,c,m,b,p.dUa())),8&i&&!(0<=e&&0<=t))if(0<=t)for(f=0;f<b;f++)S.setTag(-1,c+f,H,o);else if(0<=e)for(h=0;h<m;h++)a&&S.Ps&&S.Ps(u+h)||S.setTag(u+h,-1,H,o);else S.setTag(-1,-1,H,o);if(256&i&&!(0<=e&&0<=t))if(0<=t)for(f=0;f<b;f++)S.setHyperlink(-1,c+f,H,o);else if(0<=e)for(h=0;h<m;h++)a&&S.Ps&&S.Ps(u+h)||S.setHyperlink(-1,-1,H);if(2&i&&!(0<=e&&0<=t))if(0<=t)for(f=0;f<b;f++)S.setStyle(-1,c+f,H,o);else if(0<=e)for(h=0;h<m;h++)a&&S.Ps&&S.Ps(u+h)||S.setStyle(u+h,-1,H,o);else S.setStyle(-1,-1,H,o);if(32&i){if(e<0)for(f=0;f<b;f++)S.setColumnVisible(c+f,!0,o),S.setColumnResizable(c+f,!0,o),S.setColumnWidth(c+f,2===o?l.rowHeaderColWidth:l.colWidth,o);if(t<0)for(h=0;h<m;h++)a&&S.Ps&&S.Ps(u+h)||(S.setRowVisible(u+h,!0,o),S.setRowResizable(u+h,!0,o),S.setRowHeight(u+h,1===o?l.colHeaderRowHeight:l.rowHeight,o))}for((j(o)||3===o)&&x&&1==(1&i)&&(w=S.Bj())&&w.Ag(e,t,r,n),v=[],h=0;h<m;h++)for(f=0;f<b;f++)v.push({row:u+h,col:c+f});S.Bu(e,t,m,b,v,2,o)}finally{S.resumePaint(),x&&S.resumeCalcService(!1)}},ve.prototype._p=function(){var e,t,r,n,o=this.options,i=o.protectionOptions;o.isProtected&&i&&(e=i.allowSelectLockedCells,t=i.allowSelectUnlockedCells,(!1===e&&!1!==t||!1!==e&&!1===t)&&(r=this.Jl,n=this.Kl,this.Qs(r,n)||(this.Tr(),this.Rs(r,n,!0),this.Ss(4,r,n))))},ve.prototype.setArray=function(n,o,e,i){var a,s,l,u,c=this,t=T;if(i=t&&i,a=pe(c),s=de(c),e&&0<=n&&n<a&&0<=o&&o<s){t&&c.suspendCalcService(),c.suspendPaint();try{v(e,function(r,e){h.GC$.isArray(e)?v(e,function(e,t){u=o+e,(l=n+r)<a&&u<s&&(i?c.setFormula(l,u,t):c.setValue(l,u,t,3,!0))}):(u=o,(l=n+r)<a&&u<s&&(i?c.setFormula(l,u,e):c.setValue(l,u,e,3,!0)))})}finally{t&&c.resumeCalcService(),c.resumePaint()}}},ve.prototype.getArray=function(e,t,r,n,o){var i,a,s=[],l=pe(this),u=de(this);if(o=o&&T,0<=e&&e<l&&0<=t&&t<u)for(l<e+r&&(r=l-e),u<t+n&&(n=u-t),i=0;i<r;i++)for(s[i]=[],a=0;a<n;a++)s[i][a]=o?this.getFormula(e+i,t+a):this.getValue(e+i,t+a);return s},ve.prototype.setTag=function(e,t,r,n){var o,i,a,s,l;if(j(n)&&(n=3),0!==n){if(i=(o=this._modelManager).getRowCount(n),a=o.getColumnCount(n),e<-1||i<=e||t<-1||a<=t)return;r=A(r),s=void 0,(l=0<this.jm)||(s=this.getTag(e,t,n)),o.do("setValueForKey",e,t,Y,r,n),l||s===r||(-1!==e&&-1!==t?this.Bq(Y,e,t,n,s,r):-1!==e&&-1===t?this.kq(e,n,Y,r,s):-1===e&&-1!==t&&this.pq(t,n,Y,r,s))}},ve.prototype.getTag=function(e,t,r){var n;return j(r)&&(r=3),0!==r?(n=this._modelManager.getValueForKey(e,t,Y,r),k(n)):H},ve.prototype.tag=function(e){var t;return 0===arguments.length?(t=this._modelManager.getValueForKey(-1,-1,Y,3),k(t)):(this._modelManager.do("setValueForKey",-1,-1,Y,A(e),3),this)},ve.prototype.getParent=function(){return this.parent},ve.prototype.getDirtyRows=function(){return ce(this,!0)},ve.prototype.getInsertRows=function(){return ce(this,!1)},ve.prototype.getDeletedRows=function(){var r=[],e=this.Ts;return e&&v(e,function(e,t){t&&!h.GC$.isFunction(t)&&r.push({row:t.row,originalItem:t.data})}),r},ve.prototype.hasPendingChanges=function(){var e,t=this.Ts;return!!(t&&0<t.length)||(e=this._modelManager.hUa(),!S(e))},ve.prototype.clearPendingChanges=function(e){var t,r,n,o,i;return j(e)||S(e)?(this._modelManager.iUa(),this.Ts=[],void ve.ao(this,"clearPendingChanges")):(t=e.row,r=e.col,n=e.rowCount,o=e.colCount,(1&(i=(i=e.clearType)||oe.dirty))===oe.dirty&&this.Rec(t,r,n,o),(2&i)===oe.insert&&this.Sec(t,r,n,o),void((4&i)===oe.delete&&this.Tec(t,r,n,o)))},ve.prototype.Rec=function(e,t,r,n){var o=this._modelManager,i=this.Uec(e,t,r,n),a=this.Vec(t,n);i?(o.Qec(),ve.ao(this,"clearPendingChanges")):o.Mec(a,e,t,r,n)},ve.prototype.Sec=function(e,t,r,n){var o=this._modelManager,i=this.Uec(e,t,r,n),a=this.Vec(t,n);o.Lec(i,a,e,r)},ve.prototype.Tec=function(n,e,o,t){var r,i,a;if(this.Uec(n,e,o,t))this.Ts=[];else if(this.Vec(e,t)&&(r=this.Ts))for(i=[],v(r,function(e,t){if(t){var r=t.row;n<=r&&r<n+o&&i.push(e)}}),a=i.length-1;0<=a;a--)this.Ts.splice(i[a],1)},ve.prototype.Vec=function(e,t){return j(e)||-1===e||0===e&&this.getColumnCount()===t},ve.prototype.Wec=function(e,t){return j(e)||-1===e||0===e&&t===this.getRowCount()},ve.prototype.Uec=function(e,t,r,n){return this.Vec(e,r)&&this.Vec(t,n)},ve.prototype.getDirtyCells=function(e,o,t,i){var a,s,r,n,l,u,c,h=this;if(j(e)&&(e=-1),j(o)&&(o=-1),(j(t)||t<=0)&&(t=1),(j(i)||i<=0)&&(i=1),a=[],s=h._modelManager.hUa(),!S(s)){if(r=[],0<=e)for(n=e;n<e+t;n++)r.push(n);else for(l in s)x(s,l)&&r.push(N(l));v(r,function(e,t){var r,n;if((u=s[t])&&"e"===u.rs)if(0<=o)for(r=o;r<o+i;r++)(c=u[r])&&a.push(we(h,t,r,c.oldValue));else for(n in u)_(n)||(c=u[n])&&a.push(we(h,t,N(n),c.oldValue))})}return a},ve.prototype.suspendDirty=function(){this.gga++,this._modelManager.jUa()},ve.prototype.resumeDirty=function(){this.gga--,this.gga<0&&(this.gga=0),this._modelManager.kUa()},ve.prototype.isDirtySuspended=function(){return 0<this.gga},ve.prototype.ad=function(e){this.Us(new O.Rect(0,0,0,0)),this.vs(),this.cq(e)},ve.prototype.Vs=function(){var e,t=this.Ws(),r={top:0,left:0};return t&&t.parentElement&&(r=h.GC$(t).offset())&&(r.top+=R.body.clientTop||0,r.left+=R.body.clientLeft||0),(e=t&&t.canvasOffset)&&(r=e),r},ve.prototype.ws=function(e){var t,r,n;e&&((t=this).Js=!1,t.Xs&&t.no(!1),r=b("canvas"),n=t.parent&&t.parent.options.enableAccessibility?"":ne().NeedCanvasSupport,h.GC$(r).attr("id",e.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(n).appendTo(e),O.En.Kn(r,H,t),t.Xs=r,t.fq(),t.repaint(),t.parent&&t.parent.Ys(),ve.ao(t,"setHost",h.GC$(r)))},ve.prototype.Jgc=function(e,t,r,n,o,i,a,s,l){var u,c;for(u=r;u<n;u++)c=this.getText(t,u,l),e.push('"'+c+'"');for(u=o;u<i;u++)c=this.getText(t,u,l),e.push('"'+c+'"');for(u=a;u<s;u++)c=this.getText(t,u,l),e.push('"'+c+'"')},ve.prototype.Kgc=function(){var e,t,r,n,o,i=this,a=i.getViewportTopRow(1),s=i.getViewportBottomRow(1),l=i.getViewportLeftColumn(1),u=s-a+1,c=i.getViewportRightColumn(1)-l+1,h=i.getRowCount(M.SheetArea.colHeader),f=i.getColumnCount(M.SheetArea.rowHeader),d=i.frozenColumnCount(),p=i.frozenTrailingColumnCount(),g=i.getColumnCount(),m=i.frozenRowCount(),b=i.frozenTrailingRowCount(),y=i.getRowCount(),C=[];for(e=0;e<h;e++)t=[],i.Jgc(t,e,0,d,l,l+c,g-p,g,M.SheetArea.colHeader),C.push(t.join(","));for(e=0;e<m;e++){for(r=[],n=0;n<f;n++)o=i.getText(e,n,M.SheetArea.rowHeader),r.push('"'+o+'"');i.Jgc(r,e,0,d,l,l+c,g-p,g),C.push(r.join(","))}for(e=a;e<a+u;e++){for(r=[],n=0;n<f;n++)o=i.getText(e,n,M.SheetArea.rowHeader),r.push('"'+o+'"');i.Jgc(r,e,0,d,l,l+c,g-p,g),C.push(r.join(","))}for(e=y-b;e<y;e++){for(r=[],n=0;n<f;n++)o=i.getText(e,n,M.SheetArea.rowHeader),r.push('"'+o+'"');i.Jgc(r,e,0,d,l,l+c,g-p,g),C.push(r.join(","))}return C.join(";")},ve.prototype.cgc=function(e){var t,r,n,o,i;return O.util.sl()?this.Kgc():(t=this.Jl,r=this.Kl,n=M.SheetArea.viewport,!e||j(e.row)||j(e.col)||(t=e.row,r=e.col,n=e.hitTestType),o=ne(),i="",n===M.SheetArea.rowHeader?i=o.ARIA_RowHeader+" ":n===M.SheetArea.colHeader&&(i=o.ARIA_ColumnHeader+" "),i+o.ARIA_Cell+"("+t+","+r+") "+E.Kb(o.ARIA_HasValue,[this.getText(t,r,n)]))},ve.prototype.fq=function(){var e,t,r,n,o,i,a,s,l=this.Ws();l&&l.parentNode&&(t=(e=getComputedStyle(l.parentNode)).width,r=e.height,0<(n=t.indexOf("px"))&&(t=t.substring(0,n)),0<(n=r.indexOf("px"))&&(r=r.substring(0,n)),o=N(t),i=N(r),_(o)&&(o=h.GC$(l.parentNode).width()),_(i)&&(i=h.GC$(l.parentNode).height()),0!==o&&0!==i&&(a=L(o,0),s=L(i,0),l.style.display="none",l.style.display="",l.width=a,l.height=s,l.style.width=a+"px",l.style.height=s+"px",a=l.clientWidth||l.width,s=l.clientHeight||l.height,this.Zs.width=a,this.Zs.height=s,O.En.Pn(l,a,s),this.invalidateLayout()))},ve.prototype.no=function(e,t){var r,n,o,i=this;!0!==i.Js&&(O.En.Sn(i),i.isEditing&&i.isEditing()&&i.Yoa(),ve.ao(i,"dispose",{clearCache:e,isSheetDestroy:!0,hasActiveSheet:t}),(r=i.Xs)&&((n=r.parentNode)&&n.removeChild(r),i.Xs=H),i.$s(),i._modelManager&&i._modelManager.no(e),!1!==e&&(i.Js=!0,(o=i.at)&&o.no(),i.parent=H,i._modelManager=H,i.ss&&(i.ss.no(),i.ss=H),i.bt&&(i.bt.no(),i.bt=H),O.Vl.Wl(i)&&O.Vl.Zl(H,!0),i.uu&&(i.uu=H),i.Wr=H,i.Zr=H))},ve.prototype.$s=function(){var e=this.dt;e&&(h.GC$(e).remove(),this.dt=G)},ve.prototype.vq=function(e,t,r,n,o){var i,a,s,l;return j(n)&&(n=3),3===n&&this.jIb&&(i=e.getDynamicArrayInfo(t,r))&&i.isValid&&(t!==i.row||r!==i.col)?H:(a=this.et,!this.loading&&a&&a.getCalcService().calcOnDemand&&3===n&&(s=a.qg(t,r))&&!0===s.$l&&(s.$l=!1,delete s.dh,delete s.eh,a.recalculateCell(t,r),this.yj().zIc()),l=e.getValue(t,r,n,this.loading,o),l=k(l))},ve.prototype.Tq=function(e,t){var r,n,o,i,a;return j(t)&&(t=3),r=O.kf(-1,-1,-1,-1),e&&(n=e.row,o=e.col,i=e.rowCount,a=e.colCount,-1===o&&(o=0,a=this.getColumnCount(t)),-1===n&&(n=0,i=this.getRowCount(t)),r.col=o,r.row=n,r.colCount=a,r.rowCount=i),r},ve.prototype.getRangeRect=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C=new O.Rect(-1,-1,-1,-1),w=this,v=w.am();return 0===v.width||0===v.height?C:(n=w.it(t),o=w.jt(e),n&&0!==n.length&&o&&0!==o.length&&(i=w.Tq(r),a=w.ss,s=i.row,l=i.row+i.rowCount-1,u=i.col,c=i.col+i.colCount-1,h=ye(w),f=pe(w)-me(w)-1,d=be(w),p=de(w)-ge(w)-1,g=n[0].col,m=n[n.length-1].col,b=o[0].row,y=o[o.length-1].row,u<g&&(u=function(e,t){for(;t<e;)if(e--,w.getColumnVisible(e))return e;return e}(g,u)),m<c&&(c=function(e,t){for(;e<t;)if(e++,w.getColumnVisible(e))return e;return e}(m,c)),s<b&&(s=function(e,t){for(;t<e;)if(e--,w.getRowVisible(e))return e;return e}(b,s)),y<l&&(l=function(e,t){for(;e<t;)if(e++,w.getRowVisible(e))return e;return e}(y,l)),c<u||l<s||(0===t?u<d&&(C.x=v.kt+he(a,0,u-1),C.width=he(a,u,c)):1===t?u<=p&&d<=c&&(C.x=u<g?n[0].x-he(a,u,g-1):n[0].x+he(a,g,u-1),C.width=he(a,u,c)):2===t&&p<c&&(C.x=u<g?v.lt-he(a,u,g-1):v.lt+he(a,g,u-1),C.width=he(a,u,c)),0===e?s<h&&(C.y=v.nt+fe(a,0,s-1),C.height=fe(a,s,l)):1===e?s<=f&&h<=l&&(C.y=s<b?o[0].y-fe(a,s,b-1):o[0].y+fe(a,b,s-1),C.height=fe(a,s,l)):2===e&&f<l&&(C.y=s<b?v.ot-fe(a,s,b-1):v.ot+fe(a,b,s-1),C.height=fe(a,s,l)))),C)},ve.prototype.isintersectWithArrayFormula=function(e){var t,r,n=this.Bj();if(n)for(t=e.row;t<e.row+e.rowCount;t++)for(r=e.col;r<e.col+e.colCount;r++)if(n.dg(t,r,1,1))return!0;return!1},ve.prototype.cm=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g=this,m=new O.Rect(-1,-1,-1,-1),b=g.am();if(0===b.width||0===b.height)return m;if(t=g.Tq(e),r=be(g),n=ye(g),o=ge(g),i=me(g),a=g.ss,s=t.row,l=t.row+t.rowCount-1,u=t.col,c=t.col+t.colCount-1,h=pe(g),f=de(g),u<r)m.x=b.kt+he(a,0,u-1),m.width=he(a,u,P(c,r-1)),r<=c&&c<f-o?(d=g.it(1))&&0<d.length&&(m.width+=he(a,d[0].col,P(c,d[d.length-1].col))+g.eCb):f-o<=c&&(d=g.it(2))&&0<d.length&&(m.width=d[0].x-m.x,m.width+=he(a,f-o,P(c,f-1)));else if(u<f-o){if(!(d=g.it(1))||0===d.length||u>d[d.length-1].col||c<d[0].col)return m;m.x=b.pt+he(a,d[0].col,u-1)+g.eCb,r<=c&&c<f-o?m.width=he(a,L(u,d[0].col),P(c,d[d.length-1].col)):f-o<=c&&(d=g.it(2))&&0<d.length&&(m.width=d[0].x-m.x,m.width+=he(a,f-o,P(c,f-1)))}else u<f&&(d=g.it(2))&&0<d.length&&(m.x=b.lt+he(a,d[0].col,u-1),m.width=he(a,u,P(c,f-1)));if(s<n)m.y=b.nt+fe(a,0,s-1),m.height=fe(a,s,P(l,n-1)),n<=l&&l<h-i?(p=g.jt(1))&&0<p.length&&(m.height+=fe(a,p[0].row,P(l,p[p.length-1].row))+g.cCb):h-i<=l&&(p=g.jt(2))&&0<p.length&&(m.height=p[0].y-m.y,m.height+=fe(a,h-i,P(l,h-1)));else if(s<h-i){if(!(p=g.jt(1))||0===p.length||s>p[p.length-1].row||l<p[0].row)return m;m.y=b.qt+fe(a,p[0].row,s-1)+g.cCb,n<=l&&l<h-i?m.height=fe(a,L(s,p[0].row),P(l,p[p.length-1].row)):h-i<=l&&(p=g.jt(2))&&0<p.length&&(m.height=p[0].y-m.y,m.height+=fe(a,h-i,P(l,h-1)))}else s<h&&(p=g.jt(2))&&0<p.length&&(m.y=b.ot+fe(a,p[0].row,s-1),m.height+=fe(a,s,P(l,h-1)));return m},ve.prototype.Ws=function(){return this.Xs},ve.prototype.rt=function(e,t){return this.dp(e,t)+1},ve.prototype.dp=function(e,t){var r,n=this._render;return r=t||n.Cl(n.Bl()),O.Vn.Xn(e,r)},ve.prototype.or=function(e){var t=this.am(),r=H;return t.zr<e&&e<t.zr+t.Br?r=-1:t.kt<e&&e<t.kt+t.hs?r=0:t.pt<e&&e<t.pt+t.er?r=1:t.lt<e&&e<t.lt+t.js&&(r=2),r},ve.prototype.nr=function(e){var t=this.am(),r=H;return t.Ar<e&&e<t.Ar+t.Cr?r=-1:t.nt<e&&e<t.nt+t.fs?r=0:t.qt<e&&e<t.qt+t.jr?r=1:t.ot<e&&e<t.ot+t.gs&&(r=2),r},ve.prototype.pr=function(e,t){var r,n;if((r=-1===t?this.ut():this.jt(t))&&(n=r.findY(e)))return n.row},ve.prototype.qr=function(e,t){var r,n;if((r=-1===t?this.vt():this.it(t))&&(n=r.findX(e)))return n.col},ve.prototype.wt=function(e,t){return this.Jl<=e&&e<this.Jl+this.Lr&&this.Kl<=t&&t<this.Kl+this.Mr},ve.prototype.sp=function(e){return this._modelManager.sp(e)},ve.prototype.tp=function(e){return this._modelManager.tp(e)},ve.prototype.vp=function(e,t,r,n){var o=pe(this),i=de(this);return this._modelManager.vp(e,t,r,o,i,n)},ve.prototype.wp=function(e,t,r){var n=pe(this),o=de(this);return this._modelManager.wp(e,t,r,n,o)},ve.prototype.xt=function(e,t,r){var n,o,i,a,s,l,u=this.yt;if(u&&!u.resizeInfo&&!j(r)){if(a=u.hitTestType,s=u.row,l=u.col,1===r)return n=!1,(o=this._modelManager.findSpan(s,l,1))&&(n=o.contains(e,t,1,1)),i=e===s&&t===l||n,a===r&&i;if(2===r)return n=!1,(o=this._modelManager.findSpan(s,l,2))&&(n=o.contains(e,t,1,1)),i=e===s&&t===l||n,a===r&&i;if(3===r)return a===r&&e===s&&t===l;if(0===r)return a===r}return!1},ve.prototype.sr=function(e,t){return 0<=e&&e<=2&&0<=t?3:0<=e&&e<=2&&t<0?2:e<0&&0<=t?1:e<0&&t<0?0:H},ve.prototype.zt=function(e){var t=this._eventHandler;t&&t.zt(e)},ve.prototype.zo=function(){var e,t=this.parent,r=t&&t._host;return r=r||(e=this.Xs)&&e.parentElement},ve.prototype.Pp=function(){this.Jl=0,this.Kl=0,this.Lr=1,this.Mr=1,this.Qr=0,this.Rr=0},ve.prototype.Sl=function(e,t,r){var n=this.getRowHeight(e,t),o=this.zoom();return 1!==o&&(n*=o),r?n:W(n)},ve.prototype.Tl=function(e,t,r){var n=this.getColumnWidth(e,t),o=this.zoom();return 1!==o&&(n*=o),r?n:W(n)},ve.prototype.At=function(){var e,t,r,n,o,i,a,s,l,u=this,c=u.Dr(),h=u.options,f=h.sheetAreaOffset.left,d=h.sheetAreaOffset.top,p=new O.Rect(c.x+f,c.y+d,L(0,c.width-f),L(0,c.height-d)),g=p.width,m=p.height,b={x:p.x,y:p.y,width:p.width,height:p.height,Br:0,Cr:0,hs:0,fs:0,js:0,gs:0,Bt:0,Ct:0,Dt:0,Et:0,kt:0,nt:0,lt:0,ot:0,pt:0,qt:0,jr:0,er:0,zr:0,Ar:0,em:function(){return new O.Rect(this.x,this.y,this.Br,this.Cr)},gm:function(e){var t=this;return 0===e?new O.Rect(t.kt,t.y,t.hs,t.Cr):1===e?new O.Rect(t.pt,t.y,t.er,t.Cr):2===e?new O.Rect(t.lt,t.y,t.js,t.Cr):H},fm:function(e){var t=this;return 0===e?new O.Rect(t.x,t.nt,t.Br,t.fs):1===e?new O.Rect(t.x,t.qt,t.Br,t.jr):2===e?new O.Rect(t.x,t.ot,t.Br,t.gs):H},Ft:function(e,t){var r=this;if(0===e){if(0===t)return new O.Rect(r.kt,r.nt,r.hs,r.fs);if(1===t)return new O.Rect(r.pt,r.nt,r.er,r.fs);if(2===t)return new O.Rect(r.lt,r.nt,r.js,r.fs)}else if(1===e){if(0===t)return new O.Rect(r.kt,r.qt,r.hs,r.jr);if(1===t)return new O.Rect(r.pt,r.qt,r.er,r.jr);if(2===t)return new O.Rect(r.lt,r.qt,r.js,r.jr)}else if(2===e){if(0===t)return new O.Rect(r.kt,r.ot,r.hs,r.gs);if(1===t)return new O.Rect(r.pt,r.ot,r.er,r.gs);if(2===t)return new O.Rect(r.lt,r.ot,r.js,r.gs)}return H}};if(u.Gt&&(0<(e=u.Gt()).width&&(b.x+=e.width+0,g-=e.width+0),0<e.height&&(b.y+=e.height+0,m-=e.height+0)),h.rowHeaderVisible)for(o=u.getColumnCount(2),n=0;n<o;n++)b.Br+=u.Tl(n,2);if(h.colHeaderVisible)for(r=u.getRowCount(1),t=0;t<r;t++)b.Cr+=u.Sl(t,1);if(0<(i=be(u)))for(o=de(u),n=0;n<i&&n<o;n++)u.getColumnVisible(n)&&(b.hs+=u.Tl(n));if(0<(a=ye(u)))for(r=pe(u),t=0;t<a&&t<r;t++)u.getRowVisible(t)&&(b.fs+=u.Sl(t));if(0<(s=ge(u)))for(o=de(u),n=L(i,o-s);n<o;n++)b.js+=u.Tl(n);if(0<(l=me(u)))for(r=pe(u),t=L(a,r-l);t<r;t++)b.gs+=u.Sl(t);return g-=b.Br,m-=b.Cr,g-=b.hs,m-=b.fs,g-=b.js,m-=b.gs,m-=b.Bt,b.er=L(0,g),b.jr=L(0,m),b.zr=b.x,b.Ar=b.y,b.kt=b.zr+b.Br,b.nt=b.Ar+b.Cr,b.pt=b.kt+b.hs,b.qt=b.nt+b.fs,b.lt=b.pt+b.er,b.ot=b.qt+b.jr,b.Dt=b.zr,b.Et=b.y+b.height-b.Bt,b},ve.prototype.am=function(){return this._r||(this._r=this.At()),this._r},ve.prototype.Hr=function(e,t){return j(t)||3===t||1===t?this.it(e):2===t?this.vt():H},ve.prototype.vt=function(){return this.bs.rowHeader||(this.bs.rowHeader=this.Ht()),this.bs.rowHeader},ve.prototype.it=function(e){return this.bs.viewport||(this.bs.viewport={}),this.bs.viewport[e]||(this.bs.viewport[e]=this.It(e)),this.bs.viewport[e]},ve.prototype.Ht=function(){var e,t,r=new D.yp,n=this.am().zr,o=this.getColumnCount(2);for(t=0;t<o;t++)e=this.Tl(t,2),r.push(new D.zp(-1,t,n,-1,e,-1)),n+=e;return r},ve.prototype.It=function(e){var t,r,n,o,i,a=new D.yp,s=this.am(),l=de(this),u=this.ss,c=be(this),h=ge(this);if(0===e)for(r=s.kt,l=P(c,l),t=0;t<l;t++)n=u._m(t),a.push(new D.zp(-1,t,r,-1,n,-1)),r+=n;else if(1===e)for(o=this.eCb,r=s.pt+o,l-=h,i=s.er-o,t=L(c,this.qq);0<i&&t<l;t++)n=u._m(t),a.push(new D.zp(-1,t,r,-1,n,-1)),r+=n,i-=n;else if(2===e)for(r=s.lt,t=L(c,l-h);t<l;t++)n=u._m(t),a.push(new D.zp(-1,t,r,-1,n,-1)),r+=n;return a},ve.prototype.Gr=function(e,t){return j(t)||3===t||2===t?this.jt(e):1===t?this.ut():H},ve.prototype.Jt=function(e){var t,r,n=new D.yp;for(t=0;t<3;t++)(r=this.Gr(t,e))&&0<r.length&&(n=h.GC$.merge(n,r));return n},ve.prototype.Kt=function(e){var t,r,n=new D.yp;for(t=0;t<3;t++)(r=this.Hr(t,e))&&0<r.length&&(n=h.GC$.merge(n,r));return n},ve.prototype.ut=function(){return this.as.colHeader||(this.as.colHeader=this.Lt()),this.as.colHeader},ve.prototype.jt=function(e){return this.as.viewport||(this.as.viewport={}),this.as.viewport[e]||(this.as.viewport[e]=this.Mt(e)),this.as.viewport[e]},ve.prototype.Lt=function(){var e,t,r=new D.yp,n=this.am().Ar,o=this.getRowCount(1);for(t=0;t<o;t++)e=this.Sl(t,1),r.push(new D.zp(t,-1,-1,n,-1,e)),n+=e;return r},ve.prototype.Mt=function(e){var t,r,n,o,i,a=new D.yp,s=ye(this),l=me(this),u=this.am(),c=pe(this),h=this.ss;if(0===e)for(r=u.nt,c=P(s,c),t=0;t<c;t++)n=h.Sl(t),a.push(new D.zp(t,-1,-1,r,-1,n)),r+=n;else if(1===e)for(o=this.cCb,r=u.qt+o,c-=l,i=u.jr-o,t=L(s,this.lq);0<i&&t<c;t++)n=h.Sl(t),a.push(new D.zp(t,-1,-1,r,-1,n)),r+=n,i-=n;else if(2===e)for(r=u.ot,t=L(s,c-l);t<c;t++)n=h.Sl(t),a.push(new D.zp(t,-1,-1,r,-1,n)),r+=n;return a},ve.prototype.Ir=function(e,t,r,n){var o,i,a,s,l,u,c=this.getRowCount(r),h=this.getColumnCount(r),f=this.Gr(e,r),d=this.Hr(t,r),p=new D.yp;return f&&0<f.length&&d&&0<d.length&&(o=f[0].row,i=d[0].col,a=f[f.length-1].row,s=d[d.length-1].col,l=this._modelManager.getSpans(O.kf(o,i,a-o+1,s-i+1),r),n&&this.mJb&&(u=this.mJb.nJb(r),l=l.concat(u)),0<l.length&&this.Nt(l,o,i,a,s,p,c,h,r,f,d)),p},ve.prototype.rr=function(e,t,r,n,o){var i,a,s,l,u=this.getRowCount(r),c=this.getColumnCount(r),h=this.Gr(e,r),f=this.Hr(t,r),d=new D.yp;return h&&0<h.length&&f&&0<f.length?(i=h[0].row,a=f[0].col,(s=this.getSpan(n,o,r))&&((l=[]).push(s),this.Nt(l,i,a,s.row+s.rowCount,s.col+s.colCount,d,u,c,r,h,f)),0<d.length?d[0]:H):H},ve.prototype.Nt=function(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R=e.length;if(!(R<=0)){for(f=n+1,d=o+1,p=[],g=[],m=[],b=[],C=y=0,h=t-1;0<=h;h--)p[h]=this.Sl(h,l),C-=p[h],b[h]=C;for(C=0,h=t;h<f;h++)b[h]=C,p[h]=this.Sl(h,l),C+=p[h];for(h=r-1;0<=h;h--)g[h]=this.Tl(h,l),y-=g[h],m[h]=y;for(y=0,h=r;h<d;h++)m[h]=y,g[h]=this.Tl(h,l),y+=g[h];for(w=0;w<R;w++)if((v=e[w]).intersect(t,r,n-t+1,o-r+1)){if(f<(S=v.row+v.rowCount)){for(h=f;h<S;h++)p.push(this.Sl(h,l)),b.push(b[h-1]+p[h]);f=S}if(d<(x=v.col+v.colCount)){for(h=d;h<x;h++)g.push(this.Tl(h,l)),m.push(m[h-1]+g[h]);d=x}for(T=m[v.col],A=b[v.row],E=I=void(M=k=0),E=v.col;E<v.col+v.colCount&&E<s;E++)k+=g[E];for(I=v.row;I<v.row+v.rowCount&&I<a;I++)M+=p[I];i.push(new D.zp(v.row,v.col,c[0].x+T,u[0].y+A,k,M,v.rowCount,v.colCount,v.isAutoMerge))}}},ve.prototype.qs=function(){var e,t,r=this.parent,n=this.Ot(this.qq),o=this.eCb;-1!==n&&n!==this.qq&&(this.qq=n),(e=r&&r.Pt)&&(t=e.QB===M.ScrollType.pixels?this.jgc(n)-o:this.Qt(n),e.value(t))},ve.prototype.os=function(){var e,t,r=this.parent,n=this.Rt(this.lq),o=this.cCb;-1!==n&&n!==this.lq&&(this.lq=n),(e=r&&r.St)&&(t=e.QB===M.ScrollType.pixels?this.kgc(n)-o:this.Tt(n),e.value(t))},ve.prototype.ds=function(){var e,t=this.parent;t&&t.Pt&&(e=t.options.scrollByPixel,t.Pt.QB=e?M.ScrollType.pixels:M.ScrollType.continuous),t&&t.Ut&&(t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile&&t.hec(),t.options.scrollIgnoreHidden&&(this.Vt=this.Wt(!0)),t.Ut())},ve.prototype.es=function(){var e,t=this.parent;t&&t.St&&(e=t.options.scrollByPixel,t.St.QB=e?M.ScrollType.pixels:M.ScrollType.continuous),t&&t.Xt&&(t.options.scrollbarAppearance===M.ScrollbarAppearance.mobile&&t.hec(),t.options.scrollIgnoreHidden&&(this.Yt=this.Zt(!0)),t.Xt())},ve.prototype.$t=function(){var e=be(this);return 0<e?this.Zq(e-1):this.$q()},ve.prototype._t=function(){var e=ye(this);return 0<e?this._q(e-1):this.ar()},ve.prototype.$q=function(e){return this.Zq(-1,e)},ve.prototype.Zq=function(e,t,r){for(var n=this.getColumnCount(t),o=r?n-1:n-1-ge(this);e<o;)if(e++,this.getColumnVisible(e,t)&&0<this.Tl(e,t))return e;return H},ve.prototype.br=function(e,t){for(var r=be(this);r<e;)if(e--,this.getColumnVisible(e,t)&&0<this.Tl(e,t))return e;return H},ve.prototype.ar=function(e){return this._q(-1,e)},ve.prototype._q=function(e,t,r){for(var n=this.getRowCount(t),o=r?n-1:n-1-me(this);e<o;)if(e++,this.getRowVisible(e,t)&&0<this.Sl(e,t))return e;return H},ve.prototype.gr=function(e,t,r){for(var n=r?0:ye(this);n<e;)if(e--,this.getRowVisible(e,t)&&0<this.Sl(e,t))return e;return H},ve.prototype.au=function(){this.jq=!0,this.os()},ve.prototype.bu=function(){this.oq=!0,this.qs()},ve.prototype.kgc=function(e){var t,r=ye(this),n=r+(pe(this)-me(this)-r)-1,o=0;if(e<=r)return o;for(n<e&&(e=n),t=r;t<e;t++)o+=this.Sl(t);return o},ve.prototype.jgc=function(e){var t,r=be(this),n=r+(de(this)-ge(this)-r)-1,o=0;if(e<=r)return o;for(n<e&&(e=n),t=r;t<e;t++)o+=this.Tl(t);return o},ve.prototype.Tt=function(e){var t=this.parent;return t&&t.options.scrollIgnoreHidden?this.Zt().visibleIndex[e]:e},ve.prototype.cu=function(e){var t=this.parent;return t&&t.options.scrollIgnoreHidden?this.Zt().originalIndex[e]:e},ve.prototype.Qt=function(e){var t=this.parent;return t&&t.options.scrollIgnoreHidden?this.Wt().visibleIndex[e]:e},ve.prototype.du=function(e){var t=this.parent;return t&&t.options.scrollIgnoreHidden?this.Wt().originalIndex[e]:e},ve.prototype.Wt=function(e){var t,r,n,o,i,a,s;if(this.Vt&&!e)return this.Vt;if(n=(r=t=be(this))+(de(this)-ge(this)-t)-1,o=this.ss,i={visibleIndex:{},originalIndex:{}},n-r+1<=0)return i;for(a=0,s=r;s<=n;s++)i.originalIndex[a]=s,i.visibleIndex[s]=a,0<o._m(s)&&a++;for(s--,a--;o._m(s)<=0&&r<=s;)i.originalIndex[a]=s,i.visibleIndex[s]=a,s--;return i},ve.prototype.Zt=function(e){var t,r,n,o,i,a,s;if(this.Yt&&!e)return this.Yt;if(n=(r=t=ye(this))+(pe(this)-me(this)-t)-1,o=this.ss,i={visibleIndex:{},originalIndex:{}},n-r+1<=0)return i;for(a=0,s=r;s<=n;s++)i.originalIndex[a]=s,i.visibleIndex[s]=a,0<o.Sl(s)&&a++;for(s--,a--;o.Sl(s)<=0&&r<=s;)i.originalIndex[a]=s,i.visibleIndex[s]=a,s--;return i},ve.prototype.Rt=function(e,t){var r,n=ye(this),o=pe(this)-me(this)-1;if(t){if(o<e&&(e=o),(r=this.gr(e+1))!==H&&n<=r)return r}else if(e<n&&(e=n),(r=this._q(e-1))!==H&&r<=o)return r;return-1},ve.prototype.Ot=function(e,t){var r,n=be(this),o=de(this)-ge(this)-1;if(t){if(o<e&&(e=o),(r=this.br(e+1))!==H&&n<=r)return r}else if(e<n&&(e=n),(r=this.Zq(e-1))!==H&&r<=o)return r;return-1},ve.prototype.eu=function(e,t,r){var n,o,i,a,s;if(r<t)return r;for(n=0,o=this.ss,a=i=r;t<=a;a--)if(!((s=o.Sl(a))<=0)){if(e<(n+=s))break;i=a}return i},ve.prototype.LHb=function(e,t,r){var n,o,i=0,a=r,s=0;for(n=r;t<=n;n--)if(!((o=this.Sl(n))<=0)&&(a=n,e<=(i+=o))){s=e-i;break}return{cj:a,UP:s}},ve.prototype.fu=function(e,t,r){var n,o,i,a,s;if(r<t)return r;for(n=0,o=this.ss,a=i=r;t<=a;a--)if(!((s=o._m(a))<=0)){if(e<(n+=s))break;i=a}return i},ve.prototype.MHb=function(e,t,r){var n,o,i=0,a=r,s=0;for(n=r;t<=n;n--)if(!((o=this.Tl(n))<=0)&&(a=n,e<=(i+=o))){s=e-i;break}return{dj:a,UP:s}},ve.prototype.gu=function(){var e,t,r,n=this.am(),o=this.Hr(1,3),i=0,a=0;if(o)for(e=0;e<o.length;e++)i+=t=o[e].width,0<t&&a++;return 0==(r=i/(a=0===a?1:a))?1:U(n.er/r)},ve.prototype.hu=function(){var e,t,r,n=this.am(),o=this.Gr(1,3),i=0,a=0;if(o)for(e=0;e<o.length;e++)i+=t=o[e].height,0<t&&a++;return 0==(r=i/(a=0===a?1:a))?1:U(n.jr/r)},ve.prototype.ns=function(e){var t,r,n,o,i,a;return j(e)&&(e=3),t=this.parent,r=ye(this),n=me(this),t&&t.options.scrollbarMaxAlign?(o=this.am(),this.eu(o.jr,r,pe(this)-n-1)):(i=this.getRowCount(e),3!==e&&2!==e||(i-=n),(a=this.gr(i,e))===H&&(a=r),a)},ve.prototype.ps=function(e){var t,r,n,o,i;return j(e)&&(e=3),t=this.parent,r=be(this),t&&t.options.scrollbarMaxAlign?(n=this.am(),this.fu(n.er,r,de(this)-ge(this)-1)):(o=this.getColumnCount(e),3!==e&&1!==e||(o-=ge(this)),(i=this.br(o,e))===H&&(i=r),i)},ve.prototype.iu=function(){var e,t,r,n,o=this,i=ye(o),a=be(o),s=pe(o)-me(o)-1,l=de(o)-ge(o)-1,u=o._modelManager,c=u.getLastNonNullRow(3);return i<c&&(i=c),e=u.getLastNonNullCol(3),a<e&&(a=e),t=u.getLastNonNullRow(2),i<t&&(i=t),r=u.getLastNonNullCol(1),a<r&&(a=r),(n=ve._features)&&v(n,function(e,t){var r,n=t.lastNonNullRowAndCol;n&&(r=n.call(o),i=L(i,r.lastNonNullRow),a=L(a,r.lastNonNullCol))}),s<i&&(i=s),l<a&&(a=l),{lastNonNullRow:i,lastNonNullCol:a}},ve.prototype.mq=function(e,t,r){var n,o=this.lq,i=this.cCb,a=this.ns();o>=this.getRowCount()&&a<e&&(e=a),e>=this._t()&&e<=a&&(r||e!==o||t!==i)&&((n=this.parent)&&(n.ku.ju(e,t||0,r),this.os()),n&&!n.options.scrollbarShowMax&&this.es())},ve.prototype.rq=function(e,t,r){var n,o=this.qq,i=this.eCb,a=this.ps();o>=this.getColumnCount()&&a<e&&(e=a),e>=this.$t()&&e<=a&&(r||e!==o||t!==i)&&((n=this.parent)&&(n.ku.lu(e,t||0,r),this.qs()),n&&!n.options.scrollbarShowMax&&this.ds())},ve.prototype.yr=function(e,t,r){var n,o,i,a,s,l,u,c=e.row,h=e.col,f=e.hitTestType;return j(c)||j(h)?H:((n=this.getSpan(c,h,f))&&(c=n.row,h=n.col),this.mJb&&(o=this.mJb.oJb(c,h,f))&&(c=o.row,h=o.col),i=this.AHb(c,h,f),a=1===f?-1:G,s=2===f?-1:G,l=this.getCellRect(c,h,a,s,!0),u={sheet:this,row:c,col:h,sheetArea:f},(i.cellType||this.Al(f)).h5(t,r,i,l,u))},ve.prototype.mu=function(){this.unbindAll(),this.nu()},ve.prototype.ou=function(e){var t,r,n,o,i,a=this.Tq(e),s=a.row,l=a.col,u=s+a.rowCount,c=l+a.colCount;for(t=s;t<u;t++)for(r=l;r<c;r++)if(o=(n=this.getSpan(t,r))?n.row:t,i=n?n.col:r,!0===this.getActualStyle(o,i).locked)return!0;return!1},ve.prototype.pu=function(e,t,r,n,o,i){if(-1<=e&&e<o&&-1<=t&&t<i){if(-1===e&&-1===t)return!0;if(-1===e){if(0!==n&&t+n<=i)return!0}else if(-1===t){if(0!==r&&e+r<=o)return!0}else if(0!==n&&t+n<=i&&0!==r&&e+r<=o)return!0}return!1},ve.prototype.qu=function(e,t,r,n){var o,i,a;return!(e<0&&t<0)&&(e<0&&(o=this._modelManager.zl(1))&&o.spans&&0<o.spans.length?this._modelManager.qu(-1,t,-1,n,1):t<0&&(i=this._modelManager.zl(2))&&i.spans&&0<i.spans.length?this._modelManager.qu(e,-1,r,-1,2):!!((a=this._modelManager.zl(3))&&a.spans&&0<a.spans.length)&&this._modelManager.qu(e,t,r,n,3))},ve.prototype.suspendPaint=function(){var e=this.Xq;this.Xq++,0===e&&ve.ao(this,X,{suspend:!0})},ve.prototype.resumePaint=function(){var e;this.Xq--,this.Xq<=0&&(this.Xq=0,ve.ao(this,X,{suspend:!1}),(e=this.parent)&&e.getActiveSheet()!==this||this.$p())},ve.prototype.isPaintSuspended=function(){return 0<this.Xq},ve.prototype.su=function(e,t){var r,n,o=e&&e.length;for(r=0;r<o;r++)if(n=e[r],t.intersect(n.row,n.col,n.rowCount,n.colCount))return e.splice(r,1),this.su(e,t.union(n));return t},ve.prototype.getClipboardHelperObj=function(){var e=this.tu();return{isCutting:e.G4,ranges:e.n5,showInsertCopyPasteCells:e.UHb}},ve.prototype.tu=function(){var e=this.parent;return this.uu||(this.uu=e&&e.uu),this.uu},ve.prototype.vu=function(){if(!this.bt){var e=this;e.bt=new n.oo(function(){e.bt&&e.repaint()})}return this.bt},ve.prototype.wu=function(){var e=this.parent;if(e)return e.commandManager()},ve.prototype.Os=function(e,t){this.Wq(O.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:e,message:t})},ve.prototype.Bq=function(e,t,r,n,o,i){var a;0===this.jm&&(a={sheet:this,sheetName:this.name(),row:t,col:r,sheetArea:n,propertyName:e,oldValue:o,newValue:i,isUndo:this.OIb},this.Wq(O.Events.CellChanged,a),this._modelManager.ZVa(["cellChanged",e,t,r,n,i,o]))},ve.prototype.xu=function(e,t,r,n){this.Wq(O.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:e,col:t,oldValue:r,newValue:n})},ve.prototype.qCb=function(e,t,r,n,o){var i;0===this.jm&&(i={sheet:this,sheetName:this.name(),col:e,sheetArea:t,propertyName:r,newValue:n,oldValue:o},"addColumns"!==r&&"deleteColums"!==r||(i.count=n),this.Wq(O.Events.ColumnChanging,i),this._modelManager.ZVa(["columnChanging",e,t,r,o,n]))},ve.prototype.pq=function(e,t,r,n,o){var i;0===this.jm&&(i={sheet:this,sheetName:this.name(),col:e,sheetArea:t,propertyName:r,newValue:n,oldValue:o,isUndo:this.OIb},"addColumns"!==r&&"deleteColumns"!==r||(i.count=n),this.Wq(O.Events.ColumnChanged,i),this._modelManager.ZVa(["columnChanged",e,t,r,o,n]))},ve.prototype.RIb=function(e,t,r,n){var o,i,a,s=[];if(this.tables){for(o=this.tables.pJb(e,t,r,n),i=0;i<o.length;i++)s.push(o[i].name());0<s.length&&(a={isUndo:this.OIb,sheet:this,sheetName:this.name(),row:e,col:r,rowCount:t,colCount:n,tableNames:s,action:2},this.Wq(O.Events.RangeChanged,a),this._modelManager.ZVa(["rangeChanged",e,t,r,n]))}},ve.prototype.pCb=function(e,t,r,n,o){var i;0===this.jm&&(i={sheet:this,sheetName:this.name(),row:e,sheetArea:t,propertyName:r,newValue:n,oldValue:o},"addRows"!==r&&"deleteRows"!==r||(i.count=n),this.Wq(O.Events.RowChanging,i),this._modelManager.ZVa(["rowChanging",e,t,r,o,n]))},ve.prototype.kq=function(e,t,r,n,o){var i;0===this.jm&&(i={sheet:this,sheetName:this.name(),row:e,sheetArea:t,propertyName:r,newValue:n,oldValue:o,isUndo:this.OIb},"addRows"!==r&&"deleteRows"!==r||(i.count=n),this.Wq(O.Events.RowChanged,i),this._modelManager.ZVa(["rowChanged",e,t,r,o,n]))},ve.prototype.gyb=function(e,t){t!==e&&(this.Wq(O.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:e,newZoomFactor:t}),this.Wq(O.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:e,newZoomFactor:t}))},ve.prototype.yu=function(e,t){return!(this.n_a||!this._eventHandler.zu(e,t)||(this.Wq(O.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:e,newSelections:t}),0))},ve.prototype.Au=function(e){this.Wq(O.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:e,newSelections:this.getSelections()})},ve.prototype.Bu=function(e,t,r,n,o,i,a,s,l,u){var c={sheet:this,sheetName:this.name(),row:e,col:t,rowCount:r,colCount:n,changedCells:o,action:i},h={sheet:this,sheetName:this.name(),row:e,col:t,rowCount:r,colCount:n,changedCells:o,isUndo:!!u,action:i};a&&(c.sheetArea=a,h.sheetArea=a),s&&(c.value=s),o&&0<o.length&&(l&&0<l.length&&(h.tableNames=l),this.Wq(O.Events.RangeChanged,h),this.Wq(O.Events.FormulatextboxRangeChanged,c))},ve.prototype._raiseEditorStatusChanged=function(e,t){var r={sheet:this,sheetName:this.name(),oldStatus:e,newStatus:t};this.Wq(O.Events.EditorStatusChanged,r)},ve.prototype.Du=function(){return this.b4||(this.b4=h.GC$(b("input"))),this.b4},ve.prototype.bind=function(e,t,r){this.Du().bind(e+$,t,r)},ve.prototype.unbind=function(e,t){this.Du().unbind(e+$,t)},ve.prototype.Wq=function(e,t,r){this.updateEventsData&&this.updateEventsData(e,t),0!==this.jm&&!r||this.Du().trigger(e,t)},ve.prototype.unbindAll=function(){this.unbind($)},ve.prototype._bind=function(e,t,r){0<=e.indexOf(".")?this.bind(e,t,r):this.bind(e+ee,t,r)},ve.prototype._unbind=function(e,t){0<=e.indexOf(".")?this.unbind(e,t):this.unbind(e+ee,t)},ve.prototype.nu=function(){this.unbind(ee)},ve.prototype.Dr=function(){var e=this.Zs;return new O.Rect(e.x,e.y,e.width,e.height)},ve.prototype.Us=function(e){this.Zs=new O.Rect(e.x,e.y,e.width,e.height)},ve.prototype.scroll=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d=this,p=d.parent;p&&(n=(r=p.options).scrollByPixel,o=r.scrollPixel,i=p.ku,a=r.scrollbarShowMax,s=r.showHorizontalScrollbar,l=r.showVerticalScrollbar,0!==t&&(c=(u=i._Bb(d,Math.round(t)/o)).dj,h=n?u.UP:0,c===d.qq&&h===d.eCb||(i.lu(c,h),s&&(d.qs(),a||(d.oq=!0)))),0!==e&&(c=(f=i.aCb(d,Math.round(e)/o)).cj,h=n?f.UP:0,c===d.lq&&h===d.cCb||(i.ju(c,h),l&&(d.os(),a||(d.jq=!0)))))},ve.prototype.isCtrlPressed=function(e){return this._eventHandler&&this._eventHandler.ctrl},ve.prototype.deselectIgnoreSpan=function(){return!1},ve.Np=1,ve.Qp=ie,ve.Rp=200,ve.Sp=20,ve.Tp=1,ve.Vp=1,ae=ve,t.Worksheet=ae,O.Zn(ae),(se=ae.prototype).visible=y("visible",!0,function(e){var t,r=this.parent,n=r.sheets,o=n.length,i=h.GC$.inArray(this,n),a=r.getActiveSheetIndex();if(e)a<0?(r.dq(i,1),r.hq&&r.hq.gq<0&&(r.hq.gq=i)):r.aq();else if(i===a){for(t=i+1;t<o&&!n[t].visible();)t++;if(o<=t)for(t=i-1;0<=t&&!n[t].visible();)t--;r.hq&&t<r.hq.gq&&(r.hq.gq=t),t<0?(this.no(!1),r.eq=t,r.fq()):r.dq(t,1)}else r.aq()}),se.frozenColumnCount=y("frozenColumnCount",0,function(e){this.qq<e?this.qq=e:""!==e&&0!==e&&null!==e||(this.qq=0),this.oq=!0,this.$p()},function(e){return 0<=e}),se.frozenRowCount=y("frozenRowCount",0,function(e){this.lq<e?this.lq=e:""!==e&&0!==e&&null!==e||(this.lq=0),this.jq=!0,this.$p()},function(e){return 0<=e}),se.frozenTrailingRowCount=y("frozenTrailingRowCount",0,function(){this.jq=!0,this.$p()},function(e){return 0<=e}),se.frozenTrailingColumnCount=y("frozenTrailingColumnCount",0,function(){this.oq=!0,this.$p()},function(e){return 0<=e})},"./dist/plugins/celltype/buttoncelltype.js":function(e,t,r){"use strict";var n,y,a,h,o,i,C,s,l,u,c,f,d,p,g,m,b,w,v=this&&this.__extends||(b=function(e,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function S(e,t,r,n){var o,i=e._modelManager;i&&(i.do("setValueForKey",t,r,f,c,n),(o=i.getValueForKey(t,r,d,n))&&(clearTimeout(o),i.do("setValueForKey",t,r,d,c,n)))}function x(){var r,e=w.call(this)||this;return e.typeName="6",r=e,u(g,function(e,t){r["_"+e]=t}),e}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),y=r("Core"),a=y.Events.SelectionChanged,h=n.Common.j.Fa,o=y.Ul.nl,i=y.CellTypes.Context,C=y.CellTypes.Text,s=y.CellTypes.Base,l=y.GC$,u=l.each,c=void 0,f="_isFirstMouseUp",d="_mouseupToken",p=".buttonCellType",g={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:null,buttonState:0},v(x,w=s),x.prototype.paintValue=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b;e&&(l=this._marginLeft,u=this._marginTop,c=r+l,h=n+u,f=o-l-this._marginRight,d=i-u-this._marginBottom,0<f-2&&0<d-2&&r<c+f&&c<r+o&&n<h+d&&h<n+i&&(e.save(),(c<r||r+o<c+f||h<n||n+i<h+d)&&(e.rect(r,n,o,i),e.clip()),e.beginPath(),p="#707070",e.strokeStyle!==p&&(e.strokeStyle=p),e.strokeRect(c+.5,h+.5,f-1,d-1),g=void 0,m=this._buttonState,b=this._text,g=2===m?"#34B4E3":(g=this._buttonBackColor)||{degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]},e.fillStyle!==g&&(e.fillStyle=g),y.To.setFillStyle(e,g,r,n,o,i,function(){e.fillRect(c+1,h+1,f-2,d-2)}),e.restore(),b&&C.prototype.paintValue.call(this,e,b,c,h,f,d,a,s)))},x.prototype.getText=function(e,t){return e},x.prototype.tw=function(e,t,r,n){var o=e.parent;o&&o.tw(e,t,r,n)},x.prototype.getHitInfo=function(e,t,r,n,o){var i,a,s,l,u,c;return o&&(i=o.sheetArea,(h(i)||3===i)&&n)?(a=n.x+this._marginLeft,s=n.x+n.width-this._marginRight,l=n.y+this._marginTop,u=n.y+n.height-this._marginBottom,c={x:e,y:t,row:o.row,col:o.col,cellRect:n,sheetArea:i,sheet:o.sheet,cellStyle:r},a<=e&&e<=s&&l<=t&&t<=u&&(c.isReservedLocation=!0),c):null},x.prototype.processMouseDown=function(e){var t=e&&e.sheet;return!(!t||!e.isReservedLocation||this.uK||(this.uK=!0,this._buttonState=2,t.repaint(e.cellRect),0))},x.prototype.processMouseUp=function(e){var t,r,n,o,i=e&&e.sheet;if(this.uK&&i&&e.isReservedLocation){if(this._buttonState=0,i.repaint(e.cellRect),this.uK=!1,t=e.row,r=e.col,n=e.sheetArea,!i._modelManager.getValueForKey(t,r,f,n))return this.tw(i,t,r,n),i._modelManager.do("setValueForKey",t,r,f,!0,n),o=setTimeout(function(){S(i,t,r,n)},250),i._modelManager.do("setValueForKey",t,r,d,o,n),!0;S(i,t,r,n)}return!1},x.prototype.processMouseLeave=function(e){var t=e&&e.sheet;t&&this.uK&&(this._buttonState=0,t.repaint(e.cellRect),this.uK=!1)},x.prototype.processKeyDown=function(e,t){var r,n=t.sheet,o=this;return!(!n||o.vK||(r=n.getCellRect(t.row,t.col),o._buttonState=2,n.repaint(r),n._bind(a+p,function(){n._unbind(a+p),o.vK=!1,o._buttonState=0,n.repaint(r)}),o.vK=!0,0))},x.prototype.processKeyUp=function(e,t){var r,n,o,i=t.sheet;return!(!i||!this.vK||(r=t.row,n=t.col,o=i.getCellRect(r,n),this._buttonState=0,i.repaint(o),i._unbind(a+p),this.tw(i,r,n,t.sheetArea),this.vK=!1))},x.prototype.isReservedKey=function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},x.prototype.getAutoFitWidth=function(e,t,r,n,o){return i.cp(e,this._text,r,n,o)+this._marginLeft+this._marginRight},x.prototype.getAutoFitHeight=function(e,t,r,n,o){return i.ep(e,this._text,r,n,o)+this._marginTop+this._marginBottom},x.prototype.JH=function(e){this.isReservedKey(e)&&o(e)},x.prototype.isImeAware=function(e){return!1},x.prototype.toJSON=function(){var r,n=this,o={typeName:n.typeName};return u(g,function(e,t){"buttonState"!==e&&(r=n["_"+e])!==t&&(o[e]=r)}),o},x.prototype.fromJSON=function(r){var n=this;u(g,function(e){var t=r[e];h(t)||(n["_"+e]=t)})},x.prototype._createCellTypeElement=function(e){},x.prototype.gQa=function(){},m=x,t.Button=m,u(g,function(t){m.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}}),y.CellTypes._o[6]=m},"./dist/plugins/celltype/cellbuttons.js":function(e,t,r){"use strict";var z,n,q,v,Z,Y,f,K,X,J,Q,$,ee,w,S,h,te,re,ne,oe,x,o,D,N,F,_,P,L,O,B,d,ie,g,ae,i,a;function T(e){switch(e){case P:return z.ButtonPosition.left;case L:return z.ButtonPosition.right;case O:return z.ButtonPosition.leftOfText;case B:return z.ButtonPosition.rightOfText}}function A(e){switch(e){case z.ButtonPosition.left:return P;case z.ButtonPosition.right:return L;case z.ButtonPosition.leftOfText:return O;case z.ButtonPosition.rightOfText:return B}}function p(e){var t,r,n=e.split(" ");for(r=0;r<n.length;r++)if(0<=n[r].indexOf(o)){t=n[r];break}switch(t){case D:return P;case N:return L;case F:return O;case _:return B}}function m(e){switch(e){case P:return D;case L:return N;case O:return F;case B:return _}}function k(e,t,r,n){var o,i=e._modelManager;i&&(i.do("setValueForKey",t,r,w,Z,n),(o=i.getValueForKey(t,r,S,n))&&(clearTimeout(o),i.do("setValueForKey",t,r,S,Z,n)))}function se(e,t,r){var n,o;switch(r){case ae.topLeft:return new z.Rect(e.x,e.y,Math.min(t.width,e.width),Math.min(t.height,e.height));case ae.topCenter:return n=(e.width-t.width)/2,n=Math.max(0,n),new z.Rect(e.x+n,e.y,Math.min(t.width,e.width),Math.min(t.height,e.height));case ae.topRight:return n=e.width-t.width,n=Math.max(0,n),new z.Rect(e.x+n,e.y,Math.min(t.width,e.width),Math.min(t.height,e.height));case ae.MiddleLeft:return o=(e.height-t.height)/2,o=Math.max(0,o),new z.Rect(e.x,e.y+o,Math.min(t.width,e.width),Math.min(t.height,e.height));case ae.MiddleCenter:return n=(e.width-t.width)/2,n=Math.max(0,n),o=(e.height-t.height)/2,o=Math.max(0,o),new z.Rect(e.x+n,e.y+o,Math.min(t.width,e.width),Math.min(t.height,e.height));case ae.MiddleRight:return n=e.width-t.width,n=Math.max(0,n),o=(e.height-t.height)/2,o=Math.max(0,o),new z.Rect(e.x+n,e.y+o,Math.min(t.width,e.width),Math.min(t.height,e.height));case ae.bottomLeft:return o=e.height-t.height,o=Math.max(0,o),new z.Rect(e.x,e.y+o,Math.min(t.width,e.width),Math.min(t.height,e.height));case ae.bottomCenter:return n=(e.width-t.width)/2,n=Math.max(0,n),o=e.height-t.height,o=Math.max(0,o),new z.Rect(e.x+n,e.y+o,Math.min(t.width,e.width),Math.min(t.height,e.height));case ae.bottomRight:return n=e.width-t.width,n=Math.max(0,n),o=e.height-t.height,o=Math.max(0,o),new z.Rect(e.x+n,e.y+o,Math.min(t.width,e.width),Math.min(t.height,e.height))}}function s(e,t,r){var n,o,i,a,s,l,u,c,h=[];for(n=0;n<e.length;n++)h.push({width:R(e[n].button,t,r),height:(o=e[n].button,(c=u=l=s=a=void 0)===a&&(a=!0),s=(i=r).sheet.zoom(),l=i.sheet.getRowHeight(i.row),u=o.imageSize?o.imageSize.height:Y,c=f(1,u||l),isNaN(c)&&(c=1),a?c*s:c)});return h}function M(e,t,r,n,o,i){var a,s,l,u,c=[],h=[];for(a=0;a<e.length;a++)s=t[e[a].index],q(s)?h.push(e[a]):c.push(s);for(l=function(e){var t,r,n,o,i;if(e.length<=0)return new z.Rect(0,0,0,0);for(t=e[0].x,r=e[0].y,n=e[0].x+e[0].width,o=e[0].y+e[0].height,i=1;i<e.length;i++)t=Math.min(t,e[i].x),r=Math.min(r,e[i].y),n=Math.max(n,e[i].x+e[i].width),o=Math.max(o,e[i].y+e[i].height);return new z.Rect(t,r,n-t,o-r)}(c),a=0;a<h.length;a++)u=R(h[a].button,r,n),(!i||l.width+u<=i.width)&&(l.width+=u);return l.height=l.height?l.height:i?i.height:0,l}function b(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y,C,w=H(t,r,a,s,!0,[e]);if(0<w.length){switch(I(w,t),e){case z.ButtonPosition.left:h=D;break;case z.ButtonPosition.right:h=N;break;case z.ButtonPosition.leftOfText:h=F;break;case z.ButtonPosition.rightOfText:h=_;break;default:return}switch(f=M(w,u,o,n,0,i),d="0",p=v(),(z.Ul.Ml.mozilla||1<p)&&(d="1px"),g=f.width,m=f.height,b=A(e),q(l.canvasSizes)&&(l.canvasSizes={}),(y=l.canvasSizes)[b]={width:g,height:m},C=function(e,t,r,n){var o,i=document.createElement("canvas");for(o in i.className=e+" "+x,n)n.hasOwnProperty(o)&&(i.style[o]=n[o]);return i.width=t,i.height=r,i}(h,g,m,{width:g+"px",height:m+"px",display:"block",position:"absolute",bottom:d,overflow:"hidden",paddingTop:"0"}),e){case z.ButtonPosition.left:C.style.left="0";break;case z.ButtonPosition.right:C.style.right="0";break;case z.ButtonPosition.leftOfText:C.style.left=y[P].width+"px";break;case z.ButtonPosition.rightOfText:C.style.right=y[L].width+"px";break;default:return}c.appendChild(C)}}function j(e,t,r,n,o,i,a,s){var l,u,c,h,f,d;if(!q(e))for(q(s[r])&&(s[r]={}),I(t,n.sheet),l=e.getContext("2d"),u=M(t,a,o,n),l.setTransform(parseFloat(e.style.width)/u.width,0,0,parseFloat(e.style.height)/u.height,0,0),c=0,h=new z.Rect(0,0,parseFloat(e.style.width),parseFloat(e.style.height)),f=0;f<t.length&&(d=E(l,c,0,R(t[f].button,o,n),n.sheet.getRowHeight(n.row),t[f].button,o,n,i,s[r],t[f].index,h),!q(d));f++)c+=d.width}function y(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R=H(t,r,a,s,!0,[e]);if(0<R.length){switch(d=f=void 0,e){case z.ButtonPosition.left:f=D,d=P;break;case z.ButtonPosition.right:f=N,d=L;break;case z.ButtonPosition.leftOfText:f=F,d=O;break;case z.ButtonPosition.rightOfText:f=_,d=B;break;default:return}if(p=h.querySelector("."+f),q(p))return;switch(g=parseFloat(p.style.width),m=i.options.contentRect,b=i.options.leftExternalRect,y=i.options.rightExternalRect,e){case z.ButtonPosition.left:m.x+=g,m.width-=g;break;case z.ButtonPosition.right:m.width-=g;break;case z.ButtonPosition.leftOfText:b.width+=g;break;case z.ButtonPosition.rightOfText:y.width+=g}j(p,R,d,n,o,l,u,c),C=p,w=d,v=n,S=o,x=i.options.cellRect,q((T=l).eventListeners)&&(T.eventListeners={}),q(T.eventListeners[w])&&(T.eventListeners[w]={}),k=(A=T.eventListeners[w]).mouseDownListener=function(e){W(U({x:e.offsetX,y:e.offsetY,context:v,cellRect:x,cellStyle:S,buttonArea:w},!0),!0,C)},C.addEventListener("mousedown",k),M=A.mouseUpListener=function(e){V(U({x:e.offsetX,y:e.offsetY,context:v,cellRect:x,cellStyle:S,buttonArea:w},!0),!0,C)},C.addEventListener("mouseup",M),I=A.mouseMoveListener=function(e){ue(U({x:e.offsetX,y:e.offsetY,context:v,cellRect:x,cellStyle:S,buttonArea:w},!0),!0,C)},C.addEventListener("mousemove",I),E=A.mouseLeaveListener=function(e){var t={x:e.offsetX,y:e.offsetY,context:v,cellRect:x,cellStyle:S,buttonArea:w};t.x<0&&(t.x=0),t.x>=parseFloat(C.style.width)&&(t.x=parseFloat(C.style.width)-1),ce(U(t,!0),!0,C)},C.addEventListener("mouseleave",E)}}function l(e,t,r,n,o,i,a){var s,l,u,c,h,f,d=H(t,r,n,o,!0,[e]);if(d&&0<d.length)switch(s=A(e),l=i[s]&&i[s].width||0,u=a.contentContainer,c=a.contentRect,h=a.leftExternalRect,f=a.rightExternalRect,e){case z.ButtonPosition.left:C(u,"left",l),c.x+=l,c.width-=l;break;case z.ButtonPosition.leftOfText:C(u,"left",l),h.width+=l;break;case z.ButtonPosition.right:c.width-=l;break;case z.ButtonPosition.rightOfText:f.width+=l;break;default:return}}function C(e,t,r){var n=0;e.style[t]&&(n=+e.style[t].replace("px","")||0),n+=r,e.style[t]=n-1+"px"}function I(e,t){var r,n,o=t.vu();for(r=0;r<e.length;r++)(n=de(e[r].button))&&o.fo(n)}function u(e,t,r,n,o,i,a){var s,l,u,c,h,f,d;if(e&&!(t.length<=0)){if(o=fe(o),I(t,s=i.sheet),l=function(e,t,r){switch(r){case z.ButtonPosition.leftOfText:return new z.Rect(e.x,e.y,t.x-e.x,e.height);case z.ButtonPosition.rightOfText:return new z.Rect(t.x+t.width,e.y,e.x+e.width-t.x-t.width,e.height)}}(r,n,a?z.ButtonPosition.leftOfText:z.ButtonPosition.rightOfText),e.save(),e.rect(l.x,l.y,l.width,l.height),e.clip(),e.beginPath(),u=G(s,i.row,i.col,i.sheetArea),c=fe(o),q(u.layout)&&(u.layout={}),a)for(h=l.x+l.width,f=t.length-1;0<=f&&(d=E(e,h-=R(t[f].button,c,i),r.y,R(t[f].button,c,i),l.height,t[f].button,c,i,u,u.layout,t[f].index,r),!q(d));f--);else for(h=l.x,f=0;f<t.length&&(d=E(e,h,r.y,R(t[f].button,c,i),l.height,t[f].button,c,i,u,u.layout,t[f].index,r),!q(d));f++)h+=d.width;e.restore()}}function E(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V=0;if(l.buttonDownIndex===c?V=2:l.buttonHoverIndex===c&&(V=3),f=function(e,t,r,n,o){if(!(e+r<o.x||e>o.x+o.width||t+n<o.y||t>o.y+o.height))return e+r>o.x+o.width&&(r=o.x+o.width-e),t+n>o.y+o.height&&(n=o.y+o.height-t),e<o.x&&(e=o.x),t<o.y&&(t=o.y),new z.Rect(e,t,r,n)}(t,r,n,o,h),!q(f))return d=e,p=f.x,g=f.y,m=f.width,b=f.height,y=i,C=a,w=s,v=V,S=h,d.save(),d.beginPath(),x=y.useButtonStyle,T=w.sheet.zoom(),p+=A=x?re*T:0,g+=A,m-=2*A,b-=2*A,(k=X)&&d.strokeStyle!==k&&(d.strokeStyle=k),x&&d.strokeRect(p+.5,g+.5,m-1,b-1),y.buttonBackColor?M=y.buttonBackColor:x?M=!1===y.enabled?Q:2===v?J:3===v||w.visualState===z.VisualState.hover?$:((I=d.createLinearGradient(p+m/2,g,p+m/2,g+b)).addColorStop(.125,"#F6FAFB"),I.addColorStop(1,"#D2DBEB"),I):(M="white",3===v&&(y.enabled||q(y.enabled))&&(M=$)),(E=C.font)&&d.font!==E&&(d.font=E),d.fillStyle!==M&&(d.fillStyle=M),p+=1,g+=1,m-=2,b-=2,d.rect(p,g,m,b),d.clip(),d.beginPath(),d.fillRect(p,g,m,b),R=new z.Rect(p,g,m,b),D=new z.Rect(p,g,m,b),N=te*T,F=de(y),y.caption&&F&&(_=(oe.cp(Y,y.caption,C,T,w)+2*re)*T,P=le(y)*T,L=new z.Rect(0,0,_+P+N,b),O=new z.Rect(p,g,m,b),B=se(O,L,ae.MiddleCenter),y.captionAlign===z.CaptionAlignment.left?(D=new z.Rect(B.x,g,_,b),R=B.x+_+N<p+m-2?new z.Rect(B.x+_+N,g,Math.max(0,P),b):new z.Rect(0,0,0,0)):(R=new z.Rect(B.x,g,Math.min(P,m),b),D=B.x+P+N<p+m-2?new z.Rect(B.x+P+N,g,Math.min(m-2-P-N,_),b):new z.Rect(0,0,0,0))),y.caption&&(j=(oe.cp(Y,y.caption,C,T,w)+2*re)*T,H=(oe.ep(Y,y.caption,C,T,w)+2*re)*T,G=new z.Rect(0,0,j,H),U=se(D,G,ae.MiddleCenter),W=new ne,C=C.clone(),!1===y.enabled&&(C.foreColor=ee),C.cellButtons=Z,W.paintValue(d,y.caption,U.x,U.y-2,U.width,U.height,C,w)),F&&function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b,y,C,w;e.save(),e.rect(r+2,n+2,o-4,i-4),e.clip(),e.beginPath(),(u=s.sheet.vu()).ko(a)?u.bgc(a)&&(c=s.sheet.zoom(),h=new z.Rect(r,n,o,i),f=le(t)-2,d=function(e){var t;return e.imageSize&&("string"==typeof e.imageSize.height&&(t=K(e.imageSize.height)),"number"==typeof e.imageSize.height&&(t=e.imageSize.height)),(t===Y||isNaN(t)||t<0)&&(t=16),t}(t)-2,p=new z.Rect(0,0,f*c,d*c),g=se(h,p,ae.MiddleCenter),m=u.lo(a),b=m.width,y=m.height,z.Ul.Ml.msie&&t.imageType&&(y=t.imageType===z.ButtonImageType.custom?(ie[a]||(m.style.position="absolute",m.style.left="-10000px",m.style.top="-100000px",document.body.appendChild(m),ie[a]={width:m.width,height:m.height},document.body.removeChild(m)),b=ie[a].width,ie[a].height):b=12),l&&z.Ul.Ml.msie&&g.x+g.width>l.x+l.width?0<(C=l.x+l.width-g.x)&&(w=b/(f*c),e.drawImage(m,0,0,C*w,y,g.x,g.y,C,d*c)):e.drawImage(m,0,0,b,y,g.x,g.y,f*c,d*c)):u.fo(a),e.restore()}(d,y,R.x,R.y,R.width,R.height,F,w,S),d.restore(),u[c]=new z.Rect(f.x,f.y,f.width,f.height),u[c]}function R(e,t,r,n){var o,i,a,s,l;return void 0===n&&(n=!0),o=r.sheet.zoom(),i=2*re+3,q(e.width)?(a=oe.cp(Y,e.caption,t,o,r),s=e.useButtonStyle,de(e)&&(a=le(e)+a,i=(s?i:0)+te),n?(a+i+7)*o:a+i+7):(l=f(1,e.width),isNaN(l)&&(l=1),n?l*o:l)}function H(e,t,r,n,o,i){var a,s,l,u,c=[];if(!t||0===t.length)return[];for(a=!1,s=e._modelManager.getValueForKey(r,n,h),e.getActiveRowIndex()===r&&e.getActiveColumnIndex()===n&&!0!==s&&(a=!0),l=0;l<t.length;l++)for(u=0;u<i.length;u++)(t[l].position===i[u]||q(t[l].position)&&i[u]===z.ButtonPosition.right)&&(t[l].visibility===z.ButtonVisibility.onEditing&&o||t[l].visibility!==z.ButtonVisibility.onEditing&&a||t[l].visibility===z.ButtonVisibility.always||q(t[l].visibility))&&c.push({index:l,button:t[l]});return c}function le(e){var t;return e.imageSize&&("string"==typeof e.imageSize.width&&(t=K(e.imageSize.width)),"number"==typeof e.imageSize.width&&(t=e.imageSize.width)),(t===Y||isNaN(t)||t<0)&&(t=16),t}function G(e,t,r,n,o){var i,a,s,l,u,c={isMouseDownReservedLocation:!1};return n===z.SheetArea.corner?c:((i=e._modelManager.getValueForKey(t,r,d,n))||o||(a=t,s=r,l=n,u=i=c,e._modelManager.setValueForKey(a,s,d,u,l)),i)}function U(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w;if(void 0===t&&(t=!1),r=e.context.row,n=e.context.col,o=e.cellRect,i=e.cellStyle,a=e.context,l=(s={x:e.x,y:e.y,row:r,col:n,cellRect:o,cellStyle:i,sheetArea:e.context.sheetArea,sheet:e.context.sheet,context:a}).sheet,!1!==e.cellStyle.locked&&l.options.isProtected)return null;if(u=G(l,s.row,s.col,s.sheetArea,!0),c=e.cellStyle.cellButtons,!u||!c||c.length<=0)return null;if(h=u.layout,t&&(h=u.editorLayout[e.buttonArea]),!h)return null;for(g in f=-1,d=s.x,p=s.y,h)if(h.hasOwnProperty(g)&&h[g].contains(d,p)){f=+g;break}return-1!==f?s.cellButtonHitInfo={hitButtonIndex:f,buttonConfig:c[f],buttonArea:e.buttonArea}:(m=l.getCellType(s.row,s.col))&&(b=M(H(l,c,r,n,t,[z.ButtonPosition.left]),h,i,a),y=M(H(l,c,r,n,t,[z.ButtonPosition.right]),h,i,a),C=new z.Rect(o.x+b.width,o.y,o.width-b.width-y.width,o.height),(w=m.getHitInfo(s.x,s.y,i,C,a))&&w.isReservedLocation&&(s.isReservedLocation=!0)),s}function W(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m;return void 0===t&&(t=!1),e&&e.cellButtonHitInfo&&(n=e.sheet,o=e.row,i=e.col,a=e.sheetArea,(o===n.Jl&&i===n.Kl||a!==z.SheetArea.viewport||n.endEdit())&&(s=G(n,o,i,e.sheetArea),e.cellButtonHitInfo&&(u=e.cellButtonHitInfo.hitButtonIndex,l=e.cellButtonHitInfo.buttonConfig),n&&!s.isMouseDownReservedLocation&&l&&(l.enabled||q(l.enabled))&&0<=u&&(s.buttonDownIndex=u,s.isMouseDownReservedLocation=!0,0<=u&&l.command&&(c=l.command,t||n.getActiveRowIndex()===o&&n.getActiveColumnIndex()===i||n.DJ(o,i,1,1,2),"string"==typeof c?n.getParent().commandManager().execute({cmd:c,row:o,col:i,sheetName:n.name(),sheetArea:e.sheetArea}):"function"==typeof c&&c.call(Y,n,o,i,e.sheetArea)),t&&r?(h=e.cellStyle,f=s.layout,d=e.context,p=s.editorLayout,g=e.cellButtonHitInfo&&e.cellButtonHitInfo.buttonArea,m=h.cellButtons,g&&j(r,H(n,m,o,i,!0,[T(g)]),g,d,h,s,f,p)):n.repaint(e.cellRect),1)))}function V(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p;if(void 0===t&&(t=!1),e){if(n=e&&e.sheet,o=e.row,i=e.col,(a=G(n,e.row,e.col,e.sheetArea)).isMouseDownReservedLocation&&n){if(t&&0<=a.buttonDownIndex&&r&&(a.buttonDownIndex=-1,s=e.cellStyle,l=a.layout,u=e.context,c=a.editorLayout,h=e.cellButtonHitInfo&&e.cellButtonHitInfo.buttonArea,f=s.cellButtons,h&&j(r,H(n,f,o,i,!0,[T(h)]),h,u,s,a,l,c)),a.buttonDownIndex=-1,t||n.repaint(e.cellRect),a.isMouseDownReservedLocation=!1,d=e.sheetArea,!n._modelManager.getValueForKey(o,i,w,d))return m=o,b=i,y=d,(C=(g=n).parent)&&C.tw(g,m,b,y),n._modelManager.do("setValueForKey",o,i,w,!0,d),p=setTimeout(function(){k(n,o,i,d)},250),n._modelManager.do("setValueForKey",o,i,S,p,d),1;k(n,o,i,d)}}else var g,m,b,y,C}function ue(e,t,r){var n,o,i,a,s,l,u,c,h,f;return void 0===t&&(t=!1),e&&(o=G(n=e&&e.sheet,e.row,e.col,e.sheetArea),i=-1,e.cellButtonHitInfo&&(i=e.cellButtonHitInfo.hitButtonIndex),i!==o.buttonHoverIndex&&(o.buttonHoverIndex=i,t?(a=e.cellStyle,s=o.layout,l=e.context,u=o.editorLayout,c=a.cellButtons,h=e.row,f=e.col,r&&he(c,n,h,f,r.parentElement,l,a,o,s,u)):n.repaint(e.cellRect),1))}function ce(e,t,r){var n,o,i,a,s,l,u,c,h;void 0===t&&(t=!1),e&&e.cellButtonHitInfo&&(o=G(n=e&&e.sheet,e.row,e.col,e.sheetArea),t?(o.buttonHoverIndex=-1,0<=e.cellButtonHitInfo.hitButtonIndex&&(i=e.cellStyle,a=o.layout,s=e.context,l=o.editorLayout,u=i.cellButtons,c=e.row,h=e.col,r&&he(u,n,c,h,r.parentElement,s,i,o,a,l))):(n&&(o.buttonHoverIndex=-1),n.repaint(e.cellRect)))}function he(e,t,r,n,o,i,a,s,l,u){var c,h;for(c=0;c<g.length;c++)h=A(g[c]),j(o.querySelector("."+m(h)),H(t,e,r,n,!0,[T(h)]),h,i,a,s,l,u)}function fe(e){var t=e.clone();return t.hAlign=z.HorizontalAlign.left,t.vAlign=z.VerticalAlign.center,t.wordWrap=!1,t.isVerticalText=!1,t.shrinkToFit=!1,t.formatter="General",t.textIndent=0,t}function c(e,t,r,n,o){var i,a=e.AHb(t,r,o);if(a&&a.cellButtons&&0<a.cellButtons.length&&0<a.cellButtons.filter(function(e){return 1===e.visibility}).length){n&&e._modelManager.do("setValueForKey",t,r,h,!0,o);try{i=e.getCellRect(t,r,1===o?-1:void 0,2===o?-1:void 0),e.repaint(i)}finally{n&&e._modelManager.do("setValueForKey",t,r,h,Z,o)}}}function de(e){var t,r=null,n=e.imageType;if(q(e.imageType))return null;switch(t=e.enabled||q(e.enabled),n){case z.ButtonImageType.dropdown:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case z.ButtonImageType.left:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case z.ButtonImageType.right:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case z.ButtonImageType.clear:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case z.ButtonImageType.ok:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case z.ButtonImageType.plus:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case z.ButtonImageType.minus:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case z.ButtonImageType.redo:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case z.ButtonImageType.undo:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case z.ButtonImageType.search:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case z.ButtonImageType.separator:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case z.ButtonImageType.spinLeft:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case z.ButtonImageType.spinRight:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case z.ButtonImageType.ellipsis:r=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case z.ButtonImageType.expand:r=t?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case z.ButtonImageType.collapse:r=t?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case z.ButtonImageType.custom:r=e.imageSrc}return r}Object.defineProperty(t,"__esModule",{value:!0}),z=r("Core"),n=r("@grapecity/js-sheets-common"),q=n.Common.j.Fa,z.To.No,z.Ul.fp,v=z.En.npb,Z=void 0,Y=null,f=Math.max,K=parseInt,X="#707070",J="#34B4E3",Q="#e6e6e6",$="lightgray",ee="#CACACA",w="_isFirstMouseUp",S="_mouseupToken",h="_leaveCell",te=0,re=2,ne=z.CellTypes.Base,oe=z.CellTypes.Context,x="gc-cell-button-canvas",D=(o="gc-editor-")+"left-cellbuttons",N=o+"right-cellbuttons",F=o+"left-of-text-cellbuttons",_=o+"right-of-text-cellbuttons",P="leftButtonArea",L="rightButtonArea",O="leftOfTextButtonArea",B="rightOfTextButtonArea",d="_cellButtonParam",ie={},z.GC$,g=[z.ButtonPosition.left,z.ButtonPosition.right,z.ButtonPosition.leftOfText,z.ButtonPosition.rightOfText],(a=ae=ae||{})[a.topLeft=0]="topLeft",a[a.topCenter=1]="topCenter",a[a.topRight=2]="topRight",a[a.MiddleLeft=3]="MiddleLeft",a[a.MiddleCenter=4]="MiddleCenter",a[a.MiddleRight=5]="MiddleRight",a[a.bottomLeft=6]="bottomLeft",a[a.bottomCenter=7]="bottomCenter",a[a.bottomRight=8]="bottomRight",z.CellTypes.Base.$n("cellButton",{beforePaintLabel:function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y=e.options.context,C=e.options.style;if(!y.cellOverflowLayout&&C.cellButtons&&0<C.cellButtons.length&&(t=e.options.context.sheet,r=y.row,n=y.col,(o=H(t,C.cellButtons,r,n,!1,[z.ButtonPosition.left,z.ButtonPosition.right]))&&0<o.length)){if(i=fe(C),I(o,t),!(a=e.ctx))return;for(s=e.options.rect,a.save(),a.rect(s.x,s.y,s.width,s.height),a.clip(),a.beginPath(),l=s.x,u=s.x+s.width,c=G(t,y.row,y.col,y.sheetArea),q(c.layout)&&(c.layout={}),h=c.layout,f=H(t,C.cellButtons,r,n,!1,[z.ButtonPosition.left]),d=0;d<f.length&&(p=E(a,l,s.y,R(f[d].button,i,y),s.height,f[d].button,i,y,c,h,f[d].index,s),!q(p));d++)l+=p.width;for(g=l,l=u,d=(m=H(t,C.cellButtons,r,n,!1,[z.ButtonPosition.right])).length-1;0<=d&&(p=E(a,l-=b=R(m[d].button,i,y),s.y,b,s.height,m[d].button,i,y,c,h,m[d].index,s),!q(p));d--);a.restore(),s.x=g,s.width=l-g}},beforePaintText:function(e){var t,r,n,o,i=e.context,a=e.style;!i.cellOverflowLayout&&a.cellButtons&&0<a.cellButtons.length&&(t=e.context.sheet,r=i.row,n=i.col,(o=e.externals).left=o.left.concat(s(H(t,a.cellButtons,r,n,!1,[z.ButtonPosition.leftOfText]),a,i)),o.right=o.right.concat(s(H(t,a.cellButtons,r,n,!1,[z.ButtonPosition.rightOfText]),a,i)))},beforeFillTextArea:function(e){var t,r,n,o,i=e.style,a=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(t=e.ctx,r=e.availRect,n=e.textRect,u(t,H((o=e.context).sheet,a,o.row,o.col,!1,[z.ButtonPosition.leftOfText]),r,n,i,o,!0))},afterFillTextArea:function(e){var t,r,n,o,i=e.style,a=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(t=e.ctx,r=e.availRect,n=e.textRect,u(t,H((o=e.context).sheet,a,o.row,o.col,!1,[z.ButtonPosition.rightOfText]),r,n,i,o,!1))},onCreateCellEditor:function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p=e.options.dom;if(p&&p.children&&((t=p.children[0])&&t.children&&t.children[0])){if(n=(r=e.context).sheet,o=r.row,i=r.col,a=e.options.cellStyle,q(a)&&(a=n.getActualStyle(o,i)),s=a.cellButtons,q(s)||s&&s.length<=0)return;for(l=e.options.cellRect,u=new z.Rect(l.x,l.y,l.width,l.height),c=G(n,o,i,r.sheetArea),q(c.layout)&&(c.layout={}),h=c.layout,f=!1,d=0;d<s.length;d++)s[d].position!==z.ButtonPosition.leftOfText&&s[d].position!==z.ButtonPosition.rightOfText||(f=!0);for(f&&(t.style.overflow="hidden"),d=0;d<g.length;d++)b(g[d],n,s,r,a,u,o,i,c,h,p)}},onActivateCellEditor:function(e){var t,r,n,o,i,a,s=e.context,l=s.sheet,u=s.row,c=s.col,h=e.options.cellStyle,f=h.cellButtons;if(!(q(f)||f.length<=0))for(t=G(l,u,c,s.sheetArea),q(t.editorLayout)&&(t.editorLayout={}),r=t.layout,n=t.editorLayout,o=fe(h),i=e.options.dom,a=0;a<g.length;a++)y(g[a],l,f,s,o,e,u,c,t,r,n,i)},onDeactivateCellEditor:function(e){var t,r,n,o,i,a,s,l,u=e.context,c=u.sheet,h=u.row,f=u.col,d=c.getActualStyle(h,f,u.sheetArea).cellButtons;if(d&&0<d.length)for(r=(t=G(u.sheet,h,f,u.sheetArea)).eventListeners,n=e.options.dom.querySelectorAll("."+x),o=0;o<n.length;o++)a=p((i=n[o]).className),q(a)||q(r)||q(r[a])||(s=i,l=r[a],q(l.mouseDownListener)||s.removeEventListener("mousedown",l.mouseDownListener),q(l.mouseUpListener)||s.removeEventListener("mouseup",l.mouseUpListener),q(l.mouseMoveListener)||s.removeEventListener("mousemove",l.mouseMoveListener),q(l.mouseLeaveListener)||s.removeEventListener("mouseleave",l.mouseLeaveListener),delete t.eventListeners[a])},onUpdateContainer:function(e){var t,r=e.context,n=r.sheet,o=r.row,i=r.col,a=G(r.sheet,o,i,r.sheetArea).canvasSizes,s=e.cellStyle.cellButtons;if(!(q(s)||s.length<=0))for(e.context.preventOverflow=!0,t=0;t<g.length;t++)l(g[t],n,s,o,i,a,e)},getCellButtonHitInfo:function(e){e.paddingHitInfo=U(e)},processMouseDownOnCellPadding:function(e){W(e)},processMouseUpOnCellPadding:function(e){V(e)},processMouseMoveOnCellPadding:function(e){ue(e)},processMouseLeaveOnCellPadding:function(e){ce(e)},getCellButtonAutoHeight:function(r){var e,n,o=r.context.sheet,t=r.context.row,i=r.context.col,a=r.cellStyle;a.cellButtons&&0!==a.cellButtons.length&&(e=H(o,a.cellButtons,t,i,!1,[z.ButtonPosition.left,z.ButtonPosition.right]),n=0,e.forEach(function(e){var t=oe.ep(Y,e.button.caption,a,o.zoom(),r.context)-2;de(e.button)&&(t=f(t,le(e.button))),n=f(t,n)}),r.value=n+ +re)},getCellButtonAutoWidth:function(t){var e,r,n=t.context.sheet,o=t.context.row,i=t.context.col,a=t.cellStyle;a.cellButtons&&0!==a.cellButtons.length&&(e=H(n,a.cellButtons,o,i,!1,[z.ButtonPosition.left,z.ButtonPosition.right]),r=0,e.forEach(function(e){r+=R(e.button,a,t.context,!1)}),t.value=r)}}),i="cellButtons",z.Worksheet.$n(i,{setHost:function(){var r=this;r.bind(z.Events.EnterCell+"."+i,function(e,t){c(r,t.row,t.col,!1,t.sheetArea)}),r.bind(z.Events.LeaveCell+"."+i,function(e,t){c(r,t.row,t.col,!0,t.sheetArea)}),r.bind(z.Events.TopRowChanged+"."+i,function(e,t){c(r,t.row,t.col,!0,t.sheetArea)})},dispose:function(e){this.unbind(z.Events.EnterCell+"."+i),this.unbind(z.Events.LeaveCell+"."+i),this.unbind(z.Events.TopRowChanged+"."+i)},processMouseDown:function(e){var t=e.hitInfo.cellTypeHitInfo;t&&t.cellButtonHitInfo&&W(t)&&(e.r=!0)}})},"./dist/plugins/celltype/celltypes.entry.js":function(e,r,t){"use strict";var n,o,i,a,s;function l(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),o=(n=t("Core")).CellTypes.Base,i=n.CellTypes.Context,a=n.CellTypes.EditorType,s=n.CellTypes._o,r.Base=o,r.Context=i,r.EditorType=a,r._o=s,r.vHb=n.CellTypes.vHb,r.wHb=n.CellTypes.wHb,Object.defineProperty(r,"Corner",{set:function(e){e!==r.vHb.Corner&&(r.vHb.Corner=e)},get:function(){return r.vHb.Corner}}),Object.defineProperty(r,"ColumnHeader",{set:function(e){e!==r.vHb.ColumnHeader&&(r.vHb.ColumnHeader=e)},get:function(){return r.vHb.ColumnHeader}}),Object.defineProperty(r,"RowHeader",{set:function(e){e!==r.vHb.RowHeader&&(r.vHb.RowHeader=e)},get:function(){return r.vHb.RowHeader}}),Object.defineProperty(r,"Text",{set:function(e){e!==r.wHb.Text&&(r.wHb.Text=e)},get:function(){return r.wHb.Text}}),l(t("./dist/plugins/celltype/checkboxcelltype.js")),l(t("./dist/plugins/celltype/buttoncelltype.js")),l(t("./dist/plugins/celltype/hyperlinkcelltype.js")),l(t("./dist/plugins/celltype/comboboxcelltype.js")),t("./dist/plugins/celltype/cellbuttons.js"),l(t("./dist/plugins/celltype/editor/colorpicker.js")),l(t("./dist/plugins/celltype/editor/timepicker.js")),l(t("./dist/plugins/celltype/editor/calendar.js")),l(t("./dist/plugins/celltype/editor/calculator.js")),l(t("./dist/plugins/celltype/editor/monthPicker.js")),l(t("./dist/plugins/celltype/editor/listControl.js")),l(t("./dist/plugins/celltype/dropdown-action.js")),l(t("./dist/plugins/celltype/radiochecklistcelltype.js")),l(t("./dist/plugins/celltype/celltypes.ns.js")),l(t("./dist/plugins/celltype/rangecelltype.js"))},"./dist/plugins/celltype/celltypes.ns.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./dist/plugins/celltype/celltypes.res.en.js");t.SR={en:n}},"./dist/plugins/celltype/celltypes.res.en.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OK="OK",t.Cancel="Cancel",t.Calendar_ShortWeeks_1="MON",t.Calendar_ShortWeeks_2="TUE",t.Calendar_ShortWeeks_3="WED",t.Calendar_ShortWeeks_4="THU",t.Calendar_ShortWeeks_5="FRI",t.Calendar_ShortWeeks_6="SAT",t.Calendar_ShortWeeks_7="SUN",t.Calendar_Weeks_1="Monday",t.Calendar_Weeks_2="Tuesday",t.Calendar_Weeks_3="Wednesday",t.Calendar_Weeks_4="Thursday",t.Calendar_Weeks_5="Friday",t.Calendar_Weeks_6="Saturday",t.Calendar_Weeks_7="Sunday",t.Calendar_ShortMonths_1="JAN",t.Calendar_ShortMonths_2="FEB",t.Calendar_ShortMonths_3="MAR",t.Calendar_ShortMonths_4="APR",t.Calendar_ShortMonths_5="MAY",t.Calendar_ShortMonths_6="JUN",t.Calendar_ShortMonths_7="JUL",t.Calendar_ShortMonths_8="AUG",t.Calendar_ShortMonths_9="SEP",t.Calendar_ShortMonths_10="OCT",t.Calendar_ShortMonths_11="NOV",t.Calendar_ShortMonths_12="DEC",t.Calendar_Months_1="JANUARY",t.Calendar_Months_2="FEBRUARY",t.Calendar_Months_3="MARCH",t.Calendar_Months_4="APRIL",t.Calendar_Months_5="MAY",t.Calendar_Months_6="JUNE",t.Calendar_Months_7="JULY",t.Calendar_Months_8="AUGUST",t.Calendar_Months_9="SEPTEMBER",t.Calendar_Months_10="OCTOBER",t.Calendar_Months_11="NOVEMBER",t.Calendar_Months_12="DECEMBER",t.Calendar_Time_AM="AM",t.Calendar_Time_PM="PM",t.Calendar_EraName_1="M",t.Calendar_EraName_2="T",t.Calendar_EraName_3="S",t.Calendar_EraName_4="H",t.Calendar_FirstYear="1",t.Calendar_Today="Today",t.Calendar_LastMonth="Go to previous month",t.Calendar_NextMonth="Go to next month",t.Calendar_LastYear="Go to previous year",t.Calendar_NextYear="Go to next year",t.Calendar_LastTenYear="Go to previous ten years",t.Calendar_NextTenYear="Go to next ten years",t.Quarter_Format_1="Q1",t.Quarter_Format_2="Q2",t.Quarter_Format_3="Q3",t.Quarter_Format_4="Q4",t.ThemeColor="Theme Colors",t.StandardColor="Standard Colors",t.Calculator_DivideByZeroInfo="Cannot divide by zero.",t.Calculator_InvalidInputInfo="Invalid Input.",t.Calculator_SqrtParameterException="Invalid input for function.",t.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",t.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array."},"./dist/plugins/celltype/checkboxcelltype.js":function(e,t,r){"use strict";var n,M,l,I,N,s,u,o,F,i,_,a,c,E,P,R,h,f,d,L,p,g,m,b,y,C=this&&this.__extends||(m=function(e,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function w(e,t,r,n){var o,i=e._modelManager;i&&(i.do("setValueForKey",t,r,f,a,n),(o=i.getValueForKey(t,r,d,n))&&(clearTimeout(o),i.do("setValueForKey",t,r,d,a,n)))}function v(){var r,e=b.call(this)||this;return e.typeName="5",r=e,i(p,function(e,t){r["_"+e]=t}),e}function O(e,t,r,n,o){var i=5*o,a=t.hAlign,s=r.x-1,l=r.width+1,u=0,c=0;return 0===e||1===e?(c=s+i,1===a?c=s+l/2-L/2:2===a&&(c=s+l-i-L)):2===e?(u=L+n,c=s+i+n,1===a?c=s+l/2-u/2+n:2===a&&(c=s+l-i-u+n)):(u=L+n,c=s+i,1===a?c=s+l/2-u/2:2===a&&(c=s+l-i-u)),c-s}function B(e,t,r,n,o){var i=5*o,a=t.vAlign,s=r.y-1,l=r.height+1,u=0,c=0;return 0===e?(u=L+n,c=s+i+n,1===a?c=s+l/2-u/2+n:2===a&&(c=s+l-i-u+n)):1===e?(u=L+n,c=s+i,1===a?c=s+l/2-u/2:2===a&&(c=s+l-i-u)):(c=s+i,1===a?c=s+l/2-L/2:2===a&&(c=s+l-i-L)),c-s}function S(e,t,r,n,o){var i=t.getValue(r,n,o),a=e.rK(i),s={cmd:"editCell",sheetName:t.name(),row:r,col:n,newValue:a,autoFormat:!0};t.wu().execute(s),e.tw(t,r,n,o)}function x(e,t,r,n,o){var i=o&&o.sheet,a=e.getEditorValue(t,o);e.setEditorValue(t,a,o),e.updateEditor(t,r,n,o),e.tw(i,i.Jl,i.Kl,o.sheetArea)}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),M=r("Core"),l=M.Ul.Nl,I=n.Common.j.Fa,N=M.Ul.fp,s=M.Ul.nl,u=M.CellTypes.Context,o=M.CellTypes.Base,F=M.GC$,i=F.each,_=M.Ul.hZa,a=void 0,c=Math.max,E=parseInt,P="left",R="alphabetic",h=".gcEditingInput",f="_isFirstMouseUp",d="_mouseupToken",(y=t.CheckBoxTextAlign||(t.CheckBoxTextAlign={}))[y.top=0]="top",y[y.bottom=1]="bottom",y[y.left=2]="left",y[y.right=3]="right",p={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!(L=12)},C(v,b=o),v.prototype.paintValue=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k;e&&(e.save(),e.rect(r,n,o,i),e.clip(),e.beginPath(),l=a.hAlign,u=a.font,c=a.foreColor,h=this._textAlign,f=this.getText(t,s),p=d=0,(g=s.sheet)&&(d=g.dp(f,u),p=N(u),f&&(p*=f.split(/\r\n|\r|\n/).length)),m=g.zoom(),++r,++n,--o,--i,b=L/2,y=new M.Rect(r,n,o,i),C=E(""+(r+O(h,a,y,d,m))),w=E(""+(n+B(h,a,y,p,m))),v=P,S=C+1,1===l?(v="center",S+=b):2===l&&(v="right",S+=2*b),u&&e.font!==u&&M.Ul.lZa(e,u),c&&(e.fillStyle=c),x=a.textDecoration,k=p/2-(T=parseInt(s.fontInfo.fontSize,10))/2+(A=8<T?Math.floor((T-8)/5+2):1)-1,e.textBaseline!==R&&(e.textBaseline=R),2===h?(e.textAlign="right",e.fillText(f,C+1-2,w+b+p/2-k),x&&this.ip(e,x,C+1-2,w+b+p/2-k,d,T,A)):0===h&&(e.textAlign=v,e.fillText(f,S,w-2-k),x&&this.ip(e,x,S,w-2-k,d,p)),e.save(),e.strokeStyle="black",e.strokeRect(C+.5,w+.5,2*b+.05,2*b+.05),e.fillStyle="white",e.fillRect(C+1,w+1,2*b-1,2*b-1),this._isThreeState&&I(t)?(e.beginPath(),e.fillStyle="green",e.rect(C+3,w+3,2*(b-2.5),2*(b-2.5)),e.fill()):1==!!t&&(e.beginPath(),e.lineWidth=2.5,e.moveTo(C+3,w+b),e.lineTo(C+b,w+2*b-3.5),e.lineTo(C+2*b-1.5,w+3),e.stroke()),e.restore(),c&&(e.fillStyle=c),3===h?(e.textAlign=P,e.fillText(f,C+1+2*b+2,w+b+p/2-k),x&&this.ip(e,x,C+1+2*b+2,w+b+p/2-k,d,T,A)):1===h&&(e.textAlign=v,e.fillText(f,S,w+2*b+2+p-k),x&&this.ip(e,x,S,w+2*b+2+p-k,d,T,A)),e.restore())},v.prototype.getText=function(e,t){return this.sK(e)},v.prototype.focus=function(e,t){e&&e.parentNode.focus()},v.prototype.createEditorElement=function(e,t){var r,n,o,i,a=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,s=M.Ul.vl(a)+1e3;return F(t).css("z-index",s).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(r=F(t.firstChild)).css("overflow","hidden"),(n=F(l("input"))).attr("type","checkbox"),n.attr("class","gc-checkbox-cell-type-input"),r.append(n),(o=F(l("span"))).css("position","absolute").css("font",_("normal 11pt calibri")).css("cursor","default").css("white-space","nowrap"),r.append(o),(i=F(l("div"))).css("position","absolute").css("background-color","green").css("width",2*(L/2-2.5)).css("height",2*(L/2-2.5)),r.append(i),null},v.prototype.rK=function(e){return this._isThreeState?!I(e)&&(1!=!!e||null):!e},v.prototype.setEditorValue=function(e,t,r){var n,o,i,a,s,l,u;e&&(o=(n=e.parentNode.children)[0],i=n[1],a=n[2],o&&i&&a&&(u=l=void 0,(s=r&&r.sheet)&&s.HF||(u=this.rK(t)),this._isThreeState?I(u)?(l=!1,F(a).show()):(l=!!u,F(a).hide()):l=!!u,o.checked=l,F(i).text(this.sK(u))))},v.prototype.getEditorValue=function(e,t){if(e){var r=e.parentNode.children,n=r[0],o=r[1],i=r[2];if(n&&o&&i&&(!this._isThreeState||!F(i).isVisible()))return n.checked}return null},v.prototype.tw=function(e,t,r,n){var o=e.parent;o&&o.tw(e,t,r,n)},v.prototype.activateEditor=function(t,r,n,o){var e,i,a=o&&o.sheet;t&&a&&(e=F(t.parentNode.parentNode),i=this,e.bind("mousedown"+h,function(e){s(e)}),e.bind("mouseup"+h,function(){x(i,t,r,n,o)}),e.bind("keydown"+h,function(e){var t=e.keyCode;if(!e.ctrlKey&&!e.shiftKey&&!e.altKey){if(32===t)return i.tK=!0,s(e),!1;8===t&&s(e)}}),e.bind("keyup"+h,function(e){!i.tK||32!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey||(i.tK=!1,x(i,t,r,n,o))}),F(t).bind("click",function(e){s(e)}))},v.prototype.updateEditor=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D=n&&n.sheet;e&&D&&(o=D._render,s=(a=(i=e.parentNode).children)[0],l=a[1],u=a[2],s&&l&&u&&(F(i).width(r.width).height(r.height),h=(c=F(l)).text(),f=t.foreColor,d=t.font,p=t.hAlign,g=t.textDecoration,f&&c.css("color",f),m=void 0,m=d||o.Bl(),1<(b=D.zoom())&&(m=o.Cl(m)),c.css("font",_(m)),y=D.rt(h,m),C=N(m),h&&(C*=h.split(/\r\n|\r|\n/).length),v=O(w=this._textAlign,t,r,y,b),S=B(w,t,r,C,b),F(s).css("margin-left",v).css("margin-top",S),x=s.offsetLeft,T=s.offsetTop,A=s.offsetWidth,k=s.offsetHeight,I=(I=M=0)===w?(M=x,1===p?M=x+L/2-y/2:2===p&&(M=x+L-y),T-C):1===w?(M=x,1===p?M=x+L/2-y/2:2===p&&(M=x+L-y),T+k):(M=2===w?x-y-2:x+A+2,T+L/2-C/2),c.css(P,M).css("top",I),this._isThreeState?(E=x+(A-u.offsetWidth)/2,R=T+(k-u.offsetHeight)/2,F(u).css(P,E).css("top",R).toggle().toggle()):F(u).hide(),g&&this.lp(c,g)))},v.prototype.sK=function(e){var t=this._caption;return this._isThreeState&&I(e)?this._textIndeterminate||t:1==!!e?this._textTrue||t:this._textFalse||t},v.prototype.getHitInfo=function(e,t,r,n,o){if(o){var i=o.sheetArea;if(I(i)||3===i)return{x:e,y:t,row:o.row,col:o.col,cellRect:n,sheetArea:3,isReservedLocation:!0,sheet:o.sheet,cellStyle:r}}return null},v.prototype.processMouseDown=function(e){return!!e&&void(e.isReservedLocation&&(this.uK=!0))},v.prototype.processMouseUp=function(e){var t,r,n,o,i=e&&e.sheet;if(i&&this.uK&&e.isReservedLocation){if(this.uK=!1,t=e.row,r=e.col,n=e.sheetArea,!i._modelManager.getValueForKey(t,r,f,n))return S(this,i,t,r,n),i._modelManager.do("setValueForKey",t,r,f,!0,n),o=setTimeout(function(){w(i,t,r,n)},250),i._modelManager.do("setValueForKey",t,r,d,o,n),!0;w(i,t,r,n)}return!1},v.prototype.processMouseLeave=function(e){return!!e&&void(this.uK=!1)},v.prototype.isReservedKey=function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},v.prototype.processKeyUp=function(e,t){return S(this,t.sheet,t.row,t.col,t.sheetArea),!0},v.prototype.getAutoFitWidth=function(e,t,r,n,o){var i=this._textAlign,a=u.cp(e,this.sK(e),r,n,o);return 0===i||1===i?a=c(a,L):a+=L,a+5+2},v.prototype.getAutoFitHeight=function(e,t,r,n,o){var i=this._textAlign,a=u.ep(e,this.sK(e),r,n,o);return 0===i||1===i?a+=L:a=c(a,L),a+5},v.prototype.JH=function(e){this.isReservedKey(e)&&s(e)},v.prototype.isImeAware=function(e){return!1},v.prototype.gQa=function(){},v.prototype.toJSON=function(){var r,n=this,o={typeName:n.typeName};return i(p,function(e,t){(r=n["_"+e])!==t&&(o[e]=r)}),o},v.prototype.fromJSON=function(r){var n=this;i(p,function(e){var t=r[e];I(t)||(n["_"+e]=t)})},g=v,t.CheckBox=g,i(p,function(t){g.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}}),M.CellTypes._o[5]=g},"./dist/plugins/celltype/comboboxcelltype.js":function(e,t,r){"use strict";var n,C,u,b,y,f,s,w,i,o,v,h,S,x,l,T,A,k,M,a,I,E,c,R,D,N,F,_,P,L,O,B,d,j,H,G,p,U,W,g,m,V,z,q,Z,Y,K,X,J,Q=this&&this.__extends||(K=function(e,t){return(K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}K(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function $(e,t){e.appendChild(t)}function ee(e,t){e.removeChild(t)}function te(e){return e&&e.parentNode.parentNode.comboBox}function re(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m=this;s=(m.KK=e).firstChild,w(e).bind(A,function(e){m.LK(e)}).css(["z-index",R,D,P,L,"overflow"],[i||0,t,r,n,o,"visible"]).attr([N],["gcComboBox"]),l=x(0,n-17),m._editable=!1,m.MK=u=b("div"),m.NK=c=b("textarea"),$(s,m.PK=u),ne(u),ne(c),w(c).bind("keyup",function(){var e,t=m.PK.value;m._text=t,e=m.QK(t),m.editorValue(e),m.RK(t),m.SK()}).bind(k,function(){m.TK()}).bind(M,function(){m.SK()}),w(u).bind(T,function(){m.IK?m.Wq(z,{isMouse:!0}):m.UK()}).bind(k,function(){m.TK()}).bind(M,function(){m.SK()}),m.VK(0,0,l,o),$(s,h=m.WK=b("div")),w(h).css([U,I,j,B],[_,E,G,H]).attr(N,"gcDropDownButton").bind(T,function(){var e;!y(m.JK)&&(e=m.JK,m.JK=S,(new Date).valueOf()-e<100)||(m.IK?m.Wq(z,{isMouse:!0}):m.UK())}),f=b("canvas"),m.Xs=f,m.XK(l,0,n-l,o),$(h,f),$(s,d=m.YK=b("div")),m.ZK=!1,p=a||n,w(d).css([I,U,j,"z-index",O,"display","cursor",B,L,"min-width"],[E,"1px solid",G,i||0,_,_,"default",H,o,p+"px"]),w(d).attr(N,"gcDropDownWindow").attr(F,-1),m.$K(0,+o),m._K=0,$(d,g=m.aL=b("div")),m.bL=new C.IB(d,g),m._itemHeight=22,m.cL=20,m.dL=-1,m._editorValueType=0,m._items=[]}function ne(e){w(e).css(["margin","overflow","resize",I,"padding",O,j,"white-space",B,U],[0,"hidden",_,E,m+"px 0px 0px "+g+"px",_,G,"nowrap",H,_]).attr(N,"gcComboBoxEditor").attr(F,-1)}function oe(){var r,e=J.call(this)||this;return e.typeName="7",e.DF=!1,e.GK=!1,r=e,i(q,function(e,t){"items"===e&&(t=[]),r["_"+e]=t}),e}function ie(e){var t,r,n,o,i=["0","0","0","0"];return typeof e===a&&(o=n=void 0,1===(r=(t=e.split(" ",4)).length)?i=[n=t[0],n,n,n]:2===r?i=[n=t[0],o=t[1],n,o]:3===r?(o=t[1],i=[t[0],o,t[2],o]):4===r&&(i=[t[0],t[1],t[2],t[3]])),i}function ae(e,t){return e.hasOwnProperty(t)}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),C=r("Core"),u=C.CellTypes.Base,b=C.Ul.Nl,y=n.Common.j.Fa,f=C.Ul,s=f.nl,w=C.GC$,i=w.each,o=f.hZa,v=f.Fxb,h=document,S=void 0,x=Math.max,l=parseInt,T="click",A="keydown",k="mouseover",M="mouseout",a="string",I="position",E="absolute",c="font",R="left",D="top",N="gcUIElement",F="tabindex",_="none",P="width",L="height",O="outline",B="box-sizing",d="color",j="background-color",H="content-box",G="white",p="text",U="border",W=f.K_a,(X=t.EditorValueType||(t.EditorValueType={}))[X.text=0]="text",X[X.index=1]="index",X[X.value=2]="value",m=g=1,V=g,z="EndEdit.gcEditingInput",q={editorValueType:0,items:null,itemHeight:22,editable:!"#1E90FF",maxDropDownItems:20},re.prototype.getComboBox=function(){return this.KK},re.prototype.dispose=function(){w(this.KK).unbind(A),w(this.NK).unbind("keyup").unbind(k).unbind(M),w(this.MK).unbind(T).unbind(k).unbind(M),w(this.WK).unbind(T),w(this.aL).find("div").forEach(function(e){w(e).unbind(k).unbind(M).unbind(T)}),this.bL.dispose()},re.prototype.updateLocationAndSize=function(e,t,r,n){var o=x(0,r-17);this.VK(0,0,o,n),this.XK(o,0,r-o,n),this.$K(0,+n)},re.prototype.updateStyle=function(e,t,r){r=o(r),e=e||S,w(this.PK).css(j,e).css(d,t).css(c,r),w(this.WK).css(j,e).css(d,t).css(c,r),w(this.YK).css(j,e).css(d,t).css(c,r),w(this.KK).css(j,"transparent")},re.prototype.updateImeMode=function(e){w(this.PK).css("ime-mode",e)},re.prototype.editorValueType=function(e){return 0===arguments.length?this._editorValueType:(this._editorValueType=e,this)},re.prototype.editorValue=function(e){var t;return 0===arguments.length?this.fL:(e!==this.fL&&(this.fL=e,t=this.gL(e),this.text(t),this.RK(t,!0)),this)},re.prototype.gL=function(e){var t,r,n,o,i=this._items,a=i.length,s=this._editorValueType;if(this.HK=!0,1===s)(t=(r=i[e])&&ae(r,p)?r.text:r)===S&&(t=e,this.HK=!1);else if(0===s){for(t=e,o=0;o<a&&!((r=i[o])&&ae(r,p)&&r.text===e||r===e);o++);a<=o&&(this.HK=!1)}else if(2===s){for(n=0;n<a;n++)if((r=i[n])&&ae(r,"value")&&r.value===e){t=r.text;break}a<=n&&(t=e,this.HK=!1)}return y(e)&&(t=""),t},re.prototype.QK=function(e){var t,r,n,o=this._items,i=o.length,a=this._editorValueType,s=e;if(1===a)for(r=0;r<i;r++)((t=o[r])&&ae(t,p)&&t.text===e||t===e)&&(s=r);else if(2===a)for(n=0;n<i;n++)(t=o[n])&&ae(t,p)&&t.text===e?s=t.value:t===e&&(s=S);return s},re.prototype.RK=function(e,t){var r,n,o,i,a;if(e){for(o=(n=this._items).length,r=0;r<o&&(a=ae(i=n[r],p)?i.text:i,(t?a:(""+a).substr(0,e.length))!==e);r++);o<=r&&(r=-1)}else r=-1;this.hL(r)},re.prototype.SK=function(){w(this.PK).removeAttr("title")},re.prototype.TK=function(){var e=this.Xn(this._text),t=w(this.PK);t.width()+g<e?t.attr("title",this._text):t.removeAttr("title")},re.prototype.VK=function(e,t,r,n){r-=0,n-=0,w(this.PK).css(R,e).css(D,t).css(P,r-g).css(L,n-m)},re.prototype.editable=function(e){var t,r,n,o,i,a=this;return 0===arguments.length?a._editable:a._editable!==e?(a._editable=e,t=a.KK.firstChild,r=a.PK,n=w(r),o={left:l(n.css(R)),top:l(n.css(D)),width:l(n.css(P)),height:l(n.css(L))},i={backColor:n.css(j),foreColor:n.css(d),font:r.style.font},ee(t,r),a.PK=e?a.NK:a.MK,$(t,a.PK),w(a.PK).css(j,i.backColor).css(d,i.foreColor).css(c,i.font),a.VK(o.left,o.top,o.width,o.height),a):void 0},re.prototype.text=function(e){var t=this.PK;return 0===arguments.length?this._text:void(e!==this._text&&(this._text=e,this._editable?t.value=e:t.textContent=e))},re.prototype.focus=function(){var e=this.PK;e.focus(),this._editable&&(e.selectionStart=e.value.length)},re.prototype.selectAll=function(){this._editable&&this.PK.select()},re.prototype.XK=function(e,t,r,n){var o,i,a,s;r-=0,n-=0,o=this.Xs,w(this.WK).css(R,e).css(D,t).css(P,r).css(L,n),w(o).attr(P,r).attr(L,n),i=o.width,a=o.height,(s=o.getContext("2d")).beginPath(),s.lineWidth=2,s.fillStyle="black",s.moveTo(i-17+4,(a-2)/2-2.5),s.lineTo(i-17+7,(a-2)/2+3.5),s.lineTo(i-17+10,(a-2)/2-2.5),s.fill()},re.prototype.showDropDownList=function(){var t=this,e=t.bL;t.ZK=!0,w(t.YK).bind(A,function(e){t.LK(e)}).show(),t.iL=!1,t.jL(),this.adjustPosition(),t.iL&&e.lB(w(t.aL.children).height()),e.ew(!1),t.kL("#1E90FF"),t.lL(t.dL),t.focus()},re.prototype.adjustPosition=function(){var e,t,r,n,o,i,a,s,l,u,c=w(this.YK);if(c){if(e=parseInt(c.css("left"),10),t=parseInt(c.css("top"),10),r=c.width(),n=c.height(),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))return;i=o=0,s=(a=h.documentElement).clientWidth,l=a.clientHeight,u=c[0].getBoundingClientRect(),l<n&&(c.css("max-height",Math.round(.8*l)+"px"),n=Math.round(.8*l)),s<r&&(c.css("max-width",Math.round(.8*s)+"px"),r=Math.round(.8*s)),u.left+r>s&&(i=u.left+r-s),u.top+n>l&&(o=u.top+n-l),(e<0||t<0||0<o||0<i)&&(t-=o,(e-=i)<0&&(e-=22),c.css({left:e+"px",top:t+"px"}))}},re.prototype.shiftPadding=function(e,t){var r=this.KK.firstChild;e===R?w(r).css({left:(+w(r).css(R).replace("px","")||0)-t}):e===D&&w(r).css({top:(+w(r).css(D).replace("px","")||0)-t})},re.prototype.closeDropDownList=function(){this.ZK=!1,w(this.YK).unbind(A).hide(),this.kL(""),this.focus()},re.prototype.UK=function(){this.ZK?this.closeDropDownList():this.showDropDownList()},re.prototype.listHeight=function(e){var t=w(this.YK);return 0===arguments.length?t.height():void(0<e&&(t.height(e),this.bL.ew(!1)))},re.prototype.$K=function(e,t){w(this.YK).css(R,e).css(D,t)},re.prototype.items=function(e){var t,r,n,o,i;if(0===arguments.length)return this._items;if(e){for(this._items=e,t=this.aL,r=void 0,w(t).find("div").forEach(function(e){w(e).unbind(k).unbind(M).unbind(T)}),r=t.firstChild;r;)ee(t,r),r=t.firstChild;for(n=this._K=0,o=e.length;n<o;n++)i=e[n],this.mL(ae(i,p)?i.text:i);return this}},re.prototype.mL=function(e){var t=this,r=b("div"),n=b("span");n.textContent=""+e,n.style.padding="0 18px 0 "+V+"px",n.style.textOverflow="ellipsis",n.style.whiteSpace="nowrap",$(r,n),$(t.aL,r),t._K++,w(r).bind(T,function(){var e=w(r).index();t.selectedIndex(e),t.closeDropDownList(),t.Wq(z,{isMouse:!0})}).bind(k,function(){var e=w(r);r.oldBackColor=e.css(j),e.css(j,"lightgrey")}).bind(M,function(){w(r).css(j,r.oldBackColor||"")})},re.prototype.nL=function(){this.Po=b("span"),w(this.Po).css(["display",c],[_,this.YK.style.font]).appendTo(h.body)},re.prototype.oL=function(){ee(h.body,this.Po)},re.prototype.pL=function(e){return this.Po.textContent=e,w(this.Po).width()+2+V},re.prototype.kL=function(e){var t=this.dL;0<=t&&t<this._K&&w(this.aL.children[t]).css(j,e)},re.prototype.LK=function(e){var t,r,n,o=this,i=e.keyCode,a=e.which;(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey||37===a||39===a)&&9!==a&&o.editable()||(t=o._K,r=o.dL,n=0,38===a||40===a?(0<=r&&r<t&&(n=r+(38===a?-1:1)),0<=n&&n<t&&o.selectedIndex(n),o.ZK&&o.lL(n),s(e)):13===a||37===a||39===a||9===a?(o.selectedIndex(o.dL),o.closeDropDownList(),o.Wq(z,{keyCode:i,shiftKey:e.shiftKey}),s(e)):27===a&&(o.closeDropDownList(),o.Wq(z,{keyCode:i}),s(e)))},re.prototype.getSelectedValue=function(e,t,r){var n,o=t[e];return y(o)||(1===r?n=e:0===r?n=ae(o,p)?o.text:o:2===r&&ae(o,"value")&&(n=o.value)),n},re.prototype.hL=function(e){this.kL(""),this.dL=e,this.kL("#1E90FF"),this.lL(e)},re.prototype.selectedIndex=function(e){var t;return 0===arguments.length?this.dL:void(0<=e&&e<this._K&&(this.hL(e),t=this.getSelectedValue(this.dL,this._items,this._editorValueType),y(t)||this.editorValue(t)))},re.prototype.itemCountPerPage=function(e){return 0===arguments.length?this.cL:void(0<e&&(this.cL=e))},re.prototype.Xn=function(e){this.nL();var t=this.pL(e);return this.oL(),t},re.prototype.itemHeight=function(e){return 0===arguments.length?this._itemHeight:void(0<e&&(this._itemHeight=e))},re.prototype.jL=function(){var e,t,r,n,o,i=this;i.nL(),e=i._items[0],t=x(i._itemHeight,w(i.Po).text(y(e)?"":e).height()),w(i.aL.children).css(L,t),(n=i._K)<=(o=i.cL)?r=n*t:(r=o*t,i.iL=!0),i.listHeight(r),i.oL()},re.prototype.lL=function(e){if(0<=e&&e<this._K){var t=this.aL.children[e];this.bL.BB(t)}},re.prototype.bind=function(e,t,r){w(this.KK).bind(e,t,r)},re.prototype.unbind=function(e,t){w(this.KK).unbind(e,t)},re.prototype.Wq=function(e,t){w(this.KK).trigger(e,t)},Z=re,Q(oe,J=u),oe.prototype.isReservedKey=function(e,t){return this.GK},oe.prototype.paintValue=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m=s.sheet,b=m.zoom?m.zoom():1,y=x(0,o-17-1);3===a.hAlign&&(a.hAlign=0),a.wordWrap&&(a.wordWrap=!1),0<y&&0<i&&(l={},u=void 0,s.quotePrefix=a.quotePrefix,c=a.formatter&&"General"!==a.formatter,h=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,d=this.getItemValue(t),f=c?a.formatter:h?a._autoFormatter:C.CellTypes.Context.Ixb(e,d,y+1,a,b),(u=this.format(W(t),f,l,s))&&(p=a.isVerticalText,v(d)&&!p&&!0!==a.shrinkToFit&&(u!==(g=C.CellTypes.Context.Lxb(e,u,y+1,a,b))&&(delete l.content,a.textIndent=0),u=g),this.paintText(e,this.getText(t,s),r,n,y,i,a,s,u,l))),e.save(),(o<17||i<17)&&(e.rect(r,n,o,i),e.clip()),e.beginPath(),e.lineWidth=2,e.fillStyle="black",e.moveTo(r+o-17+3,n+(i-2)/2-2.5),e.lineTo(r+o-17+6,n+(i-2)/2+3.5),e.lineTo(r+o-17+9,n+(i-2)/2-2.5),e.fill(),e.restore()},oe.prototype.getText=function(e,t){return e},oe.prototype.createEditorElement=function(e,t){var r,n,o,i=e&&e.sheet,a=i&&i.parent,s=a&&a._host,l=f.vl(s)+1e3,u=i.defaults,c=i.getActualStyle(e.row,e.col).cellPadding,h=0;return c&&(h=parseFloat(c.split(" ")[3])||0),r=i.Tl(e.col)-h,(n=new Z(t,0,0,u.colWidth,u.rowHeight,l,r)).editorValueType(this._editorValueType),n.items(this._items),n.itemHeight(this._itemHeight),n.itemCountPerPage(this._maxDropDownItems),n.editable(this._editable),o=n.getComboBox(),Object.defineProperty(o,"comboBox",{get:function(){return this.ixb},set:function(e){this.ixb!==e&&(this.ixb&&this.ixb.dispose(),this.ixb=e)}}),o.comboBox=n,null},oe.prototype.getEditorValue=function(e,t){var r=te(e);return r&&(this.DF=!r.HK),r&&r.editorValue()},oe.prototype.setEditorValue=function(e,t,r){var n=te(e);n&&n.editorValue(t)},oe.prototype.focus=function(e,t){var r=te(e);r&&r.focus()},oe.prototype.selectAll=function(e,t){var r=te(e);r&&r.selectAll()},oe.prototype.activateEditor=function(e,t,r,n){var u=n.sheet,c=te(e);c&&(c.editorValueType(this._editorValueType),c.items(this._items),c.itemHeight(this._itemHeight),c.itemCountPerPage(this._maxDropDownItems),c.editable(this._editable),c.bind(z,function(e,t){var r,n,o,i,a,s=t.keyCode,l=t.shiftKey;if(s){if(n=(r=u.wu()).getShortcutKey(s,!1,l||!1,!1,!1),o=r.getCommands(n))for(i=0,a=o.length;i<a;i++)if("navigationLeft"!==o[i].Cj&&"navigationRight"!==o[i].Cj||(u._editorStatus=1),o[i].execute(u.parent,{sheetName:u.name()}))return!0}else t.isMouse&&c.IK&&u.endEdit()})),this.GK=!0},oe.prototype.deactivateEditor=function(e,t){var r,n,o,i,a,s;if(e&&(r=te(e))){if(n=t.sheet.getActualStyle(t.row,t.col,t.sheetArea).cellPadding)for(o=[R,D],i=[3,0],a=0;a<o.length;a++)s="number"==typeof(s=parseInt(ie(n)[i[a]],10))&&0<s?s:0,r.shiftPadding(o[a],s);r.unbind(z),r.closeDropDownList(),r.IK=!1}this.GK=!1},oe.prototype.updateImeMode=function(e,t){if(this.isImeAware()){var r=te(e);r&&r.updateImeMode(t)}},oe.prototype.updateEditor=function(e,t,r,n){var o,i,a=e&&n&&n.sheet;a&&(o=te(e),t&&o&&(i=a._render,o.updateStyle(t.backColor,t.foreColor,i.Cl(t.font||i.Bl()))),r&&o&&o.updateLocationAndSize(r.x,r.y,r.width,r.height))},oe.prototype.format=function(e,t,r,n){var o;return y(e)?"":(o=this.getItemValue(e),u.prototype.format.call(this,o||e,t,r))},oe.prototype.getItemValue=function(e){var t,r,n,o,i=this._editorValueType,a=this._items;if(a)if(r=a.length,1===i){if(0<=(n=l(e))&&n<r&&(t=a[n])!==S&&null!==t)return ae(t,p)?t.text:t}else if(2===i)for(o=0;o<r;o++)if((t=a[o])&&ae(t,"value")&&t.value===e)return t.text},oe.prototype.parse=function(e,t,r){var n,o,i,a=this._editorValueType,s=this._items,l=u.prototype.parse.call(this,e,t);if(s){if(i=s.length,0===a)return l;if(1===a){for(o=0;o<i;o++)if((n=s[o])&&ae(n,p)&&n.text===l||n===l)return o}else if(2===a)for(o=0;o<i;o++)if((n=s[o])&&ae(n,p)&&n.text===l)return n.value}return l},oe.prototype.getHitInfo=function(e,t,r,n,o){var i,a,s,l,u,c;return o?(i=o.sheetArea,a=o.sheet,(y(i)||3===i)&&n&&(s=ie(r.cellPadding),l=parseInt(s[1],10)||0,u=n.x+n.width-l,c={x:e,y:t,row:o.row,col:o.col,cellStyle:r,cellRect:n,sheetArea:i,sheet:a},u-17<=e&&e<u)?(c.isReservedLocation=!0,c):null):null},oe.prototype.processMouseDown=function(e){var t,r=e.sheet,n=e.sheetArea;(y(n)||3===n)&&e.isReservedLocation&&r&&(e.row===r.Jl&&e.col===r.Kl||r.setActiveCell(e.row,e.col),r.startEdit(),(t=te(r._editor))&&(f.Ml.mozilla&&(t.JK=(new Date).valueOf()),t.showDropDownList(),t.IK=!0))},oe.prototype.getAutoFitWidth=function(e,t,r,n,o){return r&&r.wordWrap&&(r.wordWrap=!1),C.CellTypes.Context.cp(e,t,r,n,o)+17},oe.prototype.getAutoFitHeight=function(e,t,r,n,o){return r&&r.wordWrap&&(r.wordWrap=!1),C.CellTypes.Context.ep(e,t,r,n,o)},oe.prototype.isImeAware=function(e){return!0},oe.prototype.gQa=function(){},oe.prototype.toJSON=function(){var r,n=this,o={typeName:n.typeName};return i(q,function(e,t){r=n["_"+e],("items"===e?r&&0<r.length:r!==t)&&(o[e]=r)}),o},oe.prototype.fromJSON=function(r){var n=this;i(q,function(e){var t=r[e];y(t)||(n["_"+e]=t)})},Y=oe,t.ComboBox=Y,i(q,function(t){Y.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}}),C.CellTypes._o[7]=Y},"./dist/plugins/celltype/dropdown-action.js":function(e,t,r){"use strict";var j,H,G,U,W,V,z,q,Z,n,Y,K,X,J,o,i,Q,a,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,s;function l(B){return{canUndo:!1,execute:function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O=e.getSheetFromName(t.sheetName);if(!O||e.getActiveSheet().name()!==t.sheetName)return!1;if(n=t.row,o=t.col,(J.isNullOrUndefined(n)||J.isNullOrUndefined(o))&&(n=O.getActiveRowIndex(),o=O.getActiveColumnIndex()),i=t.sheetArea,J.isNullOrUndefined(i)&&(i=3),n<0||n>=O.getRowCount(i)||o<0||o>=O.getColumnCount(i))return!1;switch(O.showCell(n,o,j.VerticalPosition.nearest,j.HorizontalPosition.nearest),a=1===i?-1:void 0,s=2===i?-1:void 0,l=O.getCellRect(n,o,a,s),u=ue.createElement("div",void 0),d=n,p=o,g=i,c=(f=O).isEditing()?(m=f.getCellType(d,p),b={sheet:f,row:d,col:p,sheetArea:g},m.getEditorValue(f._editor,b)):f.getValue(d,p,g),(J.isNullOrUndefined(t.row)||J.isNullOrUndefined(t.col))&&(t.row=O.getActiveRowIndex(),t.col=O.getActiveColumnIndex()),B){case ee:h=new z.ColorPicker(u);break;case te:c=fe(c,"date"),h=new Z.Calendar(u);break;case re:c=fe(c,"date"),h=new W.TimePicker(u);break;case ne:c=""+(c=fe(c,"number")),h=new H.Calculator(u);break;case oe:c=fe(c,"date"),h=new V.MonthPicker(u);break;case ie:(h=new G.List(u)).formula=O.getFormula(t.row,t.col);break;case ae:c=fe(c,"number"),h=new U.Slider(u);break;case se:h=new K.WorkFlow(u),"string"!=typeof c&&c!==Q&&(c=""+c);break;case le:h=new X.MultiColumn(u,Q,O)}return y=h,C=B,w=c,v=l,S=O,x=t,$.Gm(),T=S.zo(),k=x.row,M=x.col,I=x.sheetArea,E=S.AHb(k,M,I),R=function(e){var t=-1;switch(e){case ee:t=j.DropDownType.colorPicker;break;case te:t=j.DropDownType.dateTimePicker;break;case re:t=j.DropDownType.timePicker;break;case ne:t=j.DropDownType.calculator;break;case oe:t=j.DropDownType.monthPicker;break;case ie:t=j.DropDownType.list;break;case ae:t=j.DropDownType.slider;break;case se:t=j.DropDownType.workflowList;break;case le:t=j.DropDownType.multiColumn}return t}(C),D=E.dropDowns,(F=D&&0<D.length)&&(_=D.filter(function(e){return e.type===R})[0])&&(void 0!==_.option&&null!==_.option&&(A=_.option),N=_),y.setOptions(A),y.setValue(w),P=T.getBoundingClientRect(),L=new q.Rectangle(v.x+P.left,v.y+P.top,v.width,v.height),he=new q.PopupControl(y.getContainer(),L,{align:q.DropDownAlignment.Far,hostElement:T}),F&&y.SDc(),he.open(),y.scrollToSelect(),F&&y.refresh(),y.on(Y.BaseDropdown.Event_ValueChanged,function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p;e.notCloseDropDown||he.close(),d=x,!0===(p=e).notSubmit||3!==d.sheetArea&&d.cmd===ne&&isNaN(p.value)||(t=S,r=N,o=e,h=(n=x).row,f=n.col,(J.isNullOrUndefined(h)||J.isNullOrUndefined(f))&&(h=t.getActiveRowIndex(),f=t.getActiveColumnIndex()),i=n.sheetArea,J.isNullOrUndefined(i)&&(i=3),r&&r.submitCommand?"string"==typeof r.submitCommand?t.getParent().commandManager().execute({cmd:r.submitCommand,sheetName:t.name(),row:h,col:f,newValue:o.value}):"function"==typeof r.submitCommand&&((a={}).row=n.row,a.col=n.col,a.sheetArea=i,r.submitCommand.call(null,t,o.value,a)):(t.getParent().commandManager().execute({cmd:"editCell",sheetName:t.name(),row:h,col:f,newValue:o.text,autoFormat:!o.noAutoFormat,sheetArea:i,isUndo:!1}),t.isEditing()&&t.Kl===f&&t.Jl===h&&(s=t.getCellType(h,f),l={sheet:t,row:h,col:f,sheetArea:j.SheetArea.viewport},u=t.AHb(h,f,i),c=t.getCellRect(h,f),t._editor.LF=o.value,s.updateEditor(t._editor,u,c,l),s.setEditorValue(t._editor,o.text,l))))}),y.getContainer().addEventListener("contextmenu",function(e){e.stopPropagation(),e.preventDefault()}),he.on("close",function(){var e,t,r,n,o,i;e=S,t=k,r=M,n=I,i=E.cellButtons,e&&i&&0<i.length&&(o=e._modelManager.getValueForKey(t,r,ce,n))&&o.isMouseDownReservedLocation&&(o.buttonDownIndex=-1,o.isMouseDownReservedLocation=!1,e.repaint(e.getCellRect(t,r))),y&&y.dispose(),he=null,$.Hm()}),!0}}}function fe(e,t){return"date"===t?"string"==typeof e?(e=i.Qa(e))===Q&&(e=new Date):e instanceof Date||(e=new Date):"number"===t&&("string"==typeof e?e=o.Qa(e):"number"!=typeof e&&(e=0)),e}Object.defineProperty(t,"__esModule",{value:!0}),j=r("Core"),t.commands=j.Commands,H=r("./dist/plugins/celltype/editor/calculator.js"),G=r("./dist/plugins/celltype/editor/listControl.js"),U=r("./dist/plugins/celltype/editor/slider.js"),W=r("./dist/plugins/celltype/editor/timepicker.js"),V=r("./dist/plugins/celltype/editor/monthPicker.js"),z=r("./dist/plugins/celltype/editor/colorpicker.js"),q=r("./dist/plugins/celltype/editor/popupControl.js"),Z=r("./dist/plugins/celltype/editor/calendar.js"),n=r("@grapecity/js-sheets-common"),Y=r("./dist/plugins/celltype/editor/baseControl.js"),K=r("./dist/plugins/celltype/editor/workflowPicker.js"),X=r("./dist/plugins/celltype/editor/multiColumnPicker.js"),J=r("./node_modules/util/util.js"),o=n.Common.o,i=n.Common.l,Q=null,a=window,$=a.Yl,ee="openColorPicker",te="openDateTimePicker",re="openTimePicker",ne="openCalculator",oe="openMonthPicker",ie="openList",ae="openSlider",se="openWorkflowList",le="openMultiColumn",ue=document,ce="_cellButtonParam",j.Commands[ee]=l(ee),j.Commands[te]=l(te),j.Commands[re]=l(re),j.Commands[ne]=l(ne),j.Commands[oe]=l(oe),j.Commands[ie]=l(ie),j.Commands[ae]=l(ae),j.Commands[se]=l(se),j.Commands[le]=l(le),s={init:function(){this.commandManager().register(ee,j.Commands[ee]),this.commandManager().register(te,j.Commands[te]),this.commandManager().register(re,j.Commands[re]),this.commandManager().register(ne,j.Commands[ne]),this.commandManager().register(oe,j.Commands[oe]),this.commandManager().register(ie,j.Commands[ie]),this.commandManager().register(ae,j.Commands[ae]),this.commandManager().register(se,j.Commands[se]),this.commandManager().register(le,j.Commands[le])}},j.Workbook.$n("registerOpendropdownCommand",s),j.Worksheet.$n("registerOpendropdownCommand",{preProcessMouseWheel:function(e){he&&!this.sgc&&(e.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(e,t,r){"use strict";var n,o,i,a,s=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function l(e){var t=i.call(this)||this;return t._host=e,t}function u(e){var t=a.call(this)||this;return t.xo=e,t}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/plugins/celltype/editor/eventbase.js"),a=n.EventBase,s(u,a),u.prototype.init=function(e,t,r){this._host=this.xo.querySelector("."+t),this._host?this.RemoveChilds(this._host):(this._host=this.CreateElement(e,t,r),this.xo.appendChild(this._host))},u.prototype.GetContainer=function(){return this.xo},u.prototype.RemoveChilds=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},u.prototype.CreateElement=function(e,t,r,n){var o,i=document.createElement(e);if(t&&(i.className=t),r)for(o in r)r[o]&&i.setAttribute(o,r[o]);return n&&n.appendChild(i),i},t.BaseControl=u,i=n.EventBase,s(l,i),l.prototype.updateStyle=function(e,t,r){},l.prototype.scrollToSelect=function(){},l.prototype.getContainer=function(){return this._host},l.prototype.refresh=function(){},l.prototype.SDc=function(){},l.prototype.dispose=function(){},l.Event_ValueChanged="ValueChangedEvent",t.BaseDropdown=l},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(e,t,r){"use strict";var n,i,a,h,f,o,s,l,u=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function c(e,t,r){var n=l.call(this,e)||this;return n.setOptions(t),n.Lgc=r,n}function d(e,t,r){var n={sheet:e};a.isNullOrUndefined(r)||(n.isEsc=r),e.Wq(t,n)}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/plugins/celltype/editor/baseControl.js"),i=r("Core"),a=r("./node_modules/util/util.js"),h=Math.min,f=Math.max,o=".baseSpreadNS",l=n.BaseDropdown,u(c,l),c.prototype.setOptions=function(e){var t,r;(this.$z=e)&&(t=this._host,(r=document.createElement("div")).setAttribute("class","gc-base-spread-div"),t.appendChild(r),this.Mgc=r,this.Ngc=this.Ogc(r))},c.prototype.setValue=function(e){var t;this.$z&&(t=this.Ngc,setTimeout(function(){window.Yl.Hm(),t&&t.focus(!0)},1e3))},c.prototype.SDc=function(){var e,t,r,n,o;this.Mgc&&(e=this._host,(t=this.$z)&&(r=t.width,n=t.height),o=this.mAa(),a.isNullOrUndefined(r)&&(r=o.width),a.isNullOrUndefined(n)&&(n=o.height),i.GC$(e).width(r).height(n))},c.prototype.refresh=function(){this.Ngc&&this.Ngc.refresh()},c.prototype.dispose=function(){var e=this;e.Lgc&&(e.Lgc.zt(),e.Lgc=null),e.Mgc&&(e.Mgc=null),e.Ngc&&(e.Ngc.unbind(i.Events.DropdownSpreadMouseClick+o),e.Ngc.unbind(i.Events.DropdownSpreadKeyboardEnter+o),e.Ngc.no(),e.Ngc=null)},c.prototype.mAa=function(){var e,t,r,n,o,i,a,s=this.Ngc,l=s.getActiveSheet(),u=l.getColumnCount(),c=0;for(e=0;e<u;e++)c+=l.getColumnWidth(e,3);return t=c,r=l.getRowCount(3)+l.getRowCount(1),n=l.getRowHeight(0,3)*r,t<800?s.options.showHorizontalScrollbar=!1:(o=0,s.Pt&&(o=s.Pt._v()),n+=o),n<400?s.options.showVerticalScrollbar=!1:(i=0,(a=s.St)&&(i=a.wDc(!1)||a.Vo()),t+=i),{width:h(t,800),height:h(f(n,100),400)}},c.prototype.Ogc=function(e){var t,r,n=new i.Workbook(e,{sheetCount:1});return n.jDc=!0,(t=n.options).allowUserDragDrop=!1,t.allowUserDragFill=!1,t.allowUserResize=!1,t.allowUserZoom=!1,t.tabStripVisible=!1,t.allowContextMenu=!1,t.allowUserDeselect=!1,t.scrollbarMaxAlign=!0,n.getActiveSheet().sgc=!0,r=this,n.bind(i.Events.DropdownSpreadMouseClick+o,function(e,t){r.submitData(t)}),n.bind(i.Events.DropdownSpreadKeyboardEnter+o,function(e,t){r.submitData(t)}),n},c.prototype.submitData=function(e){},t.BaseSpreadPicker=c,i.GC$.extend(i.Worksheet.prototype,{tgc:function(){d(this,i.Events.DropdownSpreadMouseClick)},ugc:function(e){d(this,i.Events.DropdownSpreadKeyboardEnter,e)}})},"./dist/plugins/celltype/editor/calculator.js":function(e,t,r){"use strict";var s,n,o,i,a,u,l,c,h,f,d,p,g,m,b,y,C,w,v,S=this&&this.__extends||(w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function x(e){var t=v.call(this,e)||this,r=t;return r._host=document.createElement("div"),r._host.classList.add("gc-calculator-container"),r._host.innerHTML='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',r._host.querySelector(".okbtn").textContent=u().OK,e.appendChild(t._host),r.YCb(),r.ZCb(),r.$Cb(),r._Cb(),r.aDb("0"),t}function T(e,t,r,n,o,i,a,s,l,u,c){var h=this;h.Fi=e,h.XHa=t,h.YHa=r,h.JCb=n,h.KCb=o,h.Jb=i,h.LCb=a,h.MCb=s,h.NCb=l,h.OCb=u,h.PCb=c,h.QCb=g}function A(){}function k(){}function M(){}Object.defineProperty(t,"__esModule",{value:!0}),s=r("./dist/plugins/celltype/editor/baseControl.js"),n=r("./dist/plugins/celltype/celltypes.ns.js"),o=r("@grapecity/js-sheets-common"),i=r("Core"),a=new o.Common.ResourceManager(n.SR),u=a.getResource.bind(a),l=Math.floor,c=Math.abs,h=Math.pow,f=Math.round,d=Math.sqrt,p=Math.max,g=["0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"],M.Init=function(){M.GetBrowserType(),M.IsIE=void 0!==M.ie||void 0!==M.edge},M.GetBrowserType=function(){try{var e=navigator.userAgent.toLowerCase();window.ActiveXObject?M.ie=e.match(/msie ([\d.]+)/)[1]:-1!==e.indexOf("edge")?M.edge=e.match(/edge\/([\d.]+)/)[1]:-1!==e.indexOf("firefox")&&(M.firefox=e.match(/firefox\/([\d.]+)/)[1]),-1!==e.indexOf("rv:")&&-1===e.indexOf("firefox")&&(M.ie=e.match(/rv:([\d.]+)/)[1])}catch(e){}},(m=M).Init(),k.IsErrorText=function(e){return e===u().Calculator_DivideByZeroInfo||e===u().Calculator_InvalidInputInfo||e===u().Calculator_SqrtParameterException||e===u().Calculator_OverFlowInfo},b=k,t.CalculatorErrorInfo=b,A.IsDotContained=function(e){return-1!==(e+"").indexOf(".")},A.GetDotPosition=function(e){var t=e+"",r=0,n=0;for(n=t.length;0<n;n--){if("."===t.substring(n-1,n))return r;r++}return 0===n?0:r},A.FormatOutput=function(e){var t,r;if(null==e)return null;if(r=(t=e+"").length,A.IsDotContained(t))for(;"0"===t.substring(r-1,r)&&""!==t&&-1===t.indexOf("e");)t=t.substring(0,r-1),r--;return t},A.FormatResult=function(e){var t,r,n,o,i,a,s;return isNaN(e)&&(e=0),t=e+"",r="",e<0&&(r="-",t=t.substring(1,t.length)),n=t.length,o="",-1!==(i=t.indexOf("e"))&&(o=t.substring(i,n),n=(t=t.substring(0,i)).length),A.IsDotContained(t)&&16<n&&(a=0,t=1<parseFloat(t)?(a=A.GetDotPosition(t)-(n-16),(""+t).substring(0,17)):(a=A.GetDotPosition(t)-(n-17),(""+t).substring(0,18)),t=0<a?""+f(parseFloat(t)*h(10,a))/h(10,a):""+f(parseFloat(t))),n=t.length,!A.IsDotContained(t)&&15<n&&(a=n-15,t=""+f(parseFloat(t)/h(10,a))*h(10,a)),t=r+t+o,s=parseFloat(t),A.IsOverFlow(""+s)?u().Calculator_OverFlowInfo:s},A.SingleMathOperation=function(e,t){var r,n=parseFloat(e);if(isNaN(n)&&(n=0),"SQRT"===t){if(n<0)return u().Calculator_InvalidInputInfo;n=d(n)}if("POW"===t&&(n=h(n,2)),"1/x"===t){if(0===n)return u().Calculator_DivideByZeroInfo;r=A.GetDotPosition(""+n),n=h(10,r)/(h(10,r)*n)}return A.FormatResult(n)},A.DoubleMathOperation=function(e,t,r){var n,o,i,a,s=parseFloat(e),l=parseFloat(t);if(A.IsDotContained(""+s)||A.IsDotContained(""+l)){if(i=o=0,A.IsDotContained(""+s)&&(o=A.GetDotPosition(""+s)),A.IsDotContained(""+l)&&(i=A.GetDotPosition(""+l)),a=p(o,i),"+"===r&&(n=((s*=h(10,a))+(l*=h(10,a)))/h(10,a)),"-"===r&&(n=((s*=h(10,a))-(l*=h(10,a)))/h(10,a)),"*"===r&&(n=(s*=h(10,o))*(l*=h(10,i))/h(10,o+i)),"/"===r){if(s*=h(10,a),0==(l*=h(10,a)))return u().Calculator_DivideByZeroInfo;n=s/l}"%"===r&&(n=(s*=h(10,o))*(l*=h(10,i))/h(10,o+i+2))}else{if("+"===r&&(n=s+l),"-"===r&&(n=s-l),"*"===r&&(n=s*l),"/"===r){if(0===l)return u().Calculator_DivideByZeroInfo;n=s/l}"%"===r&&(n=s*l/100)}return A.FormatResult(n)},A.IsOverFlow=function(e){var t=parseFloat(e);if(0!==t){if(79e27<t)return!0;if(t<1e-28&&-1e-28<t)return!0;if(t<-79e27)return!0}return!1},y=A,T.prototype.RCb=function(){this.Fi="",this.XHa=null,this.YHa=null,this.JCb=null,this.KCb=0,this.MCb=!1,this.NCb=!1},T.prototype.Click=function(e){var t,r=this;return 0<=e&&e<=11&&(r.OCb&&(r.SCb(e),r.OCb=!1),r.TCb(e),10!==e&&(r.PCb="ClickNumericButton")),(12<=e&&e<=19||27===e)&&(r.OCb?(r.SCb(e),r.OCb=!1):(r.UCb(e),r.PCb="ClickMathButton")),24===e&&(r.OCb&&(r.SCb(e),r.OCb=!1),r.VCb()),25!==e&&26!==e||(r.SCb(e),r.OCb=!1),r.OCb?null:((t={}).outputText=r.WCb(),b.IsErrorText(r.Fi)&&(r.OCb=!0),t.result=void 0===r.Fi||null===r.Fi?"":r.Fi,t.x=r.XHa,t.y=r.YHa,t.operation=r.JCb,t.token=r.KCb,t.count=r.Jb,t.memoryNumber=r.LCb,t.isBSCanUse=r.MCb,t.isEqualClicked=r.NCb,t.isOperationInvalid=r.OCb,t.lastOperation=r.PCb,t)},T.prototype.TCb=function(e){var t=this;if(null!==t.Fi&&void 0!==t.Fi||(t.Fi=""),!(14<t.Jb&&10!==e))switch(11!==e&&10!==e&&(0!==e||t.Fi+""!="0"&&""!==t.Fi)&&t.Jb++,10!==e&&(t.MCb=!0),t.KCb){case 0:0<=e&&e<=9&&("ClickNumericButton"!==t.PCb&&void 0!==t.PCb&&null!==t.PCb&&(t.Fi="0"),"0"===t.Fi&&0!==e?t.Fi=""+e:"0"!==t.Fi&&(t.Fi=t.Fi+""+e)),10===e&&(-1===(""+t.Fi).indexOf("e")?""!==t.Fi&&"0"!==t.Fi&&(-1===(""+t.Fi).indexOf("-")?t.Fi="-"+t.Fi:t.Fi=(""+t.Fi).substring(1,(""+t.Fi).length)):0<+t.Fi?t.Fi="-"+t.Fi:t.Fi=t.Fi.substring(1,t.Fi.length)),11===e&&("ClickNumericButton"!==t.PCb&&void 0!==t.PCb&&null!==t.PCb&&(t.Fi="0."),""===t.Fi||y.IsDotContained(t.Fi)?""!==t.Fi&&y.IsDotContained(t.Fi)||(t.Fi="0."):t.Fi=t.Fi+"."),t.KCb=1;break;case 1:0<=e&&e<=9&&("ClickNumericButton"!==t.PCb&&void 0!==t.PCb&&null!==t.PCb&&(t.Fi="0"),"0"===t.Fi&&0===e||("0"===t.Fi&&0!==e?t.Fi=""+e:t.Fi=t.Fi+""+e)),10===e&&(-1===(""+t.Fi).indexOf("e")?""!==t.Fi&&"0"!==t.Fi&&(-1===(""+t.Fi).indexOf("-")?t.Fi="-"+t.Fi:t.Fi=(""+t.Fi).substring(1,(""+t.Fi).length)):0<+t.Fi?t.Fi="-"+t.Fi:t.Fi=t.Fi.substring(1,t.Fi.length)),11===e&&("ClickNumericButton"!==t.PCb&&void 0!==t.PCb&&null!==t.PCb?t.Fi="0.":y.IsDotContained(t.Fi)||(""===t.Fi?t.Fi="0.":t.Fi=t.Fi+".")),t.NCb||(t.YHa=t.Fi);break;case 2:0<=e&&e<=9&&(t.Fi="",t.Fi=t.Fi+e),11===e&&(t.Fi="0."),10===e&&(t.Fi="0"),t.KCb=3,t.YHa=t.Fi;break;case 3:0<=e&&e<=9&&("ClickNumericButton"!==t.PCb&&void 0!==t.PCb&&null!==t.PCb&&(t.Fi="0"),"0"===t.Fi&&0===e||("0"===t.Fi&&0!==e?t.Fi=""+e:t.Fi=t.Fi+""+e)),10===e&&(-1===(""+t.Fi).indexOf("e")?""!==t.Fi&&"0"!==t.Fi&&(-1===(""+t.Fi).indexOf("-")?t.Fi="-"+t.Fi:t.Fi=(""+t.Fi).substring(1,(""+t.Fi).length)):0<+t.Fi?t.Fi="-"+t.Fi:t.Fi=t.Fi.substring(1,t.Fi.length)),11===e&&("ClickNumericButton"!==t.PCb&&null!==t.PCb?t.Fi="0.":y.IsDotContained(t.Fi)||(""===t.Fi?t.Fi="0.":t.Fi=t.Fi+".")),t.YHa=t.Fi}},T.prototype.UCb=function(e){var t=this;switch(t.Jb=0,t.MCb=!1,t.NCb&&(t.NCb=!1),t.Fi=y.FormatOutput(t.Fi),t.KCb){case 0:""===t.Fi&&(t.Fi=0),(16<=e&&e<=18&&17!==e||27===e)&&(t.Fi=""+y.SingleMathOperation(t.Fi,t.QCb[e]),b.IsErrorText(t.Fi)||(t.XHa=t.Fi),t.KCb=1),12<=e&&e<=15&&(t.JCb=e,t.XHa=t.Fi,t.KCb=2),17===e&&t.RCb();break;case 1:(16<=e&&e<=18&&17!==e||27===e)&&(t.Fi=""+y.SingleMathOperation(t.Fi,t.QCb[e]),b.IsErrorText(t.Fi)||(null!==t.JCb&&void 0!==t.JCb&&null!==t.YHa&&void 0!==t.YHa?t.YHa=t.Fi:t.XHa=t.Fi)),19===e&&(null!==t.JCb&&void 0!==t.JCb&&null!==t.YHa&&void 0!==t.YHa?(t.Fi=""+y.DoubleMathOperation(""+t.XHa,""+t.YHa,t.QCb[t.JCb]),b.IsErrorText(t.Fi)||(t.XHa=t.Fi)):"-0."===t.Fi&&(t.Fi="0."),t.NCb=!0,t.MCb=!1),12<=e&&e<=15&&(t.JCb=e,t.XHa=t.Fi,t.KCb=2),17===e&&(null!==t.JCb&&void 0!==t.JCb?(t.YHa=t.Fi,t.Fi=""+y.DoubleMathOperation(""+t.XHa,""+t.YHa,t.QCb[17]),t.YHa=t.Fi):t.RCb());break;case 2:(16<=e&&e<=18&&17!==e||27===e)&&(t.Fi=""+y.SingleMathOperation(t.Fi,t.QCb[e]),b.IsErrorText(t.Fi)||(t.KCb=3,t.YHa=t.Fi)),19===e&&(t.YHa=t.XHa,t.Fi=""+y.DoubleMathOperation(""+t.XHa,""+t.XHa,t.QCb[t.JCb]),b.IsErrorText(t.Fi)||(t.XHa=t.Fi,t.KCb=1,t.MCb=!1),t.NCb=!0),12<=e&&e<=15&&(t.JCb=e,t.YHa=t.Fi),17===e&&(t.Fi=y.DoubleMathOperation(""+t.XHa,""+t.XHa,t.QCb[17]),b.IsErrorText(t.Fi)||(t.YHa=t.Fi,t.KCb=3));break;case 3:16<=e&&e<=18&&17!==e&&(t.Fi=""+y.SingleMathOperation(t.Fi,t.QCb[e]),b.IsErrorText(t.Fi)||(t.YHa=t.Fi)),12<=e&&e<=15&&(t.YHa=t.Fi,t.Fi=""+y.DoubleMathOperation(""+t.XHa,""+t.YHa,t.QCb[t.JCb]),b.IsErrorText(t.Fi)||(t.XHa=t.Fi,t.YHa=null,t.JCb=e,t.KCb=2)),17===e&&(t.Fi=y.DoubleMathOperation(""+t.XHa,""+t.YHa,t.QCb[17]),b.IsErrorText(t.Fi)||(t.YHa=t.Fi)),19===e&&(t.YHa=t.Fi,t.Fi=""+y.DoubleMathOperation(""+t.XHa,""+t.YHa,t.QCb[t.JCb]),b.IsErrorText(t.Fi)||(t.XHa=t.Fi,t.KCb=1,t.MCb=!1),t.NCb=!0)}t.Fi+=""},T.prototype.VCb=function(){var e,t=this;if(0<t.Jb&&t.Jb--,(0===t.KCb||1===t.KCb||3===t.KCb)&&!0===t.MCb)switch(t.Fi+="",e=t.Fi.length,0<e&&(t.Fi=t.Fi.substring(0,e-1)),"-0"===t.Fi&&(t.Fi="0"),"-"===t.Fi&&(t.Fi=""),""===t.Fi&&(t.MCb=!1),t.KCb){case 0:case 1:t.XHa=t.Fi;break;case 3:t.YHa=t.Fi}},T.prototype.SCb=function(e){var t=this;t.Jb=0,t.MCb=!1,t.Fi="",25===e&&(1===t.KCb&&(null===t.JCb||void 0===t.JCb||t.NCb||(t.YHa=0)),2===t.KCb&&(t.KCb=3)),26===e&&t.RCb()},T.prototype.WCb=function(){return""===this.Fi||null===this.Fi||void 0===this.Fi?"0":this.Fi},T.prototype.XCb=function(e){var t=e.keyCode;switch(e.shiftKey&&(t|=65536),e.ctrlKey&&(t|=131072),e.altKey&&(t|=262144),t){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(!m.IsIE)return 12;break;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===t&&m.firefox||187===t&&!m.firefox?19:-1}},C=T,v=s.BaseDropdown,S(x,v),x.prototype.setValue=function(e){var t,r=this;e=r.bDb(e);try{if(!r.Na(e))throw Error(u().Calculator_InvalidInputInfo);e=""===e?"0":e,r.Fi=r.cDb(e),r._text=r.dDb(e),r.XHa=parseFloat(r.Fi),r.YHa=null,r.JCb=null,r.KCb=0,r.Jb=r.eDb(parseFloat(r.Fi)),0<r.Jb?r.MCb=!0:r.MCb=!1,r.NCb=!1,r.OCb=!1,r.PCb=null}catch(e){r._text=u().Calculator_InvalidInputInfo,r.Fi="",r.XHa=null,r.YHa=null,r.OCb=!0}return r.fDb(r.OCb),r.aDb(r._text),(t={}).outputText=r._text,t.result=r.Fi,t.x=r.XHa,t.y=r.YHa,t.operation=r.JCb,t.token=r.KCb,t.count=r.Jb,t.memoryNumber=r.LCb,t.isBSCanUse=r.MCb,t.isEqualClicked=r.NCb,t.isOperationInvalid=r.OCb,t.lastOperation=r.PCb,r.gDb=new C(r.Fi,r.XHa,r.YHa,r.JCb,r.KCb,r.Jb,r.LCb,r.MCb,r.NCb,r.OCb,r.PCb),r},x.prototype.setOptions=function(){},x.prototype.scrollToSelect=function(){var e=this._host.querySelector(".gc-main-screen .gc-main");this.kDb(e)},x.prototype.YCb=function(){var e=this;e.hDb="0",e._text=e.hDb,e.Fi="",e.XHa=0,e.YHa=0,e.JCb=null,e.KCb=0,e.Jb=0,e.LCb=null,e.MCb=!1,e.NCb=!1,e.OCb=!1,e.PCb=null},x.prototype.ZCb=function(){var e=this;e.gDb=new C(this.Fi,e.XHa,e.YHa,e.JCb,e.KCb,e.Jb,e.LCb,e.MCb,e.NCb,e.OCb,e.PCb)},x.prototype.$Cb=function(){this.fDb(this.OCb)},x.prototype._Cb=function(){var o=this,i=this,a=i._host;a.addEventListener("click",function(e){for(var t,r,n=e.srcElement||e.target;n&&!n.classList.contains("button");)n=n.parentElement;n&&(n.getAttribute("data-value")?(t=n.getAttribute("data-value"),r=x.iDb(t),a.focus(),-1!==r&&i.jDb(r)):n.classList.contains("okbtn")&&("ClickNumericButton"===i.PCb&&i.jDb(19),o.fire(s.BaseDropdown.Event_ValueChanged,{value:i._text,text:i._text})))}),a.addEventListener("keydown",function(e){!0!==i.XCb(e)&&(e.preventDefault(),e.stopPropagation())}),a.addEventListener("contextmenu",function(e){e.preventDefault(),e.stopPropagation()})},x.prototype.aDb=function(e){var t=this._host.querySelector(".gc-main-screen .gc-main"),r=t.value;null!=r&&(""+r).replace(/\r\n/g,"\n")!==(""+e).replace(/\r\n/g,"\n")&&(t.value=e,this.kDb(t))},x.prototype.kDb=function(e){if(null!==this.lDb&&void 0!==this.lDb||(this.lDb=parseInt(window.getComputedStyle(e)["font-size"].replace("px",""),0)),this.mDb(e))for(;this.mDb(e);)this.nDb(e);else this.oDb(e)},x.prototype.mDb=function(e){var t,r;return e.scrollWidth>e.clientWidth||!(!i.Ul.Ml.edge&&!i.Ul.Ml.msie)&&!(e.clientWidth<=0)&&(r=(t=window.getComputedStyle(e)).fontWeight+" "+t.fontSize+" "+t.fontFamily,i.Vn.Xn(e.value,r)+40>e.clientWidth)},x.prototype.nDb=function(e){var t=parseInt(window.getComputedStyle(e)["font-size"].replace("px",""),0);e.style.fontSize=t-1+"px"},x.prototype.oDb=function(e){for(var t=parseInt(window.getComputedStyle(e)["font-size"].replace("px",""),0);!this.mDb(e)&&t<this.lDb;)if(++t,e.style.fontSize=t+"px",this.mDb(e)){for(;this.mDb(e);)this.nDb(e);break}},x.prototype.bDb=function(e){if(void 0===e||"string"!=typeof e&&!(e instanceof String))throw Error(e+" type is not a string.");return null!=e||(e=""),""+e},x.prototype.pDb=function(e,t){var r,n,o,i;if(0===t.length)return"";for(r="",n=o=0;n<t.length;n++){for(i=!1,o=0;o<e.length;o++)t.substring(n,n+1)===e.substring(o,o+1)&&(i=!0);!0===i&&(r+=t.substring(n,n+1))}return r},x.prototype.Na=function(e){if(this.pDb("-.0123456789",e)!==e)return!1;var t=e.indexOf("-");return(-1===t||0===t)&&e.indexOf("-")===e.lastIndexOf("-")&&e.indexOf(".")===e.lastIndexOf(".")},x.prototype.cDb=function(e){var t,r,n,o,i,a=parseFloat(e),s=!1;if(a<0&&(s=!0),t=c(a),r=l(t),n=y.GetDotPosition(""+t),o=(t*h(10,n)-r*h(10,n))/h(10,n),999999999999999<r)throw Error(u().Calculator_InvalidInputInfo);if(999999999999999!==r)return o=f(o*h(10,i=0===r?15:15-(""+r).length))/h(10,i),n=y.GetDotPosition(""+o),t=(r*h(10,n)+o*h(10,n))/h(10,n),r=l(t),n=y.GetDotPosition(""+t),0==(o=(t*h(10,n)-r*h(10,n))/h(10,n))&&(t=r),s?"-"+t:""+t;if(0===o)return r;throw Error(u().Calculator_InvalidInputInfo)},x.prototype.dDb=function(e){var t=""+e;return""===t&&(t="0"),t},x.prototype.eDb=function(e){var t=c(e),r=l(t),n=y.GetDotPosition(""+t),o=(t*h(10,n)-r*h(10,n))/h(10,n);return(0===r?0:(""+r).length)+(0==o?0:n)},x.prototype.fDb=function(e){for(var t=10;t<=18;t++)this.qDb(t,e);this.qDb(27,e)},x.prototype.qDb=function(e,t){var r=g[e],n=this._host.querySelector('[data-value="'+r.toLowerCase()+'"]');n&&(t?n.classList.add("disabled"):n.classList.remove("disabled"))},x.iDb=function(e){var t=-1;switch(e){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t=parseInt(e,10);break;case"+/-":t=10;break;case".":t=11;break;case"+":t=12;break;case"-":t=13;break;case"*":t=14;break;case"/":t=15;break;case"sqrt":t=16;break;case"%":t=17;break;case"1/x":t=18;break;case"=":t=19;break;case"MC":t=20;break;case"MR":t=21;break;case"MS":t=22;break;case"M+":t=23;break;case"BS":t=24;break;case"CE":t=25;break;case"C":t=26;break;case"pow":t=27;break;default:t=-1}return t},x.prototype.jDb=function(e){var t=this,r=t.gDb.Click(e);null!=r&&(null!==r.result&&void 0!==r.result&&(t.Fi=r.result),null!==r.outputText&&void 0!==r.outputText&&(t.hDb=r.outputText,t._text=t.hDb,t.aDb(t.hDb)),null!==r.isOperationInvalid&&void 0!==r.isOperationInvalid&&r.isOperationInvalid!==t.OCb&&(t.OCb=r.isOperationInvalid,t.fDb(t.OCb)),r.memoryNumber!==t.LCb&&(t.LCb=r.memoryNumber),r.lastOperation!==t.PCb&&(t.PCb=r.lastOperation))},x.prototype.XCb=function(e){var t=this.gDb.XCb(e);return null==t||-1!==t&&void this.jDb(t)},t.Calculator=x},"./dist/plugins/celltype/editor/calendar.js":function(e,t,r){"use strict";var n,o,i,a,s,l,u,m,c,h,b,y,f,d,p,C,w,g,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne=this&&this.__extends||($=function(e,t){return($=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}$(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function oe(e){return c.createElement(e)}function ie(e,t){var n=ee.call(this,e)||this;return n.rDb=7,n.JK=!0,n.aT=new J(n),n._render=new Q(n),n._render.on(i.BaseDropdown.Event_ValueChanged,function(e){var t=s.Common.CultureManager.q4().DateTimeFormat,r=new s.Formatter.GeneralFormatter(t.shortDatePattern+" h:mm:ss").format(e.newValue);n.fire(i.BaseDropdown.Event_ValueChanged,{text:r,value:e.newValue})}),n._render.on(Q.Event_GetHost,function(e){e.host=n._host}),n._render.createCalendarDom(),n._render.attachEvent(),n.setValue(new Date),n._render.showCalendarPage(l.CalendarPage.day),n._render.setCalendarActivePart(G.Date),t&&n.setOptions(t),n}function ae(e){var t=te.call(this)||this;return t.sDb=40,t.tDb=100,t.uDb=!1,t.tc=e,t}function se(e){this.owner=e,this.calendarPage=l.CalendarPage.month,this.oldSelectedData=null,this.selectedDate=new Date,this.focusDate=new Date(this.selectedDate.valueOf()),this.focusDateTimeIndex=-1,U.initResource()}function le(e,t,r,n){this.date=e,this.selected=!!t,this.disabled=!!r,this.focused=!!n}function ue(e,t,r,n){this.month=e,this.selected=!!t,this.disabled=!!r,this.focused=!!n}function ce(e,t,r,n){this.year=e,this.selected=!!t,this.disabled=!!r,this.focused=!!n}function he(){}function fe(){}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/plugins/celltype/editor/eventbase.js"),o=r("./dist/plugins/celltype/editor/timepicker.js"),i=r("./dist/plugins/celltype/editor/baseControl.js"),a=r("./dist/plugins/celltype/celltypes.ns.js"),s=r("@grapecity/js-sheets-common"),l=r("Core"),u=new s.Common.ResourceManager(a.SR),m=u.getResource.bind(u),c=document,h="gc-content-container",b="gc-header-container",y="gc-header-title",f="gc-year-page",d="gc-month-page",p="gc-day-page",C="gc-left-arrow",w="gc-right-arrow",g="gc-is-focused",v="gc-cl-is-selected",S="gc-cl-disabled-text",x="gc-cl-select-container",T="gc-focus-part-indicator",A="gc-cl-datepicker",k="gc-cl-dropdown",M="gc-cl-datepicker-filter",I="gc-cl-datepicker-filter-month",E="gc-cl-grid-align-spread",R="gc-cl-align-middle",D="gc-cl-button-icon-container",N="gc-cl-datepicker-month",F="gc-cl-day",_="gc-cl-grow",P="gc-cl-grid",L="gc-cl-button",O="year-index",B="month-index",j="week-index",H="day-index",(re=G=G||{})[re.Date=1]="Date",re[re.Time=2]="Time",fe.initResource=function(){fe.resource={shortWeeks:[m().Calendar_ShortWeeks_1,m().Calendar_ShortWeeks_2,m().Calendar_ShortWeeks_3,m().Calendar_ShortWeeks_4,m().Calendar_ShortWeeks_5,m().Calendar_ShortWeeks_6,m().Calendar_ShortWeeks_7],shortMonths:[m().Calendar_ShortMonths_1,m().Calendar_ShortMonths_2,m().Calendar_ShortMonths_3,m().Calendar_ShortMonths_4,m().Calendar_ShortMonths_5,m().Calendar_ShortMonths_6,m().Calendar_ShortMonths_7,m().Calendar_ShortMonths_8,m().Calendar_ShortMonths_9,m().Calendar_ShortMonths_10,m().Calendar_ShortMonths_11,m().Calendar_ShortMonths_12],weeks:[m().Calendar_Weeks_7,m().Calendar_Weeks_1,m().Calendar_Weeks_2,m().Calendar_Weeks_3,m().Calendar_Weeks_4,m().Calendar_Weeks_5,m().Calendar_Weeks_6],months:[m().Calendar_Months_1,m().Calendar_Months_2,m().Calendar_Months_3,m().Calendar_Months_4,m().Calendar_Months_5,m().Calendar_Months_6,m().Calendar_Months_7,m().Calendar_Months_8,m().Calendar_Months_9,m().Calendar_Months_10,m().Calendar_Months_11,m().Calendar_Months_12],timePrefix:[m().Calendar_Time_AM,m().Calendar_Time_PM],eraNames:[m().Calendar_EraName_1,m().Calendar_EraName_2,m().Calendar_EraName_3,m().Calendar_EraName_4],earFirstYear:m().Calendar_FirstYear,today:m().Calendar_Today,lastMonth:m().Calendar_LastMonth,nextMonth:m().Calendar_NextMonth,lastYear:m().Calendar_LastYear,nextYear:m().Calendar_NextYear,lastTenYears:m().Calendar_LastTenYear,nextTenYears:m().Calendar_NextTenYear}},fe.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},U=fe,W=function(){this.yearTds=[]},V=function(){this.monthTds=[]},z=function(){this.weekThs=[],this.dayTds=[]},q=function(){this.calendarYearSection=new W,this.calendarMonthSection=new V,this.calendarDaySection=new z,this.timeItemLIs=[]},he.dateEqual=function(e,t,r){if(!e&&!t)return!0;if(!e)return!1;if(!t)return!1;try{return r?e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()&&e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds():e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}catch(e){return!1}},he.getMonthMaxDay=function(e,t){return-1!==[1,3,5,7,8,10,12].indexOf(t)?31:-1!==[4,6,9,11].indexOf(t)?30:e%4==0&&e%100!=0?29:28},he.isValidEraDate=function(e){return!(e<this.eraMin||e>this.eraMax)},he.addMilliseconds=function(e,t){var r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());return r.setMilliseconds(r.getMilliseconds()+t),new Date(r.valueOf())},he.getEraDate=function(e){var t,r={era:-1,eraYear:-1};if(!he.isValidEraDate(e))return r;for(t=0;t<he.eraCount;t++)if(e<(t+1!==he.eraCount?he.eraDates[t+1]:he.addMilliseconds(he.eraMax,1))){r.era=t,r.eraYear=e.getFullYear()-he.eraDates[t].getFullYear()+1;break}return r},he.getEraYearString=function(e){var t=new Date(e,5,30),r=he.getEraDate(t);return-1===r.era||-1===r.eraYear?""+e:e+""},he.getShortEraYearString=function(e){var t,r=new Date(e,11,31),n=he.getEraDate(r);return-1===n.era||-1===n.eraYear?"":(t=1===n.eraYear?U.resource.earFirstYear:n.eraYear,U.resource.eraNames[n.era]+t+"")},he.getDateLocaleLabel=function(e){var t=e.getHours(),r=e.getMinutes();return(t<12?U.resource.timePrefix[0]:U.resource.timePrefix[1])+" "+(0===t||12===t?"12":""+t%12)+":"+(r<10?"0"+r:""+r)},he.eraCount=4,he.eraMax=new Date(2087,11,31,23,59,59),he.eraMin=new Date(1868,8,8),he.eraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],Z=he,ce.prototype.getLabel=function(){return""+this.year},Y=ce,ue.prototype.getLabel=function(){return U.resource.shortMonths[this.month]},K=ue,le.prototype.getLabel=function(){return""+this.date.getDate()},X=le,se.getMonthName=function(e){return U.resource.months[e]},se.getShortMonthName=function(e){return U.resource.shortMonths[e]},se.prototype.updateDayItems=function(){var e,t,r,n,o,i,a;for(this.dayItems=[],e=this.focusDate.getFullYear(),t=this.focusDate.getMonth(),o=n=((r=new Date(e,t,1).getDay()-this.owner.rDb)<0?7+r:r)%7;0<o;o--)(i=new Date(e,t,1)).setDate(i.getDate()-o),a=new X(i,!1,!0,!1),this.dayItems.push(a);for(o=1;o<=42-n;o++)i=new Date(e,t,o),a=new X(i),i.getMonth()!==t&&(a.disabled=!0),Z.dateEqual(i,this.selectedDate)&&(a.selected=!0),Z.dateEqual(i,this.selectedDate)&&(a.selected=!0),Z.dateEqual(i,this.focusDate)&&(a.focused=!0),this.dayItems.push(a)},se.prototype.updateMonthItems=function(){var e,t,r=this.selectedDate,n=this.focusDate;for(this.monthItems=[],e=0;e<12;e++)(t=new K(e)).selected=r&&r.getMonth()===e&&r.getFullYear()===n.getFullYear(),t.focused=n&&n.getMonth()===e,this.monthItems.push(t)},se.prototype.updateYearItems=function(){var e,t;for(this.yearItems=[],e=this.focusDateYearRangeStart-1;e<=this.focusDateYearRangeEnd+1;e++)(t=new Y(e)).selected=this.selectedDate&&this.selectedDate.getFullYear()===e,t.focused=this.focusDate&&this.focusDate.getFullYear()===e,t.disabled=e<this.focusDateYearRangeStart||e>this.focusDateYearRangeEnd,this.yearItems.push(t)},se.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},se.prototype.getShortWeekName=function(e){return U.resource.shortWeeks[e=(this.owner.rDb+e-1)%7]},se.prototype.getCurrentMonthName=function(){var e=this.focusDate.getMonth();return se.getMonthName(e)},J=se,te=n.EventBase,ne(ae,te),Object.defineProperty(ae.prototype,"host",{get:function(){return this.tc.getContainer()},enumerable:!0,configurable:!0}),ae.prototype.createCalendarDom=function(){var e,t,r,n,o,i,a,s=this.tc;this.vDb=new q,(e=oe("div")).tabIndex=0,e.classList.add("gc-calendar-container"),s.JK?e.classList.add("gc-date-time-container"):e.classList.add("gc-date-container"),t=oe("table"),r=oe("tr"),(n=oe("td")).classList.add("gc-content-td-date"),s.JK&&n.classList.add("gc-content-td-time"),n.appendChild(this.wDb()),r.appendChild(n),t.appendChild(r),e.appendChild(t),s.JK&&(o=oe("tr"),i=oe("td"),n.appendChild(this.xDb()),n.appendChild(this.yDb()),i.appendChild(this.zDb()),i.appendChild(this.ADb()),o.appendChild(i),t.appendChild(o)),this.vDb.outterContainerDiv=e,(a=this.host)&&(a.innerHTML="",a.appendChild(e))},ae.prototype.ADb=function(){var e,t=oe("div");return t.classList.add("gc-ok-button-container"),(e=oe("button")).textContent="OK",e.className=L+" gc-cl-button-brand gc-uiButton",t.appendChild(e),this.vDb.okButton=e,t},ae.prototype.xDb=function(){var e=oe("div");return e.classList.add("gc-date-time-vertical-partline"),e},ae.prototype.zDb=function(){var e=oe("div");return e.classList.add("gc-date-time-horizontal-partline"),e},ae.prototype.wDb=function(){var e=oe("div");return e.className="gc-date-part-container "+A+" "+k,e.tabIndex=0,e.appendChild(this.BDb()),e.appendChild(this.CDb()),e.appendChild(this.DDb()),this.vDb.dateContainerDiv=e},ae.prototype.BDb=function(){var e=oe("div");return e.classList.add(f),e.appendChild(this.EDb()),e.appendChild(this.FDb()),e},ae.prototype.EDb=function(){var e,t,r,n,o,i,a,s=oe("div");return s.className=b+" "+M+" "+P,(e=oe("div")).className=I+" "+P+" "+E+" "+_,oe("div").classList.add(R),(t=oe("button")).className=L+" "+D,t.title=m().Calendar_LastTenYear,(r=oe("div")).classList.add(C),t.appendChild(r),(n=oe("span")).classList.add(R),(o=oe("button")).className=L+" "+D,o.title=m().Calendar_NextTenYear,(i=oe("div")).classList.add(w),o.appendChild(i),e.appendChild(t),e.appendChild(n),e.appendChild(o),(a=this.vDb.calendarYearSection).headerDiv=s,a.lastYearRangeButton=t,a.focusDateYearRangeName=n,a.nextYearRangeButton=o,s.appendChild(e),s},ae.prototype.FDb=function(){var e,t=oe("table");return t.className=h+" "+N,(e=oe("div")).appendChild(t),this.vDb.calendarYearSection.currentYearRangeTable=t,this.GDb(),e},ae.prototype.GDb=function(){var e,t,r,n,o,i=this.vDb.calendarYearSection,a=oe("tbody");for(e=0;e<3;e++){for(t=oe("tr"),r=0;r<4;r++)(n=oe("td")).setAttribute(O,""+(4*e+r)),(o=oe("span")).classList.add(F),o.setAttribute(O,""+(4*e+r)),o.innerText=""+(4*e+r+1),n.appendChild(o),t.appendChild(n),i.yearTds.push(n);a.appendChild(t)}i.currentYearRangeTable.appendChild(a)},ae.prototype.CDb=function(){var e=oe("div");return e.classList.add(d),e.appendChild(this.HDb()),e.appendChild(this.IDb()),e},ae.prototype.HDb=function(){var e,t,r,n,o,i,a,s=oe("div");return s.className=b+" "+M+" "+P,(e=oe("div")).className=I+" "+P+" "+E+" "+_,oe("div").classList.add(R),(t=oe("button")).className=L+" "+D,t.title=m().Calendar_LastYear,(r=oe("div")).classList.add(C),t.appendChild(r),(n=oe("span")).className=y+" "+R,(o=oe("button")).className=L+" "+D,o.title=m().Calendar_NextYear,(i=oe("div")).classList.add(w),o.appendChild(i),e.appendChild(t),e.appendChild(n),e.appendChild(o),(a=this.vDb.calendarMonthSection).headerDiv=s,a.lastYearButton=t,a.currentYearName=n,a.nextYearButton=o,s.appendChild(e),s},ae.prototype.IDb=function(){var e,t=oe("table");return t.className=h+" "+N,(e=oe("div")).appendChild(t),this.vDb.calendarMonthSection.currentYearTable=t,this.JDb(),e},ae.prototype.JDb=function(){var e,t,r,n,o,i=this.vDb.calendarMonthSection,a=oe("tbody");for(e=0;e<3;e++){for(t=oe("tr"),r=0;r<4;r++)(n=oe("td")).setAttribute(B,""+(4*e+r+1)),(o=oe("span")).classList.add(F),o.setAttribute(B,""+(4*e+r+1)),o.innerText=""+(4*e+r+1),n.appendChild(o),t.appendChild(n),i.monthTds.push(n);a.appendChild(t)}i.currentYearTable.appendChild(a)},ae.prototype.DDb=function(){var e=oe("div");return e.classList.add(p),e.appendChild(this.KDb()),e.appendChild(this.LDb()),e.appendChild(this.MDb()),e.appendChild(this.NDb()),e},ae.prototype.KDb=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g=oe("div");for(g.className=b+" "+M+" "+P,(e=oe("div")).className=I+" "+P+" "+E+" "+_,oe("div").classList.add(R),(t=oe("button")).className=L+" "+D,t.title=m().Calendar_LastMonth,(r=oe("div")).classList.add(C),t.appendChild(r),(n=oe("span")).className=y+" "+R,(o=oe("button")).className=L+" "+D,o.title=m().Calendar_NextMonth,(i=oe("div")).classList.add(w),o.appendChild(i),e.appendChild(t),e.appendChild(n),e.appendChild(o),(a=oe("div")).className="gc-year-select-div gc-cl-shrink-none",(s=oe("div")).classList.add(x),(l=oe("select")).classList.add("gc-cl-select"),c=(u=new Date).getFullYear()-this.tDb,h=u.getFullYear()+this.sDb,f=c;f<=h;f++)(d=oe("option")).text=""+f,d.value=""+f,l.options.add(d);return oe("div").classList.add(x),s.appendChild(l),a.appendChild(s),g.appendChild(a),g.appendChild(e),(p=this.vDb.calendarDaySection).headerDiv=g,p.lastMonthButton=t,p.currentMonthName=n,p.nextMonthButton=o,p.yearSelect=l,g},ae.prototype.LDb=function(){var e,t,r,n,o,i,a=oe("div");for(a.className="gc-week-container "+M+" "+P,(e=oe("table")).className=h+" "+N,t=oe("thead"),r=oe("tr"),n=0;n<7;n++)(o=oe("th")).setAttribute(j,""+n),(i=oe("span")).classList.add("gc-cl-week"),i.setAttribute(j,""+n),i.innerText=this.tc.aT.getShortWeekName(n),o.appendChild(i),r.appendChild(o),this.vDb.calendarDaySection.weekThs.push(o);return t.appendChild(r),e.appendChild(t),a.appendChild(e),a},ae.prototype.MDb=function(){var e,t,r,n,o,i,a=this.vDb.calendarDaySection,s=oe("div"),l=oe("div"),u=oe("table");for(u.className=h+" "+N,e=oe("tbody"),t=0;t<6;t++){for(r=oe("tr"),n=0;n<7;n++)(o=oe("td")).setAttribute(H,""+(7*t+n)),(i=oe("span")).classList.add(F),i.setAttribute(H,""+(7*t+n)),o.appendChild(i),r.appendChild(o),a.dayTds.push(o);e.appendChild(r)}return u.appendChild(e),l.appendChild(u),s.appendChild(l),a.dayContentTable=u,s},ae.prototype.NDb=function(){var e,t,r,n,o,i=oe("div");return i.classList.add("gc-today-container"),(e=oe("table")).classList.add(h),t=oe("tbody"),r=oe("tr"),n=oe("td"),(o=oe("a")).href="javascript:void(0);",o.className="gc-cl-show-inline-block gc-cl-p-bottom-x-small",o.innerText=U.resource.today,n.appendChild(o),r.appendChild(n),t.appendChild(r),e.appendChild(t),i.appendChild(e),this.vDb.calendarDaySection.todayTd=n,this.vDb.calendarDaySection.todayTable=e,i},ae.prototype.yDb=function(){var t=this,e=oe("div");return e.className="gc-time-part-container "+A+" "+k,e.tabIndex=0,this.vDb.timeContainerDiv=e,this.ODb=new o.TimePicker(e),this.ODb.setOptions({step:{minute:30},height:260}),this.ODb.on(i.BaseDropdown.Event_ValueChanged,function(e){t.PDb(e)}),e},ae.prototype.updateCalendarDom=function(){this.QDb(),this.tc.JK&&this.RDb()},ae.prototype.QDb=function(){switch(this.tc.aT.calendarPage){case l.CalendarPage.year:this.SDb();break;case l.CalendarPage.month:this.TDb();break;case l.CalendarPage.day:this.UDb()}},ae.prototype.VDb=function(){var e,t,r,n,o,i=this.tc.aT,a=this.vDb.calendarDaySection,s=!1;for(a.currentMonthName.innerText=i.getCurrentMonthName(),e=i.focusDate.getFullYear(),t=a.yearSelect,r=0;r<t.options.length;r++)if(""+e===t.options[r].value){t.selectedIndex=r,s=!0;break}n=this.sDb+this.tDb+1,s?t.options[n]&&t.selectedIndex<=n-1&&t.options[n].remove():((o=oe("option")).text=""+e,o.value=""+e,t.options[n]=o,t.selectedIndex=n)},ae.prototype.SDb=function(){var e,t,r,n,o,i,a,s,l=this.tc.aT,u=this.vDb.calendarYearSection;for(l.updateYearItems(),u.focusDateYearRangeName.innerText=l.focusDateYearRangeStart+" - "+l.focusDateYearRangeEnd,e=u.yearTds,t=l.yearItems,r=0;r<3;r++)for(n=0;n<4;n++)i=t[o=4*r+n],(s=(a=e[o]).querySelector("span")).innerText=i.getLabel(),i.disabled?a.classList.add(S):a.classList.remove(S),i.selected?a.classList.add(v):a.classList.remove(v),i.focused?s.classList.add(g):s.classList.remove(g)},ae.prototype.TDb=function(){var e,t,r,n,o,i,a,s,l,u=this.tc.aT,c=this.vDb.calendarMonthSection;for(u.updateMonthItems(),e=u.focusDate.getFullYear(),t=u.monthItems,r=c.monthTds,c.currentYearName.innerText=""+e,n=0;n<3;n++)for(o=0;o<4;o++)a=t[i=4*n+o],(l=(s=r[i]).querySelector("span")).innerText=a.getLabel(),a.selected?s.classList.add(v):s.classList.remove(v),a.focused?l.classList.add(g):l.classList.remove(g)},ae.prototype.UDb=function(){this.VDb(),this.WDb()},ae.prototype.WDb=function(){var e,t,r,n,o,i,a,s,l=this.tc.aT;for(l.updateDayItems(),e=l.dayItems,t=this.vDb.calendarDaySection.dayTds,r=0;r<6;r++)for(n=0;n<7;n++)i=e[o=7*r+n],(s=(a=t[o]).querySelector("span")).innerText=i.getLabel(),i.disabled?a.classList.add(S):a.classList.remove(S),i.focused?s.classList.add(g):s.classList.remove(g),i.selected?a.classList.add(v):a.classList.remove(v)},ae.prototype.RDb=function(){this.ODb.setValue(this.tc.aT.selectedDate)},ae.prototype.attachEvent=function(){this.XDb(),this.attachDateEvent(),this.tc.JK&&this.attachTimeEvent()},ae.prototype.XDb=function(){var t=this;this.vDb.outterContainerDiv.addEventListener("keydown",function(e){t.YDb(e)})},ae.prototype.YDb=function(e){return 9===e.keyCode?(this.tc.JK&&(this.tc.aT.calendarActivePart===G.Date?this.setCalendarActivePart(G.Time):this.setCalendarActivePart(G.Date)),void e.preventDefault()):void(this.tc.aT.calendarActivePart===G.Date&&this.ZDb(e))},ae.prototype.ZDb=function(e){switch(this.tc.aT.calendarPage){case l.CalendarPage.year:this.$Db(e);break;case l.CalendarPage.month:this._Db(e);break;case l.CalendarPage.day:this.aEb(e)}},ae.prototype.$Db=function(e){var t=this.tc.aT,r=t.focusDate;switch(e.keyCode){case 13:t.selectedDate=new Date(r.valueOf()),this.showCalendarPage(l.CalendarPage.month);break;case 32:t.selectedDate=new Date(r.valueOf());break;case 37:this.bEb();break;case 39:this.cEb();break;case 38:this.bEb(4);break;case 40:e.ctrlKey||e.metaKey?this.dEb():this.cEb(4);break;case 36:r.setFullYear(t.focusDateYearRangeStart);break;case 35:r.setFullYear(t.focusDateYearRangeEnd);break;case 33:this.eEb();break;case 34:this.fEb()}t.updateYearRange(),this.QDb()},ae.prototype._Db=function(e){var t=this.tc.aT,r=t.focusDate;switch(e.keyCode){case 13:t.selectedDate=new Date(r.valueOf()),this.showCalendarPage(l.CalendarPage.day);break;case 32:t.selectedDate=new Date(r.valueOf());break;case 37:this.gEb();break;case 39:this.hEb();break;case 38:e.ctrlKey||e.metaKey?this.iEb():this.gEb(4);break;case 40:e.ctrlKey||e.metaKey?this.jEb():this.hEb(4);break;case 36:r.setMonth(0);break;case 35:r.setMonth(11);break;case 33:this.bEb();break;case 34:this.cEb()}this.QDb()},ae.prototype.aEb=function(e){var t=this.tc.aT,r=t.focusDate,n=r.getFullYear(),o=r.getMonth(),i=r.getDate(),a=Z.getMonthMaxDay(n,o+1);switch(e.keyCode){case 13:return t.selectedDate=new Date(r.valueOf()),void this.lEb();case 32:t.selectedDate=new Date(r.valueOf());break;case 37:r.setDate(i-1);break;case 39:r.setDate(i+1);break;case 38:r.setDate(i-7);break;case 40:r.setDate(i+7);break;case 36:r.setDate(1);break;case 35:r.setDate(a);break;case 33:e.shiftKey?this.gEb(12):this.gEb();break;case 34:e.shiftKey?this.hEb(12):this.hEb()}t.selectedDate=new Date(r.valueOf()),this.QDb()},ae.prototype.attachDateEvent=function(){var r=this;this.vDb.dateContainerDiv.addEventListener("click",function(e){var t=e.target;t&&(t===r.vDb.calendarDaySection.yearSelect||t.parentElement===r.vDb.calendarDaySection.yearSelect)||r.setCalendarActivePart(G.Date)}),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},ae.prototype.attachYearEvent=function(){var t=this;this.vDb.calendarYearSection.lastYearRangeButton.addEventListener("click",function(e){t.eEb(),t.QDb()}),this.vDb.calendarYearSection.nextYearRangeButton.addEventListener("click",function(e){t.fEb(),t.QDb()}),this.vDb.calendarYearSection.currentYearRangeTable.addEventListener("click",function(e){t.mEb(e)})},ae.prototype.eEb=function(){var e=this.tc.aT;e.focusDateYearRangeStart-=10,e.focusDateYearRangeEnd=e.focusDateYearRangeStart+9,e.focusDate.setFullYear(e.focusDate.getFullYear()-10)},ae.prototype.fEb=function(){var e=this.tc.aT;e.focusDateYearRangeStart+=10,e.focusDateYearRangeEnd=e.focusDateYearRangeStart+9,e.focusDate.setFullYear(e.focusDate.getFullYear()+10)},ae.prototype.dEb=function(){this.showCalendarPage(l.CalendarPage.month)},ae.prototype.mEb=function(e){var t,r,n=e.srcElement||e.target;n&&(t=+n.getAttribute(O),r=this.tc.aT.yearItems[t],this.tc.aT.focusDate.setFullYear(r.year),this.dEb())},ae.prototype.attachMonthEvent=function(){var t=this;this.vDb.calendarMonthSection.lastYearButton.addEventListener("click",function(e){t.bEb(),t.QDb()}),this.vDb.calendarMonthSection.nextYearButton.addEventListener("click",function(e){t.cEb(),t.QDb()}),this.vDb.calendarMonthSection.currentYearName.addEventListener("click",function(e){t.iEb()}),this.vDb.calendarMonthSection.currentYearTable.addEventListener("click",function(e){t.nEb(e)})},ae.prototype.bEb=function(e){var t=e||1,r=Math.max(this.tc.aT.focusDate.getFullYear()-t,0);this.tc.aT.focusDate.setFullYear(r)},ae.prototype.cEb=function(e){var t=e||1,r=Math.min(this.tc.aT.focusDate.getFullYear()+t,9999);this.tc.aT.focusDate.setFullYear(r)},ae.prototype.iEb=function(){this.tc.aT.updateYearRange(),this.showCalendarPage(l.CalendarPage.year)},ae.prototype.jEb=function(){this.showCalendarPage(l.CalendarPage.day)},ae.prototype.nEb=function(e){var t,r=e.srcElement||e.target;r&&(t=+r.getAttribute(B),this.tc.aT.focusDate.setMonth(t-1),this.jEb())},ae.prototype.attachDayEvent=function(){var t=this,e=this.vDb.calendarDaySection;e.lastMonthButton.addEventListener("click",function(e){t.gEb(),t.uDb||t.QDb()}),e.nextMonthButton.addEventListener("click",function(e){t.hEb(),t.uDb||t.QDb()}),e.currentMonthName.addEventListener("click",function(e){t.oEb()}),e.todayTable.addEventListener("click",function(e){t.pEb()}),e.dayContentTable.addEventListener("click",function(e){t.qEb(e)}),e.yearSelect.addEventListener("change",function(e){t.rEb(e)}),this.vDb.calendarDaySection.yearSelect.addEventListener("keydown",function(e){e.stopPropagation()})},ae.prototype.gEb=function(e){var t,r,n=this.tc.aT,o=e||1,i=n.focusDate.getFullYear(),a=n.focusDate.getMonth()-o,s=n.focusDate.getDate();a<0&&(a+=12,--i),t=Z.getMonthMaxDay(i,a+1),r=new Date(i,a,Math.min(s,t)),n.focusDate=r},ae.prototype.hEb=function(e){var t,r,n=this.tc.aT,o=e||1,i=n.focusDate.getFullYear(),a=n.focusDate.getMonth()+o,s=n.focusDate.getDate();11<a&&(a-=12,i+=1),t=Z.getMonthMaxDay(i,a+1),r=new Date(i,a,Math.min(s,t),n.focusDate.getHours(),n.focusDate.getMinutes(),n.focusDate.getSeconds()),n.focusDate=r},ae.prototype.oEb=function(){this.showCalendarPage(l.CalendarPage.month)},ae.prototype.qEb=function(e){var t,r,n,o,i=this.tc.aT,a=e.srcElement||e.target;a&&(t=a.getAttribute(H),r=i.dayItems[+t].date,o=(n=i.selectedDate)?new Date(n.valueOf()):new Date,i.selectedDate=new Date(r.getFullYear(),r.getMonth(),r.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),o.getMilliseconds()),i.focusDate=new Date(i.selectedDate.valueOf()),this.QDb(),this.tc.JK||this.lEb()),this.vDb.dateContainerDiv.focus()},ae.prototype.pEb=function(){var e=this.tc,t=e.aT.selectedDate,r=t?new Date(t.valueOf()):null,n=new Date;r&&(n.setHours(r.getHours()),n.setMinutes(r.getMinutes()),n.setSeconds(0)),e.aT.selectedDate=n,e.aT.focusDate=new Date(n.valueOf()),this.QDb(),e.JK||this.lEb()},ae.prototype.rEb=function(e){var t=e.srcElement||e.target;t&&(this.tc.aT.focusDate.setFullYear(+t.value),this.updateCalendarDom())},ae.prototype.attachTimeEvent=function(){var t=this;this.vDb.timeContainerDiv.addEventListener("click",function(e){t.setCalendarActivePart(G.Time)}),this.vDb.okButton.addEventListener("click",function(e){t.lEb()})},ae.prototype.PDb=function(e){var t=this.tc.aT,r=t.selectedDate?new Date(t.selectedDate.valueOf()):new Date,n=e.value;r.setHours(n.getHours()),r.setMinutes(n.getMinutes()),r.setSeconds(n.getSeconds()),t.selectedDate=r,t.focusDate=new Date(r.valueOf())},ae.prototype.lEb=function(){var e=this.tc.aT;this.fire(i.BaseDropdown.Event_ValueChanged,{oldValue:e.oldSelectedData,newValue:e.selectedDate}),e.oldSelectedData=e.selectedDate},ae.prototype.showCalendarPage=function(e){var t=this.host.querySelector("."+f),r=this.host.querySelector("."+d),n=this.host.querySelector("."+p);switch(t.style.display="none",r.style.display="none",n.style.display="none",e){case l.CalendarPage.year:t.style.display="";break;case l.CalendarPage.month:r.style.display="";break;case l.CalendarPage.day:n.style.display=""}this.tc.aT.calendarPage=e,this.updateCalendarDom()},ae.prototype.setCalendarActivePart=function(e){switch(this.tc.aT.calendarActivePart=e,this.vDb.dateContainerDiv.classList.remove(T),this.tc.JK&&this.vDb.timeContainerDiv.classList.remove(T),e){case G.Date:this.tc.JK&&this.vDb.dateContainerDiv.classList.add(T),this.vDb.outterContainerDiv.focus();break;case G.Time:this.tc.JK&&this.vDb.timeContainerDiv.classList.add(T),this.vDb.outterContainerDiv.focus()}},ae.Event_GetHost="GetHost",Q=ae,ee=i.BaseDropdown,ne(ie,ee),ie.prototype.setOptions=function(e){var t,r;e&&(e.showTime||(this.JK=e.showTime,this._render.createCalendarDom(),this._render.attachEvent()),t=e&&e.calendarPage?e.calendarPage:l.CalendarPage.day,(r=e&&e.startDay?e.startDay:l.CalendarStartDay.saturday)!==this.rDb&&(this.rDb=r,this._host.innerHTML="",this._render.createCalendarDom(),this._render.attachEvent()),this._render.showCalendarPage(t),this._render.setCalendarActivePart(G.Date))},ie.prototype.setValue=function(e){var t=this.aT;t.selectedDate=e,t.oldSelectedData=new Date(e.valueOf()),t.focusDate=new Date(e.valueOf()),t.updateYearRange()},ie.prototype.scrollToSelect=function(){this._render.updateCalendarDom()},t.Calendar=ie},"./dist/plugins/celltype/editor/colorpicker.js":function(e,t,r){"use strict";var n,o,i,a,s,l,c,u,h,f,d,p=this&&this.__extends||(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function g(e,t){var r=d.call(this,e)||this;return r.ad(),r.setOptions(t),r}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/plugins/celltype/editor/listControl.js"),o=r("Core"),i=r("./dist/plugins/celltype/editor/baseControl.js"),a=r("./dist/plugins/celltype/celltypes.ns.js"),s=r("@grapecity/js-sheets-common"),l=s.Common.j.Fa,c="group-name",u=new s.Common.ResourceManager(a.SR),h=u.getResource.bind(u),d=i.BaseDropdown,p(g,d),g.prototype.setOptions=function(e){if(e){if(this.options=this.options||{},!l(e.colorBlockSize)){var t=parseInt(e.colorBlockSize,10);!isNaN(t)&&0<=t&&(this.options.colorBlockSize=e.colorBlockSize)}l(e.groups)||(this.options.groups=e.groups),this.VF()}else this.VF()},g.prototype.setValue=function(e){l(e)||(this.BYa=e,this.sEb=null,this.VF())},g.prototype.ad=function(){var e,t=this,r=g.DefaultColorGroup(),n=[];for(e=0;e<r.length;e++)n.push({name:r[e].name,colors:r[e].colors,needScaleColor:r[e].needScaleColor});this.options={colorBlockSize:g.DefaultCellWidth,groups:n},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-color-picker-outer-div"),this.tEb.addEventListener("click",function(e){t.uEb(e)}),this._host.appendChild(this.tEb)},g.prototype.VF=function(){this.tEb.innerHTML="",new n.List(this.tEb,this.vEb()),this.wEb()},g.prototype.wEb=function(){var e,t,r,n=this.tEb.querySelectorAll(".gc-color-picker-color-cell");if(0<n.length)for(e=0;e<n.length;e++)n[e].classList.remove("selected"),t=n[e].getAttribute("color"),r=n[e].getAttribute(c),this.BYa===t&&(!this.sEb||this.sEb&&this.sEb===r)&&n[e].classList.add("selected")},g.prototype.xEb=function(){var e,t,r,n,o=0,i=this.options.groups;for(e=0;e<i.length;e++)for(t=i[e],r=0;r<t.colors.length;r++)n=t.colors[r],o=Math.max(o,n.length);return o},g.prototype.vEb=function(){var e,t,r,n=[],o=this.options.colorBlockSize||g.DefaultCellWidth,i=this.xEb(),a=this.options.groups;for(e=0;e<a.length;e++)t=this.yEb(a[e],o,i),n.push(t),a[e].needScaleColor&&(r=this.zEb(a[e].colors[0]),n.push(this.yEb(r,o,i)));return{items:n}},g.prototype.zEb=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p={},g=[];t=[-(g.length=5),-15,-25,-35,-50],r=[-10,-25,-50,-75,-90],n=[80,60,40,-25,-50],o=document.createElement("span"),i=e.length,o.style.display="none",document.body.appendChild(o);try{for(a=0;a<i;a++)for(l=(s=this.AEb(e[a],o))[0],u=s[1],c=s[2],h=this.BEb(l,u,c),f=0;f<5;f++)g[f]||((d=[]).length=i,g[f]=d),g[f][a]=1===h?this.CEb(l,u,c,t[f]):.8<=h?this.CEb(l,u,c,r[f]):0===h?this.CEb(l,u,c,Math.abs(t[5-f-1])):h<=.2?this.CEb(l,u,c,Math.abs(r[5-f-1])):this.CEb(l,u,c,n[f]);p.colors=g}finally{document.body.removeChild(o)}return p},g.prototype.AEb=function(e,t){var r;return t.style.color=e,r=window.getComputedStyle(t).color.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)]},g.prototype.CEb=function(e,t,r,n){var o,i,a;return n/=100,o=this.DEb(e,t,r),i=parseInt(""+(0<n?(240-o.luminosity)*n:o.luminosity*n),10),a=this.EEb(o.hue,o.luminosity+i,o.saturation),this.FEb(a.r,a.g,a.b)},g.prototype.GEb=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},g.prototype.FEb=function(e,t,r){return"#"+this.GEb(e)+this.GEb(t)+this.GEb(r)},g.prototype.EEb=function(e,t,r){var n,o,i,a,s;return 0===r?n=o=i=parseInt(""+255*t/240,10):(a=2*t-(s=t<=120?(t*(240+r)+120)/240:t+r-(t*r+120)/240),n=parseInt(""+(255*this.fc(a,s,e+80)+120)/240,10),o=parseInt(""+(255*this.fc(a,s,e)+120)/240,10),i=parseInt(""+(255*this.fc(a,s,e-80)+120)/240,10)),{a:255,r:n,g:o,b:i}},g.prototype.fc=function(e,t,r){return r<0&&(r+=240),240<r&&(r-=240),r<40?e+((t-e)*r+20)/40:r<120?t:r<160?e+((t-e)*(160-r)+20)/40:e},g.prototype.BEb=function(e,t,r){return this.DEb(e,t,r).luminosity/240},g.prototype.DEb=function(e,t,r){var n,o,i,a,s,l=Math.max(Math.max(e,t),r),u=Math.min(Math.min(e,t),r),c=l+u,h=parseInt(""+(240*c+255)/510,10),f=l-u;return 0==f?(n=0,o=160):(n=h<=120?parseInt(""+(240*f+c/2)/c,10):parseInt(""+(240*f+(510-c)/2)/(510-c),10),i=(40*(l-e)+f/2)/f,a=(40*(l-t)+f/2)/f,s=(40*(l-r)+f/2)/f,(o=e===l?parseInt(""+(s-a),10):t===l?parseInt(""+(80+i-s),10):parseInt(""+(160+a-i),10))<0&&(o+=240),240<o&&(o-=240)),{luminosity:h,saturation:n,hue:o}},g.prototype.yEb=function(a,s,l){var u=this,e={items:function(){var e,t,r,n,o,i=document.createElement("div");for(i.classList.add("gc-color-picker-group-row"),i.style.width=(s+7)*l+"px",e=0;e<a.colors.length;e++){for((t=document.createElement("div")).classList.add("gc-color-picker-color-row"),r=a.colors[e],n=0;n<r.length;n++)(o=document.createElement("div")).setAttribute(c,a.name),o.setAttribute("color",r[n]),o.style.backgroundColor=r[n],o.style.width=s+"px",o.style.height=s+"px",o.classList.add("gc-color-picker-color-cell"),u.BYa===r[n]&&u.sEb===a.name&&o.classList.add("selected"),t.appendChild(o);i.appendChild(t)}return i},layout:{direction:o.LayoutDirection.horizontal,displayAs:o.LayoutDisplayAs.inline}};return a.name&&(e.text=a.name),e},g.prototype.uEb=function(e){var t,r,n=e.srcElement||e.target;n&&(t=n.getAttribute("color"),r=n.getAttribute(c),t&&r&&(this.BYa=t,this.sEb=r,this.HEb(t),this.wEb()))},g.prototype.HEb=function(e){this.fire(i.BaseDropdown.Event_ValueChanged,{value:e,text:e})},g.DefaultCellWidth=10,g.DefaultColorGroup=function(){return[{name:h().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:h().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},t.ColorPicker=g},"./dist/plugins/celltype/editor/eventbase.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.on=function(e,t){var r=this.IEb[e];null!=r||(r=this.IEb[e]=[]),r.push(t)},o.prototype.off=function(e,t){var r,n;if(e){if(null==(r=this.IEb[e]))return;t?(n=r.indexOf(t),r.splice(n,1)):r=[],this.IEb[e]=r}else this.IEb={}},o.prototype.fire=function(e,t){var r=this,n=this.IEb[e];null!=n&&n.forEach(function(e){try{e.call(r,t)}catch(e){}})},o);function o(){this.IEb={}}t.EventBase=n},"./dist/plugins/celltype/editor/listControl.js":function(e,t,r){"use strict";var l,u,s,d,p,h,n,o,i,g,m,a,b,y,C,c,f,w=this&&this.__extends||(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function v(e){return n.createElement(e)}function S(e,t){if(s.Common.k.Bb(e,t))return 1;if(s.Common.l.Ska(t))for(var r=0;r<e.length;r++)if(e[r]-t==0)return 1}function x(e,t,r){var n=f.call(this,e)||this;return n._host=v("div"),n._host.classList.add("gc-list-control"),e.appendChild(n._host),n.xn=new o,n.JJb=r&&r.JJb||{Qb:void 0},n.bHb={items:[],doms:[]},n.setOptions(t),n}function T(){this.JEb=new WeakMap}Object.defineProperty(t,"__esModule",{value:!0}),l=r("./dist/plugins/celltype/editor/popupControl.js"),u=r("./dist/plugins/celltype/editor/baseControl.js"),s=r("@grapecity/js-sheets-common"),d=r("Core"),p=s.Common.j.Fa,h=s.Common.k.Cb,n=document,T.prototype.set=function(e,t,r){var n=this.JEb.get(e);n||this.JEb.set(e,n={}),n[t]=r},T.prototype.get=function(e,t){var r=this.JEb.get(e);return r&&r[t]},T.prototype.clear=function(){this.JEb=new WeakMap},o=T,i="gc-list-control-container",g="gc-list-control-item",m="gc-list-control-hassubitem",a="gc-list-control-selected-item",b="gc-list-control-subitem",y="hide-children",C="gc-list-control-tree-content",f=u.BaseDropdown,w(x,f),x.prototype.setOptions=function(e){p(e)||(this.$z=function e(t){if(t.hasOwnProperty("items"))e(t.items);else if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r].hasOwnProperty("items")?e(t[r]):t[r].hasOwnProperty("text")&&!t[r].hasOwnProperty("value")&&(t[r].value=t[r].text);return t}(e),this._host.innerHTML="",this._render())},x.prototype.setValue=function(e){if(this.$z&&this.$z.multiSelect)if("string"==typeof e)e=function(e){var t,r,n,o,i,a,s;if(p(e)||0===e.length)return[];for(t=[],n=r=0;n<e.length;n++)"\\"===(o=e.charAt(n))?","!==(i=e.charAt(n+1))&&"\\"!==i||(s=n,e=(a=e).substring(0,s)+a.substring(s+1,a.length)):","===o&&(t.push(e.substring(r,n)),r=n+1);return t.push(e.substring(r,e.length)),t}(e);else if(p(e))e=[];else if(s.Common.j.Ca(e)){if(1!==this.$z.valueType){e=e.slice(0);for(var t=0;t<e.length;t++)e[t]=""+e[t]}}else e=[e];this.JJb.Qb=e,this.KEb()},x.prototype.scrollToSelect=function(){},x.prototype.updateStyle=function(e,t,r){this._host.style.font=r},x.prototype._render=function(){var e=v("div");e.classList.add(i),this.SXa(e,this.$z),this._host.appendChild(e),this.LXa()},x.prototype.SXa=function(e,t){if(t&&(this.LEb(e,t.layout),t.items))if(Array.isArray(t.items))this.MEb(e,t.items);else{var r=t.items();r instanceof HTMLElement&&(e.appendChild(r),e.classList.add(g),this.LEb(r,t.layout))}},x.prototype.LEb=function(e,t){t&&t.direction===d.LayoutDirection.horizontal?e.classList.add("gc-list-alignment-horizontal"):e.classList.add("gc-list-alignment-vertical")},x.prototype.MEb=function(e,t){var r,n,o,i,a,s,l,u,c,h,f=t.some(function(e){return!!e.icon});for(r=0;r<t.length;r++)t[r].items?(n=t[r]).layout&&n.layout.displayAs===d.LayoutDisplayAs.inline?((o=v("div")).classList.add("gc-list-control-group"),(i=v("span")).innerText=n.text,!p(n.text)&&""!==n.text||i.classList.add(y),i.classList.add("gc-list-control-group-text"),o.appendChild(i),Array.isArray(n.items)?this.SXa(o,n):(a=n.items())instanceof HTMLElement&&((s=v("div")).classList.add(g),this.LEb(a,n.layout),s.appendChild(a),o.appendChild(s)),e.appendChild(o)):n.layout&&n.layout.displayAs===d.LayoutDisplayAs.tree?((l=v("div")).classList.add("gc-list-control-tree"),(u=v("div")).classList.add(g),u.classList.add(m),(i=v("span")).innerText=n.text,i.classList.add("gc-list-control-tree-text"),u.appendChild(i),n.layout.collapsible&&((c=v("span")).classList.add(b),u.appendChild(c),this.NEb(u)),l.appendChild(u),(h=v("div")).classList.add(C),Array.isArray(n.items)?this.SXa(h,n):(a=n.items())instanceof HTMLElement&&((s=v("div")).classList.add(g),this.LEb(a,n.layout),s.appendChild(a),h.appendChild(s)),l.appendChild(h),e.appendChild(l)):this.OEb(e,t[r],!1,!0):this.OEb(e,t[r],f)},x.prototype.OEb=function(e,t,r,n){var o,i,a,s,l,u,c;void 0===n&&(n=!1),(o=v("div")).classList.add(g),"-"===t.text?(o.classList.add("gc-list-control-noitem"),(i=v("div")).classList.add("gc-list-control-listseparator"),o.appendChild(i)):(r&&((a=v("div")).classList.add("gc-list-control-item-icon"),t.icon?a.style.backgroundImage="url("+t.icon+")":a.classList.add("gc-list-control-emptyicon"),o.appendChild(a)),(s=v("span")).classList.add("gc-list-control-item-text"),s.innerText=t.text,p(t.text)&&(s.innerText=p(t.value)?"":t.value),o.appendChild(s),l=p(t.value)?null:t.value,(u=h(this.bHb.items,l))<0&&(u=this.bHb.items.length,this.bHb.doms.push([]),this.bHb.items.push(l)),this.bHb.doms[u].push(o),this.xn.set(o,"items",t),n&&((c=v("span")).classList.add(b),o.classList.add(m),this.xn.set(o,"sub-items",t),o.appendChild(c),this.PEb(o))),e.appendChild(o)},x.prototype.CHb=function(e,t){var r,n=this.bHb.doms[e];if(t)for(r=0;r<n.length;r++)n[r].classList.contains(m)||n[r].classList.add(a);else for(r=0;r<n.length;r++)n[r].classList.contains(a)&&n[r].classList.remove(a)},x.prototype.KEb=function(){var e,t,r,n=this.$z;for(e=p(this.formula)?n&&n.multiSelect?this.JJb.Qb:[this.JJb.Qb]:["="+this.formula],t=0;t<this.bHb.items.length;t++)r=this.bHb.items[t],n&&n.multiSelect&&1!==n.valueType&&(r=""+r),S(e,r)?this.CHb(t,!0):this.CHb(t,!1)},x.prototype.LXa=function(){var a=this;this._host.querySelector("."+i).addEventListener("click",function(e){var t,r,n,o,i=a.QEb(e.target,"."+g);if(i){if(i.classList.contains(m))return void a.KJb(e);t=a.xn.get(i,"items"),r=a.$z,!t&&s.Common.j.Aa(r&&r.onItemSelected)&&(t={value:r.onItemSelected(e)}),p(t)||(n=t.value,r&&r.multiSelect&&(o=(o=a.JJb.Qb).slice(0),r.multiSelect&&1!==r.valueType&&(n=""+n),S(o,n)?function(e,t){var r,n=s.Common.l.Ska(t);for(r=e.length-1;0<=r;r--)(e[r]===t||n&&e[r]-t==0)&&e.splice(r,1)}(o,n):s.Common.k.Sb(o,n),a.JJb.Qb=n=o,a.KEb(),1!==r.valueType&&(n=function(e){var t,r,n=[];for(t=0;t<e.length;t++)(r=e[t])&&"string"==typeof r&&(r=r.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),n[t]=r;return n.join(",")}(n))),a.fire(u.BaseDropdown.Event_ValueChanged,{value:n,text:n,notCloseDropDown:r&&r.multiSelect,noAutoFormat:!0}))}})},x.prototype.QEb=function(e,t){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),r=t.length;0<=r&&t.item(r)!==this;)--r;return-1<r});for(var r=e;r&&!r.matches(t);)r=r.parentElement;return r},x.prototype.KJb=function(e){var t,r,n,o,i,a=this,s=this.QEb(e.target,"."+g);!s.classList.contains(m)||(t=this.xn.get(s,"sub-items"))&&t.items&&(r=v("div"),n=this.$z,t.multiSelect=n&&n.multiSelect,t.valueType=n&&n.valueType,t.onItemSelected=n&&n.onItemSelected,(o=new x(r,t,this)).KEb(),(i=new l.PopupControl(r,s,{align:l.DropDownAlignment.Near,hostElement:s,direction:l.DropDownDirection.Right})).open(),r.parentElement.style.top="0",o.on(u.BaseDropdown.Event_ValueChanged,function(e){a.fire(u.BaseDropdown.Event_ValueChanged,e),a.$z&&a.$z.multiSelect?a.KEb():i.close()}),this.xn.set(s,"sub-items-popup",i),e.stopPropagation(),e.preventDefault())},x.prototype.PEb=function(e){var n=this;e.addEventListener("mouseenter",function(e){n.KJb(e)}),e.addEventListener("mouseleave",function(e){var t,r=e.target;!r.classList.contains(m)||(t=n.xn.get(r,"sub-items-popup"))&&(t.close(),n.xn.set(r,"sub-items-pop",void 0))})},x.prototype.NEb=function(e){var n=this;e.addEventListener("click",function(e){var t=e.target,r=n.QEb(t,"."+m);!r||r.parentElement.querySelector("."+C)&&(r.parentElement.classList.contains(y)?r.parentElement.classList.remove(y):r.parentElement.classList.add(y),e.stopPropagation(),e.preventDefault())})},t.List=x},"./dist/plugins/celltype/editor/monthPicker.js":function(e,t,r){"use strict";var c,n,h,a,o,l,i,f,d,p,g,m,s,u,b=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function y(e){return i.createElement(e)}function C(e,t){var r=u.call(this,e)||this;return r.setOptions(t),r.LXa(),r}Object.defineProperty(t,"__esModule",{value:!0}),c=r("./dist/plugins/celltype/editor/baseControl.js"),n=r("./dist/plugins/celltype/celltypes.ns.js"),h=r("@grapecity/js-sheets-common"),a=h.Common.j.Fa,o=new h.Common.ResourceManager(n.SR),l=o.getResource.bind(o),i=document,f="gc-month-picker-month-item",d="gc-month-picker-qtr-item",p="selected",g="data-month",m="data-qtr",u=c.BaseDropdown,b(C,u),C.prototype.setOptions=function(e){var t,r,n,o=new Date,i={startYear:o.getFullYear()-10,stopYear:o.getFullYear(),height:300};e&&(a(e.startYear)||(t=parseInt(e.startYear,10),isNaN(t)||(i.startYear=t)),!a(e.stopYear)&&0<e.stopYear&&(r=parseInt(e.stopYear,10),isNaN(r)||(i.stopYear=r)),i.stopYear<i.startYear&&(i.stopYear=e.startYear),a(e.height)||(n=parseInt(e.height,10),isNaN(n)||(i.height=n))),i.height=Math.max(1,i.height),this.$z=i,this._host.innerHTML="",this.REb()},C.prototype.setValue=function(e){var t,r,n;e&&(t=e.getMonth()+1,r=e.getFullYear()),"number"!=typeof t||(n=this._host.querySelector("["+g+"='"+r+"-"+t+"']"))&&(n.classList.add(p),this.SEb&&this.SEb.classList.remove(p),this.SEb=n)},C.prototype.scrollToSelect=function(){var e,t=this.SEb;t&&(e=t.offsetTop,this._host.scrollTop=e)},C.prototype.TEb=function(e,t){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),r=t.length;0<=r&&t.item(r)!==this;)--r;return-1<r});for(var r=e;r&&!r.matches(t);)r=r.parentElement;return r},C.prototype.LXa=function(){var u=this;this._host.addEventListener("click",function(e){var t,r,n,o,i,a,s=u,l=s.TEb(e.target,"."+f+",."+d);l&&(l.getAttribute(m)||(l.classList.add(p),s.SEb&&s.SEb.classList.remove(p),r=t=null,(s.SEb=l).getAttribute(g)&&(t=+(n=l.getAttribute(g).split("-"))[1],r=+n[0]),o=new Date(r,t-1,1,0,0,0,0),i=h.Common.CultureManager.q4().DateTimeFormat,a=new h.Formatter.GeneralFormatter(i.shortDatePattern).format(o),s.fire(c.BaseDropdown.Event_ValueChanged,{text:a,value:o})))})},C.prototype.REb=function(){var e,t,r,n,o=this;for(0<=this.$z.height?o._host.style.maxHeight=this.$z.height+"px":o._host.style.height="auto",o._host.classList.add("gc-month-picker-container"),e=o.$z.startYear;e<=o.$z.stopYear;e++)t=document.createElement("div"),o.UEb(t),(r=document.createElement("div")).classList.add("gc-month-picker-year-container"),o.VEb(e,r),(n=document.createElement("div")).classList.add("gc-month-picker-month-container"),o.WEb(e,1,n),o.WEb(e,2,n),o.WEb(e,3,n),o.WEb(e,4,n),t.appendChild(r),t.appendChild(n),this._host.appendChild(t)},C.prototype.UEb=function(e){var t=y("div");t.classList.add("gc-month-picker-separator"),e.appendChild(t)},C.prototype.VEb=function(e,t){var r=y("div");r.classList.add("gc-month-picker-year-item"),r.innerText=""+e,t.appendChild(r)},C.prototype.WEb=function(e,t,r){var n=document.createElement("div"),o=y("div"),i=y("div"),a=y("div"),s=y("div");switch(o.classList.add(f),i.classList.add(f),a.classList.add(f),s.classList.add(d),t){case 1:o.innerText=l().Calendar_ShortMonths_1,o.setAttribute(g,e+"-1"),i.innerText=l().Calendar_ShortMonths_2,i.setAttribute(g,e+"-2"),a.innerText=l().Calendar_ShortMonths_3,a.setAttribute(g,e+"-3"),s.innerText=l().Quarter_Format_1,s.setAttribute(m,e+"-1");break;case 2:o.innerText=l().Calendar_ShortMonths_4,o.setAttribute(g,e+"-4"),i.innerText=l().Calendar_ShortMonths_5,i.setAttribute(g,e+"-5"),a.innerText=l().Calendar_ShortMonths_6,a.setAttribute(g,e+"-6"),s.innerText=l().Quarter_Format_2,s.setAttribute(m,e+"-2");break;case 3:o.innerText=l().Calendar_ShortMonths_7,o.setAttribute(g,e+"-7"),i.innerText=l().Calendar_ShortMonths_8,i.setAttribute(g,e+"-8"),a.innerText=l().Calendar_ShortMonths_9,a.setAttribute(g,e+"-9"),s.innerText=l().Quarter_Format_3,s.setAttribute(m,e+"-3");break;case 4:o.innerText=l().Calendar_ShortMonths_10,o.setAttribute(g,e+"-10"),i.innerText=l().Calendar_ShortMonths_11,i.setAttribute(g,e+"-11"),a.innerText=l().Calendar_ShortMonths_12,a.setAttribute(g,e+"-12"),s.innerText=l().Quarter_Format_4,s.setAttribute(m,e+"-4")}n.appendChild(o),n.appendChild(i),n.appendChild(a),n.appendChild(s),r.appendChild(n),t<4&&this.UEb(r)},t.MonthPicker=C},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(e,t,r){"use strict";var u,l,n,c,o,i,a,h,s,f,d,p,g,m,b=this&&this.__extends||(g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function y(e,t){var o,i,r,n,a,s=e[0],l=[];if(h.isArray(s))for(i=function(e,t){var r=[];return t&&0<t.length?t.forEach(function(e){r.push(e.name)}):r=e.shift(),r}(o=e,t),r=function(e,t){var r=o[e],n={};i.forEach(function(e,t){n[e]=r[t]}),l.push(n)},n=0,a=o.length;n<a;n++)r(n);else l=e;return l}function C(e,t,r){return m.call(this,e,t,r)||this}Object.defineProperty(t,"__esModule",{value:!0}),u=r("Core"),l=r("SheetsCalc"),n=r("@grapecity/js-calc"),c=r("@grapecity/js-calc"),o=r("@grapecity/js-sheets-common"),i=r("./dist/plugins/celltype/editor/baseControl.js"),a=r("./dist/plugins/celltype/editor/baseSpreadPicker.js"),h=r("./node_modules/util/util.js"),s=r("./dist/plugins/celltype/celltypes.ns.js"),f=new o.Common.ResourceManager(s.SR),d=f.getResource.bind(f),p=!!n,m=a.BaseSpreadPicker,b(C,m),C.prototype.setOptions=function(e){var t,r,n,o,i,a,s,l;if(m.prototype.setOptions.call(this,e),(this.$z=e)&&(t=this.Ngc,r=e.dataSource,n=e.bindingInfos,o=t.getActiveSheet(),r)){i=!0,(l=o).suspendPaint(),l.suspendEvent(),l.suspendCalcService(),o.options.isProtected=!0,o.options.rowHeaderVisible=!1,o.selectionPolicy(u.SelectionPolicy.single),o.selectionUnit(u.SelectionUnit.row);try{this.Rgc(o,r,n)}catch(e){i=!1,this.dispose()}finally{i&&o&&((a=new u.Style).THb=!1,o.setStyle(-1,-1,a,u.SheetArea.viewport),(s=o).resumeCalcService(),s.resumeEvent(),s.resumePaint())}}},C.prototype.setValue=function(e){var t,r;this.$z&&(m.prototype.setValue.call(this,e),t=this.Ngc.getActiveSheet(),r=this.Sgc(e),t.setSelection(r,-1,1,-1))},C.prototype.dispose=function(){m.prototype.dispose.call(this)},C.prototype.Rgc=function(e,t,r){if(t){var n=this.Ugc(t);n&&(e.setDataSource(y(n,r)),r&&e.bindColumns(r))}},C.prototype.Ugc=function(e){var t,r,n,o,i,a=e,s=this.Lgc;if(h.isString(a)){if(p){if(r=l.formulaToExpression(s,a),n=s.getCalcService()._evaluateParsedFormula(s.yj(),r,c._createCellIdentity(0,0),!0),o=!1,i=void 0,(c.Convert._isReference(n)||c.Convert.Ca(n))&&((i=c.Convert.Ph(n,0,!1,!1,!1)).isError||i.isConvertError||(o=!0)),!o)throw Error(d().MultiColumn_InvalidDataSource);t=i}}else a instanceof u.Range?t=s.getArray(a.row,a.col,a.rowCount,a.colCount):h.isArray(a)&&(t=a);return t},C.prototype.Sgc=function(e){var t,r,n,o,i,a,s,l,u,c,h=0;if(e)for(t=this.Ngc.getActiveSheet(),n=(r=Object.keys(e)).length,i=(o=t.getDataSource()).length,a=!1,s=0;s<i;s++){for(l=o[s],u=0;u<n;u++){if(l[c=r[u]]!==e[c]){a=!1;break}a=!0}if(a){h=s;break}}return h},C.prototype.submitData=function(e){var t,r,n,o=e.sheet;e.isEsc?t={notSubmit:!0}:-1<(r=o.getSelections()[0].row)&&(t={value:n=o.getDataItem(r),text:n}),h.isNullOrUndefined(t)||this.fire(i.BaseDropdown.Event_ValueChanged,t)},t.MultiColumn=C},"./dist/plugins/celltype/editor/popupControl.js":function(e,t,r){"use strict";var n,x,T,A,k,o,i,a,s,l,u,c=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function h(e,t,r){var n=a.call(this,null)||this;return n.sourceElement=e,n.target=t,n.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:x.Down,align:T.Near,horAdj:A.Flip|A.Slide,verAdj:A.Flip|A.Slide},n.globalMousedownEventHandler=function(e){var t;if(n.cXa){for(t=e.target;t&&t!==n.sourceElement;)t=t.parentElement;t||(n.close(),e.stopPropagation(),e.preventDefault())}},n.windowResizeEventHandler=function(){n.cXa&&n.close()},n.$z=n.defaultOption,n.cXa=!1,r&&n.mergeOption(r),n.XEb=null===n.$z.hostElement||void 0===n.$z.hostElement||!(n.$z.hostElement instanceof HTMLElement),n}function f(e,t,r,n){this.XHa=e,this.YHa=t,this.Vo=r,this._v=n}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/plugins/celltype/editor/baseControl.js"),(u=x=t.DropDownDirection||(t.DropDownDirection={}))[u.Down=0]="Down",u[u.Up=1]="Up",u[u.Left=2]="Left",u[u.Right=3]="Right",(l=T=t.DropDownAlignment||(t.DropDownAlignment={}))[l.Near=0]="Near",l[l.Center=1]="Center",l[l.Far=2]="Far",(s=A=t.DropDownAdjustment||(t.DropDownAdjustment={}))[s.None=0]="None",s[s.Flip=1]="Flip",s[s.Slide=2]="Slide",f.CreateFromDom=function(e){return new f(e.left,e.top,e.width,e.height)},Object.defineProperty(f.prototype,"x",{get:function(){return this.XHa},set:function(e){this.XHa=e},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"y",{get:function(){return this.YHa},set:function(e){this.YHa=e},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"width",{get:function(){return this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"height",{get:function(){return this._v},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"left",{get:function(){return this.XHa},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"right",{get:function(){return this.XHa+this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"top",{get:function(){return this.YHa},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"bottom",{get:function(){return this.YHa+this._v},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Location",{get:function(){return{X:this.XHa,Y:this.YHa}},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Size",{get:function(){return{width:this.Vo,height:this._v}},enumerable:!0,configurable:!0}),f.prototype.Offset=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e];1===t.length&&"number"==typeof t[0].X&&"number"==typeof t[0].X?(this.XHa+=t[0].X,this.YHa+=t[0].Y):2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(this.XHa+=t[0],this.YHa+=t[1])},k=f,t.Rectangle=k,o="ribbon-dropdowngroup-popup",a=n.BaseControl,c(h,a),h.prototype.open=function(){this.cXa||(this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.cXa=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},h.prototype.beforeOpen=function(){this.bindEvent()},h.prototype.dispose=function(){var t=this;this.$z.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.$z.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(e){document.removeEventListener(e,t.globalMousedownEventHandler,!0)})),this.XEb?(this.sourceElement.classList.remove(o),this.sourceElement.style.display=this.YEb,this.sourceElement.style.position=this.xC):this.ZEb&&(this.$z.hostElement.removeChild(this.ZEb),this.ZEb=null)},h.prototype.close=function(){this.cXa&&(this.cXa=!1,this.dispose(),this.fire("close"))},h.prototype.mergeOption=function(e){for(var t in e)void 0!==e[t]&&(this.$z[t]=e[t])},h.prototype.clearPosition=function(){this.$Eb.style.top=this.$Eb.style.bottom=this.$Eb.style.left=this.$Eb.style.right=""},h.prototype.calcPosition=function(){var e,t,r,n,o,i,a,s,l;e=this.target instanceof k?this.target:k.CreateFromDom(this.target.getBoundingClientRect()),t=new k(0,0,window.innerWidth,window.innerHeight),r=this.calculateDropDownLocation(t,e,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.$z.direction,this.$z.align,this.$z.horAdj,this.$z.verAdj),o=(n=this.$Eb.offsetParent).getBoundingClientRect(),i=n===document.body,a=document.documentElement,s=(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),l=(window.pageYOffset||a.scrollTop)-(a.clientTop||0),this.$Eb.style.left=r.X-(i?-s:o.left)+"px",this.$Eb.style.top=r.Y-(i?-l:o.top)+"px"},h.prototype.calculateDropDownLocation=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S={X:e.x,Y:e.y};switch(e.Offset(-S.X,-S.Y),t.Offset(-S.X,-S.Y),s=t.left,l=t.right,u=t.top,c=t.bottom,h=u,f=e.height-c,d=s,p=e.width-l,g=(a&A.Flip)===A.Flip,m=(i&A.Flip)===A.Flip,b=(a&A.Slide)===A.Slide,y=(i&A.Slide)===A.Slide,n){case x.Up:r.height>h&&g&&(n=x.Down);break;case x.Down:r.height>f&&g&&(n=x.Up);break;case x.Left:r.width>d&&m&&(n=x.Right);break;case x.Right:r.width>p&&m&&(n=x.Left)}switch(w=C=0,n){case x.Up:w=u-r.height;break;case x.Down:w=c;break;case x.Left:C=s-r.width;break;case x.Right:C=l}return n===x.Up||n===x.Down?o===T.Near?C=s:o===T.Center?C=s-(r.width-t.width)/2:o===T.Far&&(C=l-r.width):n!==x.Right&&n!==x.Left||(o===T.Near?w=u:o===T.Center?w=u-(r.height-t.height)/2:o===T.Far&&(w=c-r.height)),v=new k(C,w,r.width,r.height),y&&(v.width>e.width?v.x=0:(v.x=Math.max(v.x,0),v.x=Math.min(v.x,e.width-v.width))),b&&(v.height>e.height?v.y=0:(v.y=Math.max(v.y,0),v.y=Math.min(v.y,e.height-v.height))),v.Offset(S),v.Location},h.prototype.render=function(){this.XEb?(this.xC=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.YEb=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(o),this.$Eb=this.sourceElement):(this.ZEb=document.createElement("div"),this.ZEb.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.ZEb.classList.add(o),this.ZEb.appendChild(this.sourceElement),this.$z.hostElement.appendChild(this.ZEb),this.$Eb=this.ZEb)},h.prototype.bindEvent=function(){var t=this;this.$z.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(e){document.addEventListener(e,t.globalMousedownEventHandler,!0)})),this.$z.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},t.PopupControl=h},"./dist/plugins/celltype/editor/slider.js":function(e,t,r){"use strict";var i,s,a,o,l,u,c,n,h,f,d,p,g,m,b,y=this&&this.__extends||(m=function(e,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function C(e){var t,r,n=(r=(t=e||0).toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/),t.toFixed(Math.max(0,(r[1]||"").length-parseInt(r[2],10)))),o=0;return 0<=n.indexOf(".")&&(o=n.length-n.indexOf(".")-1),o}function w(e,t){var n=b.call(this,e)||this;return n.MFb=u,n.NFb=u,n.XFb=u,n.YFb=function(e){c.pauseEvent(e),0===e.button&&(document.addEventListener("mouseup",n.ZFb,!1),document.addEventListener("pointerup",n.ZFb,!1),document.addEventListener("MSPointerUp",n.ZFb,!1),document.addEventListener("mousemove",n._Fb,!1),document.addEventListener("pointermove",n._Fb,!1),document.addEventListener("MSPointerMove",n._Fb,!1),n._Fb(e))},n._Fb=function(e){c.pauseEvent(e);var t=n.aGb(e);n.bGb!==t&&(n.setValue(t),n.$Fb.onChange(t))},n.ZFb=function(e){n._Fb(e),document.removeEventListener("mousemove",n._Fb),document.removeEventListener("mouseup",n.ZFb),document.removeEventListener("pointermove",n._Fb),document.removeEventListener("pointerup",n.ZFb),document.removeEventListener("MSPointerMove",n._Fb),document.removeEventListener("MSPointerUp",n.ZFb);var t=n.aGb(e);n.bGb=t,n.$Fb.onAfterChange(n.$Fb.value),n.fire(i.BaseDropdown.Event_ValueChanged,{value:t,text:""+t,notCloseDropDown:!0}),c.pauseEvent(e)},n.cGb=function(e){c.pauseEvent(e);var t=e.target||e.srcElement;document.addEventListener("touchend",n.dGb,!1),t.classList.contains(n.$Fb.prefixCls+"-handle")?document.addEventListener("touchmove",n.eGb,!1):n.eGb(e)},n.eGb=function(e){var t,r;c.pauseEvent(e),t=e.targetTouches[0],r=n.aGb(t),n.bGb!==r&&(n.setValue(r),n.$Fb.onChange(r))},n.dGb=function(e){var t,r;document.removeEventListener("touchmove",n.eGb),document.removeEventListener("touchend",n.dGb),t=e.changedTouches[0],r=n.aGb(t),n.bGb=r,n.$Fb.onAfterChange(n.$Fb.value),n.fire(i.BaseDropdown.Event_ValueChanged,{value:r,text:""+r,notCloseDropDown:!0}),c.pauseEvent(e)},n.init(t),n}function v(e,t,r,n){this.xo=e,this.MFb=t,this.NFb=r,this.$z=n,this.Tyb=u,this.OFb=u,this.Tyb=new h(this.PFb(),this.xo),this.OFb=new p(this.QFb(),this.xo)}function S(e,t){this.xo=t,this.IFb={},this.IFb=c.extend(this.IFb,e)}function x(e,t){this.xo=t,this.CFb={},this.DFb=!1,this.EFb=u,this.CFb=c.extend(this.CFb,e),this.EFb=new f(this.xo,this.FFb())}function T(e,t){this.xo=e,this.AFb={},this.exb="",this.AFb=c.extend(this.AFb,t),this.exb='\n        <div class="'+this.AFb.prefixCls+"-tooltip "+this.AFb.prefixCls+'-tooltip-placement-top">\n            <div class="'+this.AFb.prefixCls+'-tooltip-content">\n                <div class="'+this.AFb.prefixCls+'-tooltip-arrow"></div>\n                <div class="'+this.AFb.prefixCls+'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        '}function A(e,t){this.xo=t,this.xFb={},this.xFb=c.extend(this.xFb,e)}function k(e,t){this.xo=t,this.vFb={},this.vFb=c.extend(this.vFb,e)}function M(){}Object.defineProperty(t,"__esModule",{value:!0}),i=r("./dist/plugins/celltype/editor/baseControl.js"),s=r("@grapecity/js-sheets-common"),a=r("Core"),o=s.Common.j.Fa,l=s.Common.u.Ob,u=null,M.isEmpty=function(e){return void 0===e||e===u||""===e||Array.isArray(e)&&0===e.length},M.isEmptyObject=function(e){var t,r=!0;for(t in e)if(t){r=!1;break}return r},M.pauseEvent=function(e){e.stopPropagation(),e.preventDefault()},M.isObject=function(e){var t=typeof e;return"function"==t||"object"==t&&!!e},M.allKeys=function(e){var t,r=[];if(!M.isObject(e))return[];for(t in e)e.hasOwnProperty(t)&&r.push(t);return r},M.parseStyleObject=function(e){var t,r,n,o,i,a;if(!M.isObject(e))return"";for(t="",n=0,o=(r=M.allKeys(e)).length;n<o;n++)a=e[i=r[n]],t+=i.replace(/([A-Z])/g,"-$1").toLowerCase()+": "+a+"; ";return t.trim()},M.extend=function(e,t,r){var n,o,i,a,s;for(void 0===r&&(r={}),n=M.allKeys(e),i=0,a=(o=M.allKeys(t)).length;i<a;i++)r[s=o[i]]=t[s];for(i=0,a=n.length;i<a;i++)void 0===r[s=n[i]]&&(r[s]=e[s]);return r},M.noop=function(){},M.measureWidth=function(e,t){var r=0,n=document.createElement("span");n.classList.add(t);try{n.innerText=e,n.style.display="none",document.body.appendChild(n),r=a.GC$(n).width()}finally{document.body.removeChild(n)}return r},c=M,k.prototype.render=function(){var e,t;return this.vFb.included?(e=this.wFb(),(t=this.xo.querySelector("."+this.vFb.className))===u&&((t=document.createElement("div")).classList.add(""+this.vFb.className),this.xo.appendChild(t)),void t.setAttribute("style",c.parseStyleObject(e))):u},k.prototype.setLength=function(e){this.vFb.length=e,this.render()},k.prototype.wFb=function(){return this.vFb.direction===a.LayoutDirection.vertical?{bottom:this.vFb.offset+"%",height:this.vFb.length+"%"}:{left:this.vFb.offset+"%",width:this.vFb.length+"%"}},n=k,A.prototype.render=function(){var e,t,r,n,o=this.xo.querySelector("."+this.xFb.className);if(o===u){for((o=document.createElement("div")).className=""+this.xFb.className,t=0,r=(e=this.yFb()).length;t<r;t++)n=this.zFb(e[t]),o.appendChild(n);this.xo.appendChild(o)}},A.prototype.zFb=function(e){var t=document.createElement("span"),r=this.xFb.max-this.xFb.min,n=Math.abs(e-this.xFb.min)/r*100+"%",o=this.xFb.direction===a.LayoutDirection.vertical?{bottom:n}:{left:n};return t.classList.add(this.xFb.prefixCls+"-dot"),t.setAttribute("style",c.parseStyleObject(o)),t.setAttribute("key",""+e),t},A.prototype.yFb=function(){var e,t,r=Object.keys(this.xFb.marks).map(function(e){return+e});if(r.sort(function(e,t){return e-t}),e=r,this.xFb.dots)for(t=this.xFb.min;t<=this.xFb.max;t+=this.xFb.step)-1===e.indexOf(t)&&e.push(t);return e},h=A,T.prototype.render=function(e,t){var r,n,o,i,a;this.AFb.offset=e,r=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip"),n=new s.Formatter.GeneralFormatter(this.AFb.formatString).format(t),c.isEmpty(r)&&(o=l(n),this.exb=this.exb.replace(/{{value}}/,o),(i=document.createElement("div")).innerHTML=this.exb,this.xo.appendChild(i.firstElementChild),r=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip")),r.querySelector("."+this.AFb.prefixCls+"-tooltip-inner").textContent=n,a=this.BFb(n),r.setAttribute("style",c.parseStyleObject(a)),this.AFb.tooltipVisible?this.show():this.hide()},T.prototype.show=function(){var e=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");c.isEmpty(e)||(e.style.display="inline-block")},T.prototype.hide=function(){var e=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");c.isEmpty(e)||(e.style.display="none")},T.prototype.BFb=function(e){var t=c.measureWidth(e,this.AFb.prefixCls+"-tooltip");return t=0===t?12:t/2+4,this.AFb.direction===a.LayoutDirection.vertical?{left:"-"+t+"px",bottom:"calc("+this.AFb.offset+"% + 10px)"}:{top:"-28px",left:"calc("+this.AFb.offset+"% - "+(t+4)+"px)"}},f=T,x.prototype.render=function(){var e,t=this,r=this.GFb(),n=this.BFb(),o=this.CFb.tabIndex||0;!this.CFb.disabled&&o!==u||(o=u),(e=this.xo.querySelector("."+this.CFb.className))===u&&((e=document.createElement("div")).className=r,this.xo.appendChild(e),e.setAttribute("role","slider"),e.setAttribute("aria-valuemin",""+this.CFb.min),e.setAttribute("aria-valuemax",""+this.CFb.max),e.setAttribute("aria-valuenow",""+this.CFb.value),e.setAttribute("aria-disabled",this.CFb.disabled+""),e.addEventListener("blur",function(){t.HFb(!1)}),e.addEventListener("mouseenter",function(){t.EFb.show()}),e.addEventListener("keydown",function(){t.HFb(!1)}),e.addEventListener("mousedown",function(){e.focus(),t.EFb.show()}),document.addEventListener("mouseup",function(){document.activeElement===e&&(t.HFb(!0),t.EFb.hide())})),e.tabIndex=o,e.setAttribute("style",c.parseStyleObject(n))},x.prototype.setOffset=function(e,t){this.CFb.offset=e,this.render(),this.EFb.render(e,t)},x.prototype.HFb=function(e){this.DFb=e},x.prototype.GFb=function(){return this.DFb?this.CFb.className+" "+this.CFb.prefixCls+"-handle-click-focused":""+this.CFb.className},x.prototype.BFb=function(){return this.CFb.direction===a.LayoutDirection.vertical?{bottom:this.CFb.offset+"%"}:{left:this.CFb.offset+"%"}},x.prototype.FFb=function(){return{prefixCls:"gc-slider",tooltipVisible:this.CFb.tooltipVisible,direction:this.CFb.direction,offset:this.CFb.offset,formatString:this.CFb.formatString}},d=x,S.prototype.render=function(){var e,t,r,n,o,i=this.xo.querySelector("."+this.IFb.className);if(i===u){for((i=document.createElement("div")).className=""+this.IFb.className,e=this.JFb(),this.LJb(e),t=0,r=e.length;t<r;t++)n=e[t],(o=this.KFb(n))!==u&&i.appendChild(o);this.xo.appendChild(i)}},S.prototype.LJb=function(e){var t,r,n,o;for(this.MJb=0,t=1,r=e.length;t<r;t++)(n=this.IFb.marks[e[0]])&&(o=c.measureWidth(n.label,this.IFb.className+"-text"),(!this.MJb||this.MJb<o)&&(this.MJb=o))},Object.defineProperty(S.prototype,"maxWidth",{get:function(){return this.MJb},enumerable:!0,configurable:!0}),S.prototype.JFb=function(){return c.allKeys(this.IFb.marks).sort(function(e,t){return e-t})},S.prototype.KFb=function(t){var e,r,n,o,i=this,a=this.IFb.marks[t],s=c.isObject(a)?a.label:a;return c.isEmptyObject(s)?u:(e=this.IFb.className+"-text",r=this.LFb(t),n=c.extend(r,a.style),(o=document.createElement("span")).classList.add(e),o.setAttribute("style",c.parseStyleObject(n)),o.setAttribute("key",""+t),o.addEventListener("mousedown",function(e){i.IFb.onClickLabel(e,t)}),o.innerHTML=l(s),o)},S.prototype.LFb=function(e){var t=this.IFb.max-this.IFb.min;return this.IFb.direction===a.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(e-this.IFb.min)/t*100+"%"}:{left:(e-this.IFb.min)/t*100+"%",transform:"translateX(-50%)"}},p=S,v.prototype.render=function(){var e=document.createElement("div");e.className=this.$z.prefixCls+"-rail",this.xo.appendChild(e),this.MFb.render(),this.Tyb.render(),this.NFb.render(),this.OFb.render(),this.OFb.maxWidth&&this.$z.direction===a.LayoutDirection.vertical&&(this.xo.style.paddingRight=this.OFb.maxWidth+"px")},v.prototype.calcValueByPosition=function(e){var t=e-this.RFb();return this.trimAlignValue(this.SFb(t))},v.prototype.trimAlignValue=function(e){return c.isEmpty(e)?u:this.TFb(e)},v.prototype.calcOffset=function(){return Math.max(this.$z.value-this.$z.min,0)/(this.$z.max-this.$z.min)*100},v.prototype.getKeyboardValueMutator=function(e){var t=this;switch(e.keyCode){case 38:case 39:return function(e){return t.calculateNextValue("increase",e)};case 40:case 37:return function(e){return t.calculateNextValue("decrease",e)};case 35:return function(e){return t.$z.max};case 36:return function(e){return t.$z.min}}},v.prototype.calculateNextValue=function(e,t){var r={increase:function(e,t){return e+t},decrease:function(e,t){return e-t}},n=Object.keys(this.$z.marks).indexOf(t+""),o=r[e](n,1),i=Object.keys(this.$z.marks)[o];return this.$z.step?r[e](t,this.$z.step):!c.isEmptyObject(this.$z.marks)&&this.$z.marks[i]?this.$z.marks[i]:t},v.prototype.TFb=function(e){var t=isFinite(this.UFb(e))?this.UFb(e):0;return this.$z.step===u?t:parseFloat(t.toFixed(this.Yrb()))},v.prototype.Yrb=function(){var e,t;if(o(this.$z.precision)){for(t in e=Math.max(C(this.$z.max),C(this.$z.min),C(this.$z.step)),this.$z.marks)e=Math.max(C(parseFloat(t)),e);this.$z.precision=e}return this.$z.precision},v.prototype.UFb=function(t){var e,r,n,o,i=Object.keys(this.$z.marks).map(parseFloat);return this.$z.step!==u&&(e=Math.ceil((this.$z.max-this.$z.min)/this.$z.step),r=Math.min((t-this.$z.min)/this.$z.step,e),n=Math.round(r)*this.$z.step+this.$z.min,i.push(Math.min(n,this.$z.max))),o=i.map(function(e){return Math.abs(t-e)}),i[o.indexOf(Math.min.apply(Math,o))]},v.prototype.PFb=function(){return{prefixCls:this.$z.prefixCls,className:this.$z.prefixCls+"-step",direction:this.$z.direction,marks:this.$z.marks,dots:this.$z.dots,step:this.$z.step,included:this.$z.included,max:this.$z.max,min:this.$z.min}},v.prototype.QFb=function(){var r=this;return{className:this.$z.prefixCls+"-mark",onClickLabel:this.$z.disabled?c.noop:function(e,t){r.VFb(e,t)},direction:this.$z.direction,marks:this.$z.marks,included:this.$z.included,max:this.$z.max,min:this.$z.min}},v.prototype.VFb=function(e,t){},v.prototype.RFb=function(){var e=this.xo.getBoundingClientRect();return this.$z.direction===a.LayoutDirection.vertical?e.top:e.left},v.prototype.WFb=function(){var e=this.xo.getBoundingClientRect();return this.$z.direction===a.LayoutDirection.vertical?e.height:e.width},v.prototype.SFb=function(e){var t=this.$z.min,r=this.$z.max,n=Math.abs(Math.max(e,0)/this.WFb());return this.$z.direction===a.LayoutDirection.vertical&&(n=Math.max(1-n,0)),n*(r-t)+t},g=v,b=i.BaseDropdown,y(w,b),w.prototype.setValue=function(e){if(!this.$Fb.disabled){var t=parseFloat(e);t=isNaN(t)?this.$Fb.min:(t=Math.max(this.$Fb.min,t),Math.min(this.$Fb.max,t)),this.$Fb.value=t,this.bGb=this.$Fb.value,this.MFb.setLength(this.calcOffset()),this.NFb.setOffset(this.calcOffset(),t)}},w.prototype.calcOffset=function(){var e=Math.max(this.$Fb.value-this.$Fb.min,0)/(this.$Fb.max-this.$Fb.min);return 100*(e=Math.min(e,1))},w.prototype.setOptions=function(e){this.init(e)},w.prototype.init=function(e){var t,r;this.fGb(e),this.gGb(),this._host.innerHTML="",(t=document.createElement("div")).className="gc-slider-container",this._host.appendChild(t),this.$Fb.direction===a.LayoutDirection.vertical?(t.classList.add(this.$Fb.prefixCls+"-vertical"),t.style.height=this.$Fb.height+"px"):t.style.width=this.$Fb.width+"px",(r=document.createElement("div")).className=this.GFb(),t.appendChild(r),this.MFb=new n(this.hGb(),r),this.NFb=new d(this.iGb(),r),this.XFb=new g(r,this.MFb,this.NFb,this.jGb()),this.XFb.render(),this.QQ(r)},w.prototype.QQ=function(e){var o=this;this.$Fb.disabled||(e.addEventListener("mousedown",this.YFb),e.addEventListener("pointerdown",this.YFb),e.addEventListener("MSPointerDown",this.YFb),e.addEventListener("touchstart",this.cGb),e.addEventListener("keyup",function(e){var t,r,n;if(c.pauseEvent(e),t=o.XFb.getKeyboardValueMutator(e),!c.isEmpty(t)){if(r=t(o.$Fb.value),(n=o.XFb.trimAlignValue(r))===o.$Fb.value)return;o.setValue(n),o.$Fb.onChange(n),o.$Fb.onAfterChange(n),o.fire(i.BaseDropdown.Event_ValueChanged,{value:n,text:""+n,notCloseDropDown:!0})}}))},w.prototype.aGb=function(e){return this.$Fb.direction===a.LayoutDirection.vertical?this.XFb.calcValueByPosition(e.clientY):this.XFb.calcValueByPosition(e.clientX)},w.prototype.sYa=function(){function e(e){}return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:a.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:e,onAfterChange:e,formatString:"General"}},w.prototype.gGb=function(){(c.isEmpty(this.$Fb)||c.isEmptyObject(this.$Fb))&&(this.$Fb={}),this.$Fb=c.extend(this.sYa(),this.$Fb)},w.prototype.fGb=function(e){var n=this;e&&(o(e.scaleVisible)||(this.$Fb.dots=e.scaleVisible),o(e.direction)||(this.$Fb.direction=e.direction),o(e.formatString)||(this.$Fb.formatString=e.formatString),this.kGb(e.min,"min"),this.kGb(e.max,"max"),this.kGb(e.step,"step"),this.kGb(e.width,"width"),this.kGb(e.height,"height"),this.$Fb.step<=0&&(this.$Fb.step=1),this.$Fb.min>this.$Fb.max&&(this.$Fb.max=this.$Fb.min),o(e.tooltipVisible)||(this.$Fb.tooltipVisible=e.tooltipVisible),this.$Fb.marks={},e.marks&&e.marks.forEach(function(e){var t,r=parseFloat(e);isNaN(r)||r>=n.$Fb.min&&r<=n.$Fb.max&&(t=new s.Formatter.GeneralFormatter(n.$Fb.formatString),n.$Fb.marks[r]={label:t.format(r)})}))},w.prototype.kGb=function(e,t){if(!o(e)){var r=parseFloat(e);isNaN(r)||(this.$Fb[t]=r)}},w.prototype.hGb=function(){return{className:this.$Fb.prefixCls+"-track",included:this.$Fb.included,direction:this.$Fb.direction,offset:0,length:0}},w.prototype.iGb=function(){return{prefixCls:this.$Fb.prefixCls,className:this.$Fb.prefixCls+"-handle",direction:this.$Fb.direction,disabled:this.$Fb.disabled,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,offset:0,tabIndex:0,tooltipVisible:this.$Fb.tooltipVisible,formatString:this.$Fb.formatString}},w.prototype.jGb=function(){return{prefixCls:this.$Fb.prefixCls,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,disabled:this.$Fb.disabled,direction:this.$Fb.direction,dots:this.$Fb.dots,step:this.$Fb.step,included:this.$Fb.included,marks:this.$Fb.marks}},w.prototype.GFb=function(){var e=""+this.$Fb.prefixCls;return this.$Fb.direction===a.LayoutDirection.vertical&&(e+="  "+this.$Fb.prefixCls+"-vertical"),c.isEmptyObject(this.$Fb.marks)||(e+=" "+this.$Fb.prefixCls+"-with-marks"),this.$Fb.disabled&&(e+=" "+this.$Fb.prefixCls+"-disabled"),e},t.Slider=w},"./dist/plugins/celltype/editor/timepicker.js":function(e,t,r){"use strict";var n,l,o,u,i,a,s,c=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function h(e,t){var r=s.call(this,e)||this;return r.ad(),r.setOptions(t),r}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/plugins/celltype/editor/listControl.js"),l=r("./dist/plugins/celltype/editor/baseControl.js"),o="undefined",u=r("@grapecity/js-sheets-common"),i=u.Common.j.Fa,s=l.BaseDropdown,c(h,s),h.prototype.setOptions=function(e){var t,r,n,o;return e&&(null!==(t=this.pGb(e.min))&&(this.$z.min=t),null!==(r=this.pGb(e.max))&&(this.$z.max=r),null!==(n=this.pGb(e.step))&&(this.$z.step=n),i(e.formatString)||(this.$z.formatString=e.formatString),i(e.height)||(o=parseInt(e.height,10),isNaN(o)||(this.$z.height=o)),this.$z.height=Math.max(1,this.$z.height)),void this.VF()},h.prototype.setValue=function(e){void 0!==e&&(this.KEb={hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds()},this.cHb=e,this.wEb(),this.scrollToSelect())},h.prototype.scrollToSelect=function(){var e,t=this.tEb.querySelector(".selected");null!==t&&(e=t.offsetTop,this.xo.scrollTop=e)},h.prototype.ad=function(){var t=this;this.$z={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-time-picker-outer-div"),this.tEb.addEventListener("click",function(e){t.uEb(e)}),this._host.appendChild(this.tEb)},h.prototype.pGb=function(e){var t,r,n,o=null;return i(e)||(o={},i(e.hour)||(t=parseInt(e.hour,10),isNaN(t)||(o.hour=t)),i(e.minute)||(r=parseInt(e.minute,10),isNaN(r)||(o.minute=r)),i(e.second)||(n=parseInt(e.second,10),isNaN(n)||(o.second=n))),o},h.prototype.VF=function(){this.tEb.innerHTML="",new n.List(this.tEb,this.qGb()),this.wEb()},h.prototype.wEb=function(){var e,t,r,n,o=this.tEb.querySelectorAll(".gc-time-picker-li");if(0<o.length)for(e=0;e<o.length;e++)o[e].classList.remove("selected"),t=+o[e].getAttribute("hour"),r=+o[e].getAttribute("minute"),n=+o[e].getAttribute("second"),this.rGb(this.KEb,{hour:t,minute:r,second:n})&&o[e].classList.add("selected")},h.prototype.qGb=function(){var o=this;return{items:function(){var e,t,r=o.sGb(),n=document.createElement("div");for(n.classList.add("gc-time-picker-container"),o.xo=n,o.$z.height<0?n.style.height="auto":n.style.maxHeight=o.$z.height+"px",(e=document.createElement("ul")).classList.add("gc-time-picker-ul"),t=0;t<r.length;t++)e.appendChild(o.tGb(r[t]));return 24*r.length>o.$z.height&&0<=o.$z.height?n.style.overflowY="scroll":n.style.overflowY="hidden",n.appendChild(e),n}}},h.prototype.tGb=function(e){var t=document.createElement("li");return t.classList.add("gc-time-picker-li"),t.setAttribute("hour",""+e.hour),t.setAttribute("minute",""+e.minute),t.setAttribute("second",""+e.second),t.innerText=this.uGb(e),t},h.prototype.sGb=function(){for(var e=this.vGb(this.$z.min),t=this.vGb(this.$z.max),r=[];e<=t;)r.push({hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds()}),e=this.wGb(e,this.$z.step);return r},h.prototype.wGb=function(e,t){return typeof t.hour!=o&&e.setHours(e.getHours()+t.hour),typeof t.minute!=o&&e.setMinutes(e.getMinutes()+t.minute),typeof t.second!=o&&e.setSeconds(e.getSeconds()+t.second),e},h.prototype.uGb=function(e){var t,r=new Date;return r.setHours(e.hour),r.setMinutes(e.minute),r.setSeconds(e.second),(t=new u.Formatter.GeneralFormatter(this.$z.formatString).format(r))&&""!==t&&null!==t?t:this.xGb(r)},h.prototype.xGb=function(e){var t=e.getHours(),r=e.getMinutes();return(t<12?"AM":"PM")+" "+(0===t||12===t?"12":""+t%12)+":"+(r<10?"0"+r:""+r)},h.prototype.vGb=function(e){var t=new Date;return t.setHours(e.hour||0),t.setMinutes(e.minute||0),t.setSeconds(e.second||0),t},h.prototype.rGb=function(e,t){return!(!e||!t)&&(e=this.yGb(e),t=this.yGb(t),e.hour===t.hour&&e.minute===t.minute&&e.second===t.second)},h.prototype.yGb=function(e){return{hour:e.hour||0,minute:e.minute||0,second:e.second||0}},h.prototype.uEb=function(e){var t,r,n,o,i,a,s=e.target;s&&(t=+s.getAttribute("hour"),r=+s.getAttribute("minute"),n=+s.getAttribute("second"),(o=this.cHb||new Date).setHours(t),o.setMinutes(r),o.setSeconds(n),o.setMilliseconds(0),i=u.Common.CultureManager.q4().DateTimeFormat,a=new u.Formatter.GeneralFormatter(i.shortDatePattern+" h:mm:ss").format(o),this.fire(l.BaseDropdown.Event_ValueChanged,{value:o,text:a}),this.KEb={hour:t,minute:r,second:n},this.wEb())},t.TimePicker=h},"./dist/plugins/celltype/editor/workflowPicker.js":function(e,t,r){"use strict";var n,o,i,s,a,l,u=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function c(e,t){var r=l.call(this,e)||this;return r.FP=new o.List(e),r.FP.on(n.BaseDropdown.Event_ValueChanged,function(e){r.fire(n.BaseDropdown.Event_ValueChanged,e)}),r.setOptions(t),r}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/plugins/celltype/editor/baseControl.js"),o=r("./dist/plugins/celltype/editor/listControl.js"),i=r("@grapecity/js-sheets-common"),s=i.Common.j.Fa,l=n.BaseDropdown,u(c,l),c.prototype.setOptions=function(e){this.$z=e},c.prototype.setValue=function(e){if(this.$z){var t=function(e,t){var r,n,o={items:[]},i=e.items,a=i.filter(function(e){return e.value===t})[0];if(s(a)&&i&&0<i.length)o.items.push({text:i[0].value,value:i[0].value});else if(a&&a.transitions&&0<a.transitions.length)for(r=function(e){var t,r=a.transitions[e];"number"==typeof r&&i[r]&&(r=i[r].value),(t=i.filter(function(e){return e.value===r})[0])&&o.items.push({text:t.value,value:t.value})},n=0;n<a.transitions.length;n++)r(n);return o}(this.$z,e);this.FP.setOptions(t)}},c.prototype.updateStyle=function(e,t,r){this.FP.updateStyle(e,t,r)},t.WorkFlow=c},"./dist/plugins/celltype/hyperlinkcelltype.js":function(e,t,r){"use strict";var n,T,o,v,i,a,A,s,l,k,M,u,c,I,C,E,h,R,f,d,p,g,m,b=this&&this.__extends||(p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function y(){var r,e=g.call(this)||this;return e.typeName="8",(r=e).yn=e.wK(),c(f,function(e,t){r["_"+e]=t}),e._onAction=function(e){var t=e&&e.sheet,r=e.row,n=e.col,o=e.sheetArea,i=t.getValue(r,n,o),a=["_blank","_self","_parent","_top"][this._target];i&&h(s(i),a)},e}function D(e,t,r,n,o,i){var a=0,s=0,l=e.width,u=e.height;return a=i=i||0,1===n?a=(l-t)/2:2===n&&(a=l-t-i),1===o?s=(u-r)/2:2===o&&(s=u-r),{x:a,y:s}}function S(e,t,r,n){var o=x(e,r),i=o.width;return i+=1==(1!==t&&!A(n))?n:0,o.width=i,o}function w(e,t,r,n,o,i){var a=x(e,n),s=D(o,a.width,a.height,t,r,i);return a.x=s.x,a.y=s.y,a}function x(e,t){var r=l(t);return{x:0,y:0,width:Math.max(0,T.Vn.Xn(e,t,!0)),height:e.split(/\r\n|\r|\n/).length*r}}function N(e){return 8*(e.textIndent||0)}function F(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=n&&n.sheet;if(w){if(s=w._render,l=t.font||s.Bl(),1<r&&(l=s.Cl(l)),u=N(t),t.wordWrap||o){if(t.wordWrap){if(c=n.row,h=n.col,f=n.sheetArea,d=0,p=w._modelManager.findSpan(c,h,f)){if(p.row>=c&&p.rowCount<=1&&p.col>=h&&h===p.col&&(d=w.Tl(h),1<p.colCount))for(g=h+1;g<h+p.colCount;g++)d+=w.Tl(g)}else d=w.Tl(h);if(i=v(t,1),0<(a=v(t,3))&&(d-=a),0<i&&(d-=i),m=T.Vn.Wn(e,d-3-u,l),o&&1<e.split(/\r\n|\r|\n/).length){for(y=b=0;y<m.length;y++)b=Math.max(b,S(m[y],t.hAlign,l,N(t)).width);return b}o||(e=m.join("\r\n"))}}else e=e.replace(/\s+/g," ");return C=S(e,t.hAlign,l,N(t)),o?C.width:C.height}return 0}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),o=(T=r("Core")).CellTypes.Context,v=o.u5,i=T.CellTypes.Base,a=T.Ul.Nl,A=n.Common.j.Fa,s=n.Common.u.BIc,l=T.Ul.fp,k=T.Ul.Ml,M=k.mozilla,u=T.GC$,c=u.each,I=Math.max,C=Math.min,E=Math.floor,h=window.open,R="hyperlinkInfo",(m=t.HyperLinkTargetType||(t.HyperLinkTargetType={}))[m.blank=0]="blank",m[m.self=1]="self",m[m.parent=2]="parent",m[m.top=3]="top",f={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},b(y,g=i),y.prototype.wK=function(){var e,t;return A(this.yn)&&(this.yn="0"),t="id_"+(e=parseInt(this.yn,10)),e++,this.yn=e+"",t},y.prototype.Eka=function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p,g,m,b,y,C=1,w="left",v=a.hAlign,S=a.vAlign,x=s.lineHeight,T=l.length;for(C+=t,1===v?(C=o/2,w="center"):2===v&&(C=o-1,C-=t,w="right"),e.textAlign!==w&&(e.textAlign=w),c=1,h="alphabetic",c+=x-(p=x/2-(f=parseInt(s.fontInfo.fontSize,10))/2+(d=8<f?E((f-8)/5+2):1)-1),1===S?x<i&&(c=M?(i-u)/2+1:k.msie?(i-u)/2+.5:(i-u)/2,E(c)!==c&&(c+=.5),c+=x/2-p):2===S&&(c=i-u-2.5-p),e.textBaseline!==h&&(e.textBaseline=h),g=n+c,m=0;m<T;m++)e.fillText(l[m],r+C,g),b=e.measureText(l[m]).width,(y=a.textDecoration)&&this.ip(e,y,r+C,g,b,f,d),g+=x},y.prototype.Fka=function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m=a.hAlign,b=a.vAlign,y=s.lineHeight,C=l.length,w=0,v=0,S=0,x=0;for(2!==m&&(S=1),2===a.vAlign&&(x=-2.5),x-=I(0,Math.round(y/9)-1),e.strokeStyle!==e.fillStyle&&(e.strokeStyle=e.fillStyle),d=s.fontInfo.fontSize,p=E((d-12)/21+1),e.lineWidth=p,e.beginPath(),g=0;g<C;g++)u=e.measureText(l[g]).width,h=(c=S+r+(f=D(new T.Rect(r,n,o,i),u,y*C,m,b,t)).x)+u,w=x+n+f.y+y,E(w)===w&&(w+=.5),v=w,e.moveTo(c,w),e.lineTo(h,v),e.stroke(),x+=y},y.prototype.paintValue=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x;if(e&&(l=this.getText(t,s),!A(l))){for(u=(l+="").split(/\r\n|\r|\n/),c=0;c<u.length;)u[c]=u[c].replace(/\s+/g," "),c++;l=u.join("\r\n"),h=!1,f=s.sheet._modelManager,d=s.row,p=s.col,g=s.sheetArea,(m=f.getValueForKey(d,p,R,g))&&(this.yn===m.id?h=m.visited:f.do("setValueForKey",d,p,R,void 0,g)),e.save(),e.beginPath(),(b=h?this._visitedLinkColor:this._linkColor)&&e.fillStyle!==b&&(e.fillStyle=b),(y=a.font)&&e.font!==y&&T.Ul.lZa(e,y),C=N(a),s.sheet.outlineColumn&&s.sheet.outlineColumn.XQa(s.col)&&(C=0),w=[],S=v=0,a.wordWrap?(x=o-3-C,--x,1<(v=(w=T.Vn.Wn(l,x,y)).length)&&0!==a.vAlign&&(S=(v-1)*s.lineHeight)):w.push(l),e.rect(r,n,o,i),e.clip(),e.beginPath(),this.Eka(e,C,r,n,o,i,a,s,w,S),this.Fka(e,C,r,n,o,i,a,s,w),e.restore()}},y.prototype.getText=function(e,t){return this._text||e},y.prototype.tw=function(e,t,r,n){if(!e.HF){var o=e.parent;o&&o.tw(e,t,r,n)}},y.prototype.getHitInfo=function(e,t,r,n,o){var i;return o&&(i=o.sheetArea,(A(i)||3===i)&&r&&n)?{x:e,y:t,row:o.row,col:o.col,cellStyle:r,cellRect:n,sheetArea:i,isFocusAware:!0,sheet:o.sheet,isReservedLocation:function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b=o.sheet,y=b._render;if(A(r))return!1;if(i||(a=b.getValue(o.row,o.col,o.sheetArea),A(a)||(i=a+"")),!i)return!1;for(n=r.cellType.f5(n,r),i=i.replace(/\s+/g," "),s=r&&r.font?r.font:y.Bl(),s=y.Cl(s),l=[i],u=N(r),r.wordWrap&&(l=T.Vn.Wn(i,n.width-3-u,s),i=l.join("\r\n")),c=w(i,r.hAlign,r.vAlign,s,n,u),h=n.y+c.y,f=0;f<l.length;f++)if(d=w(l[f],r.hAlign,r.vAlign,s,n,u),p=n.x+d.x,g=C(p+d.width,n.x+n.width),h=C((m=h)+d.height,n.y+n.height),p<=e&&e<g&&m<=t&&t<h)return!0;return!1}(e,t,r,n,o,this._text)}:null},y.prototype.processMouseDown=function(e){var t=e&&e.sheet;t&&!t.isEditing()&&e.isReservedLocation&&(this.AK=!0)},y.prototype.processMouseUp=function(e){var t=e&&e.sheet;t&&!t.isEditing()&&(e.isReservedLocation&&this.AK&&this.Eia(e),this.AK=!1)},y.prototype.processMouseMove=function(e){var t,r=e.row,n=e.col,o=e.sheet;!o||o.isEditing()&&o.getActiveRowIndex()===r&&o.getActiveColumnIndex()===n||(t=o.Ws(),e.isReservedLocation?t&&(this.BK(o,e),t.style.cursor="pointer"):(this.CK(o),t&&(t.style.cursor="default")))},y.prototype.processMouseLeave=function(e){var t,r=e.sheet;this.AK=!1,this.CK(r),!r||(t=r.Ws())&&(t.style.cursor="default")},y.prototype.BK=function(e,t){var r,n,o,i,a,s;this._linkToolTip&&(r=this.DK(),(n=u(r)).text(this._linkToolTip),i=(o=e._eventHandler.bG()).left+t.x,a=o.top+t.y+20,0===n.parent().length&&((s=e&&e.zo())&&s.insertBefore(r,null),n.css("top",a).css("left",i)))},y.prototype.CK=function(e){var t,r,n;this.EK&&((t=e&&e.zo())&&this.EK.parentElement===t&&(r=t,n=this.EK,r.removeChild(n)),this.EK=null)},y.prototype.DK=function(){var e;return this.EK||(e=a("div"),u(e).css("position","absolute").css("margin",0).css("padding",2).css("border","1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("box-sizing","content-box").css("background-color","white").css("font","9pt Arial"),this.EK=e),this.EK},y.prototype.isReservedKey=function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},y.prototype.processKeyUp=function(e,t){return!!t.sheet&&(this.Eia(t),!0)},y.prototype.getAutoFitWidth=function(e,t,r,n,o){return F(this._text||e,r,n,o,!0)},y.prototype.getAutoFitHeight=function(e,t,r,n,o){return F(this._text||e,r,n,o)},y.prototype.isImeAware=function(e){return!1},y.prototype.Eia=function(e){var t=e&&e.sheet,r=e.row,n=e.col,o=e.sheetArea;this.onClickAction().call(this,e),t._modelManager.do("setValueForKey",r,n,R,{id:this.yn,visited:!0},o),t.repaint(t.getCellRect(r,n)),this.tw(t,r,n,o)},y.prototype.onClickAction=function(e){return 0===arguments.length?this._onAction:(e&&(this._onAction=e),this)},y.prototype.toJSON=function(){var r,n=this,o={typeName:n.typeName};return c(f,function(e,t){(r=n["_"+e])!==t&&(o[e]=r)}),o},y.prototype.fromJSON=function(r){var n=this;c(f,function(e){var t=r[e];A(t)||(n["_"+e]=t)})},y.prototype._createCellTypeElement=function(e){},y.prototype.gQa=function(){var r,n=this,o=new y;return c(f,function(e,t){(r=n["_"+e])!==t&&(o["_"+e]=r)}),o._onAction=n._onAction,o},d=y,t.HyperLink=d,c(f,function(t){d.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}}),T.CellTypes._o[8]=d},"./dist/plugins/celltype/radiochecklistcelltype.js":function(e,t,r){"use strict";var O,n,i,o,B,j,s,p,g,h,m,H,a,l,u,G,U,v,f,d,W,V,c,b,y,C,w,S,x,T,A,k,M,I,E,R,D,N=this&&this.__extends||(T=function(e,t){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function z(e,t){return e.hasOwnProperty(t)}function F(e,t){return e instanceof Date&&t instanceof Date?o(e)===o(t):!m(e)&&!m(t)&&e.toString&&t.toString?""+e==""+t:e===t}function _(){var r,e=A.call(this)||this;return e.typeName="13",e.icon_size=0,e.defaultPadding=0,r=e,u(S,function(e,t){"items"===e&&(t=[]),r["_"+e]=t}),e}function P(){var e=null!==M&&M.apply(this,arguments)||this;return e.typeName="12",e}function L(){return null!==I&&I.apply(this,arguments)||this}function q(){var r,e=E.call(this)||this;return e.typeName="11",e.icon_size=12,e.defaultPadding=5,r=e,u(c,function(e,t){"items"===e&&(t=[]),r["_"+e]=t}),e}function Z(e,t,r,n){var o=t.zoom(),i=e.icon_size*o,a=X(e,r),s=j(a,i),l=n;return e._items.length<n&&(l=e._items.length),s*l+e._itemSpacing.vertical*o*(l-1)}function Y(e,t,r,n,o){var i=e.icon_size*t.zoom(),a=e.defaultPadding*t.zoom(),s=K(e,t,r,n,o),l=0;return s.forEach(function(e){l+=e}),l+=o*(i+a)+(o-1)*e._itemSpacing.horizontal*t.zoom()}function K(e,t,r,n,o){var i,a,s,l,u,c=[];for(i=0;i<e._items.length;i++)a=z(e._items[i],U)?e._items[i].text:e._items[i],s=t.dp(a,r.font),(l=e.dHb()).hasMagin&&(s=s+l.paddingLeft+l.paddingRight),u=B(i%o),e._direction===W.vertical&&(u=B(i/n)),c[u]===h?c[u]=s:c[u]=Math.max(c[u],s);return c}function X(e,t){var r=G(t.font),n=e.dHb();return n.hasMagin&&(r=r+n.paddingTop+n.paddingBottom),r}function J(e,t,r,n){var o=ee(e)*r,i=o;return 1===e.hAlign?i=(t.width-n)/2:2===e.hAlign&&(i=t.width-o-n),i}function Q(e,t,r,n){var o=2;return 1===e.vAlign?t.height-2>n&&(o=(t.height-n-2)/2+2):2===e.vAlign&&(o=t.height-n-2),o}function $(e,t,r,n,o){var i,a;if(e._direction===W.vertical){if(e._isFlowLayout){if(o!==h)for(i=e._items.length;0<i;){if(!(o<Z(e,t,r,i,s(e._items.length/i))))return[i=j(i,1),s(e._items.length/i)];--i}return[e._items.length,1]}return[i=j(1,e._maxRowCount),s(e._items.length/i)]}if(e._isFlowLayout){if(n!==h)for(a=e._items.length;0<a;){if(!(n<Y(e,t,r,s(e._items.length/a),a)))return a=j(a,1),[s(e._items.length/a),a];--a}return[1,e._items.length]}return a=j(1,e._maxColumnCount),[s(e._items.length/a),a]}function ee(e){var t=e.textIndent;return 1===e.hAlign||0===t||t===g||t===h?2:8*t}function te(e,t){var r,n=!1,o=z(e,v)?e.value:e;if(t!==g)if(Array.isArray(t)){for(r=0;r<t.length;r++)if(F(t[r],o)){n=!0;break}}else n=F(t,o);return n}function re(e,t,r,n){var o,i,a,s;if(n)return t;for(e===g&&(e=[]),Array.isArray(e)||(e=[e]),o={},r.forEach(function(e){o[z(e,v)?e.value:e]=!0}),i=e.length-1;0<=i;i--)o[e[i]]||e.splice(i,1);if(-1===(a=e.slice()).indexOf(t))a.push(t);else for(i=a.length-1;0<=i;i--)F(a[i],t)&&a.splice(i,1);return s=[],r.forEach(function(e){-1!==a.indexOf(e.value)&&s.push(e.value)}),s}Object.defineProperty(t,"__esModule",{value:!0}),O=r("Core"),n=r("@grapecity/js-sheets-common"),i=n.Common.j.C4,o=n.Common.l.Ra,B=Math.floor,j=Math.max,s=Math.ceil,p="alphabetic",g=null,h=void 0,m=n.Common.j.Fa,H=O.Ul.lZa,a=O.CellTypes.Base,l=O.GC$,u=l.each,G=O.Ul.fp,U="text",v="value",f="string",d="number",(D=W=t.Direction||(t.Direction={}))[D.horizontal=0]="horizontal",D[D.vertical=1]="vertical",(R=V=t.TextAlign||(t.TextAlign={}))[R.left=2]="left",R[R.right=3]="right",c={items:g,direction:W.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:V.right},N(q,E=a),q.prototype.paintValue=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L=this;if(e){for(e.save(),e.rect(r+1,n+1,o-2,i-2),e.clip(),e.beginPath(),l=0,c=(u=s.sheet).zoom(),h=L.icon_size*c,f=L.defaultPadding*c,d=h/2,p=new O.Rect(r+1,n+1,o-2,i-2),y=Y(L,u,a,m=(g=$(L,u,a,o-2,i-2))[0],b=g[1]),C=Z(L,u,a,m),w=K(L,u,a,m,b),v=X(L,a),S=r+J(a,p,c,y),x=n+Q(a,p,0,C),(T=a.font)&&e.font!==T&&H(e,s.fontInfo.font),a.foreColor&&(e.fillStyle=a.foreColor),A=a.textDecoration,M=8<(k=s.fontInfo.fontSize)?B((k-8)/5+2):1,I=G(a.font)/2-k/2+M-1,E=S,R=x,D=0;D<L._items.length;D++)r+o<S||n+i<x||(N=z(L._items[D],U)?L._items[D].text:L._items[D],l=u.dp(N,a.font),e.textAlign="left",F=L._direction===W.vertical?w[B(D/m)]:w[D%b],_=0,_=L._textAlign===V.left?(L.zGb(e,L._items[D],t,l,S,x,F,v,I),S=S+F+f,e.save(),L.AGb(e,t,L._items[D],S,x+v-I-h,d),e.restore(),h):(e.save(),L.AGb(e,t,L._items[D],S,x+v-I-h,d),S=S+h+f,e.restore(),L.zGb(e,L._items[D],t,l,S,x,F,v,I),F),A&&(P=this.dHb(),L.ip(e,A,S-(L._textAlign===V.right?0:F+f)+P.paddingLeft,x+v-I-P.paddingBottom,l,k,M)),L._direction===W.vertical?(x+=j(v,h)+L._itemSpacing.vertical*c,(D+1)%m==0&&(E=E+F+h+f+L._itemSpacing.horizontal*c,x=n+Q(a,p,0,C)),S=E):(S=S+_+L._itemSpacing.horizontal*c,(D+1)%b==0&&(S=r+J(a,p,c,y),R=R+j(v,h)+L._itemSpacing.vertical*c),x=R));e.restore()}},q.prototype.getText=function(e,t){return e},q.prototype.zGb=function(e,t,r,n,o,i,a,s,l){var u=z(t,U)?t.text:t;e.textBaseline!==p&&(e.textBaseline=p),e.fillText(u,o,i+s-l)},q.prototype.getItemsBound=function(l,e,t,r){var n,o,u,i,a,s,c,h,f,d,p,g,m,b,y,C,w,v,S,x=this,T=l.zoom(),A=l.getActualStyle(e,t,r),k=O.To.No("11pt "+l.currentTheme().bodyFont(),T);for(A.font&&(k=O.To.No(A.font,T)),A.font=k.font,n=1===r?-1:void 0,o=2===r?-1:void 0,i=(u=l.getCellRect(e,t,n,o)).width,a=u.height,s=$(x,l,A,i-1,a),c=s[0],h=s[1],f=K(x,l,A,c,h),d=x.icon_size*l.zoom(),p=x.defaultPadding*l.zoom(),g=j(X(x,A),d),m=Y(x,l,A,c,h),b=Z(x,l,A,c),y=J(A,u,l.zoom(),m),C=Q(A,u,l.zoom(),b),w=[],v=function(e){var t,r,n,o=z(x._items[e],U)?x._items[e].text:x._items[e],i=l.dp(o,A.font),a=B(e/h),s=e%h;x._direction===W.vertical&&(a=e%c,s=B(e/c)),t=new O.Rect,r=0,f.filter(function(e,t){return t<s}).forEach(function(e){r+=e}),t.x=y+r+s*(d+p+x._itemSpacing.horizontal*l.zoom())+u.x,t.y=C+a*g+x._itemSpacing.vertical*l.zoom()*a+u.y,n=x.dHb(),t.width=(x._textAlign!==V.right||n.hasMagin?f[s]:i)+d+p,t.height=g,t.x>u.x+u.width||t.y>u.y+u.height?w[e]=null:w[e]=t},S=0;S<x._items.length;S++)v(S);return w},q.prototype.AGb=function(e,t,r,n,o,i){},q.prototype.dHb=function(){return{hasMagin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},q.prototype.getAutoFitWidth=function(e,t,r,n,o){var i=o&&o.sheet,a=ee(r),s=$(this,i,r);return(Y(this,i,r,s[0],s[1])+a)/i.zoom()},q.prototype.getAutoFitHeight=function(e,t,r,n,o){var i=o&&o.sheet,a=$(this,i,r);return Z(this,i,r,a[0],a[1])/i.zoom()},q.prototype.getHitInfo=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p;return o?(n=r.cellType.f5(n,r),i=o.sheetArea,a=o.sheet,(m(i)||3===i)&&n?(s={x:e,y:t,row:o.row,col:o.col,cellStyle:r,cellRect:n,sheetArea:i,sheet:a},r.font&&(r.font=O.To.No(r.font,a.zoom()).font),h=Y(this,a,r,u=(l=$(this,a,r,n.width-1,n.height-2))[0],c=l[1]),f=Z(this,a,r,u),d=n.x+J(r,n,a.zoom(),h),p=n.y+Q(r,n,a.zoom(),f),new O.Rect(d,p,h,f).contains(s.x,s.y)&&(s.isReservedLocation=!0),s):g):g},q.prototype.processMouseDown=function(e){return!!e&&void(e.isReservedLocation&&(this.uK=!0))},q.prototype.processMouseLeave=function(e){return E.prototype.processMouseLeave.call(this,e),!!e&&void(this.uK=!1)},q.prototype.processMouseUp=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p;return!!e&&(t=e.sheet,!!(this.uK&&t&&e.isReservedLocation&&(this.uK=!1,r=e.row,n=e.col,o=e.sheetArea,i=function(c,h){function e(e){var t,r,n,o,i,a=z(c._items[e],U)?c._items[e].text:c._items[e],s=f.dp(a,h.cellStyle.font),l=B(e/p),u=e%p;if(c._direction===W.vertical&&(l=e%d,u=B(e/d)),t=new O.Rect,r=0,g.filter(function(e,t){return t<u}).forEach(function(e){r+=e}),t.x=C+r+u*(m+b+c._itemSpacing.horizontal*f.zoom()),t.y=w+l*y+c._itemSpacing.vertical*f.zoom()*l,n=c.dHb(),t.width=(c._textAlign!==V.right||n.hasMagin?g[u]:s)+m+b,t.height=y,o=h.x-h.cellRect.x,i=h.y-h.cellRect.y,t&&t.contains(o,i))return{value:{value:z(c._items[e],v)?c._items[e].value:c._items[e]}}}var t,r,n=h.cellRect.width,o=h.cellRect.height,f=h.sheet,i=$(c,h.sheet,h.cellStyle,n-1,o),d=i[0],p=i[1],g=K(c,h.sheet,h.cellStyle,d,p),m=c.icon_size*f.zoom(),b=c.defaultPadding*f.zoom(),y=j(X(c,h.cellStyle),m),a=Y(c,f,h.cellStyle,d,p),s=Z(c,f,h.cellStyle,d),C=J(h.cellStyle,h.cellRect,f.zoom(),a),w=Q(h.cellStyle,h.cellRect,f.zoom(),s);for(t=0;t<c._items.length;t++)if("object"==typeof(r=e(t)))return r.value}(this,e)))&&(a=this,s=t,l=r,u=n,c=i.value,h=o,f=s.getValue(l,u,h),d=a.rK(f,c),p={cmd:"editCell",sheetName:s.name(),row:l,col:u,newValue:d,autoFormat:!0},s.wu().execute(p),a.triggerButtonClicked(s,l,u,h),!0))},q.prototype.rK=function(e,t){return re(e,t,this._items,!0)},q.prototype.triggerButtonClicked=function(e,t,r,n){var o=e.parent;o&&o.tw(e,t,r,n)},q.prototype.toJSON=function(){var r,n=this,o={typeName:n.typeName};return u(c,function(e,t){r=n["_"+e],("items"===e?r&&0<r.length:r!==t)&&(o[e]="object"==typeof r?i(r):r)}),o},q.prototype.fromJSON=function(r){var n=this;u(c,function(e){var t=r[e];m(t)||(n["_"+e]=t)})},N(L,I=b=q),L.prototype.AGb=function(e,t,r,n,o,i){var a=z(r,v)?r.value:r;e.beginPath(),e.fillStyle="white",e.arc(n+i,o+i,i,0,2*Math.PI),e.fill(),e.beginPath(),e.strokeStyle="black",e.arc(n+i,o+i,i,0,2*Math.PI),e.stroke(),t!==g&&F(t,a)&&(e.beginPath(),e.strokeStyle="black",e.arc(n+i,o+i,.5*i,0,2*Math.PI),e.fillStyle="black",e.fill(),e.stroke())},y=L,t.RadioButtonList=y,N(P,M=b),P.prototype.AGb=function(e,t,r,n,o,i){e.strokeStyle="black",e.strokeRect(n+.5,o+.5,2*i+.05,2*i+.05),e.fillStyle="white",e.fillRect(n+1,o+1,2*i-1,2*i-1);var a=te(r,t);t!==g&&a&&(e.beginPath(),e.lineWidth=2.5,e.moveTo(n+3,o+i),e.lineTo(n+i,o+2*i-3.5),e.lineTo(n+2*i-1.5,o+3),e.stroke())},P.prototype.rK=function(e,t){return re(e,t,this._items,!1)},C=P,t.CheckBoxList=C,(k=w=t.SelectionMode||(t.SelectionMode={}))[k.single=0]="single",k[k.multiple=1]="multiple",S={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:g,itemSpacing:{horizontal:5,vertical:5},selectionMode:w.multiple},N(_,A=b),_.prototype.zGb=function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d;e.save(),e.beginPath(),u=te(t,r),c=z(t,U)?t.text:t,h=this._selectedBackColor,f=this._selectedForeColor,u&&(e.fillStyle=h,e.fillRect(o+1,i+1,a-1,s-1),e.fillStyle=f),e.textAlign="center",e.textBaseline!==p&&(e.textBaseline=p),d=this.dHb(),e.fillText(c,o+d.paddingLeft+(a-d.paddingLeft-d.paddingRight)/2,i+d.paddingTop+s-d.paddingTop-d.paddingBottom-l),e.restore()},_.prototype.rK=function(e,t){return re(e,t,this._items,this._selectionMode===w.single)},_.prototype.dHb=function(){var e,t,r,n,o,i,a,s=0,l=0,u=0,c=0;return this._padding&&(t=this._padding,a=["0","0","0","0"],typeof t===f&&(i=o=void 0,1===(n=(r=t.split(" ",4)).length)?a=[o=r[0],o,o,o]:2===n?a=[o=r[0],i=r[1],o,i]:3===n?(i=r[1],a=[r[0],i,r[2],i]):4===n&&(a=[r[0],r[1],r[2],r[3]])),e=a,s=typeof(s=parseInt(e[0],10))==d&&0<s?s:0,c=typeof(c=parseInt(e[1],10))==d&&0<c?c:0,l=typeof(l=parseInt(e[2],10))==d&&0<l?l:0,u=typeof(u=parseInt(e[3],10))==d&&0<u?u:0),{hasMagin:!0,paddingTop:s,paddingBottom:l,paddingLeft:u,paddingRight:c}},_.prototype.toJSON=function(){var r,n=this,o=A.prototype.toJSON.call(this);return u(S,function(e,t){r=n["_"+e],("items"===e?r&&0<r.length:r!==t)&&(o[e]="object"==typeof r?i(r):r)}),o},_.prototype.fromJSON=function(r){A.prototype.fromJSON.call(this,r);var n=this;u(S,function(e){var t=r[e];m(t)||(n["_"+e]=t)})},x=_,t.ButtonList=x,u(c,function(l){b.prototype[l]=function(e){var t,r,n,o,i,a,s="_"+l;if(0===arguments.length)return this[s];if("items"===l){for(t=[],r=0;r<e.length;r++)n=e[r],m(n.text)||m(n.value)?m(n.text)?m(n.value)?m(n)||"object"==typeof n||t.push({text:n,value:n}):(n.text=n.value,t.push(n)):(n.value=n.text,t.push(n)):t.push(n);e=t}return"itemSpacing"===l?(o=this[s],this[s]={horizontal:o.horizontal,vertical:o.vertical},m(e.horizontal)||(i=parseInt(e.horizontal,10),isNaN(i)||(this[s].horizontal=i)),m(e.vertical)||(a=parseInt(e.vertical,10),isNaN(a)||(this[s].vertical=a))):this[s]=e,this}}),O.CellTypes._o[11]=y,O.CellTypes._o[12]=C,u(S,function(l){x.prototype[l]=function(e){var t,r,n,o,i,a,s="_"+l;if(0===arguments.length)return this[s];if("items"===l){for(t=[],r=0;r<e.length;r++)n=e[r],m(n.text)||m(n.value)?m(n.text)?m(n.value)?m(n)||"object"==typeof n||t.push({text:n,value:n}):(n.text=n.value,t.push(n)):(n.value=n.text,t.push(n)):t.push(n);e=t}return"itemSpacing"===l?(o=this[s],this[s]={horizontal:o.horizontal,vertical:o.vertical},m(e.horizontal)||(i=parseInt(e.horizontal,10),isNaN(i)||(this[s].horizontal=i)),m(e.vertical)||(a=parseInt(e.vertical,10),isNaN(a)||(this[s].vertical=a))):this[s]=e,this}}),O.CellTypes._o[13]=x},"./dist/plugins/celltype/rangecelltype.js":function(e,t,r){"use strict";var ce,n,d,o,he,fe,de,s,l,i,a,u,c=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function p(e){return e.map(function(e){return{start:e.start,size:e.size}})}function h(e,t,r,n,o){var i,a=u.call(this)||this;return a.allowOverflow=!1,a.typeName="16",i=1===arguments.length?new ce.Range(0,0,e.getRowCount(),e.getColumnCount()):new ce.Range(t,r,n,o),e&&i&&(a._R=(new s).YE(e,i),a.gKb=(new l).YE(e,i)),a}function f(){}function g(){this.Uu=0,this.SV=0,this.Xj=0,this.OZ=0}function m(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q=t.x,Z=t.y,Y=t.width,K=t.height,X=n.sheet,J=n.sheetArea,Q=n.isPrinting,$=n.needTopGridline,ee=n.needLeftGridline,te=[],re=[],ne=X.vu(),oe=i.rowCount,ie=i.colCount,ae=i.rowSize,se=i.colSize,le=i.cellStyleList,ue=i.sparklines;for(o.$Jb(r),s=(a=o.cKb()).baseRow,l=a.baseCol,c=(u=o.UJb).Pm,u.Us(new ce.Rect(0,0,Y,K)),h=new ce.AF(u,u.Gr(1,3),u.Hr(1,3),3),f=o.dKb(!0),Z+=1,--K,q+=1,--Y,p=d=0,ae=ae.map(function(e){var t=e.size*K,r=de(t);return 1<=(p+=t-r)&&(r++,p--),{start:de(e.start*K),size:r}}),se=se.map(function(e){var t=e.size*Y,r=de(t);return 1<=(d+=t-r)&&(r++,d--),{start:de(e.start*Y),size:r}}),g=u.conditionalFormats,m=0;m<oe;m++)for(b=0;b<ie;b++)if(le[m][b]){if(C=(y=le[m][b]).style,w=y.isSpan,v=y.span,S=!1,x=f[m][b],w&&!v)continue;if(C=C.clone(!0),T=de(q+se[b].start),A=de(Z+ae[m].start),0,I=w?v.colCount:1,E=w?v.rowCount:1,k=se[b+I]?se[b+I].start:Y,R=de(k-se[b].start),M=ae[m+E]?ae[m+E].start:K,D=de(M-ae[m].start),x.formatStyle&&(x.formatStyle.Yo(C),C=x.formatStyle),C.Zo(c),N=fe,w){for(N={row:m,col:b,x:de(T),y:de(A),width:de(R),height:de(D),rowCount:E,colCount:I},F={},_={},P=[],O=L=void 0,L=j=B=0;L<I-1;L++)G=(H=se[b+L])?H.size:0,B+=_[L]=G;for(_[L]=de(R)-B,O=0;O<E-1;O++)G=(U=ae[m+O])?U.size:0,j+=F[O]=G;for(F[O]=de(D)-j,O=0;O<E;O++){for(W=[],V=0;V<I;V++)le[O+m]&&le[O+m][b+V]&&W.push(le[O+m][b+V].style);P.push(W)}N.spanSizeInfo={styleList:P,rowSizes:F,colSizes:_}}h.jF(m,b,de(T),de(A),de(R),de(D),C,N,$&&0===m,ee&&0===b),z=null,ue[m][b]&&((z=ue[m][b].clone())&&(z.oZa=u.name(),z.hKb=z.iKb(u),z.jKb=z.kKb(u),z.lKb=u)),x&&x.value&&"SparklineExValue"===x.value.typeName&&(he.bDc(e,x.value,T,A,R,D,X),S=!0),x.validStyle&&re.push({style:x.validStyle,x:T,y:A,width:R,height:D}),S||te.push({data:x.value,row:m,col:b,x:T,y:A,width:R,height:D,style:C,sparkline:z,baseRow:m+s,baseCol:b+l,conditionalFormats:g,imageLoader:ne,cellLayout:{row:m,col:b,x:T,y:A,width:R,height:D}})}e.save(),$&&(Z-=2,K+=4),ee&&(q-=2,Y+=4),e.rect(q,Z,Y,K),e.clip(),0<te.length&&u._render.SI(e,te,J,Q,X,s,l),h.paint(e),0<re.length&&u._render.jJ(e,re),e.restore()}Object.defineProperty(t,"__esModule",{value:!0}),ce=r("Core"),n=r("Bindings"),d=r("Sparkline"),o=ce.CellTypes.Base,he=ce.CellTypes.Context,fe=null,de=Math.floor,g.prototype.YE=function(e,t){var r=t.row,n=t.col,o=t.rowCount,i=t.colCount;return this.Uu=r,this.SV=n,this.Xj=o,this.OZ=i,this.Ny=this.nJb(e,t),this.NJb=this.OJb(e,t),this},g.prototype.PJb=function(){return this.NJb},g.prototype.OJb=function(e,t){var r,n,o,i,a,s=t.row,l=t.col,u=t.rowCount,c=t.colCount,h=0,f=[],d=0,p=[],g=0,m=s+u,b=l+c;for(r=s;r<m;r++)g=e.getRowHeight(r),d+=g,p.push(g);for(n=l;n<b;n++)g=e.getColumnWidth(n),h+=g,f.push(g);return g=0,o=p.map(function(e){var t=g/d;return g+=e,{start:t,size:e/d}}),g=0,i=f.map(function(e){var t=g/h;return g+=e,{start:t,size:e/h}}),a=this.nJb(e,t),{rowCount:u,colCount:c,rowSize:o,colSize:i,cellStyleList:this.QJb(e,t,a,o,i),sparklines:this.RJb(e,t),totalHeight:d,totalWidth:h}},g.prototype.SJb=function(e,t,r,n,o){var i,a,s,l,u,c,h,f=null;for(i=0,a=o;i<a.length;i++)if(l=(s=a[i]).rowOffset,u=s.colOffset,c=s.rowCount,h=s.colCount,new ce.Range(l+r,u+n,c,h).contains(e,t)){f=s;break}return f},g.prototype.TJb=function(e,t,r){var n,o=[0,0],i=o[0],a=o[1],s=e.rowOffset,l=e.colOffset,u=s+e.rowCount,c=l+e.colCount;for(n=s;n<u;n++)a+=t[n]?t[n].size:0;for(n=l;n<c;n++)i+=r[n]?r[n].size:0;return{width:i,height:a}},g.prototype.QJb=function(e,t,r,n,o){var i,a,s,l,u,c=t.row,h=t.col,f=t.rowCount,d=t.colCount,p=[];for(i=c;i<c+f;i++){for(a=[],s=h;s<h+d;s++)(l=this.SJb(i,s,c,h,r))&&l.rowOffset+c===i&&l.colOffset+h===s?(u=this.TJb(l,n,o),a.push({style:e.getActualStyle(i,s,3,!0),spanWidth:u.width,spanHeight:u.height,isSpan:!0,span:l})):l?a.push({style:e.getActualStyle(i,s,3,!0),isSpan:!0}):a.push({style:e.getActualStyle(i,s,3,!0)});p.push(a)}return p},g.prototype.nJb=function(e,t){var r,n,o,i=e._modelManager.getSpans(),a=[],s=t.row,l=t.col,u=t.rowCount,c=t.colCount;for(r=0,n=i;r<n.length;r++)(o=n[r]).intersect(s,l,u,c)&&a.push({rowOffset:o.row-s,colOffset:o.col-l,rowCount:o.rowCount,colCount:o.colCount});return a},g.prototype.RJb=function(e,t){var r,n,o,i,a=t.row,s=t.col,l=t.colCount,u=t.rowCount,c=[];for(r=a;r<a+u;r++){for(n=[],o=s;o<s+l;o++)(i=e.getSparkline(r,o))?n.push(i.clone()):n.push(null);c.push(n)}return c},g.prototype.toJSON=function(){var e=this.PJb(),t=e.rowCount,r=e.colCount,n=e.rowSize,o=e.colSize,i=e.cellStyleList,a=e.sparklines,s=e.totalWidth,l=e.totalHeight;return{rowCount:t,colCount:r,rowSize:p(n),colSize:p(o),cellStyleList:i.map(function(e){return e.map(function(e){if(e){var t=e.style,r=e.spanWidth,n=e.spanHeight,o=e.isSpan,i=e.span;return{style:t.toJSON(),spanWidth:r,spanHeight:n,isSpan:o,span:i}}return null})}),sparklines:a.map(function(e){return e.map(function(e){if(e)return{sparklineType:e.sparklineType(),sp:e.toJSON(),setting:e.setting().toJSON()}})}),totalWidth:s,totalHeight:l}},g.prototype.fromJSON=function(e){var t,r,n,o,i,a,s,l,u,c,h,f;e&&(t=e.rowCount,r=e.colCount,n=e.rowSize,o=e.colSize,i=e.cellStyleList,a=e.sparklines,s=e.totalWidth,l=e.totalHeight,u=p(n),c=p(o),h=i.map(function(e){return e.map(function(e){var t,r,n,o,i,a;return e?(t=e.style,r=e.spanWidth,n=e.spanHeight,o=e.isSpan,i=e.span,a=null,t&&(a=new ce.Style).fromJSON(t),{style:a,spanWidth:r,spanHeight:n,span:i,isSpan:o}):null})}),f=a.map(function(e){return e.map(function(e){if(e){var t=new d.Sparkline,r=new d.SparklineSetting(e.setting);return t.fromJSON(e.sp),t.setting(r),t.sparklineType(e.sparklineType),t}})}),this.NJb={rowCount:t,colCount:r,rowSize:u,colSize:c,cellStyleList:h,sparklines:f,totalWidth:s,totalHeight:l})},g.prototype.no=function(){this.NJb=null},s=g,t.Wgc=s,f.prototype.YE=function(e,t){var r=this;return r.my=t,r.UJb=new ce.Worksheet,r.VJb=e.parent&&e.parent.options.allowDynamicArray,r.UJb.getCalcService&&(r.UJb.getCalcService().allowDynamicArray=r.VJb,r.WJb=r.XJb(e)),r.YJb(e),r},f.prototype.XJb=function(e){var t,r,n,o,i,a,s,l=this.my,u=l.row,c=l.col,h=l.colCount,f=l.rowCount,d=[],p=e.Bj&&e.Bj();for(t=u;t<u+f;t++)for(r=c;r<c+h;r++)e.getFormula(t,r)&&(n=p&&p.Qf(t,r))&&n.isDynamicArray&&(o=n.row,i=n.col,a=n.rowCount,s=n.colCount,1<a&&d.push({row:o+1,col:i,rowCount:a-1,colCount:s}),1<s&&d.push({row:o,col:i+1,rowCount:1,colCount:s-1}));return d},f.prototype.ZJb=function(){var e,t,r,n,o,i,a,s=this.WJb,l=this.UJb;for(e=0,t=s;e<t.length;e++)n=(r=t[e]).row,o=r.col,i=r.rowCount,a=r.colCount,l.clear(n,o,i,a,3,1)},f.prototype.$Jb=function(e){var t,r=this.UJb;r.suspendEvent(),t=new n.CellBindingSource(e),this.ZJb(),r.setDataSource(t),r.resumeEvent()},f.prototype.YJb=function(e){var t=this.UJb,r=e.toJSON({includeBindingSource:!0});delete r.charts,delete r.shapes,delete r.tables,t.fromJSON(JSON.parse(JSON.stringify(r))),this._Jb()},f.prototype._Jb=function(){var e,t,r=this.my,n=r.row,o=r.col,i=r.colCount,a=r.rowCount,s=[],l=[];for(e=n;e<n+a;e++){for(l=[],t=o;t<o+i;t++)l.push(this.aKb(e,t,3));s.push(l)}this.bKb=s},f.prototype.cKb=function(){var e=this.my;return{baseRow:e.row,baseCol:e.col}},f.prototype.dKb=function(e){var t,r,n,o,i,a,s,l=this.UJb,u=this.my,c=u.row,h=u.col,f=u.colCount,d=u.rowCount,p=[];for(t=c;t<c+d;t++){for(r=[],o=n=void 0,i=h;i<h+f;i++)a=l.getText(t,i),s=l.getValue(t,i,3,1),n=this.eKb(t,i,3),o=this.fKb(l,t,i,s,e),r.push({value:s,formatStyle:n,text:a,validStyle:o});p.push(r)}return p},f.prototype.aKb=function(e,t,r){var n;return this.UJb.uja&&(n=this.UJb.getDataValidator(e,t,r))?n.highlightStyle():null},f.prototype.fKb=function(e,t,r,n,o){if(o&&e.isValid&&!e.isValid(t,r,n)){var i=this.my,a=i.row,s=i.col;return this.bKb[t-a][r-s]}return null},f.prototype.eKb=function(e,t,r){var n=this.UJb.conditionalFormats;return n?n.Eq(new ce.Style,e,t,r):null},f.prototype.getCellValueInfo=function(e){var t,r,n,o=this.my,i=o.row,a=o.col,s=o.colCount,l=o.rowCount,u=[],c=e._modelManager;for(t=i;t<i+l;t++){for(r=[],n=a;n<a+s;n++)r.push({bindPath:e.getBindingPath(t,n),formula:e.getFormula(t,n),value:c.getValue(t,n,3,fe,1)});u.push(r)}return u},f.prototype.setValueToDataStruct=function(e,t,r,n){n[e]||(n[e]={}),n[e][t]=r},f.prototype.toJSON=function(){var e=this.UJb,t=this.VJb,r=this.WJb.map(function(e){return{row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount}}),n=this.my;return{spillRangs:r,allowDynamicArray:t,range:{row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount},templatejson:JSON.stringify(e.toJSON({includeBindingSource:!0}))}},f.prototype.fromJSON=function(e){var t,r,n,o,i,a;e&&((t=this.UJb=new ce.Worksheet).suspendCalcService&&t.suspendCalcService(),this.WJb=e.spillRangs,this.VJb=e.allowDynamicArray,t.getCalcService&&(t.getCalcService().allowDynamicArray=this.VJb),t.fromJSON(JSON.parse(e.templatejson)),this.ZJb(),n=(r=e.range).row,o=r.col,i=r.rowCount,a=r.colCount,this.my=new ce.Range(n,o,i,a),this._Jb(),t.resumeCalcService&&t.resumeCalcService())},f.prototype.no=function(){this.UJb.no(),this.UJb=null,this.my=null},l=f,t.Xgc=l,c(h,u=o),h.prototype.getAutoFitWidth=function(){return this._R.NJb.totalWidth},h.prototype.getAutoFitHeight=function(){return this._R.NJb.totalHeight},h.prototype.updateTemplate=function(e,t){e&&t&&(this._R.YE(e,t),this.gKb.YE(e,t))},h.prototype.paintContent=function(e,t,r,n,o,i,a,s){var l,u=this.gKb,c=this._R;u&&c&&(l=this._R.PJb(),a.cellPadding&&(s.needTopGridline=!0,s.needLeftGridline=!0),m(e,{x:r,y:n,width:o,height:i},t,s,u,l))},h.prototype.toJSON=function(){return{typeName:this.typeName,layout:this._R.toJSON(),resolvor:this.gKb.toJSON()}},h.prototype.fromJSON=function(e){e.layout&&(this._R=new s,this._R.fromJSON(e.layout)),e.resolvor&&(this.gKb=new l,this.gKb.fromJSON(e.resolvor))},i=h,t.RangeTemplate=i,ce.CellTypes._o[16]=i,t.paintRangeTemplate=m},"./dist/plugins/conditional/conditional.entry.js":function(e,r,t){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),n(t("./dist/plugins/conditional/conditional.js")),n(t("./dist/plugins/conditional/conditional.ns.js"))},"./dist/plugins/conditional/conditional.js":function(e,b,t){"use strict";var l,x,d,r,y,p,j,g,C,n,B,w,A,k,T,M,i,v,S,m,I,o,E,R,D,N,F,a,_,u,s,H,P,L,O,G,U,W,c,V,h,z,q,Z,f,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,Ee,Re,De,Ne,Fe,_e,Pe,Le,Oe,Be,je,He,Ge,Ue,We,Ve,ze,qe,Ze,Ye,Ke,Xe,Je,Qe,$e,et,tt,rt,nt,ot,it,at,st,lt,ut,ct,ht,ft,dt,pt,gt,mt,bt,yt,Ct,wt,vt,St=this&&this.__extends||(Je=function(e,t){return(Je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}Je(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function xt(e){return e.rowCount}function Tt(e){return e.colCount}function At(e,t,r,n){switch(n&&"string"==typeof t&&"string"==typeof r&&(t=t.toLowerCase(),r=r.toLowerCase()),e){case ie.equalsTo:return t===r;case ie.notEqualsTo:return t!==r;case ie.greaterThan:return r<t;case ie.greaterThanOrEqualsTo:return r<=t;case ie.lessThan:return t<r;case ie.lessThanOrEqualsTo:return t<=r;default:return!1}}function kt(e,t){var r,n;r=(t=t||{}).formula,(n=this).offsetRow=0,n.offsetCol=0,n.conType("string"==typeof e?we[e]:e),F(t.compareType)||n.RV(t.compareType),F(t.expected)||n.expected(t.expected),F(r)||n.formula("string"==typeof r?E(C.trim(r),"="):r),F(t.item1)||n.item1(t.item1),F(t.item2)||n.item2(t.item2),F(t.customValueType)||n.customValueType(t.customValueType),F(t.type)||n.type(t.type),n.ranges(t.ranges),n.Lf=B,n.TV=B}function Mt(e,t,r){this.xyb=!0,this.ruleType(e),this.style(t),this.ranges(r)}function It(e,t,r,n,o,i,a,s,l,u){var c=yt.call(this,e,r)||this,h=c;return h.ranges(t),h.operator(n),h.value1("string"==typeof o?C.trim(o):o),h.value2("string"==typeof i?C.trim(i):i),h.text(a),h.formula(s),h.type(l),h.rank(u),h.cached=!1,h.cW=B,c}function Et(e,t,r,n){var o=t.ranges(),i=H(o),a=j.formulaToExpression(e,r,i.r,i.c,n);return j.expressionToFormula(e,a,i.r,i.c,!n)}function Rt(e,t){var r=this,n=e;return 0===arguments.length&&(n=0),(r=Ct.call(this,13,B,B,B)||this).xyb=!1,r.ranges(t),r.ad(n),r}function Dt(e,t,r,n,o,i){var a=this,s=e,l=t,u=r,c=n,h=o;return 0===arguments.length&&(s=5,u=7,c=l=B,h=U(255,99,142,198)),(a=wt.call(this,12,s,l,B,B,B,B,u,c,B,i)||this).xyb=!1,a.ad(h),a}function Nt(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y,C,w=vt.call(this,e,B,c)||this,v=w;return v.xyb=!1,v.lowestValueCached=B,v.highestValueCached=B,v.zyb={},v.cached=!1,v.cW=B,h=t,f=r,d=n,p=o,g=i,m=a,b=s,y=l,C=u,arguments.length<=1&&(h=1,f=B,d=U(255,248,105,107),p=4,g=50,m=U(255,255,235,132),b=2,y=B,C=U(255,99,190,123)),v.minColor(d),v.minValue(f),v.minType(h),v.midColor(m),v.midValue(g),v.midType(p),v.maxColor(C),v.maxValue(y),v.maxType(b),w}function Ft(e){return"string"==typeof e&&("="!==(e=C.trim(e))[0]&&(e='="'+n.Gb(e,'"','""')+'"')),e}function _t(e){this.AW=[],this.BW=B,this.DW={},this.Kfc=!0,this.WS=e}function Pt(e,t){if(t)for(var r=0;r<t.length;r++)e.push(t[r])}Object.defineProperty(b,"__esModule",{value:!0}),l=t("@grapecity/js-sheets-common"),x=t("Core"),d=t("@grapecity/js-calc"),r=t("./dist/plugins/conditional/conditional.ns.js"),y=t("@grapecity/js-calc"),p=t("Core"),j=t("SheetsCalc"),g=t("./dist/plugins/conditional/conditionalFormatIcon.js"),C=x.GC$,n=l.Common.u,B=null,w=void 0,A=Math.min,k=Math.max,T=Math.abs,M=Math.floor,i=Math.ceil,v=d.Convert,S=v.Na,m=v.Pa,I=v.Th,o=l.Common.u,E=o.Db,R=o.kb,D=o.jb,N=o.Bb,F=l.Common.j.Fa,a=l.Common.q,_=l.Common.F,u=x.Ul,s=u.T$a,H=u.l_a,P=!!d,L=x.Style,O=l.Common.k,G=l.Common.pc,U=G.bc,W=x.kf,c=x.Range,V=l.Common.l,h=l.Common.k,z=h.Fb,q=h.Cb,Z=h.ac,f=d.Functions,Y=d.evaluateOperator,K=x.Rm,X=new l.Common.ResourceManager(r.SR),J=X.getResource.bind(X),Q=function(e){var t=e.row<0?j.BAND_INDEX_CONST:e.row,r=e.col<0?j.BAND_INDEX_CONST:e.col;return y.uf(B,B,t,r,t+e.rowCount-1,r+e.colCount-1)},$=function(e){var t;if(e instanceof d.Expression)t=e;else if(e instanceof c)t=Q(e);else{if(!S(e))throw J().Exp_NotSupport;e=m(e),isNaN(e)||((t=new d.Expression(2)).value=e)}return t},ee=function(e,t,o,i){function r(e,t){var r,n;return this.hasOwnProperty("_ps")||(this._ps={}),r=this._ps,0===arguments.length?r[a]!==w?i?i.call(this,r[a]):r[a]:s:(r[a]!==e&&(n=r[a]!==w?r[a]:s,r[a]=e,!1!==t&&o&&o.call(this,e,n)),this)}var a=e,s=t;return r.isDefault=function(e){return e===s},r},te=function(o,e,i){var a=this;return i=i||{},e=e||a,C.each(e,function(e,t){var r,n=a[t];F(n)||(r=n.call(a),"formula"===t?(a.getFormulaString?r=a.getFormulaString(o,w,w,!0):a.condition()&&a.condition().getFormulaString&&(r=a.condition().getFormulaString(o,w,w,!0)),r&&(i[t]=r)):"iconCriteria"===t||"icons"===t?i[t]=r:V.Ska(r)?i[t]=V.Daa(r):r&&r.toJSON?i[t]=r.toJSON(o):F(r)||n.isDefault(r)||(i[t]=r))}),i},re=function(f,e,d,p){if(d){var g,m=this;e=e||m,C.each(e,function(e,t){var r,n,o,i,a,s,l,u,c,h;if(g=d[t],!F(g))if("ranges"===t){for(r=[],n=0;n<g.length;n++)o=g[n],r.push(W(o.row,o.col,xt(o),Tt(o)));m.ranges(r,!1)}else if("style"===t)m.style(new L,!1),m.style().fromJSON(g,p);else if("iconCriteria"===t)for(i=g.length,a=0;a<i;a++)s=g[a],m.NV[a]=new qe(s.isGreaterThanOrEqualTo,s.iconValueType,s.iconValue);else if("icons"===t)for(l=g.length,u=0;u<l;u++)c=g[u],m.CZa[u]={iconSetType:c.iconSetType,iconIndex:c.iconIndex};else"iconSetType"===t?m[t](g,!0):"item1"===t||"item2"===t?(m[t](b.$V(),!1),m[t]().fromJSON(g,f)):"expected"===t?"string"!==C.getType(g)||5!==d.conType&&13!==d.conType?m[t](g,!1):"/OADate("===g.substr(0,8)?m[t](V.Rka(g),!1):m[t](new Date(g)):"condition"===t?((h=new Fe).fromJSON(g,f),m.condition(h,!1)):"string"===C.getType(g)&&"/OADate("===g.substr(0,8)?m[t](V.Rka(g),!1):m[t](g,!1)})}},ne=x.lUa,C.extend(ne.prototype,{YUa:function(){var e=this.zTa;e&&!e.ZUa&&(e.ZUa=this.U5.AW.map(function(e){return{rule:e,ranges:e.ranges().slice()}}))},$Ua:function(e){var t=this.U5,r=this.kj;r.suspendPaint(),e&&(t.AW=e.map(function(e){var t=e.rule;return t.ranges(e.ranges),t}),t.QV()),r.resumePaint()},_Ua:function(e,t,r){this.YUa(),this.U5.rI(e,t,r)},aVa:function(e,t){this.YUa(),this.U5.GR(e,t)},bVa:function(e,t,r){this.YUa(),this.U5.tI(e,t,r)},cVa:function(e,t){this.YUa(),this.U5.HR(e,t)},dVa:function(){this.YUa(),this.U5.Nm()},eVa:function(){this.YUa(),this.U5.QV()}}),ne.$n("conditionalFormat",{init:function(){this.U5=new Xe(this.kj)},undo:function(e){var t=e.ZUa;t&&this.$Ua(t)},dispose:function(e){!1!==(e&&e.clearCache)&&this.U5&&(this.U5.no(),this.U5=B)}}),oe={init:function(){this.conditionalFormats=this._modelManager.U5},dispose:function(e){if(!1!==e.clearCache){var t=this.conditionalFormats;t&&t.OV()}},onLayoutChanged:function(e){var t=e.changeType,r=e.row,n=xt(e),o=e.col,i=Tt(e),a=e.sheetArea,s=this._modelManager,l=this.tables;"addRows"===t?s._Ua(r,n,l&&l.KFc(r,-1,n,-1,!0)):"deleteRows"===t?s.aVa(r,n):"addColumns"===t?s.bVa(o,i):"deleteColumns"===t?s.cVa(o,i):"clear"===t?s.dVa():"setColumnCount"!==t&&"setRowCount"!==t||3!==a&&1!==a||s.eVa()},toJson:function(e,t){var r=this.conditionalFormats,n=t&&t.ignoreStyle;r&&!n&&(e.conditionalFormats=r.toJSON(this))},fromJson:function(e,t,r){var n=r&&r.ignoreStyle;e&&e.conditionalFormats&&!n&&this.conditionalFormats.fromJSON(e.conditionalFormats,this,t)}},x.Worksheet.$n("conditionalFormat",oe),x.Workbook.$n("conditionalFormat",{fromJson:function(e,t,r){this.sheets.forEach(function(e){e.conditionalFormats&&e.conditionalFormats.getRules().forEach(function(e){e.S$a()})})}}),(bt=ie=b.GeneralComparisonOperators||(b.GeneralComparisonOperators={}))[bt.equalsTo=0]="equalsTo",bt[bt.notEqualsTo=1]="notEqualsTo",bt[bt.greaterThan=2]="greaterThan",bt[bt.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",bt[bt.lessThan=4]="lessThan",bt[bt.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",ae=[9,10,13,14,11,12],(mt=se=b.LogicalOperators||(b.LogicalOperators={}))[mt.or=0]="or",mt[mt.and=1]="and",(gt=le=b.ComparisonOperators||(b.ComparisonOperators={}))[gt.equalsTo=0]="equalsTo",gt[gt.notEqualsTo=1]="notEqualsTo",gt[gt.greaterThan=2]="greaterThan",gt[gt.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",gt[gt.lessThan=4]="lessThan",gt[gt.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",gt[gt.between=6]="between",gt[gt.notBetween=7]="notBetween",(pt=b.TextComparisonOperators||(b.TextComparisonOperators={}))[pt.contains=0]="contains",pt[pt.doesNotContain=1]="doesNotContain",pt[pt.beginsWith=2]="beginsWith",pt[pt.endsWith=3]="endsWith",(dt=ue=b.TextCompareType||(b.TextCompareType={}))[dt.equalsTo=0]="equalsTo",dt[dt.notEqualsTo=1]="notEqualsTo",dt[dt.beginsWith=2]="beginsWith",dt[dt.doesNotBeginWith=3]="doesNotBeginWith",dt[dt.endsWith=4]="endsWith",dt[dt.doesNotEndWith=5]="doesNotEndWith",dt[dt.contains=6]="contains",dt[dt.doesNotContain=7]="doesNotContain",(ft=ce=b.ColorCompareType||(b.ColorCompareType={}))[ft.backgroundColor=0]="backgroundColor",ft[ft.foregroundColor=1]="foregroundColor",(ht=he=b.CustomValueType||(b.CustomValueType={}))[ht.empty=0]="empty",ht[ht.nonEmpty=1]="nonEmpty",ht[ht.error=2]="error",ht[ht.nonError=3]="nonError",ht[ht.formula=4]="formula",(ct=fe=b.DateCompareType||(b.DateCompareType={}))[ct.equalsTo=0]="equalsTo",ct[ct.notEqualsTo=1]="notEqualsTo",ct[ct.before=2]="before",ct[ct.beforeEqualsTo=3]="beforeEqualsTo",ct[ct.after=4]="after",ct[ct.afterEqualsTo=5]="afterEqualsTo",(ut=de=b.DateExConditionExpectType||(b.DateExConditionExpectType={}))[ut.dateOccurring=0]="dateOccurring",ut[ut.yearOccurring=1]="yearOccurring",ut[ut.quarterOccurring=2]="quarterOccurring",ut[ut.monthOccurring=3]="monthOccurring",ut[ut.weekOccurring=4]="weekOccurring",ut[ut.dayOccurring=5]="dayOccurring",ut[ut.yearTodate=6]="yearTodate",(lt=b.Top10ConditionType||(b.Top10ConditionType={}))[lt.top=0]="top",lt[lt.bottom=1]="bottom",(st=pe=b.DateOccurringType||(b.DateOccurringType={}))[st.today=0]="today",st[st.yesterday=1]="yesterday",st[st.tomorrow=2]="tomorrow",st[st.last7Days=3]="last7Days",st[st.thisMonth=4]="thisMonth",st[st.lastMonth=5]="lastMonth",st[st.nextMonth=6]="nextMonth",st[st.thisWeek=7]="thisWeek",st[st.lastWeek=8]="lastWeek",st[st.nextWeek=9]="nextWeek",st[st.nextQuarter=10]="nextQuarter",st[st.thisQuarter=11]="thisQuarter",st[st.lastQuarter=12]="lastQuarter",st[st.nextYear=13]="nextYear",st[st.thisYear=14]="thisYear",st[st.lastYear=15]="lastYear",(at=ge=b.QuarterType||(b.QuarterType={}))[at.quarter1=0]="quarter1",at[at.quarter2=1]="quarter2",at[at.quarter3=2]="quarter3",at[at.quarter4=3]="quarter4",(it=me=b.AverageConditionType||(b.AverageConditionType={}))[it.above=0]="above",it[it.below=1]="below",it[it.equalOrAbove=2]="equalOrAbove",it[it.equalOrBelow=3]="equalOrBelow",it[it.above1StdDev=4]="above1StdDev",it[it.below1StdDev=5]="below1StdDev",it[it.above2StdDev=6]="above2StdDev",it[it.below2StdDev=7]="below2StdDev",it[it.above3StdDev=8]="above3StdDev",it[it.below3StdDev=9]="below3StdDev",(ot=be=b.ScaleValueType||(b.ScaleValueType={}))[ot.number=0]="number",ot[ot.lowestValue=1]="lowestValue",ot[ot.highestValue=2]="highestValue",ot[ot.percent=3]="percent",ot[ot.percentile=4]="percentile",ot[ot.automin=5]="automin",ot[ot.formula=6]="formula",ot[ot.automax=7]="automax",(nt=b.BarDirection||(b.BarDirection={}))[nt.leftToRight=0]="leftToRight",nt[nt.rightToLeft=1]="rightToLeft",(rt=b.DataBarAxisPosition||(b.DataBarAxisPosition={}))[rt.automatic=0]="automatic",rt[rt.cellMidPoint=1]="cellMidPoint",rt[rt.none=2]="none",(tt=ye=b.IconSetType||(b.IconSetType={}))[tt.threeArrowsColored=0]="threeArrowsColored",tt[tt.threeArrowsGray=1]="threeArrowsGray",tt[tt.threeTriangles=2]="threeTriangles",tt[tt.threeStars=3]="threeStars",tt[tt.threeFlags=4]="threeFlags",tt[tt.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",tt[tt.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",tt[tt.threeSigns=7]="threeSigns",tt[tt.threeSymbolsCircled=8]="threeSymbolsCircled",tt[tt.threeSymbolsUncircled=9]="threeSymbolsUncircled",tt[tt.fourArrowsColored=10]="fourArrowsColored",tt[tt.fourArrowsGray=11]="fourArrowsGray",tt[tt.fourRedToBlack=12]="fourRedToBlack",tt[tt.fourRatings=13]="fourRatings",tt[tt.fourTrafficLights=14]="fourTrafficLights",tt[tt.fiveArrowsColored=15]="fiveArrowsColored",tt[tt.fiveArrowsGray=16]="fiveArrowsGray",tt[tt.fiveRatings=17]="fiveRatings",tt[tt.fiveQuarters=18]="fiveQuarters",tt[tt.fiveBoxes=19]="fiveBoxes",tt[tt.noIcons=20]="noIcons",(et=Ce=b.IconValueType||(b.IconValueType={}))[et.number=1]="number",et[et.percent=4]="percent",et[et.formula=7]="formula",et[et.percentile=5]="percentile",($e=we=b.ConditionType||(b.ConditionType={}))[$e.relationCondition=0]="relationCondition",$e[$e.numberCondition=1]="numberCondition",$e[$e.textCondition=2]="textCondition",$e[$e.colorCondition=3]="colorCondition",$e[$e.formulaCondition=4]="formulaCondition",$e[$e.dateCondition=5]="dateCondition",$e[$e.dateExCondition=6]="dateExCondition",$e[$e.textLengthCondition=7]="textLengthCondition",$e[$e.top10Condition=8]="top10Condition",$e[$e.uniqueCondition=9]="uniqueCondition",$e[$e.averageCondition=10]="averageCondition",$e[$e.cellValueCondition=11]="cellValueCondition",$e[$e.areaCondition=12]="areaCondition",$e[$e.timeCondition=13]="timeCondition",(Qe=ve=b.RuleType||(b.RuleType={}))[Qe.conditionRuleBase=0]="conditionRuleBase",Qe[Qe.cellValueRule=1]="cellValueRule",Qe[Qe.specificTextRule=2]="specificTextRule",Qe[Qe.formulaRule=3]="formulaRule",Qe[Qe.dateOccurringRule=4]="dateOccurringRule",Qe[Qe.top10Rule=5]="top10Rule",Qe[Qe.uniqueRule=6]="uniqueRule",Qe[Qe.duplicateRule=7]="duplicateRule",Qe[Qe.averageRule=8]="averageRule",Qe[Qe.twoScaleRule=10]="twoScaleRule",Qe[Qe.threeScaleRule=11]="threeScaleRule",Qe[Qe.dataBarRule=12]="dataBarRule",Qe[Qe.iconSetRule=13]="iconSetRule",Se=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)},xe=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)},Te=function(e,t){e.setDate(t)},Ae=function(e){return e.getDate()},ke=function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},Me=function(e,t){return xe(e)<t},Ie=function(e,t){return t<Se(e)},Ee=function(e,t){return e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds()&&e.getMilliseconds()===t.getMilliseconds()},Re=function(e,t){return new Date(1899,11,30,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())<new Date(1899,11,30,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())},De=function(e,t){return!Re(e,t)&&!Ee(e,t)},b.$V=function(e,t,r,n,o,i,a,s,l){return new Fe(e,{compareType:t,expected:r,formula:n,customValueType:o,type:i,ranges:a,item1:s,item2:l})},b.Cxb=new L,Ne=["conType","compareType","item1","item2","ignoreBlank","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],kt.prototype.context=function(e){if(1===arguments.length){this.xc=e;var t=this.item1(),r=this.item2();t&&t.context&&t.context(e),r&&r.context&&r.context(e)}return this.xc},kt.prototype.j_a=function(e){var t=this.item1(),r=this.item2();e?this.q$a=!0:this.p$a=!0,t&&t.j_a(e),r&&r.j_a(e)},kt.prototype.k_a=function(){var e=this.item1(),t=this.item2();delete this.q$a,delete this.p$a,e&&e.k_a(),t&&t.k_a()},kt.prototype.initExpression=function(e,t,r){var n,o,i,a,s,l=this.item1(),u=this.item2();l&&l.initExpression&&l.initExpression(),u&&u.initExpression&&u.initExpression(),e=e||this.xc,n=this.Yw,e&&n&&!this.Lf&&(r=this.ranges()?(t=(o=H(this.ranges())).r,o.c):(t=t||0,r||0),i=e.getCalcService(),a=e.yj(),i&&a&&(s=!1,this.q$a&&(s=!this.p$a),this.Lf=i.parse(a,n,t,r,!1,!0,s)))},kt.prototype.expression=function(e,t,r,n){var o,i,a;return 1===arguments.length?(this.Lf=e,t=t||this.xc,e?t&&(n=this.ranges()?(r=(o=H(this.ranges())).r,o.c):(r=r||0,n||0),i=t.getCalcService(),a=t.yj(),i&&a&&(this.Yw=i.unparse(a,e,r,n))):this.Yw=e):this.Lf||this.initExpression(t,r,n),this.Lf},kt.prototype.getFormulaString=function(e,t,r,n){var o,i,a;return e=e||this.xc,o=this.Lf,i=this.Yw,e&&i?(o||(this.initExpression(e,t,r),o=this.Lf),a=H(this.ranges()),t=F(t)?a.r:t,r=F(r)?a.c:r,e.getCalcService().unparse(e.yj(),o,t,r,w,!!n)):i},kt.prototype.formula=function(e,t,r){if("string"!=typeof e){var n=this.item1(),o=this.item2();return 0===r&&n&&n.formula?n.formula(e,t,r):1===r&&o&&o.formula?o.formula(e,t,r):this.getFormulaString(w,e,t)}this.Yw=e,this.Lf=B},kt.prototype.adjustOffset=function(e,t){var r=this.item1();r&&r.adjustOffset&&r.adjustOffset(e,t),(r=this.item2())&&r.adjustOffset&&r.adjustOffset(e,t),this.offsetRow=e,this.offsetCol=t},kt.prototype.relationConditionEvaluate=function(n,o,i,r,e){var t,a,s=this;function l(e,t){if(e)return e.ignoreBlank(s.ignoreBlank()),arguments.length<5?function(e,t){if(n&&e&&3===e.conType()){var r=n.getActualStyle(o,i,3,!0);r&&(0===e.RV()?t=r.backColor:1===e.RV()&&(t=r.foreColor))}return t}(e,r):t}function u(e,t){return!F(e)&&e.evaluate(n,o,i,t)}return t=l(s.item1(),r),a=l(s.item2(),e),(u(s.item1(),t)?1:0)+(u(s.item2(),a)?1:0)>s.RV()},kt.prototype.cellValueConditionEvaluate=function(e,t,r,n){var o=this.getExpected(e,t,r);return!(o!==B||!e||!e.lRa)||this.cellValueConditionCheckCondition(o,n)},kt.prototype.cellValueConditionCheckCondition=function(e,t){var r,n,o,i,a=0,s=!1,l=this.RV();if(F(t)&&F(e))switch(l){case ie.equalsTo:case ie.greaterThanOrEqualsTo:case ie.lessThanOrEqualsTo:return!0;case ie.notEqualsTo:case ie.greaterThan:case ie.lessThan:default:return!1}return"boolean"==typeof e||"boolean"==typeof t?At(l,t,e):(r={},F(t)?this.treatNullValueAsZero()?s=!0:a=t:"boolean"!=typeof t&&I(t,r)&&(a=r.value,s=!isNaN(a)),n=0,o=!1,I(e,r)&&(n=r.value,o=!0),i=ae[l],s?o?At(l,a,n):Y(i,t,e):"string"==typeof t?o?Y(i,t,n):"string"==typeof e?Y(i,t,e):1===l:!!F(t)&&l===ie.notEqualsTo)},kt.prototype.numberConditionEvaluate=function(e,t,r,n){var o=this.numberConditionGetExpected(e,t,r);return!(o!==B||!e||!e.lRa)||(this.integerValue()&&(o=isNaN(o)?B:(0<o?M:i)(o)),this.numberConditionCheckCondition(o,n))},kt.prototype.numberConditionCheckCondition=function(e,t){var r;if((F(t)||""===t)&&this.ignoreBlank())return!0;if(isNaN(t))return!1;if(F(e)){if(this.ignoreBlank())return!0;e=0}try{r=parseFloat(t)}catch(e){return!1}return!(this.integerValue()&&r-M(r)!=0)&&At(this.RV(),r,e)},kt.prototype.numberConditionGetExpected=function(e,t,r){var n;return this.Yw&&0<this.Yw.length&&(n=e.Cf())?n.evaluate(e.yj(),this.expression(B,e),t,r):this.expected()},kt.prototype.textConditionEvaluate=function(e,t,r,n){var o,i,a,s=this,l=s.compareType(),u=s.ignoreCase();function c(e,t){return s.testTextByCondition(t,e,"^","$",function(){return u?e.toLowerCase()===t.toLowerCase():e===t})}function h(e,t){return s.testTextByCondition(t,e,"^","",function(){return R(t,e,u)})}function f(e,t){return s.testTextByCondition(t,e,"","$",function(){return D(t,e,u)})}function d(e,t){return s.testTextByCondition(t,e,"","",function(){return N(t,e===w||e===B?"":e,u)})}if(!s.forceValue2Text()&&_(n,Date))return l!==ue.beginsWith&&l!==ue.endsWith&&l!==ue.contains&&(l===ue.doesNotBeginWith||l===ue.doesNotEndWith||l===ue.doesNotContain);if(o=F(n)?"":""+n,s.ignoreBlank()&&!o)return!0;if(i=this.getExpected(e,t,r),a=F(i)?"":""+i,s.hasWildcard(a)&&"number"==typeof n)return l===ue.doesNotBeginWith||l===ue.doesNotContain||l===ue.doesNotEndWith||l===ue.notEqualsTo;switch(l){case ue.equalsTo:return c(a,o);case ue.notEqualsTo:return!c(a,o);case ue.beginsWith:return h(a,o);case ue.doesNotBeginWith:return!h(a,o);case ue.endsWith:return f(a,o);case ue.doesNotEndWith:return!f(a,o);case ue.contains:return d(a,o);case ue.doesNotContain:return!d(a,o);default:return!1}},kt.prototype.hasWildcard=function(e){return-1<e.indexOf("*")||-1<e.indexOf("?")},kt.prototype.testTextByCondition=function(e,t,r,n,o){var i;return this.useWildCards()?this.regex()?a.qb(this.regex()).test(e):(i=a.ub(t))?(i=r+i+n,this.ignoreCase()?a.sb(i).test(e):a.qb(i).test(e)):o():o()},kt.prototype.colorConditionEvaluate=function(e,t,r,n){var o,i,a;function s(e){return F(e)||""===e?B:G.ec(e)}if(o=s(this.expected()),F(o)||""===o){if(this.ignoreBlank()||F(o)&&F(n))return!0}else if(i=s(n),(F(i)||""===i)&&e&&e.getDefaultStyle&&(a=e.getDefaultStyle(),this.RV()===ce.backgroundColor?i=a.backColor:this.RV()===ce.foregroundColor&&(i=a.foreColor)),!F(i)&&""!==i)return l.Common.pc.Pka(i,o);return!1},kt.prototype.formulaConditionEvaluate=function(e,t,r,n){var o,i,a;if(!P)return!1;if(this.customValueType()===he.formula)return o=this.getExpected(e,t,r),!(!this.ignoreBlank()||!F(o)&&""!==o)||(i={},!!v.Uh(o,i)&&i.value);switch(a=v.vf,this.customValueType()){case he.empty:return F(n)||""===n;case he.nonEmpty:return!F(n)&&""!==n;case he.error:return a(n);case he.nonError:return!a(n);default:return!1}},kt.prototype.formulaConditionGetExpected=function(e,t,r){var n,o,i,a,s,l,u,c,h,f;if(this.Yw&&0<this.Yw.length){if(!(n=e.Cf()))return this.expected();if(o=n._evaluateParsedFormula(e.yj(),this.expression(w,e),y._createCellIdentity(t,r),!0),u=l=s=a=i=void 0,v._isReference(o)){for(i=o.getRowCount(0),a=o.getColumnCount(0),s=[],l=0;l<i;l++)for(s[l]=[],u=0;u<a;u++)s[l][u]=o.getValue(0,l,u);o=s}else if(v.Ca(o)){for(i=o.getRowCount(),a=o.getColumnCount(),s=[],l=0;l<i;l++)for(s[l]=[],u=0;u<a;u++)s[l][u]=o.getValue(l,u);o=s}return _(o,Array)?(i=Z(o),a=Z(o[0]),1===i&&1===a?o[0][0]:(h=t-(c=function(e,t,r){var n,o;for(n=0;n<e.length;n++)if((o=e[n]).contains(t,r))return o}(this.ranges(),t,r)).row,f=r-c.col,h<i&&f<a?o[h][f]:d.Errors.NotAvailable)):o}return this.expected()},kt.prototype.dateOrTimeEvaluate=function(e,t,r,n,o,i,a){var s,l;if((F(n)||""===n)&&this.ignoreBlank())return!0;if(!_(n,Date))return this.RV()===fe.notEqualsTo;if(s=B,l=this.getExpected(e,t,r),_(l,Date)?s=l:"string"==typeof l?s=V.Qa(l):"number"==typeof l&&(s=V.Xb(l)),F(s))return!!this.ignoreBlank();switch(this.RV()){case fe.equalsTo:return o(s,n);case fe.notEqualsTo:return!o(s,n);case fe.after:return a(s,n);case fe.afterEqualsTo:return a(s,n)||o(s,n);case fe.before:return i(s,n);case fe.beforeEqualsTo:return i(s,n)||o(s,n);default:return!1}},kt.prototype.dateConditionEvaluate=function(e,t,r,n){return this.dateOrTimeEvaluate(e,t,r,n,ke,Ie,Me)},kt.prototype.timeConditionEvaluate=function(e,t,r,n){return this.dateOrTimeEvaluate(e,t,r,n,Ee,De,Re)},kt.prototype.dateExConditionEvaluate=function(e,t,r,n){var o=this.A4(e,t,r);return!F(o)&&this.dateExConditionCheckCondition(o,n)},kt.prototype.getExConditionDateScope=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_=B,P=B,L=new Date,O=new Date(L.getFullYear(),L.getMonth(),L.getDate(),L.getHours(),L.getMinutes(),L.getSeconds(),L.getMilliseconds());switch(e){case pe.last7Days:Te(O,Ae(O)-6),_=Se(O),P=xe(L);break;case pe.yesterday:Te(O,Ae(O)-1),_=Se(O),P=xe(O);break;case pe.today:_=Se(L),P=xe(L);break;case pe.tomorrow:Te(O,Ae(O)+1),_=Se(O),P=xe(O);break;case pe.lastWeek:Te(t=L,Ae(L)-L.getDay()-7),(r=O).setDate(Ae(O)-O.getDay()-1),_=Se(t),P=xe(r);break;case pe.thisWeek:Te(n=L,Ae(L)-L.getDay()),Te(o=O,Ae(O)-O.getDay()+6),_=Se(n),P=xe(o);break;case pe.nextWeek:Te(i=L,Ae(L)-L.getDay()+7),Te(a=O,Ae(O)-O.getDay()+13),_=Se(i),P=xe(a);break;case pe.lastMonth:Te(s=L,1),s.setMonth(L.getMonth()-1),Te(l=O,0),_=Se(s),P=xe(l);break;case pe.thisMonth:Te(u=L,1),Te(c=O,1),c.setMonth(O.getMonth()+1),Te(c,0),_=Se(u),P=xe(c);break;case pe.nextMonth:Te(h=L,1),h.setMonth(L.getMonth()+1),Te(f=O,1),f.setMonth(O.getMonth()+2),Te(f,0),_=Se(h),P=xe(f);break;case pe.nextQuarter:g=(p=(d=L).getMonth())%3,d.setDate(1),d.setMonth(p-g+3),(m=O).setDate(1),m.setMonth(p-g+3+2),b=2===m.getMonth()||11===m.getMonth()?31:30,m.setDate(b),_=Se(d),P=xe(m);break;case pe.thisQuarter:w=(C=(y=L).getMonth())%3,y.setDate(1),y.setMonth(C-w),(v=O).setDate(1),v.setMonth(C-w+2),S=2===v.getMonth()||11===v.getMonth()?31:30,v.setDate(S),_=Se(y),P=xe(v);break;case pe.lastQuarter:A=(T=(x=L).getMonth())%3,x.setDate(1),x.setMonth(T-A-3),(k=O).setDate(1),k.setMonth(T-A-3+2),M=2===k.getMonth()||11===k.getMonth()?31:30,k.setDate(M),_=Se(x),P=xe(k);break;case pe.nextYear:(I=L).setDate(1),I.setFullYear(I.getFullYear()+1),I.setMonth(0),(E=O).setFullYear(E.getFullYear()+1),E.setMonth(11),E.setDate(31),_=Se(I),P=xe(E);break;case pe.thisYear:(R=L).setDate(1),R.setMonth(0),(D=O).setMonth(11),D.setDate(31),_=Se(R),P=xe(D);break;case pe.lastYear:(N=L).setFullYear(N.getFullYear()-1),N.setDate(1),N.setMonth(0),(F=O).setFullYear(F.getFullYear()-1),F.setMonth(11),F.setDate(31),_=Se(N),P=xe(F)}return{from:_,to:P}},kt.prototype.dateExConditionCheckCondition=function(e,t){var r,n,o,i,a,s,l,u,c,h;if(r=t,this.ignoreBlank()&&(F(r)||""===r))return!0;try{r=v.Wh(r)}catch(e){return!1}if((o=this.expectTypeId())===de.dateOccurring){if(a=(i=this.getExConditionDateScope(e)).from,s=i.to,!F(a)&&!F(s))return l=b.$V(we.dateCondition,fe.afterEqualsTo,a,B),u=b.$V(we.dateCondition,fe.beforeEqualsTo,s,B),b.$V(we.relationCondition,se.and,B,B,B,B,B,l,u).evaluate(B,0,0,r)}else if(n=this.A4(B,0,0),!F(n)){if(o===de.yearOccurring)return n===r.getFullYear();if(o===de.quarterOccurring)return function(e,t){switch(e){case ge.quarter1:return 0<=t.getMonth()&&t.getMonth()<=2;case ge.quarter2:return 3<=t.getMonth()&&t.getMonth()<=5;case ge.quarter3:return 6<=t.getMonth()&&t.getMonth()<=8;case ge.quarter4:return 9<=t.getMonth()&&t.getMonth()<=11;default:return!1}}(n,r);if(o===de.monthOccurring)return n===r.getMonth();if(o===de.weekOccurring)return n===r.getDay();if(o===de.dayOccurring)return n===Ae(r);if(o===de.yearTodate)return c=new Date,h=new Date,c.setMonth(0,1),c.setHours(0,0,0,0),h.setHours(23,59,59,59),c<=r&&r<=h}return!1},kt.prototype.textLengthConditionEvaluate=function(e,t,r,n){var o,i;return F(n)||""===n?this.ignoreBlank():(o=F(n)?0:(""+n).length,"number"==typeof(i=this.A4(e,t,r))&&At(this.RV(),o,i))},kt.prototype.top10ConditionEvaluate=function(e,t,r,n){var o,i,a,s=this;if(F(n)||""===n)return s.ignoreBlank();if(o=s.A4(e,t,r),!F(o)&&(i=void 0,i=s.k$a?(F(s.mxb)&&(s.mxb=s.getTopValues(e,o,s.ranges())),s.mxb):s.getTopValues(e,o,s.ranges()))){a=0;try{a=s.Pa(n)}catch(e){return!1}if(h.Bb(i,a))return!0}return!1},kt.prototype.A4=function(e,t,r){var n=this.getExpected(e,t,r);return n=parseInt(n,10),isNaN(n)||!isFinite(n)?B:n},kt.prototype.adjustRange=function(e,t){return W(e.row,e.col,Math.min(xt(e),t.getRowCount()),Math.min(Tt(e),t.getColumnCount()))},kt.prototype.getTopValues=function(e,t,r){var n,o,i,a,s,l,u,c,h,f=0===this.type()?1:-1,d=[];if(!r)return d;for(n=this.UV(e,r),o=Z(n),u=0;u<o;u++)for(i=this.adjustRange(n[u],e),c=0;c<xt(i);c++)for(a=c+i.row,h=0;h<Tt(i);h++)s=h+i.col,l=this.Pa(e.getValue(a,s)),F(l)||d.push(l);return d.sort(function(e,t){return(t-e)*f}),Z(d)>t&&(d=d.slice(0,t)),d},kt.prototype.Pa=function(e){return("number"==typeof e||_(e,Date))&&P?m(e):B},kt.prototype.uniqueConditionEvaluate=function(e,t,r,n){var o,i,a,s,l=n;return F(l)||""===l?this.ignoreBlank():(P&&S(l)&&(l=m(l)),o=this.getExpected(e,t,r),i={},v.Uh(o,i),!F(a=i.value)&&(s=this.duplicatedArrayCached||this.getDuplicated(e,this.ranges()),!F(s)&&h.Bb(s,l)?!0===a:!0!==a))},kt.prototype.getDuplicated=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d=[],p={},g=this.UV(e,t);if(g)for(r=Z(g),n=0;n<r;n++)for(o=g[n],i=xt(o=this.adjustRange(o,e)),a=Tt(o),s=0;s<i;s++)for(l=s+o.row,u=0;u<a;u++)c=u+o.col,h=e.getValue(l,c,3),!F(h)&&P&&S(h)&&(h=m(h)),(f=p[h])?1===f&&d.push(h):p[h]=1;return d},kt.prototype.VV=function(e,t){var r,n=e.length;for(r=0;r<n;r++)if(e[r].key===t)return!0;return!1},kt.prototype.averageConditionEvaluate=function(e,t,r,n){var o,i,a,s,l,u,c,h;if(!P)return!1;if((o=this).ignoreBlank()&&(F(n)||""===n))return!0;if(o.WV(),i=o.k$a?(F(o.mxb)&&(o.mxb=o.getExpected(e,t,r)),o.mxb):o.getExpected(e,t,r),s=I(i,a={})?a.value:NaN,l=B,u=o.TV?o.XV(e,o.TV,t,r):B,F(u)||(l=I(u,a={})?a.value:NaN),S(n)&&(c=m(n),!isNaN(s)))switch(h=isNaN(l),o.type()){case me.above:return s<c;case me.below:return c<s;case me.equalOrAbove:return s<=c;case me.equalOrBelow:return c<=s;case me.above1StdDev:return!h&&s+l<c;case me.below1StdDev:return!h&&c<s-l;case me.above2StdDev:return!h&&s+2*l<c;case me.below2StdDev:return!h&&c<s-2*l;case me.above3StdDev:return!h&&s+3*l<c;case me.below3StdDev:return!h&&c<s-3*l;default:return!1}return!1},kt.prototype.WV=function(){this.ranges()&&(this.Lf=this.YV("AVERAGE",this.ranges()),4<=this.type()&&this.type()<=9&&(this.TV=this.YV("STDEV",this.ranges())))},kt.prototype.YV=function(e,t){var r,n,o,i;if(!P)return B;if(r=f.findGlobalFunction(e)){for(n=[],o=Z(t),i=0;i<o;i++)n[i]=$(t[i]);return d.Jh(r,n)}return B},kt.prototype.averageConditionGetExpected=function(e,t,r){var n=e.Cf();return n?n._evaluateParsedFormula(e.yj(),this.expression(w,e),y._createCellIdentity(t,r),!1):B},kt.prototype.nxb=function(){var e=this.conType();e!==we.averageCondition&&e!==we.top10Condition||(this.k$a=!0)},kt.prototype.oxb=function(){this.k$a=!1,this.mxb=w},kt.prototype.XV=function(e,t,r,n){var o=e.Cf();return o?o._evaluateParsedFormula(e.yj(),t,y._createCellIdentity(r,n),!1):B},kt.prototype.ZV=function(e,t){var r,n;for(n=0;n<Z(t);n++)r=t[n],_(r,Array)&&0<Z(r)?1<Z(t)?e.push(r[0]):e.push.apply(e,r):e.push(r)},kt.prototype.getValidList=function(e,t,r){var n,o,i=[],a=this.getValidListImp(e,t,r);for(n=0,o=Z(a);n<o;n++)i.push(a[n].value);return i},kt.prototype.CIc=function(){return this.Yw&&0<this.Yw.length},kt.prototype.getValidListImp=function(e,t,r){var n,o,i,a,s,l,u=[];if(this.Yw&&0<this.Yw.length)n=this.getExpected(e,t,r),_(n,Array)?this.ZV(u,n):u.push(n);else if(this.expected()&&0<this.expected().length&&(o=this.expected().replace(/\\,/g,String.fromCharCode(206)).split(",")))for(i=0;i<Z(o);i++)a=o[i],F(a)||(s=RegExp(String.fromCharCode(206),"g"),""!==(l=C.trim(a).replace(s,","))&&u.push({text:l,value:l}));return u},kt.prototype.areaConditionEvaluate=function(e,t,r,n){var o,i,a,s;function l(e,t,r){return _(e,Date)&&_(t,Date)?e.valueOf()===t.valueOf():r||"string"!=typeof e||"string"!=typeof t?e===t:e.toLowerCase()===t.toLowerCase()}if(F(n)||""===n)return!0===this.ignoreBlank();for(o=this.getValidList(e,t,r),i=0;i<Z(o);i++){if(a=o[i],F(a)&&F(n))return!0;if(this.Yw){if(l(a,n,!1))return!0}else if(s=e.getActualStyle(t,r,3,!0),l(u.ul(s,a,!0),n,!0))return!0}return!1},kt.prototype.areaConditionGetExpected=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m=[];if(this.Yw){if(l=s=a=i=o=n=void 0,!(u=e.Cf()))return m;if(c=u._evaluateParsedFormula(e.yj(),this.expression(w,e),y._createCellIdentity(t,r),!0),v._isReference(c))for(n=c.getRowCount(0),o=c.getColumnCount(0),h=c.getRow(0),f=c.getColumn(0),(d=c._source&&c._source.kj)&&(p=d.getRowCount(),g=d.getColumnCount(),n=p<n?k(p-h,0):n,o=g<o?k(g-f,0):g),i=0;i<n;i++)for(m[i]=[],a=0;a<o;a++)s=c.getValue(0,i,a),l=d?d.getText(h+i,f+a):s,m[i][a]={value:s,text:l};else if(v.Ca(c))for(n=c.getRowCount(),o=c.getColumnCount(),i=0;i<n;i++)for(m[i]=[],a=0;a<o;a++)s=c.getValue(i,a),m[i][a]={value:s,text:s}}else m.push({value:this.expected(),text:this.expected()});return m},kt.prototype.reset=function(){var e=this;switch(e.ignoreBlank(!1),e.RV(1),e.item1(B),e.item2(B),e.value1=B,e.value2=B,e.expected(B),e.RV(0),e.integerValue(!1),e.operator=0,e.text="",e.RV(0),e.useWildCards(!0),e.ignoreCase(!1),e.forceValue2Text(!1),e.customValueType(0),e.Lf=B,e.type(0),this.expectTypeId(0),e.ranges(B),e.isPercent(!1),e.regex(B),e.conType()){case we.relationCondition:e.ignoreBlank(!1),e.RV(1);break;case we.numberCondition:e.RV(0),e.integerValue(!1);break;case we.textCondition:e.RV(0),e.useWildCards(!0),e.forceValue2Text(!1);break;case we.colorCondition:e.RV(0);break;case we.formulaCondition:e.customValueType(0),e.TV=B;break;case we.dateCondition:case we.timeCondition:e.RV(0);break;case we.dateExCondition:e.expectTypeId(0);break;case we.textLengthCondition:e.RV(0);break;case we.top10Condition:case we.averageCondition:e.type(0);break;case we.cellValueCondition:e.operator=6}},kt.prototype.evaluate=function(e,t,r,n){var o=this.conType();return!F(o)&&this[we[o]+"Evaluate"](e,t,r,n)},kt.prototype.getExpectedNormal=function(e,t,r,n,o,i){var a,s=this.Yw,l=this.expected();return s&&(a=e.Cf())?a._evaluateParsedFormula(e.yj(),this.expression(w,e),y._createCellIdentity(t,r),!1,i):l},kt.prototype.getExpected=function(e,t,r){var n=this;switch(n.conType()){case 2:return n.getExpectedNormal(e,t,r,t-n.offsetRow,r-n.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return n.getExpectedNormal(e,t,r,t-n.offsetRow,r-n.offsetCol,!1);case 8:return n.getExpectedNormal(e,t,r,t,r);case 0:return B;case 1:return n.numberConditionGetExpected(e,t,r);case 3:return B;case 4:return n.formulaConditionGetExpected(e,t,r);case 10:return n.averageConditionGetExpected(e,t,r);case 12:return n.areaConditionGetExpected(e,t,r);default:return B}},kt.prototype.UV=function(e,t){var r,n,o,i=[];for(r=0,n=Z(t);r<n;r++)o=e.Tq(t[r]),i.push(o);return i},kt.prototype.getExpressions=function(){var e=[],t=this;return 0===t.conType()?(t.item1()&&t.item1().getExpressions&&(e=t.item1().getExpressions()),t.item2()&&t.item2().getExpressions&&(e=e.concat(t.item2().getExpressions())),e):(t.Lf||t.initExpression(),t.Lf?[t.Lf]:[])},kt.prototype.setExpressions=function(e,t){var r,n=this;return t&&t.push({type:"condition",condition:this,expressions:n.getExpressions()}),0===n.conType()?(n.item1()&&n.item1().setExpressions&&(r=n.item1().getExpressions().length,n.item1().setExpressions(e.slice(0,r))),void(n.item2()&&n.item2().setExpressions&&n.item2().setExpressions(e.slice(r)))):void n.expression(e[0])},kt.prototype.toJSON=function(e){return te.call(this,e,Ne)},kt.prototype.fromJSON=function(e,t,r){e&&(re.call(this,t,Ne,e,r),t&&t.Wu&&t.Wu.useR1C1&&t instanceof p.Worksheet&&(this.context(t),s(this)),this.j_a(!0),this.initExpression(),this.k_a())},kt.fromSource=function(e){return b.$V(12,B,e,B)},kt.fromFormula=function(e){return b.$V(12,B,"",e)},kt.fromDay=function(e){var t=b.$V(6,B,e);return t.expectTypeId(5),t},kt.fromMonth=function(e){var t=b.$V(6,B,e);return t.expectTypeId(3),t},kt.fromQuarter=function(e){var t=b.$V(6,B,e);return t.expectTypeId(2),t},kt.fromWeek=function(e){var t=b.$V(6,B,e);return t.expectTypeId(4),t},kt.fromYear=function(e){var t=b.$V(6,B,e);return t.expectTypeId(1),t},Fe=kt,(b.Condition=Fe).prototype.conType=ee("conType",B),Fe.prototype.ranges=ee("ranges",B,function(e){var t=this.item1(),r=this.item2();t&&t.ranges&&t.ranges(e),r&&r.ranges&&r.ranges(e)}),Fe.prototype.ignoreBlank=ee("ignoreBlank",!1),Fe.prototype.compareType=ee("compareType",w),Fe.prototype.RV=Fe.prototype.compareType,Fe.prototype.expected=ee("expected",w),Fe.prototype.item1=ee("item1",B),Fe.prototype.item2=ee("item2",B),Fe.prototype.treatNullValueAsZero=ee("treatNullValueAsZero",!1),Fe.prototype.integerValue=ee("integerValue",!1),Fe.prototype.forceValue2Text=ee("forceValue2Text",!1),Fe.prototype.useWildCards=ee("useWildCards",!0),Fe.prototype.regex=ee("regex",B),Fe.prototype.ignoreCase=ee("ignoreCase",!1),Fe.prototype.customValueType=ee("customValueType",w),Fe.prototype.expectTypeId=ee("expectTypeId",0),Fe.prototype.type=ee("type",B),Fe.prototype.isPercent=ee("isPercent",!1),Mt.prototype.stopIfTrue=function(e){},Mt.prototype.evaluate=function(e,t,r,n){var o,i;return this.contains(t,r)?(this.initCondition(),o={baseRow:0,baseCol:0},this.getBaseCoordinate(o),this.condition().adjustOffset(t-o.baseRow,r-o.baseCol),i=B,this.condition().evaluate(e,t,r,n)&&(i=this.getExpected()||b.Cxb),this.condition().adjustOffset(0,0),i):B},Mt.prototype.contains=function(e,t){var r,n,o=this.ranges();if(o)for(r=Z(o),n=0;n<r;n++)if(o[n].contains(e,t))return!0;return!1},Mt.prototype.createCondition=function(){return this.xyb=!1,null},Mt.prototype.initCondition=function(e){var t=this.condition();t||((t=this.createCondition())&&(t.ranges(this.ranges()),this.condition(t)),e&&this.context(e),this.context()&&t&&t.context(this.context()))},Mt.prototype.yyb=function(){var e;this.xyb&&((e=this.condition())||(this.initCondition(),e=this.condition()),e&&!e.Lf&&e.initExpression())},Mt.prototype.context=function(e){return 1===arguments.length&&(this.xc=e,this.condition()&&this.condition().context(e)),this.xc},Mt.prototype.getExpected=function(){return this.style()},Mt.prototype.reset=function(){this.ranges(B),this.condition(B),this.style(B),this.stopIfTrue(!1),this.priority(1)},Mt.prototype.intersects=function(e,t,r,n){var o,i,a=this.ranges();if(a)for(o=Z(a),i=0;i<o;i++)if(a[i].intersect(e,t,r,n))return!0;return!1},Mt.prototype.isScaleRule=function(){return!1},Mt.prototype.getBaseCoordinate=function(e){var t,r,n,o;if(e.baseRow=Number.MAX_VALUE,e.baseCol=Number.MAX_VALUE,this.ranges()&&0<Z(this.ranges()))for(t=0;t<Z(this.ranges());t++)n=-1===(n=(r=this.ranges()[t]).row)?0:n,o=-1===(o=r.col)?0:o,e.baseRow=A(n,e.baseRow),e.baseCol=A(o,e.baseCol);else e.baseRow=0,e.baseCol=0},Mt.prototype._V=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d=r?t:0,p=r?0:t;if(this.yyb(),this.ranges())for(o=Z(this.ranges()),i=0;i<o;i++)if(a=this.ranges()[i],s=r?a.row:a.col,l=(r?xt:Tt)(a),-1!==s){if(n&&0<n.length){for(u=!1,c=0,h=n.length;c<h;c++)if((f=n[c])&&(!r&&f.col===e&&(f.col===a.col&&f.col+f.colCount-t===a.col+a.colCount||a.row===f.row&&a.rowCount===f.rowCount&&a.col>=f.col&&a.col+a.colCount<=f.col+f.colCount)||r&&f.row===a.row&&f.row+f.rowCount-t===a.row+a.rowCount&&a.row===e)){this.ranges()[i]=W(a.row,a.col,xt(a)+d,Tt(a)+p),u=!0;break}if(u)break}e<=s?this.ranges()[i]=W(a.row+d,a.col+p,xt(a),Tt(a)):e<=s+l&&(this.ranges()[i]=W(a.row,a.col,xt(a)+d,Tt(a)+p))}},Mt.prototype.rI=function(e,t,r){this._V(e,t,!0,r)},Mt.prototype.tI=function(e,t,r){this._V(e,t,!1,r)},Mt.prototype.aW=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d=r?e:0,p=r?0:e,g=r?t:0,m=r?0:t;if(this.yyb(),this.ranges()){for(n=[],o=Z(this.ranges()),i=0;i<o;i++)a=this.ranges()[i],s=r?a.row:a.col,l=(r?xt:Tt)(a),-1!==s&&(e<s?s+l<=e+t?n.push(a):this.ranges()[i]=W(a.row-g,a.col-m,xt(a),Tt(a)):e<s+l&&(u=W(a.row,a.col,xt(a)-A(a.row+xt(a)-d,g),Tt(a)-A(a.col+Tt(a)-p,m)),0===Tt(u)||0===xt(u)?n.push(a):this.ranges()[i]=u));for(c=Z(n),h=0;h<c;h++)f=n[h],z(this.ranges(),f)}},Mt.prototype.GR=function(e,t){this.aW(e,t,!0)},Mt.prototype.HR=function(e,t){this.aW(e,t,!1)},Mt.prototype.toJSON=function(e){return te.call(this,e)},Mt.prototype.fromJSON=function(e,t,r){e&&(re.call(this,t,B,e,r),this.initCondition(t))},Mt.prototype.S$a=function(){var e=this.condition();e&&s(e)},Mt.prototype.hW=function(e){var t,r,n=[],o=Z(e);for(r=0;r<o;r++)t=e[r],n.push(W(t.row,t.col,xt(t),Tt(t)));return n},Mt.prototype.iW=function(){var e,t,r=this.cW,n=this.ranges();if(!r)return this.cW=this.hW(n),!1;if(Z(r)!==(e=Z(n)))return!0;for(t=0;t<e;t++)if(!r[t].equals(n[t]))return!0;return!1},_e=Mt,(Pe=(b.ConditionRuleBase=_e).prototype).ruleType=ee("ruleType",B),Pe.ranges=ee("ranges",B,function(e){var t,r=this.condition();r&&r.ranges()&&((t=r.xc)&&t._modelManager.YUa(),r.ranges(e))}),Pe.condition=ee("condition",B),Pe.style=ee("style",B),Pe.priority=ee("priority",1),Pe.stopIfTrue=ee("stopIfTrue",!1),Le=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],St(It,yt=_e),It.prototype.value1=function(e,t){var r,n;return 1!==arguments.length?(r=this.condition())&&(n=r.formula(e,t,0))&&0<n.length?"="+E(C.trim(""+n),"="):this._Qa:void(this._Qa=e)},It.prototype.value2=function(e,t){var r,n;return 1!==arguments.length?(r=this.condition())&&(n=r.formula(e,t,1))&&0<n.length?"="+E(C.trim(""+n),"="):this.aRa:void(this.aRa=e)},It.prototype.formula=function(e,t){var r=this.condition();return"string"!=typeof e?r&&r.formula(e,t)||this.Yw:(this.Yw=e,void(r&&r.formula(e)))},It.prototype.cellValueRuleCreateCondition=function(){var e,t,r,n,o,i,a,s=this.value1(),l=this.value2(),u=this.ranges(),c=this.bW(s)?E(s,"="):B,h=this.bW(l)?E(l,"="):B,f=this.operator();return f===le.between?((e=b.$V(we.cellValueCondition,3,s,c,w,w,u)).treatNullValueAsZero(!0),(t=b.$V(we.cellValueCondition,5,l,h,w,w,u)).treatNullValueAsZero(!0),o=b.$V(we.relationCondition,1,B,B,B,B,u,e,t),(r=b.$V(we.cellValueCondition,5,s,c,w,w,u)).treatNullValueAsZero(!0),(n=b.$V(we.cellValueCondition,3,l,h,w,w,u)).treatNullValueAsZero(!0),i=b.$V(we.relationCondition,1,B,B,B,B,u,r,n),b.$V(we.relationCondition,0,B,B,B,B,u,o,i)):f===le.notBetween?((e=b.$V(we.cellValueCondition,4,s,c,w,w,u)).treatNullValueAsZero(!0),t=b.$V(we.cellValueCondition,2,l,h,w,w,u),e.treatNullValueAsZero(!0),o=b.$V(we.relationCondition,0,B,B,B,B,u,e,t),(r=b.$V(we.cellValueCondition,2,s,c,w,w,u)).treatNullValueAsZero(!0),(n=b.$V(we.cellValueCondition,4,l,h,w,w,u)).treatNullValueAsZero(!0),i=b.$V(we.relationCondition,0,B,B,B,B,u,r,n),b.$V(we.relationCondition,1,B,B,B,B,u,o,i)):((a=b.$V(11,f,s,c,w,w,u)).treatNullValueAsZero(!0),a)},It.prototype.bW=function(e){return!F(e)&&"="===e[0]},It.prototype.specificTextRuleCreateCondition=function(){var e,t,r,n,o=this.operator();switch(o){case 2:e=2;break;case 3:e=4;break;case 0:e=6;break;case 1:e=7;break;default:e=0}return t=this.text(),r=B,t&&"="===t[0]&&(r=t),(n=b.$V(2,e,t,r,w,w,this.ranges())).ignoreCase(!0),n.useWildCards(2!==o&&3!==o),n},It.prototype.formulaRuleCreateCondition=function(){var e=this.ranges();return b.$V(4,B,B,this.Yw,4,B,e)},It.prototype.dateOccurringRuleCreateCondition=function(){return b.$V(6,B,this.type(),B,B,w,this.ranges())},It.prototype.top10RuleCreateCondition=function(){return b.$V(8,B,this.rank(),B,B,this.type(),this.ranges())},It.prototype.uniqueRuleCreateCondition=function(){return b.$V(9,B,!1,B,B,B,this.ranges())},It.prototype.duplicateRuleCreateCondition=function(){return b.$V(9,B,!0,B,B,B,this.ranges())},It.prototype.averageRuleCreateCondition=function(){return b.$V(10,B,B,B,B,this.type(),this.ranges())},It.prototype.createCondition=function(){return this[ve[this.ruleType()]+"CreateCondition"]()},It.prototype.reset=function(){var e=this;switch(e.ranges(B),e.condition(B),e.style(B),e.stopIfTrue(!1),e.priority(1),e.operator(6),e.value1(B),e.value2(B),e.text(""),e.formula(B),e.type(0),e.rank(10),e.ruleType()){case 1:e.operator(6);break;case 2:e.operator(0);break;case 4:e.style(B);break;case 5:e.type(0),e.rank(10);break;case 8:e.type(0)}},It.prototype.evaluate=function(e,t,r,n){return this.jW(e),yt.prototype.evaluate.call(this,e,t,r,n)},It.prototype.jW=function(e){var t,r=this;r.initCondition(),9===(t=r.condition()).conType()&&(r.iW()&&(r.Nm(),r.cW=r.hW(r.ranges())),!1===r.cached&&(t.duplicatedArrayCached=t.getDuplicated(e,r.ranges()),r.cached=!0))},It.prototype.Nm=function(){this.cached=!1},It.prototype.rI=function(e,t,r){yt.prototype.rI.call(this,e,t,r),this.Nm()},It.prototype.tI=function(e,t,r){yt.prototype.tI.call(this,e,t,r),this.Nm()},It.prototype.GR=function(e,t){yt.prototype.GR.call(this,e,t),this.Nm()},It.prototype.HR=function(e,t){yt.prototype.HR.call(this,e,t),this.Nm()},It.prototype.toJSON=function(e){var t,r,n,o,i,a,s=this;return F(s.condition())&&this.initCondition(),t=te.call(s,e,Le),r=s.value1(),i=t.ruleType,a=t.operator,i!==ve.cellValueRule||a!==le.between&&a!==le.notBetween||(n=s.value2()),o=e&&e.parent&&1===e.parent.options.referenceStyle,F(r)||(s.bW(r)&&o&&(r=Et(e,s,r,o)),t.value1=r),F(n)||(s.bW(n)&&o&&(n=Et(e,s,n,o)),t.value2=n),s.ruleType()===ve.conditionRuleBase&&(t.condition=s.condition().toJSON()),t},It.prototype.fromJSON=function(e,t,r){var n=Le;F(e.condition)||(n=Le.concat(["condition"])),re.call(this,t,n,e,r),F(e.value1)||this.value1(e.value1),F(e.value2)||this.value2(e.value2),this.initCondition(t)},Oe=It,b.NormalConditionRule=Oe,Be={operator:ee("operator",B),text:ee("text",B),type:ee("type",B),rank:ee("rank",B),priority:ee("priority",1)},C.extend(Oe.prototype,Be),je=function(e,t){this.type=e,this.value=t},b.ScaleValue=je,He=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],St(Nt,vt=_e),Nt.prototype.stopIfTrue=function(e){return!1},Nt.prototype.isScaleRule=function(){return!0},Nt.prototype.createCondition=function(){return B},Nt.prototype.fW=function(e){var t=b.$V(8,B,B,B,B,1).getTopValues(e,1,this.ranges());return 0<Z(t)?t[0]:B},Nt.prototype.gW=function(e){var t=b.$V(8,B,B,B,B,0).getTopValues(e,1,this.ranges());return 0<Z(t)?t[0]:B},Nt.prototype.jW=function(e){var t=this;t.iW()&&(t.Nm(),t.cW=t.hW(t.ranges())),!1===t.cached&&(t.lowestValueCached=t.fW(e),t.highestValueCached=t.gW(e),t.cached=!0)},Nt.prototype.Nm=function(){this.lowestValueCached=B,this.highestValueCached=B,this.zyb={},this.cached=!1},Nt.prototype.kW=function(e,t,r,n){var o,i;return n&&(o=e.Cf())?(i=o.parse(e.yj(),n,t,r),o._evaluateParsedFormula(e.yj(),i,y._createCellIdentity(t,r),!1)):B},Nt.prototype.bW=function(e){return e&&"="===e[0]},Nt.prototype.lW=function(e){return F(e)||""===e?B:"="===e[0]?e.substr(1):e},Nt.prototype.mW=function(e,t,r,n){if(this.bW(n))return this.kW(e,t,r,this.lW(""+n));var o={};return I(n,o)?o.value:NaN},Nt.prototype.dW=function(e){return this.jW(e),this.highestValueCached},Nt.prototype.eW=function(e){return this.jW(e),this.lowestValueCached},Nt.prototype.nW=function(e,t,r,n){var o,i,a=this.mW(e,t,r,n);return!isNaN(a)&&0<=a&&a<=100&&(o=this.eW(e),i=this.dW(e),void 0!==o&&o!==B&&void 0!==i&&i!==B)?o+(i-o)*a/100:B},Nt.prototype.oW=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m=this.zyb;if(void 0!==m[n])return m[n];if(o=this.mW(e,t,r,n),!isNaN(o)&&0<=o&&o<=100){for(i=0,a=this.ranges(),s=Z(a),l=0;l<s;l++)u=this.YV("PERCENTILE",[e.Tq(a[l]),o/100]),c=e.Cf(),h=e.yj(),f=c.unparse(h,u,t,r),d=c.parse(h,f,t,r),p=c._evaluateParsedFormula(h,d,y._createCellIdentity(t,r),!1),i+=I(p,g={})?g.value:0;return m[n]=i/s,m[n]}return m[n]=B,m[n]},Nt.prototype.pW=function(e,t,r,n,o){var i,a;switch(n){case be.formula:return this.bW(o)||(o="="+o),this.mW(e,t,r,o);case be.highestValue:return this.dW(e);case be.lowestValue:return this.eW(e);case be.number:return this.mW(e,t,r,o);case be.percent:return this.nW(e,t,r,o);case be.percentile:return this.oW(e,t,r,o);case be.automax:return(i=this.dW(e))<0?0:i;case be.automin:return 0<(a=this.eW(e))?0:a;default:return B}},Nt.prototype.qW=function(e,t,r){return e===t&&e===r?1:e<=t?0:r<=e?1:(e-t)/(r-t)},Nt.prototype.rW=function(e,t,r){var n,o,i,a,s,l;return 0<=e&&e<=1?(n=G.ec(t),o=G.ec(r),i=n.a*(1-e)+o.a*e,a=n.r*(1-e)+o.r*e,s=n.g*(1-e)+o.g*e,l=n.b*(1-e)+o.b*e,U(parseFloat(i/255+""),parseInt(a+"",10),parseInt(s+"",10),parseInt(l+"",10))):B},Nt.prototype.YV=function(e,t){var r,n,o,i;if(!P)return B;if(r=f.findGlobalFunction(e)){for(n=[],o=Z(t),i=0;i<o;i++)n[i]=$(t[i]);return d.Jh(r,n)}return B},Nt.prototype.rI=function(e,t,r){vt.prototype.rI.call(this,e,t,r),this.Nm()},Nt.prototype.tI=function(e,t,r){vt.prototype.tI.call(this,e,t,r),this.Nm()},Nt.prototype.GR=function(e,t){vt.prototype.GR.call(this,e,t),this.Nm()},Nt.prototype.HR=function(e,t){vt.prototype.HR.call(this,e,t),this.Nm()},Nt.prototype.scaleEvaluate=function(e,t,r,n){var o,i,a,s,l=this;if(l.jW(e),l.contains(t,r)){if(F(n))return B;try{if(o=m(n),i=l.pW(e,t,r,l.minType(),l.minValue()),a=l.pW(e,t,r,l.midType(),l.midValue()),(s=l.pW(e,t,r,l.maxType(),l.maxValue()))<i)return B;if(isNaN(a)){if(!isNaN(i)&&!isNaN(s))return l.qW(o,i,s)}else if(!isNaN(i)&&!isNaN(s))return o<i?0:s<=o?2:i<=o&&o<=a?l.qW(o,i,a):1+l.qW(o,i,s)}catch(e){return B}}return B},Nt.prototype.twoScaleRuleEvaluate=function(e,t,r,n){var o,i,a,s,l,u;if(!F(n)){if(o={},i=S(n)&&I(n,o)?o.value:NaN,isNaN(i))return B;if(s=(a=this).pW(e,t,r,a.minType(),a.minValue()),l=a.pW(e,t,r,a.maxType(),a.maxValue()),!F(s)&&!F(l))return u=a.qW(i,s,l),a.rW(u,a.minColor(),a.maxColor())}return B},Nt.prototype.threeScaleRuleEvaluate=function(e,t,r,n){var o,i,a,s,l,u,c=this;if(c.lh=e,!F(n)){if(o={},i=S(n)&&I(n,o)?o.value:NaN,isNaN(i))return B;if(a=c.pW(e,t,r,c.minType(),c.minValue()),s=c.pW(e,t,r,c.midType(),c.midValue()),l=c.pW(e,t,r,c.maxType(),c.maxValue()),!F(a)&&!F(l)&&!F(s))return u=void 0,l<a?B:i<=a||a===l?l<=i?c.maxColor():c.minColor():l<=i?c.maxColor():i<=s?(u=c.qW(i,a,s),c.rW(u,c.minColor(),c.midColor())):(u=c.qW(i,s,l),c.rW(u,c.midColor(),c.maxColor()))}return B},Nt.prototype.evaluate=function(e,t,r,n){return this[ve[this.ruleType()]+"Evaluate"](e,t,r,n)},Nt.prototype.ad=function(){var e=this;e.minValue(B),e.minType(1),e.midValue(50),e.midType(4),e.maxValue(B),e.maxType(2),10===e.ruleType()&&(e.minColor(U(0,255,255,255)),e.maxColor(U(255,99,190,123))),11===e.ruleType()&&(e.midValue(50),e.midType(4),e.minColor(U(255,248,105,107)),e.midColor(U(255,255,235,132)),e.maxColor(U(255,99,190,123)))},Nt.prototype.reset=function(){this.ranges(B),this.condition(B),this.style(B),this.ad(),this.lh=B,this.stopIfTrue(!1),this.priority(1)},Nt.prototype.toJSON=function(e){return te.call(this,e,He)},Nt.prototype.fromJSON=function(e,t,r){re.call(this,t,He,e,r),this.initCondition(t)},Ge=Nt,b.ScaleRule=Ge,Ue={minValue:ee("minValue",B),minType:ee("minType",5),minColor:ee("minColor",B),midValue:ee("midValue",50,B,function(e){if(this.lh){if(2===this.midType())return this.dW(this.lh);if(1===this.midType())return this.eW(this.lh)}return e}),midType:ee("midType",B),midColor:ee("midColor",B),maxType:ee("maxType",7),maxValue:ee("maxValue",B),maxColor:ee("maxColor",B)},C.extend(Ge.prototype,Ue),We=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],St(Dt,wt=Ge),Dt.prototype.ad=function(e){var t=this;t.gradient(!0),t.color(e),t.showBorder(!1),t.borderColor("black"),t.dataBarDirection(0),t.negativeFillColor("red"),t.useNegativeFillColor(!0),t.negativeBorderColor("black"),t.useNegativeBorderColor(!1),t.axisPosition(0),t.axisColor("black"),t.showBarOnly(!1)},Dt.prototype.reset=function(){var e=this;e.ranges(B),e.condition(B),e.style(B),e.ad(U(255,99,142,198)),e.stopIfTrue(!1),e.priority(1),e.minValue(B),e.minType(5),e.midValue(B),e.midType(B),e.maxValue(B),e.maxType(7),e.minColor(B),e.midColor(B),e.maxColor(B)},Dt.prototype.sW=function(e,t,r,n){var o,i,a,s,l=n?this.maxType():this.minType(),u=n?this.maxValue():this.minValue();if(6!==l&&4!==l)return this.pW(e,t,r,l,u);for(i=0;i<Z(this.ranges());i++)if(this.ranges()[i].intersect(t,-1,1,-1)&&(o=this.ranges()[i]))return a=-1===(a=o.row)?0:a,s=-1===(s=o.col)?0:s,this.pW(e,a,s,l,u)},Dt.prototype.tW=function(e,t,r){return r<=e&&t<e?[1,0]:e<=t&&e<r?[0,0]:r===t?[.5,0]:[(e-t)/(r-t),0]},Dt.prototype.uW=function(e,t,r){var n,o,i=.5,a=T(r-t);return 0<r&&0<=t?r===t||r<=e?[.5,i]:e<=t?[t/r*.5,i]:[.5*T(e/r),i]:0<r&&t<0?(n=r>T(t)?.5:r/a,o=r>T(t)?t/a:-.5,0<e?r<=e?[n,i]:[e/r*n,i]:e<0?e<=t?[o,i]:[e/t*o,i]:[0,i]):r<=0&&t<0?r===t?[-.5,i]:r<=e?[-r/t*.5,i]:e<=t?[-.5,i]:[-e/t*.5,i]:0===r&&0===t?[0,i]:[i=-1,i]},Dt.prototype.vW=function(e,t,r){var n,o,i,a=-1,s=T(t),l=T(r),u=T(r-t),c=t<0?-1:1;return 0<r&&0<=t||r<=0&&t<0?(n=k(s,l),o=A(s,l),a=t<0?1:0,(i=T(e))<=o&&i<n?[0,a]:n<=i&&o<i?[c,a]:o===n?[.5*c,a]:[c*(T(e)-o)/u,a]):0<r&&t<0?(a=T(t)/u,0===e?[0,a]:r<=e?[1-a,a]:[k(e,t)/u,a]):0===r&&0===t?(a=.5,0===e?[0,a]:[.5*c,a]):[-1,a]},Dt.prototype.wW=function(e,t,r){return 0===this.axisPosition()?this.vW(e,t,r):1===this.axisPosition()?this.uW(e,t,r):this.tW(e,t,r)},Dt.prototype.evaluate=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g;if(!F(n)){if(o={},i=S(n,!0)&&I(n,o)?o.value:NaN,isNaN(i))return B;if(s=(a=this).sW(e,t,r,!1),l=a.sW(e,t,r,!0),_(s,Date)&&(s=V.Ra(s)),_(l,Date)&&(l=V.Ra(l)),!F(s)&&!F(l))return l<s&&(u=l,l=s,s=u),c=void 0,!(h=a.wW(i,s,l))||Z(h)<2?B:(f=h[0],c=h[1],d=i<0&&a.useNegativeFillColor()?a.negativeFillColor():a.color(),p=i<0&&a.useNegativeBorderColor()?a.negativeBorderColor():a.borderColor(),g=a.axisColor(),d=K.Om(e,d),p=K.Om(e,p),g=K.Om(e,g),{fillColor:d,borderColor:p,showBorder:a.showBorder(),axisColor:g,isGradient:a.gradient(),direction:a.dataBarDirection(),axisLocation:c,scale:f,showBarOnly:a.showBarOnly()})}return B},Dt.prototype.toJSON=function(e){return te.call(this,e,We)},Dt.prototype.fromJSON=function(e,t,r){re.call(this,t,We,e,r),this.initCondition(t)},Dt.paintDataBar=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y=new x.Rect(r+2,n+2,o-4,i-4),C=y.x,w=y.y,v=M(T(y.width*t.scale)),S=y.height;if(0===t.axisLocation)t.scale<=0&&(v=0);else if(1===t.axisLocation)t.scale<0?C=C+y.width-v:v=0;else{for(a=M(y.width*t.axisLocation+C)+.5,s=y.y,l=i-2,e.lineWidth=1,e.strokeStyle=t.axisColor,e.beginPath(),u=0;u<=l;u+=2)1===t.direction?(e.moveTo(2*r+o-a,s+u),e.lineTo(2*r+o-a,s+u+1)):(e.moveTo(a,s+u),e.lineTo(a,s+u+1));e.stroke(),0<t.scale?C=a+1:t.scale<0?C=a-v:v=0}t.showBorder&&(C=M(C)+.5,--v,w+=.5,--S),h=(c=C)+v,1===t.direction&&(c=2*r+o-C-v,h=2*r+o-C),0<=v&&0<=S&&(f=t.fillColor,t.isGradient&&(f=e.createLinearGradient(c,w,h,w),d=G.ec(t.fillColor),p=U(d.a,M(229.5+d.r*(1-.9)),M(229.5+d.g*(1-.9)),M(229.5+d.b*(1-.9))),g=t.scale<0?1-.9:.9,m=t.fillColor,b=t.scale<0?1:0,1===t.direction?(f.addColorStop(g,m),f.addColorStop(b,p)):(f.addColorStop(g,p),f.addColorStop(b,m))),e.fillStyle=f,e.fillRect(c,w,v,S),t.showBorder&&0<v&&0<S&&(e.strokeStyle=t.borderColor,e.strokeRect(c,w,v,S)))},Ve=Dt,b.DataBarRule=Ve,ze={gradient:ee("gradient",!0),color:ee("color",B),showBorder:ee("showBorder",!1),borderColor:ee("borderColor","black"),dataBarDirection:ee("dataBarDirection",0),negativeFillColor:ee("negativeFillColor","red"),useNegativeFillColor:ee("useNegativeFillColor",!0),negativeBorderColor:ee("negativeBorderColor","black"),useNegativeBorderColor:ee("useNegativeBorderColor",!1),axisPosition:ee("axisPosition",0),axisColor:ee("axisColor","black"),showBarOnly:ee("showBarOnly",!1)},C.extend(Ve.prototype,ze),qe=function(e,t,r){this.isGreaterThanOrEqualTo=e,this.iconValueType=t,this.iconValue=r},b.IconCriterion=qe,Ze=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],St(Rt,Ct=Ge),Rt.prototype.xW=function(e){var t=this;t.iconSetType(e,!1),t.iconSetType()>=ye.threeArrowsColored&&t.iconSetType()<=ye.threeSymbolsUncircled?(t.NV=[],t.NV[0]=new qe(!0,Ce.percent,33),t.NV[1]=new qe(!0,Ce.percent,67),t.CZa=[],t.CZa[0]={iconSetType:e,iconIndex:0},t.CZa[1]={iconSetType:e,iconIndex:1},t.CZa[2]={iconSetType:e,iconIndex:2}):t.iconSetType()>=ye.fourArrowsColored&&t.iconSetType()<=ye.fourTrafficLights?(t.NV=[],t.NV[0]=new qe(!0,Ce.percent,25),t.NV[1]=new qe(!0,Ce.percent,50),t.NV[2]=new qe(!0,Ce.percent,75),t.CZa=[],t.CZa[0]={iconSetType:e,iconIndex:0},t.CZa[1]={iconSetType:e,iconIndex:1},t.CZa[2]={iconSetType:e,iconIndex:2},t.CZa[3]={iconSetType:e,iconIndex:3}):t.iconSetType()>=ye.fiveArrowsColored&&t.iconSetType()<=ye.fiveBoxes?(t.NV=[],t.NV[0]=new qe(!0,Ce.percent,20),t.NV[1]=new qe(!0,Ce.percent,40),t.NV[2]=new qe(!0,Ce.percent,60),t.NV[3]=new qe(!0,Ce.percent,80),t.CZa=[],t.CZa[0]={iconSetType:e,iconIndex:0},t.CZa[1]={iconSetType:e,iconIndex:1},t.CZa[2]={iconSetType:e,iconIndex:2},t.CZa[3]={iconSetType:e,iconIndex:3},t.CZa[4]={iconSetType:e,iconIndex:4}):t.iconSetType()>ye.fiveBoxes&&(t.NV=[],t.CZa=[])},Rt.prototype.ad=function(e){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xW(e)},Rt.prototype.yW=function(e){var t=Z(this.NV)+1;return this.reverseIconOrder()&&2<t?t-1-e:e},Rt.prototype.pW=function(e,t,r,n){var o=this.NV[n];if(o)switch(o.iconValueType){case Ce.formula:case Ce.number:return this.mW(e,t,r,o.iconValue);case Ce.percent:return this.nW(e,t,r,o.iconValue);case Ce.percentile:return this.oW(e,t,r,o.iconValue);default:return B}},Rt.prototype.evaluate=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m=n;if(F(m))return B;if(o={},i=S(n,!0)&&"boolean"!=typeof m&&I(n,o)?o.value:NaN,isNaN(i))return B;if(a=0,s=this.iconSetType(),l=this.NV,ye.fiveArrowsColored<=s?a=5:ye.fourArrowsColored<=s?a=4:ye.threeArrowsColored<=s&&(a=3),!l)return 0;for(c=0,h=a-1;0<h;h--)if(h<Z(l)+1&&(u=l[h-1],!F(u&&u.iconValue)&&(f=this.pW(e,t,r,h-1),!F(f)&&(d=u.isGreaterThanOrEqualTo?f<=i:f<i,i<Number.MAX_VALUE&&d)))){c=h;break}return p=this.yW(c),(g=this.CZa)?{iconSetType:g[p]?g[p].iconSetType:ye.noIcons,iconIndex:g[p]?g[p].iconIndex:0,showIconOnly:this.showIconOnly()}:{iconSetType:ye.noIcons,iconIndex:0,showIconOnly:this.showIconOnly()}},Rt.prototype.reset=function(){var e=this;e.ranges(B),e.condition(B),e.style(B),e.showIconOnly(!1),e.reverseIconOrder(!1),e.iconSetType(0,B),e.NV=B,e.stopIfTrue(!1),e.priority(1),e.minColor(B),e.minValue(B),e.minType(5),e.midColor(B),e.midValue(B),e.midType(B),e.maxColor(B),e.maxValue(B),e.maxType(7),e.CZa=B},Rt.prototype.icons=function(e){return 1===arguments.length&&(this.CZa=e),this.CZa},Rt.prototype.iconCriteria=function(){return this.NV},Rt.prototype.toJSON=function(e){return te.call(this,e,Ze)},Rt.prototype.fromJSON=function(e,t,r){re.call(this,t,Ze,e,r),this.initCondition(t)},Rt.getIcon=function(e,t){return B},Rt.Pdc=function(e,t,r,n,o,i,a){if(a.ko(t)){var s=a.lo(t);e.drawImage(s,r,n,o,i)}else a.fo(t)},Rt.paintIconSet=function(e,t,r,n,o,i,a,s,l,u){var c,h,f=p.To.No(a.font,1).fontSize,d=r+2;if(t.showIconOnly&&(1===a.hAlign?d=r+o/2-f/2:2===a.hAlign&&(d=r+o-2-f-2)),c=1===a.vAlign?n+i/2-f/2:2===a.vAlign?n+i-2-s/2-f/2:n+2+s/2-f/2,t.iconSetType!==ye.noIcons)if((h=Rt.getIcon(t.iconSetType,t.iconIndex))&&"string"===C.getType(h)&&u)try{Rt.Pdc(e,h,d,c,f,f,u)}catch(e){}else!function(e,t,r,n,o,i,a,s,l){var u=Math.round;switch(e.lineWidth=1,e.rect(i,a,s,l),r=u(++r),n=u(n),e.clip(),t.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:g.drawArrows(e,t.iconSetType,t.iconIndex,r,n,o);break;case 2:g.drawIconTypeIsTwo(e,t.iconSetType,t.iconIndex,r,n,o);break;case 3:g.drawStar(e,t.iconSetType,t.iconIndex,r,n,o);break;case 14:case 12:case 5:g.drawCircle(e,t.iconSetType,t.iconIndex,r,n,o);break;case 4:g.drawFlag(e,t.iconSetType,t.iconIndex,r,n,o);break;case 6:g.drawTrafficLight(e,t.iconSetType,t.iconIndex,r,n,o);break;case 7:g.drawIconTypeIsSen(e,t.iconSetType,t.iconIndex,r,n,o);break;case 8:g.drawIconTypeIsEight(e,t.iconSetType,t.iconIndex,r,n,o);break;case 9:g.drawIconTypeIsNine(e,t.iconSetType,t.iconIndex,r,n,o);break;case 18:g.drawSector(e,t.iconSetType,t.iconIndex,r,n,o);break;case 17:case 13:g.drawSignal(e,t.iconSetType,t.iconIndex,r,n,o);break;case 19:g.drawMagicCube(e,t.iconSetType,t.iconIndex,r,n,o)}}(e,t,d,c,f,r,n,o,i)},Ye=Rt,b.IconSetRule=Ye,Ke={iconSetType:ee("iconSetType",ye.threeArrowsColored,function(e){this.xW(e)}),reverseIconOrder:ee("reverseIconOrder",!1),showIconOnly:ee("showIconOnly",!1)},C.extend(Ye.prototype,Ke),_t.prototype.no=function(){this.WS=B},_t.prototype.getRule=function(e){return this.AW[e]},_t.prototype.count=function(){return Z(this.AW)},_t.prototype.w4=function(){return this.AW},_t.prototype.UV=function(e){var t,r,n=[],o=this.WS,i=Z(e);for(t=0;t<i;t++)r=o.Tq(e[t]),n.push(r);return n},_t.prototype.EW=function(e){var t,r,n,o,i=[],a=this.WS;for(t=0,r=Z(e);t<r;t++)n=e[t],o=new c(n.row,n.col,xt(n),Tt(n)),0===n.row&&xt(n)===a.getRowCount()&&(o.row=-1),0===n.col&&Tt(n)===a.getColumnCount()&&(o.col=-1),i.push(o);return i},_t.prototype.QV=function(){if(this.Kfc&&(this.DW={},this.AW))for(var e=0;e<Z(this.AW);e++)this.FW(this.AW[e])},_t.prototype.OV=function(){this.Kfc&&(this.DW={})},_t.prototype.FW=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b;if(this.Kfc)for(t=this.DW,a=this.UV(e.ranges()),l=(s=this.WS).getRowCount(),u=s.getColumnCount(),c=0;c<Z(a);c++)for(f=(h=a[c]).row,d=h.col,l<=f+(p=xt(h))-1&&(p=l-f),u<=d+(g=Tt(h))-1&&(g=u-d),m=0;m<p;m++)for((r=t[o=m+f])||(t[o]=r=[]),b=0;b<g;b++)(n=r[i=b+d])||(r[i]=n=[]),n.push(e)},_t.prototype.GW=function(e){var t,r,n,o,i,a,s,l,u,c,h;if(this.Kfc)for(t=this.DW,i=this.UV(e.ranges()),a=0;a<Z(i);a++)for(s=i[a],l=0;l<xt(s);l++)if(r=t[l+s.row])for(u=0;u<Tt(s);u++)if(n=r[o=u+s.col]){for(c=[],h=0;h<Z(n);h++)n[h]!==e&&c.push(n[h]);0===Z(c)&&(c=w),r[o]=c}},_t.prototype.HW=function(e,t,r,n){var o,i,a,s;if(this.Kfc)for(o=this.DW,a=0;a<r;a++)if(i=o[a+e])for(s=0;s<n;s++)i[s+t]=w},_t.prototype.Ayb=function(e,t){var r,n,o=[];for(r=0;r<Z(this.AW);r++)(n=this.AW[r]).contains(e,t)&&o.push(n);return o},_t.prototype.addSpecificTextRule=function(e,t,r,n){var o=new Oe(2,n,r,e,B,B,t);return this.addRule(o)},_t.prototype.addCellValueRule=function(e,t,r,n,o){var i=new Oe(1,o,n,e,Ft(t),Ft(r));return this.addRule(i)},_t.prototype.addDateOccurringRule=function(e,t,r){var n=new Oe(4,r,t,B,B,B,B,B,e);return this.addRule(n)},_t.prototype.addFormulaRule=function(e,t,r){var n=new Oe(3,r,t,B,B,B,B,e);return this.addRule(n)},_t.prototype.addTop10Rule=function(e,t,r,n){var o=new Oe(5,n,r,B,B,B,B,B,e,t);return this.addRule(o)},_t.prototype.addUniqueRule=function(e,t){var r=new Oe(6,t,e);return this.addRule(r)},_t.prototype.addDuplicateRule=function(e,t){var r=new Oe(7,t,e);return this.addRule(r)},_t.prototype.addAverageRule=function(e,t,r){var n=new Oe(8,r,t,B,B,B,B,B,e);return this.addRule(n)},_t.prototype.add3ScaleRule=function(e,t,r,n,o,i,a,s,l,u){var c;return c=0===arguments.length?new Ge(11):new Ge(11,e,t,r,n,o,i,a,s,l,u),this.addRule(c)},_t.prototype.add2ScaleRule=function(e,t,r,n,o,i,a){var s;return s=0===arguments.length?new Ge(10):new Ge(10,e,t,r,B,B,B,n,o,i,a),this.addRule(s)},_t.prototype.addDataBarRule=function(e,t,r,n,o,i){var a;return a=0===arguments.length?new Ve:new Ve(e,t,r,n,o,i),this.addRule(a)},_t.prototype.addIconSetRule=function(e,t){var r=new Ye(e,t);return this.addRule(r)},_t.prototype.addRule=function(e){var t,r,n,o,i,a,s,l,u,c,h=this.WS;if(h){if(!e)throw Error(J().Exp_RuleIsNull);for(n=r=void 0,(t=e.ranges())&&(r=(o=H(t)).r,n=o.c),(a=(i=e.getExpected())&&i.formatter)&&"string"==typeof a&&h.fJb(r||0,n||0,a),h._modelManager.YUa(),s=0,l=Z(this.AW);s<l;s++)c=(u=this.AW[s]._ps).priority||1,u.priority=c+1;return e.priority(1),this.AW.push(e),e.context(h),this.FW(e),h.$p(),e}},_t.prototype.removeRule=function(e){var t,r,n=this.WS,o=n.parent;n&&(e&&((r=(t=e.getExpected())&&t.formatter)&&"string"==typeof r&&o.QHb[r]&&o.RHb(r),n._modelManager.YUa(),this.GW(e),z(this.AW,e)),n.$p())},_t.prototype.IW=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b;return e.intersect(t,r,n,o)?(i=e.row,a=e.row+xt(e)-1,s=e.col,l=e.col+Tt(e)-1,c=(u=t)+n-1,f=(h=r)+o-1,d=[],-1!==i&&-1!==s&&-1!==u&&-1!==h&&(0<h-s&&(p=W(i,s,xt(e),h-s),d.push(p)),0<l-f&&(g=W(i,1+f,xt(e),l-f),d.push(g)),0<u-i&&(m=W(i,k(h,s),u-i,A(f,l)-k(h,s)+1),d.push(m)),0<a-c&&(b=W(1+c,k(h,s),a-c,A(f,l)-k(h,s)+1),d.push(b))),0<Z(d)?d:B):[e]},_t.prototype.removeRuleByRange=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g=this.WS;if(g){if(o=[],this.AW)for(g._modelManager.YUa(),this.HW(e,t,r,n),i=0,a=Z(this.AW);i<a;i++)if((s=this.AW[i])&&s.ranges()&&s.intersects(e,t,r,n)){for(l=[],u=this.UV(s.ranges()),c=0,h=Z(u);c<h;c++)(f=this.IW(u[c],e,t,r,n))&&(l=l.concat(f));0<Z(l)?s.ranges(this.EW(l)):o.push(s)}for(d=0,p=Z(o);d<p;d++)z(this.AW,o[d]);g.$p()}},_t.prototype.clearRule=function(){var e,t,r,n,o=this.WS,i=o.parent;if(o){for(e=this.AW,o._modelManager.YUa(),t=0;t<e.length;t++)(n=(r=e[t].getExpected())&&r.formatter)&&"string"==typeof n&&i.QHb[n]&&i.RHb(n);this.AW.length=0,this.QV(),o.$p()}},_t.prototype.getRules=function(e,r){var n,t,o,i,a,s,l,u,c=this.AW;if(0===arguments.length||0===Z(c))return c;if(e=e===w?-1:e,r=r===w?-1:r,n=[],this.Kfc)t=this.DW,i=void 0,-1!==e&&-1!==r?(i=t[e])&&(o=i[r],Pt(n,o)):-1===e?C.each(t,function(e,t){o=t[r],Pt(n,o)}):(i=t[e])&&C.each(i,function(e,t){Pt(n,t)});else if(s=(a=this.WS).getRowCount(),l=a.getColumnCount(),u=void 0,-1!==e&&-1!==r)Pt(n,this.Ayb(e,r));else if(-1===e)for(u=0;u<s;u++)Pt(n,this.Ayb(u,r));else for(u=0;u<l;u++)Pt(n,this.Ayb(e,u));return n},_t.prototype.containsRule=function(e,t,r){return!(!e||!h.Bb(this.AW,e))&&e.contains(t,r)},_t.prototype._V=function(e,t,r,n){var o,i,a;if(this.AW&&this.WS)for(o=Z(this.AW),i=0;i<o;i++)(a=this.AW[i])&&(r?a.rI(e,t,n):a.tI(e,t,n));this.QV()},_t.prototype.rI=function(e,t,r){this._V(e,t,!0,r)},_t.prototype.tI=function(e,t,r){this._V(e,t,!1,r)},_t.prototype.aW=function(e,t,r){var n,o;if(this.AW&&this.WS)for(n=Z(this.AW)-1;0<=n;n--)(o=this.AW[n])&&(r?o.GR(e,t):o.HR(e,t),o.ranges().length<=0&&(this.GW(o),this.AW.splice(n,1)));this.QV()},_t.prototype.GR=function(e,t){this.aW(e,t,!0)},_t.prototype.HR=function(e,t){this.aW(e,t,!1)},_t.prototype.Nm=function(){var e,t,r,n=this.AW;if(n!==B&&0<Z(n))for(t=0,r=Z(n);t<r;t++)(e=n[t]).Nm&&e.Nm()},_t.prototype.XA=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_=[],P=[],L=[],O=[],B=this.WS;for(-1===e&&(n=e=0,i=B.getRowCount()),-1===t&&(o=t=0,a=B.getColumnCount()),l=0;l<i;l++)for(u=0;u<a;u++)for(c=this.getRules(e+l,t+u),h=0;h<Z(c);h++){for(d=(f=c[h]).ranges(),p=[],g=0;g<Z(d);g++)m=d[g],y=(b=B.Tq(m)).row,C=b.col,w=xt(b),v=Tt(b),q(L,m)<=-1&&m.contains(e+l,t+u)&&(L.push(m),(S=W(n+l,o+u,-1,-1)).rowCount=i+e<=y+w?i-l:e<y?w:y+w-e,S.colCount=a+t<=C+v?a-u:t<C?v:C+v-t,this===r&&m.containsRange(S)||p.push(S),s&&-1===O.indexOf(S)&&O.push(S));0<p.length&&((x=_.indexOf(f))<0?(_.push(f),P.push(p)):P[x]=P[x].concat(p))}for(T=0,A=_.length;T<A;T++)M=(k=this.iga(_[T].toJSON(),_[T].context())).ranges(),k.ranges(P[T]),(I=k.Yw)&&(E=1===B.parent.options.referenceStyle,R=H(M),D=j.formulaToExpression(B,I,R.r,R.c,E),N=H(P[T]),F=j.expressionToFormula(B,D,N.r,N.c,E),k.formula(F)),r.addRule(k);return this.QV(),O},_t.prototype.YA=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v=[],S=this.WS,x=S.getRowCount(3),T=S.getColumnCount(3);for(-1===e&&(e=0,r=S.getRowCount()),-1===t&&(t=0,n=S.getColumnCount()),a=0;a<r;a++)for(s=0;s<n;s++)for(l=this.getRules(e+a,t+s),u=0;u<Z(l);u++){for(h=(c=l[u]).ranges(),f=[],d=0;d<Z(h);d++)p=h[d],m=(g=S.Tq(p)).row,b=g.col,y=xt(g),C=Tt(g),O.Bb(o,p)||q(v,p)<=-1&&p.contains(e+a,t+s)&&(v.push(p),m<e&&f.push(W(m,b,e-m,C)),b<t&&f.push(W(k(e,m),b,A(e+r,m+y)-k(e,m),t-b)),t+n<b+C&&f.push(W(k(e,m),t+n,A(e+r,m+y)-k(e,m),b+C-(t+n))),e+r<m+y&&f.push(W(e+r,b,m+y-(e+r),C)));this.Byb(S,v,o,h,x,T,i),0<(w=h.concat(f)).length?(c.yyb(),c.ranges(w)):this.removeRule(c)}this.QV()},_t.prototype.Byb=function(e,t,r,n,o,i,a){var s,l,u,c,h,f;for(s=0;s<Z(t);s++){if(u=[l=t[s]],a)for(c=0;c<Z(r);c++)h=r[c],l.intersect(h.row,h.col,h.rowCount,h.colCount)&&(u=u.concat(e.v_a(l,h,o,i)));for(f=0;f<Z(u);f++)z(n,u[f])}},_t.prototype.jp=function(e,t,r,n,o,i,a,s){var l=16,u=!1,c=!1,h=s.sheet,f=s.row,d=s.col,p=h.zoom(),g=this.oRa(h,f,d,t),m=g.iconSet,b=g.dataBar;return(b||m)&&(e.save(),e.beginPath(),b&&(Ve.paintDataBar(e,b,r,n,o,i),u=b.showBarOnly),m&&((o<(l=parseInt(l*p+"",10))||i<l)&&(e.rect(r,n,o,i),e.clip(),e.beginPath()),Ye.paintIconSet(e,m,r,n,o,i,a,s.lineHeight,p,s.imageLoader),c=m.showIconOnly),e.restore()),u||c},_t.prototype.oRa=function(e,t,r,n){var o,i,a,s,l,u,c,h,f=e.ss,d=f.Um(t,r);if(d)o=d.i,i=d.d;else{if(a=this.getRules(t,r),0<(s=Z(a))){for(a.sort(function(e,t){return e.priority()-t.priority()}),u=l=B,h=c=void 0,h=0;h<s&&(!l||!u);h++)(c=a[h])&&(_(c,Ve)&&(l=c),_(c,Ye)&&(u=c));if(l||u)for(l=u=B,h=0;!(!(h<s)||l&&u||(c=a[h])&&(!l&&_(c,Ve)&&(l=c),!u&&_(c,Ye)&&(u=c),c.stopIfTrue()&&c.evaluate(e,t,r,n)));h++);l&&(i=l.evaluate(e,t,r,n)),u&&(o=u.evaluate(e,t,r,n))}f.Wm(t,r,i,o)}return{dataBar:i,iconSet:o}},_t.prototype.bp=function(e,t,r){var n,o,i;if(F(r)||3===r)for(n=this.getRules(e,t),o=0,i=Z(n);o<i;o++)if(n[o]instanceof Ye)return!0;return!1},_t.prototype.toJSON=function(e){var t,r,n=[];for(t=0;t<Z(this.AW);t++)r=this.AW[t],n.push(r?r.toJSON(e):B);return 0===Z(n)?w:{rules:n}},_t.prototype.fromJSON=function(e,t,r){var n,o,i,a,s;if(e&&(n=e.rules)){for(this.AW=[],o=Z(n),i=0;i<o;i++)a=n[i],(s=this.iga(a,t,r))&&this.AW.push(s);this.Kfc=!function(e){var t,r,n,o,i=Z(e);for(t=0;t<i;t++)if(r=e[t],n=r.ranges)for(o=0;o<n.length;o++)if(1e3<n[o].rowCount)return 1}(n),this.QV()}},_t.prototype.iga=function(e,t,r){var n,o=B;return e&&(n=this.JW()[e.ruleType])&&(o=new n).fromJSON(e,t,r),o},_t.prototype.JW=function(){if(!this.BW){var e={};e[0]=Oe,e[1]=Oe,e[2]=Oe,e[3]=Oe,e[4]=Oe,e[5]=Oe,e[6]=Oe,e[7]=Oe,e[8]=Oe,e[9]=Ge,e[10]=Ge,e[11]=Ge,e[12]=Ve,e[13]=Ye,this.BW=e}return this.BW},_t.prototype.Eq=function(e,t,r,n){var o,i,a,s,l,u;if(this&&0<this.count()&&(o=this.getRules(t,r),i=Z(o),a=void 0,s=B,0<i))for(o.sort(function(e,t){return e.priority()-t.priority()}),l=0;l<i&&!((a=o[l])&&(u=this.WS,a.isScaleRule()?10!==a.ruleType()&&11!==a.ruleType()||(s=a.evaluate(u,t,r,u.getValue(t,r,n)))&&(e=e||new L).backColor===w&&(e.backColor=s):(s=a.evaluate(u,t,r,u.getValue(t,r,n)))&&(e=e||new L).Yo(s,!1,1),a.stopIfTrue()&&s));l++);return e},_t.prototype.Fq=function(e,t,r,n){var o,i,a,s,l,u,c,h,f={v5:!1};if(this&&0<this.count()&&(o=this.getRules(e,t),i=Z(o),a=void 0,s=B,0<i))for(o.sort(function(e,t){return e.priority()-t.priority()}),l=0;l<i;l++)if(a=o[l]){if(u=this.WS,a.isScaleRule()){if(c=a.ruleType(),"backColor"===r&&(10===c||11===c)&&(s=a.evaluate(u,e,t,u.getValue(e,t,n)))){f.Fi=s,f.v5=!0;break}}else{if(!((h=a.style())&&void 0!==h[r]||a.stopIfTrue()))continue;if((s=a.evaluate(u,e,t,u.getValue(e,t,n)))&&s[r]!==w){f.Fi=s[r],f.v5=!0;break}}if(a.stopIfTrue()&&s)break}return f},Xe=_t,b.ConditionalFormats=Xe},"./dist/plugins/conditional/conditional.ns.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./dist/plugins/conditional/conditional.res.en.js");t.SR={en:n}},"./dist/plugins/conditional/conditional.res.en.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_RuleIsNull="The argument 'rule' is null",t.Exp_NotSupported="NotSupportException"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(e,t,r){"use strict";var k,M,l,u,n,o,i,a,s,c,h,f,d,p,g,m,I;function b(e,t,r,n,o){e.beginPath(),e.moveTo(t,r),e.lineTo(t+n,r),e.lineTo(t+n,r+o),e.lineTo(t,r+o),e.lineTo(t,r),e.closePath(),e.fill(),e.stroke()}function y(e,t,r){e.moveTo(l(.1*k)*t,-u(.1*k)*t),e.lineTo(l(.3*k)*r,-u(.3*k)*r),e.lineTo(0*t,-u(.5*k)*t),e.lineTo(l(.7*k)*r,-u(.7*k)*r),e.lineTo(l(.9*k)*t,-u(.9*k)*t),e.lineTo(l(1.1*k)*r,-u(1.1*k)*r),e.lineTo(l(1.3*k)*t,-u(1.3*k)*t),e.lineTo(0*r,-u(1.5*k)*r),e.lineTo(l(1.7*k)*t,-u(1.7*k)*t),e.lineTo(l(1.9*k)*r,-u(1.9*k)*r),e.lineTo(l(.1*k)*t,-u(.1*k)*t)}function C(e,t,r,n,o,i){var a=i;e.strokeStyle=I[t][r].strokeStyle,e.beginPath(),e.arc(a/2+n,a/2+o,a/2,0,2*k),e.fillStyle=I[t][r].fillColor,e.closePath(),e.fill(),e.stroke()}function E(e,t,r){e.lineTo(M(t)+.5,M(r)+.5)}function R(e,t,r){e.moveTo(M(t)+.5,M(r)+.5)}Object.defineProperty(t,"__esModule",{value:!0}),k=Math.PI,M=Math.round,l=Math.cos,u=Math.sin,I=[[{strokeStyle:o="#326f5b",fillColor:i="#76a797",fillColor2:"",rotate:k},{strokeStyle:a="#A4802b",fillColor:s="#EAC282",fillColor2:"",rotate:-.5*k},{strokeStyle:c="#9E381C",fillColor:h="#D86344",fillColor2:"",rotate:0}],[{strokeStyle:f="#646262",fillColor:d="#808080",fillColor2:"",rotate:k},{strokeStyle:f,fillColor:d,fillColor2:"",rotate:-.5*k},{strokeStyle:f,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:o,fillColor:i,fillColor2:"",rotate:k}],[{strokeStyle:a,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0}],[{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:o,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:o,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:p="#303030",fillColor:g="#505050",fillColor2:"#d86344",rotate:0},{strokeStyle:p,fillColor:g,fillColor2:"#eac282",rotate:0},{strokeStyle:p,fillColor:g,fillColor2:i,rotate:0}],[{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:o,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:c,fillColor:h,fillColor2:"white",rotate:.25*k},{strokeStyle:a,fillColor:s,fillColor2:"white",rotate:0},{strokeStyle:o,fillColor:i,fillColor2:"white",rotate:-.25*k}],[{strokeStyle:c,fillColor:h,fillColor2:"",rotate:.25*k},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:o,fillColor:i,fillColor2:"",rotate:-.25*k}],[{strokeStyle:o,fillColor:i,fillColor2:"",rotate:k},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:-.75*k},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:-.25*k},{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:f,fillColor:d,fillColor2:"",rotate:k},{strokeStyle:f,fillColor:d,fillColor2:"",rotate:-.75*k},{strokeStyle:f,fillColor:d,fillColor2:"",rotate:-.25*k},{strokeStyle:f,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:"#353535",fillColor:g,fillColor2:"",rotate:0},{strokeStyle:d,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:m="#727272",fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n="#4d82b8 #4d82b8 #4d82b8 #4d82b8",fillColor2:"",rotate:0}],[{strokeStyle:"#353535",fillColor:g,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:o,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:i,fillColor2:"",rotate:k},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:-.75*k},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:-.5*k},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:-.25*k},{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:f,fillColor:d,fillColor2:"",rotate:k},{strokeStyle:f,fillColor:d,fillColor2:"",rotate:-.75*k},{strokeStyle:f,fillColor:d,fillColor2:"",rotate:-.5*k},{strokeStyle:f,fillColor:d,fillColor2:"",rotate:-.25*k},{strokeStyle:f,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:g,fillColor:g,fillColor2:"",rotate:2*k},{strokeStyle:g,fillColor:g,fillColor2:"",rotate:.5*k},{strokeStyle:g,fillColor:g,fillColor2:"",rotate:.5*k},{strokeStyle:g,fillColor:g,fillColor2:"",rotate:+k},{strokeStyle:g,fillColor:g,fillColor2:"",rotate:2*k}],[{strokeStyle:m,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}]],t.drawSignal=function(e,t,r,n,o,i){var a,s;e.translate(n,o),e.strokeStyle=I[t][r].strokeStyle,a=I[t][r].fillColor.split(" "),s=M(.2*i),e.fillStyle=a[0],b(e,s+.5,3*s+.5,s,2*s),e.fillStyle=a[1],b(e,2*s+.5,2*s+.5,s,3*s),e.fillStyle=a[2],b(e,3*s+.5,s+.5,s,4*s),e.fillStyle=a[3],b(e,4*s+.5,.5,s,5*s)},t.drawMagicCube=function(e,t,r,n,o,i){var a,s;e.translate(n,o),e.strokeStyle=I[t][r].strokeStyle,a=I[t][r].fillColor.split(" "),e.fillStyle=I[t][r].strokeStyle,s=M(i/2),e.fillStyle=a[0],b(e,.5,.5,s,s),e.fillStyle=a[1],b(e,s+.5,.5,s,s),e.fillStyle=a[2],b(e,.5,s+.5,s,s),e.fillStyle=a[3],b(e,s+.5,s+.5,s,s)},t.drawSector=function(e,t,r,n,o,i){e.translate(n+i/2,o+i/2),e.strokeStyle=I[t][r].strokeStyle,4===r?(e.beginPath(),e.arc(0,0,i/2,0,I[t][r].rotate),e.closePath(),e.fillStyle=I[t][r].fillColor,e.fill(),e.beginPath(),e.arc(0,0,i/2,0,I[t][r].rotate),e.closePath(),e.stroke()):0===r?(e.beginPath(),e.arc(0,0,i/2,0,2*k),e.closePath(),e.fillStyle="white",e.fill(),e.beginPath(),e.arc(0,0,i/2,0,I[t][r].rotate),e.stroke(),e.closePath()):1===r?(e.beginPath(),e.arc(0,0,i/2,0,2*k),e.closePath(),e.fillStyle="white",e.fill(),e.beginPath(),e.moveTo(0,0),e.lineTo(0,-i/2),e.arc(0,0,i/2,.5*-k,0),e.lineTo(0,0),e.closePath(),e.fillStyle=I[t][r].fillColor,e.fill(),e.arc(0,0,i/2,0,2*k),e.stroke()):2===r?(e.beginPath(),e.arc(0,0,i/2,0,2*k),e.closePath(),e.fillStyle="white",e.fill(),e.beginPath(),e.moveTo(0,0),e.lineTo(0,-i/2),e.arc(0,0,i/2,.5*-k,.5*k),e.moveTo(0,0),e.closePath(),e.fillStyle=I[t][r].fillColor,e.fill(),e.arc(0,0,i/2,0,2*k),e.stroke()):3===r&&(e.beginPath(),e.arc(0,0,i/2,0,2*k),e.closePath(),e.fillStyle="white",e.fill(),e.beginPath(),e.moveTo(0,0),e.lineTo(0,-i/2),e.arc(0,0,i/2,.5*-k,k),e.lineTo(0,0),e.fillStyle=I[t][r].fillColor,e.fill(),e.arc(0,0,i/2,0,2*k),e.stroke(),e.closePath())},t.drawStar=function(e,t,r,n,o,i){var a=i/1.8,s=a/2.5;e.translate(a+n,a+o),e.strokeStyle="#727272",e.fillStyle=I[t][r].fillColor,e.beginPath(),2===r&&(e.strokeStyle="#727272",y(e,a,s),e.fill(),e.stroke(),e.strokeStyle=I[t][r].strokeStyle,y(e,a,s),e.stroke(),e.closePath()),0===r&&(e.fillStyle="white",y(e,a,s),e.fill(),e.stroke(),e.strokeStyle="#727272",y(e,a,s),e.stroke(),e.closePath()),1===r&&(e.strokeStyle=I[t][r].fillColor,e.moveTo(0*a,-u(.5*k)*a),e.lineTo(l(.7*k)*s,-u(.7*k)*s),e.lineTo(l(.9*k)*a,-u(.9*k)*a),e.lineTo(l(1.1*k)*s,-u(1.1*k)*s),e.lineTo(l(1.3*k)*a,-u(1.3*k)*a),e.lineTo(0*s,-u(1.5*k)*s),e.fill(),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(0*a,-u(.5*k)*a),e.lineTo(-l(.7*k)*s,-u(.7*k)*s),e.lineTo(-l(.9*k)*a,-u(.9*k)*a),e.lineTo(-l(1.1*k)*s,-u(1.1*k)*s),e.lineTo(-l(1.3*k)*a,-u(1.3*k)*a),e.lineTo(0*s,-u(1.5*k)*s),e.fillStyle="white",e.fill(),e.closePath(),e.beginPath(),e.strokeStyle="#727272",y(e,a,s),e.stroke(),e.closePath())},t.drawIconTypeIsEight=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T;2===r?(w=t,v=r,S=n,x=o,T=i,(C=e).translate(M(S+T/2),M(T/2+x)),C.strokeStyle=I[w][v].strokeStyle,C.rotate(I[w][v].rotate),C.beginPath(),C.arc(0,0,T/2,0,2*k),C.closePath(),C.fillStyle=I[w][v].fillColor,C.fill(),C.beginPath(),C.arc(0,0,T/2,0,2*k),C.stroke(),C.closePath(),C.beginPath(),C.fillStyle=I[w][v].fillColor2,C.fillRect(.325*-T,.25*-T,.2*T,.5*T),C.closePath(),C.fill(),C.beginPath(),C.fillStyle=I[w][v].fillColor2,C.fillRect(.325*-T,.05*T,.65*T,.2*T),C.closePath(),C.fill(),C.stroke()):0===r?(f=e,d=t,p=r,g=n,m=o,y=M((b=i)/2),f.translate(g+y,m+y),f.strokeStyle=I[d][p].strokeStyle,f.rotate(I[d][p].rotate),f.beginPath(),f.arc(0,0,y,0,2*k),f.closePath(),f.fillStyle=I[d][p].fillColor,f.fill(),f.beginPath(),f.arc(0,0,y,0,2*k),f.closePath(),f.stroke(),f.beginPath(),f.fillStyle=I[d][p].fillColor2,f.fillRect(.375*-b,.1*-b,.75*b,.2*b),f.closePath(),f.fill(),f.beginPath(),f.fillStyle=I[d][p].fillColor2,f.fillRect(.1*-b,.375*-b,.2*b,.75*b),f.closePath(),f.fill(),f.stroke()):1===r&&(s=t,l=r,u=n,c=o,h=i,(a=e).translate(u,c),a.strokeStyle=I[s][l].strokeStyle,a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*k),a.closePath(),a.fillStyle=I[s][l].fillColor,a.fill(),a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*k),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(h/3,.1*h),a.lineTo(h/1.5,.1*h),a.lineTo(.625*h,.6*h),a.lineTo(.375*h,.6*h),a.lineTo(h/3,.1*h),a.moveTo(.625*h,.85*h),a.arc(.5*h,.8*h,.15*h,0,2*k),a.fillStyle=I[s][l].fillColor2,a.fill(),a.closePath())},t.drawIconTypeIsNine=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A;2===r?(v=t,S=r,x=n,T=o,A=i,(w=e).translate(M(x+A/2),M(T+A/2)),w.strokeStyle=I[v][S].strokeStyle,w.rotate(I[v][S].rotate),w.beginPath(),w.fillStyle=I[v][S].fillColor,w.fillRect(.375*-A,.25*-A,.2*A,.5*A),w.closePath(),w.fill(),w.beginPath(),w.fillStyle=I[v][S].fillColor,w.fillRect(.375*-A,.05*A,.75*A,.2*A),w.closePath(),w.fill(),w.stroke()):0===r?(d=t,p=r,g=n,m=o,C=i,(f=e).translate(M(g+C/2),M(m+C/2)),f.strokeStyle=I[d][p].strokeStyle,f.rotate(I[d][p].rotate),f.beginPath(),R(f,-(b=.5*C),-(y=.075*C)),E(f,-b,y),E(f,-y,y),E(f,-y,b),E(f,y,b),E(f,y,y),E(f,b,y),E(f,b,-y),E(f,y,-y),E(f,y,-b),E(f,-y,-b),E(f,-y,-y),E(f,-b,-y),f.fillStyle=I[d][p].fillColor,f.fill(),f.stroke()):1===r&&(s=t,l=r,u=n,c=o,h=i,(a=e).translate(u,c),a.beginPath(),a.strokeStyle=I[s][l].strokeStyle,a.moveTo(h/3,.5),a.lineTo(h/1.5,.5),a.lineTo(.625*h,.65*h),a.lineTo(.375*h,.65*h),a.lineTo(h/3,.5),a.moveTo(.65*h,.85*h),a.arc(.5*h,.85*h,.15*h,0,2*k),a.fillStyle=I[s][l].fillColor,a.fill(),a.stroke())},t.drawFlag=function(e,t,r,n,o,i){var a=1.2*i;e.translate(n,o),e.strokeStyle=d,e.fillStyle=d,b(e,M(.2*a)+.5,.5,M(.06*a),M(.8*a)),e.strokeStyle=I[t][r].strokeStyle,e.beginPath(),R(e,.4*a,.5),E(e,.4*a,.5*a),E(e,.9*a,.25*a),E(e,.4*a,.5),e.fillStyle=I[t][r].fillColor,e.fill(),e.stroke()},t.drawIconTypeIsSen=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b;2===r?C(e,t,r,n,o,i):1===r?(f=e,d=t,p=r,g=n,m=o,b=M(i),f.translate(g,m),f.strokeStyle=I[d][p].strokeStyle,f.beginPath(),R(f,0,b),E(f,b/2,b-b/2*Math.sqrt(3)),E(f,b,b),E(f,0,b),f.fillStyle=I[d][p].fillColor,f.closePath(),f.fill(),f.stroke()):(s=t,l=r,u=n,c=o,h=i,(a=e).strokeStyle=I[s][l].strokeStyle,a.beginPath(),a.translate(u+M(h/2),c+M(h/2)),a.beginPath(),R(a,0,-h/2),E(a,h/2,0),E(a,0,h/2),E(a,-h/2,0),E(a,0,-h/2),a.fillStyle=I[s][l].fillColor,a.closePath(),a.fill(),a.stroke())},t.drawTrafficLight=function(e,t,r,n,o,i){var a=M(i);e.strokeStyle=I[t][r].strokeStyle,e.fillStyle=I[t][r].fillColor,b(e,n+.5,o+.5,a,a),e.beginPath(),e.arc(a/2+n+.5,a/2+o+.5,.375*a,0,2*k),e.fillStyle=I[t][r].fillColor2,e.fill(),e.stroke()},t.drawCircle=C,t.drawIconTypeIsTwo=function(e,t,r,n,o,i){var a,s,l,u,c,h;1===r?(s=t,l=r,u=n,c=o,h=i,(a=e).strokeStyle=I[s][l].strokeStyle,a.translate(M(h/2+u),M(h/2+c)),a.beginPath(),a.rotate(I[s][l].rotate),R(a,-h/2,-h/5.4),E(a,h/2,-h/5.4),E(a,h/2,h/5.4),E(a,-h/2,h/5.4),E(a,-h/2,-h/5.4),a.fillStyle=I[s][l].fillColor,a.fill(),a.stroke()):0===r?function(e,t,r,n,o,i){e.strokeStyle=I[t][r].strokeStyle;var a=i;e.translate(M(a/2+n),M(a/2+o)),e.beginPath(),R(e,-a/2,-a/3),E(e,a/2,-a/3),E(e,0,a/3),E(e,-a/2,-a/3),e.fillStyle=I[t][r].fillColor,e.fill(),e.stroke()}(e,t,r,n,o,i):2===r&&function(e,t,r,n,o,i){e.strokeStyle=I[t][r].strokeStyle;var a=i;e.translate(M(a/2+n),M(a/2+o)),e.beginPath(),R(e,-a/2,a/3),E(e,a/2,a/3),E(e,0,-a/3),E(e,-a/2,a/3),e.fillStyle=I[t][r].fillColor,e.fill(),e.stroke()}(e,t,r,n,o,i)},t.drawArrows=function(e,t,r,n,o,i){var a,s,l,u,c=i/3.5,h=I[t].length-1;e.strokeStyle=I[t][h-r].strokeStyle,e.translate(M(1.75*c+n),M(1.75*c+o)),e.rotate(I[t][h-r].rotate),e.beginPath(),a=.25*c,s=1.25*c,R(e,-(l=.75*c),-(u=1.75*c)),E(e,a,-u),E(e,a,a),E(e,s,-l),E(e,s,a),E(e,-a,u),E(e,-u,a),E(e,-u,-l),E(e,-l,a),E(e,-l,-u),e.fillStyle=I[t][h-r].fillColor,e.fill(),e.stroke()}},"./dist/plugins/contextMenu/context-menu-dialog.js":function(e,t,r){"use strict";var n,o,i,a,s,l,u,c=this&&this.__extends||(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function h(e,t){var r=u.call(this,e,o(e))||this;return r.Eu=t,r}Object.defineProperty(t,"__esModule",{value:!0}),n=r("Core"),o=n.Ul.vl,i=n.Go,a=n.GC$,s="gc.command.executed",c(h,u=i),h.prototype.Qla=function(e,t,r){var n=e[0];this.kma&&this.kma.ai&&this.kma.ai(n,t,r,this.Eu)},h.prototype.OT=function(e,t,r,n,o){var i=this.Sla(r,n);this.kma=e,this.Qla(i,t,o)},h.prototype.Sla=function(e,t){var r=this.yo();return r.css(["left","top"],[e,t]),r.empty(),u.prototype.Ao.call(this),this.QQ(),r},h.prototype.Loa=function(e){var t,r,n,o=this.yo();return"block"!==o.css("display")||((t=o.offset()).top+=document.body.clientTop||0,t.left+=document.body.clientLeft||0,r=e.x,n=e.y,r<t.left||r>o.width()+t.left||n<t.top||n>o.height()+t.top)},h.prototype.QQ=function(){var e=this;e.Eu.bind(s,function(){e.close()})},h.prototype.Tla=function(){this.Eu.unbind(s)},h.prototype.close=function(){this.kma&&this.kma.no(),this.Tla(),this.vo(this.Cj)&&a("#"+this.Cj).remove(),u.prototype.close.call(this)},t.ContextMenuViewDialog=h},"./dist/plugins/contextMenu/context-menu.entry.js":function(e,r,t){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),n(t("./dist/plugins/contextMenu/context-menu.js")),n(t("./dist/plugins/contextMenu/menu-view.js")),n(t("./dist/plugins/contextMenu/context-menu.ns.js"));var o=t("./dist/plugins/contextMenu/context-menu-dialog.js");r.Cyb=o.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(e,t,r){"use strict";var n,o,i,P,a,l,L,O,s,B,c,u,h,j,H,f,d,p,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,g,ue,ce,he,fe,de,pe,ge,m,me,be,b,y,C,w,v,S,x,T,ye,Ce,we,ve,Se,A,k,M,xe,I;function Te(e){var t,r;if(e.slicers){if(!(t=e.slicers.all())||O(t))return;for(r in t)if(t[r].isSelected())return 1}else;}function Ae(e,t,r){var n,o,i,a,s="row"===t?"rowCount":"colCount";for(n=0;n<e.length;n++)for(i=-1===(o=e[n])[t]?0:o[t],a=0;a<o[s];a++)r(i+a)}function ke(e,t){var r,n=[],o=-1;for(r=e.row;r<e.row+e.rowCount;r++)!1!==t[r]&&-1===o&&(o=r),!1===t[r]&&-1!==o&&(n.push([o,r-o]),o=-1);return-1!==o&&n.push([o,r-o]),n}function Me(e,t){var r,n,o,i;if(1===t.colCount&&-1===t.row){if((r=t.col)===e.$q()&&(0<=(n=r-1)&&!e.getColumnVisible(n)))return!0}else if(1===t.rowCount&&-1===t.col&&((o=t.row)===e.ar()&&(0<=(i=o-1)&&!e.getRowVisible(i))))return!0}function E(e,t){var r,n,o,i,a,s=[c+ee,c+V,c+U,c+W],l=t.name;if(s.indexOf(l)<0)return!0;if(n=(r=e.getActiveSheet()).getActiveRowIndex(),o=r.getActiveColumnIndex(),r.comments){if(r.comments.get(n,o))return l!==c+ee;if(l===c+V||l===c+U)return!1;if(l===c+ee)return!0;for(i=r.getSelections(),a=0;a<i.length;a++)if(D(i[a],r))return!0;return!1}}function R(e,t){var r,n,o,i,a,s;if(t.comments)for(r=t.comments.all(),o=n=void 0,i=0;i<e.length;i++)for(a=e[i],s=0;s<r.length;s++)if(!r[s].locked()&&(o=r[s].nT,n=r[s].oT,o>=a.row&&o<a.row+a.rowCount&&n>=a.col&&n<a.col+a.colCount))return 1}function D(e,t){var r,n,o,i;if(t.comments)for(r=t.comments.all(),o=n=void 0,i=0;i<r.length;i++)if(o=r[i].nT,n=r[i].oT,o>=e.row&&o<e.row+e.rowCount&&n>=e.col&&n<e.col+e.colCount)return 1}function N(e,t){var r,n,o,i,a;return[c+"sort",c+$].indexOf(t.name)<0||!(!(n=(r=e.getActiveSheet()).getSelections())||1!==n.length||(i=Ie(r,o=n[0]))&&(a=i.range(),o.row<a.row||o.col<a.col||o.row+o.rowCount>a.row+a.rowCount||o.col+o.colCount>a.col+a.colCount))}function F(e){var t,r,n,o=e.getActiveRowIndex(),i=e.getActiveColumnIndex();if(!e.tu().UHb)return!1;if(e.tables&&e.tables.find(o,i))return!1;for(t=e._modelManager.getSpans(),r=0;r<t.length;r++)if(o>=(n=t[r]).row&&o<n.row+n.rowCount&&i>=n.col&&i<n.col+n.colCount)return!1;return!0}function Ie(e,t){var r,n,o;if(!t)return null;for(r=t.row;r<t.row+t.rowCount;r++)for(n=t.col;n<t.col+t.colCount;n++)if(e.tables&&(o=e.tables.find(r,n)))return o;return null}function Ee(e,t,r,n){var o,i;for(o=0;o<t.length;o++)(i=t[o]).PIb(r,n,!0,Se,i.nKb())}function Re(e){var t,r,n,o=e;for(t=0;t<o.length-1;t++)for(r=t+1;r<o.length;r++)o[t].row<o[r].row&&(n=o[t],o[t]=o[r],o[r]=n);return o}function De(e){var t,r,n,o=e;for(t=0;t<o.length-1;t++)for(r=t+1;r<o.length;r++)o[t].col<o[r].col&&(n=o[t],o[t]=o[r],o[r]=n);return o}function Ne(e,t,r,n){var o=e._modelManager.getSpans(Se,3);0<=t?(Fe(e,o,t,n,3),Fe(e,e._modelManager.getSpans(Se,2),t,n,2)):0<=r&&(_(e,o,r,n,3),_(e,e._modelManager.getSpans(Se,1),r,n,1))}function _(e,t,r,n,o){var i,a,s,l,u,c,h;for(i=0,a=t.length;i<a;i++)if(r>(s=t[i]).col&&r<s.col+s.colCount)for(l=e.getStyle(s.row,s.col,o),u=r;u<r+n;u++)for(c=s.row;c<s.row+s.rowCount;c++)e.setStyle(c,u,l,o),c===s.row+s.rowCount-1&&((h=e.getCell(s.row+s.rowCount-1,s.col).borderBottom())&&e.getCell(c,u).borderBottom(h))}function Fe(e,t,r,n,o){var i,a,s,l,u,c,h;for(i=0,a=t.length;i<a;i++)if(r>=(s=t[i]).row&&r<=s.row+s.rowCount)for(l=e.getStyle(s.row,s.col,o),u=r;u<r+n;u++)for(c=s.col;c<s.col+s.colCount;c++)e.setStyle(u,c,l,o),c===s.col+s.colCount-1&&((h=e.getCell(s.row,s.col+s.colCount-1).borderRight())&&e.getCell(u,c).borderRight(h))}function _e(e,t,r,n,o){var i,a,s,l,u,c=e.getSheetFromName(t.sheetName);return!!c&&(i=t.considerAllSheets,a=e.sheets,c.suspendPaint(),s=P.Commands.bWa(c.name()),r?(o&&o(c,t),i?P.Commands._xb(a,t):c._modelManager.undo(t[s])):(i?P.Commands.Zxb(a):c._modelManager.startTransaction(),l=n(c,t),i?P.Commands.$xb(a,t):t[s]=c._modelManager.endTransaction()),c.resumePaint(),i&&((u=e.getActiveSheet())&&c!==u&&u.repaint()),l)}function Pe(e,t,r){var n;if(0<r){for(n=t+1;n<e.getRowCount();n++)if((r-=e.getRowHeight(n))<=0)return n-t}else if(r<0)for(n=t-1;0<=n;n--)if(0<=(r+=e.getRowHeight(n)))return n-t;return 0}function Le(e,t,r,n){var o,i,a=e.getSheetFromName(t.sheetName);a&&(o=a.options.clipBoardOptions,a.options.clipBoardOptions=n,i=function(){a.options.clipBoardOptions=o},r.execute({cmd:le,sheetName:a.name(),callback:i}))}function Oe(e,t,r,n){return _e(e,t,r,function(e){var t,r=function(e){var t,r,n;if(e.slicers){if(!(t=e.slicers.all())||O(t))return null;for(n in r=[],t)t[n].isSelected()&&r.push(t[n]);return r}}(e);if(r&&0!==r.length)for(t in r)r.hasOwnProperty(t)&&r[t].sortState(n)})}function Be(e){e.Os(7,k().hideSheetFailureInfo)}function je(){this.menuView=new i.MenuView,this.menuData=[{text:k().copy,name:c+de,command:B+de,iconClass:u+de,workArea:h+j+H+f+p},{text:k().cut,name:c+"cut",command:B+"cut",iconClass:u+"cut",workArea:h+j+H+f+p},{text:k().pasteOptions,name:c+g,iconClass:u+g,type:"groupHeader",workArea:h+j+H+f+p},{command:B+fe,name:c+fe,iconClass:u+fe,group:c+g,text:k().pasteAll,workArea:h+j+H+f+p},{command:B+he,name:c+he,iconClass:u+he,group:c+g,text:k().pasteFormula,workArea:h+j+H+p},{command:B+ce,name:c+ce,iconClass:u+ce,group:c+g,text:k().pasteValues,workArea:h+j+H+p},{command:B+ue,name:c+ue,iconClass:u+ue,group:c+g,text:k().pasteFormatting,workArea:h+j+H+p},{command:B+pe,name:c+pe,iconClass:u+pe,group:c+g,text:k().pasteValuesFormatting,workArea:h+j+H+p},{command:B+ge,name:c+ge,iconClass:u+ge,group:c+g,text:k().pasteFormulaFormatting,workArea:h+j+H+p},{type:m},{text:k().clearContents,command:B+se,name:c+se,workArea:h+j+H+p},{type:m},{text:k().headerInsertCopiedCells,name:c+H+ye,command:B+H+ye,workArea:H},{text:k().headerInsertCutCells,name:c+H+Ce,command:B+H+Ce,workArea:H},{text:k().headerInsertCopiedCells,name:c+j+ye,command:B+j+ye,workArea:j},{text:k().headerInsertCutCells,name:c+j+Ce,command:B+j+Ce,workArea:j},{text:k().insertCopiedCells,name:c+ye,subMenu:[{text:k().shiftCellsRight,name:c+ye+ve,command:B+ye+ve,iconClass:u+ve},{text:k().shiftCellsDown,name:c+ye+we,command:B+ye+we,iconClass:u+we}],workArea:h},{text:k().insertCutCells,name:c+Ce,subMenu:[{text:k().shiftCellsRight,name:c+Ce+ve,command:B+Ce+ve,iconClass:u+ve},{text:k().shiftCellsDown,name:c+Ce+we,command:B+Ce+we,iconClass:u+we}],workArea:h},{text:k().insertRows,name:c+ne,command:B+ne,workArea:H},{text:k().insertColumns,name:c+oe,command:B+oe,workArea:j},{text:k().deleteRows,name:c+ie,command:B+ie,workArea:H},{text:k().deleteColumns,name:c+ae,command:B+ae,workArea:j},{type:m},{text:k().tableInsert,name:c+b,subMenu:[{text:k().tableInsertColumnsLeft,name:c+v,command:"tableInsertColumnsLeftForContextMenu",iconClass:u+v},{text:k().tableInsertColumnsRight,name:c+S,command:"tableInsertColumnsRightForContextMenu",iconClass:u+S},{text:k().tableInsertRowsAbove,name:c+C,command:"tableInsertRowsAboveForContextMenu",iconClass:u+C},{text:k().tableInsertRowsBelow,name:c+w,command:"tableInsertRowsBelowForContextMenu",iconClass:u+w}],workArea:"table"},{text:k().tableDelete,name:c+y,subMenu:[{text:k().tableDeleteColumns,name:c+T,command:"tableDeleteColumnsForContextMenu",iconClass:u+T},{text:k().tableDeleteRows,name:c+x,command:"tableDeleteRowsForContextMenu",iconClass:u+x}],workArea:"table"},{type:m},{text:k().insertSheet,name:c+re,command:B+re,workArea:d},{text:k().deleteSheet,name:c+te,command:B+te,workArea:d},{type:m},{text:k().filter,name:c+$,command:B+$,workArea:h+p},{text:k().sort,name:c+"sort",subMenu:[{text:k().sortAscend,name:c+J,command:B+J,iconClass:u+J},{text:k().sortDescend,name:c+Q,command:B+Q,iconClass:u+Q}],workArea:h+p},{text:k().slicerSortAscend,name:c+me,command:B+me,iconClass:u+J,workArea:f},{text:k().slicerSortDescend,name:c+be,command:B+be,iconClass:u+Q,workArea:f},{type:m},{text:k().insertComment,name:c+ee,command:B+ee,iconClass:u+ee,workArea:h+p},{text:k().editComment,name:c+V,command:B+V,iconClass:u+V,workArea:h+p},{text:k().deleteComment,name:c+W,command:B+W,iconClass:u+W,workArea:h+p},{text:k().toggleComment,name:c+U,command:B+U,workArea:h+p},{type:m},{text:k().hideRows,name:c+K,command:B+K,workArea:H},{text:k().unhideRows,name:c+Z,command:B+Z,workArea:H},{text:k().hideColumns,name:c+X,command:B+X,workArea:j},{text:k().unhideColumns,name:c+Y,command:B+Y,workArea:j},{type:m},{text:k().hideSheet,name:c+q,command:B+q,workArea:d},{text:k().unhideSheet,name:c+z,command:B+z,workArea:d},{type:m},{text:k().removeSlicer,name:c+G,command:B+G,workArea:f}]}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),o=r("./dist/plugins/contextMenu/context-menu-dialog.js"),i=r("./dist/plugins/contextMenu/menu-view.js"),P=r("Core"),a=r("./dist/plugins/contextMenu/context-menu.ns.js"),l=P.GC$,L=n.Common.j.Fa,O=n.Common.j.za,s=P.Ul.nl,n.Commands.CommandManager,B="gc.spread.contextMenu.",c="gc.spread.",u="gc-spread-",h="viewport",j="colHeader",H="rowHeader",f="slicer",d="sheetTab",p="corner",G="removeSlicer",U="toggleComment",W="deleteComment",V="editComment",z="unhideSheet",q="hideSheet",Z="unhideRows",Y="unhideColumns",K="hideRows",X="hideColumns",J="sortAscend",Q="sortDescend",$="filter",ee="insertComment",te="deleteSheet",re="insertSheet",ne="insertRows",oe="insertColumns",ie="deleteRows",ae="deleteColumns",se="clearContents",le="paste",g="pasteOptions",ue="pasteFormatting",ce="pasteValues",he="pasteFormula",fe="pasteAll",de="copy",pe="pasteValuesFormatting",ge="pasteFormulaFormatting",m="separator",me="slicerSortAscend",be="slicerSortDescend",b="tableInsert",y="tableDelete",C="tableInsertRowsAbove",w="tableInsertRowsBelow",v="tableInsertColumnsLeft",S="tableInsertColumnsRight",x="tableDeleteRows",T="tableDeleteColumns",ye="insertCopiedCells",Ce="insertCutCells",we="shiftCellsDown",ve="shiftCellsRight",Se=void 0,A=new n.Common.ResourceManager(a.SR),k=A.getResource.bind(A),M={sheetTab:function(e,t,r){return RegExp("sheetTab","i").test(r.workArea)&&e.tabStripHitInfo&&e.tabStripHitInfo.sheetTab&&"newSheet"!==e.tabStripHitInfo.sheetTab.sheetName},outline:function(e,t,r){return!!(RegExp("outline","i").test(r.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.outlineHitInfo)},viewport:function(e,t,r){if(RegExp("viewport","i").test(r.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.commentHitInfo)return E(t,r)&&N(t,r)&&(a=t,[c+ye].indexOf(r.name)<0||(s=a.getActiveSheet(),(l=s.tu())&&!l.G4&&l.n5&&1===l.n5.length&&1===s.getSelections().length&&F(s)))&&(n=t,[c+Ce].indexOf(r.name)<0||(o=n.getActiveSheet(),(i=o.tu())&&i.G4&&i.n5&&1===i.n5.length&&1===o.getSelections().length&&F(o)));var n,o,i,a,s,l},rowHeader:function(e,t,r){if(RegExp("rowHeader","i").test(r.workArea)&&e.worksheetHitInfo&&2===e.worksheetHitInfo.hitTestType)return function(e,t){var r,n,o,i,a,s,l,u;if([c+H+ye,c+H+Ce].indexOf(t.name)<0)return!0;if(r=e.getActiveSheet(),n=r.tu(),o=r.getActiveRowIndex(),r.tables)for(i=r.tables.all(),a=0;a<i.length;a++)if(s=i[a],o>s.cj&&o<s.cj+s.Xj)return!1;for(l=r._modelManager.getSpans(),a=0;a<l.length;a++)if(u=l[a],o>u.row&&o<u.row+u.rowCount)return!1;if(!n.UHb||n.n5&&1!==n.n5.length||1!==r.getSelections().length)return!1;if(t.name===c+H+Ce){if(n.G4&&n.n5&&r.getColumnCount()%n.n5[0].colCount==0)return!0}else if(t.name===c+H+ye&&!n.G4&&n.n5&&r.getColumnCount()%n.n5[0].colCount==0)return!0;return!1}(t,r)},colHeader:function(e,t,r){if(RegExp("colHeader","i").test(r.workArea)&&e.worksheetHitInfo&&1===e.worksheetHitInfo.hitTestType)return function(e,t){var r,n,o,i,a,s,l,u;if([c+j+ye,c+j+Ce].indexOf(t.name)<0)return!0;if(r=e.getActiveSheet(),n=r.tu(),o=r.getActiveColumnIndex(),r.tables)for(i=r.tables.all(),a=0;a<i.length;a++)if(s=i[a],o>s.dj&&o<s.dj+s.OZ)return!1;for(l=r._modelManager.getSpans(),a=0;a<l.length;a++)if(u=l[a],o>u.col&&o<u.col+u.colCount)return!1;if(!n.UHb||n.n5&&1!==n.n5.length||1!==r.getSelections().length)return!1;if(t.name===c+j+ye){if(!n.G4&&n.n5&&r.getRowCount()%n.n5[0].rowCount==0)return!0}else if(t.name===c+j+Ce&&n.G4&&n.n5&&r.getRowCount()%n.n5[0].rowCount==0)return!0;return!1}(t,r)},corner:function(e,t,r){if(RegExp("corner","i").test(r.workArea)&&e.worksheetHitInfo&&0===e.worksheetHitInfo.hitTestType)return E(t,r)&&N(t,r)},slicer:function(e,t,r){return RegExp("slicer","i").test(r.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"Slicer"===e.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},chart:function(e,t,r){return RegExp("chart","i").test(r.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===e.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(e,t,r){return RegExp("shape","i").test(r.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo},table:function(e,t,r){var n=t.getActiveSheet().tables;return RegExp("table","i").test(r.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&n&&n.mKb()},vpWithoutTb:function(e,t,r){if(RegExp("vpWithoutTb","i").test(r.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.commentHitInfo){var n=t.getActiveSheet().tables;return!(n&&n.mKb())&&E(t,r)&&N(t,r)}}},xe=[],je.prototype.ad=function(e){this.Mma||(this.wu=e.commandManager(),L(this.Ela)&&(this.Ela=new o.ContextMenuViewDialog(e.xv(),l(e.sv))),this.nla(e),this.kTa={filter:{menuDataDict:[c+$],checkFunction:function(e){if(e.rowFilter)return!0}},comments:{menuDataDict:[c+ee,c+V,c+W,c+U],checkFunction:function(e){if(e.comments)return!0}},slicer:{menuDataDict:[c+me,c+be,c+G],checkFunction:function(e){if(e.slicers)return!0}},floatingObject:{menuDataDict:[c+ce,c+ue,c+he],checkFunction:function(e){var t;return!e.BR||!((t=e.BR().fromSheet)&&t.CR)||void 0}},table:{menuDataDict:[c+b,c+y],checkFunction:function(e){if(e.tables)return!0}}},this.Mma=!0)},je.prototype.ola=function(e,t){var r,n,o,i;return t.focus(),r=this.pla(e,t),n=t.getActiveSheet(),L(r)||L(n)?void s(e):(o={row:n.getActiveRowIndex(),col:n.getActiveColumnIndex()},void(n.isEditing()&&r.worksheetHitInfo&&r.worksheetHitInfo.col===o.col&&r.worksheetHitInfo.row===o.row||t.getTab()&&t.getTab().FD||(this.ad(t),this.qla(r,t),i=this.Fla(this.menuData,r,t),this.onOpenMenu(this.menuData,i,r,t)||(s(e),i.length&&this.jla(i,r,t)))))},je.prototype.qla=function(e,t){this.Ela.Loa(e)&&this.sla(e,t)},je.prototype.sla=function(e,t){var r=t.getActiveSheet();r.isEditing()&&r.endEdit(),this.tla(e)?this.ula(e,t):this.vla(e)&&this.wla(e,t)},je.prototype.vla=function(e){return!!e.worksheetHitInfo},je.prototype.xla=function(e,t,r,n){var o,i,a=!0;if(1===n){for(o=0;o<e.length;o++)-1===(i=e[o]).row&&r>=i.col&&r<i.col+i.colCount&&(a=!1);return a}if(2===n){for(o=0;o<e.length;o++)-1===(i=e[o]).col&&t>=i.row&&t<i.row+i.rowCount&&(a=!1);return a}for(o=0;o<e.length;o++)if((i=e[o]).contains(t,r))return!1;return!0},je.prototype.tla=function(e){return!(!e.tabStripHitInfo||!e.tabStripHitInfo.sheetTab)},je.prototype.yla=function(e){return e.tabStripHitInfo.sheetTab.sheetName},je.prototype.wla=function(e,t){var r=t.getActiveSheet(),n=e.worksheetHitInfo;n.floatingObjectHitInfo||n.commentHitInfo||n.shapeHitInfo||(this.Ala(r,n),this.aPa(r))},je.prototype.aPa=function(e){var t,r=e.getActiveRowIndex(),n=e.getActiveColumnIndex(),o=e.comments;!o||(t=o.get(r,n))&&o.bU===t&&o.hT(t)},je.prototype.zla=function(e){return 3===e.hitTestType},je.prototype.cs=function(e,t,r){e.cs&&e.cs(t,r)},je.prototype.Ala=function(e,t){var r=e._modelManager.getSelections(),n=t.row,o=t.col;this.xla(r,n,o,t.hitTestType)&&e.Qs(t.rowViewportIndex<0?-1:t.row,t.colViewportIndex<0?-1:t.col)&&(e._eventHandler.Ala(e,t,n,o),e._eventHandler.hH())},je.prototype.ula=function(e,t){var r=this.yla(e),n=t.getSheetIndex(r),o=t.sheets[n];o&&(o.isSelected()||(t.sheets.forEach(function(e){e.isSelected()&&e.DHb(!1,!0)}),t.hq&&t.hq.BHb(t,o,!1,!0,o.name(),n)),t.dq(n,2,!1,!0),this.$Oa(this.menuData,e,t))},je.prototype.pla=function(e,t){var r=t.oia(),n=e.pageX-r.left,o=e.pageY-r.top;return t.hitTest(n,o,!0)},je.prototype.onOpenMenu=function(e,t,r,n){},je.prototype.jla=function(e,t,r){this.Ela.Loa(t)&&(this.Cla(),this.Dla(e,t,r))},je.prototype.Cla=function(){this.Ela.close()},je.prototype.Dla=function(e,t,r){this.Ela.OT(this.menuView,e,t.x,t.y,r)},je.prototype.Fla=function(e,n,o){var i=[],t={};return l.extend(!0,t,e),l.each(t,function(e,r){L(r)||(r.type===m&&i.push(r),l.each(M,function(e,t){t(n,o,r)&&i.push(r)}))}),this.J$a(i,n),this.lTa(i,o),this.oKb(i,o),this.UZa(i,o),this.RZa(i),i=this.Bma(i),this.pKb(i),i},je.prototype.pKb=function(e){var t,r,n=0,o=!1;for(t=0;t<e.length&&((r=e[t].name)!==c+H+ye&&r!==c+H+Ce&&r!==c+j+ye&&r!==c+j+Ce||(o=!0),r!==c+ne&&r!==c+oe||(n=t,!o));t++);o&&e.splice(n,1)},je.prototype.J$a=function(e,t){var r=t.worksheetHitInfo;!r||r.row!==Se&&r.col!==Se||e.splice(0,e.length)},je.prototype.lTa=function(i,e){var a=this,s=e.getActiveSheet(),t=a.kTa;return l.each(t,function(e,t){var r,n,o;if(!t.checkFunction(s))for(n=0,o=(r=t.menuDataDict).length;n<o;n++)a.hma(i,r[n],function(e,t){e[t]=null})}),i},je.prototype.oKb=function(e,t){var n,o,i,r=t.getActiveSheet(),a=r.getSelections();a&&0<a.length&&(n=Ie(r,a[0]),o=r.getActiveRowIndex(),i=r.getActiveColumnIndex(),n&&l.each(e,function(e,t){if(!L(t)&&t.name===c+b){var r=t.subMenu;n.checkTableLastRow(o)&&r.splice(3,1),n.checkTableLastCol(i)&&r.splice(1,1)}}))},je.prototype.RZa=function(e){var t;for(t=e.length-1;0<t;t--)e[t]?e[t].subMenu&&this.RZa(e[t].subMenu):e.splice(t,1);return e},je.prototype.Bma=function(e){var t,r,n,o,i,a=[],s=e.length;for(t=0;t<s;t++)e[t]&&e[t].type===m&&e[t+1]&&e[t+1].type===m||a.push(e[t]);for(s=a.length,i=o=!(n=r=0),t=0;t<s&&(o&&a[t].type===m?r++:o=!1,i&&a[s-1-t].type===m?n++:i=!1,o||i);t++);return a.splice(s-n,n),a.splice(0,r),a},je.prototype.UZa=function(e,t){this.VZa(e,t),this.QZa(e,t)},je.prototype.VZa=function(e,t){var r,n=t.getActiveSheet(),o=n.tables;for(r=0;r<e.length;r++)if(e[r]){switch(e[r].name){case c+ne:n.ZZa()||(e[r].disable=!0);break;case c+ie:(!n.ZZa()||o&&o.containTableHeaderTotalRowForSheet())&&(e[r].disable=!0);break;case c+oe:case c+ae:n.$Za()||(e[r].disable=!0);break;case c+C:o&&(o.isAcrossTables()||o.containTableHeader()||o.noRoomToInsertRow())&&(e[r].disable=!0);break;case c+w:o&&(o.isAcrossTables()||o.noRoomToInsertRow())&&(e[r].disable=!0);break;case c+x:o&&(o.checkTableRow()||o.isAcrossTables()||o.containTableHeaderTotalRow())&&(e[r].disable=!0);break;case c+v:case c+S:o&&(o.isAcrossTables()||o.noRoomToInsertColumn())&&(e[r].disable=!0);break;case c+T:o&&(o.checkTableCol()||o.isAcrossTables()||o.isWholeTableCol())&&(e[r].disable=!0)}e[r]&&e[r].subMenu&&this.VZa(e[r].subMenu,t)}},je.prototype.QZa=function(e,t){var r,n,o,i,a=t.getActiveSheet(),s=a.options.isProtected,l=a.options.protectionOptions;if(s&&l)for(r=void 0,n=0;n<e.length;n++)if(e[n]){switch(e[n].name){case c+ne:l.allowInsertRows||(e[n].disable=!0);break;case c+oe:l.allowInsertColumns||(e[n].disable=!0);break;case c+ie:l.allowDeleteRows||(e[n].disable=!0);break;case c+ae:l.allowDeleteColumns||(e[n].disable=!0);break;case c+$:l.allowFilter||(e[n].disable=!0);break;case c+J:case c+Q:l.allowSort||(e[n].disable=!0);break;case c+K:case c+Z:case c+X:case c+Y:e[n].disable=!0;break;case c+me:case c+be:l.allowEditObjects||e.splice(0,e.length);break;case c+ee:l.allowEditObjects||(e[n]=null);break;case c+V:o=void 0,a.comments&&(o=(r=a.comments.get(a.getActiveRowIndex(),a.getActiveColumnIndex()))&&r.lockText()),!l.allowEditObjects&&o&&(e[n]=null);break;case c+W:i=void 0,a.comments&&(i=!R(a.getSelections(),a)),!l.allowEditObjects&&i&&(e[n]=null);break;case c+C:case c+w:case c+v:case c+S:case c+x:case c+T:e[n].disable=!0}e[n]&&e[n].subMenu&&this.QZa(e[n].subMenu,t)}},je.prototype.$Oa=function(e,t,r){var n,o,i;if(t.tabStripHitInfo&&(n=r.sheets,o=this.RS(c+z))){for(i=0;i<n.length;i++)if(!n[i].visible())return void(o.disable=!1);o.disable=!0}},je.prototype.RS=function(e){return this.gma(this.menuData,e)},je.prototype.gma=function(e,t){var r;return this.hma(e,t,function(e,t){r=e[t]}),r},je.prototype.hma=function(e,t,r){for(var n=e.length,o=0;o<n;o++)if(!L(e[o])){if(t===e[o].name)return void r(e,o);e[o].subMenu&&this.hma(e[o].subMenu,t,r)}},je.prototype.nla=function(l){var e,t,r,n,o,i,a,s,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F=l.commandManager(),_={canUndo:!1,execute:function(e,t){var r=e.getSheetFromName(t.sheetName);r&&(Te(r)?F.execute({cmd:"copyFloatingObjects",sheetName:r.name()}):F.execute({cmd:de,sheetName:r.name(),ignoreClipboard:!0}))}};F.register(B+de,_,null,!1,!1,!1,!1),e={canUndo:!1,execute:function(e,t){var r=e.getSheetFromName(t.sheetName);r&&(Te(r)?F.execute({cmd:"cutFloatingObjects",sheetName:r.name()}):F.execute({cmd:"cut",sheetName:r.name(),ignoreClipboard:!0}))}},F.register(B+"cut",e,null,!1,!1,!1,!1),t={canUndo:!1,execute:function(e,t){var r,n,o=e.getSheetFromName(t.sheetName);o&&(o.isPasteFloatingObject&&o.isPasteFloatingObject()?F.execute({cmd:"pasteFloatingObjects",sheetName:o.name()}):o.isPasteShapes&&o.isPasteShapes()?F.execute({cmd:"pasteShapes",sheetName:o.name()}):(r=o.options.clipBoardOptions,o.options.clipBoardOptions=0,n=function(){o.options.clipBoardOptions=r},F.execute({cmd:le,sheetName:o.name(),callback:n})))}},F.register(B+fe,t,null,!1,!1,!1,!1),r={canUndo:!1,execute:function(e,t){var r,n,o=e.getSheetFromName(t.sheetName);o&&(r=o.options.clipBoardOptions,o.options.clipBoardOptions=0,n=function(){o.options.clipBoardOptions=r},F.execute({cmd:le,sheetName:o.name(),callback:n,shiftCells:P.InsertShiftCell.right}))}},F.register(B+ye+ve,r,null,!1,!1,!1,!1),F.register(B+Ce+ve,r,null,!1,!1,!1,!1),F.register(B+j+ye,r,null,!1,!1,!1,!1),F.register(B+j+Ce,r,null,!1,!1,!1,!1),n={canUndo:!1,execute:function(e,t){var r,n,o=e.getSheetFromName(t.sheetName);o&&(r=o.options.clipBoardOptions,o.options.clipBoardOptions=0,n=function(){o.options.clipBoardOptions=r},F.execute({cmd:le,sheetName:o.name(),callback:n,shiftCells:P.InsertShiftCell.down}))}},F.register(B+ye+we,n,null,!1,!1,!1,!1),F.register(B+Ce+we,n,null,!1,!1,!1,!1),F.register(B+H+ye,n,null,!1,!1,!1,!1),F.register(B+H+Ce,n,null,!1,!1,!1,!1),o={canUndo:!1,execute:function(e,t){Le(e,t,F,3)}},F.register(B+he,o,null,!1,!1,!1,!1),i={canUndo:!1,execute:function(e,t){Le(e,t,F,1)}},F.register(B+ce,i,null,!1,!1,!1,!1),a={canUndo:!1,execute:function(e,t){var r,n,o=e.getSheetFromName(t.sheetName);o&&(r=o.options.clipBoardOptions,o.options.clipBoardOptions=2,n=function(){o.options.clipBoardOptions=r},F.execute({cmd:le,sheetName:o.name(),callback:n}))}},F.register(B+ue,a,null,!1,!1,!1,!1),s={canUndo:!1,execute:function(e,t){Le(e,t,F,4)}},F.register(B+pe,s,null,!1,!1,!1,!1),u={canUndo:!1,execute:function(e,t){Le(e,t,F,5)}},F.register(B+ge,u,null,!1,!1,!1,!1),c={canUndo:!1,execute:function(e,t){var r=e.getSheetFromName(t.sheetName);r&&F.execute({cmd:"clear",sheetName:r.name()})}},F.register(B+se,c,null,!1,!1,!1,!1),h={canUndo:!0,execute:function(C,e,t){return _e(C,e,t,function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p=t.commentState||2,g=t.displayMode,m=t.activeRow,b=t.activeCol,y=e.comments.add(m,b,"");y&&(y.commentState(p),g&&y.displayMode(g),r=e.Er(m),n=e.Fr(b),o=e.getCellRect(m,b,r,n),i=e.am().Ft(r,n),a=y.location(),s=y.width(),l=y.height(),f=h=c=u=void 0,d=C.ku,o.y+a.y<i.y?(h=Pe(e,m,o.y+a.y-i.y),u=d.ms(e,h),d.ju(u.cj,0),e.os()):o.y+a.y+l>i.y+i.height&&(h=Pe(e,m,o.y+a.y+l-(i.y+i.height)),u=d.ms(e,h),d.ju(u.cj,0),e.os()),o.x+a.x+s>i.x+i.width&&(f=function(e,t,r){var n;if(0<r){for(n=t+1;n<e.getColumnCount();n++)if((r-=e.getColumnWidth(n))<=0)return n-t}else if(r<0)for(n=t-1;0<=n;n--)if(0<=(r+=e.getColumnWidth(n)))return n-t;return 0}(e,b,o.x+a.x+s-(i.x+i.width)),c=d.Sw(e,f),d.lu(c.dj,0),e.qs()))},function(e,t){var r=t.activeRow,n=t.activeCol,o=e.comments.get(r,n);o&&(t.displayMode=o.displayMode(),t.commentState=o.commentState())})}},F.register(B+ee,h,null,!1,!1,!1,!1),f={canUndo:!1,execute:function(e,t){var r,n,o,i=e.getSheetFromName(t.sheetName);i&&(r=t.activeRow,n=t.activeCol,(o=i.comments.get(r,n))&&o.commentState(2))}},F.register(B+V,f,null,!1,!1,!1,!1),d={canUndo:!0,execute:function(e,l,t){return _e(e,l,t,function(e){var t,r,n,o,i,a=l.selections,s=a.length;if(!(s<=0))for(t=0;t<s;t++)for(n=(r=a[t]).row;n<r.row+r.rowCount;n++)for(o=r.col;o<r.col+r.colCount;o++)!(i=e.comments.get(n,o))||e.options.isProtected&&!e.options.protectionOptions.allowEditObjects&&i.locked()||F.execute({cmd:W,sheetName:e.name(),row:i.nT,col:i.oT})})}},F.register(B+W,d,null,!1,!1,!1,!1),p={canUndo:!1,execute:function(e,t){var r,n,o,i=e.getSheetFromName(t.sheetName);i&&(r=t.activeRow,n=t.activeCol,(o=i.comments.get(r,n))&&(2===o.displayMode()?o.displayMode(1):o.displayMode(2)))}},F.register(B+U,p,null,!1,!1,!1,!1),g={canUndo:!0,execute:function(e,d,t){return d.considerAllSheets=!0,_e(e,d,t,function(e){var t,r,n,o,i,a,s,l,u,c,h,f=Re(d.selections);for(r=0;r<f.length;r++){for(t=f[r],n=e.getRange(t.row-1,0,1,t.colCount),o=[],i=0;i<n.colCount;i++)e.getCell(n.row,i).locked()||o.push(i);for(a=t.row,s=t.rowCount,e.addRows(a,s),l=0;l<o.length;l++)for(u=f[r].row;u<f[r].row+f[r].rowCount;u++)e.getCell(u,o[l]).locked(!1);if(e.tables&&0<s)for(c=e.tables.s$(a,-1,s,-1),h=0;h<c.length;h++)c[h].PIb(a,s,!1,!1);Ne(e,a,-1,s)}})}},F.register(B+ne,g,null,!1,!1,!1,!1),m={canUndo:!0,execute:function(e,d,t){return d.considerAllSheets=!0,_e(e,d,t,function(e){var t,r,n,o,i,a,s,l,u,c,h,f=De(d.selections);for(r=0;r<f.length;r++){for(t=f[r],n=e.getRange(0,t.col-1,t.rowCount,1),o=[],i=0;i<n.rowCount;i++)e.getCell(i,n.col).locked()||o.push(i);for(a=t.col,s=t.colCount,e.addColumns(a,s),l=0;l<o.length;l++)for(u=a;u<a+s;u++)e.getCell(o[l],u).locked(!1);if(e.tables&&0<s)for(c=e.tables.s$(-1,a,-1,s),h=0;h<c.length;h++)c[h].QIb(a,s,!1,!1);Ne(e,-1,a,s)}})}},F.register(B+oe,m,null,!1,!1,!1,!1),b={canUndo:!0,execute:function(e,f,t){return f.considerAllSheets=!0,_e(e,f,t,function(e){var t,r,n,o,i,a,s,l,u=Re(f.selections),c=e.filterRowsVisibleInfo&&e.filterRowsVisibleInfo.rowsVisibleInfo,h=c&&0<Object.keys(c).length;for(t=0;t<u.length;t++)if(n=(r=u[t]).row,o=r.rowCount,i=e.getRowCount(),h)for(s=(a=ke(r,c)).length-1;0<=s;s--)n=a[s][0],o=a[s][1],l=e.tables&&e.tables.s$(n,-1,o,-1),e.deleteRows(n,o),0<l.length&&0<i-e.getRowCount()&&(i=e.getRowCount(),Ee(0,l,n,o));else l=e.tables&&e.tables.s$(n,-1,o,-1),e.deleteRows(n,o),0<l.length&&0<i-e.getRowCount()&&Ee(0,l,n,o)})}},F.register(B+ie,b,null,!1,!1,!1,!1),y={canUndo:!0,execute:function(e,l,t){return l.considerAllSheets=!0,_e(e,l,t,function(e){var t,r,n,o,i,a,s=De(l.selections);for(t=0;t<s.length;t++)if(r=e.getColumnCount(),n=s[t].col,o=s[t].colCount,i=void 0,e.tables&&(i=e.tables.s$(-1,n,-1,o)),e.deleteColumns(n,o),e.tables&&0<r-e.getColumnCount())for(a=0;a<i.length;a++)i[a].QIb(n,o,!0)})}},F.register(B+ae,y,null,!1,!1,!1,!1),C={canUndo:!1,execute:function(e){var t,r,n=e.getActiveSheetIndex(),o=[],i=e.getActiveSheet(),a=e.vv(e._getDefaultSheetName(n));e.sheets.forEach(function(e){e.DHb()&&o.push(e)}),o.forEach(function(e){e.DHb(!1,!0)}),t={sheetName:a.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:n},e.Wq(P.Events.SheetChanging,t),t.cancel||(e.ow(n,2,a),r=a.name(),e.hq&&e.hq.BHb(l,a,!1,!0,r,e.getSheetIndex(r)),e.Wq(P.Events.SheetChanged,{sheetName:a.name(),propertyName:"insertSheet",sheetIndex:n}),e.Wq(P.Events.ActiveSheetChanged,{oldSheet:i,newSheet:a}))}},F.register(B+re,C,null,!1,!1,!1,!1),w={canUndo:!1,execute:function(a){var n,s,e,t,r=a.getActiveSheet();1<a.getSheetCount()?(n=[],s=[],a.sheets.forEach(function(e,t){if(e.DHb()){var r=e.name();n.push(r),s.push(t)}}),n.length!==a.sheets.length?1<=n.length&&(n.forEach(function(e,t){var r,n=s[t],o=a.getSheetFromName(e),i={sheetName:e,propertyName:"deleteSheet",cancel:!1,sheetIndex:n};a.Wq(P.Events.SheetChanging,i),i.cancel||(a.removeSheet(a.getSheetIndex(e)),a.Wq(P.Events.SheetChanged,{sheetName:e,propertyName:"deleteSheet",sheetIndex:n}),o===(r=a.getActiveSheet())&&a.Wq(P.Events.ActiveSheetChanged,{oldSheet:o,newSheet:r}))}),t=(e=a.getActiveSheet()).name(),e.isSelected()||a.hq&&a.hq.BHb(l,e,!1,!0,t,a.getSheetIndex(t))):Be(r)):Be(r),a.undoManager().clear()}},F.register(B+te,w,null,!1,!1,!1,!1),v={canUndo:!0,execute:function(e,a,t){return _e(e,a,t,function(e){var t,r=a.selections[0],n=Ie(e,r),o=a.activeRow,i=a.activeCol;n?n.range().contains(o,i,1,1)&&(t=n.name(),F.execute({cmd:"contextmenuFilterForTable",sheetName:e.name(),cmdOption:{tableName:t,activeRow:o,activeCol:i,expectedText:e.getText(o,i)}})):e.rowFilter&&F.execute({cmd:"contextmenuFilterForSheet",sheetName:e.name(),cmdOption:{activeRow:o,activeCol:i,selection:r,expectedText:e.getText(o,i)}})})}},F.register(B+$,v,null,!1,!1,!1,!1),S={canUndo:!0,execute:function(e,s,t){return _e(e,s,t,function(e){var t=s.activeCol,r=s.selections,n=Ie(e,r[0]),o=n?n.dataRange():r[0],i=e.oec(o,!0,null),a={sheet:e,sheetName:e.name(),col:t,ascending:!0,range:o,compareFunction:Se,groupSort:i.groupSort,ignoreHidden:i.ignoreHidden,cancel:!1};e.Wq(P.Events.RangeSorting,a),!1===a.cancel&&(e.sortRange(o.row,o.col,o.rowCount,o.colCount,!0,[{index:t,ascending:!0,compareFunction:a.compareFunction}],{groupSort:a.groupSort,ignoreHidden:a.ignoreHidden},Se,!!n),e.Wq(P.Events.RangeSorted,a))})}},F.register(B+J,S,null,!1,!1,!1,!1),x={canUndo:!0,execute:function(e,s,t){return _e(e,s,t,function(e){var t=s.activeCol,r=s.selections,n=Ie(e,r[0]),o=n?n.dataRange():r[0],i=e.oec(o,!0,null),a={sheet:e,sheetName:e.name(),col:t,ascending:!1,range:o,compareFunction:Se,groupSort:i.groupSort,ignoreHidden:i.ignoreHidden,cancel:!1};e.Wq(P.Events.RangeSorting,a),!1===a.cancel&&(e.sortRange(o.row,o.col,o.rowCount,o.colCount,!0,[{index:t,ascending:!1,compareFunction:a.compareFunction}],{groupSort:a.groupSort,ignoreHidden:a.ignoreHidden},Se,!!n),e.Wq(P.Events.RangeSorted,a))})}},F.register(B+Q,x,null,!1,!1,!1,!1),T={canUndo:!0,execute:function(e,t,r){return Oe(e,t,r,1)}},F.register(B+me,T,null,!1,!1,!1,!1),A={canUndo:!0,execute:function(e,t,r){return Oe(e,t,r,2)}},F.register(B+be,A,null,!1,!1,!1,!1),k={canUndo:!0,execute:function(e,r,t){return _e(e,r,t,function(t){Ae(r.selections,"row",function(e){t.setRowVisible(e,!1)})})}},F.register(B+K,k,null,!1,!1,!1,!1),M={canUndo:!0,execute:function(e,r,t){return _e(e,r,t,function(t){Ae(r.selections,"col",function(e){t.setColumnVisible(e,!1)})})}},F.register(B+X,M,null,!1,!1,!1,!1),I={canUndo:!1,execute:function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p=0;if(e.sheets.forEach(function(e){e.visible()&&(p+=1)}),t=e.getActiveSheet(),p<=1)Be(t);else{if(n=[],e.sheets.forEach(function(e){e.DHb()&&n.push(e)}),p!==n.length){for(o=0;o<n.length;o++)l={sheetName:a=(i=n[o]).name(),propertyName:"isVisible",cancel:!1,sheetIndex:s=e.getSheetIndex(a),oldValue:!0,newValue:!1},e.Wq(P.Events.SheetChanging,l),l.cancel||(i.DHb(!1,!0),xe.push(i),i.visible(!1),u=e.getActiveSheet(),o!==n.length-1||u.isSelected()||(r={oldValue:!1,newValue:!0,sheetName:c=u.name(),propertyName:"isSelected",cancel:!1,sheetIndex:e.getSheetIndex(c)},e.Wq(P.Events.SheetChanging,r)),e.Wq(P.Events.SheetChanged,{sheetName:a,propertyName:"isVisible",sheetIndex:s,oldValue:!0,newValue:!1}));f=(h=e.getActiveSheet()).name(),r&&(r.cancel?h._modelManager.CHb(!1):(h._modelManager.CHb(!0),e&&e.hq&&e.hq.repaint(),d={oldValue:!1,newValue:!0,sheetName:f,propertyName:"isSelected",sheetIndex:e.getSheetIndex(f)},e.Wq(P.Events.SheetChanged,d))),t===h&&e.Wq(P.Events.ActiveSheetChanged,{oldSheet:t,newSheet:h})}else Be(t);e.undoManager().clear()}}},F.register(B+q,I,null,!1,!1,!1,!1),E={canUndo:!0,execute:function(e,n,t){return _e(e,n,t,function(t){var e=n.selections,r=n.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;L(r)&&(r=n.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Me(t,e[0])),1===e.length&&r?(t.setRowVisible(e[0].row-1,!0),t.mq(e[0].row-1)):Ae(e,"row",function(e){t.setRowVisible(e,!0),e===t._t()&&(t.lq=0,t.os())})})}},F.register(B+Z,E,null,!1,!1,!1,!1),R={canUndo:!0,execute:function(e,n,t){return _e(e,n,t,function(t){var e=n.selections,r=n.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;L(r)&&(r=n.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Me(t,e[0])),1===e.length&&r?(t.setColumnVisible(e[0].col-1,!0),t.rq(e[0].col-1)):Ae(e,"col",function(e){t.setColumnVisible(e,!0),e===t.$t()&&(t.qq=0,t.qs())})})}},F.register(B+Y,R,null,!1,!1,!1,!1),D={canUndo:!1,execute:function(e){var t,r,n,o,i,a,s,l;if(0===xe.length)for(t=e.sheets,r=0;r<t.length;r++)t[r].visible()||(xe.push(t[r]),t[r].DHb(!1));if(n=e.getActiveSheet(),0<xe.length){if(e.sheets.forEach(function(e){e.DHb(!1,!0)}),a={sheetName:i=(o=xe.pop()).name(),propertyName:"isVisible",cancel:!1,sheetIndex:e.getSheetIndex(i),oldValue:!1,newValue:!0},e.Wq(P.Events.SheetChanging,a),a.cancel)return;o.visible(!0),s={oldValue:!1,newValue:!0,sheetName:i,propertyName:"isSelected",cancel:!1,sheetIndex:e.getSheetIndex(i)},e.Wq(P.Events.SheetChanging,s),e.setActiveSheet(o.name()),s.cancel?o._modelManager.CHb(!1):(o._modelManager.CHb(!0),e&&e.hq&&e.hq.repaint(),l={oldValue:!1,newValue:!0,sheetName:i,propertyName:"isSelected",sheetIndex:e.getSheetIndex(i)},e.Wq(P.Events.SheetChanged,l)),e.Wq(P.Events.SheetChanged,{sheetName:i,propertyName:"isVisible",sheetIndex:e.getSheetIndex(i),oldValue:!1,newValue:!0})}e.getActiveSheet()&&(e.focus(!0),e.Wq(P.Events.ActiveSheetChanged,{oldSheet:n,newSheet:e.getActiveSheet()}))}},F.register(B+z,D,null,!1,!1,!1,!1),N={canUndo:!1,execute:function(e,t){var r,n,o,i=e.getSheetFromName(t.sheetName);if(i&&(e.suspendPaint(),r=[],(n=i.slicers.all())&&!O(n))){for(o in n)n[o].isSelected()&&r.push(n[o].name());0<r.length&&F.execute({cmd:"deleteFloatingObjects",sheetName:i.name(),floatingObjects:r}),e.resumePaint()}}},F.register(B+G,N,null,!1,!1,!1,!1)},I=je,t.ContextMenu=I,P.Workbook.$n("contextmenu",{setHost:function(){var t=this,e=t._host;t.contextMenu||(t.contextMenu=new I),l(e).bind("contextmenu.gcSheet",function(e){if(t.options.allowContextMenu)return t.contextMenu.ola(e,t)})},dispose:function(){l(this._host).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var t,e=k(),n=this.contextMenu;n&&(t=n.menuData,l.each(e,function(e,r){n.hma(t,c+e,function(e,t){e[t].text=r})}))}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./dist/plugins/contextMenu/context-menu.res.en.js");t.SR={en:n}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copy="Copy",t.cut="Cut",t.pasteOptions="Paste Options:",t.pasteAll="All",t.pasteFormula="Formulas",t.pasteValues="Values",t.pasteFormatting="Formatting",t.pasteValuesFormatting="Values&Formatting",t.pasteFormulaFormatting="Formula&Formatting",t.clearContents="Clear Contents",t.insertRows="Insert",t.insertColumns="Insert",t.deleteRows="Delete",t.deleteColumns="Delete",t.insertSheet="Insert",t.deleteSheet="Delete",t.insertComment="Insert Comment",t.filter="Filter",t.sort="Sort",t.insertCopiedCells="Insert Copied Cells...",t.insertCutCells="Insert Cut Cells...",t.shiftCellsRight="Shift Cells Right",t.shiftCellsDown="Shift Cells Down",t.headerInsertCopiedCells="Insert Copied Cells",t.headerInsertCutCells="Insert Cut Cells",t.slicerSortAscend="Sort A to Z",t.slicerSortDescend="Sort Z to A",t.sortAscend="Sort A to Z",t.sortDescend="Sort Z to A",t.hideRows="Hide",t.hideColumns="Hide",t.hideSheet="Hide",t.unhideSheet="Unhide",t.unhideColumns="Unhide",t.unhideRows="Unhide",t.editComment="Edit Comment",t.deleteComment="Delete Comment",t.toggleComment="Show/Hide Comment",t.removeSlicer="Remove",t.removeFloatingObject="Remove",t.tableInsert="Insert",t.tableInsertRowsAbove="Table Rows Above",t.tableInsertRowsBelow="Table Row Below",t.tableInsertColumnsLeft="Table Columns to the Left",t.tableInsertColumnsRight="Table Columns to the Right",t.tableDelete="Delete",t.tableDeleteRows="Table Rows",t.tableDeleteColumns="Table Columns",t.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden."},"./dist/plugins/contextMenu/menu-view.js":function(e,t,r){"use strict";var n,o,g,c,i,m,u,a,b,y,s,l,h,f,d,p,C,w,v,S,x;function T(){}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),o=r("Core"),g=o.GC$,c=o.Ul.Nl,i=n.Common.j,m=i.Fa,u=i.Aa,a=i.C4,b=document,s=(y={qKb:"mouseenter",rKb:"mouseleave",sKb:"click",tKb:"gc.command.executed",uKb:".",vKb:"gc-ui-contextmenu",wKb:"-",xKb:"container",yKb:"hover",zKb:"disable-hover",AKb:"text",BKb:"icon",CKb:"menuitem",DKb:"nonselective-menuitem",EKb:"menuitem-content",FKb:"sup-container",GKb:"separator",HKb:"sup-indicator",IKb:"subitems-container",JKb:"group-container",KKb:"title",LKb:"group-header",MKb:"groupitems-container",NKb:"groupitem",OKb:"nonexecutable",PKb:"executable",QKb:"disable",RKb:"gc-statusbar-contextmenu",SKb:" ui-widget",TKb:" ui-state-hover",UKb:" ui-icon ui-icon-triangle-1-e",VKb:"DIV",WKb:"SPAN",XKb:"keydown.ctx.gcSheet",YKb:"none",ZKb:"inline-block",$Kb:"visible",_Kb:"hidden"}).vKb+y.wKb+y.yKb,l=y.vKb+y.wKb+y.CKb,h=y.vKb+y.wKb+y.DKb,f=y.vKb+y.wKb+y.EKb,d=y.vKb+y.wKb+y.PKb,p=y.vKb+y.wKb+y.FKb,C=y.vKb+y.wKb+y.IKb,w=y.RKb+y.wKb+"check",v=y.RKb+y.wKb+"check-container",S=y.RKb+y.wKb+"content",x=y.RKb+y.wKb+"status",T.prototype.ai=function(e,t,r,n){var o=this;o._host=g(e),o.lla=a(t),o.wu=r.commandManager(),o.xc=r,o.Eu=n,o.LQ=[],o.YPa={},o.rQa=[],o.ZPa=null,o.lma()},T.prototype.mma=function(){var e,t,r,n,o,i,a,s=this,l=parseInt(s._host.css("left"),10),u=parseInt(s._host.css("top"),10),c=s._host.width(),h=s._host.height(),f=g(s.xc.getHost()),d=f.width(),p=s.hostInfo;m(p)?(n=f.height(),d<l+c&&(l=0<l-c?l-c:l,s._host.css("left",l)),n<u+h&&(h<u?u-=h:h<=n?u=n-h:(o=s._host.css("display"),s._host.css("display",y.YKb),u+h<(i=b.documentElement.scrollHeight)-(a=f.offset().top)||h<i&&(u=n+(i-a-n)-h),s._host.css("display",o)),s._host.css("top",u))):(e=p.top,t=p.width,r=p.height,t<l+c&&(l=0<l-c?l-c:l,s._host.css("left",l)),window.innerHeight-e-r<e&&(u-=h,s._host.css("top",u)))},T.prototype.lma=function(){var e,t,r=this.lla;m(r)||!(r instanceof Object)||r.length<1||(r instanceof Array||(r=[r]),e=this.nma("menuView",r),this.YPa.menuView=e,(t=this.oma(this.lla)).appendTo(this._host),this.mma(),this.QQ(),this.rQa.push({name:"menuView",menuView:t}))},T.prototype.nma=function(e,t){for(var r,n=t.length,o=0,i=[];o<n;o++)r=t[o],m(r)||"separator"===r.type||(r.subMenu?this.YPa[r.name]=this.nma(r.name,r.subMenu):"groupHeader"===r.type&&(this.pma(r,t),this.YPa[r.name]=this.nma(e,r.groups)),i.push(this.qma(e,r)));return i},T.prototype.qma=function(e,t){var r,n,o;if(r="groupHeader"===t.type?this.$Pa():this.rma(),n=this.createMenuItemElement(t),!m(n))return n instanceof HTMLElement&&(n=g(n)),n.appendTo(r),o={name:t.name,host:r,menuItemData:t,menuName:e},this.LQ.push(o),o},T.prototype.rma=function(){var e=g(c(y.VKb));return e.addClass(l),e},T.prototype.$Pa=function(){var e=g(c(y.VKb));return e.addClass(h),e},T.prototype.createMenuItemElement=function(e){var t=e.type;return"groupHeader"===t?this.tma(e):"groupItem"===t?this.uma(e):"statusBar"===t?this.Eyb(e):e.subMenu?this.vma(e):this.wma(e)},T.prototype.wma=function(e){var t,r,n=g(c(y.VKb)).addClass(f);return e.command?e.disable?n.addClass(y.vKb+y.wKb+y.QKb):n.addClass(d):n.addClass(y.vKb+y.wKb+y.OKb),t=g(c(y.WKb)).addClass(y.vKb+y.wKb+y.BKb),e.iconClass&&t.addClass(e.iconClass),t.appendTo(n),e.text&&((r=g(c(y.WKb)).addClass(y.vKb+y.wKb+y.AKb))[0].innerHTML=e.text,r.appendTo(n)),n},T.prototype.sma=function(e){return g(c(y.VKb)).addClass(y.vKb+y.wKb+y.GKb)},T.prototype.tma=function(e){var t,r,n,o,i,a,s=g(c(y.VKb)).addClass(y.vKb+y.wKb+y.JKb);if(e.groups.length<=0)return s;for((t=this.wma(e)).addClass(y.vKb+y.wKb+y.LKb),t.appendTo(s),r=g(c(y.VKb)).addClass(y.vKb+y.wKb+y.MKb),o=(n=e.groups).length,i=0;i<o;i++)(a=this.xma("name",n[i].name).host).addClass(y.vKb+y.wKb+y.NKb),a.appendTo(r);return r.appendTo(s),s},T.prototype.uma=function(e){var t=this.wma(e);return t.find(y.uKb+y.vKb+y.wKb+y.AKb).remove(),t.attr(y.KKb,e.text),t},T.prototype.Eyb=function(e){var t,r,n,o=c("div"),i=g(o).addClass(f),a=e.visible,s=e.menuContent,l=e.status,u=c("div");return g(u).addClass(w),t=c("div"),g(t).addClass(v),t.appendChild(u),t.style.visibility=a?y.$Kb:y._Kb,(r=c("div")).innerText=s,g(r).addClass(S),n=c("div"),g(n).addClass(x),l?(n.innerText=l,n.style.display=y.ZKb):n.style.display=y.YKb,o.appendChild(t),o.appendChild(r),o.appendChild(n),i},T.prototype.vma=function(e){var t,r=g(c(y.VKb)).addClass(p),n=this.wma(e);return 0<e.subMenu.length&&(g(c(y.WKb)).addClass(y.vKb+y.wKb+y.HKb+y.UKb).appendTo(n),(t=this.oma(e.subMenu)).addClass(C),t.appendTo(r)),n.appendTo(r),r},T.prototype.oma=function(e){for(var t,r,n,o=g(c(y.VKb)).addClass(y.vKb+y.wKb+y.xKb+y.SKb),i=e.length,a=0;a<i;a++)m(e[a])||(t=e[a].name,m(t)?"separator"===e[a].type&&(n=this.$Pa(),this.sma(e[a]).appendTo(n),n.appendTo(o)):(r=this.xma("name",t),m(r)||r.host.appendTo(o)));return o},T.prototype.xma=function(e,t){for(var r=this.LQ,n=r.length,o=0;o<n;o++)if(t instanceof g?t[0]===r[o][e][0]:r[o][e]===t)return r[o]},T.prototype.pma=function(e,t){var r,n,o;for(e.groups=[],r=t.length,n=0;n<r;n++)(o=t[n])&&o.group&&o.group===e.name&&(o.type="groupItem",e.groups.push(o),t.splice(n,1),n--)},T.prototype.QQ=function(){var o=this;g(y.uKb+l).bind(y.qKb,function(){var e,t,r=g(this),n=o.xma("host",r);for(o.ZPa=n,e=0,t=o.rQa.length;e<t&&n.menuName!==o.rQa[t-e-1].name;e++)o.Ooa();o._Pa(),o.cQa(!1)}).bind(y.rKb,function(){o.ZPa=null,o._Pa()}).bind(y.sKb,function(e){var t=g(this),r=o.xma("host",t);o.ZPa=r,o.aQa(!1,e)&&o.WT()}),g(b).bind(y.XKb,function(e){var t,r;switch(e.keyCode){case 27:o.Ooa()||o.WT();break;case 32:case 13:o.aQa(!0,e)&&o.WT();break;case 9:e.shiftKey?o.bQa(!1,!0):o.bQa(!0,!0);break;case 37:t=o.Ooa(),(r=o.xma("name",t))&&(o.ZPa=r),o.ZPa&&o.ZPa.menuItemData.group&&o.bQa(!1,!0);break;case 38:o.bQa(!1,!1);break;case 39:o.ZPa&&o.ZPa.menuItemData.group&&o.bQa(!0,!0),o.cQa(!0);break;case 40:o.bQa(!0,!1)}e.preventDefault?e.preventDefault():e.returnValue=!1})},T.prototype.Noa=function(e){var t,r,n,o,i=e.offset().left,a=e.width();i+a>(window.scrollX||window.pageXOffset)+window.innerWidth&&e.css("left",-a),t=e.offset().top,r=e.height(),n=e.position().top,t+r>(o=window.scrollY||window.pageYOffset)+window.innerHeight&&e.css("top",n-(t+r-(o+window.innerHeight)))},T.prototype.zma=function(e){return e.command},T.prototype.getCommandOptions=function(e,t,r){},T.prototype.aQa=function(e,t){var r,n=this.ZPa;if(n&&!n.menuItemData.disable)return(r=n.menuItemData).subMenu?void(0<r.subMenu.length&&this.cQa(e)):(this.h4(t),!0)},T.prototype.h4=function(e){var t,r,n,o,i,a,s=this.ZPa,l=this.zma(s.menuItemData);m(l)||(t=this.getCommandOptions(s.menuItemData,s.host[0],e),r=this.wu,u(l)?l(this.xc,t):(o=(n=this.xc.getActiveSheet()).getActiveColumnIndex(),i=n.getActiveRowIndex(),a=n.tables.find(i,o),r.execute({cmd:l,sheetName:n.name(),selections:n.getSelections(),activeRow:i,activeCol:o,commandOptions:t,tableName:a?a.name():""})))},T.prototype.Tla=function(){g(y.uKb+l).unbind(y.qKb).unbind(y.rKb).unbind(y.sKb),g(b).unbind(y.XKb)},T.prototype.no=function(){this._host=null,this.lla=null,this.wu=null,this.xc=null,this.Eu=null,this.LQ=null,this.YPa=null,this.ZPa=null,this.Tla()},T.prototype.Ooa=function(){var e;if(1<this.rQa.length)return(e=this.rQa.pop()).menuView.find(y.uKb+l).removeClass(s+y.TKb),e.menuView.hide(),e.name},T.prototype._Pa=function(){var e,t,r=this.dQa(!0);if(r){for(e=0,t=r.length;e<t;e++)r[e].host.removeClass(s+y.TKb);this.ZPa&&(this.ZPa.menuItemData.disable?this.ZPa.host.addClass(y.vKb+y.wKb+y.zKb+y.TKb):this.ZPa.host.addClass(s+y.TKb))}},T.prototype.WT=function(){this.Eu.trigger(y.tKb),this.no()},T.prototype.bQa=function(e,t){var r,n,o,i=this.dQa(t);this.ZPa&&((r=this.eQa(this.ZPa,i))||(n=this.YPa[this.ZPa.menuItemData.group])&&(o=n[0],r=this.eQa(o,i))),r=e?(void 0!==r&&r!==i.length-1||(r=-1),"number"==typeof r?r+1:0):(void 0!==r&&0!==r||(r=i.length),"number"==typeof r?r-1:0),this.ZPa=i[r],this._Pa()},T.prototype.dQa=function(e){for(var t,r,n,o=this.rQa[this.rQa.length-1].name,i=this.YPa[o],a=0,s=i.length,l=[];a<s;a++)if("groupHeader"!==i[a].menuItemData.type)l.push(i[a]);else if(t=this.YPa[i[a].menuItemData.name],e)for(r=0,n=t.length;r<n;r++)l.push(t[r]);else l.push(t[0]);return l},T.prototype.eQa=function(e,t){var r,n=t.length;for(r=0;r<n;r++)if(e.name===t[r].name)return r},T.prototype.cQa=function(e){var t,r,n=this.ZPa;!n||(t=n.menuItemData).subMenu&&0<t.subMenu.length&&(t.name!==this.rQa[this.rQa.length-1].name&&((r=g(n.host.find(y.uKb+C)[0])).show(),this.Noa(r),this.rQa.push({name:t.name,menuView:r})),this.ZPa=null,e&&this.bQa(!0,!1))},t.MenuView=T},"./dist/plugins/data/binding.js":function(e,t,r){"use strict";var p,n,g,o,i,l,u,m,c,a,b,y,s,C,h;function f(e){this.ad(e)}function d(e){this._source=e}function w(e,t,r){var n,o,i,a,s,l,u,c,h,f=e,d=f.Ou,p={value:m,hasBinding:!1};if(!d)return p;if(n=f.kj,(o=f.CL)===y){if(s=n?n.getBindingPath(t,r):m)return{value:d.getValue(s),hasBinding:!0}}else{if(t<0||e.getRowCount()<=t)return p;if(l=n?n.getColumnCount():e.getColumnCount(),r<0||l<=r)return p;if(n?(f.qia||(f.qia=n._modelManager.Hp(!1,3)),(i=f.qia[r])&&(a=i.name)):e.HL&&(f.qia?(i=f.qia[r])&&(a=i.dataField):a=e.HL[r]),o)return u=b[o],h=x(c=i&&i.value)?c:m,u.getValue(d,h,a,t,r)}return p}function v(e,t){return e&&t&&t!==y?b[t].getProperties(e):m}function S(e){return h&&e instanceof h}function x(e){return e instanceof Function}function T(e,t,r){var n,o,i,a,s;if(e&&t){if(n=e[t],!u(n))return void(x(n)?e[t](r):e[t]=r);for(i=(o=t.split(".")).length,a=0;a<i&&(s=o[a],e);a++)a===i-1?x(e[s])?e[s](r):e[s]=r:e=x(e[s])?(u(e[s]())&&e[s]({}),e[s]()):(u(e[s])&&(e[s]={}),e[s])}}function A(e,t,r){var n,o,i,a,s;if(!e||!t)return m;if(n=e[t],!u(n))return x(n)?n():n;o=null,r?(o=r[t])||(o=t.split("."),r[t]=o):o=t.split("."),i=o.length,a=0;do{if(e=x(e[s=o[a]])?e[s]():e[s],u(e))return m;++a}while(a<i);return e}function k(){this.pathCache={}}Object.defineProperty(t,"__esModule",{value:!0}),p=r("Core"),n=r("Core"),g=n.GC$,o=r("@grapecity/js-sheets-common"),i=r("./dist/plugins/data/data.ns.js"),l=g.isNumeric,u=o.Common.j.Fa,m=null,c="string",t.yL=a,b=t.yL=a={},y="cellBinding",s=new o.Common.ResourceManager(i.SR),C=s.getResource.bind(s),d.prototype.setValue=function(e,t){T(this._source,e,t)},d.prototype.getValue=function(e){return A(this._source,e)},d.prototype.getSource=function(){return this._source},h=d,t.CellBindingSource=h,f.prototype.bind=function(n,e){var t,r,o,i,a,s,l,u,c,h=this,f=h.kj,d=h.Ou;if(e&&h.tUa(e,{type:"bind",oldDataSource:d}),d&&(d.lka&&(d.subscribe=d.lka,delete d.mka,delete d.lka),x(d.dispose)&&d.dispose()),h.zL(h.AL),h.zL(h.BL),h.ad(f),h.Ou=n){if(!(t=h.CL=(s=m,(a=n)&&(S(a)?s=y:g.each(b,function(e,t){if(t.isDataSource(a))return s=e,!1})),s)))throw Error(C().Exp_NotSupportedDataSource);h.DL=h.EL(),f&&g[g.sd]({tc:f.parent}),f&&(r=h.AL,o=n.currentPosition,n.subscribe&&r.push(n.subscribe(h.FL,h)),o&&o.subscribe&&r.push(o.subscribe(h.GL,h)),x(n.subscribe)&&!n.lka&&(i=n.lka=n.subscribe,n.mka=!1,n.subscribe=function(e,t){var r=[].concat.apply([],arguments);return r[0]=function(){if(!n.mka&&x(e))return e.apply(t,arguments)},i.apply(n,r)}),h.Lx()),h.HL=v(n,t)}return u=n,!(!(c=(l=f)&&l.wq)||!c.xL(u)||(l.clearPendingChanges(),p.Worksheet.ao(l,"initBinding",{sheet:l,data:u}),0))},f.prototype.Lx=function(){var e,t,r,n,o,i=this.kj,a=this.Ou;if(i&&a&&(e=this.CL,this.zL(this.BL),t=m,e!==y&&(r=i.getActiveRowIndex(),t=a.currentPosition?(-1<=r&&r<a.count()&&a.currentPosition(r),a.currentItem()):this.ru(r)),t))for(o in n=function(){i&&i.repaint()},t)t[o]&&x(t[o].subscribe)&&this.BL.push(t[o].subscribe(n,m,m))},f.prototype.zL=function(e){var t,r;if(e)for(t=0;t<e.length;t++)(r=e[t])&&x(r.dispose)&&r.dispose()},f.prototype.getRowCount=function(){var e=this.Ou,t=this.CL,r=0;return e&&t&&t!==y&&(r=b[t].getDataLength(e)),r},f.prototype.getColumnCount=function(){var e,t,r,n=this.HL;return n?n.length:(e=this.Ou)&&(t=e[0],"null"===(r=g.getType(t))||r===c||"number"===r)?1:0},f.prototype.getSource=function(){return this.Ou},f.prototype.rL=function(){return this.HL},f.prototype.Nka=function(e){this.HL=e},f.prototype.ru=function(e){var t=this.Ou,r=this.CL,n=m;return t&&r&&r!==y&&(n=b[r].getDataItem(t,e)),n},f.prototype.EL=function(){var e,t,r;if(!this.DL)for(e=this.getRowCount(),t=0;t<e;t++)if(r=this.ru(t)){this.DL=r.entityAspect&&r.entityType||r.constructor;break}return this.DL},f.prototype.getValue=function(e,t){return w(this,e,t)},f.prototype.setValue=function(e,t,r,n){var o;return n&&(o=w(this,e,t).value,this.tUa(n,{type:"setValue",row:e,col:t,oldValue:o})),function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d=e,p=d.Ou,g=!1;if(!p)return g;if(o=d.kj,(i=d.CL)===y)(l=o?o.getBindingPath(t,r):m)&&(p.setValue(l,n),g=!0);else{if(t<0||e.getRowCount()<=t)return g;if(u=o?o.getColumnCount():e.getColumnCount(),r<0||u<=r)return g;o?(d.qia||(d.qia=o._modelManager.Hp(!1,3)),(a=d.qia[r])&&(s=a.name)):e.HL&&(d.qia?(a=d.qia[r])&&(s=a.dataField):s=e.HL[r]),i&&(c=b[i],h=a&&a.value,f=x(h)?h:m,g=c.setValue(p,f,s,t,r,n))}return g}(this,e,t,r)},f.prototype.sL=function(){var e=b[this.CL];return e&&e.canAdd&&e.canAdd()},f.prototype.tL=function(){var e=b[this.CL];return e&&e.canInsert&&e.canInsert()},f.prototype.vL=function(){var e=b[this.CL];return e&&e.canRemove&&e.canRemove()},f.prototype.uL=function(e,t,r){var n,o,i=this.Ou;!i||e>this.getRowCount()||(n=this.CL,o=this.EL(),n&&n!==y&&!this.IL&&(this.JL=!0,r&&this.tUa(r,{type:"addItems",row:e,rowCount:t}),b[n].addItems(i,e,t,o),this.JL=!1))},f.prototype.wL=function(e,t,r){var n,o=this.CL,i=this.getRowCount(),a=this.Ou;!a||i<=e||o&&o!==y&&!this.IL&&(this.JL=!0,n=b[o].removeItems(a,e,t),r&&n&&0<n.length&&this.tUa(r,{type:"removeItems",row:e,removedItems:n}),this.JL=!1)},f.prototype.uUa=function(e,t){var r=this.Ou,n=this.CL;b[n].undoRemoveItems(r,e,t)},f.prototype.xL=function(e){return S(e||this.Ou)},f.prototype.ad=function(e){var t,r;this.Ou=m,this.CL="",this.DL=m,this.HL=m,this.AL=[],this.BL=[],this.qia=m,this.kj=e,(r=(t=e)&&t.wq)&&r.xL()&&p.Worksheet.ao(t,"resetBinding",{sheet:t})},f.prototype.FL=function(e){var t,r,n,o,i=this.kj;if(i&&!this.JL){if(e){if(this.IL=!0,!isNaN(e.length)&&(i.setRowCountCore(e.length),t=i._modelManager,u(this.HL)&&0===t.VTa(!1,3)&&(this.HL=v(this.Ou),i.setColumnCount(this.getColumnCount()),r=this.rL())))for(n=0,o=r.length;n<o;n++)t.do("setItem",!1,3,n,{name:r[n]});this.IL=!1}i.$p()}},f.prototype.GL=function(){var e,t=this.kj,r=this.Ou;t&&r&&r.currentPosition&&(e=r.currentPosition(),t.Jl!==e&&(t.Sr(e,t.Kl,void 0,void 0,2),t.$p()))},f.prototype.tUa=function(e,t){if(!(this.kj&&this.kj._modelManager&&!u(this.kj._modelManager.WTa)&&this.kj._modelManager.WTa<=0)){var r=e.rUa;r=r||(e.rUa=[]),t.bindingManager=this,r.push(t)}},f.prototype.sUa=function(e){var t=e.type,r=e.row;"bind"===t?this.bind(e.oldDataSource):"setValue"===t?this.setValue(r,e.col,e.oldValue):"addItems"===t?this.wL(r,e.rowCount):"removeItems"===t&&this.uUa(r,e.removedItems)},f.prototype.toJSON=function(){var e,t=this.Ou;return t?{type:e=this.CL,source:t=e===y?t.getSource():b[e].toJSON(t)}:m},f.prototype.fromJSON=function(e){var t,r,n=e&&e.source;!n||(r=(t=e.type)===y?new h(n):b[t].fromJSON(n))&&this.bind(r)},t.qL=f,t.setValueByPath=T,t.LL=A,k.prototype.isDataSource=function(e){return g.isArray(e)},k.prototype.getDataLength=function(e){return e.length},k.prototype.getDataItem=function(e,t){return e[t]},k.prototype.addItems=function(e,t,r,n){var o,i;for(o=0;o<r;o++)i={},n&&(i=n.createEntity?n.createEntity():new n),e.splice(t,0,i)},k.prototype.removeItems=function(e,t,r){var n=this.getDataLength(e);if(t<n)return e.splice(t,Math.min(r,n-t))},k.prototype.undoRemoveItems=function(e,t,r){for(var n=0,o=r.length;n<o;n++)e.splice(t+n,0,r[n])},k.prototype.getProperties=function(e){var t,r,n=e.length,o=m;if(0<n)for(r in o=[],t=e[0])x(t[r])||o.push(r);return o},k.prototype.getValue=function(e,t,r,n,o){var i=m,a=!1,s=this.getDataItem(e,n);return u(s)||(t?(i=t(s),a=!0):r?(i=A(s,r,this.pathCache),a=!0):typeof s!=c&&!l(s)||0!==o||(i=s,a=!0)),{value:i,hasBinding:a}},k.prototype.setValue=function(e,t,r,n,o,i){var a=!1,s=this.getDataItem(e,n);return u(s)||(t?(t(s,i),a=!0):r?(T(s,r,i),a=!0):typeof s!=c&&!l(s)||0!==o||(e[n]=i,a=!0)),a},k.prototype.fromJSON=function(e){return e},k.prototype.toJSON=function(e){return e},b.defaultBindingSource=new k},"./dist/plugins/data/data.dataview.js":function(e,t,r){"use strict";var n,o,l;function i(){}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),o=r("./dist/plugins/data/binding.js"),t.yL=o.yL,l=n.Common.j.Fa,i.prototype.isDataSource=function(e){var t=window.wijmo;return t&&t.data&&t.data.isDataView&&t.data.isDataView(e)},i.prototype.getDataLength=function(e){return e.count()},i.prototype.getDataItem=function(e,t){return e.item(t)},i.prototype.addItems=function(e,t,r,n){if(n)for(var o=0;o<r;o++)e.mka=!0,e.add(n.createEntity?n.createEntity():new n),e.mka=!1,e.commitEdit()},i.prototype.removeItems=function(e,t,r){var n,o,i,a,s=this.getDataLength(e);if(t<s){for(n=[],o=Math.min(r,s-t),i=0;i<o;i++)a=e.item(t),e.remove(a),n.push(a);return n}},i.prototype.undoRemoveItems=function(e,t,r){var n,o,i=e.getSource();for(n=0,o=r.length;n<o;n++)i.splice(t+n,0,r[n]);e.refresh()},i.prototype.getProperties=function(e){var t,r=0,n=null,o=e.getProperties();if(o&&0<o.length)for(r=o.length,n=[],t=0;t<r;t++)n.push(o[t].name);return n},i.prototype.canInsert=function(){return!1},i.prototype.getValue=function(e,t,r,n,o){var i=null,a=!1,s=this.getDataItem(e,n);return l(s)||(t?(i=t(s),a=!0):r&&(i=e.getProperty(s,r),a=!0)),{value:i,hasBinding:a}},i.prototype.setValue=function(e,t,r,n,o,i){var a=!1,s=this.getDataItem(e,n);return l(s)||(t?(t(s,i),a=!0):r&&(e.setProperty(s,r,i),a=!0)),a},i.prototype.fromJSON=function(e){return e},i.prototype.toJSON=function(e){return e.local},o.yL.dataViewBinding=new i},"./dist/plugins/data/data.entry.js":function(e,r,t){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),t("./dist/plugins/data/worksheet-databind.js");var o=t("./dist/plugins/data/binding.js");r.CellBindingSource=o.CellBindingSource,r.qL=o.qL,r.setValueByPath=o.setValueByPath,r.LL=o.LL,n(t("./dist/plugins/data/data.ko.js")),n(t("./dist/plugins/data/data.dataview.js")),n(t("./dist/plugins/data/data.ns.js"))},"./dist/plugins/data/data.ko.js":function(e,t,r){"use strict";var m,n,l,u,b,i,c,h,y,a,o;function s(){}Object.defineProperty(t,"__esModule",{value:!0}),m=r("Core"),n=r("@grapecity/js-sheets-common"),l=r("./dist/plugins/data/binding.js"),t.yL=l.yL,u=n.Common.j.Fa,b=m.GC$,i=b.isFunction,c=b.getType,h=b.isNumeric,y="string",a=window.ko,s.prototype.isDataSource=function(e){return a&&a.isObservable(e)},s.prototype.getDataLength=function(e){return e().length},s.prototype.getDataItem=function(e,t){return e()[t]},s.prototype.addItems=function(e,t,r,n){var o,i;for(o=0;o<r;o++)i={},n&&(i=n.createEntity?n.createEntity():new n),e.splice(t,0,i)},s.prototype.removeItems=function(e,t,r){var n=this.getDataLength(e);if(t<n)return e.splice(t,Math.min(r,n-t))},s.prototype.undoRemoveItems=function(e,t,r){for(var n=0,o=r.length;n<o;n++)e.splice(t+n,0,r[n])},s.prototype.getProperties=function(e){var t,r,n=e(),o=[];if(0<n.length)for(r in t=n[0])(!i(t[r])||a&&a.isObservable(t[r]))&&o.push(r);return o},s.prototype.getValue=function(e,t,r,n,o){var i=null,a=!1,s=this.getDataItem(e,n);return u(s)||(t?(i=t(s),a=!0):r?(i=l.LL(s,r),a=!0):c(s)!==y&&!h(s)||0!==o||(i=s,a=!0)),{value:i,hasBinding:a}},s.prototype.setValue=function(e,t,r,n,o,i){var a=!1,s=this.getDataItem(e,n);return u(s)||(t?(t(s,i),a=!0):r?(l.setValueByPath(s,r,i),a=!0):c(s)!==y&&!h(s)||0!==o||(e()[n]=i,a=!0)),a},s.prototype.fromJSON=function(e){return a?a.observableArray(e):null},s.prototype.toJSON=function(e){return e()},l.yL.koBinding=new s,a&&((o=a.bindingHandlers)["gc-spread-sheets"]=o["gcspread-sheets"]=o.wijspread={init:function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g;if(!b(e).data("workbook")&&(i=(o=t())&&o.sheets,a=new m.Workbook(b("#"+e.id)[0],o),i)){for(l=s=void 0,u=i.length,c=a.getSheetCount();c<u;)s=a.vv(a._getDefaultSheetName(c)),a.ow(c,0,s),c=a.getSheetCount();for(h=0;h<u;h++)s=a.getSheet(h),f=(l=i[h]).name,d=l.autoGenerateColumns,p=l.data,g=l.columns,typeof f==y&&0<f.length&&s.cq(f),"boolean"==typeof d&&(s.autoGenerateColumns=d),p&&s.setDataSource(p),g&&0<g.length&&(s.autoGenerateColumns=!1,s.bindColumns(g))}},update:function(e,t,r,n){}})},"./dist/plugins/data/data.ns.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./dist/plugins/data/data.res.en.js");t.SR={en:n}},"./dist/plugins/data/data.res.en.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(e,t,r){"use strict";var n,o,u,c,a,i,s,l,h,f;function d(e,t,r){"string"==typeof r&&(r={name:r}),e._modelManager.do("setItem",!1,3,t,r);var n=r&&r.formatter,o=r&&r.cellType;n&&e.setFormatter&&e.setFormatter(-1,t,n),o&&e.setCellType(-1,t,o),r&&r.width&&e.setColumnWidth(t,r.width)}Object.defineProperty(t,"__esModule",{value:!0}),n=r("Core"),o=r("@grapecity/js-sheets-common"),u=r("./dist/plugins/data/binding.js"),c=o.Common.j.Fa,a=n.GC$.isEmptyObject,i=n.GC$.extend,s=n.Worksheet.prototype,l="bindingPath",h=RegExp("^\\d*(\\.\\d+)?\\*$"),f=o.Common.l,i(s,{getDataSource:function(){var e=this.wq;return e?e.getSource():null},setDataSource:function(e,t){var r,n,o,i,a,s=this,l=s.wq;if(l&&l.getSource()!==e){if(t&&s.vs(),e){if((l=s.wq).aLb=!0,!l.bind(e,s._modelManager.zTa)&&(s.setRowCountCore(l.getRowCount()),s.autoGenerateColumns&&(s.setColumnCount(l.getColumnCount()),r=l.rL())))for(n=0,o=r.length;n<o;n++)s._modelManager.do("setItem",!1,3,n,{name:r[n]})}else s.wq=new u.qL(s);s.clearPendingChanges(),i=!1,l&&l.aLb&&(i=l.bLb,delete l.bLb,delete l.aLb),s.recalcAll&&s.recalcAll(i),(a=s.tu())&&a.PA===s&&a.hZ(),s.$p()}},bindColumn:function(e,t){this.suspendPaint();try{d(this,e,t)}finally{this.resumePaint()}},bindColumns:function(e){var t,r,n,o;this.suspendPaint();try{if(e)for(t=e.length,isNaN(t)||this.setColumnCount(t),r=0;r<t;r++)o=(n=e[r]).size,h.test(o)&&(n.starSize=o),d(this,r,n)}finally{this.resumePaint()}},getDataItem:function(e){var t,r,n,o,i,a,s=this.wq;if(!s||0===s.getRowCount())return null;if(t=this.getColumnCount(),r={},n=s.ru(e))for(o in n)n.hasOwnProperty(o)&&"function"!=typeof o&&(r[o]=n[o]);for(i=0;i<t;i++)(a=this._modelManager.Jp(!1,3,i))&&a.name&&0<a.name.length&&c(r[a.name])&&(r[a.name]=this.getValue(e,i));return r},getDataColumnName:function(e){var t;return 0<=e&&e<this.getColumnCount()&&this.getDataSource()?(t=this._modelManager.Jp(!1,3,e))&&(t.displayName||t.name):null},getBindingPath:function(e,t){return this._modelManager.getValueForKey(e,t,l)},setBindingPath:function(e,t,r){return this._modelManager.do("setValueForKey",e,t,l,r),this.$p(),this}}),n.CellRange.prototype.bindingPath=n.CellRange.Pl(s.getBindingPath,s.setBindingPath),n.Worksheet.$n("binding",{init:function(){this.autoGenerateColumns=!0,this.wq=new u.qL(this)},dispose:function(e){!1!==e.clearCache&&(this.wq=null)},onLayoutChanged:function(e){var t,r,n,o,i,a=e.changeType,s=e.row,l=e.rowCount,u=e.sheetArea,c=this.wq;if("addingRows"===a)c&&!1===c.sL()?e.canAdd=!1:c&&!1===c.tL()&&(e.newRow=this.getRowCount());else if("addRows"===a)c&&c.uL(s,l,this._modelManager.zTa);else if("deletingRows"===a){if(c)if(!1===c.vL())e.canDelete=!1;else for(this.Ts||(this.Ts=[]),t=this.Ts,r=this._modelManager,n=c.getRowCount(),o=0;o<l&&s+o<r.getRowCount();o++)i=null,s+o<n&&(i=c.ru(s+o)),t.push({row:s+o,data:i})}else"deleteRows"===a?c&&c.wL(s,l,this._modelManager.zTa):"settingRowCount"===a&&(!c.getSource()||c.xL()||3!==u&&2!==u||(e.canSet=!1))},toJson:function(e,t){var r,n,o=this.getColumnCount(),i=this.getDataSource();t&&t.includeBindingSource&&i&&(function(e,t,r,n){var o,i,a,s,l=e.wq;for(o=0;o<r;o++)for(i=0;i<n;i++)a=l.getValue(o,i).value,c(a)||(s=a,f.Ska(a)&&(s=f.Daa(a)),e.qI(t,o,i,s))}(this,r=e.data.dataTable||{},this.getRowCount(),o),a(r)||(e.data.dataTable=r),function(e,t,r,n){var o,i,a,s,l,u=e.options.colHeaderAutoTextIndex;for(o=0;o<r;o++)if(0<=u&&o===u||-1===u&&o===r-1)for(i=0;i<n;i++)a=t[o]&&t[o][i]&&t[o][i].value,s=e._modelManager.Jp(!1,3,i),c(a)&&s&&((l=s.displayName||s.name)&&e.qI(t,o,i,l))}(this,n=e.colHeaderData.dataTable||{},this.getRowCount(1),o),a(n)||(e.colHeaderData.dataTable=n)),!0!==this.autoGenerateColumns&&(e.autoGenerateColumns=this.autoGenerateColumns)},fromJson:function(e,t){var r,n,o,i;this.wq=new u.qL(this),t&&(r=this.wq,n=e.dataSource,o=e.dataBinding,n&&r.bind(n),o&&r.fromJSON(o,t)),i=e.autoGenerateColumns,c(i)||(this.autoGenerateColumns=i)},preFromJson:function(){this.wq=new u.qL(this)}}),n.lUa.$n("binding",{priority:6e3,getValue:function(e){var t,r=e.row,n=e.col,o=e.sheetArea,i=this.kj.wq;3===o&&i&&i.Ou&&(t=i.getValue(r,n),e.isValueGet=t.hasBinding,e.value=t.value)},setValue:function(e){var t,r,n,o=e.row,i=e.col,a=e.value,s=e.sheetArea,l=this.kj,u=l.wq;3===s&&u&&u.Ou&&((t=u.getValue(o,i)).hasBinding&&(a!==(r=t.value)&&(l.isDirtySuspended()||(n=l.getDataItem(o),this.Cp(o,i,{Dp:n,Ep:r},s)),u.setValue(o,i,a,l._modelManager.zTa)),e.isValueSet=!0))},undo:function(e){var t,r,n=e.rUa;if(n)for(t=n.length-1;0<=t;t--)(r=n[t]).bindingManager.sUa(r)}})},"./dist/plugins/fill/drag-fill.js":function(e,t,r){"use strict";var d,v,p,n,o,a,g,m,i,c,k,s,b,S,y,C,w,M,l,u,h,f,x,T,A,I,E,R,D,N,F,_,P=this&&this.__extends||(D=function(e,t){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}D(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function L(e){return e.rowCount}function O(e){return e.colCount}function B(e,t){return e.getRowCount(t)}function j(e,t){return e.getColumnCount(t)}function H(e,t){var r=N.call(this)||this,n=r;return n.kj=e,n.i4=t,n.W$=t[y],n.X$=t[C],n.Y$=t[w],n.Z$=t[M],r}function G(e,t){var r=F.call(this)||this,n=r,o=t[M],i=0===o,a=i||1===o,s=t[C],l=t[y],u=l.row,c=l.col,h=L(l),f=O(l);return n.kj=e,4===(n.G$=t)[w]?n.H$=new v.Commands.OA(e,{ranges:[t[C]]}):n.I$=a?m(u,i?s.col:c,h,f+O(s)):m(2===o?s.row:u,c,h+L(s),f),n.J$=a?1:0,r}function U(e,t,r,n,o){var i,a,s=e.getSelections();e.Tr(),e.addSelection(t,r,n,o),e.Au(s),i=0<t?t:e.ar(),a=0<r?r:e.$q(),e.Kr(i,a,e.Nr,e.Pr)}function W(e){var t=e.parent.getActiveSheet();t&&e!==t&&t.repaint()}function V(e,t){return _.call(this,e,t)||this}Object.defineProperty(t,"__esModule",{value:!0}),d=r("@grapecity/js-sheets-common"),v=r("Core"),p=r("./dist/plugins/fill/fill.js"),n=r("./dist/plugins/fill/fill.ns.js"),o=r("@grapecity/js-calc"),a=!!o,g=d.Common.j.Fa,m=v.kf,i=v.GC$,c=Math.max,k=Math.floor,s=v.Commands.ActionBase,b=v.Commands.xy,S=v.Commands.Bu,y="startRange",C="fillRange",w="autoFillType",M="fillDirection",l="cancel",u="fill",h="dragDrop",f=i.isEmptyObject,x=new d.Common.ResourceManager(n.SR),T=x.getResource.bind(x),A={fillAuto:function(e,t,r){if(!t)throw Error(T().Exp_RangeIsNull);var n,o,i,a,s=r.fillType,l=r.series,u=r.direction,c=r.step,h=r.stop,f=new p.z$(this);if(o=t,i=u?null:l,a=u,(n=e)&&o&&o.containsRange(n)&&(!g(i)&&(1===i&&n.row===o.row&&L(n)===L(o)||0===i&&n.col===o.col&&O(n)===O(o))||!(g(a)||(2!==a&&3!==a||n.col!==o.col||O(n)!==O(o))&&(0!==a&&1!==a||n.row!==o.row||L(n)!==L(o))))){this.suspendPaint(),e&&(this._eventHandler.A$=e);try{4===s?f.B$(t,l,!1,r.withTag,r.withoutStyle):0===s?f.C$(t,u):1===s||2===s?f.D$(1===s,t,l,c,h):3===s&&f.E$(t,l,3,c,g(h)?null:d.Common.l.Ra(h),r.unit)}finally{this.resumePaint()}}}},i.extend(v.Worksheet.prototype,A),v.Worksheet.$n(u,{init:function(){this.Fyb=new p.Gyb(this)},setHost:function(e){if(e){var t=this.wu();t.fill||t.register(u,v.Commands.fill),t[h]||t.register(h,v.Commands[h])}},dispose:function(e){if(!1!==e.clearCache){this.Fyb&&(this.Fyb.no(),this.Fyb=null)}}}),P(G,F=s),G.prototype.canExecute=function(){var e=this.kj,t=this.G$,r=t[y],n=t[C];return!(!e.Y3(n.row,n.col,L(n),O(n))||4!==t[w]&&n.intersect(r.row,r.col,L(r),O(r)))},G.prototype.execute=function(){var e,t,r,n,o,i=this;if(i.canExecute()){t=(e=i.G$)[C],(r=i.kj)._modelManager.startTransaction(),i.Lz(r,!0);try{a&&r.suspendCalcService(),n=r.getSelections(),r.isDirtySuspended()||(i.N$=new b(r,e[C],2047)),4===e[w]?i.K$(r):i.L$(r),r.yu(n,r.getSelections())&&r.Au(n)}finally{i.Mz(r,!0),e[v.Commands.bWa(r.name())]=r._modelManager.endTransaction(),a&&r.resumeCalcService(!1),r.t4&&r.t4(t.row,t.col,L(t),O(t)),o=[],r.isDirtySuspended()||(i.M$=new b(r,t,2047),i.M$.uy(i.N$.sy()),o=i.M$.wy()),S(r,t.row,t.col,L(t),O(t),o,1)}}},G.prototype.K$=function(e){var t,r,n,o,i,a,s,l,u;this.H$.execute(e),r=(t=this.G$)[y],n=t[C],o=0===this.J$,a=L(r),s=O(r),l=o?c(1,a-L(n)):a,u=o?s:c(1,s-O(n)),r.equals(n)||(i=m(r.row,r.col,l,u),e.Kr(c(e.ar(),i.row),c(e.$q(),i.col),e.Nr,e.Pr),e.Tr(),e.addSelection(i.row,i.col,L(i),O(i)))},G.prototype.L$=function(e){var t,r,n,o=this.kj,i=this.G$[y],a=this.G$[C],s=this.G$[w],l=this.I$,u={fillType:4,series:this.J$,withTag:!0};try{o.tables&&o.tables.fIb(l)}catch(e){return o.Os(6,e.message),void o.resumePaint()}if(1===s){if(o.fillAuto(i,l,u),o._modelManager.MTa(i.row,i.col,i.rowCount,i.colCount))for(t=0;t<a.rowCount;t++)for(r=0;r<a.colCount;r++)(n=o.Aj(i.row+k(t%i.rowCount),i.col+k(r%i.colCount)))&&n.clone&&(n=n.clone()),o.Nq(a.row+t,a.col+r,n)}else 0===s?this.O$(i,a,2043):2===s?this.O$(i,a,192):3===s&&(1!==L(i)||1!==O(i)||-1===i.row&&-1!==i.col||-1===i.col&&-1!==i.row?(u.withoutStyle=!0,o.fillAuto(i,l,u)):this.O$(i,a,187));o.Kr(c(e.ar(),l.row),c(e.$q(),l.col),e.Nr,e.Pr),e.Tr&&e.Tr(),o.addSelection(l.row,l.col,L(l),O(l))},G.prototype.O$=function(e,t,r){var n,o,i,a,s,l=this.kj,u=l.Tq(e),c=l.Tq(t),h=u.row,f=u.col,d=L(u),p=O(u),g=c.row,m=c.col,b=L(c),y=O(c),C=this.G$[M],w=3===C,v=1===C,S=k(b/d),x=b%d,T=k(y/p),A=y%p;if(0===this.J$){for(n=0;n<S;n++)a=w?g+n*d:g+b-(n+1)*d,l.ax(h,f,a,m,d,p,r,!0);0!=x&&(o=w?h:h+(S+1)*d-b,a=w?g+d*S:g+b-S*d-x,l.ax(o,f,a,m,x,p,r,!0))}else{for(n=0;n<T;n++)s=v?m+n*p:m+y-(n+1)*p,l.ax(h,f,g,s,d,p,r,!0);0!=A&&(i=v?f:f+(T+1)*p-y,s=v?m+p*T:m+y-T*p-A,l.ax(h,i,g,s,d,A,r,!0))}},G.prototype.undo=function(){var e,t,r,n,o=this.kj,i=!1;if(this.canUndo()){this.Lz(o,!0);try{a&&o.suspendCalcService(),e=o.getSelections(),t=this.G$,r=o.NF,n=t[C],i=4===t[w]?this.S$(o):this.T$(o),!o.U$&&r&&r.close(),S(o,n.row,n.col,L(n),O(n),this.M$?this.M$.wy():[],1,void 0,!0),o.yu(e,o.getSelections())&&o.Au(e)}finally{this.Mz(o,!0),a&&o.resumeCalcService(!1)}}return i},G.prototype.S$=function(e){var t=this.G$[y],r=t.row,n=t.col,o=v.Commands.bWa(e.name());return e._modelManager.undo(this.G$[o]),e.Kr(c(e.ar(),r),c(e.$q(),n),e.Nr,e.Pr),!0},G.prototype.T$=function(e){var t,r=this.G$,n=r[y],o=n.row,i=n.col;a&&e.suspendCalcService();try{t=v.Commands.bWa(e.name()),e._modelManager.undo(r[t]),e.Kr(c(e.ar(),o),c(e.$q(),i),e.Nr,e.Pr)}finally{a&&e.resumeCalcService(!1)}return e.invalidateLayout(),!0},I=G,P(H,N=s),H.prototype.execute=function(){var e,t,r,n,o,i,a=this,s=!1;if(a.canExecute()){e=a.kj,t=a.X$,e._modelManager.startTransaction(),a.oUa(),a.Lz(e,!0),e.vxb=!0;try{r=e.getSelections(),n=e._eventHandler,(o={sheet:e,sheetName:e.name(),cancel:!1})[C]=t,o[w]=a.Y$,o[M]=a.Z$,e.Wq(v.Events.DragFillBlock,o),n.$$=o[w],n._$=o[l],a.a_(o),delete o[l],e.Wq(v.Events.DragFillBlockCompleted,o),s=!0,e.yu(r,e.getSelections())&&e.Au(r)}finally{a.Mz(e,!0),e.vxb=!1,a.IVa(e,t),i=v.Commands.bWa(e.name()),a.i4[i]=e._modelManager.endTransaction()}}return s},H.prototype.a_=function(e){var t,r,n=this.kj,o=n._eventHandler,i=this.X$,a=this.Y$;o.$$=a,o._$||((t={})[y]=this.W$,t[C]=i,t[w]=5===e[w]?a:e[w],t[M]=this.Z$,r=new I(n,t),n.suspendEvent(),r.execute(),n.resumeEvent(),this.i4.d_=r)},H.prototype.oUa=function(){this.kj.isDirtySuspended()||(this.N$=new b(this.kj,this.X$,2047))},H.prototype.undo=function(){var e,t,r,n;if(this.canUndo()){e=this.kj,t=this.X$,this.oUa(),this.Lz(e,!0);try{r=e.getSelections(),e.suspendEvent(),n=v.Commands.bWa(e.name()),e._modelManager.undo(this.i4[n]),e.resumeEvent(),e.yu(r,e.getSelections())&&e.Au(r)}finally{this.Mz(e,!0),this.IVa(e,t,!0)}}return!0},H.prototype.IVa=function(e,t,r){var n,o=[];e.isDirtySuspended()||((n=new b(e,t,2047)).uy(this.N$.sy()),o=n.wy()),S(e,t.row,t.col,L(t),O(t),o,1,void 0,r)},E=H,P(V,_=s),V.prototype.canExecute=function(){var e,t,r,n=this.kj,o=this.VQ,i=o.fromRow,a=o.fromColumn,s=L(o),l=o.columnCount,u=o.toRow,c=o.toColumn,h=!o.copy,f={row:i,col:a,rowCount:s,colCount:l},d={row:u,col:c,rowCount:s,colCount:l};return(!n.tables||!n.tables.zxb(n,f,n,d,h))&&!!n.pu(i,a,s,l,B(n),j(n))&&!(!o.insert&&!n.pu(u,c,s,l,B(n),j(n)))&&(e=0<=u&&c<0&&0<=i&&a<0&&0<s&&l<0,t=u<0&&0<=c&&i<0&&0<=a&&s<0&&0<l,r=this.KZa(e,t),n.Y3(u,c,s,l,null,null,r)&&n.Y3(i,a,s,l,null,null,r))},V.prototype.KZa=function(e,t){var r,n,o=this.VQ,i=this.kj,a=o.insert,s=i.options.isProtected,l=i.options.protectionOptions;return!(!s||f(l)||(r=l.allowDragInsertRows,n=l.allowDragInsertColumns,!a||!(r&&e||n&&t)))},V.prototype.execute=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m=!1;if(this.canExecute()){e=this.kj,t=this.VQ,this.oUa(),o=n=r=void 0,i=t.fromRow,a=t.fromColumn,s=t.toRow,l=t.toColumn,u=L(t),c=t.columnCount,h=t.option,f=e.parent.sheets,v.Commands.Zxb(f),this.Lz(e,!0),e.vxb=!0;try{try{e.tables&&e.tables.fIb(new v.Range(s,l,u,c),new v.Range(i,a,u,c))}catch(t){return e.Os(6,t.message),void e.resumePaint()}t.insert?0<=a&&i<0?(r=a,o=c,d=n=l,e.addColumns(n,o),t.copy?e.copyTo(-1,n<=r?r+o:r,-1,n,-1,o,h):(e.moveTo(-1,n<=r?r+o:r,-1,n,-1,o,h),e.deleteColumns(n<=r?r+o:r,o),r<n&&(d=n-o)),U(e,-1,d,B(e),o)):0<=i&&a<0&&(r=i,o=u,p=n=s,e.addRows(n,o),t.copy?e.copyTo(n<=r?r+o:r,-1,n,-1,o,-1,h):(e.moveTo(n<=r?r+o:r,-1,n,-1,o,-1,h),e.deleteRows(n<=r?r+o:r,o),r<n&&(p=n-o)),U(e,p,-1,o,j(e))):(t.copy?e.copyTo(i,a,s,l,u,c,h):e.moveTo(i,a,s,l,u,c,h),e&&(U(e,s,l,u,c),g=t.io,t.copy||e.isDirtySuspended()||(g._z=this.aA(e,g.cA,i,a,u,c)),e.isDirtySuspended()||(g.dA=this.aA(e,g.fA,s,l,u,c)))),m=!0}finally{e._eventHandler.gA={},this.Mz(e,!0),e.vxb=!1,v.Commands.$xb(f,t)}W(e)}return m},V.prototype.aA=function(e,t,r,n,o,i){var a=new b(e,m(r,n,o,i),this.VQ.option),s=e.tables&&e.tables.$Hb&&e.tables.$Hb(r,n,o,i);return s&&0<s.length&&(this.VQ.tableNamesObj={r:r,c:n,rc:o,cc:i,tableNames:s}),a.uy(t.sy()),S(e,r,n,o,i,a.wy(),0,s),a},V.prototype.oUa=function(){var e=this.kj,t=this.VQ,r=t.io={},n=t.fromRow,o=t.fromColumn,i=t.toRow,a=t.toColumn,s=t.option,l=n<0?0:n,u=o<0?0:o,c=i<0?0:i,h=a<0?0:a,f=n<0?B(e):L(t),d=o<0?j(e):t.columnCount;t.insert||e.isDirtySuspended()||(t.copy||(r.cA=new b(e,m(l,u,f,d),s)),r.fA=new b(e,m(c,h,f,d),s)),r.rA=e.Nr,r.sA=e.Pr,r.tA=e.Jl,r.uA=e.Kl},V.prototype.undo=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w;if(this.canUndo()){if(e=this.kj,r=(t=this.VQ).fromRow,n=t.fromColumn,o=t.toRow,i=t.toColumn,a=L(t),s=t.columnCount,!e.pu(r,n,a,s,B(e),j(e)))return!1;if(!t.insert&&!e.pu(o,i,a,s,B(e),j(e)))return!1;l=void 0,u=t.io,this.Lz(e,!0),c=e.parent.sheets,v.Commands._xb(c,t);try{t.insert?0<=n&&0<=r||(0<=n?(l=s,e&&U(e,-1,n,B(e),l)):0<=r&&(l=a,e&&U(e,r,-1,l,j(e)))):(h=r<0?0:r,f=n<0?0:n,d=o<0?0:o,p=i<0?0:i,g=r<0?B(e):a,m=n<0?j(e):s,e&&(U(e,r,n,a,s),b=t.tableNamesObj,y=[],C=[],b&&(b.r===d&&b.c===p&&b.rc===g&&b.cc===m?C=b.tableNames:y=b.tableNames),S(e,d,p,g,m,u.dA?u.dA.wy():[],0,y,!0),S(e,h,f,g,m,u._z?u._z.wy():[],0,C,!0))),e&&(-1!==u.tA&&-1!==u.uA&&((w=e.getSelections()[0]).contains(u.tA,u.uA)?e.Jr(u.tA,u.uA):e.Jr(w.row,w.col)),-2!==u.rA&&-2!==u.sA&&-1!==u.tA&&-1!==u.uA&&e.showCell(u.tA,u.uA,3,3))}finally{this.Mz(e,!0)}W(e)}return!0},R=V,v.Commands.fill={canUndo:!0,execute:function(e,t,r){return v.Commands.h4(e,E,t,r)}},v.Commands[h]={canUndo:!0,execute:function(e,t,r){return v.Commands.h4(e,R,t,r)}}},"./dist/plugins/fill/fill-event.js":function(e,t,r){"use strict";var y,b,c,o,C,n,h,w,E,v,f,S,R,D,x,d,p,l,i,T;function g(e){return e.rowViewportIndex}function m(e){return e.colViewportIndex}function u(e){return e.hitTestType}function A(e,t){return e.getRowCount(t)}function k(e,t){return e.getColumnCount(t)}function M(e){return e.colCount}function I(e){return e.rowCount}function N(e){return e.height}function F(e){return e.width}function _(e,t,r,n,o){var i,a,s;e.save(),t===n?(e.rect(t-2,r,7,D(o-r)),e.clip(),e.beginPath(),r<o?(r-=3,o+=3):(r+=3,o-=3),i=b.zF(t-1,r-1,n-1,o+1,l,7),a=b.zF(t,r,n,o,l,7),s=b.zF(t+1,r-1,n+1,o+1,l,7)):r===o&&(e.rect(t,r-2,D(n-t),7),e.clip(),e.beginPath(),t<n?(t-=3,n+=3):(t+=3,n-=3),i=b.zF(t-1,r-1,n+1,o-1,l,7),a=b.zF(t,r,n,o,l,7),s=b.zF(t-1,r+1,n+1,o+1,l,7)),i&&i.vE(e),a&&a.vE(e),s&&s.vE(e),e.stroke(),e.beginPath(),e.restore()}function P(e,t,r,n,o,i,a,s,l,u,c){var h=t?b.Events.DragDropBlock:b.Events.DragDropBlockCompleted,f={sheet:e,sheetName:e.name(),fromRow:r,fromCol:n,toRow:o,toCol:i,rowCount:a,colCount:s,copy:l,insert:u,copyOption:c};return t&&(f.cancel=!1),e.Wq(h,f),f.cancel}function L(e,t,r,n,o){var i,a,s;for(i=0;i<r.rowCount;i++){for(a=0;a<r.colCount;a++){if(!(s=e.getSpan(r.row+i,r.col+a))||s.rowCount!==t.rowCount||s.colCount!==t.colCount)return!1;n&&(a+=t.colCount)}o&&(i+=t.rowCount)}return!0}Object.defineProperty(t,"__esModule",{value:!0}),y=r("@grapecity/js-sheets-common"),b=r("Core"),c=r("SheetsCalc"),o=r("./dist/plugins/fill/fill-ui.js"),C=r("./dist/plugins/fill/fill.js"),n=r("./dist/plugins/fill/fill.ns.js"),h=r("@grapecity/js-calc"),w=!!h,E=b.GC$,v=b.kf,f=y.Common.j.Fa,S=null,R=Math.min,D=Math.abs,x=Math.max,d="drag",p="corner",l="black",i=new y.Common.ResourceManager(n.SR),T=i.getResource.bind(i),E.extend(b.iI.prototype,{gG:function(e){var t,r,n,o,i,a,s,l;this.zG||(t=this.kj,r=S,1===(n=t._modelManager.getSelections()).length?r=n[0]:n.length<1&&(r=t._modelManager.getSpan(t.Jl,t.Kl)),r&&(this.zG=!0,this._isWorking=!0,this.L_=r,o=t.getRangeRect(g(e),m(e),r),(i=this.gA).x=o.x,i.y=o.y,i.width=o.width-1,i.height=o.height-1,i.row=r.row,i.col=r.col,i.rowCount=I(r),i.colCount=M(r),a=t.Tq(r),s=e.row,l=e.col,s<a.row&&(s=a.row),s>=a.row+I(a)&&(s=a.row+I(a)-1),l<a.col&&(l=a.col),l>=a.col+M(a)&&(l=a.col+M(a)-1),i.hitRow=s,i.hitCol=l,i.rowOffset=s-a.row,i.colOffset=l-a.col,this.rG={KG:g(e),MG:m(e),sG:u(e)},this.qG()))},AG:function(){var e,t,r,n,o,i,a,s,l,u,c=this;c.rG&&c._isWorking&&c.zG&&c.L_&&(e=c.$F,t=c.gA,n=(r=c.kj.getCellRect(t.hitRow,t.hitCol)).width/2,o=r.x+n,i=r.height/2,a=r.y+i,t.hitTarget={x:e.x,y:e.y},s=c.fH(),l=c.gH(),u=!1,(D(o-e.x)>5+n||D(a-e.y)>5+i)&&(u=!0),0<=s&&0<=l&&u&&c.M_(s,l),c.NG())},M_:function(e,t){var r,n,o,i,a,s,l,u;this.zG&&this.L_&&(r=this.kj,n=this.gA,-1===(o=r._getActiveSelectedRange()).row&&-1!==o.col?(n.row=-1,n.col=x(0,R(k(r)-M(n),t-n.colOffset))):-1!==o.row&&-1===o.col?(n.row=x(0,R(A(r)-I(n),e-n.rowOffset)),n.col=-1):(n.row=n.row<0?-1:x(0,R(A(r)-I(n),e-n.rowOffset)),n.col=n.col<0?-1:x(0,R(k(r)-M(n),t-n.colOffset))),n.hitRow=e,n.hitCol=t,i=r.Tq(n),(a=this.N_)&&i.row===a.row&&i.col===a.col&&I(i)===I(a)&&M(i)===M(a)&&i.row>r.ar()&&i.col>r.$q()&&i.row+I(i)-1<r.ir()&&i.col+M(i)-1<r.dr()||(this.MI=i,r._render.QH(),this.N_=i,(s=r.parent)&&s.options.showDragDropTip&&(l=n.x+n.width+5,u=n.y+n.height+5,s.uw(this.O_(i),l,u))))},O_:function(e){var t,r,n,o,i,a,s,l,u;return e&&w?(r=(t=this.kj)._getActiveSelectedRange(),i=void 0,n=(n=t.getActiveRowIndex())<0?0:n,o=(o=t.getActiveColumnIndex())<0?0:o,i=1===I(r)&&1===M(r)?h.rf(S,S,e.row-n,e.col-o,!0,!0):(u=l=s=a=void 0,-1===r.row&&0<=r.col?(a=l=c.BAND_INDEX_CONST,s=e.col-o,u=e.col-o+M(r)-1):-1===r.col&&0<=r.row?(s=u=c.BAND_INDEX_CONST,a=e.row-n,l=e.row-n+I(r)-1):0<=r.row&&0<=r.col&&(a=e.row-n,l=e.row-n+I(r)-1,s=e.col-o,u=e.col-o+M(r)-1),h.uf(S,S,a,s,l,u,!0,!0,!0,!0,n,o)),t.Cf().unparse(t.yj(),i,n,o)):void 0},wH:function(){var e,t,r,n,o,i,a,s,l,u,c,h,f=this,d=!1,p="",g=!1,m=f.kj;f.rG=S,f.RG(),e=(t=m._getActiveSelectedRange())&&(0<I(t)||0<M(t))?{r:t.row,c:t.col,rc:I(t),cc:M(t)}:{r:m.Jl,c:m.Kl,rc:1,cc:1},!0===f.zG&&!0===f._isWorking&&(r=e.r,n=e.c,o=e.rc,i=e.cc,a=f.gA.row,s=f.gA.col,l=m.options.protectionOptions,u={fromRow:r,fromColumn:n,rowCount:o,columnCount:i,toRow:a,toColumn:s,isDragInsert:f.OH,isDragCopy:f.PH},m.Wq(b.Events.BeforeDragDrop,u),(p=u.invalidMessage)&&0!==p.length||(!f.OH||-1!==r&&-1!==n?a===r&&s===n||((m.qu(r,n,o,i)||m.qu(a,s,o,i))&&(d=!0,p=T().Exp_ChangeMergedCell),d||w&&(m.Ns(r,n,o,i)||m.Ns(a,s,o,i))&&(d=!0,p=T().Exp_ChangePartOfArray),!d&&m.options.isProtected&&(!f.PH&&m.ou(v(r,n,o,i))||m.ou(v(a,s,o,i)))&&(d=!0,p=T().Exp_CellReadOnly),d||(P(m,!0,r,n,a,s,o,i,f.PH,!1,2047)||(g=m.wu().execute({cmd:"dragDrop",sheetName:m.name(),fromRow:r,fromColumn:n,toRow:a,toColumn:s,rowCount:o,columnCount:i,copy:f.PH,insert:!1,option:2047}),P(m,!1,r,n,a,s,o,i,f.PH,!1,2047)))):0<=n?(f.PH&&(s<=n||n+i<=s)||!f.PH&&(s<n||n+i<s))&&((m.qu(-1,n,-1,i)||m.qu(-1,s,-1,0))&&(d=!0,p=T().Exp_ChangeMergedCell),c=l&&l.allowDragInsertColumns,!d&&m.options.isProtected&&!0!==c&&(d=!0,p=T().Exp_ColumnReadOnly),d||(P(m,!0,-1,n,-1,s,-1,i,f.PH,!0,2047)||(g=m.wu().execute({cmd:"dragDrop",sheetName:m.name(),fromRow:-1,fromColumn:n,toRow:-1,toColumn:s,rowCount:-1,columnCount:i,copy:f.PH,insert:!0,option:2047}),P(m,!1,-1,n,-1,s,-1,i,f.PH,!0,2047)))):0<=r&&n<0&&(f.PH&&(a<=r||r+o<=a)||!f.PH&&(a<r||r+o<a))&&((m.qu(r,-1,o,-1)||m.qu(a,-1,0,-1))&&(d=!0,p=T().Exp_ChangeMergedCell),d||w&&(m.Ns(r,-1,o,-1)||m.Ns(a,-1,0,-1))&&(d=!0,p=T().Exp_ChangePartOfArray),h=l&&l.allowDragInsertRows,!d&&m.options.isProtected&&!0!==h&&(d=!0,p=T().Exp_RowReadOnly),d||(P(m,!0,r,-1,a,-1,o,-1,f.PH,!0,2047)||(g=m.wu().execute({cmd:"dragDrop",sheetName:m.name(),fromRow:r,fromColumn:-1,toRow:a,toColumn:-1,rowCount:o,columnCount:-1,copy:f.PH,insert:!0,option:2047}),P(m,!1,r,-1,a,-1,o,-1,f.PH,!0,2047)))))),f._isWorking=!1,f.zG=!1,f.L_=S,f.OH=!1,f.PH=!1,f.N_=S,f.xw(),g||(f.gA={},m.repaint()),d&&m.Os(3,p)},hG:function(e){var t=this;!0!==t.BG&&!0!==t._isWorking&&(t.P_(),t.A$&&(t._isWorking=!0,t.BG=!0,t.$I=!0,t.Q_=e,t.R_=m(e),t.S_=g(e),t.T_=m(e),t.U_(),t.rG={KG:g(e),MG:m(e),sG:u(e)},t.qG()))},U_:function(){var e,t=this,r=t.kj.frozenRowCount(),n=t.kj.frozenColumnCount(),o=t.V_();0<=o&&o<r?t.W_=0:r<=o&&o<=A(t.kj)&&(t.W_=1),t.X_()?t.Y_=1:t.Y_=t.Q_,0<=(e=t.Z_())&&e<n?t.__=0:n<=e&&e<=k(t.kj)&&(t.__=1),t.a0()?t.b0=1:t.b0=t.R_},CG:function(){var e,t,r=this;r.rG&&r.BG&&r._isWorking&&r.A$&&(r.S_=r.iH(),r.T_=r.jH(),r.c0=r.fH(),r.d0=r.gH(),0<=r.c0&&0<=r.d0&&(r.e0(),r.f0(),e=r.kj.parent,t=!1,r.g0()&&(t=r.h0(r.A$,r.A_,!0)),e&&e.options.showDragFillTip&&t&&r.i0(),r.j0()),r.NG())},k0:function(){var e,t,r,n,o,i,a,s,l,u,c,h=this.kj,f=this.A$,d=this.A_,p=h.parent.options.defaultDragFillType,g=this.l0(3===p?5:p,3===p),m=this.m0(),b=this.g0();return 1===g?(e=0===m||1===m?1:0,r=new C.z$(h).B$(b,e,!0),t=this.n0(m,d,f),o=(n=h.getActualStyle(t.row,t.col)).cellType||h.Al(),i=n.formatter?n.formatter:n._autoFormatter,a=y.Formatter&&y.Formatter.GeneralFormatter,r instanceof Date&&a&&(i=new a(y.Common.CultureManager.q4().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),l=3,(s=this.rG)&&(l=s.sG),u={sheet:h,row:t.row,col:t.col,sheetArea:l,quotePrefix:n.quotePrefix},c={},o.format(r,i,c,u)):0===g?(t=this.n0(m,d,f),h.getFormula(t.row,t.col)?S:h.getText(t.row,t.col)):S},n0:function(e,t,r){var n,o=r.row,i=r.col,a=I(r),s=M(r),l=v(o,i,1,1);return 3===e?(n=0===(n=I(t)%a)?o+a-1:o+n-1,l.row=n,l.col=i):1===e?(n=0===(n=M(t)%s)?i+s-1:i+n-1,l.row=o,l.col=n):0===e?(n=0===(n=M(t)%s)?i:i+s-n,l.row=o,l.col=n):2===e&&(n=0===(n=I(t)%a)?o:o+a-n,l.row=n,l.col=i),l},i0:function(){var e,t,r,n,o,i,a=this.kj;return 4===this.l0()||this.a0()||this.X_()?(this.xw(),S):(n=this.m0(),o=this.g0(),i=a.cm(o),r=this.k0(),3===n||1===n?(e=i.x+i.width+3,t=i.y+i.height+3):0===n?(e=i.x+3,t=i.y+i.height+3):2===n&&(e=i.x+i.width+3,t=i.y+3),void this.uw(r,e,t))},j0:function(){this.o0(),this.p0(),this.q0(),this.r0=this.g0()},o0:function(){var e,t=this.kj;this.r0&&((e=t.cm(this.r0)).x-=2,e.y-=2,e.width+=4,e.height+=4,t._render.dm(e))},p0:function(e){this.kj._render.im(this.A$,S,e)},q0:function(){var e,t,r=this.kj,n=r._render,o=this.g0();o&&(e=n.bm(),t=r.cm(o),e.save(),e.beginPath(),n.RI(e,t),e.restore())},f0:function(){this.A_=this._I()},a0:function(){return-1===this.A$.col&&-1!==this.A$.row},X_:function(){return-1===this.A$.row&&-1!==this.A$.col},ZI:function(){return 4===this.dJ||5===this.dJ},_I:function(){var e=this,t=-1,r=-1,n=-1,o=-1;switch(e.dJ){case 0:n=e.X_()?t=-1:(t=e.V_(),I(e.A$)),r=e.d0,o=e.Z_()-r;break;case 1:n=e.X_()?t=-1:(t=e.V_(),I(e.A$)),r=e.s0()+1,o=e.d0-r+1;break;case 2:t=e.c0,n=e.V_()-t,o=e.a0()?r=-1:(r=e.Z_(),M(e.A$));break;case 3:t=e.t0()+1,n=e.c0-t+1,o=e.a0()?r=-1:(r=e.Z_(),M(e.A$));break;case 5:t=e.c0,n=e.t0()-t+1,o=e.a0()?r=-1:(r=e.Z_(),M(e.A$));break;case 4:n=e.X_()?t=-1:(t=e.A$.row,I(e.A$)),r=e.d0,o=e.s0()-r+1}return v(t,r,n,o)},u0:function(){var e=this.t0();return-1!==e?this.kj.Gr(this.Y_).findRow(e):S},v0:function(){return this.kj.Gr(this.S_).findRow(this.w0())},w0:function(){return this.kj.getViewportBottomRow(this.S_)},x0:function(){var e=this.s0();return-1!==e?this.kj.Hr(this.b0).findCol(e):S},y0:function(){return this.kj.Hr(this.T_).findCol(this.z0())},z0:function(){return this.kj.getViewportRightColumn(this.T_)},e0:function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C=this,w=C.a0(),v=C.X_(),S=E(C.kj.Ws()).offset(),x=C.$F.e,T=C.$F.x,A=C.$F.y,k=x.pageX-S.left,M=x.pageY-S.top,I=!1;w||v?v?C.d0>=C.Z_()&&C.d0<=C.s0()?C.dJ=4:C.d0<C.Z_()?C.dJ=0:C.d0>C.s0()&&(C.dJ=1):w&&(C.c0>=C.V_()&&C.c0<=C.t0()?C.dJ=5:C.c0<C.V_()?C.dJ=2:C.c0>C.t0()&&(C.dJ=3)):C.c0>=C.V_()&&C.c0<=C.t0()?C.d0>=C.Z_()&&C.d0<=C.s0()?(e=D(C.d0-C.s0()))<(t=D(C.c0-C.t0()))?C.dJ=5:t<e?C.dJ=4:A>(r=(r=C.u0())||C.v0()).y+r.height?C.dJ=3:(o=(n=(n=C.x0())||C.y0()).x+n.width-T,i=r.y+r.height-A,k>=n.x&&k<=n.x+n.width&&M>=r.y&&M<=r.y+r.height?C.dJ=i<=o?4:5:I=!0):C.d0<C.Z_()?C.dJ=0:C.d0>C.s0()&&(C.dJ=1):C.c0<C.V_()?C.d0>=C.Z_()&&C.d0<=C.s0()?C.dJ=2:C.d0<C.Z_()?(e=D(C.d0-C.Z_()),t=D(C.c0-C.V_()),C.dJ=e<=t?2:0):C.d0>C.s0()&&(e=D(C.d0-C.s0()),t=D(C.c0-C.V_()),C.dJ=e<=t?2:1):C.c0>C.t0()&&(C.d0>=C.Z_()&&C.d0<=C.s0()?C.dJ=3:C.d0<C.Z_()?(e=D(C.d0-C.Z_()),t=D(C.c0-C.t0()),C.dJ=e<=t?3:0):C.d0>C.s0()&&(e=D(C.d0-C.s0()),t=D(C.c0-C.t0()),C.dJ=e<=t?3:1)),(a=C.kj._render.rH)&&(u=(s=C.t0())+1,c=(l=C.s0())+1,h=C.kj.getRowHeight(s,3),f=C.kj.getColumnWidth(l,3),d=C.kj.getRowHeight(u,3),p=C.kj.getColumnWidth(c,3),g=a.x+a.width/2-R(10,f/2),m=a.x+a.width/2+R(10,p/2),b=a.y+a.height/2-R(10,h/2),y=a.y+a.height/2+R(10,d/2),(w||v?v?g<=k&&k<=m:b<=M&&M<=y:g<=k&&k<=m&&b<=M&&M<=y)||I?(C.$I=!0,C.dJ=4):C.$I=!1)},V_:function(){return this.A$?-1===this.A$.row?0:this.A$.row:-1},t0:function(){return this.A$?-1===this.A$.row?A(this.kj)-1:this.A$.row+I(this.A$)-1:-1},Z_:function(){return this.A$?-1===this.A$.col?0:this.A$.col:-1},s0:function(){return this.A$?-1===this.A$.col?k(this.kj)-1:this.A$.col+M(this.A$)-1:-1},hla:function(e,t){var r,n,o,i,a,s,l=v(t.row,t.col,t.rowCount,t.colCount),u=this.kj;return u._modelManager.findSpan(e.row,e.col)&&(r=e.rowCount,n=l.rowCount,0!==Math.floor(n%r)&&(o=Math.ceil(n/r)*r,l.row+o<=u.getRowCount()&&(l.rowCount=o)),i=e.colCount,a=l.colCount,0!==Math.floor(a%i)&&(s=Math.ceil(a/i)*i,l.col+s<=u.getColumnCount()&&(l.colCount=s))),l},xH:function(){var e,t,r,n,o=this,i=o.kj;return o.rG=S,o.RG(),o.xw(),o.BG&&o._isWorking?(o.BG=!1,o._isWorking=!1,void((e=o.g0())&&(!o.h0(o.A$,o.A_)||o.$I?(o.A0(),o.WA(e)):(t=i._eventHandler.A$,r=o.hla(t,o.A_),n=o.l0(),i.wu().execute({cmd:"fill",sheetName:i.name(),startRange:t,fillRange:r,autoFillType:n,fillDirection:i._eventHandler.m0()}),!o._$&&o.B0()&&i.parent.options.showDragFillSmartTag&&4!==o.$$?o.C0(o.$$):o.WA(e),o.A0())))):void o.A0()},C0:function(e){var t=this.kj,r=t._render.rH,n={x:r.x+r.width,y:r.y+r.height,fillType:e};t.NF=new o.K_(t.parent.xv(),t,n),t.NF.OT()},P_:function(){var e=this.kj,t=e._modelManager.getSelections();1===t.length?this.A$=t[0]:0<=e.Jl&&0<=e.Kl&&(this.A$=v(e.Jl,e.Kl,1,1))},A0:function(){this._isWorking=!1,this.BG=!1},WA:function(e){this.kj._render.im(e)},l0:function(e,t){var r=this.kj,n=void 0!==e?e:r.parent.options.defaultDragFillType;return this.ZI()?4:5!==n?n:1===I(this.A$)&&1===M(this.A$)&&!this.X_()&&!this.a0()?this.RH&&!t?1:0:this.RH&&!t?0:1},g0:function(){var e,t,r,n,o=this;return o.A$?o.ZI()?o.A$:o.A_?(n=r=t=e=0,n=o.D0()?(e=2===o.dJ?o.A_.row:o.A$.row,t=I(o.A$)+I(o.A_),r=o.A$.col,M(o.A$)):(e=o.A$.row,t=I(o.A$),r=0===o.dJ?o.A_.col:o.A$.col,M(o.A$)+M(o.A_)),v(e,r,t,n)):S:S},h0:function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b=this.kj,y=!0,C="";return!b._modelManager.MTa(t.row,t.col,I(t),M(t))||(n=b,i=t,s=(o=e).row,l=o.rowCount,u=o.col,c=o.colCount,h=i.row,f=i.rowCount,d=i.col,p=i.colCount,m=u===d&&c===p,((g=s===h&&l===f)||m)&&(a=n.getSpan(s,u))&&L(n,a,o,g,m)&&!n._modelManager.qu(h,d,f,p)&&L(n,a,i,g,m))||(y=!1,C=T().Exp_FillRangeContainsMergedCell),y&&b.options.isProtected&&b.ou(t)&&(y=!1,C=T().Exp_FillCellsReadOnly),y||r||b.Os(2,C),y},B0:function(){return this.E0()||this.F0()},E0:function(){return 3===this.dJ||1===this.dJ},F0:function(){return 0===this.dJ||2===this.dJ},D0:function(){return 2===this.dJ||3===this.dJ||5===this.dJ},m0:function(){var e=this.dJ;return 0<=e&&e<=3?e:4===e?0:5===e?2:3},tr:function(e,t,r){var n,o,i,a=S,s=g(e),l=m(e),u=this.kj,c=u.parent;if(f(s)||f(l)||!c.options.allowUserDragDrop&&!c.options.allowUserDragFill)return a;if(-1===(n=u._getActiveSelectedRange()).row&&-1===n.col)return a;if(0<=s&&0<=l&&1===u._modelManager.getSelections().length){if(this.qH(s,l,t,r))return a;(o=u.getRangeRect(s,l,n)).x-4<t&&t<o.x+4&&o.y<=r&&r<o.y+o.height&&(a={action:d,side:"left"}),a||(i=this.kj._render.rH)&&i.x<=t&&t<=i.x+i.width&&i.y<=r&&r<=i.y+i.height&&(a={action:d,side:p}),a||o.x+o.width-4<t&&t<o.x+o.width+4&&o.y<=r&&r<o.y+o.height&&(a={action:d,side:"right"}),a||o.y-4<r&&r<o.y+4&&o.x<=t&&t<o.x+o.width&&(a={action:d,side:"top"}),a||o.y+o.height-4<r&&r<o.y+o.height+4&&o.x<=t&&t<o.x+o.width&&(a={action:d,side:"bottom"}),a&&(t<o.x||t>o.x+o.width||r<o.y||r>o.y+o.height)&&(a.outside=!0)}return c&&c.options.allowUserDragDrop||a&&a.side!==p&&(a.side=S),c&&c.options.allowUserDragFill||a&&a.side===p&&(a.side=S),a},Hyb:function(e,t){var r=this.kj.getSpan(e,t,3);return r?!f(this.kj.getValue(r.row,r.col,3,0)):!f(this.kj.getValue(e,t,3,0))},Iyb:function(e,t,r,n){var o;for(o=t;o<t+n;o++)if(!this.Hyb(e,o))return!1;return!0},Jyb:function(e,t,r,n){var o;for(o=t;o<t+n;o++)if(this.Hyb(e,o))return!1;return!0},Kyb:function(e,t,r,n){var o,i,a,s,l,u,c,h=this.kj;if("left"===n){for(o=0;o<t;o++)this.Hyb(e,o)&&(r.searchArray[o]=!0);for(i=t-1,a=1;r.searchArray[i];)i--,a++;r.searchLength=a}if("right"===n){for(s=h.getColumnCount(),l=t;l<s;l++)this.Hyb(e,l)&&(r.searchArray[l-t]=!0);for(u=0,c=1;r.searchArray[u];)u++,c++;r.searchLength=c}return r},Lyb:function(e,t,r,n,o){var i,a,s,l,u,c=this.kj,h=0,f={searchArray:Array(n),searchLength:1},d={searchArray:Array(c.getColumnCount()-o),searchLength:1};for(i=t;i<r;i++)f=this.Kyb(i,e.col,f,"left"),d=this.Kyb(i,e.col+e.colCount-1,d,"right");for(;this.Jyb(r+h,e.col,1,e.colCount);){for(s=!(a=!0),f=this.Kyb(r+h,n,f,"left"),d=this.Kyb(r+h,o,d,"right"),l=n-1;l>=n-f.searchLength;l--)if(this.Hyb(r+h,l)){h++,a=!1;break}if(a){for(u=o+1;u<=o+d.searchLength;u++)if(this.Hyb(r+h,u)){h++,s=!0;break}if(!s)return h}}return h},Myb:function(e){for(var t=0;this.Iyb(e.row+e.rowCount+t,e.col,1,e.colCount);)t++;return t},Nyb:function(e){var t,r,n,o;return this.Iyb(e.row+e.rowCount,e.col,1,e.colCount)?this.Myb(e):(n=e.row-2,o=e.row+e.rowCount,r=1===e.colCount?t=e.col:(t=e.col,e.col+e.colCount-1),this.Lyb(e,n,o,t,r))},cyb:function(){var e,t,r,n=this,o=n.kj,i=o._eventHandler.A$,a=n.Nyb(i);0!==a&&(e=v(i.row+i.rowCount,i.col,a,i.colCount),n.dJ=3,n.A_=e,t=n.l0(),r=n._$,o.wu().execute({cmd:"fill",sheetName:o.name(),startRange:i,fillRange:e,autoFillType:t,fillDirection:n.dJ}),!r&&o.parent.options.showDragFillSmartTag&&4!==n.$$&&n.C0(n.$$))}}),E.extend(b.oJ.prototype,{gJ:function(e,t){var r,n=this.kj,o=e.x,i=e.y,a=F(e),s=N(e),l=n._getActiveSelectedRange(),u=n.am(),c=4,h=-2.5;return 2007<t&&(c=5,h=-3),r=new b.Rect(-4,-4,c,c),-1===l.col?(r.x=u.kt,r.y=i+s+h):-1===l.row?(r.x=o+a+h,r.y=u.nt):(r.x=o+a+h,r.y=i+s+h),r},eJ:function(e,t,r,n,o){var i,a,s=this.kj,l=s.am(),u=s.parent,c=u&&u.Vv,h=this.gJ(n,c),f=h.x,d=h.y,p=F(h),g=N(h),m=l.Ft(t,r);o&&!h.intersectRect(o)||h.intersectRect(m)&&(i=-1.5,2007<c&&(i=-1),(a=new b.Rect(f+i,d+i,p+2,g+2)).x=x(a.x,m.x),a.y=x(a.y,m.y),this.dm(a),e.save(),o&&!o.containsRect(h)&&(e.rect(o.x,o.y,F(o),N(o)),e.clip()),e.beginPath(),e.fillStyle=b.Rm.Om(s,s.getSelectionBorderColor()),e.fillRect(f,d,p,g),this.rH=new b.Rect(h.x,h.y,4,4),e.beginPath(),e.restore())},RI:function(e,t){var r=t.x,n=t.y,o=r+F(t),i=n+N(t);_(e,r,n,o,n),_(e,r,i,o,i),_(e,r,n,r,i),_(e,o,n,o,i)},NI:function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d=this.kj,p=d._eventHandler.gA,g=p.hitTarget;p&&g&&(r=p.hitCol,n=p.hitRow,o=d._eventHandler.OH,i=d.OI,e.save(),!0!==o||-1!==p.row&&-1!==p.col?(i&&(a=new b.Rect(i.x-2,i.y-2,F(i)+4,N(i)+4),this.dm(a,t),this.im(d._getActiveSelectedRange(),t)),e.rect(t.x,t.y,F(t),N(t)),e.clip(),e.beginPath(),this.RI(e,p)):-1===p.row&&-1!==p.col?(s=(s=(s=d.Hr(0).findCol(r))||d.Hr(1).findCol(r))||d.Hr(2).findCol(r))&&(l=s.x,u=F(s),p.col=r,g.x>l+u/2&&(p.col<d.cr()||p.col===d.dr())&&(l=s.x+F(s),p.col++),i&&0===F(i)||(i=d._eventHandler.gA),i&&(a=new b.Rect(i.x-2,i.y-2,F(i)+4,N(i)+4),this.dm(a,t),this.im(d._getActiveSelectedRange(),t)),d.QI=new b.Rect(l,p.y,0,N(p)),e.rect(t.x,t.y,F(t),N(t)),e.clip(),e.beginPath(),_(e,l,p.y,l,p.y+N(p))):-1===p.row||-1!==p.col||(c=(c=(c=d.Gr(0).findRow(n))||d.Gr(1).findRow(n))||d.Gr(2).findRow(n))&&(h=c.y,f=N(c),p.row=n,g.y>h+f/2&&(p.row<d.hr()||p.row===d.ir())&&(h=c.y+N(c),p.row++),i&&0===N(i)||(i=d._eventHandler.gA),i&&(a=new b.Rect(i.x-2,i.y-2,F(i)+4,N(i)+4),this.dm(a,t),this.im(d._getActiveSelectedRange(),t)),d.QI=new b.Rect(p.x,h,F(p),0),e.rect(t.x,t.y,F(t),N(t)),e.clip(),e.beginPath(),_(e,p.x,h,p.x+F(p),h)),e.beginPath(),e.restore())},QH:function(){var e,t,r,n,o,i,a,s,l,u,c,h=this.kj,f=h.yt,d=h._eventHandler.MI;f&&f.dragInfo&&d&&(e=this.bm(),t=h.am(),r=h._eventHandler.gA,n=h.cm(d),o=h.frozenTrailingColumnCount(),i=h.frozenTrailingRowCount(),a=h.getColumnCount()-o,s=h.getRowCount()-i,l=t.Ft(1,1),0<o&&d.col+d.colCount<=a&&n.x+F(n)>l.x+F(l)&&n.intersectRect(l)&&(n=n.getIntersectRect(l)),0<i&&d.row+d.rowCount<=s&&n.y+N(n)>l.y+N(l)&&n.intersectRect(l)&&(n=n.getIntersectRect(l)),u=new b.Rect(t.kt,t.nt,t.lt+t.js,t.ot+t.gs),0<F(n)&&0<N(n)?(r.x=n.x,r.y=n.y,r.width=F(n)-1,r.height=N(n)-1,this.NI(e,u)):0!==F(n)&&0!==N(n)||(r.x=n.x,r.y=n.y,r.width=F(n),r.height=N(n),this.NI(e,u)),c=h._eventHandler.OH,h.OI=!0===c?h.QI:new b.Rect(r.x,r.y,F(r),N(r)))}})},"./dist/plugins/fill/fill-ui.js":function(e,t,r){"use strict";var n,o,i,d,p,a,s,g,l,u,c,h,f,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B=this&&this.__extends||(P=function(e,t){return(P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}P(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function j(e,t,r,n,o,i){var a=e.CH,s=a?"160px":"150px",l=a?"25px":"20px",u=d(p("div")).css([v,S,x,"padding",T],["block",s,l,0,0]).addClass("gc-smartMenu-item-default "+r+" ui-state-default"+g),c=d(p("div")).addClass(b).appendTo(u),h=d(p("div")).addClass("gc-menu-item-text").appendTo(u),f=d(p("input")).attr({id:t,value:o,type:"radio",name:"fill-group",style:"display:none"}).appendTo(c);return d(p("span")).text(n).appendTo(h),i?(c.addClass(m),f.prop("checked","checked")):f.prop("checked",""),u}function H(e,t,r){var n,o=L.call(this,e,a(t.parent._host))||this;return o.kj=t,o.B_=r,n=o.C_=o.yo().addClass("gc-smart-tag-default "+C+" gc-no-user-select ui-widget-header"+g),o.D_=d(p("div")).attr("class","fillSmartTag").css("float",w).appendTo(n),o.E_=d(p("div")).attr("class","fillSmartTagDown").css(["float",v],[w,"none"]).appendTo(n),o}function G(e,t){var r,n=O.call(this,e,a(t.parent._host))||this;return n.kj=t,n.v_=d("."+C),(r=n.w_=n.yo()).addClass(c),j(t,"smartMenuCopyCells",u,F().CopyCells,"0",!0).appendTo(r),j(t,"smartMenuFillSeries",u,F().FillSeries,"1").appendTo(r),j(t,"smartMenuFillFormattingOnly",u,F().FillFormattingOnly,"2").appendTo(r),j(t,"smartMenuFillWithoutFormatting",u,F().FillWithoutFormatting,"3").appendTo(r),n}Object.defineProperty(t,"__esModule",{value:!0}),n=r("@grapecity/js-sheets-common"),o=r("Core"),i=r("./dist/plugins/fill/fill.ns.js"),d=o.GC$,p=o.Ul.Nl,a=o.Ul.vl,s=d(document),g=" btn btn-default",u="gc-fill-type-item",c="gc-fill-menu-container",h=(l="ui-state-hover ")+"gc-smartMenu-item-hover",f=l+"gc-smart-tag-hover",m="ui-icon ui-icon-check gc-check-image",b="gc-menu-item-input",y="ui-state-active gc-smart-tag-active",C="gc-tag-container",w="left",v="display",S="min-width",x="height",T="margin",A="change",k="input[type=radio]",M="mouseover",I="mouseout",E="click",R="fillTypeChanged",D="keydown.ui-fill",N=new n.Common.ResourceManager(i.SR),F=N.getResource.bind(N),O=o.Go,B(G,O),G.prototype.Ao=function(){O.prototype.Ao.call(this)},G.prototype.QQ=function(){var i=this;d("."+u).bind(M,function(){d(this).addClass(h)}).bind(I,function(){d(this).removeClass(h)}).bind(E,function(){var e,t=d(this),r=i.v_,n=t.find(k),o=n[0];o.checked=!0,n.trigger(A),r.trigger(E),r.trigger(I),t.removeClass(h),e=parseInt(d(o).attr("value"),10),i.x_(e)}),i.w_.find(k).bind(A,function(){d("."+b).removeClass(m),d(this).parent().addClass(m)})},G.prototype.y_=function(){d("."+u).unbind(M).unbind(I).unbind(E),this.w_.find(k).unbind(A)},G.prototype.x_=function(e){var t=this.kj,r=t._eventHandler;if(this.z_!==e){this.z_=e,t.U$=!0,t.suspendEvent();try{o.Commands.undo.execute(t.parent,{sheetName:t.name()})}finally{t.resumeEvent()}t.U$=!1,t.wu().execute({cmd:"fill",sheetName:t.name(),startRange:r.A$,fillRange:r.A_,autoFillType:e,fillDirection:r.dJ}),this.v_.trigger(R,e)}},G.prototype.MQ=function(){return!!d("."+c).length},_=G,L=o.Go,B(H,L),H.prototype.F_=function(e,t,r){var n=this.kj.CH,o=d(t),i=this.G_,a=this.E_,s=n?"38px":"32px",l=n?"24px":"18px";i&&i.MQ()||(e?o.addClass(f):o.removeClass(f),o.css(["width",x],[e?s:l,l]),r||(e?a.show():a.hide()))},H.prototype.H_=function(){var i=this,e=i.C_,t=o.Ul.rl(),a=o.Ul.Ml.safari&&(t.ipad||t.iphone);e.bind(M,function(){i.F_(!0,this,a)}).bind(I,function(){i.F_(!1,this,a)}),e.bind(E,function(){var e,t,r=d(this),n=i.G_,o=i.E_;n&&n.MQ()?(a&&o.hide(),r.removeClass(y),i.I_()):(a&&o.show(),r.addClass(y),i.J_(),(t=(e=i.w_)&&e.find(k)[i.B_.fillType])&&!t.checked&&(t.checked=!0,d(t).trigger(A)))}),s.bind(D,function(e){27===e.keyCode&&(i.G_&&i.G_.MQ()?i.I_():i.close(),o.Ul.nl(e))})},H.prototype.OT=function(){var e=this.C_,t=this.B_,r=this.kj.CH,n=r?"3px":"0px",o=r?"24px":"18px";e&&(e.css([w,"top"],[t.x,t.y]),this.Ao(),this.H_(),this.D_.css(T,n),this.E_.css(x,o),this.hZ())},H.prototype.J_=function(){var e,t,r,n,o,i,a,s=this.kj;this.G_||(this.G_=new _(s.parent.xv(),s),this.w_=this.G_.yo()),t=(e=this.C_).css(w),r=e.css("top"),n=parseFloat(r),i=this.G_,a=this.B_,i.z_=a.fillType,isNaN(n)||(o=n+e.height()+2),this.w_.css([w,"top"],[t,o]),i.Ao(),i.QQ(),i.v_.unbind(R).bind(R,function(e,t){a.fillType=t})},H.prototype.I_=function(){var e=this.G_;e&&(e.y_(),e.close())},H.prototype.hZ=function(){var e=this.G_,t=this.C_;e&&(e.MQ()&&t.trigger(E),t.trigger(I))},H.prototype.close=function(){var e,t=this.kj;this.hZ(),s.unbind(D),L.prototype.close.call(this),(e=t.Xs)&&(e.style.cursor="default"),t&&t.zt()},t.K_=H},"./dist/plugins/fill/fill.entry.js":function(e,r,t){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),t("./dist/plugins/fill/drag-fill.js"),t("./dist/plugins/fill/fill-event.js"),n(t("./dist/plugins/fill/fill-ui.js")),n(t("./dist/plugins/fill/fill.js")),n(t("./dist/plugins/fill/fill.ns.js"))},"./dist/plugins/fill/fill.js":function(e,t,r){"use strict";var u,n,o,d,i,p,a,$,b,C,w,ee,s,l,c,R,h,f,g,te,re,ne,m,D,oe,y,v,S,x,T,A,k,M,I,E,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,ie=this&&this.__extends||(L=function(e,t){return(L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}L(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function ae(e){return!se(e)&&a.Na(e)}function se(e){return"string"==typeof e}function le(e){var t=[e];return t.rowCount=1,t.colCount=R(e),t}function ue(e){return e}function ce(e,t,r,n){var o=le(t),i=le(r),a=le([n]),s=e?u.Common.qc(o,i,a,!0,ue,$,$,$):u.Common.sc(o,i,a,!0,$,$,$),l=s&&s[0][0];return typeof l===te?u.Common.o.Lma(l,13):l}function he(e){return e.toLowerCase()}function fe(){this.Uk="",this.Wyb="",this.Tyb=0,this.Xyb=1,this._padding=""}function de(e){this.Ryb=-1,this.Syb=[],this.Tyb=-1,this.kj=e}function pe(e){this.e_=[],this.f_=[],this.Oyb=[],this.Nc=$,this.Pyb=[],this.Qyb=$,this.g_=ee(e)?-1:e}function ge(e){var t,r=e.length,n=1;if(1<r)for(n=e[1]-e[0],t=2;t<r;t++)if(n!==e[t]-e[t-1]){n=0;break}return n}function me(e,t){return 0<e?(e-1)%t:t-Math.abs(e)%t-1}function be(e){for(var t="",r=0;r<e;)t+="0",r++;return t}function ye(e,t){return 12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth())}function Ce(e,t){var r,n=e.length,o=!0;for(r=2;r<n&&(o=t===ye(e[r-1],e[r]));r++);return o}function we(e){return"0"===e[0]}function ve(t,e,r){var n,o,i,a,s,l=r?1:2,u=r?2:1;return e.every(function(e){return!!(n=e.match(t.Yyb))&&(o=n[l],(s=o.length)>t.Zyb&&we(o)&&(t.Zyb=s),i=parseInt(o,10),a=n[u],ee(t.Qyb)&&(t.Qyb=a),a!==t.Qyb?(t.$yb=!0,t.Qyb=$,t.Pyb=[]):t.Pyb.push(i),!0)})}function Se(e){this.fzb=[new T,new A,new k],this.gzb=[new I(e),new E,new N,new F],this.hzb=new _,this.izb=new P}function xe(){var e=null!==U&&U.apply(this,arguments)||this;return e.t_=!0,e}function Te(){return null!==W&&W.apply(this,arguments)||this}function Ae(){var e=null!==V&&V.apply(this,arguments)||this;return e.Yyb=/^(\d+)(\D+.*)$/,e}function ke(){var e=null!==z&&z.apply(this,arguments)||this;return e.Yyb=/^(.*\D+)(\d+)$/,e}function Me(){var e=null!==q&&q.apply(this,arguments)||this;return e.Yyb=/^\d+$/,e}function Ie(e){var t=Z.call(this)||this;return t.ezb=new y(e),t}function Ee(){var e=Y.call(this)||this;return e.Yyb=$,e.Pyb=[],e.Qyb=$,e.$yb=!1,e.Zyb=0,e.Nc=ne,e.t_=!1,e.czb=!1,e.dzb=new v,e}function Re(){return null!==K&&K.apply(this,arguments)||this}function De(){return null!==X&&X.apply(this,arguments)||this}function Ne(){return null!==J&&J.apply(this,arguments)||this}function Fe(){var e=null!==Q&&Q.apply(this,arguments)||this;return e.azb=0,e.Nc=re,e}function _e(){}function Pe(e){e.forEach(function(e){e&&e.dispose()})}function Le(e){this.kj=e,this.AX=!1,this.cLb=[]}Object.defineProperty(t,"__esModule",{value:!0}),u=r("@grapecity/js-sheets-common"),n=r("Core"),o=r("@grapecity/js-calc"),d=r("SheetsCalc"),i=r("./dist/plugins/fill/fill.ns.js"),p=!!o,a=u.Common.j,$=null,b=void 0,C=Math.floor,w=n.kf,ee=a.Fa,s=a.Pa,l=u.Common.k,c=l.Eb,R=l.ac,h=u.Common.l,f=h.Ra,g=h.Xb,te="number",re="date",ne="string",m=new u.Common.ResourceManager(i.SR),D=m.getResource.bind(m),(G=t.AutoFillType||(t.AutoFillType={}))[G.copyCells=0]="copyCells",G[G.fillSeries=1]="fillSeries",G[G.fillFormattingOnly=2]="fillFormattingOnly",G[G.fillWithoutFormatting=3]="fillWithoutFormatting",G[G.clearValues=4]="clearValues",G[G.auto=5]="auto",(H=t.FillDirection||(t.FillDirection={}))[H.left=0]="left",H[H.right=1]="right",H[H.up=2]="up",H[H.down=3]="down",(j=t.FillSeries||(t.FillSeries={}))[j.column=0]="column",j[j.row=1]="row",(B=t.FillType||(t.FillType={}))[B.direction=0]="direction",B[B.linear=1]="linear",B[B.growth=2]="growth",B[B.date=3]="date",B[B.auto=4]="auto",(O=t.FillDateUnit||(t.FillDateUnit={}))[O.day=0]="day",O[O.weekday=1]="weekday",O[O.month=2]="month",O[O.year=3]="year",pe.prototype.h_=function(){return R(this.e_)},pe.prototype.Ey=function(){var e,t,r=[],n=this.f_;for(e=0;e<R(n);e++)t=n[e],r.push("object"===this.Nc?this.Wh(t):t);return r},pe.prototype.i_=function(){var e,t,r,n=this.e_;if(0<R(n)){for(t=[],r=void 0,-1===(e=this.g_)&&(e=n[0]),r=0;r<R(n);r++)t[r]=n[r]-e+1;return t}return $},pe.prototype.j_=function(){var e=this.f_;return R(e)?e:$},pe.prototype.Eb=function(e,t,r){if(!ae(r))throw Error(D().Exp_NumberOnly);ee(this.Nc)&&(this.Nc=r instanceof Date?re:te),c(this.e_,e,t),c(this.f_,e,s(r))},pe.prototype.Sb=function(e,t){var r=ee(this.Nc);ae(t)?(r&&(t instanceof Date?this.Nc=re:this.Nc=te),this.f_.push(s(t))):r&&(this.Nc=se(t)?ne:"default"),this.e_.push(e),this.Oyb.push(t)},pe.prototype.k_=function(e){return this.Nc===re?this.Wh(e):e},pe.prototype.Wh=function(t){var r=$;if(t instanceof Date)r=t;else if(o)try{r=o.Convert.Wh(t)}catch(e){r=t}return r},oe=pe,de.prototype.no=function(){this.kj=$},de.prototype.Uyb=function(){var e=this.kj;return e.parent&&e.parent.Txb()||[]},de.prototype.Vyb=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g=e.length,m=!1;if(e&&0<g)for(t=he(e[0]),r=this.Uyb(),l=s=a=i=o=n=void 0,n=0;n<r.length;n++)if(0<=(a=(i=(o=r[n]).map(function(e){return he(e)})).indexOf(t))){for(s=a,u=i.length,f=h=c=void 0,d=1;d<g;d++){if(h=he(e[d]),!(0<=(c=i.indexOf(h)))){m=!1;break}if(f=c-s+u,l){if(l!==f){m=!1;break}}else m=!0,l=f,s=c}if(p=1===g,m||p){m=!0,this.Ryb=a,this.Syb=o,this.Tyb=p?1:l;break}}return m},de.prototype.ge=function(e){var t=this.Syb,r=this.Ryb,n=this.Tyb,o=t.length;return t[(r+n*me(e,o))%o]},y=de,fe.prototype.ge=function(e){var t=this.Tyb*(e-1)+this.Xyb,r=this._padding.length,n=""+Math.abs(t),o=n.length,i=this._padding+n,a=i.length;return n=r<o?n:i.substr(a-r),this.Uk+n+this.Wyb},v=fe,_e.prototype.match=function(e){return!1},_e.prototype.getTargetValue=function(e,t,r,n,o){},_e.prototype.resetProp=function(){},_e.prototype._yb=function(e,t){return e.indexOf(t+1)},_e.prototype.dispose=function(){},ie(Fe,Q=S=_e),ie(Ne,J=x=Fe),Ne.prototype.match=function(e){var t=this.azb=ye(e[0],e[1]),r=e.every(function(e){return 1===e.getDate()}),n=e.length,o=!0;return r&&2<n&&(o=Ce(e,t)),r&&o},Ne.prototype.getTargetValue=function(e,t){var r=e.Oyb[0],n=r.getFullYear(),o=t-1,i=r.getMonth()+this.azb*o;return new Date(n+parseInt(i/12,10),i%12,1)},T=Ne,ie(De,X=x),De.prototype.match=function(e){var t=this.azb=ye(e[0],e[1]),r=e.every(function(e){var t=e.getFullYear(),r=e.getMonth();return e.getDate()===new Date(t,r+1,0).getDate()}),n=e.length,o=!0;return r&&2<n&&(o=Ce(e,t)),r&&o},De.prototype.getTargetValue=function(e,t){var r=e.Oyb[0],n=r.getFullYear(),o=t-1,i=r.getMonth()+this.azb*o,a=n+parseInt(i/12,10),s=i%12;return new Date(a,s,new Date(a,1+s,0).getDate())},A=De,ie(Re,K=x),Re.prototype.match=function(e){var t,r,n,o,i,a,s=!1;return e.every(function(e){var t=e.getHours(),r=e.getMinutes(),n=e.getSeconds();return 0!==t||0!==r||0!==n})||(t=this.azb=ye(e[0],e[1]),n=(a=0)<(r=e.every(function(e){var t=e.getDate();return(a=a||t)===t})?a:0),o=e.length,i=!0,this.bzb=r,n&&2<o&&(i=Ce(e,t)),s=n&&i),s},Re.prototype.getTargetValue=function(e,t){var r=e.Oyb[0],n=r.getFullYear(),o=t-1,i=r.getMonth()+this.azb*o,a=n+parseInt(i/12,10);return new Date(a,i%12,this.bzb)},k=Re,ie(Ee,Y=S),Ee.prototype.resetProp=function(){this.Pyb=[],this.Zyb=0,this.Qyb=$,this.$yb=!1,this.t_=!1,this.czb=!1},Ee.prototype.getInternal=function(e){var t,r,n=!1,o=e[0];for(r=1;r<e.length;r++)if(t=e[r],1!==Math.abs(t-o)){n=!0;break}return n},ie(Ie,Z=M=Ee),Ie.prototype.dispose=function(){this.ezb&&(this.ezb.no(),this.ezb=$)},Ie.prototype.match=function(e){return this.ezb.Vyb(e)},Ie.prototype.getTargetValue=function(e,t,r,n,o){var i,a=e.Oyb.length,s=this._yb(r,n),l=$;return-1!==s&&(i=a*o+s+1,l=this.ezb.ge(i)),l},I=Ie,ie(Me,q=M),Me.prototype.match=function(e){var t,r,n=this;return e.every(function(e){return!!e.match(n.Yyb)&&((r=e.length)>n.Zyb&&we(e)&&(n.Zyb=r),t=parseInt(e,10),n.Pyb.push(t),!0)})},Me.prototype.getTargetValue=function(e,t,r,n,o){var i,a=e.Oyb,s=this.dzb,l=ge(this.Pyb),u=a.length,c=0!==l,h=c?0:me(t,u),f=this._yb(r,n),d=$;return this.t_=c,this.czb=this.getInternal(e.e_),-1!==f&&(s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=be(this.Zyb),i=u*o+f+1,d=s.ge(i)),d},E=Me,ie(ke,z=M),ke.prototype.match=function(e){return ve(this,e,!1)},ke.prototype.getTargetValue=function(e,t,r,n,o){var i,a=e.Oyb,s=this.dzb,l=ge(this.Pyb),u=a.length,c=0!==l,h=c?0:me(t,u),f=this._yb(r,n),d=$;return this.t_=c,this.czb=this.getInternal(e.e_),-1!==f&&(s.Uk=this.Qyb,s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=be(this.Zyb),i=u*o+f+1,d=s.ge(i)),d},N=ke,ie(Ae,V=M),Ae.prototype.match=function(e){return ve(this,e,!0)},Ae.prototype.getTargetValue=function(e,t,r,n,o){var i,a=e.Oyb,s=this.dzb,l=ge(this.Pyb),u=a.length,c=0!==l,h=c?0:me(t,u),f=this._yb(r,n),d=$;return this.t_=c,this.czb=this.getInternal(e.e_),-1!==f&&(s.Wyb=this.Qyb,s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=be(this.Zyb),i=u*o+f+1,d=s.ge(i)),d},F=Ae,ie(Te,W=S),Te.prototype.getTargetValue=function(e,t,r){return ce(!0,e.j_(),r,t)},_=Te,ie(xe,U=S),xe.prototype.getTargetValue=function(e,t,r,n){var o=e.Oyb;return o[me(t,o.length)]},P=xe,Se.prototype.getRule=function(e,t){var r,n,o,i=[],a=this.izb;for(e===re?(i=this.fzb,a=this.hzb):e===ne?i=this.gzb:e===te&&(a=this.hzb),r=0;r<i.length;r++)if(o=void 0,(n=i[r]).resetProp(),n.match(t)){if(o=n.$yb,ee(o)||!1===o)return n;if(!0===o)return a}return a},Se.prototype.no=function(){var e=this;e.fzb&&(Pe(e.fzb),e.fzb=$),e.gzb&&(Pe(e.gzb),e.gzb=$),e.hzb&&(e.hzb.dispose(),e.hzb=$),e.izb&&(e.izb.dispose(),e.izb=$)},t.Gyb=Se,Le.prototype.D$=function(e,t,r,n,o){var i=e?1:2;ee(n)&&ee(o)?this.E$(t,r,i):this.E$(t,r,i,n,o,$)},Le.prototype.E$=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=this.kj,A=T.Tq(e),k=A.row,M=A.col,I=A.rowCount,E=A.colCount;if(T._modelManager.MTa(k,M,I,E))throw Error(D().Exp_RangeContainsMergedCell);for(f=0,p=(d=1===t)?E:I,g=d?k:M,m=d?k+I:M+E,b=(h=3<arguments.length)?1:p,C=(y=this.kj._eventHandler.A$).row===k&&y.rowCount===I&&y.col>M||y.col===M&&y.colCount===E&&y.row>k,a=g;a<m;a++)if(w=C&&h?M+E-1:M,v=C&&h?k+I-1:k,(S=d?this.l_(a,w,1,b,t):this.l_(v,a,b,1,t))&&S.h_())for(u=S.e_[0],h?(c=C?S.f_[R(S.f_)-1]:S.f_[0],s=this.m_(C,c,p,r,n,o,i),C&&(f=p-R(s),u=S.e_[R(S.e_)-1])):s=this.n_(S,p,r),l=0;l<R(s);l++)x=S.k_(s[l]),d?this.o_(T,a,u,a,M+f+l,x,r):this.o_(T,u,a,k+f+l,a,x,r)},Le.prototype.l_=function(e,t,r,n,o){for(var i,a=$,s=this.kj,l=1===o,u=l?t+n-1:e+r-1,c=l?t:e;c<=u;)ae(i=l?s.getValue(e,u):s.getValue(u,t))&&(a=a||new oe(c)).Eb(0,u,i),u--;return a},Le.prototype.m_=function(e,t,r,n,o,i,a){var s,l,u,c=[],h=t,f=0<=o,d=ee(i);for(s=0;s<r;s++)l=i<=h,u=h<=i,e&&(d||f&&l||!f&&u)?(c.unshift(h),1===n?h-=o:2===n?h/=o:3!==n||ee(a)||(h=this.p_(!0,a,t,h,o,s+1))):!e&&(d||f&&u||!f&&l)&&(c.push(h),1===n?h+=o:2===n?h*=o:3!==n||ee(a)||(h=this.p_(!1,a,t,h,o,s+1)));return c},Le.prototype.n_=function(e,t,r){var n,o=[],i=1===r;if(i||2===r){for(1===e.h_()&&e.Sb(e.e_[0]+1,i?e.k_(e.f_[0]+1):e.Ey()[0]),n=0;n<t;n++)o.push(ce(!!i,e.j_(),e.i_(),n+1));return o}return $},Le.prototype.B$=function(e,t,r,n,o){var i=this.kj,a=i._modelManager,s=i.Tq(e),l=s.row,u=s.col,c=s.rowCount,h=s.colCount,f=i.Tq(i._eventHandler.A$),d=f.row,p=f.col;if(a.qu(d,p,f.rowCount,f.colCount)||a.qu(l,u,c,h))throw Error(D().Exp_ChangeMergedCell);return this.q_(f,c,h,t,r,!(l<d||u<p),n,o)},Le.prototype.q_=function(e,t,r,n,o,i,a,s){var l,u,c,h,f=i?1:-1,d=e.row,p=e.col,g=e.rowCount,m=e.colCount;if(1===n){if(l=C(r/m),u=r%m,!o)for(h=1;h<l;h++)c=w(d,p+h*f*m,g,m),this.r_(e,c,n,4,o,i,b,b,b,a,s);if(o&&1<l&&0===u&&(--l,u=m),0<l&&0<u)return c=w(d,i?p+l*m:p-l*m+m-u,g,u),this.r_(e,c,n,4,o,i,$,i?0:m-u,b,a,s)}else{if(l=C(t/g),u=t%g,this.AX||(c=w(d+f*g,p,t-g,r),this.dLb(e,c,f)),!o)for(h=1;h<l;h++)c=w(d+h*f*g,p,g,m),this.r_(e,c,n,4,o,i,$,$,!0,a,s);if(o&&1<l&&0===u&&(--l,u=g),0<l&&0<u)return c=w(i?d+l*g:d-l*g+g-u,p,u,m),this.r_(e,c,n,4,o,i,i?0:g-u,$,!0,a,s)}},Le.prototype.r_=function(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V=this.kj,z=1===r,q=z?e.row:e.col,Z=z?e.col:e.row,Y=z?t.row:t.col,K=z?t.col:t.row,X=z?e.rowCount:e.colCount,J=z?e.colCount:e.rowCount,Q=z?t.colCount:t.rowCount;for(p=0;p<X;p++){for(b=m=$,y=0,v=C=q+p,S=w=Y+p,x=(z?s:a)||0,T=z?0:x,A=z?$:l,k=$;y<J;)if(E=$,R=M=Z+y,D=I=K+y-x,z||(C=M,M=v,w=I,I=S),d=V._modelManager.findSpan(C,M),(h=V.getFormula&&V.getFormula(C,M))&&""!==h||(E=V.getValue(C,M)),(N=this.AX)&&ee(k)&&(k=!1===i?V.getValue(Z+J-1,M):V.getValue(C,M)),N||4!==n||!ae(E)&&!se(E)||(m=m||new oe,f=ae(E)?E instanceof Date?re:te:ne,(b=b||f)!==f))if(!N&&E&&m&&m.h_()){if(g=this.s_(z,e,t,v,S,m,o,i,T,A,u,c),o&&g)return g;b=m=$}else{if(N||!d||d&&(z?d.row:d.col)===v)if(F=D==K+Q-1,_=N?k:E,o){if(N)return _;if(d&&F||!d&&(F&&i||!i&&D===K))return E}else D<K+Q&&K<=D&&(N||z||!z&&!(l&&V.Ps&&V.Ps(D)))&&(N&&-1!==this.cLb.indexOf(w)||this.o_(V,C,M,w,I,_,n,u,c));d?y+=z?d.colCount:d.rowCount:y++}else m.Sb(R,E),d?y+=z?d.colCount:d.rowCount:y++;if(this.AX)for(P=e.row,L=e.col,O=e.rowCount,B=e.colCount,H=j=void 0,G=!1===i?-1:1,U=1;U<O;U++)for(j=P+G*U,W=0;W<B;)H=L+W,-1===this.cLb.indexOf(j)&&this.o_(V,P,L,j,H,k,n,u,c),W++;if(m&&m.h_()&&(g=this.s_(z,e,t,v,S,m,o,i,T,A,u,c),o&&!ee(g)))return g}return $},Le.prototype.dLb=function(e,t,r){var n,o,i,a,s,l,u,c=this.kj,h=c.tables,f=e.union(t),d=f.row,p=f.rowCount,g=e.row,m=e.col,b=e.rowCount,y=e.colCount;if(h)for(n=h.s$(g,m,b,y),o=0;o<n.length;o++)if(i=n[o].xr,a=this.cLb,s=void 0,i&&i.isFiltered&&i.isFiltered()){for(l=0;l<p;l++)s=d+r*l,i.isRowFilteredOut(s)&&this.cLb.push(s);if(0<a.length){this.AX=!0;break}}if(u=c.xr,!0!==this.AX&&u&&u.isFiltered&&u.isFiltered()){for(a=this.cLb,s=void 0,l=0;l<p;l++)s=d+r*l,u.isRowFilteredOut(s)&&this.cLb.push(s);0<a.length&&(this.AX=!0)}},Le.prototype.o_=function(e,t,r,n,o,i,a,s,l){var u,c,h,f=e._modelManager;p&&(e.hasFormula(t,r)||e.hasFormula(n,o))&&(e.setFormula(n,o,$),0!==a&&4!==a||(u=e.Bj(),e.getFormula(t,r)&&d.CalcOperatorAdjustor.copyFormula(u,t,r,u,n,o,1,1))),e.setValue(n,o,i),h=l?0:64,s&&(h|=128),h|=1024,e.copyTo(t,r,n,o,1,1,h),e.removeSpan(n,o,3),(c=f.findSpan(t,r))&&t===c.row&&r===c.col&&e.Sq(n,o,c.rowCount,c.colCount,3)},Le.prototype.s_=function(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M=this.kj,I=e?r.col:r.row,E=e?t.col:t.row,R=e?r.colCount:r.rowCount,D=e?t.colCount:t.rowCount;if(l=l||0,m=i.h_(),b=(I-E-l)/D,y=this.t_(i.e_,i.f_),C=i.Nc,y){for(p=[],d=0;d<m;d++)p[d]=d+1;f=m}else g=i.e_[0],f=i.e_[m-1]-g+1,1===m&&C!==ne&&i.Sb(i.e_[0]+1,i.k_(i.f_[0]+1)),p=i.i_();for(d=0;d<f;d++)if(w=i.Oyb,S=v=void 0,C!==re&&C!==ne||(v=M.Fyb&&M.Fyb.getRule(C,w)),T=I+R-1,k=(A=(v?(S=v.getTargetValue(i,f*b+d+1,p,d,b),y=v.t_?v.t_:y,x=!!v.czb&&v.czb,y&&!x):(S=ce(!0,i.j_(),p,f*b+d+1),y))?i.e_[d]:g+d)+b*D,a){if(y&&(s&&k===T||!s&&k===I)||!y&&k+l===T)return i.k_(S)}else k<I+R&&I<=k&&(e?this.o_(M,n,A,o,k,i.k_(S),4,c,h):u&&M.Ps&&M.Ps(k)||this.o_(M,A,n,k,o,i.k_(S),4,c,h));return $},Le.prototype.t_=function(e,t){var r,n,o,i=R(t);if(i<=1||R(e)!==i)return!1;for(r=e[1]-e[0],n=t[1]-t[0],o=2;o<i;o++)if(e[o]-e[o-1]!=r||t[o]-t[o-1]!=n)return!1;return!0},Le.prototype.C$=function(e,t){var r,n=this.kj,o=n._modelManager.getSpans(),i=n.Tq(e),a=i.row,s=i.col,l=i.rowCount,u=i.colCount;r=0===t?w(a,s+u-1,l,1):1===t?w(a,s,l,1):w(2===t?a+l-1:a,s,1,u),(r=n.su(o,r))&&this.u_(r,a,s,l,u,t)},Le.prototype.u_=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p=e.row,g=e.col,m=e.rowCount,b=e.colCount,y=this.kj._modelManager;if(c=0===i?(d=y.MTa(t,r,n,o-b),h=0,f=-1*b,l=o,u=b,1):1===i?(d=y.MTa(t,r+b,n,o-b),h=0,l=o,u=f=b,1):(h=2===i?(d=y.MTa(t,r,n-m,o),-1*m):(d=y.MTa(t+m,r,n-m,o),m),l=n,u=m,f=0),d)throw Error(D().Exp_TargetContainsMergedCells);if(l%u!=0)throw Error(D().Exp_MergedCellsIdentical);for(a=C(l/u),s=1;s<a;s++)this.r_(e,w(p+s*h,g+s*f,m,b),c,0)},Le.prototype.p_=function(e,t,r,n,o,i){var a=e?-1:1,s=C(i*o),l=Math.abs(o),u=g(1<t?r:n);if(0===t)u.setDate(u.getDate()+a*o);else if(1===t)for(;0<l;)u.setDate(u.getDate()+a*(0<o?1:-1)),6!==u.getDay()&&0!==u.getDay()&&l--;else 2===t?u.setMonth(u.getMonth()+a*s):u.setFullYear(u.getFullYear()+a*s);return f(u)},t.z$=Le},"./dist/plugins/fill/fill.ns.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./dist/plugins/fill/fill.res.en.js");t.SR={en:n}},"./dist/plugins/fill/fill.res.en.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyCells="Copy Cells",t.FillSeries="Fill Series",t.FillFormattingOnly="Fill Formatting Only",t.FillWithoutFormatting="Fill Without Formatting",t.Exp_NumberOnly="Only works for Numbers",t.Exp_RangeContainsMergedCell="Range should not have merged cells.",t.Exp_TargetContainsMergedCells="Target range should not have merged cells.",t.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",t.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",t.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",t.Exp_ChangeMergedCell="Cannot change part of merged cell.",t.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",t.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",t.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",t.Exp_RangeIsNull="range is null",t.Exp_ChangePartOfArray="Cannot change part of an array."},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(e,r,t){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),n(t("./dist/plugins/formulaTextbox/formulatextbox.js")),n(t("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js")),t("./dist/plugins/formulaTextbox/formulatextbox-event.js"),t("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),t("./dist/plugins/formulaTextbox/formulatextbox-render.js")},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(e,t,r){"use strict";var c,h,n;function i(e){var t=c.Ul.Nl("textarea");return c.GC$(t).css({display:"none"}),c.GC$(e).append(t),t}function o(){}function a(){var e=this;e.nT=-1,e.Mk=-1,e._text="",e.Q2=-1,e.kj=null,e.MH=!1,e.R2=-1,e.I0=null,e.OC=null,e.f1=null}Object.defineProperty(t,"__esModule",{value:!0}),c=r("Core"),h=r("./dist/plugins/formulaTextbox/formulatextbox.js"),t._createEditorElement=i,a.prototype.$b=function(){var e=this;e.S2(),e.nT=-1,e.Mk=-1,e._text="",e.Q2=-1,e.MH=!1,e.R2=-1,e.kj=null,e.OC=null,e.f1=null},a.prototype.S2=function(){var e,t,r=this;r.kj.Js||(e=r.kj.getCellType(r.nT,r.Mk),t={sheet:r.kj,row:r.nT,col:r.Mk,sheetArea:3},r.I0&&r.I0.firstChild&&e.deactivateEditor(r.I0.firstChild.firstChild,t)),c.GC$(r.I0).remove(),r.I0=null},a.prototype.T2=function(e){var t=this,r=e._formulaTextBox;r&&(t._text=r.text(),t.nT=e.getActiveRowIndex(),t.Mk=e.getActiveColumnIndex(),t.Q2=r.caret(),t.MH=r.MH,t.R2=r.C1(),t._isSelectMode=r._isSelectMode,t.C5=r.C5,t.Nfa=r.Nfa,t.kj=e,t.OC=e.parent,t.f1=e._eventHandler.bG())},a.prototype.VF=function(e){e._formulaTextBox&&(this._text=e._formulaTextBox.text(),this.Q2=e._formulaTextBox.caret(),this.MH=e._formulaTextBox.MH,this.R2=e._formulaTextBox.C1())},a.prototype.U2=function(e){var t=e._formulaTextBox;t&&(t._isSelectMode=this._isSelectMode,t.C5=this.C5,t.Nfa=this.Nfa,t.text(this._text),t.caret(this.Q2),this.MH&&(t.B1(),t.C1(this.R2)))},a.prototype.V2=function(e){var t,r=e.oldSheet,n=r&&r._formulaTextBox;if(n)if(n.close(),(!this.kj||this.kj.Js)&&n.M0()||this.C5!==n.C5){this.T2(r),t=r.getValue(r.Jl,r.Kl,3),r.suspendEvent();try{if(!r.endEdit(!0))return}finally{r.resumeEvent()}r.setValue(r.Jl,r.Kl,t,3,!0),r._editorStatus=1,e.needTriggerSheetChange=!1}else this._text&&(this.VF(r),n.destroy(),r._formulaTextBox=null,e.needTriggerSheetChange=!1)},a.prototype.W2=function(e){var t,r=e.oldSheet,n=e.newSheet,o=this;n.Js||(o.I0&&""===o._text&&(r.GJ(),o.$b()),o._text&&o.kj===n?(n._editorStatus=0,n.zt(),n.suspendEvent(),o._isSelectMode?(t=i(n.parent._host),h._attachFormulaTextBox(n,t),n._editorStatus=2,n._render._paintFormulaTextBox()):n.startEdit(!1),n.resumeEvent(),o.U2(n),o.VK(n,o.nT,o.Mk),r.GJ(),o.$b()):o._text&&!o.I0?(n._editorStatus=1,r._editorStatus=1,o.X2(n),n.EJ()):o._text&&o.kj!==n&&(n._editorStatus=1,r._editorStatus=1,o.X2(n),r.GJ(),n.EJ()))},a.prototype.X2=function(e){var t,r,n,o,i,a,s,l=this,u=l.kj;u.Js||(t=l.nT,r=l.Mk,n=u.getCellType(t,r),o={sheet:u,row:t,col:r,sheetArea:3,canvasOffset:this.f1},n.isImeAware(o)&&(e._editorStatus=1,i=n._createCellTypeElement(o),l.I0&&l.S2(),l.I0=i,c.GC$(i).css("position","absolute"),a=u.getCellRect(t,r),c.GC$(i).attr("id","across"),s=u.getActualStyle(t,r),n._activateEditorWrapper(i,s,a,o),(l.OC&&l.OC.getHost()||document.body).insertBefore(i,null),l._isSelectMode&&c.GC$(i).css({display:"none"}),h._attachFormulaTextBox(e,n.getEditingElement(),!0),i.firstChild&&!l._isSelectMode&&n.focus(i.firstChild.firstChild),l.U2(e),n._updateEditorWrapper(i,s,a,o)))},a.prototype.VK=function(e,t,r){var n,o=e.getCellType(t,r),i=e._editor,a=e.am(),s=e.getActualStyle(t,r),l=e.getCellRect(t,r);l&&0<l.width&&0<l.height&&l.x>=a.kt&&l.y>=a.nt&&l.x+l.width<=a.lt+a.js&&l.y+l.height<=a.ot+a.gs&&(n={sheet:e,row:t,col:r,sheetArea:3},i&&i.parentNode&&o._updateEditorWrapper(i.parentNode.parentNode,s,l,n,!0))},n=a,o.Q0=function(e,t){o.H0||(o.H0=new n),o.H0.V2(t)},o.R0=function(e,t){o.H0||(o.H0=new n),o.H0.W2(t)},t.G0=o},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(e,t,r){"use strict";var w,n,v,i,S,y;function x(e){var t=e._formulaTextBox,r=e._eventHandler;return t.MH?r.E2:r.E2={anchorRow:e.Jl,anchorCol:e.Kl,leadingRow:e.Qr,leadingCol:e.Rr}}function s(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b=e._formulaTextBox,y=e.parent,C=y&&y.options;if(b&&b.M0()&&C&&C.allowUserEditFormula&&C.enableFormulaTextbox){switch(a=(i=x(e)).anchorRow,s=i.anchorCol,l=i.leadingRow,u=i.leadingCol,S(n)&&(n=a),S(o)&&(o=s),c=e._eventHandler,t){case 3:g=e.iy(n,o,r,l);break;case 4:g=e.hy(n,o,r,l);break;case 1:g=e.HJ(n,o,r,u);break;case 2:g=e.LJ(n,o,r,u);break;case 5:g=e.OJ();break;case 6:g=e.NJ()}g&&(h=g.row,f=g.col,d=g.leadingCellRow?g.leadingCellRow:h,p=g.leadingCellCol?g.leadingCellCol:f,e.IJ(h,f)&&(i.anchorRow=h,i.anchorCol=f,i.leadingRow=d,i.leadingCol=p,(m=v._rangeToString(c.kj,w.kf(h,f,1,1)))&&b._appendRange(m,!1,!0),0<=h&&0<=f&&e.Yq(h,f)))}}function l(){}Object.defineProperty(t,"__esModule",{value:!0}),w=r("Core"),n=r("@grapecity/js-sheets-common"),v=r("./dist/plugins/formulaTextbox/formulatextbox.js"),i=r("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),S=n.Common.j.Fa,w.Commands.Ox=function(e,t){if(e){if(2===e._editorStatus)return!1;var r=e._formulaTextBox;return r&&r.M0()?s(e,t,!1):(r&&(e=y.O2(e)),e.yx(t,!1)),!0}return!1},w.Commands.Qx=function(e,t,r,n){if(e){if(2===e._editorStatus)return!1;var o=e._formulaTextBox;return o&&o.M0()?s(e,t,!1,r,n):(o&&(e=y.O2(e)),e.yx(t,!1,r,n)),!0}return!1},w.Commands.Rx=function(e,t,r){if(e){if(2===e._editorStatus)return!1;var n=e._formulaTextBox;return n&&n.M0()?(i=t,a=r,g=(o=e)._formulaTextBox,m=o.parent,b=m&&m.options,g&&g.M0()&&b&&b.allowUserEditFormula&&b.enableFormulaTextbox&&(s=o._eventHandler,u=(l=x(o)).anchorRow,c=l.anchorCol,(h=g.MH?(f=g.m1(),v._stringToRange(o,f.text)):w.kf(u,c,1,1))&&(d=o.UJ(h,i,a,u,c),(p=v._rangeToString(s.kj,d))&&g._appendRange(p,!0,!1))),!0):(n&&(e=y.O2(e)),!!e.endEdit()&&(e.Sx(t,r),!0))}var o,i,a,s,l,u,c,h,f,d,p,g,m,b;return!1},l.fv=function(e){return l.O2(e)},l.Xx=function(e){return l.O2(e)},l.Yx=function(e){return l.O2(e)},l.O2=function(e){var t=e,r=i.G0.H0;return r&&r._text&&(t=r.kj,l.G2(t)),t},l.G2=function(e,t){var r,n;void 0===t&&(t=!0),r=e.parent,(n=i.G0.H0)&&n._text&&r.hw(e,t)},l.Zx=function(e,t,r){var n,o,i=!1,a=e._formulaTextBox;return a&&a.M0()?((n=x(e)).anchorRow=t,n.leadingRow=t,(o=v._rangeToString(e,w.kf(n.anchorRow,n.anchorCol,1,1)))&&a._appendRange(o,!1,!0),e.mq(r),i=!0):a&&(e=l.O2(e)),{sheet:e,r:i}},l._x=function(e,t,r){var n,o,i=!1,a=e._formulaTextBox;return a&&a.M0()?((n=x(e)).anchorRow=t,n.leadingRow=t,(o=v._rangeToString(e,w.kf(n.anchorRow,n.anchorCol,1,1)))&&a._appendRange(o,!1,!0),e.mq(r),i=!0):a&&(e=l.O2(e)),{sheet:e,r:i}},l.pzb=function(e,t){var r=!1,n=t?5:6,o=e._formulaTextBox,i=e.Jl,a=e.Kl;return o&&o.M0()?(o.MH||(e._eventHandler.E2={anchorRow:i,anchorCol:a,leadingRow:e.Qr,leadingCol:e.Rr}),s(e,n,!1,i,a),r=!0):o&&(e=l.O2(e)),{sheet:e,r:r}},l.ay=function(e){return l.pzb(e,!0)},l.by=function(e){return l.pzb(e,!1)},l.ey=function(e){return l.O2(e)},l.gy=function(e){return l.O2(e)},l.jy=function(e){var t,r,n,o=i.G0.H0;if(o&&o._text&&(e=o.kj,t=o.nT,r=o.Mk,l.G2(e,!1),v._detachFormulaTextBox(e),e.Sr(t,r,void 0,void 0,1),e.isEditing()))return n=e.getValue(t,r,3),!!e._endEditImp(!0,void 0,void 0,!0)&&(e.setValue(t,r,n,3,!0),!0)},y=l,w.Commands.Wx=y},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(e,t,r){"use strict";var v,p,g,S,b,n,C,w;Object.defineProperty(t,"__esModule",{value:!0}),v=r("Core"),p=r("@grapecity/js-calc"),g=r("SheetsCalc"),S=r("./dist/plugins/formulaTextbox/formulatextbox.js"),b=r("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),n=v.GC$.extend,C=Math.max,w=Math.min,n(v.iI.prototype,{D2:function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y=this,C=y.kj,w=C._formulaTextBox;w&&(y.Kka(),t=C.frozenRowCount(),r=C.frozenColumnCount(),(n=w.MH)&&y.E2||(y.E2={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),o=C.getRowCount(),i=C.getColumnCount(),a=e.hitTestType,s=e.row,l=e.col,u=y.shift,c=y.ctrl,f=(h=y.E2).anchorRow,d=h.anchorCol,g=p=-1,0===a?(p=t?C.ar():C.lq,g=r?C.$q():C.qq,m=v.kf(-1,-1,-1,-1),w._appendRange(S._rangeToString(C,m),u,!c),y._isWorking=!0):1===a?(p=t?C.ar():C.lq,g=l,m=C.Jx(0,l,o-1,l,!0),u&&0<=d&&(m=C.Jx(0,l,o-1,d,!0)),m=v.kf(-1,m.col,-1,m.colCount),w._appendRange(S._rangeToString(C,m),u,!c),y._isWorking=!0):2===a?(p=s,g=r?C.$q():C.qq,m=C.Jx(s,0,s,i-1,!0),u&&0<=f&&(m=C.Jx(s,0,f,i-1,!0)),m=v.kf(m.row,-1,m.rowCount,-1),w._appendRange(S._rangeToString(C,m),u,!c),y._isWorking=!0):3===a&&(g=l,void 0!==(p=s)&&void 0!==l&&((b=e.tableSelectInfo&&e.tableSelectInfo.tableSelection)?m=b:(m=C.Jx(s,l,s,l,!0),m=v.kf(m.row,m.col,1,1),u&&0<=f&&0<=d&&(m=C.Jx(s,l,f,d,!0))),w._appendRange(S._rangeToString(C,m),u,!c)),y._isWorking=!0),y.DG=y._isWorking,u&&n||(h.anchorRow=p,h.anchorCol=g,h.leadingRow=p,h.leadingCol=g),y.rG={KG:e.rowViewportIndex,MG:e.colViewportIndex,sG:e.hitTestType},y.qG())},F2:function(e){var t,r,n=!1,o=b.G0.H0;if(o&&o.I0)if(t=o.kj,(r=e._formulaTextBox)&&t.setFormula(o.nT,o.Mk,r.text()),t!==e){if(v.Commands.Wx.G2(t),!t.endEdit())return;n=!0}else r&&(r.destroy(),e._formulaTextBox=null),o.$b();return n},EG:function(){var e,t=this.rG;t&&this._isWorking&&(3===(e=t.sG)?this.H2():2===e?this.I2():1===e&&this.J2())},H2:function(){var e,t,r,n=this.E2,o=n.anchorRow,i=n.anchorCol,a=this.fH(),s=this.gH();0<=o&&0<=i&&0<=a&&0<=s&&(t=(e=this.kj).Jx(a,s,o,i,!0),(r=S._rangeToString(e,t))&&e._formulaTextBox._appendRange(r,!0,!1)),this.NG()},I2:function(){var e,t,r,n=this.E2.anchorRow,o=this.fH();0<=n&&0<=o&&(t=(e=this.kj).Jx(o,0,n,e.getColumnCount()-1,!0),t=v.kf(t.row,-1,t.rowCount,-1),(r=S._rangeToString(e,t))&&e._formulaTextBox._appendRange(r,!0,!1)),this.NG()},J2:function(){var e,t,r,n=this.E2.anchorCol,o=this.gH();0<=n&&0<=o&&(t=(e=this.kj).Jx(0,o,e.getRowCount()-1,n,!0),t=v.kf(-1,t.col,-1,t.colCount),(r=S._rangeToString(e,t))&&e._formulaTextBox._appendRange(r,!0,!1)),this.NG()},yH:function(){this.RG(),this.rG=null,this._isWorking=!1,this.DG=!1},iG:function(e){var t,r,n,o,i,a,s,l,u=this.kj,c=this._oa(),h=e.formulaRangeHitInfo;h&&h.inBorder&&c&&(c.MH&&c._stopAppending(),c.close(),!(r=(t=h.paramRange)&&t.text)||(n=S._stringToRange(u,r))&&(this.Kka(),o=u.Tq(n),i=e.row,a=e.col,i<o.row&&(i=o.row),i>=o.row+o.rowCount&&(i=o.row+o.rowCount-1),a<o.col&&(a=o.col),a>=o.col+o.colCount&&(a=o.col+o.colCount-1),s=i-o.row,l=a-o.col,this._isWorking=!0,this.FG=!0,this.K2={paramRange:t,fromRange:n,rowOffset:s,colOffset:l},this.rG={KG:e.rowViewportIndex,MG:e.colViewportIndex,sG:e.hitTestType},this.qG()))},GG:function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y;this._isWorking&&this.FG&&(e=this.fH(),t=this.gH(),0<=e&&0<=t&&(n=(r=this.K2).fromRange,o=r.rowOffset,i=r.colOffset,a=r.toRow,s=r.toCol,l=t,e===a&&l===s||(r.toRow=e,r.toCol=l,c=(u=this.kj).getRowCount(),h=u.getColumnCount(),f=n.row,d=n.col,p=n.rowCount,g=n.colCount,m=f<0?-1:C(0,w(c-p,e-o)),b=d<0?-1:C(0,w(h-g,t-i)),(y=S._rangeToString(u,v.kf(m,b,p,g)))&&this._oa()._repalceRange(r.paramRange.index,y,!0))),this.NG())},zH:function(){var e;this.RG(),this._isWorking=!1,this.FG=!1,this.K2=null,(e=this._oa()).onRangeMoved&&e.onRangeMoved()},jG:function(e){var t,r,n,o,i,a,s,l,u,c,h,f=this.kj,d=this._oa(),p=e.formulaRangeHitInfo;if(p&&d&&(d.MH&&d._stopAppending(),r=(t=p.paramRange)&&t.text,t&&r&&(n=S._stringToRange(f,r)))){if(this.Kka(),o=n.row,i=n.row<0?-1:n.row+n.rowCount-1,a=n.col,s=n.col<0?-1:n.col+n.colCount-1,p.inTopLeft)l=i,u=s,c=o,h=a;else if(p.inTopRight)l=i,u=a,c=o,h=s;else if(p.inBottomLeft)l=o,u=s,c=i,h=a;else{if(!p.inBottomRight)return;l=o,u=a,c=i,h=s}this._isWorking=!0,this.HG=!0,this.L2={paramRange:t,anchorRow:l,anchorCol:u,toRow:c,toCol:h},this.rG={KG:e.rowViewportIndex,MG:e.colViewportIndex,sG:e.hitTestType},this.qG()}},kG:function(e,t){var r=e._formulaTextBox;return r&&r.M0()?(this.D2(t),!0):!!this.F2(e)},IG:function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y;this._isWorking&&this.HG&&(e=this.fH(),t=this.gH(),0<=e&&0<=t&&(n=(r=this.L2).anchorRow,o=r.anchorCol,i=r.toRow,a=r.toCol,l=t,(s=e)===i&&l===a||(r.toRow=s,r.toCol=l,c=(u=this.kj).getRowCount(),h=u.getColumnCount(),d=o<0?h-1:o,p=w(f=n<0?c-1:n,s),g=w(d,l),m=C(f,s)-p+1,b=C(d,l)-g+1,0===p&&m===c&&(m=p=-1),0===g&&b===h&&(b=g=-1),(y=S._rangeToString(u,v.kf(p,g,m,b)))&&this._oa()._repalceRange(r.paramRange.index,y,!0))),this.NG())},AH:function(){var e,t;this.RG(),this._isWorking=!1,this.HG=!1,this.L2=null,!(e=this._oa())._isSelectMode||-(e.W0=1)!==(t=e.text().lastIndexOf(",",e.caret()))&&(e.W0=t+1),e.onRangeResized&&e.onRangeResized()},vr:function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p=this.kj,g=this._oa(),m=g&&g.l1();if(!m||0===m.length||!g.UQa)return null;if(n=e.rowViewportIndex,o=e.colViewportIndex,this.qH(n,o,t,r))return null;for(l=m.length-1;0<=l;l--)if(!1!==(i=m[l]).allowDrag&&((!(u=b.G0.H0)||!u._text)&&(a=S._stringToRange(p,i.text)))){if(c=(s=p.getRangeRect(n,o,a)).x-2,h=s.x+s.width+1-5,f=s.y-2,d=s.y+s.height+1-5,5+c<=t&&t<h&&(1+f<=r&&r<=3+f||1+d<=r&&r<=3+d))return{paramRange:i,inBorder:!0};if(5+f<=r&&r<d&&(1+c<=t&&t<=3+c||1+h<=t&&t<=3+h))return{paramRange:i,inBorder:!0};if(h<=t&&t<5+h&&d<=r&&r<5+d)return{paramRange:i,inBottomRight:!0};if(c<=t&&t<5+c&&d<=r&&r<5+d)return{paramRange:i,inBottomLeft:!0};if(h<=t&&t<5+h&&f<=r&&r<5+f)return{paramRange:i,inTopRight:!0};if(c<=t&&t<5+c&&f<=r&&r<5+f)return{paramRange:i,inTopLeft:!0}}return null},_oa:function(){var e=this.kj;return e._formulaTextBox||e._formulaTextBoxForChart},ly:function(){var e,t,r,n,o,i,a,s,l,u,c,h,f=this.kj,d=f._formulaTextBox;if(d)if(e=f.Jl,t=f.Kl,n=(r=f.parent)&&1===r.options.referenceStyle,o=new g.SheetParserContext(f,n,p._createCellIdentity(e,t)),i=new p.Parser,d.MH)for(l=d.u1(),u=0;u<l.length;u++){a=l[u];try{s=i.parse(o,a.text)}catch(e){s=null}s&&1===s.type&&(this.M2(s,e,t,!0,!0),d._repalceRange(a.index,i.unparse(o,s)))}else{if(!(a=d.m1()))return;try{s=i.parse(o,a.text)}catch(e){s=null}if(!s)return;1!==s.type||s.sf()?1===s.type&&(this.N2(s,e,t),d._repalceRange(a.index,i.unparse(o,s))):(c=a.textOffset+a.text.lastIndexOf(":"),d.caret()<=c?(this.M2(s,e,t,!0,!1),h=i.unparse(o,s),d._repalceRange(a.index,h),d.caret(a.textOffset+h.lastIndexOf(":"))):(this.M2(s,e,t,!1,!0),d._repalceRange(a.index,i.unparse(o,s))))}},M2:function(e,t,r,n,o){var i,a,s=e.rowRelative,l=e.columnRelative;n&&(s&&l?(e.rowRelative=!1,e.columnRelative=!1,e.row+=t,e.column+=r):!s&&l?(e.rowRelative=!0,e.columnRelative=!1,e.row-=t,e.column+=r):(e.columnRelative=!0,e.column-=r)),i=e.endRowRelative,a=e.endColumnRelative,o&&(i&&a?(e.endRowRelative=!1,e.endColumnRelative=!1,e.endRow+=t,e.endColumn+=r):!i&&a?(e.endRowRelative=!0,e.endColumnRelative=!1,e.endRow-=t,e.endColumn+=r):(e.endColumnRelative=!0,e.endColumn-=r))},N2:function(e,t,r){var n=e.rowRelative,o=e.columnRelative;n&&o?(e.rowRelative=!1,e.columnRelative=!1,e.row+=t,e.column+=r):!n&&o?(e.rowRelative=!0,e.columnRelative=!1,e.row-=t,e.column+=r):(e.columnRelative=!0,e.column-=r)},Kka:function(){var e,t=this.kj._formulaTextBox;!t||(e=t._host)&&t.Cia(e)&&t.Jka()}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(e,t,r){"use strict";var n,H,G,U,W,o,V;function u(e,r,t,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_=e.kj,P=_._eventHandler,L=i&&i.l1(),O=L&&L.length,B=qe&&qe._legacyWynbi&&qe._legacyWynbi.spreadChartEditState&&qe._legacyWynbi.spreadChartEditState.pivotTableManager,j=[];if(B&&(a=B.getPivotTableBySheet(e.kj))){if(O=0,!(s=a.text2Ranges(i.text(),_.name()))||!s.length)return;j=s}if(!(O<=0&&j.length<=0)&&(l=e.VI(t,n,o))){for(r.save(),r.rect(l.x,l.y,l.width,l.height),r.clip(),r.beginPath(),e.XI(t,n,j,l).forEach(function(e,t){e&&0!==e.width&&0!==e.height&&(r.beginPath(),r.lineWidth=2,r.strokeStyle=W.DEFAULT_RANGE_COLORS[t%W.DEFAULT_RANGE_COLORS.length],r.rect(e.x+1,e.y+1,e.width-3,e.height-3),r.stroke())}),u=[],c=P.isFormulaRangeHoving,h=P.tH,f=P.FG,d=P.K2,p=P.HG,g=P.L2,v=0;v<O;v++)if(b=(m=L[v]).text,y=m.ranges&&0<m.ranges.length?m.ranges:[G._stringToRange(_,b)]){if((S=U.G0.H0)&&S.kj)if(V.Bb(b,"!")){if(x=V.Ib(b,"!"),_.name()!==x&&"'"+_.name()+"'"!==x)continue}else if(T=V.Ib(b,"["),A=_.tables,!(_.getCustomNames()[T]||A&&A.findByName(T)))continue;for(C=e.XI(t,n,y,l),k=0;k<C.length;k++)(M=C[k])&&0<M.width&&0<M.height&&(w=i.o1(v),i.t1(m)?(c&&h.paramRange.index===v&&(r.beginPath(),r.lineWidth=2,r.strokeStyle=w,r.rect(M.x+1,M.y+1,M.width-3,M.height-3),r.stroke()),e.fJ(r,M,w)):(c&&h.paramRange.index===v||f&&d.paramRange.index===v||p&&g.paramRange.index===v?(r.beginPath(),r.lineWidth=2,r.strokeStyle=w,r.rect(M.x+1,M.y+1,M.width-3,M.height-3)):(r.beginPath(),r.lineWidth=2,r.strokeStyle=w,r.rect(M.x,M.y,M.width-1,M.height-1)),r.stroke()),i.n1(m)&&((I=H.Common.pc.ec(w)).a=.1,r.beginPath(),r.fillStyle=H.Common.pc.bc(I),r.fillRect(M.x+1,M.y+1,M.width-3,M.height-3)),u.push({rect:M,color:w,allowDrag:m.allowDrag}))}if(0<u.length&&i.UQa)for(E=u.length,v=0;v<E;v++)M=u[v].rect,w=u[v].color,R=M.x-2,D=M.x+M.width+1-5,N=M.y-2,F=M.y+M.height+1-5,!1!==u[v].allowDrag&&((S=U.G0.H0)&&S._text||(r.beginPath(),r.fillStyle=w,r.fillRect(R,N,5,5),r.fillRect(D,N,5,5),r.fillRect(R,F,5,5),r.fillRect(D,F,5,5)));r.beginPath(),r.restore()}}Object.defineProperty(t,"__esModule",{value:!0}),n=r("Core"),H=r("@grapecity/js-sheets-common"),G=r("./dist/plugins/formulaTextbox/formulatextbox.js"),U=r("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),W=r("./dist/plugins/formulaTextbox/formulatextbox.js"),o=n.GC$.extend,V=H.Common.u,o(n.oJ.prototype,{_paintFormulaTextBox:function(){var e,t,r=this.kj;0<r.Xq||(e=r.am(),t=this.bm(),this.Mx(e.x,e.y,e.width,e.height),this.Pw(t))}}),n.Worksheet.$n("formulatextboxrender",{paintAdornment:function(e){var t,r,n,o=e.ctx,i=e.clipRect,a=this._render,s=this.am(),l=this._eventHandler._oa();if(l)for(r=0;r<=2;r++)for(n=0;n<=2;n++)(t=s.Ft(r,n))&&0!==t.width&&0!==t.height&&u(a,o,r,n,i,l)}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(e,c,t){"use strict";var d,m,b,v,S,C,u,p,r,x,T,A,w,y,n,h,g,o,i,f,a,s,k,M,I,E,l,R,D,N,F,_,P,L;function O(e){return e.getActiveSheet()}function B(e){var r,n=[];return v.GC$.each(e,function(e,t){(r=t.description())&&(r.name=e,n.push(r))}),n}function j(e){var t=d.getMapping()&&d.getMapping().builtInFunctionsMapping;return t&&t[e]&&t[e].alias||e}function H(i,e,t){var r,n,a,s,l,o,u=i.parent,c=u&&u.options;(e&&c&&c.allowUserEditFormula&&c.enableFormulaTextbox||t)&&(i._formulaTextBox&&i._formulaTextBox.destroy(),i._formulaTextBox=new L(e,null,u),r=i._formulaTextBox.text(),n=i.getFormulaInformation(i.Jl,i.Kl),"="!==r[0]||n&&n.hasFormula||(r="'"+r,i._formulaTextBox.text(r)),a=i._formulaTextBox,s=i._eventHandler,l=i._render,a.bind("AppendStarted",function(){a.close();var e=i._editorStatus;1!==e&&(i._editorStatus=1,i._raiseEditorStatusChanged(e,1))}),a.bind("AppendEnded",function(){l._paintFormulaTextBox()}),a.bind(k,function(e,t){if(!i.Js){if(t&&t.type!==f){s._updateEditingEditor(t);var r=i.Jl,n=i.Kl,o=i.getCellType(r,n);i.Wq(v.Events.EditChange,{sheet:i,sheetName:i.name(),row:r,col:n,editingText:o.getEditorValue(i._editor)})}l._paintFormulaTextBox(),i.Wq(v.Events.FormulaTextBoxTextChanged,{sheet:i,sheetName:i.name(),text:a.text()})}}),a.bind("CaretChanged",function(){l._paintFormulaTextBox(),i.Wq(v.Events.FormulaTextBoxCaretChanged,{sheet:i,sheetName:i.name(),caret:a.caret()})}),a.add((o=[],v.GC$.each(d.sR()._h,function(e,t){d.Functions.bi[e]&&(t.name=e,o.push(t))}),o)),a.add(B(d.Functions.ci)),a.add(B(i._functions).concat(B(u._functions))),l._paintFormulaTextBox())}function G(e){e._formulaTextBox&&(e._formulaTextBox.destroy(),e._formulaTextBox=C,e._render._paintFormulaTextBox());var t=e.parent&&e.parent.CF;A.activeElement===(t&&t._host)&&e._eventHandler.Qq()}function U(e){var t,r=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE"];for(t=0;t<r.length;t++)if(e===r[t])return 1}function W(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C=this,w=e;if(C._isSelectMode=!1,C.Nfa=!1,C._needSheetName=!0,C.Ac=[],C.Bc=[],C._gc=[],t&&t.rangeSelectMode&&(!0===t.absoluteReference&&(C.Nfa=!0),!1===t.needSheetName&&(C._needSheetName=!1),C._isSelectMode=!0,C.D5=!1,C.E5=!1,C.cga=e,a=e,s=C,(y=v.GC$(a)).attr("contenteditable","false"),l=x("table"),v.GC$(l).css("border-spacing","0"),v.GC$(l).css("width","100%"),y.append(l),u=x("tbody"),l.appendChild(u),c=document.createElement("tr"),u.appendChild(c),h=document.createElement("td"),v.GC$(h).css("padding-right","0px"),c.appendChild(h),f=document.createElement("td"),v.GC$(f).css("width","23px"),v.GC$(f).css("padding-right","0px"),c.appendChild(f),d=y.width()-v.GC$(f).width(),p=x("div"),g=x("div"),v.GC$(g).width(d),v.GC$(g).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),g.appendChild(p),h.appendChild(g),m=x("div"),f.appendChild(m),v.GC$(p).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),v.GC$(p).width(d),v.GC$(p).attr("contenteditable","true"),v.GC$(p).attr("spellcheck","false"),(b=v.GC$(m)).css({display:"block",float:"right",width:"23px",height:"23px",background:E,"background-repeat":"no-repeat"}),b.bind("click",function(){s.D5?(s.OC.Wq("RangeSelectEnding",s),s.endSelectMode()):s.startSelectMode()}),w=(n={contentDiv:p,button:m}).contentDiv,C.sia=n.button,C.tia=e,C.C5=P,P++),C.UQa=!0,C.ad(r&&r.getHost()||A.body),w&&C.N0(w),r&&(C.O0=!0,C.P0(r),C.OC._unbind(v.Events.FormulatextboxActiveSheetChanging,S.G0.Q0),C.OC._bind(v.Events.FormulatextboxActiveSheetChanging,S.G0.Q0),C.OC._unbind(v.Events.FormulatextboxActiveSheetChanged,S.G0.R0),C.OC._bind(v.Events.FormulatextboxActiveSheetChanged,S.G0.R0)),o=C.text(),C._tokens=C.T0(o),C.Cia(w)){C.V0(C._tokens);try{(i=T.getSelection()).selectAllChildren(w),0<i.rangeCount&&i.collapseToEnd()}catch(e){}v.GC$(C._host).data(D,o)}}function V(e){return"gcAttachedFormulaTextBox"===e.target.getAttribute("gcuielement")}Object.defineProperty(c,"__esModule",{value:!0}),d=t("@grapecity/js-calc"),m=t("SheetsCalc"),b=t("@grapecity/js-sheets-common"),v=t("Core"),S=t("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),C=null,u=Math.max,p=Math.min,r=v.GC$.extend,x=v.Ul.Nl,T=window,A=document,w=b.Common.u,y=v.Ul.nl,n=v.Ul.Ml,h=n.msie&&parseInt(n.version,10)<10,g=w.Nb,o="formulatextbox",i="gcUIElement",f="input",a=".gcFormulaTextBoxInternal",s=".gcFormulaTextBox",k="TextChanged",M="CaretChanged",I={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},c.DEFAULT_RANGE_COLORS=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],E='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',l="background",R="background-repeat",D="text-before",N="caret-before",c._rangeToString=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g;return t?(r=qe&&qe._legacyWynbi&&qe._legacyWynbi.spreadChartEditState&&qe._legacyWynbi.spreadChartEditState.pivotTableManager)&&(n=r.getPivotTableBySheet(e))?1===t.colCount&&1===t.rowCount?n.rangeToFormula(t.row,t.col):"":(o=e._formulaTextBox,s=(a=(i=S.G0.H0)&&i.kj||e).Jl,l=a.Kl,c=(u=e.parent)&&1===u.options.referenceStyle,h=15,e._formulaTextBox&&e._formulaTextBox.Nfa&&(h=0),t.row<0&&t.col<0&&(t=new v.Range(0,-1,e.getRowCount(),-1)),d=(f=e.tables)&&f.find(t.row,t.col),i&&i.Nfa&&(h=0),o&&!o._isSelectMode&&function(e,t){if(e){var r=!1,n=!1;if(1===t.rowCount){if(e.hasHeadersRow()&&t.row===e.startRow())return 1;if(e.hasTotalsRow()&&t.row===e.endRow())return 1}else e.hasHeadersRow()&&t.row===e.startRow()&&(t.rowCount===e.dataRange().rowCount+1&&(r=!0),e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1+1&&(r=!0)),t.row===e.dataRange().row&&(t.rowCount===e.dataRange().rowCount&&(r=!0),e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1&&(r=!0));return t.col+t.colCount<=e.startColumn()+e.dataRange().colCount&&(n=!0),r&&n}}(d,t)?(i&&i._text&&i.kj!==e&&(s=l=-1),m.rangeToFormulaWithStructReference(e,t,s,l,h,c,d)):(p=m.rangeToFormula(t,s,l,h,c),(i&&i._text||e._formulaTextBox&&e._formulaTextBox._isSelectMode&&e._formulaTextBox._needSheetName)&&(g=e.name(),p=(m.jma(g.split(""),!1)?g:"'"+g.replace(/'/g,"''")+"'")+"!"+p),p)):C},v.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",v.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",T.Yl.km.push(function(e,t){var r,n=S.G0;t||!e.endEdit||!n||(r=n.H0)&&r.I0&&e._formulaTextBox&&(e._formulaTextBox&&e._formulaTextBox.destroy(),e._formulaTextBox=C,r.$b())}),c._attachFormulaTextBox=H,c._detachFormulaTextBox=G,c._stringToRange=function(e,t){var r,n,o,i;if(!t)return C;o=(n=(r=S.G0.H0)&&r.kj||e).Jl,i=n.Kl;try{return m.formulaToRange(e,t,o,i)}catch(e){}return C},r(v.DC.prototype,{bE:function(e){return!(e&&e._formulaTextBox&&e._formulaTextBox.M0())}}),v.Worksheet.$n(o,{startEdit:function(e){H(this,e.element)},endEdit:function(){G(this)}}),F=v.DC.prototype,_=F.dE,v.DC.$n(o,{preProcessMouseDbClick:function(e){var t=O(this.OC),r=t?t._formulaTextBox:void 0,n=r&&r.M0(),o=S.G0.H0;n?e.r=!1:o&&o.I0&&o.$b()}}),F.dE=function(){var e=O(this.OC)._formulaTextBox,t=S.G0.H0,r=t&&t._text;return _.call(this)&&!r&&!e},P=1,W.prototype.j5=function(e){var t,r,n,o,i,a,s=this;s._startingEdit(),s._startEdit(),s.E5=!0,t=S._createEditorElement(s.OC._host),(r=s.a1()).suspendPaint(),H(r,t,!0),(n=r._formulaTextBox)._isSelectMode=!0,n.C5=s.C5,n.Nfa=s.Nfa,n._needSheetName=s._needSheetName,e&&(s.text(e),s.caret(e.length)),o=s.text(),(i=s.caret())<=0&&(i=o.length),s.focus(),s.caret(i),s.MH=!0,-(s.W0=1)!==(a=o.lastIndexOf(",",i))&&(s.W0=a+1),o||(s.text("="),o="=",s.caret(1),i=1),0!==o.indexOf("=")&&(o="="+o,i++),n.text(o),n.caret(i),n.MH=s.MH,n.W0=s.W0,r.resumePaint()},W.prototype.startSelectMode=function(e){var t=e;t&&0!==t.indexOf("=")&&(t="="+t),this._isSelectMode=!0,this.D5=!0,v.GC$(this.sia).css([l,R],['url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAItSURBVDhPY3hILqBYZ/eqVxDUuvRl/cKXZbNf5E59ntT3DIgi2p/6NT5xq35iV/YYiCyLHkG0IHQuOvR/1t6/03b+mbD1d/eGXy2rf9Yu/wFE5Yu+Fc79mjXza+rUz0BkmHoWogXFTqCFVfNfQmwLa3vqVfsYiBzA9sCRftIJiBaozuYZO+89eAREt+4+AKIbt+9fvXkPiC5du3P28s0T564dOnV579Hz2w6cSaqcDdEC1Vk/ZQtQQ2vv7MaumbUd0+o6ZzT3zmnunQ1kF9T0pZe2J+U3x+U0bNx9MqZ4CkQLVGdB6xKgDaX1/b/+/PnyE4E+ff/z8uPvR29/3X35MzCxfPW2o2HZPRAtUJ2lXSuADkstann/9febz7/ff/3zLDP4Spj9Pjs1oE6gthvPfnpEFS7deDAwrRWiBaozv3kh0D8RadVAlFvZvWLDrjvRrk+bCrdpCS1ZsyOpoMU9ssA5NBeo0zuhDqIFqjO9Zubhk1eA6MT5G+eu3H78/PVFX/OnxQnrNQTuPnyx9+hFoA+B2uav2ecaVQ7RAtUZVzQBKH3g+KXTl24fdjE44mp4yFbtSYrfGg3+yQocQLTryEWgzgVr9zmEFkK0QHWGZbbvPHQOiI6cvnb5wMENhjJPE30eB1k9dFIDaruy/wAwPoA6563eaxOQDdEC1YkG1hvKrNKVuOEA0nYr2Pp5qA1UAglg1wkEW03lF2kI3wy1xaoNCHDqJAjI1fnwIQDHT83/UVFPcQAAAABJRU5ErkJggg==")',"no-repeat"]),this.j5(t)},W.prototype.endSelectMode=function(){this.D5=!1,this.H5(),v.GC$(this.sia).css([l,R],[E,"no-repeat"])},W.prototype.H5=function(){var e=this.a1();e&&(e._endEditImp(!0,void 0,!0),e.repaint())},W.prototype.rgc=function(e){this._gc=[e]},W.prototype.ahc=function(){return this._gc},W.prototype.destroy=function(){var e=this;e.D5&&e.H5(),e._gc=C,e.MH=!1,e.W0=-1,e.X0(),e.Y0(),v.GC$(e._funcsPopup).remove(),v.GC$(e.$0).remove(),v.GC$(e._0).remove()},W.prototype.bind=function(e,t,r){var n=this._host;n&&e&&(e=e.split(/\s+/).join(s+" "),v.GC$(n).bind(e+s,t,r))},W.prototype.unbind=function(e,t){var r=this._host;r&&e&&(e=e.split(/\s+/).join(s+" "),v.GC$(r).unbind(e+s,t))},W.prototype.unbindAll=function(){var e=this._host;e&&v.GC$(e).unbind(s)},W.prototype.caret=function(e){var t,r,n=this._host;if(n)return t=A.activeElement===n,r=v.GC$(n),0===arguments.length?t?this.b1(n).end:r.data(N):void(e!==this.caret()&&(t?(this.c1(n,e),r.data(N,this.b1(n).end)):r.data(N,e),this.Wq(M,{})))},W.prototype.b1=function(e){var t,r,n,o=-1,i=-1;return this.d1(e)?(o=e.selectionStart,i=e.selectionEnd):this.Cia(e)&&0<(t=T.getSelection()).rangeCount&&((n=(r=t.getRangeAt(0)).cloneRange()).selectNodeContents(e),n.setEnd(r.endContainer,r.endOffset),i=(""+n).length,(n=r.cloneRange()).selectNodeContents(e),n.setEnd(r.startContainer,r.startOffset),o=(""+n).length,n.detach()),{start:o,end:i}},W.prototype.c1=function(e,t){var r,n,o,i;this.d1(e)?e.setSelectionRange(t,t):!this.Cia(e)||(o=this.e1(e,t))&&(r=T.getSelection(),n=A.createRange(),(i=o.node)&&1===i.childNodes.length?n.setStart(i.firstChild,o.offset):i.lastChild&&i.lastChild.length&&n.setStart(i.lastChild,i.lastChild.length),n.collapse(!0),r.removeAllRanges(),r.addRange(n),this._isSelectMode&&(e.parentElement.scrollTop=e.parentElement.scrollHeight))},W.prototype.text=function(e){var t,r,n,o,i,a,s,l=this,u=l._host,c=l.a1();if(!u||!c||c.Js)return"";if(t=l.d1(u),r=l.Cia(u),0===arguments.length){if(n="",t)n=u.value;else if(r){if(0<u.getElementsByClassName("gcsj-func-gray-formula").length)return"";0<=(n=(n=h?v.Ul.Woa(u):u.innerText).replace(/\r\n?/g,"\n")).indexOf("")&&(n=v.Ul.Ika(n,""," "))}return n}null!=e||(e=""),e!==l.text()&&(o=l.mLb(e),l._tokens=o?l.T0(o):l.T0(e),t?u.value=e:r&&(i=l.nLb(l._tokens,e),l.V0(i),l.caret(e.length)),a={},(s=S.G0.H0)&&s._text&&(a={sheet:s.kj,editor:s.I0&&s.I0.firstChild.firstChild,canvasOffset:s.f1}),l.Wq(k,a)),l.oLb&&l.pLb()},W.prototype.autoComplete=function(e){return 0===arguments.length?this.g1:void(this.g1=e)},W.prototype.showHelp=function(e){return 0===arguments.length?this.h1:void(this.h1=e)},W.prototype.add=function(e){var t,r;if(e)if(v.GC$.isArray(e))for(t=e.length,r=0;r<t;r++)this.Sb(e[r]);else this.Sb(e)},W.prototype.Sb=function(e){var t,r,n,o,i=e&&g(j(e.name));if(i){for(r=(t=this.i1).length,n=0;n<r;n++){if((o=g(t[n].name))===i)return;if(i<o)break}t.splice(n,0,e)}},W.prototype.remove=function(e){var t,r,n;if(e)for(e=g(e),r=(t=this.i1).length,n=0;n<r;n++)if(g(t[n].name)===e){t.splice(n,1);break}},W.prototype.workbook=function(e){return 0===arguments.length?this.OC:void(e===C?this._isSelectMode&&this.H5():(this.P0(e),this.j1()))},W.prototype.P0=function(e){e&&(this.OC&&this.Y0(),this._host&&(this.OC=e))},W.prototype.l1=function(){var e,t,r,n=[],o=this._tokens,i=o&&o.length,a=0,s=0;if(0<i)for(r=0;r<i;r++)t=(e=o[r]).text,11===e.type&&(n.push({textOffset:a,text:t,ranges:e.ranges,index:s,allowDrag:e.allowDrag}),s++),a+=t.length;return n},W.prototype.m1=function(){var e,t,r,n,o,i=this._host,a=this.l1();if(i&&a&&0<a.length)for(e=this.caret(),t=a.length,n=r=void 0,o=0;o<t;o++){if((n=(r=a[o]).textOffset)<e&&e<=n+r.text.length)return r;if(e<=n)break}return C},W.prototype.n1=function(e){var t,r,n;return!!e&&(t=this.caret(),r=e.text,(n=e.textOffset)<t&&t<=n+r.length)},W.prototype.o1=function(e){var t,r,n,o,i,a,s,l=this.l1(),u=l.length;if(e<0||u<=e)return"";for(t=[],o=n=0;o<u;o++){for(r=l[o],i=!1,a=0;a<t.length;a++)if(t[a].text.replace(/\s+/g,"").toUpperCase()===r.text.replace(/\s+/g,"").toUpperCase()){i=!0;break}if(i){if(e===o){n=a;break}}else if(t.push(r),e===o){n=t.length-1;break}}return(s=c.DEFAULT_RANGE_COLORS)[n%s.length]},W.prototype.M0=function(){var e,t,r;return!!this.MH||!!this._isSelectMode||!!(e=this.s1(this.caret()))&&(t=e.type,r=e.text,1===t||8===t||7===t&&"%"!==r||5===t||9===t||15===t)},W.prototype.t1=function(e){if(!e||!this.MH)return!1;var t=this.W0,r=this.caret(),n=e.textOffset;return t<=n&&n<r},W.prototype.u1=function(){var e,t,r=[],n=this.l1(),o=n.length;if(0<o)for(t=0;t<o;t++)e=n[t],this.t1(e)&&r.push(e);return r},W.prototype._appendRange=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p=this,g=p._host;if(e&&g){if(!p.MH){if(!p.M0())return;t=!1,p.MH=!0,p.W0=p.caret(),p.Wq("AppendStarted",{})}n=p.W0,o=p.text(),i=p.caret(),o||(o="=",n=p.W0=1,i=1),a=i,r&&(t=!1,o=o.substr(0,n)+o.substr(i),p._tokens=p.T0(o),a=i=n),s=p.s1(i),t?(l=(l=o.substr(0,i)).substr(0,l.length-s.text.length)).length>=n&&(s.text=e,a=l.length+e.length):(u=p._tokens,c=b.Common.k.Cb(u,s),h=p._isSelectMode&&1<u.length&&c===u.length-1&&11===s.type,n<i||h?(u.splice(c+1,0,{text:this.w1(),type:8}),u.splice(c+2,0,{text:e,type:11}),e=","+e):u.splice(c+1,0,{text:e,type:11}),a=i+e.length),p.z1(),f={},(d=S.G0.H0)&&d._text&&(f={sheet:d.kj,editor:d.I0&&d.I0.firstChild.firstChild,canvasOffset:d.f1}),p.Wq(k,f),p.caret(a)}},W.prototype._stopAppending=function(){this.MH&&(this.MH=!1,this.W0=-1,this.Wq("AppendEnded",{}))},W.prototype.B1=function(){this.MH=!0,this.W0=this.caret()},W.prototype.C1=function(e){return void 0!==e&&(this.W0=e),this.W0},W.prototype._repalceRange=function(e,t,r){var n,o,i,a,s,l,u;if(this._host&&!(e<0)&&t){for(n="",o=!1,a=(i=this._tokens)&&i.length,u=l=0;u<a;u++){if(11===(s=i[u]).type&&l++===e){i[u]={text:t,type:11},o=!0;break}n+=s.text}o&&(this.z1(),this.Wq(k,{}),r?this.caret(this.text().length):this.caret(n.length+t.length))}},W.prototype.j1=function(){var e,t,r=this;r.OC&&(e=r._host,r.OC&&e&&(e.setAttribute(i,"gcAttachedFormulaTextBox"),r._isSelectMode||(r.OC.CF=r),r.OC._bind(v.Events.FormulatextboxEditStarted,r,r.E1),r.OC._bind(v.Events.FormulatextboxEnterCell,r,r.F1),r.OC._bind(v.Events.FormulatextboxEditEnded,r,r.G1),r.OC._bind(v.Events.FormulatextboxActiveSheetChanged,r,r.H1),r.OC._bind(v.Events.FormulatextboxRangeChanged,r,r.I1),r.OC._bind(v.Events.FormulaTextBoxTextChanged,r,r.J1),r.OC._bind(v.Events.FormulaTextBoxCaretChanged,r,r.K1),r.OC._bind(v.Events.ValueChanged,r,r.qLb),(t=O(r.OC))&&!r._isSelectMode&&r.text(r._getEditText(t,t.Jl,t.Kl)),r._bind(k,r,r.M1),r._bind(M,r,r.N1)))},W.prototype.refresh=function(e){var t,r=this.OC;!r||(t=O(r))&&!this._isSelectMode&&(this._isWorking=!!e||this._isWorking,this.text(this._getEditText(t,t.Jl,t.Kl)),this._isWorking=!1)},W.prototype.Y0=function(){var e=this,t=e.OC;!e.O0&&t&&(e._isSelectMode||(t.CF=null,t._unbind(v.Events.FormulatextboxEditStarted,e.E1),t._unbind(v.Events.FormulatextboxEnterCell,e.F1),t._unbind(v.Events.FormulatextboxEditEnded,e.G1),t._unbind(v.Events.FormulatextboxActiveSheetChanged,e.H1),t._unbind(v.Events.FormulatextboxRangeChanged,e.I1),t._unbind(v.Events.FormulaTextBoxTextChanged,e.J1),t._unbind(v.Events.FormulaTextBoxCaretChanged,e.K1),t._unbind(v.Events.ValueChanged,e.qLb),e._unbind(k,e.M1),e._unbind(M,e.N1)),e.text("")),e.OC=null},W.prototype._startingEdit=function(){var e,t;this._isWorking||(this._isWorking=!0,(t=(e=this.OC)&&O(e))&&!t.isEditing()?(this._isSelectMode||t.EF(null,t.Jl,t.Kl,null,null,!1,null),this.Q1=!0):this.Q1=!1,this._isWorking=!1,this._isFuncsShown||this._openFuncHelp())},W.prototype.rLb=function(){var e=this._host,t=this.sLb;e.insertBefore(t,e.firstChild),t.innerText=this.oLb},W.prototype.tLb=function(e,t){e&&this.uLb!==t&&(this.uLb=t,e.style.display=t?"":"none")},W.prototype.pLb=function(){var e,t=this._host;this.Cia(t)?((e=this.sLb)||((e=this.sLb=x("span")).className="gcsj-func-gray-formula"),this.tLb(e,!0),this.rLb()):t.placeholder=this.oLb},W.prototype.vLb=function(){var e;this.oLb&&(this.oLb="",e=this._host,this.Cia(e)?this.tLb(this.sLb,!1):e.placeholder="")},W.prototype._startEdit=function(){var e,t,r,n,o,i,a=this.OC,s=a&&O(a);s&&(e=s._formulaTextBox,this.Q1&&e&&(t=e.text(),(r=this.text())!==t&&(n=this.caret(),o=s.getFormulaInformation(s.getActiveRowIndex(),s.getActiveColumnIndex()),this.text(t),o.isArrayFormula&&(n>=r.length&&--n,n=u(0,n-1)),this.caret(n))),!(this.Q1&&e||this._isSelectMode)||2!==(i=s._editorStatus)&&(s._editorStatus=2,s._raiseEditorStatusChanged(i,2)))},W.prototype._getEditText=function(e,t,r){var n,o,i,a,s,l="";if(e){if(o=(n=e.parent)&&n.options,(i=e.getFormulaInformation(t,r))&&i.hasFormula){if(l="="+i.formulaWithCulture,i.isDynamicArray)return this.oLb=l,"";this.oLb="",i.isArrayFormula&&(l="{"+l+"}")}else a=e.getActualStyle(t,r),l="string"==typeof(s=e.getValue(t,r))&&a.quotePrefix||0<l.length&&"="===l[0]&&o&&o.allowUserEditFormula?"'"+s:v.Ul.Il(a,s,e)||"";this.vLb()}return l},W.prototype.H1=function(e,t){var r,n=e.data;n._isWorking||(r=t.newSheet,n._isSelectMode||(n._isWorking=!0,n.close(),t&&n.text(n._getEditText(r,r.Jl,r.Kl)),n._isWorking=!1))},W.prototype.E1=function(e){var t,r,n,o=e.data;o._isWorking||(n=(r=(t=o.OC)&&O(t))&&r._formulaTextBox)&&o._isSelectMode===n._isSelectMode&&o.C5===n.C5&&(o.vLb(),o._isWorking=!0,o.text(n.text()),o._isWorking=!1)},W.prototype.F1=function(e,t){var r=e.data;r._isSelectMode||r._isWorking||(r._isWorking=!0,t&&r.text(r._getEditText(t.sheet,t.row,t.col)),r._isWorking=!1)},W.prototype.I1=function(e,t){var r,n,o,i,a,s=e.data;s._isWorking||s._isSelectMode||(s._isWorking=!0,t&&(r=t.sheet,n=t.row,o=t.col,i=t.rowCount,a=t.colCount,new v.Range(n,o,i,a).contains(r.Jl,r.Kl)&&s.text(s._getEditText(r,r.Jl,r.Kl))),s._isWorking=!1)},W.prototype.G1=function(e,t){var r=e.data;return r._isSelectMode&&r.D5&&r.E5?void(t.ignore=!0):void(r._isWorking||(r._isWorking=!0,r.close(),t&&t.sheet._formulaTextBox&&!t.sheet._formulaTextBox._isSelectMode&&!r._isSelectMode&&r.text(r._getEditText(t.sheet,t.row,t.col)),r._isWorking=!1))},W.prototype.qLb=function(e,t){var r=t.sheet,n=r&&r.parent&&r.parent.CF;n&&n.e2()===t.row&&n.f2()===t.col&&n.a1()===r&&e.data instanceof W&&(t.text=r.getText(t.row,t.col),e.data.J1(e,t))},W.prototype.J1=function(e,t){var r,n=e.data;n._isWorking||t.sheet._formulaTextBox&&(n._isSelectMode!==t.sheet._formulaTextBox._isSelectMode||n.C5!==t.sheet._formulaTextBox.C5)||(n._isWorking=!0,t&&(r=n.caret(),n.text(t.text),n.caret(r)),n._isWorking=!1)},W.prototype.K1=function(e,t){var r=e.data;r._isWorking||t.sheet._formulaTextBox&&(r._isSelectMode!==t.sheet._formulaTextBox._isSelectMode||r.C5!==t.sheet._formulaTextBox.C5)||(r._isWorking=!0,t&&r.caret(t.caret),r._isWorking=!1)},W.prototype.M1=function(e){var t,r,n,o,i,a,s,l,u=e.data;if(!u._isWorking&&(r=(t=u.OC)&&O(t))){if(r.isEditing()||(u._startingEdit(),u.focus()),u._isWorking=!0,n=r.Jl,o=r.Kl,i=r._formulaTextBox,a=r.getCellType(n,o),i){if(u._isSelectMode!==i._isSelectMode||u.C5!==i.C5)return;s=i.caret(),i.text(u.text()),i.caret(s)}else l={sheet:r,row:n,col:o,sheetArea:3},a.setEditorValue(r._editor,u.text(),l);u._isWorking=!1}},W.prototype.N1=function(e){var t,r,n,o=e.data;o._isWorking||(r=(t=o.OC)&&O(t))&&r.isEditing()&&((n=r._formulaTextBox)&&(o._isSelectMode!==n._isSelectMode||o.C5!==n.C5)||(o._isWorking=!0,n&&(n.caret(o.caret()),o._openFuncHelp()),o._isWorking=!1))},W.prototype.ad=function(e){var t,r,n,o=this;o.T1=!1,o.U1=!1,o.MH=!1,o.W0=-1,o.i1=[],o.g1=!0,o.h1=!0,o.V1=!0,(t=x("div")).className="gcsj-func-ac-popup",t.style.display="none",t.setAttribute(i,"gcFuncACPopup"),e.insertBefore(t,C),o._funcsPopup=t,o._isFuncsShown=!1,(r=x("div")).className="gcsj-func-help-popup",r.style.display="none",r.setAttribute(i,"gcFuncHelpPopup"),e.insertBefore(r,C),o.$0=r,o._isFuncHelpShown=!1,v.GC$(t).bind("mouseover",function(){o.V1=!1}).bind("mouseout",function(){o.V1=!0}),v.GC$(r).bind("mouseover",function(){o.V1=!1}).bind("mouseout",function(){o.V1=!0}),v.GC$(t).bind("scroll",function(){o.X1&&clearTimeout(o.X1),o.X1=T.setTimeout(function(){o._host&&o._host.focus()},100)}),(n=x("div")).style.display="none",n.setAttribute(i,"gcFuncHelpDiv"),e.insertBefore(n,C),o._0=n,o.OC=null,o._isWorking=!1,o.Q1=!1,o.O0=!1},W.prototype.N0=function(e){var p,g,t;e&&(g=(p=this).Cia(e),(p.d1(e)||g)&&(t=v.GC$(e),p._host&&p.X0(),p._host=e,n&&(n.msie||n.chrome)?g||h||n.chrome?(p._bind("focus",function(){t.data(D,p.text())}),p._bind("click",function(){t.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(e){p._bind(e,function(){p.Y1()})})):p._bind(f,function(){p.Z1()}):p._bind(f,function(){if(g){var e=p._host.lastChild;n.chrome&&e&&"BR"===e.tagName&&p._host.removeChild(e)}p.Z1()}),p._bind("keydown",function(e){var t,r,n,o,i,a,s,l=e.ctrlKey,u=e.shiftKey,c=e.altKey,h=e.metaKey,f=l||u||c||h,d=e.keyCode;!f&&p._isFuncsShown&&(d===I.down?(p._1(1),y(e)):d===I.up?(p._1(-1),y(e)):d===I.tab&&(p._completeFunc(),y(e))),d===I.esc&&p.close(),p.b2(e),r=(t=O(p.OC))._eventHandler.LH(e),p._isSelectMode&&r&&(n=t._formulaTextBox)&&n.MH&&n._stopAppending(),g&&(r?(8===d?V(e)&&v.uHb.processBackspaceAndLeftArrowKeyEvent(e,!0):46===d&&V(e)&&v.uHb.processDeleteAndRightArrowKeyEvent(e,!0),p.Jka()):13===d&&(l||c)?(!V(e)||0<(s=T.getSelection()).rangeCount&&(o=s.getRangeAt(0),(i=A.createElement("span")).innerHTML="<br/>",o.insertNode(i),(a=A.createRange()).setStartAfter(i),a.setEndAfter(i),a.collapse(!1),s.removeAllRanges(),s.addRange(a)),p.Jka(!0)):37===d?V(e)&&v.uHb.processBackspaceAndLeftArrowKeyEvent(e,!1):39===d&&V(e)&&v.uHb.processDeleteAndRightArrowKeyEvent(e,!1),g&&l&&(90===d||89===d)&&y(e))}),p._bind("keyup",function(e){var t,r,n,o;p.b2(e),t=p.text(),g&&(r=void 0,n=e.keyCode,(o=e.ctrlKey)&&90===n?(r=p.Ac.pop()||"",p.text(r),p.Bc.push(t)):!o||89!==n||(r=p.Bc.pop())&&(p.text(r),p.Ac.push(t)))}),p._bind("focus",function(e){n&&n.mozilla&&!p._host.innerText&&(p._host.innerText=""),p.b2(e),p._isSelectMode&&p.D5&&(p.E5=!0,p.j5())}),p._bind("blur",function(){p.V1&&p.close(),p._isSelectMode&&(p.H5(),p.E5=!1)}),p._bind("mousedown",function(){p.E5=!0,p.uLb&&(p.vLb(),p.wLb=!0),p._startingEdit()}),p._bind("mouseup",function(){if(p.wLb){p.wLb=!1;var e=p._host,t=T.getSelection();e!==t.anchorNode&&t.selectAllChildren(e)}p._startEdit()}),p._bind("click",function(e){var t,r,n;p.MH&&p._stopAppending(),(n=(r=(t=p.OC)&&O(t))&&r._formulaTextBox)&&n.MH&&!n._isSelectMode&&n._stopAppending(),p.b2(e)}),p._bind("compositionstart",function(){p.T1=!0}),p._bind("compositionend",function(){p.T1=!1,(n.edge||n.chrome)&&p.Y1()})))},W.prototype.X0=function(){var e,t=this._host;t&&((e=v.GC$(t)).removeData(D),e.removeData(N),e.removeAttr(i),this.nu(),this.unbindAll(),this._isSelectMode&&(v.GC$(this.cga).empty(),this.cga=C),this._host=C)},W.prototype.Y1=function(){var e=v.GC$(this._host),t=this.text();e.data(D)!==t&&(this.T1||e.data(D,t),this.Z1())},W.prototype.b2=function(e){var t,r;n&&n.msie?setTimeout((t=this,r=e,function(){t.d2(t,r)}),10):this.d2(this,e)},W.prototype.d2=function(e,t){var r,n,o,i,a,s=t.keyCode,l=s===I.left||s===I.right||s===I.home||s===I.end||s===I.pdn||s===I.pup||s===I.tab||s===I.enter;if(e.g1||(l=l||s===I.up||s===I.down),r=void 0!==t.button,l||r){if(n=e._host,o=v.GC$(n),(i=e.b1(n)).start!==i.end)return;a=i.end,o.data(N)!==a&&(o.data(N,a),e.Wq(M,{}),e._openFuncHelp())}},W.prototype.e2=function(){return this.OC?O(this.OC).Jl:void 0},W.prototype.f2=function(){return this.OC?O(this.OC).Kl:void 0},W.prototype.a1=function(){if(this.OC)return O(this.OC)},W.prototype.parseInternal=function(e,t,r,n){var o,i,a=[];return e&&"="===e[0]&&function(e,t){var r,n=0;for(r=0;r<e.length;r++)e[r]===t&&n++;return n}(e,'"')%2!=1?(o=new d.Parser,i=m.qzb(o,e,t,r,n,!0),a=this.i2(i)):(a.push({text:e,type:17}),a)},W.prototype.T0=function(e){return this.parseInternal(e,this.a1(),this.e2(),this.f2())},W.prototype.Z1=function(){var e,t,r,n=this,o=n.text();return"\n"!==o&&0<=o.indexOf("\n")?void n.Wq(k,{type:f}):(e=n._host,t=v.GC$(e),n.U1=!0,n._tokens=n.T0(o),n.Cia(e)?n.T1||("\n"===o?(t.empty(),n.Wq(k,{type:f})):(r=n.caret(),n.V0(n._tokens),n.Wq(k,{type:f}),n.caret(r))):n.Wq(k,{type:f}),r=n.caret(),t.data(N)!==r&&(t.data(N,r),n.Wq(M,{})),n._openFuncs(),void(n._isFuncsShown||n._openFuncHelp()))},W.prototype.j2=function(){return b.Common.CultureManager.q4().NumberFormat},W.prototype.h2=function(){var e=this.j2();return e&&e.arrayGroupSeperator||";"},W.prototype.l2=function(){var e=this.j2();return e&&e.arrayListSeparator||","},W.prototype.w1=function(){var e=this.j2();return e&&e.listSeparator||","},W.prototype.g2=function(){var e=this.j2();return e&&e.numberDecimalSeparator||"."},W.prototype.i2=function(e){var t,r,n,o,i=[],a=[],s=this.h2(),l=this.l2(),u=!1;for(t=0;t<e.length;t++)0<t&&t<e.length-1&&";"===e[t-1].text&&","===e[t].text&&"ARRAYROW"===e[t+1].text||(r=e[t],n=this.m2(r,a),o=r.text,2===n?i.push({text:o,type:n}):u&&8===n&&","===o?i.push({text:l,type:9}):u&&8===n&&";"===o?i.push({text:s,type:10}):8===n?i.push({text:o,type:n}):3===n?("ARRAY"===o&&(u=!0),i.push({text:"{",type:3})):4===n?"ARRAY"===o?(u=!1,i.push({text:"}",type:4})):i.push({text:o,type:4}):6===n?i.push({text:")",type:n}):13===n?i.push({text:b.Common.o.nb(o),type:n,ranges:r.ranges,allowDrag:r.canDrag}):null!==n&&i.push({text:o,type:n,ranges:r.ranges,allowDrag:r.canDrag}));return i},W.prototype.m2=function(e,t){var r,n=e.type,o=e.subType,i=e.text,a=e.value;if(1===n){if(1===o)return"ARRAY"===i||"ARRAYROW"===i?(t.push(3),3):(t.push(5),"@"===a||"("===a.trim()?5:2);if(2===o){if(")"===a.trim())return 6;if(0<t.length){if(3===(r=t[t.length-1]))return t.pop(),4;if(5===r)return t.pop(),6}}if("="===a.trim())return 1}else if(3===n){if(0===o)return 8}else{if(5===n||6===n||4===n)return 7;if(0===n)return 7===o||0===o?11:5===o?12:4===o?13:3!==o&&6===o?16:14;if(7===n)return 15;if(8===n)return 17}return 17},W.prototype.z1=function(){var e,t=this._host,r=this._tokens,n="",o=r&&r.length;for(e=0;e<o;e++)n+=r[e].text;this.d1(t)?t.value=n:this.Cia(t)&&this.V0(r)},W.prototype.d1=function(e){var t=e&&e.tagName;return"TEXTAREA"===t||"INPUT"===t},W.prototype.Cia=function(e){return e&&"DIV"===e.tagName&&"true"===e.contentEditable},W.prototype.Dia=function(e){return"gcEditingInput"===v.GC$(e).attr(i)},W.prototype.bW=function(e){return e&&"="===e[0]},W.prototype._bind=function(e,t,r){var n=this._host;n&&e&&(e=e.split(/\s+/).join(a+" "),v.GC$(n).bind(e+a,t,r))},W.prototype._unbind=function(e,t){var r=this._host;r&&e&&(e=e.split(/\s+/).join(a+" "),v.GC$(r).unbind(e+a,t))},W.prototype.nu=function(){var e=this._host;e&&v.GC$(e).unbind(a)},W.prototype.Wq=function(e,t){var r=this._host;r&&v.GC$(r).trigger(e,t)},W.prototype.s1=function(e){var t,r,n,o,i;if(e<=0)return C;if(0<(r=(t=this._tokens)&&t.length))for(o=void(n=0),i=0;i<r;i++)if(e<=(n+=(o=t[i]).text.length))return o;return C},W.prototype.n2=function(){var e,t,r,n,o,i=this.OC;if(i&&(e=O(i))&&(t=e.getCalcService().allowDynamicArray,r=e._formulaTextBox)){for(o=(n=[].concat(r.i1)).length-1;0<=o;o--)!t&&n[o]&&U(n[o].name)?n.splice(o,1):n[o].isFunc=!0;return n.concat(this.o2(i,e)).concat(this.q2(i.sheets))}return this.i1},W.prototype.o2=function(e,t){var r,n=[],o=t.getCustomNames();return o&&v.GC$.each(o,function(e,t){n.push({name:t.Cj,description:t.kT})}),(r=e.getCustomNames())&&v.GC$.each(r,function(e,t){n.push({name:t.Cj,description:t.kT})}),n},W.prototype.q2=function(e){var o=[];return e.forEach(function(e){var t,r,n=e.tables;if(n&&(t=n.all()))for(r=0;r<t.length;r++)o.push({name:t[r].name(),description:d.sR().Fbx_TableName_Description+t[r].name()})}),o},W.prototype.s2=function(e,t){var r,n,o,i;for(e=g(e),w.Bb(e,"[")&&(e=e.substr(e.lastIndexOf("[")+1),e=w.Gb(e,"@","")),r=[],n=t&&t.length,i=0;i<n;i++)o=t[i],0===g(j(o.name)).indexOf(e)&&r.push(o);return r},W.prototype.t2=function(){var e,t,r,n,o,i=this.caret();if(i<=0)return"";if(0<(t=(e=this._tokens)&&e.length))for(n=void(r=0),o=0;o<t;o++){if(r+(n=e[o]).text.length>=i)return n.text.substring(0,i-r);r+=n.text.length}return""},W.prototype.u2=function(){var e,t,r,n,o,i,a,s,l,u=this.caret(),c=this._tokens,h=c&&c.length,f=[],d=0;for(t=0;t<h;t++){if(e=c[t],f.push(e),6===e.type)for(r=0;0<f.length;)if(6===(n=f.pop()).type&&r++,5===n.type&&r--,0===r){0<f.length&&(n=f[f.length-1])&&2===n.type&&f.pop();break}if(u<=(d+=e.text.length))break}if(0<f.length)for(o=0;0<f.length;)if(8===(e=f.pop()).type)o++;else if(2===e.type){for(i=g(e.text),s=(a=this.n2())&&a.length,l=void 0,t=0;t<s;t++)if(l=a[t],g(j(l.name))===i)return{func:l,activeParamterIndex:o,isFunc:l.isFunc};break}return C},W.prototype._openFuncs=function(){var e,t,r,n,o,i,a,s,l=this,u=l.v2();if(l.g1&&l.bW(l.text())&&u&&0<u.length&&!l.MH&&!l.T1&&!l._isSelectMode){for(l._closeFuncHelp(),e=l._funcsPopup,8<u.length?(e.style.height="204px",e.style.overflowY="scroll"):(e.style.height="auto",e.style.overflowY=""),t="",r=u.length,n=void 0,o=0;o<r;o++)t+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(n=u[o]).isFunc+">"+j(n.name)+"</div><div class='gcsj-func-ac-row-description'>"+(n.description||"")+"</div></div>";(i=v.GC$(l._funcsPopup)).html(t).show(),l._isFuncsShown=!0,0<(a=i.find(".gcsj-func-ac-row")).length&&(s="gcsj-ac-row-active",v.GC$(a[0]).addClass(s),a.bind("mouseover",function(){a.removeClass(s),v.GC$(this).addClass(s)}),a.bind("click",function(){l._completeFunc()})),l._position()}else l._closeFuncs()},W.prototype.v2=function(){var e,t,r,n,o,i,a,s=this.s1(this.caret()),l=s&&s.text,u=[],c=this._tokens.indexOf(s);if(s&&14===s.type)return u;if(0<(e=this.A2(c)).length){for(o in t=JSON.parse(JSON.stringify(d.sR().B2)),r=d.getMapping()&&d.getMapping().tableFunctionsMapping,n=[],t)(i=r&&r[t[o].name])&&(t[o].name=i),n.push(t[o]);if(u=u.concat(e).concat(n),w.jb(l,"[")||w.jb(l,"[@"))return u}else u=this.n2();return a=[],(l=this.t2())&&(a=this.s2(l,u)),a},W.prototype.A2=function(e){var t,r,n,o,i,a,s,l,u=[],c=this._tokens,h=c&&c.length;if(e<0||e>=c.length)return u;if(r=(t=this.OC)&&O(t),n={},void 0!==e&&e!==C||(e=h),r&&(o=c[e],void 0!==(a=(i=r.tables)&&i.findByName(w.Ib(o.text,"[")))&&a!==C&&!n[a])){for(n[a]=!0,s=0,l="";l!==C;)l=a.getColumnName(s),s++,l!==C&&u.push({name:l,description:""});if(0<u.length)return u}return u},W.prototype._closeFuncs=function(){v.GC$(this._funcsPopup).hide(),this._isFuncsShown=!1},W.prototype._1=function(e){var t,r,n,o,i,a,s=v.GC$(this._funcsPopup).find(".gcsj-func-ac-row"),l=s.length;if(0!==l){if(t="gcsj-ac-row-active",r=0,e)for(n=0;n<l;n++)if(v.GC$(s[n]).hasClass(t)){r=n+e;break}o=v.GC$(this._funcsPopup).scrollTop(),s.removeClass(t),(i=0)<l&&(i=s[0].offsetHeight),r=u(r,0),a=s[r=p(r,l-1)],v.GC$(a).addClass(t),a.offsetTop+a.offsetHeight>v.GC$(this._funcsPopup).scrollTop()+v.GC$(this._funcsPopup).height()?v.GC$(this._funcsPopup).scrollTop(v.GC$(this._funcsPopup).scrollTop()+i):a.offsetTop<v.GC$(this._funcsPopup).scrollTop()?v.GC$(this._funcsPopup).scrollTop(a.offsetTop):v.GC$(this._funcsPopup).scrollTop(o)}},W.prototype._completeFunc=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g=this,m=v.GC$(g._funcsPopup).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),b=m.text(),y="true"===m.attr("isFunc");if(b){for(e=g.caret(),r=(t=g._tokens)&&t.length,i=o=n=0,a=C;i<r&&!(e<=n+(o=(a=t[i]).text.length));)i++,n+=o;s=e-n,l=a.text,c=u=0,w.Bb(l,"[")?-1===(u=l.lastIndexOf("[",s-1))?(u=l.indexOf("["),a.text=-1===u?b:b+l.substr(u),u=0):(u++,"@"===l.charAt(u)&&(u+=1),-1===(c=l.indexOf("]",s))&&(c=l.length),a.text=l.substring(0,u)+b+l.substr(c)):(a.text=b,(h=l.substr(s))&&1<(f=g.T0("="+h)).length&&t.splice(i+1,0,f[1])),a.type=y?2:11,p=t[d=i+1],!y||p&&5===p.type||t.splice(d,0,{text:"(",type:5}),g._closeFuncs(),g._host.focus(),g.z1(),g.caret(n+b.length+u+(y?1:0)),g._openFuncHelp(),g._tokens=g.T0(g.text()),g.Wq(k,{})}},W.prototype._openFuncHelp=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f=this;if(f._isFuncsShown&&f._closeFuncs(),(e=f.u2())!==C&&!0===e.isFunc)if(t=f.w1(),f.h1&&f.bW(f.text())&&e&&!f.MH&&!f.T1&&!f._isSelectMode){for(o=(n=(r=e.func).parameters)&&n.length,i=p(o-1,e.activeParamterIndex),a=void 0,s="",l=0;l<o;l++)u=(a=n[l]).name,a.repeatable&&(u+=t+"..."),a.optional&&(u="["+u+"]"),c=l===o-1?"":t+" ",s+=u=l===i?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+u+"</span>"+c:"<span class='gcsj-func-help-paramter'>"+u+"</span>"+c;h="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+j(r.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+s+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div><div class='gcsj-func-help-body'><div class='gcsj-func-help-section-content'><div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+d.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(r.description||"")+"</div></div></div></div>",v.GC$(f.$0).html(h).show(),f._isFuncHelpShown=!0,f._position()}else f._closeFuncHelp();else f._closeFuncHelp()},W.prototype._closeFuncHelp=function(){v.GC$(this.$0).hide(),this._isFuncHelpShown=!1},W.prototype.close=function(){this._closeFuncs(),this._closeFuncHelp()},W.prototype.BH=function(e,t){var r,n,o,i,a,s;return!this.MH&&(r=e.ctrlKey||e.shiftKey||e.altKey||e.metaKey,n=e.keyCode,o=e.ctrlKey,i=e.altKey,a=e.metaKey,(s=e.srcElement||e.target)&&t&&t.isEditing&&"gcAttachedFormulaTextBox"===s.getAttribute("gcUIElement")?67===n&&(o||a)&&!i||88===n&&(o||a)&&!i:this._isFuncsShown&&!r&&(n===I.down||n===I.up||n===I.tab))},W.prototype._position=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d=C;if(this._isFuncsShown?d=this._funcsPopup:this._isFuncHelpShown&&(d=this.$0),d){if(e=v.GC$(this._host),t=v.GC$(d),(r=S.G0.H0)&&r.kj)return n=r.kj.getCellRect(r.nT,r.Mk),o=r.f1,void t.css("top",n.y+n.height+o.top).css("left",n.x+o.left);i=e.parent(),a=e.outerHeight(),this.Dia(this._host)&&(a=(i=i.parent()).outerHeight()),s=i.css("top"),l=parseFloat(s),isNaN(l)||(s=l),u=i.css("left"),"auto"===s&&(s=e.offset().top,u=e.offset().left),c=s+a,v.GC$(A.body).outerHeight()<c+(h=t.outerHeight())&&0<=(f=s-h)&&(c=f),t.css("top",c).css("left",u)}},W.prototype.focus=function(){v.GC$(this._host).focus()},W.prototype.V0=function(e){var t,r,n,o,i="",a="",s=e&&e.length,l=0;for(r=0;r<s;r++)n="",11===(t=e[r]).type&&(n=" style='color: "+this.o1(l)+"'",l++),this._0.innerText=t.text,i+="<span"+n+" class='gcsj-func-color-text'>"+this._0.innerHTML+"</span>",a+=t.text;if(a||this.text())if(o=this._host,i)o.innerHTML="<span class='gcsj-func-color-content'>"+i+"</span>";else for(;o.firstChild;)o.removeChild(o.firstChild)},W.prototype.e1=function(e,t){var r,n,o,i=v.GC$(e).find(".gcsj-func-color-content .gcsj-func-color-text"),a=i.length;for(t=u(0,t),o=0;o<a;o++)if((t-=(n=(r=i[o]).innerText).length)<=0)return{node:r,offset:n.length+t};return n?{node:r,offset:n.length}:C},W.prototype.iIb=function(e,t){var r=T.getSelection(),n=this._host.children[0],o=document.createRange();o.setStart(n,e),o.setEnd(n,t),r.removeAllRanges(),r.addRange(o)},W.prototype.Jka=function(e){var t=this._host,r=this.Cia(t),n=this.text();r&&n&&(n=e?n.substr(0,n.length-2):n,this.Ac.push(n))},W.prototype.nLb=function(e,t){var r,n,o,i,a,s,l;if(t)for(o=n=r=0,i=t.length,a=0;a<e.length;a++){for(s=e[a].text;n<i;n++)if((l=t[n].toUpperCase())===(s[o]?s[o].toUpperCase():void 0))o+=1;else{if("\n"!==l)break;n+1<i&&""===t[n+1]&&(n+=1)}e[a].text=t.substring(r,n),r=n,o=0}return e},W.prototype.mLb=function(e){var t,r,n,o,i;if("="===e[0]&&-1!==e.indexOf("\n")){for(t=[],r=e.length,n=!1,o=0;o<r;o++)'"'===(i=e[o])&&(n=!n),n||"\n"!==i?t.push(i):o+1<r&&""===e[o+1]&&(o+=1);return t.join("")}},L=W,c.FormulaTextBox=L},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(e,t,r){"use strict";var A,n,m,b,_,y,P,a,k,L,O,B,j,H,G,C,T,w,u,o,i,s,l,c,h,f,d,p,g,v,S,x,M=this&&this.__extends||(d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function I(e,t,r,n){var o,i,a,s=p.call(this,e&&e.yj(),t,r,n)||this;for(e=e||new A.Worksheet,s.kj=e,s.row=r&&r.row||0,s.column=r&&r.col||0,i=(o=e.getCalcService()).getResolvers(),a=0;a<i.length;a++)if(i[a]instanceof b.SheetReferenceResolver)return s;return o.addResolver(new b.SheetReferenceResolver(e)),o.addResolver(new b.StructureReferenceResolver(e)),s}function E(e){var t=g.call(this,O)||this;return t.references=e,t}function R(e,t,r,n,o){this.Cj=e,this.Uu=r,this.Vu=n,this.Lf=t,T(o)||(this.kT=o)}function U(e,t,r,n,o){var i=t.getSpan(r,n,o),a=O;return i.row===r&&i.col===n&&(a=e.getValue(r,n,o)),a}function D(e){var t=S.call(this,O)||this;return t.createSourceModel=function(e){return new _.CalcSourceModel(e,this)},t.Qu=e,t}function N(e,t){var r=x.call(this,O)||this;return r.getCalcSourceModel=function(){return this.Bf},r.createSourceModel=function(e){return new _.CalcSourceModel(e,this)},r.getRangeKey=function(e,t){return e.id+","+t.row+","+t.col+","+t.rowCount+","+t.colCount},r.getSheetRangeReference=function(e){var t,r,n,o,i,a=this.kj,s=a&&a.parent;if(e.endSource&&s&&s.sheets&&e.endSource instanceof N){for(t=s.sheets,r=!1,n=void 0,o=[],i=0;i<t.length;i++){if((n=t[i].yj())===this)r=!0;else if(n===e.endSource){o.push(n.getReference(e));break}r&&o.push(n.getReference(e))}return new c(o)}},r.kj=e,r.Wz=t||3,r}function F(e,t,r,n,o,i){var a,s=e&&e instanceof A.Worksheet&&e,l=new _.Parser;return r=r===B?0:r,n=n===B?0:n,a=new h(s,!!o,_._createCellIdentity(r,n)),i&&(a.culture=!0),l.parse(a,t)}function W(e,t,r,n,o){var i,a,s=e.Cf();return r===B&&(r=e.getActiveRowIndex()),n===B&&(n=e.getActiveColumnIndex()),i=!0,o&&o.convertNullToZero!==B&&(i=o.convertNullToZero),a=e.yj(),s._evaluateParsedFormula(a,t,_._createCellIdentity(r,n),!1,i)}function V(e,t,r,n,o){var i,a,s,l,u=e.row,c=e.col,h=e.row+e.rowCount-1,f=e.col+e.colCount-1,d=!1,p=!1,g=!1,m=!1;return 4<=arguments.length&&(u-=(d=0!=(1&n))?t:0,h-=(p=0!=(4&n))?t:0,c-=(g=0!=(2&n))?r:0,f-=(m=0!=(8&n))?r:0),o&&(i=function(e,t,r){if(1===e.rowCount){if(t.hasHeadersRow()&&e.row===t.startRow())return 2;if(t.hasTotalsRow()&&e.row===t.endRow())return 8;if(r===e.row)return 1}else{if(t.hasHeadersRow()&&e.row===t.startRow()){if(e.rowCount===t.dataRange().rowCount+1)return 6;if(t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1+1)return 14}if(e.row===t.dataRange().row){if(e.rowCount===t.dataRange().rowCount)return 3;if(t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1)return 12}}return B}(e,o,t),l=o,a=(s=e).col===l.startColumn()&&s.colCount===l.dataRange().colCount?1:1===s.colCount?2:s.col>=l.startColumn()&&s.col+s.colCount-1<=l.endColumn()?4:B,i&&a)?b.StructureReferenceResolver.create(o,i,a,e.col-o.dataRange().col,e.col+e.colCount-o.dataRange().col-1):1===e.rowCount&&1===e.colCount?_.rf(O,O,u,c,d,g):(e.row<0&&(u=h=y.BAND_INDEX_CONST),e.col<0&&(c=f=y.BAND_INDEX_CONST),_.uf(O,O,u,c,h,f,d,g,p,m,t,r))}function z(e,t,r,n){var o,i,a,s,l,u,c,h;if(!t)return null;if(r=r||0,n=n||0,(o=e.Cf().parse(e.yj(),t,r,n,!0,!0))&&((!(i=o.source)||13!==o.type)&&1===o.type&&o.endSource)){for(a=o.source,s=o.endSource,l=a.getSources(s),u=!1,c=0;c<l.length;c++)if(l[c]===e.yj()){u=!0;break}o=u&&o}return!o||!o.getRange||i&&i!==e.yj()?null:(h=o.getRange(r,n))?new A.Range(h.row,h.col,h.rowCount,h.colCount):null}function q(e,t,r,n,o,i){var a,s,l,u="";for(a=0;a<r.length;a++)s=V(r[a],n,o,i),l=e.unparse(t,s),u+=0<a?", "+l:l;return u}Object.defineProperty(t,"__esModule",{value:!0}),A=r("Core"),n=r("Core"),m=r("@grapecity/js-sheets-common"),b=r("./dist/plugins/sheetsCalc/parser-sheets.js"),_=r("@grapecity/js-calc"),y=r("./dist/plugins/sheetsCalc/calc.ns.js"),P=m.Common.j,a=m.Common.u,k=P.Ia,L=P.za,O=null,B=void 0,j=["v","n","s","b","d","sn"],H=_.Errors.Value,_.Errors.Calc,G=m.Formatter&&m.Formatter.GeneralFormatter,C=_.Convert.vf,_.Convert._isReference,_.Convert.Ca,_.Errors.Reference,_.Errors.NotAvailable,_.Errors.Name,m.Common.A,m.Common.B,T=P.Fa,w=function(e){return _.Convert.Na(e,!0)},u=A.Range.prototype.contains,o=a.Nb,(i=_.CalcSource.prototype).referenceToArray=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w=1,v=1,S=[],x=e.getRangeCount();if(0===x)return S.isError=!0,S;for(p=this.getRowCount(),g=this.getColumnCount(),r=r===B||r,m=0;m<x;m++){if(r||(d=[],S.push(d)),0===(w=e.getRowCount(m)))return S.isError=!0,S;if(0===(v=e.getColumnCount(m)))return S.isError=!0,S;if(c=e.getRow(m),h=e.getColumn(m),p<=c||g<=h)return(S=[O]).rowCount=1,S.colCount=1,S.rangeCount=1,S;for(p<c+w&&(w=p-c),g<h+v&&(v=g-h),b=void 0,y=0;y<w;y++)for(l=c+y,r||(b=[],d.push(b)),C=0;C<v;C++){if(u=h+C,f=this.getValue(l,u),n&&_.Convert.vf(f))return(S=[f]).isError=!0,S;if(f=_.Convert.wf(f,t,!_.ExcelCompatibleCalcMode,i,s),o&&f===_.Convert.CalcConvertedError)return(S=[H]).isConvertError=!0,S;f===O&&i||(r?S.push(f):b.push(f))}}return r||1!==x||(S=S[0]),S.rowCount=w,S.colCount=v,S.rangeCount=x,S},i.getSheetReference=function(){return this.Df=this.Df||new _.CalcReference(this),this.Df},(v=s=t.ReferenceStyle||(t.ReferenceStyle={}))[v.a1=0]="a1",v[v.r1c1=1]="r1c1",n.ReferenceStyle=s,R.prototype.getName=function(){return this.Cj},R.prototype.getRow=function(){return this.Uu},R.prototype.getColumn=function(){return this.Vu},R.prototype.getExpression=function(){return this.Lf},R.prototype.getComment=function(){return this.kT},R.prototype.fg=function(e,t){t&&t.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=e},l=R,t.NameInfo=l,n.NameInfo=l,_.CalcSource.prototype.createSourceModel=function(e){return new _.CalcSourceModel(e,this)},g=_.CalcReference,M(E,g),E.prototype.toArray=function(e,t,r,n,o){var i,a,s=this.references,l=[];for(i=0;i<s.length;i++){if((a=s[i]._source.referenceToArray(s[i],e,t,r,n,o)).isError&&r)return a;t?Array.prototype.push.apply(l,a):l.push(a[0]),i||(l.rowCount=a.rowCount,l.colCount=a.colCount)}return l.rangeCount=s.length,l},c=E,t.SheetRangeReference=c,p=_.ParserContext,M(I,p),I.prototype.getExternalSource=function(e,t){var r,n,o,i=this.kj.parent;if(e&&(!i||i.name!==e))return O;if(!i)return a.Mb(this.kj.name(),t)?this.kj.yj():O;if((r=i.sheets)&&0<r.length)for(n=0;n<r.length;n++)if(o=r[n],a.Mb(o.name(),t))return o.yj();return _.ParserContext.prototype.getExternalSource.call(this,e,t)},I.prototype.getExternalSourceToken=function(e){return e.getName()},I.prototype.getTableByName=function(e){var t,r,n=this.kj.tables,o=n?n.findByName(e):O;if(!o&&(t=this.kj.parent&&this.kj.parent.sheets))for(r=0;r<t.length&&(!(n=t[r].tables)||!(o=n.findByName(e)));r++);return o},I.prototype.getTableByIndex=function(e,t){var r=this.kj.tables;return r?r.find(e,t):O},I.prototype.setSource=function(e){(this.source=e)&&e.getSheet&&(this.kj=e.getSheet())},I.prototype.no=function(){this.kj&&this.kj.no()},h=I,t.SheetParserContext=h,new m.Common.ResourceManager(A.SR),x=_.CalcSource,M(N,x),N.prototype.startCalculation=function(){this.Hu||this.xLb()},N.prototype.endCalculation=function(){this.Hu=O,this.zIc(),this.Iu=O;var e=this.Bf.ug(!1);e&&e.clearListenersCache(),this._service.calcOnDemand&&this.kj.repaint()},N.prototype.zIc=function(){var e,t=this.Iu;t&&0<t.length&&(e=this.kj).Wq(A.Events.RangeChanged,{isUndo:!1,sheet:e,sheetName:e.name(),row:0,col:0,rowCount:e.getRowCount(),colCount:e.getColumnCount(),changedCells:t,action:6},e.vxb)},N.prototype.clearValueCache=function(){this.xLb()},N.prototype.xLb=function(){var e=this.getRowCount(),t=this.getColumnCount();this.Hu={rowCount:e,colCount:t,arrayInfo:[]},this.Iu=[]},N.prototype.OHb=function(){this.Hu=O,this.Iu=O},N.prototype.getValue=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p=[];for(r=2;r<arguments.length;r++)p[r-2]=arguments[r];if(n=this.kj,"number"==typeof e)o=arguments[0],i=arguments[1],t=arguments[2];else if((e=e).row!==B)o=e.row,i=e.col;else if(e.name)return null;return a=this.Wz,t=t||0,o<0||i<0?H:n.Ju&&n.Ku===o&&n.Lu===i?n.Mu:(s=this.Hu,l=j[t],s?(u=s.rowCount,c=s.colCount,d=f=h=void 0,u<=o||c<=i?O:((d=(f=(f=(h=(h=s[o])||(s[o]={}))[i])||(h[i]={v:n.getValue(o,i,a)}))[l])===B&&(d=_.Convert.wf(f.v,t,!_.ExcelCompatibleCalcMode),f[l]=d),d=A.Ul.w0a(d))):o>=this.getRowCount()||i>=this.getColumnCount()?O:this.kj.getValue(o,i,a))},N.prototype.getIdentity=function(e,t){var r=t.row,n=t.rowCount||1,o=t.column,i=t.columnCount||1;return-1===r&&(r=0,n=this.getRowCount()),-1===o&&(o=0,i=this.getColumnCount()),this.getName()+"."+r+"."+n+"."+o+"."+i},N.prototype.getReference=function(e){var t,r,n,o,i,a,s=e.row,l=e.col;if(-1===s&&(e.row=0,e.rowCount=this.getRowCount()),-1===l&&(e.col=0,e.colCount=this.getColumnCount()),t=!1,e.spillRef)if(r=this.yLb().getAnchorCell(s,l))e.rowCount=r.rowCount,e.colCount=r.colCount,t=!r.isValid;else{if(o=(n=this.getCalcSourceModel()).Qf(s,l))return o.row===s&&o.col===l?(e.rowCount=o.rowCount,e.colCount=o.colCount,new _.CalcReference(this,[e])):void 0;if(!(i=n.Kf(s,l))||33!==i.type)return i&&("@"===i.functionName||i instanceof _.ReferenceExpression)?(e.rowCount=1,e.colCount=1,new _.CalcReference(this,[e])):void 0;t=!0,e.rowCount=1,e.colCount=1}return a=new _.CalcReference(this,[e]),t&&(a.isSpillError=!0),a},N.prototype.getSources=function(e){var t,r,n,o,i;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&e instanceof N){for(t=this.kj.parent.sheets,r=!1,n=void 0,o=[],i=0;i<t.length;i++){if((n=t[i].yj())===this&&(r=!0),n===e){o.push(n);break}r&&o.push(n)}return o}},N.prototype.Ppb=function(o,i){var a,s=this.Hu,l=s&&s.arrayInfo;l&&(a=!1,l.forEach(function(e,t){if(e){var r=e.reference,n=e.key;u.call(r._identities[0],o,i)&&(delete s[n],l[t]=B,a=!0)}}),a&&(s.arrayInfo=[],l.forEach(function(e){e&&s.arrayInfo.push(e)})))},N.prototype.referenceToArray=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A=this,k=1,M=1,I=[],E=A.kj,R=A.Hu,D=j[t],N=E._modelManager,F=e.getRangeCount();if(0===F)return I.isError=!0,I;if(R&&(f=R[g=e.getRangeCount()+"_"+e.getRow(0)+"_"+e.getColumn(0)+"_"+e.getRowCount(0)+"_"+e.getColumnCount(0)+"_"+t+"_"+r]))return A.zLb(f);for(m=this.getRowCount(),b=this.getColumnCount(),r=r===B||r,y=0;y<F;y++){if(r||(d=[],I.push(d)),0===(k=e.getRowCount(y)))return I.isError=!0,A.zLb(I);if(0===(M=e.getColumnCount(y)))return I.isError=!0,A.zLb(I);if(c=e.getRow(y),h=e.getColumn(y),m<=c||b<=h)return(I=r?[O]:[[O]]).rowCount=1,I.colCount=1,I.rangeCount=1,A.zLb(I);for(m<c+k&&(k=m-c),b<h+M&&(M=b-h),w=C=void 0,v=E.Ju,S=0;S<k;S++)for(l=c+S,r||(C=[],d.push(C)),R&&(R[l]||(R[l]={}),p=R[l]),x=0;x<M;x++){if(u=h+x,v&&E.Ku===l&&E.Lu===u)f=E.Mu,v=!1;else{if(R?(w=p[u])?f=w.v:(f=U(E,N,l,u,A.Wz),w=p[u]={v:f}):f=U(E,N,l,u,A.Wz),a&&("@"===((T=E.getFormatter())instanceof G?T.formatString():T)?f=E.getText(l,u):f instanceof Date&&(f=P.Pa(f)),L(w)||(w=p[u]={v:f})),n&&_.Convert.vf(f))return(I=[f]).isError=!0,A.zLb(I);if(w&&w[D]!==B)f=w[D];else if(f=_.Convert.wf(f,t,!_.ExcelCompatibleCalcMode,i,s),w&&(w[D]=f),o&&w===f)return(I=[H]).isConvertError=!0,A.zLb(I)}_.Convert.j$a(f,i)||(r?I.push(f):C.push(f))}}return r||1!==F||(I=I[0]),I.rowCount=k,I.colCount=M,I.rangeCount=F,R&&!isNaN(F)&&!isNaN(k)&&!isNaN(M)&&F*k*M<2500&&R.arrayInfo.length<50&&(R[g]=I,R[g].rowCount=k,R[g].colCount=M,R[g].rangeCount=F,R.arrayInfo.push({reference:e,key:g})),A.zLb(I)},N.prototype.zLb=function(e){var t=[];return(t=t.concat(e)).rowCount=e.rowCount,t.colCount=e.colCount,t.rangeCount=e.rangeCount,t.isError=e.isError,t.isArray=e.isArray,t.isReference=e.isReference,t.isConvertError=e.isConvertError,t},N.prototype.getColumnCount=function(){var e=this.kj;return e.Js?0:e.getColumnCount(this.Wz)},N.prototype.getRowCount=function(){var e=this.kj;return e.Js?0:e.getRowCount(this.Wz)},N.prototype.isHiddenRow=function(e,t){var r=this.kj;return!((!r.Nu||!r.Nu())&&t)&&0===r.getRowHeight(e)},N.prototype.getName=function(){var e=this.Wz;return e===A.SheetArea.colHeader?this.kj.name()+"CH":e===A.SheetArea.rowHeader?this.kj.name()+"RH":this.kj.name()},N.prototype.yLb=function(){var e=this.ZHb;return e=e||(this.ZHb=this.kj._modelManager.ZHb)},N.prototype.setArray=function(e,t,r,n,o){return this.yLb().setArray(this,e,t,r,n,o)},N.prototype.updateItem=function(e,t,r){return this.yLb().updateItem(this,e,t,r)},N.prototype.GIb=function(e,t){this.yLb().GIb(e,t)},N.prototype.HIb=function(){this.yLb().HIb()},N.prototype.setValue=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=[];for(t=1;t<arguments.length;t++)T[t-1]=arguments[t];if(r=this.kj,i=this.Wz,(e=e).row!==B)n=e.row,o=e.col,a=1;else{if(e.name)return;n=arguments[0],o=arguments[1],a=2}s=arguments[a],l=arguments[a+1],(u=this.Hu)&&(!(c=u[n])||(h=c[o])&&(h.v=s,h.b!==B&&(h.b=B),h.d!==B&&(h.d=B),h.n!==B&&(h.n=B),h.s!==B&&(h.s=B),h.sn=B)),f=A.Ul.x0a(s),d=r._modelManager,p=!1,m=(g=r.tables)&&g.find(n,o),3===i&&m&&(b=m.showHeader()&&n===m.headerIndex(),y=m.showFooter()&&n===m.footerIndex(),b||y||(p=m.yq(n,o,f))),C=r.wq,3===i&&!p&&C&&C.Ou&&((w=C.getValue(n,o)).hasBinding&&(v=void 0,v=u?(v=(S=u.bindingRows=u.bindingRows||{})[n])||(S[n]=k({},r.getDataItem(n))):k({},r.getDataItem(n)),d.Cp(n,o,{Dp:v,Ep:w.value}),C.setValue(n,o,f,d.zTa)),p=w.hasBinding),p||("string"==typeof f&&f.hyperlink&&(x={url:f.hyperlink},d.setHyperlink&&d.do("setHyperlink",n,o,x),delete f.__proto__.hyperlink),d.do("setValue",n,o,f,i,!0,!0,arguments[a+2])),this.Iu?this.Iu.push({row:n,col:o}):this.kj.Wq(A.Events.CellChanged,{sheet:this.kj,sheetName:this.kj.name(),row:n,col:o,sheetArea:i,propertyName:"value",oldValue:l,newValue:s})},N.prototype.getCustomFunction=function(e){return this.kj?this.kj.Pu(e):O},N.prototype.getCustomName=function(e){e=o(e);var t=this.kj?this.kj.getCustomName(e):O;return t?t.getExpression():O},N.prototype.getSheet=function(){return this.kj},N.prototype.setFormula=function(e,t,r){},N.prototype.setArrayFormula=function(e,t,r,n,o){},N.prototype.setFormulaByName=function(e,t){},N.prototype.refresh=function(){this.kj.repaint()},N.prototype.toJSON=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=t,v=e.data||{},S=!0,x=this.Cf();for(x.UIc=!0,c=0;c<=r;c++)if(i=v.dataTable||{},a=w[c]){for(S=!(l=i[c]),l=l||{},h=0;h<=n;h++)if((s=a[h])&&s.Lf){u=l[h]||{};try{f=x.unparse(this,s.Lf,c,h,!1,!0),d=-1<f.indexOf("LET(")&&"LET",p=void 0,d&&(T(u.prefix)&&(u.prefix={}),f=(p=f).replace(/_xlpm\./g,"")),!s.Pf&&f&&0===f.indexOf("@")&&z(this.kj,f.slice(1,f.length),0,0)&&(f=f.slice(1,f.length),d&&(p=p.slice(1,p.length))),s.Pf?s.Pf.row===c&&s.Pf.col===h&&(u.arrayInfo=s.Pf,u.formula=f,d&&(u.prefix[d]=p)):(u.formula=f,d&&(u.prefix[d]=p)),S=!1,l[h]=u}catch(e){}}if(S){if(i!==v.dataTable)continue}else i[c]=l;v.dataTable=i}if(o){for(g=v.columnDataArray||[],m=0;m<o.length;m++)(b=o[m])&&b.Lf&&(y=this.Cf().unparse(this,b.Lf,0,m,!1,!0),(C=g[m]||{}).formula=y,g[m]=C);0<g.length&&(v.columnDataArray=g)}L(v)||(e.data=v),delete x.UIc},f=N,(t.SheetSource=f).prototype.getParserContext=function(e,t,r){return t=t||_._createCellIdentity(0,0),new h(this.kj,e,t,r)},S=_.CalcSource,M(D,S),D.prototype.getCustomFunction=function(e){return this.Qu?this.Qu.getCustomFunction(e):O},D.prototype.getCustomName=function(e){var t=this.Qu?this.Qu.getCustomName(e)||this.Qu.aJb(e):O;return t?t.getExpression():O},t.SpreadSource=D,t.formulaToExpression=F,t.expressionToFormula=function(e,t,r,n,o,i){var a,s=e&&e instanceof A.Worksheet&&e,l=new _.Parser;return r=r===B?0:r,n=n===B?0:n,(a=new h(s,!!o,_._createCellIdentity(r,n))).YSa=i,l.unparse(a,t)},t.evaluateFormula=function(e,t,r,n,o){return r===B&&(r=0),n===B&&(n=0),W(e,F(e,t,r,n,o,!0),r,n)},t.evaluateExpression=W,t.rangeToExpression=V,t.rangeToFormula=function(e,t,r,n,o){var i=V(e,t,r,n),a=new h(O,!!o,_._createCellIdentity(t,r)),s=(new _.Parser).unparse(a,i);return a.no(),s},t.rangeToFormulaWithStructReference=function(e,t,r,n,o,i,a){var s=V(t,r,n,o,a),l=new h(e,!!i,_._createCellIdentity(r,n));return(new _.Parser).unparse(l,s)},t.formulaToRange=z,t.formulaToRanges=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g=[],m=[];if(!t)return g;for(i={},r=r||0,n=n||0,a=new _.Parser,s=b.qzb(a,t,e,r,n,B,o),l=0;l<s.length;l++)if((u=s[l].sheetRanges)&&!L(u))for(c=0;c<u.sheets.length;c++)for((m=i[h=u.sheets[c]])||(i[h]=m=[],g.push({sheetName:h,ranges:m})),f=u[h],d=0;d<f.length;d++)p=f[d],m.push(new A.Range(p.row,p.col,p.rowCount,p.colCount));return g},t.rangesToFormula=function(e,t,r,n,o){var i=new _.Parser,a=new h(O,!!o,_._createCellIdentity(t,r)),s=q(i,a,e,t,r,n);return a.no(),s},t.ALb=q,t.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},t.goalSeek=function(e,t,r,n,o,i,a){var s,l,u,c,h=n.getValue(t,r),f=!1,d=(w(h)?+h:0)-a,p=n.getValue(o,i),g=(w(p)?+p:0)-a;if(w(p)&&Math.abs(g)<.001)f=!0;else if(C(p))f=!1;else for(s=d+(0===d?.01:.01*d),u=0;!f&&u<100;u++)s=m.Common.o.Lma(s,13),e.setValue(t,r,s),p=n.getValue(o,i),l=(w(p)?+p:0)-a,w(p)&&Math.abs(l)<.001?f=!0:s=C(p)?(d+s)/2:d-s==0?d+(0===d?.01:.01*d):g-l==0?d+2*(s-d):(c=s-l*(d-s)/(g-l),d=s,g=l,c);return f||e.setValue(t,r,h),f}},"./dist/plugins/sheetsCalc/calc.ns.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BAND_INDEX_CONST=-2147483648,t.MAX_ROW_COUNT=1048576,t.MAX_COLUMN_COUNT=16384},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(e,t,r){"use strict";var ne,n,oe,T,F,o,w,G,a,ie,ae,v,S,U,W,i;function s(e,t){var r,n,o,i;return t=t||this,r=a(e.row,t.row),n=a(e.column,t.column),o=G(e.row+e.rowCount,t.row+t.rowCount),i=G(e.column+e.columnCount,t.column+t.columnCount),o<=r||i<=n?ae:{row:r,column:n,rowCount:o-r,columnCount:i-n,intersectWith:s}}function l(e,t,r,n,o,i,a,s){this.Rj=e,this.Vj=t,this.Wj=r,this.Qj=n,this.Tj=o,this.Uj=i,this.Xj=a,this.Yj=s}function E(e,t,r,n){return(!n||e<t)&&r}function V(e,t,r,n){var o=e[t];(o=o||(e[t]={}))[r]=n}function z(e,t,r){var n=e[t];return n&&n[r]}function q(){}function x(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g;return 0<=r||!o?(f=n+(o?r:0),d=i+(a?r:0),p=c&&I(s,e,c),g=!c&&I(s,e,c),(p||g)&&(!h&&l+u<=r||h&&l<=r)&&(f-=o?u:0,d-=a?u:0),p=c&&I(s,t,c),g=!c&&I(s,t,c),(p||g)&&(!h&&l<=f||h&&(o&&l<=r+n||!o&&l<=n)?(f+=u,d+=u):(!h&&l<=d||h&&(a&&l<=r+i||!a&&l<=i))&&(d+=u)),f-=o?r:0,d-=a?r:0,h&&l+u<=r&&(f+=o?u:0,d+=a?u:0),{index:f,endIndex:d}):{index:n,endIndex:i}}function A(e,t,r,n,o,i,a,s,l,u,c,h){if(t&&!h){var f=l?o.row:o.column,d=l?o.rowRelative:o.columnRelative,p=void 0;if(l&&0<=r||!l&&0<=n||!d){if(u)p=x(e,t,l?r:n,f,d,-1,!1,i,a,s,l,c).index;else if(p=function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p;if(0<=r||!o){if(c=n+(o?r:0),h=l&&I(i,e,l),f=!l&&I(i,e,l),(h||f)&&a<=r&&(c+=o?s:0),h=l&&I(i,t,l),f=!l&&I(i,t,l),h||f)if(d=r+n,p=r+s+n,!u&&a+s<=c||u&&a+s<=d)c-=s;else if(!u&&a<=c||u&&a<=d&&a<=p&&p<=a+s)return S;return c-=o?r:0,u&&a<=r&&(c-=o?s:0),c}return n}(e,t,l?r:n,f,d,i,a,s,l,c),v(p))return ne.Hh(p);p!==f&&(o=o.offset(l?p-f:0,l?0:p-f,!0))}}return o}function k(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C;if(t&&!h){if(3===(f=o.tf())||l&&2===f||!l&&1===f)return o;if(d=l?o.rowRelative:o.columnRelative,p=l?o.endRowRelative:o.endColumnRelative,g=l?o.row:o.column,m=l?o.endRow:o.endColumn,b=void 0,l&&0<=r||!l&&0<=n||!d||!p){if(u)b=x(e,t,l?r:n,g,d,m,p,i,a,s,l,c);else if(b=function(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y;if(0<=r||!o){if(f=n+(o?r:0),d=i+(a?r:0),p=l+u-1,g=c&&I(s,e,c),m=!c&&I(s,e,c),(g||m)&&l<=r&&(f+=o?u:0,d+=a?u:0),g=c&&I(s,t,c),m=!c&&I(s,t,c),g||m)if(b=r+n,y=r+i,!h&&p<f||h&&p<b)f-=u,d-=u;else{if(!h&&l<=f&&d<=p||h&&l<=b&&y<=p)return S;!h&&d<l||h&&y<l||(!h&&p<=d||h&&p<=y?(f=!h&&f<=l||h&&b<=l?f:l,d-=u):d=l-1)}return f-=o?r:0,d-=a?r:0,h&&l<=r&&(f-=o?u:0,d-=o?u:0),{index:f,endIndex:d}}return{index:n,endIndex:i}}(e,t,l?r:n,g,d,m,p,i,a,s,l,c),v(b))return ne.Hh(b);y=b.index,C=b.endIndex,y===g&&C===m||(o=o.offset2(l?y-g:0,l?0:y-g,l?C-m:0,l?0:C-m,r,n))}}return o}function M(e,t,r,n,o,i,a,s,l,u,c,h){var f,d,p,g,m,b,y,C,w=M,v=n;if(n){if(1===n.type&&n.sf()||33===n.type)v=A(e,n.source||e,t,r,n,o,i,a,s,l,c,h);else if(1===n.type)v=k(e,n.source||e,t,r,n,o,i,a,s,l,c,h);else if(10===n.type)(f=w(e,t,r,n.value,o,i,a,s,l,ie,c,h))!==n.value&&(v=ne.Lh(f));else if(9===n.type)d=w(e,t,r,n.value,o,i,a,s,l,ie,c,h),p=n.value2&&w(e,t,r,n.value2,o,i,a,s,l,ie,c,h),d===n.value&&p===n.value2||(v=ne.Kh(n.operatorType,d,p));else if(7===n.type){for(g=ae,b=m=void 0,C=(y=n).arguments.length,b=0;b<C;b++)if((f=w(e,t,r,m=y.arguments[b],o,i,a,s,l,ie,c,h))!==m){(g=[])[b]=f;break}if(g){for(b=0;b<C;b++)m=y.arguments[b],g[b]!==ie&&g[b]!==ae||(g[b]=w(e,t,r,m,o,i,a,s,l,ie,c,h));v=ne.Jh(y,g)}}else c||s||13!==n.type||(v=function(e,t,r,n,o){if(e){if(t)return t.offsetWhenInsertRemoveColumn(r,n,o)}return t}(e,n,i,a,l));return v}}function h(o,i,a,s,e,t,r,n,l,u){var c=o.getSheet(),h=c.uja&&(c.parent||c).tja(),f=c._modelManager&&c._modelManager.dUa();!function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x;if(e)for(u=0;u<e.length;u++){for(h=c=!0,f=T.maxRowCount-1,d=T.maxColumnCount-1,o=e[u].validator,p=o.n5,g=0,m=p.length;g<m&&(b=p[g],y=b.rowCount,C=b.colCount,s=b.row,l=b.col,-1!==y&&(h=!1,f=s<f?s:f),-1!==C&&(c=!1,d=l<d?l:d),c||h);g++);if(!(r&&h||!r&&c)&&(a=e[u].sheet,w=a.yj(),i=o.condition(),(v=i.getExpressions())&&0<v.length)){for(S=0;S<v.length;S++)x=v[S],v[S]=t(w,x,f,d);i.setExpressions(v,n)}}}(h,function(e,t,r,n){return i.call(this,e,r,n,t,o,a,s,l,u)},l,f)}function Z(e){var n=[],t=e.parent;return(t&&t.sheets||[e]).forEach(function(t){var e=t.conditionalFormats,r=e&&e.getRules();r&&r.length&&r.forEach(function(e){e.xyb&&n.push({rule:e,sheet:t})})}),n}function f(o,i,a,s,l,u){var e=o.getSheet();Y(Z(e),function(e,t,r,n){return i.call(this,e,r,n,t,o,a,s,l,u)},e._modelManager&&e._modelManager.dUa(),l,u)}function Y(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N;if(e)for(i=0,a=e.length;i<a;i++){if(l=(s=e[i].rule).ranges(),c=(u=U(l)).r,h=u.c,d=(f=e[i].sheet).yj(),p=s.condition(),(g=f.tables)&&l&&1===l.length&&(b=(m=l[0]).row,y=m.col,C=m.rowCount,w=m.colCount,v=void 0,o&&n?v=g.KFc(b,y,C,w):f.dJb&&f.zFc&&(v=[f.zFc]),v&&v.length)){for(S=!1,x=0,T=v.length;x<T;x++)if(k=(A=v[x]).row,M=A.col,I=A.rowCount,E=A.colCount,b===k&&C===I&&M<=y&&y+w<=M+E){S=!0;break}if(S)continue}if(p||(s.initCondition(),p=s.condition()),(R=p&&p.getExpressions())&&0<R.length){for(D=0;D<R.length;D++)N=R[D],R[D]=t(d,N,c,h);p.setExpressions(R,r)}}}function I(e,t,r){var n=r?{2:!0}:{1:!0};return e===t||e.kj===t.kj&&(3===e.Wz&&n[t.Wz]||n[e.Wz]&&3===t.Wz)}function R(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y=R,C=t;if(t)if(t.source)if(a=t.source,(s=t.endSource)&&a!==s){if(!(l=a.kj&&a.kj.parent))return ne.Ih;s===r?(u=r.VDc,C.endSource=l.getSheet(u-1).yj()):a===r&&(c=r.VDc,C.source=l.getSheet(c).yj()),delete r.VDc,C.source===C.endSource&&delete C.endSource}else(e!==r&&a===r||e===r&&a!==r)&&(C=ne.Ih);else if(10===t.type)(n=y(e,t.value,r))!==t.value&&(C=ne.Lh(n));else if(9===t.type)h=y(e,t.value,r),f=t.value2&&y(e,t.value2,r),h===t.value&&f===t.value2||(C=ne.Kh(t.operatorType,h,f));else if(7===t.type){for(d=ae,p=t.arguments.length,i=0;i<p;i++)if((n=y(e,o=t.arguments[i],r))!==o){(d=[])[i]=n;break}if(d){for(i=0;i<p;i++)o=t.arguments[i],d[i]!==ie&&d[i]!==ae||(d[i]=y(e,o,r));C=ne.Jh(t,d)}}else 8===t.type&&(g=e||r,m=w(t.value),(b=g.getCustomName(m))&&b.source?a=b.source:(b=(g._service.getGlobalSourceModel()||g.getCalcSourceModel()).getSource().getCustomName(m))&&b.source&&(a=b.source),a&&(e!==r&&a===r||e===r&&a!==r)&&(C=ne.Ih));return C}function u(e,t,r,n,o){return R(e,n,o)}function D(e,t,r,n,o,i,a,s){return a?ne.BLb(s,e,t,r,n,o,i):ne.rf(e,t,r,n,o,i)}function _(e,t){if(!(t=e.getIntersect(t,0,0)))return ae;var r=e.row,n=e.col,o=e.rowCount,i=e.colCount;return e.rowCount===t.rowCount&&e.colCount===t.colCount||(e.rowCount===t.rowCount?(e.col===t.col&&(n=e.col+t.colCount),i=e.colCount-t.colCount):e.colCount===t.colCount&&(e.row===t.row&&(r=e.row+t.rowCount),o=e.rowCount-t.rowCount)),F.kf(r,n,o,i)}function P(e,t,r,n){var o,i=_(e,t);return i?(o=i.union(r),n?(o.col=e.col,o.colCount=e.colCount):(o.row=e.row,o.rowCount=e.rowCount)):o=r,{startRow:o.row,endRow:o.row+o.rowCount-1,startColumn:o.col,endColumn:o.col+o.colCount-1}}function L(e,t,r,n,o){var i,a=_(e,t),s=e.getIntersect(t,0,0);return s?(s.row+=n,s.col+=o,{startRow:(i=a?a.union(s):r).row,endRow:i.row+i.rowCount-1,startColumn:i.col,endColumn:i.col+i.colCount-1}):ae}function O(e,t){var r=e.row,n=e.col,o=e.rowCount,i=e.colCount,a=t.row,s=t.col,l=t.rowCount,u=t.colCount;return 1===o&&1!==i?s<n&&n<=s+u-1||s<=n+i-1&&n+i-1<s+u-1:1!==i||1===o||a<r&&r<=a+l-1||a<=r+o-1&&r+o-1<a+l-1}function se(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C=(c=o,h=i,f=n.getRange(c,h),F.kf(f.row,f.col,f.rowCount,f.colCount)),w=C.row,v=C.row+C.rowCount-1,S=C.col,x=C.col+C.colCount-1,T=e.Vj,A=T+e.Xj-1,k=e.Wj,M=k+e.Yj-1,I=e.Tj,E=e.Uj,R=F.kf(T,k,e.Xj,e.Yj),D=F.kf(I,E,e.Xj,e.Yj),N=C.getIntersect(D,0,0);if(d=R,g=D,m=t,b=r,(p=C)&&d&&(!(y=p.getIntersect(d,0,0))&&p.getIntersect(g,0,0)||y&&y.rowCount===p.rowCount&&0!==b||y&&y.colCount===p.colCount&&0!==m))if(u=l=void 0,s=0!==t)if(u=T<=v&&v<=A,(l=T<=w&&w<=A)&&u)w+=t,v+=t;else if(l&&!u){if(t<=0)w+=t;else if(!(v<T+t)){if(!(A+t<v))return L(C,R,D,t,r);if(T===w)return P(C,R,D,s);w+=t}}else if(!l&&u){if(0<=t)v+=t;else if(!(A+t<w)){if(!(w<I))return L(C,R,D,t,r);if(A===v)return P(C,R,D,s);v+=t}}else N&&!N.equals(D)&&O(C,D)&&(w=(a=_(C,N)).row,v=a.row+a.rowCount-1,S=a.col,x=a.col+a.colCount-1);else if(u=k<=x&&x<=M,(l=k<=S&&S<=M)&&u)S+=r,x+=r;else if(l&&!u){if(r<0)S+=r;else if(!(x<k+r)){if(!(M+r<x))return L(C,R,D,t,r);if(k===S)return P(C,R,D,s);S+=r}}else if(!l&&u){if(0<r)x+=r;else if(!(M+r<S)){if(!(S<E))return L(C,R,D,t,r);if(M===x)return P(C,R,D,s);x+=r}}else N&&!N.equals(D)&&O(C,D)&&(w=(a=_(C,N)).row,v=a.row+a.rowCount-1,S=a.col,x=a.col+a.colCount-1);return{startRow:w,endRow:v,startColumn:S,endColumn:x}}function K(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p=K,g=n;if(1===n.type&&n.sf()||33===n.type)g=i?function(e,t,r,n,o,i){var a,s,l,u,c,h,f=!!n.source,d=n.source||e,p=n.rowRelative,g=n.columnRelative,m=o.Nj(),b=o.Oj(),y=33===n.type,C=y&&n.contextSource;if((0<=t||!p)&&(0<=r||!g)){if(a=n.row+(p?t:0),s=n.column+(g?r:0),i&&i.isNameID||e===o.Rj&&(u=e===o.Qj?o.Pj(o.Qj,t,r,1,1):(c=t,h=r,i&&i.crossSheetMoved&&(c-=m,h-=b),o.Sj(o.Rj,c,h,1,1))),d===o.Qj&&o.Pj(d,a,s,1,1)&&!o.Sj(d,a,s,1,1)&&(!p&&!g||!u))return ne.Ih;if(l=(f&&d===o.Rj||!f&&e===o.Rj)&&(!u&&o.Sj(o.Rj,a,s,1,1)||u&&o.Pj(o.Qj,p?a:a+m,g?s:s+b,1,1)),u&&(a-=p?m:0,s-=g?b:0),l&&(a+=m,s+=b),a-=p?t:0,s-=g?r:0,d=n.source,o.Rj!==o.Qj&&(l&&u?f&&(d=o.Qj):l?d=o.Qj:u&&!f&&(d=o.Rj)),a!==n.row||s!==n.column||d!==n.source)return D(d,ae,a,s,p,g,y,C)}else if((0<=t||!p)&&-1===r){if(a=n.row+(p?t:0),o.Pj(e,t,r,1,1)&&(a-=p?m:0),o.Sj(d,a,-1,1,-1))a+=m;else if(o.Pj(d,a,-1,1,-1))return ne.Ih;if((a-=p?t:0)!==n.row)return D(n.source,ae,a,n.column,p,n.columnRelative,y,C)}else if(-1===t&&0<=r&&!g){if(s=n.column+(g?r:0),o.Pj(e,t,r,1,1)&&(s-=g?b:0),o.Sj(d,a,s,1,1))s+=b;else if(o.Pj(d,a,s,1,1))return ne.Ih;if(s-=g?r:0,a!==n.row||s!==n.column)return D(n.source,n.endSource,n.row,s,n.rowRelative,g,y,C)}return n}(e,t,r,n,o,a):function(e,t,r,n,o){var i,a,s=n.source||e,l=n.rowRelative,u=n.columnRelative,c=o.Nj(),h=o.Oj(),f=33===n.type,d=f&&n.contextSource;if((0<=t||!l)&&(0<=r||!u)){if(i=n.row+(l?t:0),a=n.column+(u?r:0),o.Pj(e,t,r,1,1)?(i-=l?c:0,a-=u?h:0):o.Sj(e,i,a,1,1)&&(i+=l?c:0,a+=u?h:0),o.Sj(s,i,a,1,1)?(i+=c,a+=h):o.Pj(s,i,a,1,1)&&(i-=c,a-=h),a-=u?r:0,(i-=l?t:0)!==n.row||a!==n.column)return D(n.source,ae,i,a,l,u,f,d)}else if((0<=t||!l)&&-1===r){if(i=n.row+(l?t:0),o.Pj(e,t,-1,1,-1)?i-=l?c:0:o.Sj(e,i,-1,1,-1)&&(i+=l?c:0),o.Sj(s,i,-1,1,-1)?i+=c:o.Pj(s,i,-1,1,-1)&&(i-=c),(i-=l?t:0)!==n.row||a!==n.column)return D(n.source,ae,i,n.column,l,n.columnRelative,f,d)}else if(-1===t&&0<=r&&!u&&(a=n.column+0,o.Pj(e,-1,r,-1,1)?a-=0:o.Sj(e,-1,a,-1,1)&&(a+=0),o.Sj(s,-1,a,-1,1)?a+=h:o.Pj(s,-1,a,-1,1)&&(a-=h),a-=0,i!==n.row||a!==n.column))return D(n.source,ae,n.row,a,n.rowRelative,u,f,d);return n}(e,t,r,n,o);else if(1===n.type)g=i?function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K=!!n.source,X=K?n.source:e,J=n.tf(),Q=o.Nj(),$=o.Oj(),ee=i&&i.isDataValidator,te=(Y=e,(Z=o).Qj===Z.Rj&&Y!==Z.Qj),re=!1;if(0===J)if(a=n.rowRelative,s=n.columnRelative,l=n.endRowRelative,u=n.endColumnRelative,0<=t||!a||!l||0<=r||!s||!u){if(c=n.row+(a?t:0),h=n.endRow+(l?t:0),f=n.column+(s?r:0),p=h-c+1,g=(d=n.endColumn+(u?r:0))-f+1,!ee&&te){if(o.Sj(o.Rj,c,f,p,g))return n.offset(Q,$,!0);if(o.Pj(X,c,f,p,g))return ne.Ih;if(X!==o.Rj||X!==o.Qj||0!==Q&&0!==$)return n;re=!0}if(i&&i.isNameID||e===o.Rj&&(C=e===o.Qj?o.Pj(o.Qj,t,r,1,1):(w=t,v=r,i&&i.crossSheetMoved&&(w-=Q,v-=$),o.Sj(o.Rj,w,v,1,1))),(re||e===X&&e===o.Rj&&e===o.Qj)&&(S=t,x=r,C&&(S-=Q,x-=$),0===Q||0===$)){if(!(T=se(o,Q,$,n,S,x)))return ne.Ih;if(0===$&&Q&&T.endColumn>=d&&T.startColumn<=f||0===Q&&$&&T.endRow>=h&&T.startRow<=c)return A=T.startRow,k=T.startColumn,M=T.endRow,I=T.endColumn,A===c&&M===h&&k===f&&I===d?n:(a&&(A-=t),l&&(M-=t),s&&(k-=r),u&&(I-=r),ne.uf(n.source,ae,A,k,M,I,a,s,l,u,t,r))}if(C&&(E=o.Tj-o.Vj,R=o.Uj-o.Wj,p+=(a?-E:0)+(l?E:0),g+=(s?-R:0)+(u?R:0)),X===o.Qj&&o.Pj(X,c,f,p,g)&&!g&&(!a&&!s&&!l&&!u||!C))return ne.Ih;if(y=(K&&X===o.Rj||!K&&e===o.Rj)&&(!C&&o.Sj(o.Rj,c,f,p,g)||C&&o.Pj(o.Qj,a?c:c+Q,s?f:f+$,p,g)),C&&(c-=a?Q:0,h-=l?Q:0,f-=s?$:0,d-=u?$:0),D=!1,y)c+=m=Q,h+=m,f+=b=$,d+=b;else if(o.Pj(X,c,f,p,g)){if(!(N=o.intersectWith(X,c,f,p,g))||N.rowCount!==p&&N.colCount!==g)return ne.Ih;c=N.row+Q,f=N.col+$,h=c+N.rowCount,d=f+N.colCount,D=!0}if(c-=a?t:0,h-=l?t:0,f-=s?r:0,d-=u?r:0,o.Rj===o.Qj?X=K?n.source:ie:(X=n.source,y&&C&&K?X=o.Qj:y&&C||(y?X=o.Qj:C&&!K&&(X=o.Rj))),c!==n.row||f!==n.column||h!==n.endRow||d!==n.endColumn||D||X!==n.source)return ne.uf(X,ae,c,f,h,d,a,s,l,u,t,r)}else if(!(0<=t)&&a&&l||-1!==r){if(-1===t&&(0<=r||!s||!u)){if(f=n.column+(s?r:0),(d=n.endColumn+(u?r:0))<f)return ne.Ih;if(o.Pj(e,t,r,1,1)&&(f-=s?$:0,d-=u?$:0),g=d-f+1,o.Sj(X,-1,f,-1,g))f+=b=$,d+=b;else if(o.Pj(X,-1,f,-1,g))return ne.Ih;if(d-=u?r:0,(f-=s?r:0)!==n.column||d!==n.endColumn)return ne.uf(n.source,ae,n.row,f,n.endRow,d,n.rowRelative,s,n.endRowRelative,u,t,r)}}else{if(c=n.row+(a?t:0),(h=n.endRow+(l?t:0))<c)return ne.Ih;if(o.Pj(e,t,r,1,1)&&(c-=a?Q:0,h-=l?Q:0),p=h-c+1,o.Sj(X,c,-1,p,-1))c+=m=Q,h+=m;else if(o.Pj(X,c,-1,p,-1))return ne.Ih;if(h-=l?t:0,(c-=a?t:0)!==n.row||h!==n.endRow)return ne.uf(n.source,ae,c,n.column,h,n.endColumn,a,n.columnRelative,l,n.endColumnRelative,t,r)}else if(1===J){if(a=n.rowRelative,l=n.endRowRelative,0<=t||!a||!l){if(c=n.row+(a?t:0),(h=n.endRow+(l?t:0))<c)return ne.Ih;if(C=e===o.Rj&&e===o.Qj&&o.Pj(o.Qj,t,r,1,1),X===o.Rj&&X===o.Qj&&0===o.Wj&&0===o.Uj&&o.Yj===X.getColumnCount()){if(F=o.Vj,_=o.Tj,C&&(c-=Q,h-=Q),L=F+(P=o.Xj),B=F<=h&&h<L,(O=F<=c&&c<L)&&B)return C?n:n.offset(Q,$,!0);if(j=_+P,O&&_<=h?(c+=Q,h<j&&_<=h&&(h=j-1,c=L)):B&&c<=j&&(h+=Q,_<=c&&f<j&&(c=_,h=F-1)),h-=l?t:0,(c-=a?t:0)!==n.row||h!==n.endRow)return ne.uf(n.source,n.endSource,c,oe.BAND_INDEX_CONST,h,oe.BAND_INDEX_CONST,a,s,l,u,t,r)}if(C)return n.offset(-Q,$,!0)}}else if(2===J){if(s=n.columnRelative,u=n.endColumnRelative,f=n.column+(s?r:0),(d=n.endColumn+(u?r:0))<f)return ne.Ih;if(C=e===o.Rj&&e===o.Qj&&o.Pj(o.Qj,t,r,1,1),X===o.Rj&&X===o.Qj&&0===o.Vj&&0===o.Tj&&o.Xj===X.getRowCount()){if(H=o.Wj,G=o.Uj,C&&(f-=$,d-=$),W=H+(U=o.Yj),z=H<=d&&d<W,(V=H<=f&&f<W)&&z)return C?n:n.offset(Q,$,!0);if(q=G+U,V&&G<=d?(f+=$,d<q&&G<=d&&(d=q-1,f=W)):z&&f<=q&&(d+=$,G<=f&&f<q&&(f=G,d=H-1)),d-=u?r:0,(f-=s?r:0)!==n.column||d!==n.endColumn)return ne.uf(n.source,n.endSource,oe.BAND_INDEX_CONST,f,oe.BAND_INDEX_CONST,d,a,s,l,u,t,r)}if(C)return n.offset(Q,-$,!0)}return n}(e,t,r,n,o,a):function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b=n.source||e,y=n.tf(),C=o.Nj(),w=o.Oj();if(0===y){if(h=n.rowRelative,f=n.columnRelative,d=n.endRowRelative,p=n.endColumnRelative,!(0<=t)&&h&&d||!(0<=r)&&f&&p)if(!(0<=t)&&h&&d||-1!==r){if(-1===t&&(0<=r||!f||!p)){if(s=n.column+(f?r:0),l=n.endColumn+(p?r:0),s<l)return ne.Ih;if(o.Pj(e,-1,r,-1,1)?(s-=f?w:0,l-=p?w:0):o.Sj(e,-1,r,-1,1)&&(s+=f?w:0,l+=p?w:0),c=l-s,o.Sj(b,-1,s,-1,c)?(s+=m=w,l+=m):o.Pj(b,-1,s,-1,c)&&(s-=m=w,l-=m),l-=p?r:0,(s-=f?r:0)!==n.column||l!==n.endColumn)return ne.uf(n.source,ae,s,n.endRow,l,n.rowRelative,f,n.endRowRelative,p,t,r)}}else{if(i=n.row+(h?t:0),a=n.endRow+(d?t:0),i<a)return ne.Ih;if(o.Pj(e,t,-1,1,-1)?(i-=h?C:0,a-=h?C:0):o.Sj(e,t,-1,1,-1)&&(i+=h?C:0,a+=h?C:0),u=a-i,o.Sj(b,i,-1,u,-1)?(i+=g=C,a+=g):o.Pj(b,i,-1,u,-1)&&(i-=g=C,a-=g),a-=d?t:0,(i-=h?t:0)!==n.row||a!==n.endRow)return ne.uf(n.source,ae,i,n.column,a,n.endColumn,h,n.columnRelative,d,n.endColumnRelative,t,r)}else if(i=n.row+(h?t:0),a=n.endRow+(d?t:0),s=n.column+(f?r:0),l=n.endColumn+(p?r:0),u=a-i,c=l-s,o.Pj(e,t,r,1,1)?(i-=h?C:0,a-=d?C:0,s-=f?w:0,l-=p?w:0):o.Sj(e,i,s,u,c)&&(i+=h?C:0,a+=d?C:0,s+=f?w:0,l+=p?w:0),o.Sj(b,i,s,u,c)?(i+=g=C,a+=g,s+=m=w,l+=m):o.Pj(b,i,s,u,c)&&(i-=g=C,a-=g,s-=m=w,l-=m),a-=d?t:0,s-=f?r:0,l-=p?r:0,(i-=h?t:0)!==n.row||s!==n.column||a!==n.endRow||l!==n.endColumn)return ne.uf(n.source,ae,i,s,a,l,h,f,d,p,t,r)}else if(1===y){if(h=n.rowRelative,d=n.endRowRelative,0<=t||!h||!d){if(i=n.row+(h?t:0),a=n.endRow+(d?t:0),i<a)return ne.Ih;if(o.Pj(e,t,-1,1,-1)?(i-=h?C:0,a-=d?C:0):o.Sj(e,t,-1,1,-1)&&(i+=h?C:0,a+=d?C:0),u=a-i,o.Sj(b,i,-1,u,-1)?(i+=g=C,a+=g):o.Pj(b,i,-1,u,-1)&&(i-=g=C,a-=g),a-=d?t:0,(i-=h?t:0)!==n.row||a!==n.endRow)return ne.uf(n.source,ae,i,oe.BAND_INDEX_CONST,a,oe.BAND_INDEX_CONST,h,!1,d,!1,t,r)}}else if(2===y){if(f=n.columnRelative,p=n.endColumnRelative,s=n.column+(f?r:0),(l=n.endColumn+(p?r:0))<s)return ne.Ih;if(o.Pj(e,-1,r,-1,1)?(s-=f?w:0,l-=p?w:0):o.Sj(e,-1,r,-1,1)&&(s+=f?w:0,l+=p?w:0),c=l-s,o.Sj(b,-1,s,-1,c)?(s+=m=w,l+=m):o.Pj(b,-1,s,-1,c)&&(s-=m=w,l-=m),l-=p?r:0,(s-=f?r:0)!==n.column||l!==n.endColumn)return ne.uf(n.source,ae,oe.BAND_INDEX_CONST,s,oe.BAND_INDEX_CONST,l,!1,f,!1,p,t,r)}return n}(e,t,r,n,o);else if(10===n.type)(s=p(e,t,r,n.value,o,i,a))!==n.value&&(g=ne.Lh(s));else if(9===n.type)l=p(e,t,r,n.value,o,i,a),u=n.value2&&p(e,t,r,n.value2,o,i,a),l===n.value&&u===n.value2||(g=ne.Kh(n.operatorType,l,u));else if(7===n.type){for(c=ae,f=h=void 0,d=n.arguments.length,f=0;f<d;f++)if((s=p(e,t,r,h=n.arguments[f],o,i,a))!==h){(c=[])[f]=s;break}if(c){for(f=0;f<d;f++)h=n.arguments[f],c[f]!==ie&&c[f]!==ae||(c[f]=p(e,t,r,h,o,i,a));g=ne.Jh(n,c)}}return g}function N(e,t,r,n,o,i){e._g(t,r,n,o,!0,!1,i)}function d(e,t,r){var n,o,i,a,s,l,u,c=d,h=t;if(8===t.type){if(t.value===r&&(!t.source||t.source===e.getSource()))return ne.Hh(S,t.source)}else if(10===t.type)(n=c(e,t.value,r))!==t.value&&(h=ne.Lh(n));else if(9===t.type)a=c(e,t.value,r),s=t.value2&&c(e,t.value2,r),a===t.value&&s===t.value2||(h=ne.Kh(t.operatorType,a,s));else if(7===t.type){for(l=ae,u=t.arguments.length,i=0;i<u;i++)if((n=c(e,o=t.arguments[i],r))!==o){(l=[])[i]=n;break}if(l){for(i=0;i<u;i++)o=t.arguments[i],l[i]!==ie&&l[i]!==ae||(l[i]=c(e,o,r));h=ne.Jh(t,l)}}return h}Object.defineProperty(t,"__esModule",{value:!0}),ne=r("@grapecity/js-calc"),n=r("@grapecity/js-sheets-common"),oe=r("./dist/plugins/sheetsCalc/calc.ns.js"),T=r("./dist/plugins/sheetsCalc/parser-sheets.js"),F=r("Core"),o=n.Common.u,w=o.Nb,G=Math.min,a=Math.max,ie=void 0,ae=null,v=ne.Convert.vf,S=ne.Errors.Reference,U=F.util.l_a,l.prototype.Nj=function(){return this.Tj-this.Vj},l.prototype.Oj=function(){return this.Uj-this.Wj},l.prototype.Sj=function(e,t,r,n,o){return this.Rj===e&&(-1===this.Vj||this.Vj<=t&&t+n<=this.Vj+this.Xj)&&(-1===this.Wj||this.Wj<=r&&r+o<=this.Wj+this.Yj)},l.prototype.Pj=function(e,t,r,n,o){return this.Qj===e&&(-1===this.Tj||this.Tj<=t&&t+n<=this.Tj+this.Xj)&&(-1===this.Uj||this.Uj<=r&&r+o<=this.Uj+this.Yj)},l.prototype.intersectWith=function(e,t,r,n,o){var i;return this.Qj!==e?ae:(i=this.Zj(e,t,r,n,o),this.Zj(e,this.Vj,this.Wj,n,o).intersectWith(i))},l.prototype.Zj=function(e,t,r,n,o){return{row:-1===t?0:t,column:-1===r?0:r,rowCount:-1===t||-1===n?e.rowCount:n,columnCount:-1===r||-1===o?e.colCount:o,intersectWith:s}},W=l,t.MoveSwapInfo=W,q.zj=function(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m=r,b=q,y=this.zj;if(!r)return m;if(10===(d=r.type))m=ne.Lh(y.call(b,e,t,r.value,n,o,i,a,s,l,u,c));else if(1===d&&r.sf()||33===d){if(h=G((r.source||t).getRowCount(),oe.MAX_ROW_COUNT),f=G((r.source||t).getColumnCount(),oe.MAX_COLUMN_COUNT),r.rowRelative&&(r.row+n<0||r.row+n>=h)||r.columnRelative&&(r.column+o<0||r.column+o>=f))return ne.Hh(S,r.source);m=r.offset(0,0,!1)}else if(1===d){if(h=G((r.source||t).getRowCount(),oe.MAX_ROW_COUNT),f=G((r.source||t).getColumnCount(),oe.MAX_COLUMN_COUNT),r.rowRelative&&!r.isFullColumn&&(r.row+n<0||r.row+n>h)||r.columnRelative&&!r.isFullRow&&(r.column+o<0||r.column+o>f)||r.endRowRelative&&!r.isFullColumn&&(r.endRow+n<0||r.endRow+n>h)||r.endColumnRelative&&!r.isFullRow&&(r.endColumn+o<0||r.endColumn+o>f))return ne.Hh(S,r.source,r.endSource);m=r.offset(0,0,!1,n,o)}else if(9===r.type)m=ne.Kh(r.operatorType,y.call(b,e,t,r.value,n,o,i,a,s,l,u,c),r.value2&&y.call(b,e,t,r.value2,n,o,i,a,s,l,u,c));else if(7===d){if(p=[],r.arguments&&0<r.arguments.length)for(g=0;g<r.arguments.length;g++)p[g]=y.call(b,e,t,r.arguments[g],n,o,i,a,s,l,u,c);m=ne.Jh(r,p)}else 13===d&&(m=r.offsetWhenCopy(e,t,n,o,i,a,s,l,u,c));return m},q.copyFormula=function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L=e,O=n,B=e.getSource(),j=n.getSource(),H=q;if(L&&O){for(u=j&&j.getSheet()._modelManager.dUa(),h=r,f=o,d=i,p=a,g=s,(c=t)<0&&(c=0,p=G(e.rC(),n.rC())),r<0&&(h=0,g=G(e.cC(),n.cC())),o<0&&(f=0),i<0&&(d=0),m=new ne.CalcSourceModel(e.Cf(),B),b=0;b<p;b++)for(y=0;y<g;y++)L.Uf(m,b+c,y+h,b,y);for(C={},w=n.Cf(),b=0;b<p;b++)if(!l||!j.isHiddenRow(b+f,!0))for(v=b+f,y=0;y<g;y++)if(S=y+d,x=m.Kf(b,y)){if(x===C)continue;if(x=H.zj(B,j,m.Kf(b,y),v,S,o-t,i-r,o,i,p,g),T=m.Qf(b,y),j)if(T&&!T.isDynamicArray){for(A=T.rowCount,k=T.colCount,0<(M=c-T.row)&&(A-=M),(I=p-b)<A&&(A=I),0<(E=h-T.col)&&(k-=E),(R=g-y)<k&&(k=R),D=0;D<A;D++)for(N=0;N<k;N++)m.Rf(b+D,y+N,C);n.setArrayFormula(v,S,A,k,w.unparse(j,x,v,S),ie,u)}else F=x?w.unparse(j,x,v,S):ie,j.setFormula(v,S,F),(_=m.Mf(b,y))&&(P=new ne.EvaluateContext(j,ne._createCellIdentity(v,S),!1),_=(_=ne.Mh(P,x,!1,0,0))===x?ie:_),O.ig(v,S,x,_,T,u);else O.Rf(b+f,y+d,x),O.Xf(b+f,y+d,T)}else O&&O.Kf(v,S)&&O.Sf(v,S,u)}},q.moveFormula=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k=e.Bj(),M=n.Bj(),I=k.Cf();if(k&&M){for(l=k.dUa(),u=M.dUa(),c=I.ih(),t<0&&(t=0,a=G(e.getRowCount(),n.getRowCount())),o<0&&(o=0),r<0&&(r=0,s=G(e.getColumnCount(),n.getColumnCount())),i<0&&(i=0),h=!(e===n&&e.name()===n.name()),k.Sg(t,r,a,s),N(k,t,r,a,s),M.Sg(o,i,a,s),N(M,o,i,a,s),f=[],d=0;d<a;d++)for(p=0;p<s;p++)g=k.Kf(d+t,p+r),m=k.Qf(d+t,p+r),b=k.Mf(d+t,p+r),g?(f.push({Lf:g,Pf:m,Nf:b}),k.Sf(d+t,p+r,l)):f.push(ae);for(C=h?{}:null,d=0;d<a;d++)for(w=d+o,p=0;p<s;p++)S=p+i,(v=f[d*s+p])?(g=v.Lf,m=v.Pf,I&&m&&!m.isDynamicArray&&m.row===t+d&&m.col===r+p&&(y=F.kf(w,S,m.rowCount,m.colCount)),x=m&&!m.isDynamicArray?y:ie,b=v.Nf,M.FTa(u,w,S),M.Rf(w,S,g),M.Xf(w,S,x),M.Wf(w,S,b),h&&(C[w+", "+S]=g)):(M.FTa(u,w,S),M.Rf(w,S,ie),M.Xf(w,S,ie));c.Dj(k,t,r,a,s),c.Dj(M,o,i,a,s),A=(T=k.getSource().getSheet()).uja&&(T.parent||T).tja(),c.Ej(A,k.getSource(),t,r,M.getSource(),o,i,a,s,!0,C),1==h&&c.Ej(A,k.getSource(),t,r,M.getSource(),o,i,a,s,!0,C)}},q.prototype.isAdjustCell=function(e){return e.preAdj||this.imb&&e===this.imb[0]},q.prototype.isAdjust=function(e){return e.preAdj||this.imb&&e===this.imb[0]},q.prototype.hh=function(e,t){var r,n;isNaN(t)||(this.imb||(this.imb={},this.jmb={}),r=this.imb[t],n=this.jmb[t],e&&!e.preAdj&&e!==r&&(r?n.nextAdj=e:this.imb[t]=e,e.preAdj=n,e.nextAdj=ae,this.jmb[t]=e))},q.prototype.Fj=function(e,t){var r,n,o;isNaN(t)||(r=this.imb&&this.imb[t],e&&(e.preAdj||e===r)&&(n=e.preAdj,o=e.nextAdj,n?n.nextAdj=o:this.imb[t]=o,o?o.preAdj=n:this.jmb[t]=n,e.preAdj=ae,e.nextAdj=ae))},q.prototype.Gj=function(e,t,r,n,o,i,a){this.Hj(e,M,t,r,n,o,i,a);var s=0,l=0,u=0,c=0;0===t&&(n&&o?u=r:n?s=r:o?c=r:l=r),h(e,M,t,r,0,0,0,0,n,o),f(e,M,t,r,n,o)},q.prototype.Hj=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M=this,I=M.imb;if(I){for(g={};I[0];)if(p=(l=(f=I[0]).ah).dUa(),d=l.getSource(),z(g,u=f.row,c=f.column))M.Fj(f,0);else{if(h=l.Kf(u,c))if(h=t.call(M,d,u,c,h,e,r,n,o,i,ie,a,s),m=l.Qf(u,c)){if(d===e&&(b=i?n:-n,o?r<=m.row&&(m.row+=b):r<=m.col&&(m.col+=b)),u===m.row&&c===m.col)if(m.isDynamicArray)l.fg(u,c,h,m,!0,E(o?u:c,r,p,e.id===d.id));else for(y=u;y<u+m.rowCount;y++)for(g[y]||(g[y]={}),C=c;C<c+m.colCount;C++)l.fg(y,C,h,m,y===u&&C===c,E(o?y:C,r,p,e.id===d.id)),V(g,y,C,!0)}else l.fg(u,c,h,m,!0,E(o?u:c,r,p,e.id===d.id));else(l.getRowExpression&&l.getRowExpression(u)||l.getColumnExpression&&l.getColumnExpression(c))&&l.Ag(u,c,1,1);M.Fj(f,0)}for(;I[1];)p=(l=(f=I[1]).ah).dUa(),u=f.row,l.getRowExpression&&(h=l.getRowExpression(u))&&l.fg&&(d=l.getSource(),l.fg(u,-1,t.call(M,d,u,-1,h,e,r,n,o,i),ie,!0,E(u,r,p,e.id===d.id))),M.Fj(f,1);for(;I[2];)p=(l=(f=I[2]).ah).dUa(),c=f.column,l.getColumnExpression&&(h=l.getColumnExpression(c))&&l.fg&&(d=l.getSource(),l.fg(-1,c,t.call(M,d,-1,c,h,e,r,n,o,i),ie,!0,E(c,r,p,e.id===d.id))),M.Fj(f,2);for(;I[3];)v=(w=I[3]).name,h=(l=w.ah).DTa(v),S=t.call(M,l.getSource(),0,0,h,e,r,n,o,i,{isNameID:!0}),l.gg(v,S),M.Fj(w,3);for(x in I)if(3<(T=+x)&&I.hasOwnProperty(x))for(;I[x];)k=(A=I[x]).ah,h=t.call(M,k,0,0,A.expression,e,r,n,o,i),k.setExpression(A.id,A.name,h),M.Fj(A,T)}},q.prototype.ph=function(e){N(e.getCalcSourceModel(),0,0,e.getRowCount(),e.getColumnCount()),this.Hj(e,u),h(e,u,0,0,0,0,0,0,!0,!1),f(e,u,0,0,!0,!1)},q.prototype.Ej=function(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O=this,B=K,j=new W(t,r,n,o,i,a,s,l),H={};if(e&&function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g=t.Rj.getSheet()._modelManager.dUa();for(n=0;n<e.length;n++)if(o=e[n].validator,i=o.n5,a=U(i),s=a.r,l=a.c,u=e[n].sheet,c=u.yj(),h=o.condition(),(f=h.getExpressions())&&0<f.length){for(d=0;d<f.length;d++)p=f[d],f[d]=K(c,s,l,p,t,r,{isDataValidator:!0});h.setExpressions(f,g)}}(e,j,u),_=j,P=u,Y(Z(L=t.getSheet()),function(e,t,r,n){return K.call(this,e,r,n,t,_,P)},L._modelManager.dUa()),C={},b=O.imb){for(;b[0];)if(h=(f=b[0]).ah,d=f.row,p=f.column,m=h.dUa(),z(H,d,p))O.Fj(f,0);else{if(g=h.Kf(d,p),y=h.getSource(),g)if(w=ie,c&&c[d+", "+p]&&(y=t,w={crossSheetMoved:!0}),g=B.call(O,y,d,p,g,j,u,w),S=void 0,(v=h.Qf(d,p))&&!v.isDynamicArray)if(S=[(F=v).row,F.col,F.rowCount,F.colCount].join(","),d===v.row&&p===v.col)for(C[S]=!0,x=d;x<d+v.rowCount;x++)for(H[x]||(H[x]={}),T=p;T<p+v.colCount;T++)h.fg(x,T,g,v,x===d&&T===p,m),V(H,x,T,!0);else C[S]||(h.fg(d,p,g,v,!1,m),V(H,d,p,!0));else h.fg(d,p,g,v,!0,m);else(h.getRowExpression&&h.getRowExpression(d)||h.getColumnExpression&&h.getColumnExpression(p))&&h.Ag(d,p,1,1);O.Fj(f,0)}for(;b[1];)h=(f=b[1]).ah,d=f.row,m=h.dUa(),h.getRowExpression&&(g=h.getRowExpression(d))&&h.jg&&h.jg(d,B.call(O,y,d,-1,g,j,u),ie,m),O.Fj(f,1);for(;b[2];)h=(f=b[2]).ah,p=f.column,m=h.dUa(),h.getColumnExpression&&(g=h.getColumnExpression(p))&&h.kg&&h.kg(p,B.call(O,y,-1,p,g,j,u),ie,m),O.Fj(f,2);for(;b[3];)k=(A=b[3]).name,g=(h=A.ah).DTa(k),M=B.call(O,y,0,0,g,j,u),h.gg(k,M),O.Fj(A,3);for(I in b)if(3<(E=+I)&&b.hasOwnProperty(I))for(;b[I];)N=(D=(R=b[I]).ah).getSource(),g=B.call(O,N,0,0,R.expression,j,u),D.setExpression(R.id,R.name,g),O.Fj(R,E)}},q.prototype.Dj=function(e,t,r,n,o){var i,a,s,l,u,c=t+n,h=r+o;for(s=t;s<c;s++)for(l=r;l<h;l++)i=e.Yf(s,l),a=e.Kf(s,l),(i||a)&&(this.Fj(i,0),e.Q3(s,l,0),u=e.qg(s,l,!0),this.hh(u,0))},q.prototype.Ij=function(e,t,r){var n,o;for(n=t;-1!==n&&n<t+r;n++)(e.Yf(-1,n)||e.Kf(-1,n))&&(e.Q3(-1,n,2),o=e.sg(n,!0),this.hh(o,2))},q.prototype.Jj=function(e,t,r){var n,o;for(n=t;-1!==n&&n<t+r;n++)(e.Yf(n,-1)||e.Kf(n,-1))&&(e.Q3(n,-1,1),o=e.rg(n,!0),this.hh(o,1))},q.prototype.Kj=function(e){var t,r,n,o,i,a=e.Cf().getAllSourceModels();for(n=0;n<a.length;n++)if((o=a[n]).lmb)for(t=o.lmb(),i=0;i<t.length;i++)(r=t[i])&&r.isVolatile&&r instanceof ne.CellCalc&&!this.isAdjustCell(r)&&this.hh(r,0)},q.prototype.onBeforeAddRemoveRows=function(e,n,t){[e,t].forEach(function(e){if(e){var t=e.rC(),r=e.cC();e.Sg(n,0,t-n,r),e.Ug(n,t-n),N(e,n,-1,t-n,-1,!0)}})},q.prototype.onAfterAddRemoveRows=function(e,n,o,i,t,r){var a=this;[e,r].forEach(function(e){if(e){var t=e.rC(),r=e.cC();i?e.Ag(n,0,o,r):t+=o,a.Dj(e,n,0,t-n,r),a.Jj(e,n,t-n),a.Kj(e)}}),a.Gj(e.getSource(),n,o,!0,i,ie,t),e.Cf().autoCalculation&&e.Cf().recalculateAll(!1)},q.prototype.onAfterAddRemoveColumns=function(e,n,o,i,t,r){var a=this;[e,r].forEach(function(e){if(e){var t=e.rC(),r=e.cC();i?e.Ag(0,n,t,o):r+=o,a.Dj(e,0,n,t,r-n),a.Ij(e,n,r-n),a.Kj(e)}}),a.Gj(e.getSource(),n,o,!1,i,ie,t),e.Cf().autoCalculation&&e.Cf().recalculateAll(!1)},q.prototype.onBeforeAddRemoveColumns=function(e,n,t){[e,t].forEach(function(e){if(e){var t=e.rC(),r=e.cC();e.Sg(0,n,t,r-n),e.Wg(n,r-n),N(e,-1,n,-1,r-n,!0)}})},q.prototype.onAfterRemoveName=function(e,t){var r=e.wg(t,!1);r&&(r.updateListening(!0,!1),r.fh(),r.updateListeningOnRemoved())},q.prototype.adjustFormulaOnRemoveName=function(e,t,r){return d(e,t,r)},q.prototype.invalidName=function(e,t){var r;!t||(r=e.getCalcSourceModel().wg(t.toUpperCase(),!0))&&r.Yg()},q.prototype.onAfterRemoveTable=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d;for(a=0;a<e.length;a++)N((s=e[a]).source().getCalcSourceModel(),s.startRow(),s.startColumn(),s.endRow()-s.startRow()+1,s.endColumn()-s.startColumn()+1);if(l=this.imb)for(u={};l[0];)if(r=(c=l[0]).ah,z(u,n=c.row,o=c.column))this.Fj(c,0);else{if(i=r.Kf(n,o))if(i=q.adjustExpressionOnRemoveTable(i,e,n,o,t),(h=r.Qf(n,o))&&!h.isDynamicArray)for(h=F.kf(n,o,h.rowCount,h.colCount),f=n;f<n+h.rowCount;f++)for(u[f]||(u[f]={}),d=o;d<o+h.colCount;d++)r.fg(f,d,i,h,f===n&&d===o),V(u,f,d,!0);else r.fg(n,o,i,h,!0);else(r.getRowExpression&&r.getRowExpression(n)||r.getColumnExpression&&r.getColumnExpression(o))&&r.Ag(n,o,1,1);this.Fj(c,0)}},q.adjustExpressionOnRemoveTable=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v=q.adjustExpressionOnRemoveTable;if(9===e.type){if(i=e.value,a=e.value2,s=v(i,t,r,n,o),l=a&&v(a,t,r,n,o),i!==s||a!==l)return ne.Kh(e.operatorType,s,l)}else if(7===e.type){for(u=!1,c=[],h=0;h<e.arguments.length;h++)d=v(f=e.arguments[h],t,r,n,o),u=u||f!==d,c.push(d);if(u)return ne.Jh(e,c)}else if(10===e.type){if((p=e.value)!==(g=v(p,t,r,n,o)))return ne.Lh(g)}else if(13===e.type)for(m=e,h=0;h<t.length;h++)if(m.baseTable===t[h])return o?ne.Ih:(b=m.getRange(-1===r?0:r,-1===n?0:n,!0),y=-1===r||1===m.referencePortions(),C=1===b.rowCount&&1===b.columnCount,w=m.source,C?ne.rf(w,ae,b.row,b.col,y,!1):ne.uf(w,ae,b.row,b.col,b.row+b.rowCount-1,b.col+b.colCount-1,y,!1,y,!1));return e},i=q,t.CalcOperatorAdjustor=i,ne.CalcService.prototype.uzb=function(){return new i},t.adjustFormulaOnMoveSwap=K},"./dist/plugins/sheetsCalc/parser-sheets.js":function(e,g,t){"use strict";var r,n,H,G,O,B,p,o,i,m,U,W,u,a,b,d,s,l,c,h,f,y,C,w,v,S,x=this&&this.__extends||(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function T(e,t){var r=t+1;return e<0?e%r+r:t<e?e%r:e}function j(e){return new H.ErrorSource(e)}function V(e,t,r,n,o){var i,a,s=O.BAND_INDEX_CONST,l={cj:s,dj:s,ej:!0,fj:!0,gj:!1,li:0,Vka:!0},u=t?M(e,r,n,0):k(e,0,o);return u.hj?(l.cj=u.ij,l.ej=u.jj):(l.dj=u.ij,l.fj=u.jj),l.li=u.li,l.gj=u.gj,!u.gj||u.li>=e.length?l:!t&&u.hj||t&&!u.hj?{gj:!1}:(i=e[l.li],!t&&(H.isNumber(i)||"$"===i)||t&&("C"===i||"c"===i)?(a=t?M(e,r,n,l.li):k(e,l.li,o),l.li=a.li,!a.gj||!t&&!a.hj||t&&a.hj?l.gj=!1:(a.CLb&&(l.CLb=!0),l.li<e.length&&(l.Vka=!1),t?(l.dj=a.ij,l.fj=a.jj):(l.cj=a.ij,l.ej=a.jj),l.gj=!0),l):{gj:!1})}function A(e){return H.ei(e)||95===e.charCodeAt(0)}function k(e,t,r){var n,o,i,a,s,l,u,c,h,f={jj:!0,gj:!1},d=e.length;if(d<=t)return f;if("$"===e[t]&&(f.jj=!1,t++),d<=t)return f;if(o=0,i=e[n=t],a=!1,H.isNumber(i)&&"0"!==i){for(f.hj=!0;n<d&&H.isNumber(i);)++n<d&&(i=e[n]);if(n+1===d&&"#"===i&&r&&(a=!0),7<n-t)return f;for(s=n-1,l=0;t<=s;s--,l++)o+=(e[s].charCodeAt(0)-48)*b[l];if(o<=g.maxRowCount)return f.ij=o-1,f.li=a?d:n,f.CLb=a,f.gj=!0,f}else if(H.ei(i)){for(f.hj=!1;n<d&&H.ei(i);)++n<d&&(i=e[n]);if(3<n-t)return f;if(function(e,t,r){for(var n=e,o=t[e],i=!1;n<r&&!A(o);)++n<r&&(o=t[n]);if(n<r){for(;n<r&&A(o);)++n<r&&(o=t[n]);n<r&&(i=!0)}return i}(n,e,d))return f;for(o=0,c=u=n-1;t<=c;c--){if(!(65<=(h=e[c].charCodeAt(0))&&h<=90||97<=h&&h<=122))return f;o+=((32|h)-96)*m[u-c]}if(o<=g.maxColumnCount)return f.ij=o-1,f.li=n,f.gj=!0,f}return f}function M(e,t,r,n){var o,i,a,s,l,u={li:n,ij:O.BAND_INDEX_CONST,hj:!0,jj:!1,gj:!1},c=e.length;if(c<=n)return u;if("R"===(i=e[o=n])||"r"===i)u.hj=!0,a=t;else{if("C"!==i&&"c"!==i)return u;u.hj=!1,a=r}if(o++,c<=++n)return u.li=n,u.ij=a,u.jj=!0,u.gj=!0,u;if("["===(i=e[o])&&(n++,o++,u.jj=!0),c<=n)return u;if(s=!1,i=e[o],u.jj&&"-"===i&&(n++,o++,s=!0),c<=n)return u;if(i=e[o],!H.isNumber(i))return u.jj||(u.li=n,u.ij=a,u.jj=!0,u.gj=!0),u;for(;o<c&&H.isNumber(i);)++o<c&&(i=e[o]);if(l=parseInt(e.slice(n,o).join(""),10),u.jj){if(c<=o||"]"!==e[o])return u;o++}return l<(u.hj?g.maxRowCount:g.maxColumnCount)?(u.jj?(l=s?-l:l,u.ij=l+a):u.ij=l-1,u.li=o,u.gj=!0,u):void 0}function I(e,t,r,n){var o,i,a,s,l,u=e.source&&e.source._service,c=e.row||0,h=e.column||0,f=e.Eh;if(r.source===H.BangSource)n.push("!");else if(r.source&&!R(e,n,r.source,r.endSource))return void n.push("#","R","E","F","!");if(i=33===(o=r.type),8===o||5===o)n.push(""+r.value);else if(100===o)a="_xlpm.",r.bhc&&u.UIc?n.push(a+(""+r.value)):n.push(""+r.value);else if(r.value&&r._error)n.push(""+r.value);else if(i||r.sf()){if(l=a=s=void 0,i&&(a=(s=d[f?0:1]).prefix,l=s.surfix,n.push(a),r.isReferenceError))return n.push("#REF!"),void n.push(l);!r.source&&e.addSheetName&&e.source&&R(e,n,e.source,U),E(e.useR1C1,c,h,r.row,r.column,r.rowRelative,r.columnRelative,n),i&&n.push(l)}else!r.source&&e.addSheetName&&e.source&&R(e,n,e.source,U),function(e,t,r,n,o,i,a,s,l,u,c,h,f,d){3===(d=d||0)&&(o=0,a=e?e.getRowCount():g.maxRowCount-1,d=1),E(t,r,n,o,i,l,u,f,d);var p=O.BAND_INDEX_CONST;t&&o===a&&i===s&&(a===p||s===p)||a===p&&s===p||(f.push(":"),E(t,r,n,a,s,c,h,f,d))}(e.source,e.useR1C1,c,h,r.row,r.column,r.endRow,r.endColumn,r.rowRelative,r.columnRelative,r.endRowRelative,r.endColumnRelative,n,r.tf())}function E(e,t,r,n,o,i,a,s,l){var u,c,h,f,d;if(l=l||0,u=g.maxRowCount-1,(0===l||1===l)&&-u<n&&n<=2*u&&(n=T(n+=i?t:0,u)),c=g.maxColumnCount-1,(0===l||2===l)&&-c<o&&o<=2*c&&(o=T(o+=a?r:0,c)),h=n,f=o,3===(d=l)||0<=h&&0<=f||1===d&&0<=h||2===d&&0<=f)if(e){if(2!==l&&(s.push("R"),0<=n&&(t!==n||!i)&&(i?s.push("["+(n-t)+"]"):(n++,s.push(n+""))),o<0))return;1!==l&&(s.push("C"),r===o&&a||(a?s.push("["+(o-r)+"]"):(o++,s.push(o+""))))}else{if(0<=o&&(a||s.push("$"),s.push.apply(s,p(o+1).split(""))),n<0)return;n++,i||s.push("$"),s.push(n+"")}else s.push(""+H.Errors.Reference)}function R(e,t,r,n){if(e.getExternalSourceToken){if(r!==H.BangSource){var o=function(e,t,r){if(!t||0===t.length||D(e,t)||D(e,r))return[];var n,o=t;if(F(t,!1)||r&&F(r,!1)){for(o=["'"],n=0;n<t.length;n++)"'"===t[n]&&o.push("'"),o.push(t[n]);if(r)for(o.push(":"),n=0;n<r.length;n++)"'"===r[n]&&o.push("'"),o.push(r[n]);o.push("'")}else if(r)for(o.push(":"),n=0;n<r.length;n++)o.push(r[n]);return o}(e,e.getExternalSourceToken(r).split(""),n&&e.getExternalSourceToken(n).split(""));if(!(0<o.length))return!1;t.push.apply(t,o)}return t.push("!"),!0}return!1}function D(e,t){if(t&&0!==t.length&&e.Eh){var r="'"===t[0]?1:0;return"["===t[r]&&t.indexOf("]")>r}}function N(e,t){var r,n,o,i;if(!e||0===e.length)return!0;if(!t){if(H.isNumber(e[0]))return!1;if((i=V(o=e,!1,0,0)).gj||(i=V(o,!0,0,0)),i.gj&&i.li<=e.length)return!1}for(n=0;n<e.length;n++)if(r=e[n],t){if("*"===r||":"===r||"["===r||"]"===r||"?"===r||"\\"===r||"/"===r)return!1}else if(a[r]||H.operaterTypesMap[r])return!1;return!0}function F(e,t){var r,n,o;return H.isDigit(+e[0])||(r=[],"["===(n=e)[0]&&(0<(o=e.lastIndexOf("]"))&&(r=e.slice(1,o),n=e.slice(o+1))),!function(e,t){var r,n;if(!e||0===e.length)return 1;for(n=0;n<e.length;n++)if(r=e[n],t){if("*"===r||":"===r||"["===r||"]"===r||"?"===r)return;if("'"===r&&(0===n||n>=e.length-1||"'"!==e[n+1]))return}else if("'"===r||"["===r||"]"===r||"?"===r||"%"===r||H.operaterTypesMap[r])return;return 1}(r)||!N(n,t))}function z(e){var t=new H.Expression(8);return t.value=e,t}function q(e){var t=e;return e&&3<=e.length&&"["===e[0]&&"0"===e[1]&&"]"===e[2]&&(t=3===e.length?"":e.substring(3)),t}function _(e){var t=y.call(this,8e3)||this;return t.kj=e,t}function Z(e,t,r,n,o){return 0===t.Nc&&0===t.hi||!n&&0===t.Nc&&4===t.hi&&(!o||r<e.length-2&&":"===e[r+1].ni&&0===e[r+2].Nc&&4===e[r+2].hi)}function P(e,t,r,n,o){return t<=e.startRow()&&r<=e.startColumn()&&t+n>e.endRow()&&r+o>e.endColumn()}function L(e){var t=v.call(this,7900)||this;return t.kj=e,t}function Y(){return S.call(this,13)||this}function K(e,t,r){return e.slice(t,r).join("")}function X(e,t,r,n,o,i){var a,s,l,u,c,h,f=e,d=[],p="",g=!1,m=!1;if(1<o)g=!0,o--,d=t.slice(i,r),":"===(n=t[++r])&&(m="["===(n=t[++r]),p=(s=$(t,r,n,o)).xj,r=s.tj,n=s.uj,o=s.wj);else if("["===n){for(m=!0,n=t[a=r-1];" "===n;)n=t[--a];":"!==n&&te(),d=function(e){for(var t=e.length-1;0<=t&&" "===e[t];)t--;for(;0<=t&&" "!==e[t];)t--;return 0<=t?e.slice(t+1,e.length-t-1):e}(d=t.slice(i,a)),p=(s=$(t,r,n=t[r],o)).xj,r=s.tj,n=s.uj,o=s.wj}else f.qj!==U&&16!==f.qj||(g=!0),0<(a=(l=t.slice(i,r)).indexOf(":"))?(d=l.slice(0,a),"["!==(p=l.slice(a+1))[0]&&te()):d=l;if(u=J(f,d,g),p?(c=J(f,p,m),f.rj=4):(c=u,f.rj=2),c<u&&(h=u,u=c,c=h),f.oj=u,f.pj=c,++r<t.length)for(n=t[r];" "===n;)n=t[++r];return{tj:r,uj:n,wj:o}}function J(e,t,r){var n,o,i,a;if(t&&function(e,t){var r,n,o;if(t)return 1;if(r="",r=e[0],"#"===(n=r)||"@"===r||" "===r||","===r||":"===r||"["===r||"]"===r)return;for(o=1;o<e.length;o++){if(","===(r=e[o])||":"===r||"["===r&&"'"!==n||"]"===r&&"'"!==n||"@"===r&&"'"!==n||"#"===r&&"'"!==n)return;n=r}return 1}(t,r)){for(n=[],o=0,i=t.length;o<i;o++)"'"===t[o]&&o<i-1&&o++,n.push(t[o]);return t=n,(a=e.lj.getColumnIndexInTable(t.join("")))<0&&te(),a}return-1}function Q(e){var t,r,n=[];for(r=0;r<e.length;r++)"["!==(t=e[r])&&"]"!==t&&"@"!==t&&"#"!==t&&"'"!==t||n.push("'"),n.push(t);return n}function $(e,t,r,n){var o,i,a=!1;if("["===r)for(a=!0,n++,r=e[++t];" "===r;)r=e[++t];for(o=t;"]"!==r&&(","!==r||1<n);)"'"===r&&t++,r=e[++t];return t<=o&&te(),i=e.slice(o,t),1<n&&n--,a||(i=function(e){for(var t,r=0,n=e.length;r<n&&" "===e[r];)r++;for(t=r,r=n-1;t<r&&" "===e[r];)r++;return t<=r?e.slice(t,r+1):e}(i)),{xj:i,tj:t,uj:r,wj:n}}function ee(e,t,r,n){for(var o,i,a,s=14,l=t;"]"!==r;)"'"===r&&t++,r=e[++t];for(o=function(e){var t,r=H.getMapping()&&H.getMapping().tableFunctionsMapping;if(!B.isNullOrUndefined(r))for(t in r)if(r[t].toLowerCase()===e)return t.toLowerCase();return e}(o=K(e,l,t).toLowerCase().trim()),i=!1,a=0;a<u.length;a++)if(o===u[a]){s=h[o],i=!0;break}if(i||te(),++t>=e.length)n--;else{for(r=e[t];" "===r;)r=e[++t];if(","===r){for(n<=1&&te(),r=e[++t];" "===r;)r=e[++t];"["===r&&(n++,r=e[++t])}1<n&&n--}return{vj:s,tj:t,uj:r,wj:n}}function te(){throw i().Exp_FormulaInvalid}function re(e){return 1===e.Nc&&"ARRAY"===e.ni?1:0===e.Nc&&3===e.hi?(e.HTa||e.ni).length+2:0===e.Nc&&12===e.hi?e.ni.length+3:e.ni.length}function ne(e,t,r){var n,o;e&&t&&((o=e[n=t.getName&&t.getName()||"!"])||(o=e[n]=[],e.sheets||(e.sheets=[]),e.sheets.push(n)),o.push(r))}function oe(e,t,r,n,o,i){var a,s,l;if(e){for(;10===e.type;)e=e.value;if(12===e.type&&(e=e.value),!(2<=e.type&&e.type<=6))if(1===e.type)a=e.getRange(o,i),!n.source||e.source&&e.source!==n.source||t.push(a),ne(r,e.source||n.source,a);else if(13===e.type)a=e.getRange(o,i),e.source===n.source&&a&&t.push(a),ne(r,e.source||n.source,a);else if(8===e.type)s=W,e.source?e.source.Cf()&&(s=new H.EvaluateContext(e.source,H._createCellIdentity(o,i))):s=n,oe(s.getName(e.value),t,r,s,o,i);else if(9===e.type)oe(e.value,t,r,n,o,i),e.value2&&oe(e.value2,t,r,n,o,i);else if(7===e.type)for(l=0;l<e.arguments.length;l++)oe(e.arguments[l],t,r,n,o,i)}}Object.defineProperty(g,"__esModule",{value:!0}),r=t("Core"),n=t("@grapecity/js-sheets-common"),H=t("@grapecity/js-calc"),G=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),O=t("./dist/plugins/sheetsCalc/calc.ns.js"),B=t("./node_modules/util/util.js"),p=r.util.xq,o=new n.Common.ResourceManager(r.SR),i=o.getResource.bind(o),H.Errors.Reference,g.maxRowCount=1048576,g.maxColumnCount=16384,m=[1,26,676],u=["#all","#data","#headers","#totals","#this row"],a={" ":!(W=null),"'":!(U=void 0),"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"":!0,"":!0,".":!0,";":!0},b=[1,10,100,1e3,1e4,1e5,1e6,1e6],d=[{prefix:"ANCHORARRAY(",surfix:")"},{prefix:"",surfix:"#"}],g.jma=N,g.validateSheetName=N,y=H.TokenResolver,x(_,y),_.prototype.resolveToken=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E=e.useR1C1,R=e.row||0,D=e.column||0,N=r.length,F=r[n],_=F.ni,P=F.Nc,L=F.hi;if(0!==P&&6!==L)return!1;if(0===P&&0===L&&n<N-2&&":"===r[n+1].ni&&12===r[n+2].hi&&r[n+2].ni.indexOf(":")<0||0===P&&12===L){if(u=l=void 0,_&&(0<_.indexOf(":")?(c=_.indexOf(":"),l=_.substring(1,c-1),u=_.substring(c+1,_.length-2)):("'"===(l=_).charAt(0)&&(l=l.substring(1,l.length-1)),0===L&&"'"===(u=r[n+2].ni).charAt(0)&&(u=u.substring(1,u.length-1)))),n++,s=!!l,(l=q(l))&&(i=(i=_?e.getExternalSource("",l):H.BangSource)||j(l),(u=q(u))&&(a=(a=e.getExternalSource("",u))||j(u),n+=2)),!(F=r[n]))return z(_);_=F.ni}if(h=n===N-1?W:r[n+1],Z(r,F,n,E,!0)){if(f=e&&e.source&&e.source._service&&e.source._service.allowDynamicArray,!(d=V(F.Qb,E,R,D,f)).gj&&!s)return!1;if(F.hi=7,d.gj&&d.Vka){if(p=d.cj,g=d.dj,m=d.ej,b=d.fj,y=d.CLb,n<N-2&&5===h.Nc&&":"===h.ni&&Z(r,h=r[n+2],n+2,E,!1)&&(C=V(h.Qb,E,R,D)).gj&&p===O.BAND_INDEX_CONST==(C.cj===O.BAND_INDEX_CONST)&&g===O.BAND_INDEX_CONST==(C.dj===O.BAND_INDEX_CONST))return R=p===O.BAND_INDEX_CONST?0:R,D=g===O.BAND_INDEX_CONST?0:D,{index:n+3,expr:H.uf(i,a,p-(m?R:0),g-(b?D:0),C.cj-(C.ej?R:0),C.dj-(C.fj?D:0),m,b,C.ej,C.fj,R,D)};if(p===O.BAND_INDEX_CONST||g===O.BAND_INDEX_CONST){if(E)return p-=p!==O.BAND_INDEX_CONST&&m?R:0,g-=g!==O.BAND_INDEX_CONST&&b?D:0,{index:n+1,expr:H.uf(i,a,p,g,p,g,m,b,m,b,R,D)};if(!i)return!1;o=z(_)}if(!o)return B.isNullOrUndefined(i)&&(S=R,x=D,(I=e.source)&&(A=I.q$a,k=I.cDc,M=I.dDc,!A||(0<=S&&S<k&&M<=x||k<=S&&0<=x&&x<M)&&(T=I)),i=T),w=p-(m?R:0),v=g-(b?D:0),{index:n+1,expr:o=y?H.BLb(e.source,i,a,w,v,m,b):H.rf(i,a,w,v,m,b)}}else o=z(_)}else if(6===F.hi)(o=new H.Expression(5)).value=H.CalcError.parse(F.ni);else{if(!i)return!1;o=z(_)}return i&&(o.source=i),a&&(o.endSource=a),{index:n+1,expr:o}},_.prototype.unparse=function(e,t,r,n){var o=r&&r.type;return(1===o||8===o||5===o||33===o||100===o)&&(I(e,0,r,n),!0)},g.SheetReferenceResolver=_,(w=s=g.StructReferencePortions||(g.StructReferencePortions={}))[w.ThisRow=1]="ThisRow",w[w.Headers=2]="Headers",w[w.Data=3]="Data",w[w.Totals=8]="Totals",w[w.HeadersAndData=6]="HeadersAndData",w[w.DataAndTotals=12]="DataAndTotals",w[w.All=14]="All",w[w.NotSpecific=16]="NotSpecific",(C=l=g.StructReferenceColumnSpecifier||(g.StructReferenceColumnSpecifier={}))[C.All=1]="All",C[C.NotSpecific=1]="NotSpecific",C[C.SingleColumn=2]="SingleColumn",C[C.ColumnRange=4]="ColumnRange",S=H.Expression,x(Y,S),Y.prototype.tableName=function(){return this.lj.tableName()},Object.defineProperty(Y.prototype,"baseTable",{get:function(){return this.lj},set:function(e){this.lj=e,this.source=e.source()},enumerable:!0,configurable:!0}),Y.prototype.JUa=function(){this.vzb=this.lj.startColumn()},Y.prototype.columnReferenceStart=function(){return this.oj+this.lj.startColumn()},Y.prototype.columnReferenceEnd=function(){return this.pj+this.lj.startColumn()},Y.prototype.referencePortions=function(){return this.qj},Y.prototype.referenceColumnSpecifier=function(){return this.rj},Y.prototype.getRange=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p=this.lj;switch(this.JUa(),u=p.startRow(),c=p.endRow(),h=p.hasTotalsRow(),f=p.hasHeadersRow(),this.qj){case 3:case 16:n=f?u+1:u,i=h?c-1:c;break;case 2:if(f)i=n=u;else{if(!r)return W;i=n=u-1}break;case 8:if(h)i=n=c;else{if(!r)return W;i=n=c+1}break;case 1:i=n=e;break;case 6:n=u+(r&&!f?-1:0),i=h?c-1:c;break;case 12:n=f?u+1:u,i=c+(r&&!h?1:0);break;case 14:default:n=u+(r&&!f?-1:0),i=c+(r&&!h?1:0)}return o=this.columnReferenceStart(),a=this.columnReferenceEnd(),d=p.endColumn(),1===this.rj&&(a=d),d<o||d<a?(this._error=!0,W):i<n||!r&&n<u||!r&&c<i?W:(s=i-n+1,l=a-o+1,H.qf(n,o,s,l))},Y.prototype.offsetWhenInsertRemoveColumn=function(e,t,r,n){var o,i,a=this.vzb;return e<a||e===a&&r&&!n||e>this.pj+a?this:(t=r?t:-t,o=e-a,(i=new Y).baseTable=this.lj,i.pj=this.pj+t,i.oj=this.oj,e<=a+this.oj&&(i.oj+=t,i.oj<o&&(i.oj=o)),i.rj=this.rj,i.qj=this.qj,i.pj<i.oj?H.Ih:i)},Y.prototype.offsetWhenCopy=function(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p,g=new G.SheetParserContext(t.kj,t._service.useR1C1,H._createCellIdentity(r,n)),m=g.getTableByIndex(r,n),b=this.offset();return m&&(c=r-o,h=n-i,f=a-o,d=s-i,p=void 0,(p=e===t?g.getTableByIndex(c,h):new G.SheetParserContext(e.kj,e._service.useR1C1,H._createCellIdentity(c,h)).getTableByIndex(c,h))!==m&&p===this.lj&&P(p,f,d,l,u)&&P(m,a,s,l,u)&&(b.baseTable=m)),b},Y.prototype.Jma=function(e){var t,r=new Y;return r.baseTable=this.lj,r.pj=this.pj,r.oj=this.oj,2===this.rj&&e&&(e%=t=this.lj.endColumn()-this.lj.startColumn()+1,r.oj+=e,r.oj<0&&(r.oj+=t),r.pj=r.oj),r.rj=this.rj,r.qj=this.qj,r},Y.prototype.offset=function(e,t,r){var n=new Y;return n.baseTable=this.baseTable,n.qj=this.qj,n.oj=this.oj,n.pj=this.pj,n.rj=this.rj,n},Y.prototype.Kma=function(e,t){var r=this.lj;return e>=r.startRow()&&t>=r.startColumn()&&e<=r.endRow()&&t<=r.endColumn()},Y.prototype.tzb=function(e,t,r){this.lj.wzb(e,t,r)},c=Y,g.xzb=c,v=H.TokenResolver,x(L,v),L.prototype.resolveToken=function(e,t,r,n){var o,i,a,s=r[n];if(0===s.Nc&&(0===s.hi||7===s.hi))if("]"===(o=s.ni).charAt(o.length-1))try{return i=new c,function(e,t,r){var n,o,i,a,s,l,u,c,h,f=r,d=0,p=t[d],g=function(e,t,r,n){for(var o,i,a=t.length;"["!==n&&r<a;)n=t[++r];return{sj:0<(i=r)?(o=K(t,0,i),e.getTableByName(o)):e.getTableByIndex(e.row,e.column),tj:r,uj:n}}(e,t,d,p),m=g.sj;for(m||te(),f.baseTable=m,d=g.tj,p=t[++d],n=d;" "===p;)p=t[++d];for("@"!==p&&"["!==p&&(p=t[d=n]),a=i=!(o=1),s=t.length;0!==o&&d<s;)if("["===p&&(o++,p=t[++d]),"#"===p)i&&o<=1&&te(),l=ee(t,d,p,o),u=l.vj,d=l.tj,p=l.uj,o=l.wj,i?2===f.qj&&3===u||2===u&&3===f.qj?f.qj=6:3===f.qj&&8===u||3===u&&8===f.qj?f.qj=12:te():f.qj=u,i=!0;else if("@"===p){for((1<o||i)&&te(),i=!0,f.qj=1,p=t[++d];" "===p;)p=t[++d];","===p&&te()}else{for(c=d;!B.isNullOrUndefined(p)&&"]"!==p&&"["!==p;)if("'"===p&&d++,","===p){for(p=t[++d],h=d;" "===p;)p=t[++d];if("["===p){d=h,p=",";break}}else p=t[++d];if(c<d&&((a||"["===p&&1<o)&&te(),l=X(f,t,d,p,o,c),d=l.tj,p=l.uj,o=l.wj,a=!0),"]"===p){if(0==--o)break;d>=t.length&&te(),p=t[++d]}","===p&&(p=t[++d])}i||(f.qj=e.DLb?1:16),a||(f.oj=0,f.pj=f.lj.endColumn()-f.lj.startColumn(),f.rj=1)}(e,o.split(""),i),i}catch(e){}else if(a=e.getTableByName&&e.getTableByName(o))return L.create(a);return W},L.prototype.unparse=function(e,t,r,n){var o,i,a,s,l,u,c;return 13===r.type&&(o=r,e.YSa?(i=o.getRange(e.row,e.column,!0),I(e,0,H.uf(o.source,W,i.row,i.col,i.row+i.rowCount-1,i.col+i.colCount-1,!1,!1,!1,!1),n),!0):16===o.qj&&1===o.rj?(n.push(o.lj.tableName()),void(e.Eh&&n.push("[]"))):(s=n.length,e.source===o.lj.source()&&o.Kma(e.row,e.column)&&!e.Eh||n.push(o.lj.tableName()),n.push("["),16!==o.qj&&(l=function(e,t,r){var n=H.getMapping()&&H.getMapping().tableFunctionsMapping,o=H.sR().B2,i=n?n["#All"]:o.All.name,a=n?n["#This row"]:o.thisRow.name,s=n?n["#Headers"]:o.Headers.name,l=n?n["#Data"]:o.Data.name,u=n?n["#Totals"]:o.Totals.name;switch(e){case 1:return r?"["+a+"]":"@";case 2:return t?"["+s+"]":s;case 3:return t?"["+l+"]":l;case 8:return t?"["+u+"]":u;case 6:return"["+s+"], ["+l+"]";case 12:return"["+l+"], ["+u+"]"}return t?"["+i+"]":i}(o.qj,1!==o.rj,e.Eh),n.push(l)),1!==o.rj&&(1===o.qj&&!e.Eh||16===o.qj||n.push(", "),(u=o.lj.getColumnName(o.oj))?u=Q(u.split("")).join(""):a=!0,a||(4===o.rj?(c=o.lj.getColumnName(o.pj))?(c=Q(c.split("")).join(""),n.push("[",u,"]:[",c,"]")):a=!0:1===o.qj&&!e.Eh&&!function(e){var t,r="";if("#"===(r=e[0])||" "===r||"@"===r||" "===r||","===r||":"===r||"["===r||"]"===r)return 1;for(t=1;t<e.length;t++)if(" "===(r=e[t])||","===r||":"===r||"["===r||"]"===r||"@"===r||"#"===r)return 1}(u)||16===o.qj?n.push(u):n.push("[",u,"]"))),a?(n.length=s,n.push("#REF!")):n.push("]"),!0))},L.create=function(e,t,r,n,o){void 0===t&&(t=s.NotSpecific),void 0===r&&(r=l.NotSpecific),void 0===n&&(n=0),void 0===o&&(o=e.endColumn()-e.startColumn());var i=new c;return i.baseTable=e,i.qj=t,i.oj=n,i.pj=o,i.rj=r,i},g.StructureReferenceResolver=L,h={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},g.qzb=function(e,t,r,n,o,i,a){var s,l,u;e.setParserOption(i),s=[],l=t.split("");try{u=r.yj().getParserContext(!a&&r.Cf().useR1C1,H._createCellIdentity(n,o),W),s=e.parseToTokens(u,l,!1)}catch(e){}return function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A=U,k=n.yj(),M=n.Cf();for(M?(s=new G.SheetParserContext(n,!a&&M.useR1C1,H._createCellIdentity(o,i)),A=new H.EvaluateContext(k,H._createCellIdentity(o,i),!1)):s=new H.ParserContext(W,!1,H._createCellIdentity(0,0)),s.ignoreError=!0,l=[],c=0;c<t.length;c++)try{if("["===(u=t[c]).ni||"#"===u.Qb[0]||3===u.hi){l.push({text:u.HTa||u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni});continue}if(I=e,E=s,N=h=[],B=O=L=P=_=F=void 0,j=(R=t)[D=c],c=j&&"function"!=typeof j&&0===j.Nc?(F=[],_=I.resolveToken(E,R,F,D)-1,1===(L=(P=F[0]).type)||13===L||33===L||8===L||5===L&&P.source?(O=R[_],B={mi:j.mi,li:O.li,Lf:P},N.push(B),_):D):D,f=void 0,0<h.length){for(d=0;d<h.length;d++)if((p=h[d])instanceof H.FormulaToken)l.push({text:r.slice(p.mi,p.li+1).join(""),type:p.Nc,subType:p.hi,canDrag:f,ranges:[],value:p.ni});else if(p.Lf){if(g=p.Lf,m=g.type,b=g.source,y=r.slice(p.mi,p.li+1).join(""),C=[],w={},f=!0,v=g.getRange&&g.getRange(o,i),8===m)f=!1,A&&(S=A,g.source&&(S=new H.EvaluateContext(g.source,H._createCellIdentity(o,i),!1)),oe(S.getName(g.value),C,w,A,o,i));else if(13===m)f=!1,b===k&&v?C.push(v):C=null,ne(w,b,v);else if(33===m)(b||g.contextSource)===k&&(v=v||H.getRangeForReference(g,o,i),C.push(v),b=b||k),ne(w,b,v);else if(1===m)if(g.endSource)for(x=g.endSource,T=b.getSources(x),d=0;d<T.length;d++){if(T[d]===k){C.push(v);break}ne(w,T[d],v)}else ne(w,b||k,v),b&&b!==k||C.push(v);else C=null;C&&0<C.length?l.push({text:y,type:0,subType:7,canDrag:f,ranges:C,value:y,sheetRanges:w}):l.push({text:y,type:u.Nc,subType:u.hi,canDrag:f,ranges:C,value:y,sheetRanges:w})}}else l.push({text:u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni})}catch(e){l.push({text:u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni})}var I,E,R,D,N,F,_,P,L,O,B,j;return l}(e,s=function(e,t){var r,n,o,i,a,s,l,u,c,h;for(e.unshift(new H.FormulaToken("=",1,0,0,0)),i=[],a=0,o=e.length-1;0<o;o--)e[o].mi===e[o-1].mi&&e[o].ni===e[o-1].ni||(i[a]=e[o],a++);for(i[a]=e[o],i.reverse(),s=[],u=l=0;u<i.length-1;u++,l++)n=re(i[u]),s[l]=i[u],0<i[u+1].mi-i[u].mi-n&&(r=new H.FormulaToken(t.slice(i[u].mi+n,i[u+1].mi),7,i[u].mi+n),s[++l]=r);for(s[l]=i[u],n=re(s[l]),0<s.length&&t.length>s[l].mi+n&&(r=new H.FormulaToken(t.slice(s[l].mi+n,t.length),7,s[l].mi+n),s[l+1]=r),c=0;c<s.length;c++)h=s[c].ni.trim(),3===s[c].hi?s[c].ni='"'+s[c].ni+'"':"("===h||"{"===h?(s[c].Nc=1,s[c].hi=1):")"!==h&&"}"!==h||(s[c].Nc=1,s[c].hi=2);return s}(s,l),l,r,n,o,a)}},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(e,r,t){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),n(t("./dist/plugins/sheetsCalc/calc.ns.js")),n(t("./dist/plugins/sheetsCalc/parser-sheets.js")),n(t("./dist/plugins/sheetsCalc/calc-spreadjs.js")),n(t("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js")),n(t("./dist/plugins/sheetsCalc/worksheet-formula.js")),t("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(e,t,r){"use strict";var i,x,n,o,a,h,s,f,l,d,u;Object.defineProperty(t,"__esModule",{value:!0}),i=r("Core"),x=r("Core"),n=r("@grapecity/js-sheets-common"),o=r("@grapecity/js-calc"),a=r("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=r("./dist/plugins/sheetsCalc/calc-spreadjs.js"),s=a.SpreadSource,f=n.Common.u.Nb,l=new n.Common.ResourceManager(i.SR),d=l.getResource.bind(l),n.Common.j.Fa,(u=i.Workbook.prototype).qv=function(e){var t=this,r=t.Wu;t.Wu=new o.CalcService,t.Wu.useR1C1=1===t.options.referenceStyle,t.Wu.allowDynamicArray=t.options.allowDynamicArray,t.Wu.iterativeCalculation=t.options.iterativeCalculation,t.Wu.iterativeCalculationMaximumIterations=t.options.iterativeCalculationMaximumIterations,t.Wu.iterativeCalculationMaximumChange=t.options.iterativeCalculationMaximumChange,e&&r&&t.Wu.cloneFrom(r),t.yv=new s(t),t.zv=t.Wu.getGlobalSourceModel(t.yv)},u.addCustomFunction=function(e){this.Xu(e)},u.Xu=function(e){if(!(e&&e instanceof o.Functions.Function))throw Error(d().Exp_InvalidCustomFunction);this._functions[f(e.name)]=e},u.getCustomFunction=function(e){return e?this._functions[f(e)]:void 0},u.removeCustomFunction=function(e){e&&(delete this._functions[f(e)],this.iK())},u.clearCustomFunctions=function(){this._functions={}},u.addCustomName=function(e,t,r,n,o){this.Yu(this.Tu,e,t,r,n,!1,o)},u.H$a=function(e){return!this.Tu[f(e)]},u.isValidCustomName=function(e){return e&&i.Ul.G$a(e)&&this.H$a(e)},u.Yu=function(e,t,r,n,o,i,a){var s,l,u,c;if(!t||!r||!i&&!this.isValidCustomName(t))throw Error(d().Exp_InvalidCustomName);if(this.Wu){if(l=(s=this.getActiveSheet())?s.yj():null,u=void 0,i)try{u=this.Wu.parse(l,r,n,o,!1,!1,!0)}catch(e){}else u=this.Wu.parse(l,r,n,o);e[f(t)]=new h.NameInfo(t,u,n,o,a),i||((c={})[t]=t,this.Zu(c,!0))}},u.getCustomName=function(e){return e?this.Tu[f(e)]:void 0},u.aJb=function(e){return e?this.QHb[f(e)]:void 0},u.getCustomNames=function(){var r=[];return i.GC$.each(this.Tu,function(e,t){r.push(t)}),r},u.ELb=function(){var r=[];return i.GC$.each(this.QHb,function(e,t){r.push(t)}),r},u.removeCustomName=function(e){if(e){delete this.Tu[f(e)];var t={};t[e]=e,this.Zu(t,!1)}},u.RHb=function(e){if(e){delete this.QHb[f(e)];var t={};t[e]=e,this.Zu(t,!1)}},u.clearCustomNames=function(){var e=this.Tu;this.Tu={},this.Zu(e,!1)},u.FLb=function(){var e=this.QHb;this.QHb={},this.Zu(e,!1)},u.Zu=function(e,t){var r,n;if(e){for(n in r=this.zv,e)r&&r.updateNameCalc(n,t);this.iK()}},u.iK=function(){if(this.Wu&&!this.Wu.IsSuspended()){var e=this.getActiveSheet();e&&(e.suspendPaint(),this.Wu.recalculateAll(),e.resumePaint())}},u.getCalcService=function(){return this.Wu},u.Cf=function(){return this.Wu},u.suspendCalcService=function(e){this.Wu&&this.Wu.suspend(e)},u.resumeCalcService=function(e){this.Wu&&this.Wu.resume(e)},u.getCircularReference=function(){var e,t,r,n=this.chc();for(t in e=[],n=this.dhc(n))Object.prototype.hasOwnProperty.call(n,t)&&(r=t.split("\\"),e.push({row:+r[1],col:+r[2],rowCount:1,colCount:1,sheetName:r[0]}));return e},u.chc=function(){var f={};return this.sheets.forEach(function(e){var t,r,n,o,i,a,s,l=e.Bj(),u=e.getRowCount(),c=e.getColumnCount(),h=e.name();if(l)for(t=0;t<u;t++)for(r=0;r<c;r++)for(n=h+"\\"+t+"\\"+r,o=e.getDependents(t,r),!f[n]&&0<o.length&&(f[n]={from:[],to:[]}),i=0;i<o.length;i++)s=(a=o[i]).sheetName+"\\"+a.row+"\\"+a.col,f[s]||(f[s]={from:[],to:[]}),f[s].from.push(n),f[n].to.push(s)}),f},u.dhc=function(r){var n,e,t;function o(e,t){e.splice(e.indexOf(t),1)}for(n=!0;0<Object.keys(r).length&&n;)for(t in n=!1,e=function(t){if(Object.prototype.hasOwnProperty.call(r,t)){var e=r[t];0===e.from.length?(e.to.forEach(function(e){o(r[e].from,t)}),delete r[t],n=!0):0===e.to.length&&(e.from.forEach(function(e){o(r[e].to,t)}),delete r[t],n=!0)}},r)e(t);return r},i.Workbook.$n("calc",{priority:1e3,init:function(){this._functions={},this.Tu={},this.QHb={}},toJson:function(e){var l,u,t,r,c,n,h,o=this._functions;i.GC$.isEmptyObject(o)||(e.customFunctions=o),l=[],u=[],t=this.getCustomNames(),r=this.ELb(),c=this.Wu,n=this.getActiveSheet(),h=n?n.yj():null,t&&c&&(i.GC$.each(t,function(e,t){var r,n=t.getName(),o=t.getRow(),i=t.getColumn(),a=t.getExpression(),s=t.getComment();a&&(r={name:n,formula:c.unparse(h,a,o,i,!1,!0),row:o,col:i},s&&(r.comment=s),l.push(r))}),i.GC$.each(r,function(e,t){var r,n=t.getName(),o=t.getRow(),i=t.getColumn(),a=t.getExpression(),s=t.getComment();a&&(r={name:n,formula:c.unparse(h,a,o,i,!1,!0),row:o,col:i},s&&(r.comment=s),u.push(r))}),0<l.length&&(e.names=l),0<u.length&&(e.formatStringNames=u))},fromJson:function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S=this.Wu;if(S&&S.suspend(),this.clearCustomNames(),n=e.names)for(o=0;o<n.length;o++)i=n[o],this.Yu(this.Tu,i.name,i.formula,i.row,i.col,!0,i.comment);if(this.FLb(),a=e.formatStringNames)for(o=0;o<a.length;o++)i=a[o],this.Yu(this.QHb,i.name,i.formula,i.row,i.col,!0,i.comment);if(this.clearCustomFunctions(),s=e.customFunctions)for(l in s)s.hasOwnProperty(l)&&(u=s[l],(c=x.getTypeFromString(u.typeName))&&((h=new c).fromJSON(u,t),this.Xu(h)));if(g=[],p=e.sheets){for(b in f=0,p)"string"==typeof b&&(y=p[b],d=this.getSheetFromName(y.name||b),g.push(d),d.nameFunctionsFromJSON(y,t,r),f++);for(m=g.length,f=0;f<m;f++)(d=g[f]).yj().q$a=!0,d.formulaFromJSON(p[d.name()],t,r)}for(S&&(e.noRecalc||r&&r.doNotRecalculateAfterLoad?S.resumeWithoutCalc():S.resume(!0)),C=0,w=g;C<w.length;C++)(v=(d=w[C]).yj()).HIb(),delete v.q$a},egc:function(a,e,s){var t,r,n,o,i,l,u,c,h,f,d,p,g,m,b,y=this.Wu;if(y&&y.suspend(),this.clearCustomNames(),t=a.names)for(r=0;r<t.length;r++)n=t[r],this.Yu(this.Tu,n.name,n.formula,n.row,n.col,!0,n.comment);if(this.clearCustomFunctions(),o=a.customFunctions)for(i in o)o.hasOwnProperty(i)&&(l=o[i],(u=x.getTypeFromString(l.typeName))&&((c=new u).fromJSON(l,e),this.Xu(c)));if(d=a.sheets,p=[],d){for(m in h=0,d)"string"==typeof m&&(b=d[m],f=this.getSheetFromName(b.name||m),p.push(f),f.nameFunctionsFromJSON(b,e,s),h++);for(g=p.length,h=0;h<g;h++)(f=p[h]).yj().q$a=!0,f.formulaFromJSON(d[f.name()],e,s)}s.incrementLoadTask.addTask(function(e,t,r){var n,o,i;for(y&&(a.noRecalc||s&&s.doNotRecalculateAfterLoad?y.resumeWithoutCalc():y.resume(!0)),n=0,o=p;n<o.length;n++)(i=(f=o[n]).yj()).HIb(),delete i.q$a},[y,a,s])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(e,t,r){"use strict";var b,f,n,O,c,E,B,d,h,o,y,C,u,i;function w(e){return e.Cf()}function a(){var e=this;return e.Ru?void(e.Ru=!1):(e._functions={},e.Tu={},e.eDc?e.eDc.clearAll():e.fDc=new c.SheetSource(e,b.SheetArea.colHeader),e.gDc?e.gDc.clearAll():e.hDc=new c.SheetSource(e,b.SheetArea.rowHeader),void(e.et?e.et.clearAll():e.ft=new c.SheetSource(e,b.SheetArea.viewport)))}function v(e,t,r,n,o,i){var a=e.Ms(t,r,n,o,i),s=a&&a.formulas;return s&&0<s.length}function S(e,t,r,n,o,i){var a,s=n.yj(),l=e&&e.formula;l&&(l=l.replace(/ANCHORARRAY\(([A-Z]+[0-9]+)\)/gi,"$1#").replace(/SINGLE\((.*)\)/gi,"@$1").replace(/ANCHORARRAY\((#[A-Z]+[\?!])\)/gi,"$1#"),(a=e.arrayInfo)&&!a.isDynamicArray?n.bv(t,r,u(a.rowCount,10),u(a.colCount,10),l,!0,i):(a&&a.isInvalid&&s.GIb(t,r),n._u(t,r,l,B,!0,i,!0,!a)))}function x(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b=o&&o.incrementLoadTask;if(b&&!b.isTerminated){for(s=b.isBusyFunc,l=i=i||0,e.suspendPaint(),u=new Date;l<r;){if(c=t[l])for(h=0;h<n;h++)S(c[h],l,h,e,0,a);if(l++,s&&s())break;if(30<new Date-u)break}e.resumePaint(),(f=(o=o||{})&&o.incrementalLoading)&&f.loading&&(f.loadStatus.formulaLoad+=l-i,p=f.loadStatus,g=o.doNotRecalculateAfterLoad,m=p.formulaLoad/p.total,d=g?.4*m+.5:.3*m+.4,f.loading(d)),l<r&&o.incrementLoadTask.pushTask(x,[e,t,r,n,o,l])}}function p(n,o,i,a){var e=b.Worksheet._features;e&&d(e,function(e,t){var r=t.fromJsonAfterFormula;r&&r.call(n,o,i,a)})}function T(n,o,i,a,s){var e,l,u,c,t,r,h,f;if(n.parent&&n.parent.sheets)for(c=n.parent.sheets,t=n.parent.getCustomNames(),r=n.parent.ELb(),t&&d(t,function(e,t){l=t.getExpression(),(u=j(null,n,o,i,a,s,l))!==l&&t.fg(u)}),r&&d(r,function(e,t){l=t.getExpression(),(u=j(null,n,o,i,a,s,l))!==l&&t.fg(u)}),h=function(r){(e=c[r].getCustomNames())&&d(e,function(e,t){l=t.getExpression(),(u=j(c[r],n,o,i,a,s,l))!==l&&t.fg(u)})},f=0;f<c.length;f++)h(f);else(e=n.getCustomNames())&&d(e,function(e,t){l=t.getExpression(),(u=j(n,n,o,i,a,s,l))!==l&&t.fg(u)})}function j(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P=t.yj(),L=O.Hh(O.Errors.Reference,P);if(9===a.type){if(l=a.value,u=a.value2,c=j(e,t,r,n,o,i,l),h=u&&j(e,t,r,n,o,i,u),l!==c||u!==h)return O.Kh(a.operatorType,c,h)}else if(7===a.type){for(f=!1,d=[],p=void 0,g=0;g<a.arguments.length;g++)m=j(e,t,r,n,o,i,p=a.arguments[g]),f=f||p!==m,d.push(m);if(f)return O.Jh(a,d)}else if(1===a.type&&a.sf()){if(s=a.source||e&&e.yj(),C=b=a.row,w=y=a.column,s&&s===P&&(i&&!a.rowRelative||!i&&!a.columnRelative)){if(i&&o)b+=r<=b?n:0;else if(!i&&o)y+=r<=y?n:0;else if(i){if(r+n<=b)b-=n;else if(r<=b)return L}else if(r+n<=y)y-=n;else if(r<=y)return L;if(b!==C||y!==w)return O.rf(P,B,b,y,a.rowRelative,a.columnRelative)}}else if(1===a.type){if(s=a.source||e&&e.yj(),v=a.row,S=a.column,x=a.endRow,T=a.endColumn,A=a.rowRelative,k=a.columnRelative,M=a.endRowRelative,I=a.endColumnRelative,E=v,R=S,D=x,N=T,s&&s===P){if(i&&o)v+=!A&&r<=v?n:0,x+=!M&&r<=x?n:0;else if(!i&&o)S+=!k&&r<=S?n:0,T+=!I&&r<=T?n:0;else if(i&&!o){if(!A&&r<=v&&!M&&x<r+n)return L;if(A&&M||x<r)return a;if(!A)if(r+n<=v)v-=n;else if(!(v<r)){if(M)return L;r<v&&(v=r)}if(!M)if(r+n<=x)x-=n;else{if(A)return L;x<r+n&&(x=r-1)}}else{if(!k&&r<=S&&!I&&T<r+n)return L;if(k&&I||T<r)return a;if(!k)if(r+n<=S)S-=n;else if(!(S<r)){if(I)return L;r<S&&(S=r)}if(!I)if(r+n<=T)T-=n;else{if(k)return L;T<r+n&&(T=r-1)}}if(S!==R||T!==N||v!==E||x!==D)return O.uf(P,B,v,S,x,T,A,k,M,I)}}else if(10===a.type){if((F=a.value)!==(_=j(e,t,r,n,o,i,F)))return O.Lh(_)}else 13===a.type&&((s=a.source||e&&e.yj())&&s===P&&!i&&(a=a.offsetWhenInsertRemoveColumn(r,n,o)));return a}function m(e,t){var r,n,o,i,a,s,l,u=t.ah,c=u.getSource(),h=-1,f=-1;t.name?(n=t.name,i=t.id,C(i)?r=u.getNodeByName(n):(r={Lf:t.expression},o=!0)):(h=void 0===(h=t.row)?-1:h,f=void 0===(f=t.column)?-1:f,r=u.getNode(h,f)),a=r.Lf,s=r.Pf,l=e.unparse(c,a,h<0?0:h,f<0?0:f),s&&(!0!==e.allowDynamicArray||!0===e.allowDynamicArray&&!s.isDynamicArray)?h===s.row&&f===s.col&&u.setArrayFormula(s.row,s.col,s.rowCount,s.colCount,l):n?o?u.setFormula(i,n,l):u.setFormulaByName(n,l):u.setFormula(h,f,l,null,!0,!0),r.Lf.ehc=a.ehc}function R(e,t){var r=e.offset(0,0,!1,0,0);return r.rowRelative=r.endRowRelative=r.columnRelative=r.endColumnRelative=t,r}Object.defineProperty(t,"__esModule",{value:!0}),b=r("Core"),f=r("Core"),n=r("@grapecity/js-sheets-common"),O=r("@grapecity/js-calc"),c=r("./dist/plugins/sheetsCalc/calc-spreadjs.js"),E=r("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),B=null,d=b.GC$.each,h=n.Common.u.Nb,o=new n.Common.ResourceManager(b.SR),y=o.getResource.bind(o),C=n.Common.j.Fa,u=parseInt,(i=b.Worksheet.prototype).resetCalc=function(){a.call(this),this.Ru=!0},i.recalcAll=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g=w(this);if(g){if(this.suspendPaint(),g.suspend(!0),e)for(r=(t=this.parent)&&t.sheets||[this],n=0;n<r.length;n++){if(i=(o=r[n]).Tu,a=o.yj(),i)for(s in i)u=(l=i[s]).Lf,c=g.unparse(a,u,0,0),l.Lf=g.parse(a,c,0,0);for(h=a.getCalcSourceModel().getAllNodes(),f=0;f<h.length;f++)(p=(d=h[f]).calc)&&d.Lf&&m(g,p)}g.resume(!0),this.resumePaint()}},i.recalcRange=function(e,t,r,n){var o=w(this);o&&o.recalcRange(this.yj(),e,t,r,n)},i.recalcRows=function(e){var t,r=w(this);if(r&&!r.ignoreDirty()){for(r.suspend(),t=0;t<e.length;t++)r.recalculate(this.ft,e[t],-1);r.resume(!1)}},i.recalcCols=function(e){var t,r=w(this);if(r&&!r.ignoreDirty()){for(r.suspend(),t=0;t<e.length;t++)r.recalculate(this.ft,-1,e[t]);r.resume(!1)}},i.zq=function(e,t,r){var n,o=w(this);o&&!o.ignoreDirty()&&(n=this.ft,1===r?n=this.fDc:2===r&&(n=this.hDc),o.recalculate(n,e,t))},i.getCalcService=function(){return this.Wu||(this.Wu=new O.CalcService,this.yj(b.SheetArea.colHeader).setCalcService(this.Wu),this.yj(b.SheetArea.rowHeader).setCalcService(this.Wu),this.yj().setCalcService(this.Wu),this.Wu.initParserContext(this.yj())),this.Wu},i.Cf=function(){return this.getCalcService()},i.suspendCalcService=function(e){var t=w(this);t&&t.suspend(e)},i.resumeCalcService=function(e){var t=w(this);t&&t.resume(e)},i.yj=function(e){return C(e)||3===e?this.ft:1===e?this.fDc:2===e?this.hDc:B},i.Bj=function(e){var t=this;return 1===e?(!t.eDc&&t.fDc&&(t.eDc=t.Cf().getSourceModel(t.fDc)),t.eDc):2===e?(!t.gDc&&t.hDc&&(t.gDc=t.Cf().getSourceModel(t.hDc)),t.gDc):(!t.et&&t.ft&&(t.et=t.Cf().getSourceModel(t.ft)),t.et)},i.iDc=function(e,t,r,n,o){var i=this.Bj(o);return i&&i.tg(e,t,r,n,!0,!0)},i.Ns=function(e,t,r,n,o,i){var a=this.iDc(e,t,r,n,3);return!a&&o&&(n=this.getColumnCount(2),a=this.iDc(e,0,r,n,2)),!a&&i&&(r=this.getRowCount(1),a=this.iDc(0,t,r,n,1)),a},i.Ms=function(e,t,r,n,o){var i=this.Bj(o);return i&&i.tg(e,t,r,n,!1,!0)},i.Vq=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m;return void 0===o&&(o=!0),s=o&&this.Ns(e,t,r,n,i,a),l=!o&&(p=i,g=a,!(m=v(u=this,c=e,h=t,f=r,d=n,3))&&p&&(d=u.getColumnCount(2),m=v(u,c,0,f,d,2)),!m&&g&&(f=u.getRowCount(1),m=v(u,0,h,f,d,1)),m),!s&&!l||(this.Os(4,y().Exp_ChangePartOfArray),!1)},i.addCustomFunction=function(e){this.Xu(e),this.recalcAll()},i.Xu=function(e){if(!(e&&e instanceof O.Functions.Function))throw Error(y().Exp_InvalidCustomFunction);this._functions[h(e.name)]=e},i.getCustomFunction=function(e){return e?this._functions[h(e)]:B},i.removeCustomFunction=function(e){e&&(delete this._functions[h(e)],this.recalcAll())},i.clearCustomFunctions=function(){this._functions={},this.recalcAll()},i.Pu=function(e){var t,r;return e?(t=this.parent,!(r=this.getCustomFunction(e))&&t&&t.getCustomFunction&&(r=t.getCustomFunction(e)),r):B},i.addCustomName=function(e,t,r,n,o){this.Yu(e,t,r,n,!1,o)},i.getCustomName=function(e){return e?this.Tu[h(e)]:void 0},i.getCustomNames=function(){var r=[];return d(this.Tu,function(e,t){r.push(t)}),r},i.removeCustomName=function(e){var t,r;e&&(t=h(e),delete this.Tu[t],(r={})[t]=t,this.Zu(r,!1))},i.clearCustomNames=function(){var e=this.Tu;this.Tu={},this.Zu(e,!1)},i.createNameInfo=function(e,t,r,n,o){var i,a=w(this),s=this.yj();return a&&s?(i=a.parse(s,t,n,o),new c.NameInfo(e,i,n,o,r)):B},i.H$a=function(e){var t,r=!this.Tu[h(e)];return r&&((t=this.tables)&&(r=!t.findByName(e))),r},i.isValidCustomName=function(e){return e&&b.Ul.G$a(e)&&this.H$a(e)},i.Yu=function(e,t,r,n,o,i){var a,s,l,u;if(!e||!t||!o&&!this.isValidCustomName(e))throw Error(y().Exp_InvalidCustomName);if(a=w(this),s=this.yj(),a&&s){if(l=void 0,o)try{l=a.parse(s,t,r,n,!1,!1,!0)}catch(e){}else l=a.parse(s,t,r,n);this.Tu[h(e)]=new c.NameInfo(e,l,r,n,i),o||((u={})[e]=e,this.Zu(u,!0))}},i.Zu=function(e,t){var r,n=this.Bj();if(n){for(r in e)n.updateNameCalc(r,t);this.recalcAll()}},i.$u=function(e){var t,r;return e?(t=this.parent,!(r=this.getCustomName(e))&&t&&t.getCustomName&&(r=t.getCustomName(e)),r):B},i.setFormula=function(e,t,r,n){this._u(e,t,r,B,!1,n)},i._u=function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b=this;return C(i)&&(i=3),e<0||e>=b.getRowCount(i)||t<0||t>=b.getColumnCount(i)?void b.Os(0,y().Exp_IndexOutOfRange):(u=0<=e?e:0,c=0<=t?t:0,h=b.yj(i),n=n||(r&&b.Wu?b.Wu.parse(h,r,u,c,!1,o,o):B),s&&(n.ensureSingle=!0),f=b.tables,void(3===i&&0<=e&&0<=t&&f&&!f.Hma(e,t,1,1,r,n)||(d=b.Bj(i),p=b.conditionalFormats,d&&(g=d.getFormula(e,t),m=b._modelManager,d.setFormula(e,t,r,n,o,void 0,m.dUa(),l),p&&p.Nm(),a||b.Bq("formula",e,t,i,g,r)),b.t4&&b.t4(e,t,1,1,i),b.$p())))},i.setArrayFormula=function(e,t,r,n,o,i){this.bv(e,t,r,n,o,!1,i)},i.bv=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p;if(void 0===a&&(a=3),l=this,e<0||e+r>l.getRowCount()||t<0||t+n>l.getColumnCount())l.Os(0,y().Exp_IndexOutOfRange);else if(l._modelManager.MTa(e,t,r,n))l.Os(0,y().Exp_ArrayFormulaSpan);else if(u=l.tables,!(3===a&&0<=e&&0<=t&&u)||u.Hma(e,t,r,n,o)){if(c=l.Bj(a),h=l.conditionalFormats,c&&(l.suspendEvent(),c.setArrayFormula(e,t,r,n,o,i,l._modelManager.dUa(),s),l.resumeEvent(),h&&h.Nm(),l.jm<1)){for(f=[],d=e;d<e+r;d++)for(p=t;p<t+n;p++)f.push({row:d,col:p});l.Bu(e,t,r,n,f,5,a,o)}l.$p()}},i.getFormula=function(e,t,r,n){var o=this.Bj(r);return o?o.getFormula(e,t,n):B},i.Ima=function(e,t,r){var n=this.Bj(r);return n?n.Kf(e,t):B},i.getFormulaInformation=function(e,t){var r,n,o,i,a,s={},l=this.Bj();return l&&((r=l.Kf(e,t))?(n=l.Qf(e,t),s.hasFormula=!0,n&&!n.isDynamicArray&&(s.baseRange=new b.Range(n.row,n.col,n.rowCount,n.colCount)),s.isArrayFormula=n&&!n.isDynamicArray,e=n?n.row:e,t=n?n.col:t,s.formula=this.Wu.unparse(this.ft,r,e,t),s.formulaWithCulture=this.Wu.unparse(this.ft,r,e,t,!0),s.hasFormula=!!s.formula):(o=this._modelManager.getDynamicArrayInfo(e,t))&&o.isValid&&(i=o.row,a=o.col,e===i&&t===a||(r=l.Kf(i,a),s.formulaWithCulture=this.Wu.unparse(this.ft,r,i,a,!0),s.hasFormula=!0,s.isDynamicArray=!0))),s},i.ngc=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b;for(r||(r=this,n=e,o=t,i=[]),a=r.getDependents(n,o),s=this.name(),l=0;l<a.length;l++){if(i[c=(u=a[l]).sheetName+"_"+u.row+"_"+u.col+"_"+u.rowCount+"_"+u.colCount])return!1;if(i[c]=!0,(u.row<=e&&e<u.row+u.rowCount||-1===u.rowCount)&&(u.col<=t&&t<u.col+u.colCount||-1===u.colCount)&&s===u.sheetName)return!0;for(h=u.sheetName===s?r:r.parent.getSheetFromName(u.sheetName),f=u.rowCount,d=u.row,p=u.colCount,g=u.col,-1===f&&(f=h.getRowCount(),d=0),-1===p&&(p=h.getColumnCount(),g=0),m=d;m<f+d;m++)for(b=g;b<p+g;b++)if(this.ngc(e,t,h,d,g,i))return!0}return!1},i.getPrecedents=function(e,t){var r,n,o,i,a=[],s=this.Bj();return s&&(r=s.Mf(e,t)||s.Kf(e,t),o=(n=this.getFormulaInformation(e,t).baseRange)?n.row:e,i=n?n.col:t,this.VGb(r,o,i,a),a=function(e){var t,r,n,o=[],i=[];for(t=0;t<e.length;t++)n=""+(r=e[t]).row+r.col+r.rowCount+r.colCount+r.sheetName,o.indexOf(n)<0&&(o.push(n),i.push(r));return i}(a)),a},i.getDependents=function(e,t){var r,n,o,i,a,s,l,u=[],c=this.Bj().qg(e,t),h=this.Bj().ug();if(c)for(n in r=c[0])r.hasOwnProperty(n)&&(a=(i=(o=r[n]).ah._source)?i.kj.name():this.name(),u.push({row:o.row,col:o.column,rowCount:1,colCount:1,sheetName:a}));if(h)for(n in s=h[0])s.hasOwnProperty(n)&&((-1===(l=s[n]).row||l.row<=e&&e+1<=l.row+l.rowCount)&&(-1===l.col||l.col<=t&&t+1<=l.col+l.colCount)&&(a=(i=(o=l[0]).ah._source)?i.kj.name():this.name(),u.push({row:o.row,col:o.column,rowCount:1,colCount:1,sheetName:a})));return u},i.VGb=function(e,t,r,n){var o,i,a,s,l;if(e)switch(e.type){case O.ExpressionType.reference:case O.ExpressionType.structReference:case O.ExpressionType.spillReference:o=e.getRange(t,r),n.push({row:o.row,col:o.col,rowCount:o.rowCount,colCount:o.colCount,sheetName:e.source&&e.source.kj?e.source.kj.name():this.name()});break;case O.ExpressionType.operator:this.VGb(e.value,t,r,n),this.VGb(e.value2,t,r,n);break;case O.ExpressionType.expand:case O.ExpressionType.parentheses:this.VGb(e.value,t,r,n);break;case O.ExpressionType.name:i=this.$u(e.value),this.VGb(i.getExpression(),t,r,n);break;case O.ExpressionType.function:for(a=e.arguments,s=0;s<a.length;s++)l=a[s],this.VGb(l,t,r,n)}},i.hasFormula=function(e,t){var r=this.Bj();return!!r&&r.hasFormula(e,t)},i.dv=function(){var e,t,r,n,o,i=this.Bj();if(i)for(e=0,t=i.rC(),r=i.cC();e<t;){for(n=0;n<r;)(o=i.qg(e,n))&&(o.ng(),o.og()),n++;e++}},i.clearFormula=function(e,t,r,n,o){var i,a;for(e<0&&(e=0,r=this.getRowCount()),t<0&&(t=0,n=this.getColumnCount()),i=0;i<r;i++)if(o(this,i+e))for(a=0;a<n;a++)this.setFormula(i+e,a+t,B)},i.nameFunctionsFromJSON=function(e,t,r,n){var o,i,a,s,l,u,c,h;if(e){if(o=e.customFunctions)for(i in o)o.hasOwnProperty(i)&&(a=o[i],(s=f.getTypeFromString(a.typeName))&&((l=new s).fromJSON(a,t),this.Xu(l)));if((u=e.names)&&0<u.length){for(c=0;c<u.length;c++)h=u[c],this.Yu(h.name,h.formula,h.row,h.col,!0,h.comment);this.dv()}n&&n()}},i.formulaFromJSON=function(e,t,a){var s,l,u;e&&(s=this,l=a&&a.ignoreFormula,u=a&&a.incrementalLoading,[e.colHeaderData,e.rowHeaderData,e.data].forEach(function(e,t){var r,n,o,i;e&&!l&&e.dataTable&&(r=t+1,n=e.dataTable,o=s.getRowCount(r),i=s.getColumnCount(r),u?x(s,n,o,i,a,0,r):function(e,t,r,n,o){var i,a,s;for(i=0;i<r;i++)if(a=t[i])for(s=0;s<n;s++)S(a[s],i,s,e,0,o)}(s,n,o,i,r))}),u?a.incrementLoadTask.pushTask(p,[s,e,t,a]):p(s,e,t,a))},i.ev=function(e){var t=this,r=t.Wu;r&&!e||(t.Wu=e||new O.CalcService,t.yj(b.SheetArea.colHeader).setCalcService(t.Wu),t.yj(b.SheetArea.rowHeader).setCalcService(t.Wu),t.yj(b.SheetArea.viewport).setCalcService(t.Wu),t.Wu.initParserContext(t.yj()),r?(e.setSourceModel(t.fDc,r.getSourceModel(t.fDc)),e.setSourceModel(t.hDc,r.getSourceModel(t.hDc)),e.setSourceModel(t.ft,r.getSourceModel(t.ft))):(t.eDc=t.Wu.getSourceModel(t.fDc),t.gDc=t.Wu.getSourceModel(t.hDc),t.et=t.Wu.getSourceModel(t.ft)))},i.setCalc=function(e,t){this.Wu=e,this.ft=t||this.ft,this.et=e.getSourceModel(this.ft),this.parent&&(this.parent.Wu=e)},i.fv=function(){this._endEditImp(!1,1)},i.mUa=function(e,t){var r,n,o,i,a,s,l,u,c=this,h=e.changeType,f=e.row,d=e.rowCount,p=e.col,g=e.colCount,m=c.Bj();m&&(n=(r=c._modelManager).dUa(),o=w(m),i=m._source,a=o.ih(),s=o.lh.asyncManager,"addingRows"===h?c.Vq(f,0,0,c.getColumnCount(),void 0,!0,!1)?(l=c.Bj(2),a.onBeforeAddRemoveRows(m,f,l),t||b.clearSpillValuesOnAddRemove(r,f,d,!0,!0),T(c,f,d,!0,!0),[m,l].forEach(function(e){e.addRows(f,d)}),s.addRows(i,f,d)):e.canAdd=!1:"addRows"===h?(o.suspend(),l=c.Bj(2),a.onAfterAddRemoveRows(m,f,d,!0,t,l),o.resume(!1),n&&n.push({type:"addRows",row:f,rowCount:d})):"deletingRows"===h?c.Vq(f,0,d,c.getColumnCount(),void 0,!0,!1)?(l=c.Bj(2),a.onBeforeAddRemoveRows(m,f,l),t||b.clearSpillValuesOnAddRemove(r,f,d,!1,!0),T(c,f,d,!1,!0),[m,l].forEach(function(e){e.deleteRows(f,d)}),s.deleteRows(i,f,d)):e.canDelete=!1:"deleteRows"===h?(o.suspend(),l=c.Bj(2),a.onAfterAddRemoveRows(m,f,d,!1,t,l),o.resume(!1),n&&n.push({type:"deleteRows",row:f,rowCount:d})):"addingColumns"===h?c.Vq(0,p,c.getRowCount(),0,void 0,!1,!0)?(u=c.Bj(1),a.onBeforeAddRemoveColumns(m,p,u),t||b.clearSpillValuesOnAddRemove(r,p,g,!0,!1),T(c,p,g,!0,!1),[m,u].forEach(function(e){e.addColumns(p,g)}),s.addColumns(i,f,d)):e.canAdd=!1:"addColumns"===h?(o.suspend(),u=c.Bj(1),a.onAfterAddRemoveColumns(m,p,g,!0,t,u),o.resume(!1),n&&n.push({type:"addColumns",col:p,colCount:g})):"deletingColumns"===h?c.Vq(0,p,c.getRowCount(),g,void 0,!1,!0)?(u=c.Bj(1),a.onBeforeAddRemoveColumns(m,p,u),t||b.clearSpillValuesOnAddRemove(r,p,g,!1,!1),T(c,p,g,!1,!1),[m,u].forEach(function(e){e.deleteColumns(p,g)}),s.deleteColumns(i,f,d)):e.canDelete=!1:"deleteColumns"===h&&(o.suspend(),u=c.Bj(1),a.onAfterAddRemoveColumns(m,p,g,!1,t,u),o.resume(!1),n&&n.push({type:"deleteColumns",col:p,colCount:g})))},i.nUa=function(e,t,r){var n=r.type;"addRows"===n?(r.changeType="deletingRows",this.mUa(r,!0),r.changeType="deleteRows",this.mUa(r,!0)):"deleteRows"===n?(r.changeType="addingRows",this.mUa(r,!0),r.changeType="addRows",this.mUa(r,!0)):"addColumns"===n?(r.changeType="deletingColumns",this.mUa(r,!0),r.changeType="deleteColumns",this.mUa(r,!0)):"deleteColumns"===n?(r.changeType="addingColumns",this.mUa(r,!0),r.changeType="addColumns",this.mUa(r,!0)):"customName"===n?r.nameInfo.fg(r.expr):"condition"===n&&r.condition.setExpressions(r.expressions)},i.gUa=function(e){var t,r=w(this),n=this.Bj();for(r.suspend();e.length;)(t=e.pop()).type?this.nUa(r,n,t):n.$Va.apply(n,t);r.resume(!1)},i.getReferenceRange=function(e){var t,r=this.yj(),n=this.getCalcService().evaluate(r,e,0,0,!0);if(n instanceof O.CalcReference&&(t=n.getSource().getName(),0<n.getRangeCount()))return{sheetName:t,range:b.kf(n.getRow(0),n.getColumn(0),n.getRowCount(0),n.getColumnCount(0))}},t.kDc=T,t.vyb=function(e,t,r,n,o,i,a,s,l){E.CalcOperatorAdjustor.copyFormula(e.Bj(),t,r,n.Bj(),o,i,a,s,l)},t.uyb=function e(t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I;if(9===c.type){if(h=c.value,f=c.value2,d=e(t,r,n,o,i,a,s,l,u,h),p=f&&e(t,r,n,o,i,a,s,l,u,f),h!==d||f!==p)return O.Kh(c.operatorType,d,p)}else if(7===c.type){for(g=!1,m=[],b=void 0,y=0;y<c.arguments.length;y++)C=e(t,r,n,o,i,a,s,l,u,b=c.arguments[y]),g=g||b!==C,m.push(C);if(g)return O.Jh(c,m)}else if(1===c.type){if(w=!c.rowRelative&&!c.columnRelative,v=!c.endRowRelative&&!c.endColumnRelative,S=r.yj(),(!c.source||c.source===S)&&w&&v)return x=i.yj(),T=new E.MoveSwapInfo(S,n,o,x,a,s,l,u),A=R(c,!0),(k=E.adjustFormulaOnMoveSwap(S,0,0,A,T,!0))===A?c:1===k.type&&R(k,!1)||k}else if(10===c.type&&(M=c.value)!==(I=e(t,r,n,o,i,a,s,l,u,M)))return O.Lh(I);return c},b.Worksheet.$n("calc",{priority:1e3,init:a,dispose:function(e){var t,r,n,o=this;!1!==e.clearCache&&(o.ft=B,o.hDc=B,o.fDc=B,o.Wu=B,(t=o.et)&&(!0===e.isSheetDestroy?t.eHb():t.rzb(),o.et=B),(r=o.gDc)&&(!0===e.isSheetDestroy?r.eHb():r.rzb(),o.gDc=B),(n=o.eDc)&&(!0===e.isSheetDestroy?n.eHb():n.rzb(),o.eDc=B))},attach:function(e){e instanceof b.Workbook?this.ev(e.Wu):this.ev()},onLayoutChanged:function(e){this.Cf().isAdjustSuspended()||this.mUa(e)},toJson:function(e,t){var l,r,u,n,c=this,o=c._functions;b.GC$.isEmptyObject(o)||(e.customFunctions=o),l=[],r=c.getCustomNames(),u=w(c),r&&u&&(d(r,function(e,t){var r,n=t.getName(),o=t.getRow(),i=t.getColumn(),a=t.getExpression(),s=t.getComment();a&&(r={name:n,formula:u.unparse(c.yj(),a,o,i,!1,!0,!0),row:o,col:i},s&&(r.comment=s),l.push(r))}),0<l.length&&(e.names=l)),t&&t.ignoreFormula||(n=[c.et,c.eDc,c.gDc],[e.data,e.colHeaderData,e.rowHeaderData].forEach(function(e,t){var r=n[t];r&&r.toJSON({data:e})}))},fromJson:function(e,t,r,n){r&&r.incrementalLoading||(this.clearCustomFunctions(),this.clearCustomNames()),n&&(this.nameFunctionsFromJSON(e,t,r),this.formulaFromJSON(e,t,r))},setName:function(e){(function(e){var t,r,n,o,i,a,s,l,u,c,h=w(e),f=[h.getSourceModel(e.yj(b.SheetArea.colHeader)),h.getSourceModel(e.yj(b.SheetArea.rowHeader)),h.getSourceModel(e.yj())];for(t=0;t<f.length;t++){if(!(r=f[t]))return;for(n=r.getAllNodes(),o=0;o<n.length;o++)if(i=n[o].calc)for(a=i.Ze,s=void 0,l=0;l<a.length;l++)if(u=i[a[l]])for(c in u)(s=u[c])&&s instanceof O.PathCalc&&m(h,s)}})(this),w(this.Bj()).lh.asyncManager.changeSourceName(e.oldName,e.newName)},beforeSetName:function(){this.uja&&(this.parent||this).tja()}})},"./dist/plugins/sparkline/functions-sparkline.js":function(e,t,p){"use strict";var n,m,r,b,g,y,C,w,d,o,i,v,a,s,S,l,x,T,u,c,h,f,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve=this&&this.__extends||(re=function(e,t){return(re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}re(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function Se(e){return 0===e}function xe(e){return 0===e||2===e}function Te(e){return xe(e)||8===e}function Ae(e,t){var r,n,o,i,a,s,l,u,c,h,f=[];if(w(e))for(r=0,n=e.getRangeCount();r<n;r++)for(o=e.getRowCount(r),i=e.getColumnCount(r),a=0;a<o;a++)for(s=0;s<i;s++)f.push(e.getValue(r,a,s));else if(t&&d(e))for(l=e.getRowCount(),u=e.getColumnCount(),c=0;c<l;c++)for(h=0;h<u;h++)f.push(e.getValue(c,h));return f}function ke(e,t){var r,n,o,i,a=[];if(w(e)&&t<e.getRangeCount())for(r=e.getRowCount(t),n=e.getColumnCount(t),o=0;o<r;o++)for(a[o]=[],i=0;i<n;i++)a[o].push(e.getValue(t,o,i));return a}function Me(e){var t;return w(e)?t=e.getValue(0,0,0):v(e)||(t=e),t}function Ie(){return ne.call(this)||this}function Ee(){return oe.call(this)||this}function Re(){return ie.call(this)||this}function De(){return ae.call(this)||this}function Ne(){return se.call(this)||this}function Fe(){return le.call(this)||this}function _e(){return ue.call(this)||this}function Pe(){return ce.call(this)||this}function Le(){return he.call(this)||this}function Oe(){return fe.call(this)||this}function Be(){return de.call(this)||this}function je(){return pe.call(this)||this}function He(){return ge.call(this)||this}function Ge(){return me.call(this)||this}function Ue(){var t,r,e=this.createFunction();e&&(t=e.name,r=e.evaluate,e.evaluate=function(){var e=r.call(this,arguments);return e instanceof n.CalcError?e:e?new P(t,e):null},(this.Cj=t)&&!n.Functions.findGlobalFunction(t)&&(n.Functions.ci[t]=e)),this.typeName=""}function We(e,t){this.name=e,this.value=t,this.typeName="SparklineExValue"}function Ve(e,p){function g(e){return new m.Range(e.getRow(0),e.getColumn(0),e.getRowCount(0),e.getColumnCount(0))}var t=new o(e,2,5);return t.evaluate=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d=e[0];if(w(d)&&0<d.getRangeCount()){for(c in t=g(d),r=d.getSource().getSheet().name(),n=e[1],o=e[2],s=a=i=void 0,w(o)&&(s=o.getSource().getSheet().name(),0<o.getRangeCount()&&(i=g(o),a=e[3])),l=function(e){var t,r,n,o,i,a={},s=!1,l=!0,u="",c="";if(e){for(t=0,r=(e=e.substr(1,e.length-2)).length;t<r;t++)":"===(n=e.charAt(t))?l=!1:","!==n||s?"'"===n||'"'===n||("("===n?s=!0:")"===n&&(s=!1),l?u+=n:c+=n):(a[u]=c,l=!(c=u=""));for(o in u&&(a[u]=c),a)a.hasOwnProperty(o)&&(i=a[o],v(i)||("TRUE"===i.toUpperCase()?a[o]=!0:"FALSE"===i.toUpperCase()?a[o]=!1:!x(i)&&isFinite(i)&&(a[o]=T(i))))}return a}(e[4]||"{}"),u={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"})u.hasOwnProperty(c)&&l.hasOwnProperty(c)&&(l[u[c]]=l[c]);return 1===(f=(h=new b.SparklineSetting(l)).options).maxAxisType&&(f.maxAxisType=0),1===f.minAxisType&&(f.minAxisType=0),{data:t,dataSheetName:r,dataOrientation:n,dateAxisData:i,dateAxisDataSheetName:s,dateAxisOrientation:a,sparklineType:p,displayDateAxis:i&&!v(a),setting:h,values:ke(d,0),dateValues:ke(o,0)}}},t.acceptsReference=xe,t}function ze(e,t,r,n,o,i,a){var s,l,u=b.Sparkline.cT,c=a.sheet,h=c.parent.getSheetFromName(t.dataSheetName),f=c.parent.getSheetFromName(t.dateAxisDataSheetName),d=t.setting;d&&d.options||(d=new b.SparklineSetting(d)),s=d.options.displayHidden,l={sparklineType:t.sparklineType,displayDateAxis:t.displayDateAxis,zoomFactor:a.zoomFactor,values:u(t.values,h||c,s,t.data,t.dataOrientation),dateValues:u(t.dateValues,f||c,s,t.dateAxisData,t.dateAxisOrientation,!0),settings:d,getColor:function(e){if(c&&e){var t=m.Rm.Om(c,e);if(t)return t}return e}},(new S).paint(e,l,r,n,o,i)}function qe(){return be.call(this)||this}function Ze(){return ye.call(this)||this}function Ye(){return Ce.call(this)||this}function Ke(){return we.call(this)||this}function Xe(e){e&&(te[e.name()]=e)}Object.defineProperty(t,"__esModule",{value:!0}),n=p("@grapecity/js-calc"),m=p("Core"),r=p("@grapecity/js-sheets-common"),b=p("./dist/plugins/sparkline/sparkline-wrapper.js"),w=n.Convert._isReference,d=n.Convert.Ca,o=n.Functions&&n.Functions.Function,i=n.Functions&&n.Functions.bi,v=r.Common.j.Fa,(a=m.GC$).inherit,s=a.extend,S=r.Sparklines.SparklineRender,l=r.Sparklines.SparklineExRenders,x=isNaN,T=parseFloat,u="PIESPARKLINE",c="AREASPARKLINE",h="SCATTERSPARKLINE",f="BULLETSPARKLINE",A="SPREADSPARKLINE",k="STACKEDSPARKLINE",M="HBARSPARKLINE",I="VBARSPARKLINE",E="VARISPARKLINE",R="BOXPLOTSPARKLINE",D="CASCADESPARKLINE",N="PARETOSPARKLINE",F="MONTHSPARKLINE",_="YEARSPARKLINE",We.prototype.toString=function(){return""},P=We,t.SparklineExValue=P,Ue.prototype.name=function(){return this.Cj},Ue.prototype.createFunction=function(){return null},Ue.prototype.paint=function(e,t,r,n,o,i,a){},Ue.prototype.toJSON=function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},Ue.prototype.fromJSON=function(e){if(e)for(var t in e)v(e[t])||(this[t]=e[t])},L=Ue,t.SparklineEx=L,ve(Ge,me=L),O=Ge,s((t.PieSparkline=O).prototype,{createFunction:function(){var e=new o(u,1,255);return e.evaluate=function(e){var t=e[0],r=Ae(t);return r.length<=0&&!v(t)&&r.push(t),{values:r,colors:Array.prototype.slice.call(e,1)}},e.acceptsReference=Se,e},paint:l[u]}),ve(He,ge=L),B=He,s((t.AreaSparkline=B).prototype,{createFunction:function(){var e=new o(c,1,7);return e.evaluate=function(e){return{points:Ae(e[0]),mini:e[1],maxi:e[2],line1:e[3],line2:e[4],colorPositive:e[5],colorNegative:e[6]}},e.acceptsReference=Se,e},paint:l[c]}),ve(je,pe=L),j=je,s((t.ScatterSparkline=j).prototype,{createFunction:function(){var e=new o(h,1,18);return e.evaluate=function(e){return{points1:ke(e[0],0),points2:ke(e[1],0),minX:e[2],maxX:e[3],minY:e[4],maxY:e[5],hLine:e[6],vLine:e[7],xMinZone:e[8],xMaxZone:e[9],yMinZone:e[10],yMaxZone:e[11],tags:e[12],drawSymbol:e[13],drawLines:e[14],color1:e[15],color2:e[16],dash:e[17]}},e.acceptsReference=function(e){return 0===e||1===e},e},paint:l[h]}),ve(Be,de=L),H=Be,s((t.BulletSparkline=H).prototype,{createFunction:function(){var e=new o(f,3,17);return e.evaluate=function(e){return{measure:Me(e[0]),target:Me(e[1]),maxi:Me(e[2]),good:Me(e[3]),bad:Me(e[4]),forecast:Me(e[5]),tickUnit:Me(e[6]),colorScheme:e[7],vertical:e[8],measureColor:e[9],targetColor:e[10],maxiColor:e[11],goodColor:e[12],badColor:e[13],forecastColor:e[14],allowMeasureOverMaxi:e[15],barSize:e[16]}},e.acceptsReference=function(e){return 0<=e&&e<=6},e},paint:l[f]}),ve(Oe,fe=L),G=Oe,s((t.SpreadSparkline=G).prototype,{createFunction:function(){var e=new o(A,1,7);return e.evaluate=function(e){var t,r,n,o,i,a,s,l,u=Ae(e[0]),c=[];if(!v(u)&&(c=function(e){var t,r,n,o,i,a={};for(r=void(t=0),n=e.length;t<n;t++)a[r=e[t]]?a[r]++:a[r]=1;for(i in o=[],a)a.hasOwnProperty(i)&&o.push({key:T(i),value:a[i]});return o.sort(function(e,t){return e.key-t.key})}(u=function(e){var t,r,n,o,i=[];for(n=r=0,o=e.length;r<o;r++)t=T(e[r]),!x(t)&&isFinite(t)&&(i[n]=t,n++);return i}(u)),3===(t=e[4])))for(r=0,n=c.length;r<n;r++){for(i=(o=c[r]).value,a=[],s=Math.max(100,10*i),l=0;l<s+i-1;l++)a.push(Math.random());o.randomNumbers=a}return{spreadData:c,showAverage:e[1],scaleStart:e[2],scaleEnd:e[3],style:t,colorScheme:e[5],vertical:e[6]}},e.acceptsReference=Se,e},paint:l[A]}),ve(Le,he=L),U=Le,s((t.StackedSparkline=U).prototype,{createFunction:function(){var e=new o(k,1,13);return e.evaluate=function(e){return{points:Ae(e[0]),colorRange:Ae(e[1]),labelRange:Ae(e[2]),maximum:e[3],targetRed:e[4],targetGreen:e[5],targetBlue:e[6],targetYellow:e[7],color:e[8],highlightPosition:e[9],vertical:e[10],textOrientation:e[11],textSize:e[12]}},e.acceptsReference=function(e){return 0<=e&&e<=2},e},paint:l[k]}),ve(Pe,ce=L),W=Pe,s((t.HBarSparkline=W).prototype,{createFunction:function(){var e=new o(M,1,4);return e.evaluate=function(e){return{value:Me(e[0]),colorScheme:e[1],axisVisible:e[2],barHeight:e[3]}},e.acceptsReference=Se,e},paint:l[M]}),ve(_e,ue=L),V=_e,s((t.VBarSparkline=V).prototype,{createFunction:function(){var e=new o(I,1,4);return e.evaluate=function(e){return{value:Me(e[0]),colorScheme:e[1],axisVisible:e[2],barWidth:e[3]}},e.acceptsReference=Se,e},paint:l[I]}),ve(Fe,le=L),z=Fe,s((t.VariSparkline=z).prototype,{createFunction:function(){var e=new o(E,1,10);return e.evaluate=function(e){return{variance:Me(e[0]),reference:Me(e[1]),mini:Me(e[2]),maxi:Me(e[3]),mark:Me(e[4]),tickUnit:Me(e[5]),legend:e[6],colorPositive:e[7],colorNegative:e[8],vertical:e[9]}},e.acceptsReference=function(e){return 0<=e&&e<=5},e},paint:l[E]}),ve(Ne,se=L),q=Ne,s((t.BoxPlotSparkline=q).prototype,{createFunction:function(){function n(e,t){return w(e)&&!x(t)&&0<=t&&t<=100?i.PERCENTILE.evaluate(e,t/100):NaN}var e=new o(R,1,10);return e.evaluate=function(e){var t,r=e[0];return{points:Ae(r),boxPlotClass:e[1],showAverage:e[2],scaleStart:Me(e[3]),scaleEnd:Me(e[4]),acceptableStart:Me(e[5]),acceptableEnd:Me(e[6]),colorScheme:e[7],style:e[8],vertical:e[9],perc02:n(r,2),perc09:n(r,9),perc10:n(r,10),perc90:n(r,90),perc91:n(r,91),perc98:n(r,98),q1:n(r,25),q3:n(r,75),median:n(r,50),stDev:w(t=r)?i.STDEVP.evaluate(t):NaN}},e.acceptsReference=Se,e},paint:l[R]}),ve(De,ae=L),Z=De,s((t.CascadeSparkline=Z).prototype,{createFunction:function(){var e=new o(D,1,10);return e.evaluate=function(e){return{points:Ae(e[0]),pointIndex:Me(e[1]),labels:Ae(e[2]),minimum:Me(e[3]),maximum:Me(e[4]),colorPositive:e[5],colorNegative:e[6],vertical:e[7],itemTypeRange:Ae(e[8],!0),colorTotal:e[9]}},e.acceptsReference=Te,e.acceptsArray=Te,e},paint:l[D]}),ve(Re,ie=L),Y=Re,s((t.ParetoSparkline=Y).prototype,{createFunction:function(){var e=new o(N,1,12);return e.evaluate=function(e){return{points:Ae(e[0]),pointIndex:Me(e[1]),colorRange:Ae(e[2],!0),target:Me(e[3]),target2:Me(e[4]),highlightPosition:Me(e[5]),label:e[6],vertical:e[7],targetColor:e[8],target2Color:e[9],labelColor:e[10],barSize:e[11]}},e.acceptsReference=xe,e.acceptsArray=xe,e},paint:l[N]}),ve(Ee,oe=L),K=Ee,s((t.MonthSparkline=K).prototype,{createFunction:function(){var e=new o(F,3,7);return e.evaluate=function(e){var t,r,n,o,i,a,s,l,u,c=e[0],h=e[1],f=e[2],d=f;for(w(f)&&(d=ke(f,0)),t=e[3],r=[],w(t)&&(r=ke(t,0)),n=[],o=[],i=0,a=d.length;i<a;i++)(s=d[i])&&((l=s[0])&&l.getFullYear()===c&&l.getMonth()+1===h&&(n[u=l.getDate()-1]=s[1],0<r.length&&(o[u]=r[i][0])));return 0<r.length?{year:c,month:h,values:n,colors:o}:{year:c,month:h,values:n,emptyColor:t,startColor:e[4],middleColor:e[5],endColor:e[6]}},e.acceptsReference=function(e){return 2===e||3===e},e},paint:l[F]}),ve(Ie,ne=L),Ie.daysOfMonth=function(e,t){switch(t){case 2:return e%4==0&&e%100!=0||e%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},Ie.dayInYear=function(e){var t,r=e.getFullYear(),n=e.getMonth(),o=e.getDate();for(t=1;t<n+1;t++)o+=Ie.daysOfMonth(r,t);return o},X=Ie,s((t.YearSparkline=X).prototype,{createFunction:function(){var e=new o(_,2,6);return e.evaluate=function(e){var t,r,n,o,i,a,s,l,u,c=e[0],h=e[1],f=h;for(w(h)&&(f=ke(h,0)),t=e[2],r=[],w(t)&&(r=ke(t,0)),n=[],o=[],i=0,a=f.length;i<a;i++)(s=f[i])&&((l=s[0])&&l.getFullYear()===c&&(n[u=X.dayInYear(l)-1]=s[1],0<r.length&&(o[u]=r[i][0])));return 0<r.length?{year:c,values:n,colors:o}:{year:c,values:n,emptyColor:t,startColor:e[3],middleColor:e[4],endColor:e[5]}},e.acceptsReference=function(e){return 1===e||2===e},e},paint:l[_]}),ve(Ke,we=L),J=Ke,s((t.LineSparkline=J).prototype,{createFunction:function(){return Ve("LINESPARKLINE",0)},paint:ze}),ve(Ye,Ce=L),Q=Ye,s((t.ColumnSparkline=Q).prototype,{createFunction:function(){return Ve("COLUMNSPARKLINE",1)},paint:ze}),ve(Ze,ye=L),$=Ze,s((t.WinlossSparkline=$).prototype,{createFunction:function(){return Ve("WINLOSSSPARKLINE",2)},paint:ze}),ve(qe,be=L),ee=qe,s((t.RangeBlockSparkline=ee).prototype,{createFunction:function(){var e=new o("RANGEBLOCKSPARKLINE",2,2);return e.evaluate=function(e){var t=e[0],r=t.getSource().getSheet(),n=t.getRow(0),o=t.getColumn(0),i=t.getRowCount(0),a=t.getColumnCount(0);return{templateSheetName:r.name(),templateRange:{row:n,col:o,rowCount:i,colCount:a},bindingObject:e[1]}},e.acceptsReference=Se,e},paint:function(e,t,r,n,o,i,a){var s,l,u,c,h,f=t.templateSheetName,d=t.templateRange;!f||(l=(s=a.sheet.parent)&&s.getSheetFromName(f))&&(y||(u=p("CellTypes"),y=u.Xgc,g=u.Wgc,C=u.paintRangeTemplate),c=(new y).YE(l,d),h=(new g).YE(l,d),C(e,{x:r,y:n,width:o,height:i},t.bindingObject,a,c,h.NJb))}}),te={},t.w_a=te,o&&(Xe(new O),Xe(new B),Xe(new j),Xe(new H),Xe(new G),Xe(new U),Xe(new W),Xe(new V),Xe(new z),Xe(new q),Xe(new Z),Xe(new Y),Xe(new K),Xe(new X),Xe(new J),Xe(new Q),Xe(new $),Xe(new ee)),s(m.Workbook.prototype,{addSparklineEx:function(e){this.dT||(this.dT={});var t=this.dT;e&&(t[e.name()]=e)},getSparklineEx:function(e){var t,r=te[e];return r||(t=this.dT)&&t[e]},removeSparklineEx:function(e){var t=this.dT;t&&(t[e]=void 0)}}),m.Workbook.$n("sparklineEx",{toJson:function(e){var t,r,n=this.dT,o=[];if(n){for(t in n)n.hasOwnProperty(t)&&((r=n[t].toJSON())&&r.typeName&&o.push(r));0<o.length&&(e.sparklineExs=o)}},fromJson:function(e){var t,r,n,o,i=e.sparklineExs;if(i)for(t=0;t<i.length;t++)r=i[t],(n=m.getTypeFromString(r.typeName))&&((o=new n).fromJSON(r),this.addSparklineEx(o))}})},"./dist/plugins/sparkline/sparkline-wrapper.entry.js":function(e,t,r){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),n=r("./dist/plugins/sparkline/functions-sparkline.js"),t.w_a=n.w_a,t.PieSparkline=n.PieSparkline,t.AreaSparkline=n.AreaSparkline,t.ScatterSparkline=n.ScatterSparkline,t.BulletSparkline=n.BulletSparkline,t.SpreadSparkline=n.SpreadSparkline,t.StackedSparkline=n.StackedSparkline,t.HBarSparkline=n.HBarSparkline,t.VBarSparkline=n.VBarSparkline,t.VariSparkline=n.VariSparkline,t.BoxPlotSparkline=n.BoxPlotSparkline,t.CascadeSparkline=n.CascadeSparkline,t.ParetoSparkline=n.ParetoSparkline,t.MonthSparkline=n.MonthSparkline,t.YearSparkline=n.YearSparkline,t.LineSparkline=n.LineSparkline,t.ColumnSparkline=n.ColumnSparkline,t.WinlossSparkline=n.WinlossSparkline,t.RangeBlockSparkline=n.RangeBlockSparkline,t.SparklineEx=n.SparklineEx,t.SparklineExValue=n.SparklineExValue,o=r("./dist/plugins/sparkline/sparkline-wrapper.js"),t.EmptyValueStyle=o.EmptyValueStyle,t.SparklineAxisMinMax=o.SparklineAxisMinMax,t.SparklineSetting=o.SparklineSetting,t.SparklineType=o.SparklineType,t.DataOrientation=o.DataOrientation,t.Sparkline=o.Sparkline},"./dist/plugins/sparkline/sparkline-wrapper.js":function(e,t,r){"use strict";var w,d,p,o,l,v,S,n,g,x,i,m,c,T,C,A,h,a,s,u,f,b,y,k,M,I,E,R,D,N;function F(e,t){var r=o.formulaToRanges(e,t,0,0)[0],n=r&&r.ranges&&r.ranges[0];return n?{range:n,sheetName:r.sheetName}:T}function _(e,t,r,n){var o=this.ZA;o.JUa(e,t,n),n&&o.add(n.group()),this.Bq("sparkline",e,t,3,r,n)}function P(e){this.Ub=[],this.kj=e,this.xn={},this.qZa=[],this.rZa=[]}function L(e,t,r){return r?e>r.row+r.rowCount-1?r:e>r.row?v(r.row,r.col,r.rowCount+t,r.colCount):v(r.row+t,r.col,r.rowCount,r.colCount):T}function O(e,t,r){return r?e>r.col+r.colCount-1?r:e>r.col?v(r.row,r.col,r.rowCount,r.colCount+t):v(r.row,r.col+t,r.rowCount,r.colCount):T}function B(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g=new w.KTa;for(i=0;i<e.length;i++)for(s=(a=e[i]).PS,a.displayDateAxis&&(l=(n?L:O)(t,r,a.dateAxisData()),a.dateAxisData(l)),u=0;u<s.length;u++)c=s[u],t<=(n?c.row:c.column)&&(g.set(i,u,c),o.JUa(c.row,c.column,T),n?c.row+=r:c.column+=r),h=(n?L:O)(t,r,c.data()),c.data(h);for(f=0;f<e.length;f++)for(d=e[f].PS,p=0;p<d.length;p++)o.SUa(g.get(f,p))}function j(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b;for(a=0;a<n.length;a++)(s=n[a]).displayDateAxis&&(u=(l=s.OW())._modelManager,c=!1,i&&!u.zTa&&(u.zTa=[],c=!0),h=(r?L:O)(e,t,s.dateAxisData()),s.dateAxisData(h),c&&(i.push({sheetName:l.name(),changes:u.zTa}),u.zTa=C));for(f=0;f<o.length;f++)g=(p=(d=o[f]).bT())._modelManager,m=!1,i&&!g.zTa&&(g.zTa=[],m=!0),b=(r?L:O)(e,t,d.data()),d.data(b),m&&(i.push({sheetName:p.name(),changes:g.zTa}),g.zTa=C)}function H(e,t,r){var n=U(r.col,r.col+r.colCount-1,e,e+t-1);return n?v(r.row,n.start,r.rowCount,n.end-n.start+1):T}function G(e,t,r){var n=U(r.row,r.row+r.rowCount-1,e,e+t-1);return n?v(n.start,r.col,n.end-n.start+1,r.colCount):T}function U(e,t,r,n){var o,i,a,s,l,u=-1;if(n<e)return{start:u=e-(i=n-r+1),end:t-i};if(t<r)return{start:u=e,end:t};if(r<=e){for(a=t-e+1,s=0,o=e;o<=n&&o<=t;o++)s++;return{start:u=r,end:u+a-s-1}}for(l=0,o=e;o<=t;o++)-1===u&&(o<r||n<o)&&(u=o),(o<r||n<o)&&l++;return-1!==u&&0<l?{start:u,end:u+l-1}:T}function W(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b=new w.KTa,y=e.length,C=0;for(i=y-1;-1<i;i--){if((a=e[i]).displayDateAxis){if(s=(n?G:H)(t,r,a.dateAxisData()),S(s)){a.clear(),o.remove(a);continue}a.dateAxisData(s)}for(l=(l=[]).concat(a.PS),u=x(l),C=A(u,C),c=u-1;-1<c;c--)h=l[c],t<=(f=n?h.row:h.column)&&f<t+r?(a.remove(h),o.JUa(h.row,h.column,T)):(t<=f&&(o.JUa(h.row,h.column,T),n?h.row-=r:h.column-=r,b.set(i,c,h)),d=(n?G:H)(t,r,h.data()),S(d)?a.remove(h):h.data(d));a.count()<=0&&o.remove(a)}for(g=0;g<y;g++)for(m=0;m<C;m++)(p=b.get(g,m))&&o.SUa(p)}function V(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y;for(a=n.length-1;-1<a;a--)(s=n[a]).displayDateAxis&&(u=(l=s.OW())._modelManager,c=!1,i&&!u.zTa&&(u.zTa=[],c=!0),h=(r?G:H)(e,t,s.dateAxisData()),S(h)?(s.clear(),s.ZA.remove(s)):s.dateAxisData(h),c&&(i.push({sheetName:l.name(),changes:u.zTa}),u.zTa=C));for(f=o.length-1;-1<f;f--)g=(p=(d=o[f]).bT())._modelManager,m=!1,i&&!g.zTa&&(g.zTa=[],m=!0),b=(r?G:H)(e,t,d.data()),S(b)?((y=d.group()).remove(d),y.count()<=0&&y.ZA.remove(y)):d.data(b),m&&(i.push({sheetName:p.name(),changes:g.zTa}),g.zTa=C)}function z(e,t){this.displayDateAxis=!1,this.ZA=T,this.PS=[],this.XS=T,this.YS=1,this.setting=t,this.sparklineType=e}function q(e){var t;for(t in this.options={},y)y.hasOwnProperty(t)&&(this.options[t]=e&&e[t]?e[t]:y[t]);this.WS=T}function Z(e,t,r,n,o,i){this.row=e,this.column=t,this._S=n,this.aT=r,this.cb=new M(o,i),this.cb.add(this)}Object.defineProperty(t,"__esModule",{value:!0}),w=r("Core"),d=r("@grapecity/js-sheets-common"),p=r("@grapecity/js-calc"),o=r("SheetsCalc"),l=w.GC$.isEmptyObject,v=w.kf,S=d.Common.j.Fa,n=d.Common.k,g=n.Fb,x=n.ac,i=n.Bb,m=d.Sparklines.Vd,c=d.Sparklines.SparklineRender,T=null,C=void 0,A=Math.max,h=Number.MAX_VALUE,w.GC$.extend(w.lUa.prototype,{FUa:function(e){var t,r,n=this.zTa,o=arguments[1];if(n){switch(n.GUa||(n.GUa=[]),t={type:e},e){case 0:r=o&&o.sparkline?o.sparkline:T,t.HUa={row:o.row,col:o.col,sparkline:r};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:t.HUa=o}n.GUa.push(t)}},IUa:function(e){var t,r,n,o,i,a,s,l,u,c,h,f=this,d=e.HUa;switch(e.type){case 12:d.sparkline?(d.sparkline.row=d.row,d.sparkline.column=d.col,f.ZA.JUa(d.row,d.col,d.sparkline)):f.ZA.JUa(d.row,d.col,T);break;case 0:f.ZA.JUa(d.row,d.col,d.sparkline),d.sparkline&&!f.ZA.contains(d.sparkline.group())&&f.ZA.add(d.sparkline.group());break;case 1:for(n=r=t=void 0,o=x(d),i=0;i<o;i++)t=d[i].row,r=d[i].col,n=f.ZA.KUa(t,r),0===i&&n.cb.count()===o&&f.ZA.remove(n.cb),this.ZA.add(n.group(d[i].group).cb);break;case 2:for(a=[],s=0;s<x(d);s++)a.push(f.ZA.KUa(d[s].row,d[s].col));f.ZA.kj.groupSparkline(a);break;case 3:f.ZA.KUa(d.row,d.col).sparklineType(d.sparklineType);break;case 4:f.ZA.KUa(d.row,d.col).setting(d.setting);break;case 5:d.sparkline.data(d.data);break;case 15:f.ZA.KUa(d.row,d.col).dataSheetName(d.dataSheetName);break;case 6:f.ZA.KUa(d.row,d.col).dataOrientation(d.dataOrientation);break;case 7:f.ZA.KUa(d.row,d.col).displayDateAxis(d.displayDateAxis);break;case 8:l=(u=d.rangeInfo)?v(u.row,u.col,u.rowCount,u.colCount):u,d.group.dateAxisData(l);break;case 16:d.group.dateAxisDataSheetName(d.dateAxisDataSheetName);break;case 9:d.group.dateAxisOrientation(d.dateAxisOrientation);break;case 10:for(d.group.PS.forEach(function(e){f.ZA.vZa(e)}),d.group.PS=d.PS,c=d.group.PS,h=0;h<x(c);h++)c[h].group(d.group);c.forEach(function(e){f.ZA.tZa(e)});break;case 11:f.ZA.KUa(d.row,d.col).group(d.group);break;case 13:g(f.ZA.groups(),d),f.ZA.yZa(d);break;case 14:f.ZA.groups().push(d),f.ZA.zZa(d)}},LUa:function(e){var t;for(t=x(e)-1;0<=t;t--)this.IUa(e[t])},MUa:function(e,t){this.ZA.rI(e,t)},NUa:function(e,t){this.ZA.GR(e,t)},OUa:function(e,t){this.ZA.tI(e,t)},PUa:function(e,t){this.ZA.HR(e,t)},QUa:function(e,t,r,n){this.ZA.clear(e,t,r,n)},wZa:function(){var e=this.zTa;return e?(e.xZa||(e.xZa=[]),e.xZa):T}}),w.lUa.$n("sparkline",{init:function(){var e=this.kj;this.ZA=new u(e)},undo:function(e){var t,r,n=e.GUa;n&&this.LUa(n),t=this.kj,(r=e.xZa)&&r.forEach(function(e){t.parent.getSheetFromName(e.sheetName)._modelManager.undo(e.changes)})}}),a={init:function(){this.ZA=this._modelManager.ZA},dispose:function(e){if(!1!==e.clearCache){this.ZA&&(this.ZA.kj=T,this.ZA.evaluator=T,this.ZA=T),this._modelManager&&(this._modelManager.ZA=T)}},onLayoutChanged:function(e){var t,r=e.changeType,n=e.row,o=e.rowCount,i=e.col,a=e.colCount,s=this._modelManager;"addRows"===r?s.MUa(n,o):"deleteRows"===r?s.NUa(n,o):"addColumns"===r?s.OUa(i,a):"deleteColumns"===r?s.PUa(i,a):"clear"===r&&(t=e.type,3===e.sheetArea&&16==(16&t)&&s.QUa(n,i,o,a))},toJson:function(e,t){t&&t.ignoreStyle||(e.sparklineGroups=this.ZA.toJSON())},fromJson:function(e,t,r){var n=r&&r.ignoreStyle,o=this.ZA,i=e.sparklineGroupManager,a=t?i&&i.groups:e.sparklineGroups;a&&!n&&o.RUa(a,t)},setName:function(e){var t=e.oldName,r=e.newName;this.ZA.jOa(t,r)}},w.Worksheet.$n("sparkline",a),s={getSparkline:function(e,t){return this.ZA?this.ZA.KUa(e,t):T},setSparkline:function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d;if(!this.ZA)return T;if("string"==typeof r){if(!(u=F(this,r)))return T;r=u.range,l=u.sheetName}if(c=new I(e,t,r,n,o,i),l&&l!==this.name()&&c.dataSheetName(l),a&&!S(s)){if(h=void 0,"string"==typeof a){if(!(f=F(this,a)))return T;a=f.range,h=f.sheetName}c.dateAxisData(a),h&&h!==this.name()&&c.dateAxisDataSheetName(h),c.dateAxisOrientation(s),c.group().displayDateAxis=!0}return d=this.getSparkline(e,t),this.removeSparkline(e,t),_.call(this,e,t,d,c),this.$p(),c},WLb:function(e,t,r){var n=this.getSparkline(e,t);_.call(this,e,t,n,r)},removeSparkline:function(e,t){var r,n,o,i=this.ZA;i&&(n={row:e,col:t,sparkline:r=this.getSparkline(e,t)},this._modelManager.FUa(0,n),r&&((o=r.group()).remove(r),o.count()<=0&&i.remove(o),_.call(this,e,t,r,T)),this.$p())},groupSparkline:function(e){var t,r,n,o,i,a,s=this.ZA;if(!s)return T;for(t=T,r=[],n=this._modelManager.zTa!==C,o=0;o<e.length;o++)(i=e[o])&&(n&&r.push({group:i.group().clone(),row:i.row,col:i.column}),t?((a=i.group()).remove(i),t.add(i),a.count()<=0&&s.remove(a)):t=i.group());return this.$p(),this._modelManager.FUa(1,r),t},ungroupSparkline:function(e){var t,r,n,o,i,a,s=this.ZA;if(s&&e){for(t=[],r=[],n=this._modelManager.zTa!==C,t=t.concat(e.PS),o=0;o<t.length;o++)(i=t[o])&&(n&&r.push({row:i.row,col:i.column}),e.remove(i),(a=e.clone()).add(i),s.add(a));s.remove(e),this._modelManager.FUa(2,r),this.$p()}}},w.GC$.extend(w.Worksheet.prototype,s),P.prototype.RUa=function(e,t){var r=this;r.fromJSON(e,t),r.groups().forEach(function(e){e.PS.forEach(function(e){r.SUa(e)})})},P.prototype.SUa=function(e){e&&this.JUa(e.row,e.column,e)},P.prototype.JUa=function(e,t,r){if(this.kj._modelManager.zTa){var n={row:e,col:t,sparkline:this.KUa(e,t)};this.kj._modelManager.FUa(12,n)}r?this.xn[e+"_"+t]=r:delete this.xn[e+"_"+t]},P.prototype.KUa=function(e,t){return this.xn[e+"_"+t]||T},P.prototype.groups=function(e){return 0===arguments.length?this.Ub:void(this.Ub=e)},P.prototype.add=function(e){this.kj._modelManager.FUa(13,e),this.groups().push(e),e.ZA=this,e.QS(),this.zZa(e)},P.prototype.zZa=function(e){var t=this;t.sZa(e),e.all().forEach(function(e){t.tZa(e)})},P.prototype.remove=function(e){this.kj._modelManager.FUa(14,e),g(this.groups(),e),this.yZa(e)},P.prototype.yZa=function(e){var t=this;t.uZa(e),e.all().forEach(function(e){t.vZa(e)})},P.prototype.contains=function(e){return i(this.groups(),e)},P.prototype.count=function(){return this.groups().length},P.prototype.rI=function(e,t){B(this.Ub,e,t,!0,this),j(e,t,!0,this.rZa,this.qZa,this.kj._modelManager.wZa())},P.prototype.tI=function(e,t){B(this.Ub,e,t,!1,this),j(e,t,!1,this.rZa,this.qZa,this.kj._modelManager.wZa())},P.prototype.GR=function(e,t){W(this.Ub,e,t,!0,this),V(e,t,!0,this.rZa,this.qZa,this.kj._modelManager.wZa())},P.prototype.HR=function(e,t){W(this.Ub,e,t,!1,this),V(e,t,!1,this.rZa,this.qZa,this.kj._modelManager.wZa())},P.prototype.jOa=function(t,r){this.rZa.forEach(function(e){e.dateAxisDataSheetName()===t&&e.dateAxisDataSheetName(r)}),this.qZa.forEach(function(e){e.dataSheetName()===t&&e.dataSheetName(r)})},P.prototype.tZa=function(e){var t,r,n=this.kj,o=e.dataSheetName();o&&o!==n.name()&&(!(t=n.parent.getSheetFromName(o))||(r=t.ZA.qZa).indexOf(e)<0&&r.push(e))},P.prototype.vZa=function(e){var t,r,n,o=e.dataSheetName();o&&(!(t=this.kj.parent.getSheetFromName(o))||0<=(n=(r=t.ZA.qZa).indexOf(e))&&r.splice(n,1))},P.prototype.sZa=function(e){var t,r,n=this.kj,o=e.dateAxisDataSheetName();o&&o!==n.name()&&(!(t=n.parent.getSheetFromName(o))||(r=t.ZA.rZa).indexOf(e)<0&&r.push(e))},P.prototype.uZa=function(e){var t,r,n,o=e.dateAxisDataSheetName();o&&(!(t=this.kj.parent.getSheetFromName(o))||0<=(n=(r=t.ZA.rZa).indexOf(e))&&r.splice(n,1))},P.prototype.clear=function(e,t,r,n){var o,i,a,s,l,u,c,h,f;if(0===arguments.length){for(o=this.Ub,i=x(o)-1;-1<i;i--)if(a=o[i]){for(s=a.count()-1;-1<s;s--)l=a.PS[s],this.JUa(l.row,l.column,T),a.remove(l);this.remove(a)}}else for(u=e;u<e+r;u++)for(c=t;c<t+n;c++)(h=this.RS(u,c))&&(this.JUa(h.row,h.column,T),(f=h.group()).remove(h),0===f.count()&&this.remove(f))},P.prototype.RS=function(e,t){var r,n,o,i,a=this.Ub;for(r=0;r<a.length;r++)for(n=a[r],o=0;o<n.count();o++)if((i=n.PS[o])&&i.row===e&&i.column===t)return i;return T},P.prototype.Zz=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C=this.kj;if(C){for(s=new w.KTa,l=r-e,u=n-t,f=C.getRowCount(),d=C.getColumnCount(),p=C.ZA,c=0;c<o;c++)if(!(a&&C.Ps&&C.Ps(r+c)))for(h=0;h<i;h++)(g=C.getSparkline(e+c,t+h))&&((m=g.clone()).row=r+c,m.column=n+h,b=m.dateAxisData(),!S(b)&&this.SS(b,l,u,f,d)&&m.dateAxisData(b.offset(u,l)),y=m.data(),!S(y)&&this.SS(y,l,u,f,d)&&m.data(y.offset(u,l)),this.add(m.group()),s.set(c,h,m));for(c=0;c<o;c++)if(!(a&&C.Ps&&C.Ps(r+c)))for(h=0;h<i;h++)p.JUa(r+c,n+h,s.get(c,h))}},P.prototype.SS=function(e,t,r,n,o){var i,a,s,l,u=this.TS(e);return!(!u||(i=A(u.row,0),a=A(u.col,0),s=u.row<0?n:u.rowCount,l=u.col<0?o:u.colCount,i+t<0||a+r<0||n<i+s+t||o<a+l+r))},P.prototype.aB=function(e,t,r,n,o,i){var a,s,l,u,c,h=this.kj;if(h){for(this.US(e,t,r,n,o,i),a=h.ZA,s=new w.KTa,l=0;l<o;l++)for(u=0;u<i;u++)(c=h.getSparkline(e+l,t+u))&&(c.row=r+l,c.column=n+u,s.set(l,u,c)),a.JUa(e+l,t+u,T);for(l=0;l<o;l++)for(u=0;u<i;u++)h.removeSparkline(r+l,n+u),a.JUa(r+l,n+u,s.get(l,u))}},P.prototype.US=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p=v(e,t,o,i),g=r-e,m=n-t,b=this.Ub;for(a=0;a<b.length;a++)for(s=b[a].PS,l=0;l<s.length;l++)(u=s[l])&&(c=u.dateAxisData(),(h=this.TS(c))&&p.containsRange(h)&&p.contains(u.row,u.column)&&u.dateAxisData(c.offset(m,g)),f=u.data(),(d=this.TS(f))&&p.containsRange(d)&&p.contains(u.row,u.column)&&u.data(f.offset(m,g)))},P.prototype.TS=function(e){return e},P.prototype._A=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C=this.kj;if(C){if(e===C)return void this.Zz(t,r,n,o,i,a);for(l=n-t,u=o-r,c=C.ZA,h=C.getRowCount(),f=C.getColumnCount(),d=0;d<i;d++)if(!(s&&C.Ps&&C.Ps(n+d)))for(p=0;p<a;p++)(g=e.getSparkline(t+d,r+p))?((m=g.clone()).row=n+d,m.column=o+p,b=m.dateAxisData(),!S(b)&&this.SS(b,l,u,h,f)&&m.dateAxisData(b.offset(u,l)),y=m.data(),!S(y)&&this.SS(y,l,u,h,f)&&m.data(y.offset(u,l)),this.add(m.group()),c.JUa(n+d,o+p,m)):c.JUa(n+d,o+p,T)}},P.prototype.$A=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p=this.kj;if(p){if(e===p)return void this.aB(t,r,n,o,i,a);for(s=e.ZA,l=p.ZA,this.VS(e,t,r,n,o,i,a),u=0;u<i;u++)for(c=0;c<a;c++)(h=e.getSparkline(t+u,r+c))?(h.row=n+u,h.column=o+c,d=(f=h.group()).clone(),f.remove(h),f.count()<=0&&s.remove(f),d.add(h),this.add(d),l.JUa(n+u,o+c,h)):l.JUa(n+u,o+c,T),s.JUa(t+u,r+c,T)}},P.prototype.VS=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C=this.kj;if(e&&C){if(e===C)return void this.US(t,r,n,o,i,a);for(s=v(t,r,i,a),l=n-t,u=o-r,c=e.ZA.Ub,h=0;h<c.length;h++)for(f=c[h],d=0;d<f.PS.length;d++)(p=f.PS[d])&&(g=p.dateAxisData(),(m=this.TS(g))&&s.containsRange(m)&&s.contains(p.row,p.column)&&p.dateAxisData(g.offset(u,l)),b=p.data(),(y=this.TS(b))&&s.containsRange(y)&&s.contains(p.row,p.column)&&p.data(b.offset(u,l)))}},P.prototype.toJSON=function(){var e,t=this.Ub,r=[];for(e=0;t&&e<t.length;e++)r.push(t[e].toJSON());return 0===r.length?C:r},P.prototype.fromJSON=function(e,t){var r,n,o;for(this.Ub.length=0,this.xn={},r=0;e&&r<e.length;r++)n=e[r],(o=new M).fromJSON(n,t),this.add(o)},u=P,(N=t.EmptyValueStyle||(t.EmptyValueStyle={}))[N.gaps=0]="gaps",N[N.zero=1]="zero",N[N.connect=2]="connect",(D=t.SparklineAxisMinMax||(t.SparklineAxisMinMax={}))[D.individual=0]="individual",D[D.group=1]="group",D[D.custom=2]="custom",f=d.Common.pc.bc(255,149,179,215),b=d.Common.pc.bc(255,36,64,98),y={axisColor:"black",firstMarkerColor:f,highMarkerColor:"Blue",lastMarkerColor:f,lowMarkerColor:"Blue",markersColor:b,negativeColor:"Brown",seriesColor:b,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},q.prototype.clone=function(){return new q(this.options)},q.prototype.toJSON=function(){var e,t=this.options,r={};for(e in t)y[e]!==t[e]&&(r[e]=t[e]);return l(r)?C:r},k=q,t.SparklineSetting=k,(R=t.SparklineType||(t.SparklineType={}))[R.line=0]="line",R[R.column=1]="column",R[R.winloss=2]="winloss",(E=t.DataOrientation||(t.DataOrientation={}))[E.vertical=0]="vertical",E[E.horizontal=1]="horizontal",z.prototype.OW=function(){var e;return this.ZA&&(e=this.ZA.kj),e},z.prototype.TUa=function(){var e,t=this.OW();t&&t._modelManager.zTa&&(e={group:this,PS:this.PS.concat()},t._modelManager.FUa(10,e))},z.prototype.add=function(e){var t;e&&(this.TUa(),this.PS.push(e),e.group(this),this.QS(),(t=this.ZA)&&t.tZa(e),this.onGroupChanged())},z.prototype.clear=function(){this.TUa();var t=this.ZA;t&&this.PS.forEach(function(e){t.vZa(e)}),this.PS=[]},z.prototype.all=function(){return this.PS},z.prototype.remove=function(e){var t,r=this.PS;return this.TUa(),g(r,e),e.onSparklineChanged(),e.cb=this.clone(),this.QS(),(t=this.ZA)&&t.vZa(e),this.onGroupChanged(),r},z.prototype.contains=function(e){return i(this.PS,e)},z.prototype.onGroupChanged=function(){var e,t,r=this.PS;if(r)for(e=0;e<r.length;e++)(t=r[e])&&t.onSparklineChanged()},z.prototype.clone=function(){var e=this.setting?this.setting.clone():T,t=new z(this.sparklineType,e);return t.displayDateAxis=this.displayDateAxis,t.XS=this.XS,t.nZa=this.nZa,t.YS=this.YS,t},z.prototype.dateAxisData=function(e){var t,r,n=this;return 0===arguments.length?n.XS:((t=n.OW())&&t._modelManager.zTa&&(r={group:n,rangeInfo:n.XS?{row:n.XS.row,col:n.XS.col,rowCount:n.XS.rowCount,colCount:n.XS.colCount}:T},t._modelManager.FUa(8,r)),void(n.XS!==(n.XS=e)&&n.onGroupChanged()))},z.prototype.dateAxisDataSheetName=function(e){var t,r,n;return 0===arguments.length?this.nZa:(t=this.nZa,(r=this.OW())&&r._modelManager.zTa&&(n={group:this,dateAxisDataSheetName:t},r._modelManager.FUa(16,n)),t!==e&&(t&&r&&r.ZA.uZa(this),(this.nZa=e)&&r&&r.ZA.sZa(this),this.onGroupChanged()),this)},z.prototype.dateAxisOrientation=function(e){var t,r;return 0===arguments.length?this.YS:((t=this.OW())&&t._modelManager.zTa&&(r={group:this,dateAxisOrientation:this.YS},t._modelManager.FUa(9,r)),void(this.YS!==(this.YS=e)&&this.onGroupChanged()))},z.prototype.count=function(){return this.PS.length},z.prototype.QS=function(){var e,t,r,n,o,i,a,s,l=this.setting,u=this.PS;if(l&&((e=l.options).groupMaxValue=-h,e.groupMinValue=h,t=1===e.maxAxisType,r=1===e.minAxisType,t||r))for(n=0;n<u.length;n++)o=u[n],a=(i=this.ZS(o)).min,s=i.max,t&&e.groupMaxValue<s&&(e.groupMaxValue=s),r&&e.groupMinValue>a&&(e.groupMinValue=a)},z.prototype.ZS=function(e){var t,r,n,o,i,a=-h,s=h,l=e.data();if(l)for(r=(t=e.bT())&&t.parent.getSheetFromName(e.dataSheetName()),n=e.$S(l,e.dataOrientation(),!1,r||t),o=0;o<n.length;o++)(i=n[o])===m&&(i=0),"number"==typeof i&&(a=a<i?i:a,s=i<s?i:s);return{min:s,max:a}},z.prototype.toJSON=function(){var e,t,r,n,o,i,a={setting:this.setting?this.setting.toJSON():T,displayDateAxis:this.displayDateAxis,sparklineType:this.sparklineType,axisOrientation:this.YS,sparklines:this.PS.map(function(e){return e.toJSON()})},s=this.XS;for(t in s&&(a.axisReference={row:s.row,col:s.col,rowCount:s.rowCount,colCount:s.colCount,sheetName:this.nZa}),e={},a)a.hasOwnProperty(t)&&(r=a[t],o=r,i=void 0,i=!1,"setting"===(n=t)||"axisReference"===n?i=o===T:"displayDateAxis"===n?i=!1===o:"axisOrientation"===n?i=1===o:"sparklines"===n&&(i=0===o.length),i||(e[t]=r));return l(e)?C:e},z.prototype.fromJSON=function(e,t){var r,n,o,i,a,s,l,u,c;if(e&&(r=this,n=e.displayDateAxis,o=e.sparklineType,i=e.axisReference,a=e.axisOrientation,s=e.sparklines,r.setting=new k(e.setting),S(n)||(r.displayDateAxis=n),S(o)||(r.sparklineType=o),S(i)||(r.XS=v(i.row,i.col,i.rowCount,i.colCount),r.nZa=i.sheetName),S(a)||(r.YS=a),s))for(r.PS=[],l=0,u=s.length;l<u;l++)(c=new I).fromJSON(s[l]),r.add(c)},M=z,Z.prototype.group=function(e){var t,r,n,o,i=this;return 0===arguments.length?((t=i.cb)||((t=new M).add(i),i.cb=t),t):(r=i.cb,(n=i.bT())&&n._modelManager.zTa&&(o={row:i.row,col:i.column,group:r},n._modelManager.FUa(11,o)),e!==r&&(r&&r.remove(i),(i.cb=e)&&!e.contains(i)&&e.add(i),i.onSparklineChanged()),n&&n.$p(),i)},Z.prototype.sparklineType=function(e){var t,r,n,o;return 0===arguments.length?this.group().sparklineType:((r=(t=this.group()).sparklineType)!==e&&(t.sparklineType=e,(n=this.bT())&&n._modelManager.zTa&&(o={row:this.row,col:this.column,sparklineType:r},n._modelManager.FUa(3,o)),this.onSparklineChanged(),n&&n.$p()),this)},Z.prototype.onSparklineChanged=function(){var e=this.bT();e&&e.Wq(w.Events.SparklineChanged,{sheet:e,sheetName:e.name(),sparkline:this})},Z.prototype.setting=function(e){var t,r=this.group(),n=this.bT(),o=n&&n._modelManager.zTa;return 0===arguments.length?o?w.GC$.extend(!0,{},r.setting):r.setting:(o&&(t={row:this.row,col:this.column,setting:w.GC$.extend(!0,{},r.setting)},n._modelManager.FUa(4,t)),r.setting=e,n&&n.$p(),this)},Z.prototype.data=function(e){var t,r,n=this;return 0===arguments.length?n.aT:((t=n.bT())&&t._modelManager.zTa&&(r={row:n.row,col:n.column,sparkline:n,data:w.GC$.extend(!0,{},n.aT)},t._modelManager.FUa(5,r)),n.aT!==e&&(n.aT=e,n.onSparklineChanged()),t&&t.$p(),n)},Z.prototype.dataSheetName=function(e){var t,r,n,o=this;return 0===arguments.length?o.oZa:(t=o.oZa,(r=o.bT())&&r._modelManager.zTa&&(n={row:o.row,col:o.column,dataSheetName:t},r._modelManager.FUa(15,n)),t!==e&&(t&&r&&r.ZA.vZa(o),(o.oZa=e)&&r&&r.ZA.tZa(o),o.onSparklineChanged()),o)},Z.prototype.dataOrientation=function(e){var t,r;return 0===arguments.length?this._S:((t=this.bT())&&t._modelManager.zTa&&(r={row:this.row,col:this.column,dataOrientation:this._S},t._modelManager.FUa(6,r)),this._S!==e&&(this._S=e,this.onSparklineChanged()),t&&t.$p(),this)},Z.prototype.dateAxisData=function(e){var t=this.group();return 0===arguments.length?t.dateAxisData():(t.dateAxisData(e),this)},Z.prototype.dateAxisDataSheetName=function(e){var t=this.group();return 0===arguments.length?t.dateAxisDataSheetName():(t.dateAxisDataSheetName(e),this)},Z.prototype.dateAxisOrientation=function(e){var t=this.group();return 0===arguments.length?t.dateAxisOrientation():(t.dateAxisOrientation(e),this)},Z.prototype.displayDateAxis=function(e){var t,r,n=this.group();return 0===arguments.length?n.displayDateAxis:((t=this.bT())&&t._modelManager.zTa&&(r={row:this.row,col:this.column,displayDateAxis:n.displayDateAxis},t._modelManager.FUa(7,r)),n.displayDateAxis=e,this)},Z.prototype.clone=function(){var e=new Z;return e.row=this.row,e.column=this.column,e.data(this.data()),e.dataSheetName(this.dataSheetName()),e.dataOrientation(this.dataOrientation()),e.group(this.group().clone()),e},Z.prototype.paintSparkline=function(e,t,r,n,o){var i,a,s,l=this,u=l.bT();u&&u.parent&&(i=u.parent.getSheetFromName(l.dataSheetName()),a=u.parent.getSheetFromName(l.dateAxisDataSheetName())),this.lKb&&(u=this.lKb),s={sparklineType:l.sparklineType(),displayDateAxis:l.displayDateAxis(),zoomFactor:u.zoom(),values:l.hKb||l.$S(l.data(),l.dataOrientation(),!1,i||u),dateValues:l.jKb||l.$S(l.dateAxisData(),l.dateAxisOrientation(),!0,a||u),settings:l.setting(),getColor:function(e){if(u&&e){var t=w.Rm.Om(u,e);if(t)return t}return e}},(new c).paint(e,s,t,r,n,o)},Z.prototype.iKb=function(e){return this.$S(this.data(),this.dataOrientation(),!1,e)},Z.prototype.kKb=function(e){return this.$S(this.dateAxisData(),this.dateAxisOrientation(),!0,e)},Z.prototype.$S=function(e,t,r,n){var o=this.setting().options.displayHidden;return Z.cT(C,n,o,e,t,r)},Z.prototype.bT=function(){var e=this.group(),t=e&&e.ZA;return t?t.kj:T},Z.prototype.toJSON=function(){return{row:this.row,col:this.column,orientation:this._S,data:{row:this.aT.row,rowCount:this.aT.rowCount,col:this.aT.col,colCount:this.aT.colCount,sheetName:this.oZa}}},Z.prototype.fromJSON=function(e){var t,r,n,o,i;e&&(t=e.row,r=e.col,n=e.orientation,o=e.data,S(t)||(this.row=t),S(r)||(this.column=r),S(n)||(this._S=n),o&&(i=o,this.aT=v(i.row,i.col,i.rowCount,i.colCount),this.oZa=i.sheetName))},Z.cT=function(e,t,r,n,o,i){var a,s,l,u,c,h=[],f=1===o;if(t&&n)for(a=0,s=f?n.colCount:n.rowCount;a<s;a++)l=f?0:a,u=f?a:0,(c=e?e[l][u]:t.getValue(n.row+l,n.col+u))instanceof p.CalcError||(!r&&(t.getRowHeight(n.row+l)<=0||t.getColumnWidth(n.col+u)<=0)?c=NaN:S(c)||(i?c="number"==typeof c?d.Common.l.Xb(c):Date.parse(c):"number"!=typeof c&&(c=m)),h.push(c));return h},I=Z,t.Sparkline=I},"./dist/plugins/table/table-action.js":function(e,t,r){"use strict";var c,n,o,l,h,f,d,p,i,g,a,m,b,y,u,s,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z=this&&this.__extends||(O=function(e,t){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}O(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function Y(e,t){var r=B.call(this,e)||this;return r.lMb=t,r.aMb=t.tableName,r}function K(e,t){var r=j.call(this,e)||this,n=r;return n.kMb=t,n.cj=t.row,n.dj=t.col,n.Yw=t.newValue,r}function X(e,t){var r=H.call(this,e)||this;return r.jMb=t,r.aMb=t.tableName,r}function J(e,t){var r=G.call(this,e)||this;return r.iMb=t,r.aMb=t.tableName,r.dj=t.col,r.Jb=t.count,r}function Q(e,t){var r=U.call(this,e)||this;return r.gMb=t,r.aMb=t.tableName,r.dj=t.col,r.Jb=t.count,r.dMb=t.isAfter,r}function $(e,t){var r=W.call(this,e)||this;return r.fMb=t,r.aMb=t.tableName,r.cj=t.row,r.Jb=t.count,r}function ee(e,t){var r=V.call(this,e)||this;return r.cMb=t,r.aMb=t.tableName,r.cj=t.row,r.Jb=t.count,r.dMb=t.isAfter,r}function te(e,t){var r=z.call(this,e)||this;return r.cMb=t,r.aMb=t.tableName,r.cj=t.row,r.Jb=t.count,r.dMb=t.isAfter,r}function re(e,t){var r=q.call(this,e)||this;return r._Lb=t,r.aMb=t.tableName,r.bMb=t.resizeToRange,r}Object.defineProperty(t,"__esModule",{value:!0}),c=r("Core"),n=r("@grapecity/js-sheets-common"),o=r("./dist/plugins/table/table-util.js"),l=o.Util.$Lb,h=o.Util.PIb,f=o.Util.QIb,d=o.Util._getTable,p=o.Util._Mb,i=c.Commands.ActionBase,g=n.Common.j.Fa,a="tableResize",m="tableInsertRows",b="tableDeleteRows",y="tableInsertColumns",u="tableDeleteColumns",s="tableToRange",C="tableTotalRowFormula",w="DoInsertRows",v="tableShowFooter",S="tableInsertRowsAboveForContextMenu",x="tableInsertRowsBelowForContextMenu",T="tableDeleteRowsForContextMenu",A="tableInsertColumnsLeftForContextMenu",k="tableInsertColumnsRightForContextMenu",M="tableDeleteColumnsForContextMenu",Z(re,q=i),re.prototype.execute=function(){var e,t,r,n,o,i,a,s=!1;if(this.canExecute()){t=(e=this.kj)._modelManager,r=this.aMb,n=this._Lb,t.startTransaction(),this.Lz(e,!0);try{(o=e.tables.findByName(r))&&(i=o.range(),a=this.bMb,e.tables.resize(o,a),l(e,o,i,a),s=!0)}finally{this.Mz(e),n[c.Commands.bWa(e.name())]=t.endTransaction()}}return s},re.prototype.undo=function(){var e,t,r,n,o=this.kj,i=this.aMb,a=!1;if(this.canUndo()){this.Lz(o,!0);try{e=this._Lb,t=o._modelManager,r=o.tables.findByName(i),(n=e[c.Commands.bWa(o.name())])&&(t.undo(n),l(o,r,e.resizeToRange,r.range()),t.wVa(n.uVa),a=!0)}finally{this.Mz(o,!0)}}return a},I=re,c.Commands[a]={canUndo:!0,execute:function(e,t,r){return c.Commands.h4(e,I,t,r)}},Z(te,z=i),te.prototype.execute=function(){var e,t,r,n,o,i,a,s,l,u=!1;if(this.canExecute()){t=(e=this.kj)._modelManager,r=this.aMb,n=this.cj,o=this.Jb,i=this.dMb,t.startTransaction(),this.Lz(e,!0);try{(a=e.tables.findByName(r))&&(s=a.Xj,a.Nia(n,o,i),u=!0,a.Xj-s===o&&h(e,a,m,n,o,i))}finally{this.Mz(e),l=c.Commands.bWa(e.name()),this.cMb[l]=t.endTransaction()}}return u},te.prototype.undo=function(){var e,t,r,n,o,i,a,s,l=this.kj,u=!1;if(this.canUndo()){this.Lz(l,!0);try{e=this.cMb,t=l._modelManager,r=e[c.Commands.bWa(l.name())],n=e.row,o=e.count,i=e.isAfter,r&&(t.undo(r),t.wVa(r.uVa),(a=l.tables.findByName(this.aMb))&&(s=i?n+1:n,a.ihc(s,o),a.NAb(),a.WNb(s,o,p(!0)),h(l,a,b,n,o,void 0,a.nKb())),u=!0)}finally{this.Mz(l,!0)}}return u},E=te,c.Commands[m]={canUndo:!0,execute:function(e,t,r){return c.Commands.h4(e,E,t,r)}},Z(ee,V=i),ee.prototype.execute=function(){var e,t,r,n,o,i,a,s,l=this,u=!1;if(l.canExecute()){t=(e=l.kj)._modelManager,r=l.aMb,n=l.cj,o=l.Jb,i=l.dMb,t.startTransaction(),l.Lz(e,!0);try{(a=e.tables.findByName(r))&&(a.eMb(n,o,i,!1),h(e,a,m,n,o,i),l.cMb.row=n,l.cMb.count=o,u=!0)}finally{l.Mz(e),s=c.Commands.bWa(e.name()),l.cMb[s]=t.endTransaction()}}return u},ee.prototype.undo=function(){var e,t,r,n,o,i,a,s,l=this.kj,u=!1;if(this.canUndo()){this.Lz(l,!0);try{e=this.cMb,t=l._modelManager,r=e[c.Commands.bWa(l.name())],n=e.row,o=e.count,i=e.isAfter,r&&(t.undo(r),t.wVa(r.uVa),(a=l.tables.findByName(this.aMb))&&(s=i?n+1:n,a.ihc(s,o),a.NAb(),a.WNb(s,o,p(!0)),h(l,a,b,n,o,a.nKb())),u=!0)}finally{this.Mz(l,!0)}}return u},R=ee,c.Commands[w]={canUndo:!0,execute:function(e,t,r){return c.Commands.h4(e,R,t,r)}},Z($,W=i),$.prototype.execute=function(){var e,t,r,n,o,i,a,s,l=!1;if(this.canExecute()){t=(e=this.kj)._modelManager,r=this.aMb,n=this.cj,o=this.Jb,t.startTransaction(),this.Lz(e,!0);try{(i=e.tables.findByName(r))&&(a=i.Xj,i.STa(n,o),l=!0,a-i.Xj===o&&h(e,i,b,n,o,void 0,i.nKb()))}finally{this.Mz(e),s=c.Commands.bWa(e.name()),this.fMb[s]=t.endTransaction()}}return l},$.prototype.undo=function(){var e,t,r,n,o,i,a=this.kj,s=!1;if(this.canUndo()){this.Lz(a,!0);try{e=this.fMb,t=a._modelManager,r=e[c.Commands.bWa(a.name())],n=e.row,o=e.count,r&&(t.undo(r),t.wVa(r.uVa),(i=a.tables.findByName(this.aMb))&&i.NAb(),h(a,i,m,n,o,!(s=!0)))}finally{this.Mz(a,!0)}}return s},D=$,c.Commands[b]={canUndo:!0,execute:function(e,t,r){return c.Commands.h4(e,D,t,r)}},Z(Q,U=i),Q.prototype.execute=function(){var e,t,r,n,o,i,a,s,l,u=!1;if(this.canExecute()){t=(e=this.kj)._modelManager,r=this.aMb,n=this.dj,o=this.Jb,i=this.dMb,t.startTransaction(),this.Lz(e,!0);try{(a=e.tables.findByName(r))&&(s=a.OZ,a.hMb(n,o,i),u=!0,a.OZ-s===o&&f(e,a,y,n,o,i))}finally{this.Mz(e),l=c.Commands.bWa(e.name()),this.gMb[l]=t.endTransaction()}}return u},Q.prototype.undo=function(){var e,t,r,n,o,i,a=this.kj,s=!1;if(this.canUndo()){this.Lz(a,!0);try{e=this.gMb,t=a._modelManager,r=e[c.Commands.bWa(a.name())],n=e.col,o=e.count,r&&(t.undo(r),t.wVa(r.uVa),(i=a.tables.findByName(this.aMb))&&i.NAb(),s=!0,f(a,i,u,n,o))}finally{this.Mz(a,!0)}}return s},N=Q,c.Commands[y]={canUndo:!0,execute:function(e,t,r){return c.Commands.h4(e,N,t,r)}},Z(J,G=i),J.prototype.execute=function(){var e,t,r,n,o,i,a,s,l=!1;if(this.canExecute()){t=(e=this.kj)._modelManager,r=this.aMb,n=this.dj,o=this.Jb,t.startTransaction(),this.Lz(e,!0);try{(i=e.tables.findByName(r))&&(a=i.OZ,i.TTa(n,o),l=!0,a-i.OZ===o&&f(e,i,u,n,o))}finally{this.Mz(e),s=c.Commands.bWa(e.name()),this.iMb[s]=t.endTransaction()}}return l},J.prototype.undo=function(){var e,t,r,n,o,i,a=this.kj,s=!1;if(this.canUndo()){this.Lz(a,!0);try{e=this.iMb,t=a._modelManager,r=e[c.Commands.bWa(a.name())],n=e.col,o=e.count,r&&(t.undo(r),t.wVa(r.uVa),(i=a.tables.findByName(this.aMb))&&i.NAb(),f(a,i,y,n,o,!(s=!0)))}finally{this.Mz(a,!0)}}return s},F=J,c.Commands[u]={canUndo:!0,execute:function(e,t,r){return c.Commands.h4(e,F,t,r)}},Z(X,H=i),X.prototype.execute=function(){var e,t,r,n,o,i=!1;if(this.canExecute()){t=(e=this.kj)._modelManager,r=this.aMb,t.startTransaction(),this.Lz(e,!0);try{(n=e.tables.findByName(r))&&(e.tables.remove(n,3),i=!0)}finally{this.Mz(e),o=c.Commands.bWa(e.name()),this.jMb[o]=t.endTransaction()}}return i},X.prototype.undo=function(){var e,t,r,n,o=this.kj,i=!1;if(this.canUndo()){this.Lz(o,!0);try{e=this.jMb,t=o._modelManager,(r=e[c.Commands.bWa(o.name())])&&(t.undo(r),t.wVa(r.uVa),(n=o.tables.findByName(this.aMb))&&n.NAb(),i=!0)}finally{this.Mz(o,!0)}}return i},_=X,c.Commands[s]={canUndo:!0,execute:function(e,t,r){return c.Commands.h4(e,_,t,r)}},Z(K,j=i),K.prototype.execute=function(){var e,t,r,n,o,i,a=!1;if(this.canExecute()){(t=(e=this.kj)._modelManager).startTransaction(),this.Lz(e,!0);try{r=this.cj,n=this.dj,o=this.Yw,e.setFormula(r,n,o),o||e.setValue(r,n,null),a=!0}finally{this.Mz(e),i=c.Commands.bWa(e.name()),this.kMb[i]=t.endTransaction()}}return a},K.prototype.undo=function(){var e,t,r,n=this.kj,o=!1;if(this.canUndo()){this.Lz(n,!0);try{e=this.kMb,t=n._modelManager,(r=e[c.Commands.bWa(n.name())])&&(t.undo(r),t.wVa(r.uVa),o=!0)}finally{this.Mz(n,!0)}}return o},P=K,c.Commands[C]={canUndo:!0,execute:function(e,t,r){return c.Commands.h4(e,P,t,r)}},Z(Y,B=i),Y.prototype.execute=function(){var e,t,r,n,o,i=!1;if(this.canExecute()){t=(e=this.kj)._modelManager,r=this.aMb,t.startTransaction(),this.Lz(e,!0);try{(n=e.tables.findByName(r))&&(n.showFooter(!0),i=!0)}finally{this.Mz(e),o=c.Commands.bWa(e.name()),this.lMb[o]=t.endTransaction()}}return i},Y.prototype.undo=function(){var e,t,r,n=this.kj,o=!1;if(this.canUndo()){this.Lz(n,!0);try{e=this.lMb,t=n._modelManager,(r=e[c.Commands.bWa(n.name())])&&(t.undo(r),t.wVa(r.uVa),o=!0)}finally{this.Mz(n,!0)}}return o},L=Y,c.Commands[v]={canUndo:!0,execute:function(e,t,r){return c.Commands.h4(e,L,t,r)}},c.Commands[S]={canUndo:!0,execute:function(e,t,r){var n,o,i,a,s,l,u;return t.cmd=S,g(t.row)&&g(t.count)?(n=c.Commands.bT(e,t),l=s=a=i=void 0,1===(o=t.selections).length&&(i=o[0],(a=d(n,i))&&(s=i.row,l=i.rowCount,u=a.footerIndex()===s,t.row=u?s-1:s,t.count=l,t.tableName=a.name(),t.isAfter=u),c.Commands.h4(e,E,t,r))):c.Commands.h4(e,E,t,r)}},c.Commands[x]={canUndo:!0,execute:function(e,t,r){if(t.cmd=x,g(t.row)&&g(t.count)){var n=c.Commands.bT(e,t),o=t.selections,i=void 0,a=void 0,s=void 0,l=void 0;return 1===o.length&&(i=o[0],(a=d(n,i))&&(s=i.row,l=i.rowCount,t.row=s,t.count=l,t.tableName=a.name(),t.isAfter=!0),c.Commands.h4(e,E,t,r))}return c.Commands.h4(e,E,t,r)}},c.Commands[T]={canUndo:!0,execute:function(e,t,r){if(t.cmd=T,g(t.row)&&g(t.count)){var n=c.Commands.bT(e,t),o=t.selections,i=void 0,a=void 0,s=void 0,l=void 0;return 1===o.length&&(i=o[0],(a=d(n,i))&&(s=i.row,l=i.rowCount,t.row=s,t.count=l,t.tableName=a.name()),c.Commands.h4(e,D,t,r))}return c.Commands.h4(e,D,t,r)}},c.Commands[A]={canUndo:!0,execute:function(e,t,r){if(t.cmd=A,g(t.col)&&g(t.count)){var n=c.Commands.bT(e,t),o=t.selections,i=void 0,a=void 0,s=void 0,l=void 0;return 1===o.length&&(i=o[0],(a=d(n,i))&&(s=i.col,l=i.colCount,t.col=s,t.count=l,t.tableName=a.name(),t.isAfter=!1),c.Commands.h4(e,N,t,r))}return c.Commands.h4(e,N,t,r)}},c.Commands[k]={canUndo:!0,execute:function(e,t,r){if(t.cmd=k,g(t.col)&&g(t.count)){var n=c.Commands.bT(e,t),o=t.selections,i=void 0,a=void 0,s=void 0,l=void 0;return 1===o.length&&(i=o[0],(a=d(n,i))&&(s=i.col,l=i.colCount,t.col=s,t.count=l,t.tableName=a.name(),t.isAfter=!0),c.Commands.h4(e,N,t,r))}return c.Commands.h4(e,N,t,r)}},c.Commands[M]={canUndo:!0,execute:function(e,t,r){if(t.cmd=M,g(t.col)&&g(t.count)){var n=c.Commands.bT(e,t),o=t.selections,i=void 0,a=void 0,s=void 0,l=void 0;return 1===o.length&&(i=o[0],(a=d(n,i))&&(s=i.col,l=i.colCount,t.col=s,t.count=l,t.tableName=a.name()),c.Commands.h4(e,F,t,r))}return c.Commands.h4(e,F,t,r)}},c.Commands.mMb=function(e){e.register(a,c.Commands[a]),e.register(m,c.Commands[m]),e.register(w,c.Commands[w]),e.register(b,c.Commands[b]),e.register(y,c.Commands[y]),e.register(u,c.Commands[u]),e.register(s,c.Commands[s]),e.register(C,c.Commands[C]),e.register(v,c.Commands[v]),e.register(S,c.Commands[S]),e.register(x,c.Commands[x]),e.register(T,c.Commands[T]),e.register(A,c.Commands[A]),e.register(k,c.Commands[k]),e.register(M,c.Commands[M])}},"./dist/plugins/table/table-event.js":function(e,t,r){"use strict";var f,n,d,o,i,p,l,a,m,y,C,s;Object.defineProperty(t,"__esModule",{value:!0}),f=r("Core"),n=r("@grapecity/js-sheets-common"),d=r("./dist/plugins/table/table.js"),o=r("./dist/plugins/table/table.ns.js"),i=r("./dist/plugins/table/table-util.js"),p=n.Common.j.Fa,l=Math.abs,a=new n.Common.ResourceManager(o.SR),m=a.getResource.bind(a),y=i.Util.nMb,C=i.Util.oMb,s=i.Util.pMb,f.GC$.extend(f.iI.prototype,{oIb:function(e,t){var r=this.qgc(e,t);r&&t.setSelection(r.row,r.col,r.rowCount,r.colCount)},qgc:function(e,t){var r,n,o,i,a,s,l,u,c=t.getSelections(),h=e.tableSelectInfo;if(!t.isEditing()||t.getActiveRowIndex()===e.row&&t.getActiveColumnIndex()===e.col||t.endEdit(),o=n=0,(r=h.table).NZ&&(n=1),r.MZ&&(o=1),i=null,a=h.action,s=t._formulaTextBox&&t._formulaTextBox.ahc(),!p(s)&&0<s.length&&(c=s),a===d.TableSelectionType.TABLE_ROW_SELECT)i=f.kf(e.row,r.dj,1,r.OZ);else if(a===d.TableSelectionType.TABLE_COL_SELECT){for(l=0;l<c.length;l++)if((u=c[l]).col===e.col&&u.row===r.cj+o&&1===u.colCount&&u.rowCount===r.Xj-o-n){i=f.kf(r.cj,e.col,r.Xj,1);break}p(i)&&(i=f.kf(r.cj+o,e.col,r.Xj-o-n,1))}else if(a===d.TableSelectionType.TABLE_CORNER_SELECT){for(l=0;l<c.length;l++)if((u=c[l]).col===r.dj&&u.row===r.cj+o&&u.colCount===r.OZ&&u.rowCount===r.Xj-o-n){i=f.kf(r.cj,r.dj,r.Xj,r.OZ);break}p(i)&&(i=f.kf(r.cj+o,r.dj,r.Xj-o-n,r.OZ))}else a===d.TableSelectionType.TABLE_SELECT&&(i=f.kf(r.cj,r.dj,r.Xj,r.OZ));return i},iJb:function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m=this.kj,b=null;return m&&!m.options.isProtected&&!m.isEditing()&&t&&t.showResizeHandle()&&(r=e.row,n=e.col,o=e.x,i=e.y,a=e.rowViewportIndex,s=e.colViewportIndex,l=y(m,t),u=C(m,t),r===l&&n===u&&(h=(c=m.getCellRect(r,n,a,s)).x,f=c.y,d=c.width,g=f+c.height,(p=h+d)-10<=o&&o<=p&&g-10<=i&&i<=g&&(b={x:o,y:i,table:t}))),b},pIb:function(e){var t,r,n,o,i,a=this;!0!==a.qIb&&!0!==a._isWorking&&(t=a.kj,(n=(r=e.resizeTableHitInfo)&&r.table)&&!n.hJb()&&(a.qIb=!0,a._isWorking=!0,a.qMb=n,a.rMb=n.cj,a.sMb=n.dj,a.tMb=n.Xj,a.uMb=n.OZ,o=a.rMb+a.tMb-1,i=a.sMb+a.uMb-1,a.vMb=t.getCellRect(o,i),a.wMb=n.range(),a.rG={KG:e.rowViewportIndex,MG:e.colViewportIndex,sG:e.hitTestType},a.qG()))},rIb:function(){var e=this,t=e.kj;e.rG&&e.qIb&&e._isWorking&&e.qMb&&(e.xMb(),e.yMb()&&(e.zMb=e.AMb(),e.BMb(),e.CMb(),(e.DMb||e.EMb()).equals(e.FMb)||(e.DMb=f.kf(e.FMb.row,e.FMb.col,e.FMb.rowCount,e.FMb.colCount),s(t,e.qMb,e.EMb(),e.FMb))),e.NG())},wIb:function(){var e,t=this,r=t.kj;return t.RG(),t.qIb&&t._isWorking&&t.FMb&&t.qMb?(t.qIb=!1,t._isWorking=!1,void(t.HMb()?(e=t.EMb(),t.IMb(),e.equals(t.FMb)?r._render.JMb():r.wu().execute({cmd:"tableResize",sheetName:r.name(),tableName:t.qMb.name(),resizeToRange:t.FMb}),t.GMb()):(t.GMb(),r._render.JMb()))):void t.GMb()},EMb:function(){var e=this.qMb;return f.kf(e.cj,e.dj,e.Xj,e.OZ)},xMb:function(){var e=this.fH(),t=this.gH();this.KMb=e,this.LMb=t},yMb:function(){var e=this.rMb,t=this.sMb,r=this.KMb,n=this.LMb;return(this.qMb.MZ?e+1:e)<=r&&t<=n},AMb:function(){var e=this.$F,t=this.vMb,r=t.x+t.width,n=t.y+t.height,o=e.x,i=e.y,a=l(n-i);return l(r-o)<=a?i<n?2:3:o<r?0:1},BMb:function(){var e=this,t=e.rMb,r=e.sMb,n=e.KMb,o=e.LMb,i=e.zMb,a=e.tMb,s=e.uMb;switch(i){case 0:case 1:s=l(o-r)+1;break;case 2:case 3:a=l(n-t)+1}e.FMb?(e.FMb.rowCount=a,e.FMb.colCount=s):e.FMb=f.kf(t,r,a,s)},CMb:function(){this.kj._render.JMb(),this.wMb=this.MMb()},MMb:function(){var e=this.FMb,t=e.row,r=e.col,n=e.rowCount,o=e.colCount;return f.kf(t,r,n,o)},IMb:function(){var e=this.qMb;2===this.zMb&&e.NZ&&(this.FMb.rowCount+=1)},HMb:function(){var e=this.kj,t=!1,r=e._modelManager,n=e.tables,o=this.qMb,i=this.FMb,a=i.row,s=i.col,l=i.rowCount,u=i.colCount,c=this.KMb,h=this.LMb,f=y(e,o),d=C(e,o),p=this.zMb,g=o.xr;return f&&d&&(r.MTa(a,s,l,u)||r.qu(a,s,l,u)?e.Os(6,m().Exp_TableResizeToSpan):g&&g.isFiltered()?2===p?e.Os(6,m().Exp_TableResizeWithHidden):3===p&&o.NZ?e.Os(6,m().Exp_TableResizeWithFilter):t=!0:2===p&&this.NMb(f,c)||0===p&&this.OMb(d,h)?e.Os(6,m().Exp_TableResizeWithHidden):1===p&&(n.rn(a,d+1,l,h-d)||n.HZ(a,d+1,l,h-d))||3===p&&(n.rn(f+1,s,c-f,u)||n.HZ(f+1,s,c-f,u))?e.Os(6,m().Exp_TableResizeToTable):t=!0),t},NMb:function(e,t){var r,n=this.kj,o=!1;for(r=e;t<r;r--)if(n.getRowHeight(r)<=0){o=!0;break}return o},OMb:function(e,t){var r,n=this.kj,o=!1;if(!o)for(r=e;t<r;r--)if(n.getColumnWidth(r)<=0){o=!0;break}return o},GMb:function(){this.qIb=!1,this._isWorking=!1,this.rG=null,this.FMb=null,this.DMb=null}})},"./dist/plugins/table/table-render.js":function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),(0,(n=r("Core")).GC$.extend)(n.oJ.prototype,{JMb:function(){0<this.kj.Xq||this.im()}}),n.Worksheet.$n("tableRender",{paintAdornment:function(e){var t,r,n,o,i,a,s=e.ctx,l=this._eventHandler;l&&l.rG&&l.qIb&&(t=this,r=s,n=l.iH(),o=l.jH(),i=t._eventHandler.FMb,a=t.getRangeRect(n,o,i),r.strokeStyle=t.getSelectionBorderColor(),r.strokeRect(a.x,a.y,a.width,a.height))}})},"./dist/plugins/table/table-theme.js":function(e,t,r){"use strict";var l,f,a,u,n,o,i,s,c,h,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j;function H(){}function G(e,t,r,n,o,i,a,s,l,u){var c=this,h=arguments;f(F,function(e,t){c[t]=h[e]})}function U(e,t){return isNaN(t)?t:new l.LineBorder(e,t)}function W(e,t,r,n,o,i,a,s,l,u){var c=new _;return t&&(c.backColor=t),r&&(c.foreColor=r),n&&(c.font=k),o&&(c.borderLeft=U(e,o)),i&&(c.borderTop=U(e,i)),a&&(c.borderRight=U(e,a)),s&&(c.borderBottom=U(e,s)),l&&(c.borderHorizontal=U(e,l)),u&&(c.borderVertical=U(e,u)),c}function V(e){return 0===e?"Text 1":"Accent "+e}function z(e){var t,r=e-1,n=h,o=s(r/7);return 0<=o&&o<3&&(t="Light"+e,(n=[function(e){var t=V(e),r=t+" 80",n=new P;return n[d](W(t,0,t,1,0,0,0,1)),n[g](W(t,0,t,0,0,1,0,1)),n[y](W(t,r)),n[b](W(t,0,t,1)),n[m](W(t,0,t,1)),n[w](W(t,r)),n[p](W(t,0,t,1,0,1)),n},function(e){var t=V(e),r=new P;return r[d](W(t,t,L,1)),r[g](W(t,0,0,0,1,1,1,1)),r[y](W(t,0,0,0,0,1)),r[C](W(t,0,0,0,0,1)),r[w](W(t,0,0,0,1)),r[v](W(t,0,0,0,1)),r[b](W(t,0,0,1)),r[m](W(t,0,0,1)),r[p](W(t,0,0,1,0,6)),r},function(e){var t=V(e),r=t+" 80",n=new P;return n[d](W(t,0,0,1,0,0,0,2)),n[g](W(t,0,0,0,1,1,1,1,1,1)),n[y](W(t,r)),n[w](W(t,r)),n[b](W(t,0,0,1)),n[m](W(t,0,0,1)),n[p](W(t,0,0,1,0,6)),n}][o](r%7)).name&&n.name(t),n.builtInName&&n.builtInName(t)),n}function q(e){var t,r=e-1,n=h,o=s(r/7);return 0<=o&&o<4&&(t="Medium"+e,(n=[function(e){var t=V(e),r=t+" 20",n=t,o=t+" 80",i=new P;return i[d](W(r,n,L,1)),i[g](W(r,0,0,0,1,1,1,1,1)),i[y](W(r,o)),i[w](W(r,o)),i[b](W(r,0,0,1)),i[m](W(r,0,0,1)),i[p](W(r,0,O,1,0,6)),i},function(e){var t=V(e),r=L,n=t,o=t+" 60",i=t+" 80",a=new P;return a[d](W(r,n,L,1,0,0,0,2,0,1)),a[g](W(r,i,0,0,0,0,0,0,1,1)),a[y](W(r,o)),a[w](W(r,o)),a[b](W(r,n,L,1)),a[m](W(r,n,L,1)),a[p](W(r,n,L,1,0,2,0,0,0,1)),a},function(e){var t=V(e),r=t,n=0===e?O:"#D3D3D3",o=new P;return o[d](W(O,r,L,1,0,2,0,2)),o[g](W(n,0,0,0,1,new l.LineBorder(O,2),1,new l.LineBorder(O,2),0===e?1:0,1)),o[y](W(n,"#D3D3D3")),o[w](W(n,"#D3D3D3")),o[b](W(n,r,L)),o[m](W(n,r,L)),o[S](W(n,r,L,1)),o[x](W(n,r,L,1)),o[p](W(O,0,O,0,0,6)),o},function(e){var t=V(e),r=t,n=t+" 40",o=t+" 80",i=t+" 60",a=t+" 80",s=new P;return s[d](W(n,o,O,1,1,1,1,1,0,1)),s[g](W(n,o,0,0,1,1,1,1,1,1)),s[y](W(n,i)),s[w](W(n,i)),s[b](W(n,0,0,1)),s[m](W(n,0,0,1)),s[p](W(n,a,O,1,1,new l.LineBorder(r,2),1,1,0,1)),s}][o](r%7)).name(t),n.builtInName(t)),n}function Z(e){var t,r=e-1,n=h,o=s(r/7);return 0<=o&&o<2&&(t="Dark"+e,(n=[function(e){var t=V(e),r=O,n=0===e?t+" 25":t+" -25",o=0===e?t+" 50":t,i=0===e?t:t+" -50",a=new P;return a[d](W(L,r,L,1,0,0,0,2)),a[g](W(t,o,L)),a[y](W(t,n)),a[w](W(t,n)),a[b](W(L,n,L,1,0,0,2)),a[m](W(L,n,L,1,2)),a[p](W(L,i,L,1,0,2)),a},function(e){var t,r,n,o,i,a;function s(e,t){if(e<0||3<e)return"";return{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[t][e]}return t=V(e),r=s(e,"headerColor"),n=s(e,"stripColor"),o=s(e,"tableBackground"),i=o,(a=new P)[d](W(t,r,L)),a[g](W(t,o)),a[y](W(t,n)),a[w](W(t,n)),a[b](W(t,0,0,1)),a[m](W(t,0,0,1)),a[p](W(O,i,0,1,0,6)),a}][o](r%7)).name(t),n.builtInName(t)),n}for(Object.defineProperty(t,"__esModule",{value:!0}),l=r("Core"),f=l.GC$.each,a=l.GC$.isEmptyObject,u=l.Ul.Ol,n=JSON.stringify,o=JSON.parse,i=l.Ul.Pl,s=Math.floor,c=void 0,h=null,T=[d="headerRowStyle",p="footerRowStyle",g="wholeTableStyle",m="highlightLastColumnStyle",b="highlightFirstColumnStyle",y="firstRowStripStyle",C="secondRowStripStyle",w="firstColumnStripStyle",v="secondColumnStripStyle","firstHeaderCellStyle","lastHeaderCellStyle",S="firstFooterCellStyle",x="lastFooterCellStyle"],A=["firstRowStripSize","secondRowStripSize","firstColumnStripSize","secondColumnStripSize"],k="bold 11pt calibri",F=["backColor","foreColor","font",M="borderLeft",I="borderTop",E="borderRight",R="borderBottom",D="borderHorizontal",N="borderVertical","textDecoration"],G.prototype.Yo=function(r,n,o,i,a){var s=this;f(F,function(e,t){0<=t.indexOf("border")?(o&&u(s[M])&&!u(r[M])&&(r[M]=s[M],r[M].level=20),n&&u(s[I])&&!u(r[I])&&(r[I]=s[I],r[I].level=20),a&&u(s[E])&&!u(r[E])&&(r[E]=s[E],r[E].level=20),i&&u(s[R])&&!u(r[R])&&(r[R]=s[R],r[R].level=20),i||!u(s[D])||u(r[R])||(r[R]=s[D],r[R].level=20),a||!u(s[N])||u(r[E])||(r[E]=s[N],r[E].level=20)):u(s[t])&&!u(r[t])&&(r[t]=s[t])})},G.prototype.Uo=function(){var e=new G,t=n(this.toJSON());return e.fromJSON(o(t)),e},G.prototype.toJSON=function(){var o=this,i={};return f(F,function(e,t){var r=o[t],n=r&&r.toJSON?r.toJSON():r;i[t]=a(n)?c:n}),i},G.prototype.fromJSON=function(o,i){if(o){var a=this;f(F,function(e,t){var r,n=o[t];u(n)&&(0<=t.indexOf("border")?((r=new l.LineBorder).fromJSON(n,i),a[t]=r):a[t]=n)})}},_=G,t.TableStyle=_,H.prototype.toJSON=function(){var r,n,o=this,e=o.builtInName();return e?{buildInName:e}:(r={name:o.name()},f(T,function(e,t){(n=o[t]())&&(r[t]=n.toJSON())}),f(A,function(e,t){1!==(n=o[t]())&&(r[t]=n)}),a(r)?c:r)},H.prototype.fromJSON=function(o,i){var a,e,t,r,n,s;if(o){if(a=this,e=o.buildInName)return n=a,s=B[e.toLowerCase()],n.name(s.name()),f(A,function(e,t){n[t](s[t]())}),f(T,function(e,t){var r=s[t]();n[t](r?r.Uo():h)}),void n.builtInName(s.builtInName(),!1);t=o.name,r=u(t)?t:o.Cj,u(r)&&a.name(r,!1),f(A,function(e,t){var r=o[t]!==c?o[t]:o["_"+t];r&&a[t](r,!1)}),f(T,function(e,t){var r,n=o[t]!==c?o[t]:o["_"+t];n&&((r=new _).fromJSON(n,i),a[t](r,!1))})}},P=H,(t.TableTheme=P).prototype.name=i("name"),P.prototype.builtInName=i("builtInName"),f(T,function(e,t){P.prototype[t]=i(t)}),f(A,function(e,t){P.prototype[t]=i(t,1)}),L="white",O="black",B=function(){},t.TableThemes=B,j=1;j<=28;j++)j<=21&&(B["light"+j]=z(j)),j<=11&&(B["dark"+j]=Z(j)),B["medium"+j]=q(j)},"./dist/plugins/table/table-util.js":function(e,t,r){"use strict";var h,o,i,n,a,s,l,c,f,d,u,p,m;function b(e){throw Error(e)}function g(e){e.suspendPaint()}function y(e){e.resumePaint()}function C(e){i&&e.suspendCalcService()}function w(e,t){i&&e.resumeCalcService(t)}function v(e){return e&&!(/\d/.test(e[0])||/[\s\+\-\*\\:%!\[\]]/.test(e)||-1!==["C","c","R","r"].indexOf(e)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(e)||/^[Rr]\d*[Cc]\d*$/.test(e)||255<=e.length)}function S(e,t,r,n,o){return o=o===c||o,e.Wu.unparse(e.yj(),t,r,n,!1,o)}function x(e,t,r){var n=e.getValue(t,r);return n!==l&&s(n)||e.getSparkline&&e.getSparkline(t,r)||T(e.Iq(t,r))}function T(e){return!(!e||!(e.backColor||e.backgroundImage||e.borderBottom||e.borderLeft||e.borderRight||e.borderTop||e.diagonalDown||e.diagonalUp))}function A(e,t,r,n,o,i,a,s){return o<=e&&!(t===a&&t+n-1===s)&&(t<a&&a<=t+n||a<=t&&t<=s&&s<t+n-1)}function k(e,t,r,n,o,i,a,s){return a<=t&&!(e===o&&e+r-1===i)&&(e<o&&o<=e+r||o<=e&&e<=i&&i<e+r-1)}function M(e,t){var r=e.cj;return t-(e.MZ?r+1:r)}Object.defineProperty(t,"__esModule",{value:!0}),h=r("Core"),o=r("SheetsCalc"),i=r("@grapecity/js-calc"),n=r("@grapecity/js-sheets-common"),a=r("./dist/plugins/table/table.ns.js"),s=h.Ul.Ol,l=null,c=void 0,f=Math.max,d=n.Common.j.Fa,u=0,p=new n.Common.ResourceManager(a.SR),m=p.getResource.bind(p),t.Util={throwError:b,setFormulaToSheet:function(e,t,r,n,o){!n&&o&&(n=S(e,o,t,r)),i&&e._u(t,r,n,o)},setValue:function(e,t,r,n){e.setValue(t,r,n)},suspendPaint:g,resumePaint:y,ih:function(e){return e.Cf().ih()},suspendCalcService:C,resumeCalcService:w,RMb:function(e){e&&(g(e),e.suspendEvent(),C(e))},SMb:function(e){e&&(w(e),e.resumeEvent(),y(e))},getRowCount:function(e){return e.rowCount},getColCount:function(e){return e.colCount},isValidTableName:v,formulaToExpression:function(e,t,r,n,o){var i,a=e.yj();return a.DLb=o,i=e.Wu.parse(a,t,r,n,!1,!1,!1),delete a.DLb,i},expressionToFormula:S,checkTableName:function(e){var t,r,n;return!(!e||(v(e)||b(m().Exp_TableNameInvalid),t=this.name(),r=this.tc,e===t||r&&((n=r.findByName(e))&&this!==n)))},TMb:function(e,t,r){return{col:t,leadingCellRow:r,row:e}},nMb:function(e,t,r){var n=l,o=t.cj,i=t.endRow();for(r&&(i-=t.NZ?1:0);o<=i&&e.getRowHeight(i)<=0;)i--;return o<=i&&(n=i),n},oMb:function(e,t){for(var r=l,n=t.dj,o=t.endColumn();n<=o&&e.getColumnWidth(o)<=0;)o--;return n<=o&&(r=o),r},UMb:function(e,t){var r,n,o,i=t.tc,a=t.cj+t.Xj-1,s=t.dj,l=s+t.OZ-1,u=function(e){var t,r,n,o,i=e._modelManager,a=i._getSheetModel(3).dataTable,s=i.getLastNonNullRow(3,!0),l=e.getRowCount(),u=e.getColumnCount();for(n=l-1;-1<n;n--)if(t=a[n])for(o=0;o<u;o++)if((r=t[o])&&!d(r.value))return f(n,s);return f(-1,s)}(e),c=i?i.PMb():-1;return(r=a)<(u=f(u,c))&&(n=1+a,o=new h.Range(n,s,u-a,l-s+1),r=f(function(e,t,r,n,o){var i,a,s;for(i=r;t<=i;i--)for(a=n;a<=o;a++){if(T(e.Iq(i,a)))return i;if(x(e,i,a))return i;if(s=e._modelManager.findSpan(i,a))return s.row+s.rowCount-1}return-1}(e,n,u,s,l),i.PMb(o))),r},VMb:function(e,t){var r,n,o,i=t.tc,a=t.cj,s=a+t.Xj-1,l=t.dj+t.OZ-1,u=function(e){var t,r,n,o,i=e._modelManager,a=i._getSheetModel(3).dataTable,s=i.getLastNonNullCol(3,!0),l=e.getRowCount();for(n=e.getColumnCount()-1;-1<n;n--)for(o=0;o<l;o++)if((r=(t=a[o])&&t[n])&&!d(r.value))return f(n,s);return f(-1,s)}(e),c=i?i.QMb():-1;return(r=l)<(u=f(u,c))&&(n=1+l,o=new h.Range(a,n,s-a+1,u-l),r=f(function(e,t,r,n,o){var i,a,s;for(a=o;n<=a;a--)for(i=t;i<=r;i++){if(T(e.Iq(i,a)))return a;if(x(e,i,a))return a;if(s=e._modelManager.findSpan(i,a))return s.col+s.colCount-1}return-1}(e,a,s,n,u),i.QMb(o))),r},WMb:function(e,t,i,a,s,l,r,n,o,u){var c,h,f=e.getRowCount()-1,d=e.getColumnCount()-1,p=e._modelManager.getSpans(),g=t.tc&&t.tc.l$;return!n&&(!o&&f-a<r||o&&d-l<r)?(u||b(m().Exp_TableAddRowNoEnoughRoom),!0):(c=o?k:A,(h=p.some(function(e){var t=e.row,r=e.col,n=e.rowCount,o=e.colCount;return c(t,r,n,o,i,a,s,l)}))?u||b(m().Exp_TableAddRowIntersectSpan):g&&((h=g.some(function(e){var t=e.cj,r=e.dj,n=e.Xj,o=e.OZ;return c(t,r,n,o,i,a,s,l)}))&&!u&&b(m().Exp_TableAddRowIntersectTable)),h)},XMb:function(e,t,r){var n,o,i,a=t.row,s=t.col,l=a+t.rowCount,u=s+t.colCount;for(n=a;n<l;n++)for(o=s;o<u;o++)if((i=e.getCell(n,o)).value()||e._modelManager.findSpan(n,o)){if(r&&r.equals(new h.Range(i.row,i.col,1,1)))continue;return new h.Range(n,o,1,1)}return c},YMb:function(e,t){return{action:t,table:e}},ZMb:M,$Mb:function(e,t){return t-e.dj},_Mb:function(e){var t=u;return e&&u++,t},aNb:function(e){return"string"==typeof e},pMb:function(e,t,r,n){var o={sheet:e,table:t,oldRange:r,newRange:n};e.Wq(h.Events.TableResizing,o)},$Lb:function(e,t,r,n){var o={sheet:e,table:t,oldRange:r,newRange:n};e.Wq(h.Events.TableResized,o)},PIb:function(e,t,r,n,o,i,a){var s={sheet:e,table:t,propertyName:r,row:M(t,n),count:o};d(i)||(s.isAfter=i),a&&(s.deletedItem=a),e.Wq(h.Events.TableRowsChanged,s)},QIb:function(e,t,r,n,o,i){var a={sheet:e,table:t,propertyName:r,col:n-t.dj,count:o};d(i)||(a.isAfter=i),e.Wq(h.Events.TableColumnsChanged,a)},bNb:function(e,t,r){var n=0;if(e.VZ(t,r))for(n=2;e.VZ(t+n,n);)n++;return 0<n&&(t+=n),t},bW:function(e){return e&&"="===e[0]},cNb:function(e){var t,r,n=-1;if(e)for(t=e.arguments,r=0;r<t.length;r++)if(t[r]instanceof o.xzb){n=r;break}return n},dNb:function(e,t,r){var n=e.dataRange(),o=n.row,i=n.col;return(r?o:i)+t},eNb:function(e){var t=e;return e&&"="===e[0]&&(t=e.slice(1)),t},fNb:function(e,t){var r,n;for(n=0;n<e.length;n++)if((r=e[n])&&t===r.col)return r;return l},_getTable:function(e,t){var r,n,o;if(!t)return null;for(r=t.row;r<t.row+t.rowCount;r++)for(n=t.col;n<t.col+t.colCount;n++)if(e.tables&&(o=e.tables.find(r,n)))return o;return null},Pda:function(e,t){return t?e.tables.s$(t.row,t.col,t.rowCount,t.colCount):null},jhc:function(e){return d(e)||("string"!=typeof e&&(e+=""),e=e.replace(/\r\n?/g,"\n")),e},gNb:function(e){return e===c}}},"./dist/plugins/table/table.entry.js":function(e,r,t){"use strict";function n(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),t("./dist/plugins/table/table.interface.js"),t("./dist/plugins/table/table-event.js"),t("./dist/plugins/table/table-render.js"),t("./dist/plugins/table/table-action.js"),t("./dist/plugins/table/table-util.js"),n(t("./dist/plugins/table/table-theme.js")),n(t("./dist/plugins/table/table.js")),n(t("./dist/plugins/table/table.ns.js"))},"./dist/plugins/table/table.interface.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(e,F,t){"use strict";var Y,k,r,C,n,_,o,P,i,a,L,s,m,O,f,M,b,y,d,D,A,w,v,S,u,h,p,N,B,l,g,I,x,E,T,R,j,H,G,U,W,V,z,q,Z,K,X,c,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,Ee,Re,De,Ne,Fe,_e,Pe,Le,Oe,Be,je,He,Ge,Ue,We,Ve,ze,qe,Ze,Ye,Ke,Xe,Je,Qe,$e,et,tt,rt=this&&this.__extends||(Je=function(e,t){return(Je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}Je(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),nt=this&&this.__assign||function(){return(nt=Object.assign||function(e){var t,r,n,o;for(r=1,n=arguments.length;r<n;r++)for(o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ot(e,t){for(var r=e.length-1;t<r;r--)e[r]=e[r-1]}function it(e,t){var r={position:Y.ButtonPosition.right,imageType:Y.ButtonImageType.dropdown,visibility:Y.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},n={items:[{text:Ve().Table_None,value:null},{text:Ve().Table_Average,value:"=SUBTOTAL(101,["+t+"])"},{text:Ve().Table_Count,value:"=SUBTOTAL(103,["+t+"])"},{text:Ve().Table_Count_Numbers,value:"=SUBTOTAL(102,["+t+"])"},{text:Ve().Table_Max,value:"=SUBTOTAL(104,["+t+"])"},{text:Ve().Table_Min,value:"=SUBTOTAL(105,["+t+"])"},{text:Ve().Table_Sum,value:"=SUBTOTAL(109,["+t+"])"},{text:Ve().Table_StdDev,value:"=SUBTOTAL(107,["+t+"])"},{text:Ve().Table_Var,value:"=SUBTOTAL(110,["+t+"])"}]},o=new Y.Style;return o.cellButtons=[r],o.dropDowns=[{type:Y.DropDownType.list,option:n,submitCommand:"tableTotalRowFormula"}],o}function at(n){return function(e,t){var r=this.kj;r&&e!==t&&r._modelManager.pVa(this,n,t)}}function st(e,t,r,n,o,i,a){var s,l=this;for(l.MZ=!a||a.showHeader===le||a.showHeader,l.NZ=!(!a||a.showFooter===le)&&a.showFooter,l.kNb=!(!a||a.useFooterDropDownList===le)&&a.useFooterDropDownList,l.lNb=!(!a||a.showResizeHandle===le)&&a.showResizeHandle,l.mNb=[],l.wq=se,l.xr=se,l.tc=se,l.lhc=!1,L(e)&&l.name(e),l.cj=L(t)?t:-1,l.dj=L(r)?r:-1,l.Xj=L(n)?n:-1,l.OZ=L(o)?o:-1,L(i)&&l.style(i),l.Nz=[],s=0;s<l.OZ;s++)l.Nz.push(new Ke(s+1));l.ZX=se,l.LAb={},l.Bec=[],l.Ts=[],l.nNb=[],l.mhc=[],l.oNb=[],l.pNb=[],l.qNb=!0}function lt(e){this.kj=e,this.l$=[],this.$m=[],this.an=[]}function ut(e,t,r,n,o,i){this.id(e),this.dataField(t),this.name(r||t||Se+this.id()),this.formatter(n),this.cellType(o),this.value(i)}function ct(e){var t=tt.call(this)||this;return t.table(e),t}function ht(e,t,r,n,o){var i,a,s=0===o,l=s?e.Ts:e.nNb,u=-1;for(a=0;a<l.length;a++)if((i=l[a])&&i.key===n){u=a;break}-1<u&&l.splice(u,M(r)?1:r),s&&e.phc()}Object.defineProperty(F,"__esModule",{value:!0}),Y=t("Core"),k=t("SheetsCalc"),r=t("@grapecity/js-sheets-common"),C=t("@grapecity/js-calc"),n=t("Filters"),_=t("Bindings"),o=t("./dist/plugins/table/table.ns.js"),P=t("./dist/plugins/table/table-theme.js"),i=t("./dist/plugins/table/table-util.js"),a=Y.Ul.Pl,L=Y.Ul.Ol,s=Y.Ul.bc,m=Y.GC$.inArray,O=Y.GC$.each,f=Y.GC$.isEmptyObject,M=r.Common.j.Fa,b=r.Common.l,y=r.Common.k.Bb,d=r.Common.D,D=i.Util.throwError,A=i.Util.setFormulaToSheet,w=i.Util.setValue,v=i.Util.suspendPaint,S=i.Util.resumePaint,u=i.Util.ih,h=i.Util.suspendCalcService,p=i.Util.resumeCalcService,N=i.Util.getRowCount,B=i.Util.getColCount,l=i.Util.checkTableName,g=i.Util.isValidTableName,I=i.Util.formulaToExpression,x=i.Util.expressionToFormula,E=i.Util.TMb,T=i.Util.nMb,R=i.Util.oMb,j=i.Util.UMb,H=i.Util.VMb,G=i.Util.WMb,U=i.Util.XMb,W=i.Util.YMb,V=i.Util.ZMb,z=i.Util.$Mb,q=i.Util._Mb,Z=i.Util.aNb,K=i.Util.RMb,X=i.Util.SMb,c=i.Util.PIb,J=i.Util.QIb,Q=i.Util.bNb,$=i.Util.bW,ee=i.Util.cNb,te=i.Util.dNb,re=i.Util.eNb,ne=i.Util.fNb,oe=i.Util.Pda,ie=i.Util.jhc,ae=i.Util.gNb,se=null,le=void 0,ue=Math.min,ce=Math.ceil,he=Math.max,fe=JSON.stringify,de=JSON.parse,me="highlightFirstColumn",be="highlightLastColumn",ye="bandRows",Ce="bandColumns",we="autoGenerateColumns",ve=".table",Se="Column",ke="footerRowStyles",Me=["id",pe="name",ge="cellType","value","formatter","dataField",xe="footerFormula",Te="dataAreaFormula",Ae="footerValue"],Ie="table",Ee="tableInsertRows",Re="DoInsertRows",De="tableShowFooter",Ne="tableDeleteRows",Fe="tableInsertColumns",_e="tableDeleteColumns",Pe="collection",Le="tableColumn",Oe="dataSource",Be="rowsChange",je="range",He="columns",Ge="tableExpression",Ue="sheetExpression",We=new r.Common.ResourceManager(o.SR),Ve=We.getResource.bind(We),($e=ze=F.TableSelectionType||(F.TableSelectionType={})).TABLE_ROW_SELECT="tableRowSelect",$e.TABLE_COL_SELECT="tableColSelect",$e.TABLE_CORNER_SELECT="tableCornerSelect",$e.TABLE_SELECT="tableSelect",(Qe=qe=qe||{})[Qe.deleted=0]="deleted",Qe[Qe.dirty=1]="dirty",Y.Worksheet.$n(Ie,{priority:2e3,init:function(){var m=this;m.tables=m._modelManager.noa,m.unbind(ve),m.bind(Y.Events.BeforeDragDrop+ve,function(e,t){var r,n=m,o=m.tables,i=Ve().Exp_DragDropChangePartOfTable,a=t.fromRow,s=t.fromColumn,l=N(t),u=t.columnCount,c=n._eventHandler.gA,h=c.row,f=c.col,d=t.isDragInsert,p=t.isDragCopy,g=se;!d||-1!==a&&-1!==s||(0<=s?(m.isDragCopy&&(f<=s||s+u<=f)||!p&&(f<s||s+u<f))&&(r=!1,o.HZ(-1,f,-1,1)&&(r=!0,g=Ve().Exp_DragDropShiftTableCell),r||p||!o.HZ(-1,s,-1,u)||(g=i)):0<=a&&s<0&&(p&&(h<=a||a+l<=h)||!p&&(h<a||a+l<h))&&!p&&o.HZ(a,-1,l,-1)&&(g=i)),t.invalidMessage=g}),m.bind(Y.Events.RowChanged+ve,function(e,t){var r=m.tables,n=r.$m,o=t.propertyName;"isVisible"===o?(!1===t.newValue?n[t.row]=0:n[t.row]=le,r.hNb(t.row)):"height"===o&&(n[t.row]=le,r.hNb(t.row))}),m.bind(Y.Events.RowHeightChanged+ve,function(e,t){var r,n,o,i=m.tables,a=i.$m;for(r=0,n=t.rowList;r<n.length;r++)a[o=n[r]]=le,i.hNb(o)}),m.bind(Y.Events.ColumnChanged+ve,function(e,t){var r=m.tables,n=r.an;"isVisible"===t.propertyName?(!1===t.newValue?n[t.col]=0:n[t.col]=le,r.iNb(t.col)):"width"===t.propertyName&&(n[t.col]=le,r.iNb(t.col))}),m.bind(Y.Events.ColumnWidthChanged+ve,function(e,t){var r,n,o,i=m.tables,a=i.an;for(r=0,n=t.colList;r<n.length;r++)a[o=n[r]]=le,i.iNb(o)}),m.bind(Y.Events.RangeFiltered+ve,function(e,t){var r,n=m.tables,o=n.$m,i=t.sheet.xr.range;for(r=0;r<i.rowCount;r++)o[i.row+r]=le,n.hNb(i.row+r)}),m.bind(Y.Events.TableFiltered+ve,function(e,t){var r,n=m.tables,o=n.$m,i=t.table.range();for(r=0;r<i.rowCount;r++)o[i.row+r]=le,n.hNb(i.row+r)}),m.bind(Y.Events.TableFilterCleared+ve,function(e,t){m.tables.Nm()})},resetBinding:function(e){this.tables.IZ()},initBinding:function(e){var t,r,n,o,i=this.tables;for(i.IZ(),h(this),r=0,n=(t=i.all()).length;r<n;r++)(o=t[r])&&o.JZ();p(this)},dispose:function(e){!1!==e.clearCache&&(this.unbind(ve),this.tables&&(this.tables.no(),this.tables=null))},clearPendingChanges:function(){var e=this.tables;e&&e.Xec()},onGroupChanged:function(e){var t,r,n=this.tables;if(e.fromSetCollapsed)for(t=e.isRow?n.$m:n.an,r=e.start;r<=e.end;r++)t[r]=le,e.isRow?n.hNb(r):n.iNb(r)},onLayoutChanged:function(e){var t,r=e.changeType,n=e.row,o=e.rowCount,i=e.col,a=e.colCount,s=this.tables;"addRows"===r?(s.rI(n,o),s.Nm()):"addRows2"===r?s.KZ(n,o):"deleteRows"===r?(s.GR(n,o),s.Nm()):"addColumns"===r?(s.tI(i,a),s.Nm()):"deleteColumns"===r?(s.HR(i,a),s.Nm()):"addColumns2"===r||"deleteColumns2"===r?s.khc(i):"clear"===r?(t=e.sheetArea,e.ignoreTable||3!==t&&!M(t)||s.$b(n,i,o,a,e.type)):"setRowCount"!==r&&"setColumnCount"!==r||s.Nm()},toJson:function(e,t){var r,n;r=this.tables,t&&t.ignoreStyle||(r&&(e.tables=r.toJSON()),t&&t.includeBindingSource&&((n=e.data).dataTable=n.dataTable||{},function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g=e.tables.all();for(r=0,n=g.length;r<n;r++)if(i=(o=g[r]).LZ(),s=(a=o.dataRange()).row,l=a.col,u=s+N(a)-1,c=l+B(a)-1,i)for(h=s;h<=u;h++)for(f=l;f<=c;f++)(d=o.ge(h,f)).gt&&(p=d.Qb,b.Ska(p)&&(p=b.Daa(p)),e.qI(t,h,f,p))}(this,n.dataTable)))},fromJson:function(e,t,r){var n=this.tables,o=e.tableManager,i=t?o&&o.tables:e.tables,a=r&&r.ignoreStyle;L(i)&&!a&&n&&n.fromJSON(i,t)},fromJsonAfterFormula:function(e,t,r){this.tables.all().forEach(function(e){e.formulaFromJSON()})},lastNonNullRowAndCol:function(){var e,t,r,n,o,i,a=-1,s=-1,l=this.tables.all();if(l)for(e=0,t=l.length;e<t;e++)(r=l[e])&&(a<(o=(n=r.range()).row+N(n)-1)&&(a=o),s<(i=n.col+B(n)-1)&&(s=i));return{lastNonNullRow:a,lastNonNullCol:s}},paintCell:function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b;e.isPrinting||e.sheetArea!==Y.SheetArea.viewport||this.options.isProtected||(t=this.tables,r=e.ctx,o=(n=e.cell).row,i=n.col,(a=t.find(o,i))&&a.showResizeHandle()&&!a.hJb()&&(s=T(this,a),l=R(this,a),o===s&&i===l&&(u=n.x,c=n.y,h=n.width,f=n.height,d=this.zoom(),p=ce(4*d),g=ce(2*d),m=u+h,b=c+f,r&&0<h&&0<f&&(r.save(),r.rect(u,c,h,f),r.clip(),r.fillStyle="#485DB1",r.beginPath(),r.moveTo(m-p,b),r.lineTo(m,b),r.lineTo(m,b-g),r.lineTo(m-p,b-g),r.fill(),r.beginPath(),r.moveTo(m,b-g),r.lineTo(m-g,b-g),r.lineTo(m-g,b-p),r.lineTo(m,b-p),r.fill(),r.restore()))))},composeTableFooterList:function(e){var t=e.table,r=e.row,n=e.col,o=e.style;t.jNb(r,n,o)}}),Y.Worksheet.prototype.PIb=function(e,t,r,n,o,i){var a=i?le:e.nKb();c(this,e,t,r,n,o,a)},Y.Worksheet.prototype.QIb=function(e,t,r,n,o){J(this,e,t,r,n,o)},Y.Workbook.prototype.jga=function(e){var t,r,n,o=this.sheets;if(o)for(n=0;n<o.length;n++)if((r=o[n].tables)&&(t=r.findByName(e)))return t;return se},st.prototype.no=function(){var e=this;e.Nz=[],e.mNb=[],e.Ts=[],e.nNb=[],e.mhc=[],e.LAb={},e.Bec=[],e.kj=se,e.tc=se,e.xr&&(e.xr.no(),e.xr=se),e.Nm()},st.prototype.Nm=function(){this.oNb=[],this.pNb=[]},st.prototype.range=function(){return Y.kf(this.cj,this.dj,this.Xj,this.OZ)},st.prototype.dataRange=function(){var e=this.MZ?this.cj+1:this.cj,t=this.MZ?this.Xj-1:this.Xj;return this.NZ&&t--,Y.kf(e,this.dj,t,this.OZ)},st.prototype.headerIndex=function(){return this.MZ?this.cj:-1},st.prototype.footerIndex=function(){return this.NZ?this.cj+this.Xj-1:-1},st.prototype.showHeader=function(e){var t;return 0===arguments.length?this.MZ:(this.MZ!==e&&((t=this.kj)&&t.suspendPaint(),this.qVa(e),t&&t.resumePaint()),this)},st.prototype.qVa=function(e){var t,r=this,n=r.kj;n&&n._modelManager.pVa(r,"showHeader",r.MZ),(r.MZ=e)?(0<r.cj&&(r.cj=r.cj-1,r.Xj+=1),r.PZ()):(t=r.cj,r.cj=r.cj+1,--r.Xj,r.QZ(t),r.RZ()),n&&C&&n.recalcRange(r.cj+(e?0:-1),r.dj,1,r.OZ)},st.prototype.showFooter=function(e,t){var r;if(0===arguments.length)return this.NZ;if(this.NZ!==e){(r=this.kj)&&r.suspendPaint();try{this.rVa(e,!!t&&t)}finally{r&&r.resumePaint()}}return this},st.prototype.expandBoundRows=function(e){return 0===arguments.length?this.lhc:(this.lhc!==e&&(this.lhc=e),this)},st.prototype.rVa=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d=this,p=d.kj;if(p&&p._modelManager.pVa(d,"showFooter",d.NZ),r=d.Xj,e){if((!p||d.cj+r<p.getRowCount())&&(!t||d.rNb(!0,r)))for(d.NZ=e,d.Xj+=1,o=(n=d.Nz).length,i=d.footerIndex(),a=d.dj,s=0;s<o;s++)c=a+s,(u=(l=n[s])&&l.footerFormula())&&(h=x(p,u,i,c))&&(u=I(p,h,i,c),l.footerFormula(u));d.SZ()}else d.NZ=e,f=d.cj+r-1,--d.Xj,d.QZ(f),d.NAb(),d.Cec(0),t&&d.rNb(!1,r);p&&C&&p.recalcRange(d.cj+d.Xj+(e?-1:0),d.dj,1,d.OZ)},st.prototype.rNb=function(e,t){var r,n=this.kj,o=this.cj+t,i=this.dj,a=this.OZ,s=i+a-1,l=j(n,this),u=o<=l,c=U(n,new Y.Range(o,i,l-o+1,s-i+1)),h=(c&&c.row)===o;return!(h&&G(n,this,o,l,i,s,1)||(h&&u&&(r=e?o+1:o-1,n.moveTo(o,i,r,i,l-o+1,a,1023)),0))},st.prototype.sNb=function(e){var t,r,n,o=this.Nz,i=o.length,a=this.dj,s=[],l=this.name();for(t=0;t<i;t++)r=a+t,n=this.getColumnName(t),s.push(it(0,n)),e||(0===t?this.j$(r,Ve().Table_Total,!0):t===i-1&&(o[t].footerFormula()||(this.tNb(r)?this.i$(t,"=SUBTOTAL(109,"+l+"["+n+"])"):this.i$(t,"=SUBTOTAL(103,"+l+"["+n+"])"))));this.mNb=s},st.prototype.tNb=function(e){var t,r,n=this.kj,o=this.dataRange(),i=!0,a=o.rowCount,s=o.row;for(t=0;t<a;t++)if(r=n.getValue(s+t,e),!M(r)&&"number"!=typeof r){i=!1;break}return i},st.prototype.uNb=function(){return this.mNb&&0<this.mNb.length},st.prototype.vNb=function(e,t,r){var n=this.kj;this.uNb()&&(n&&n._modelManager.pVa(this,ke,this.wNb()),0<=t&&(r?this.mNb.splice(e,t,r):this.mNb.splice(e,t)))},st.prototype.wNb=function(){var e=this.mNb,t=[];return e.forEach(function(e){e&&t.push(e.clone())}),t},st.prototype.xNb=function(e,t,r){var n=L(r)?it(this.name(),r):se;this.uNb()&&this.vNb(e,t,n)},st.prototype.useFooterDropDownList=function(e){var t=this,r=t.kj;return 0===arguments.length?t.kNb:(r&&(r.suspendPaint(),t.kNb!==e&&(r._modelManager.pVa(t,"useFooterDropDownList",t.kNb),t.kNb=e,t.kNb&&!t.uNb()&&(t.sNb(),t.e$())),r.resumePaint()),t)},st.prototype.showResizeHandle=function(e){var t=this.kj;return 0===arguments.length?this.lNb:(t&&(t.suspendPaint(),this.lNb!==e&&(t._modelManager.pVa(this,"showResizeHandle",this.lNb),this.lNb=e),t.resumePaint()),this)},st.prototype.rowFilter=function(){return!this.xr&&F.MAb&&(this.xr=new F.MAb(this),this.xr.EZ(this.dataRange())),this.xr},st.prototype.bindColumns=function(e){var t,r,n,o,i,a,s,l,u,c,h=[];if(e)for(t=ue(this.OZ,e.length),r=0;r<t;r++)(n=this.Nz[r])||(n=new Ke(this.TZ()),this.Nz[r]=n),i=(o=e[r]).id(),a=o.name(),s=o.dataField(),l=o.value(),u=Q(this,a,r),n.id(i),n.name(u),n.dataField(s),n.value(l),n.cellType(o.cellType()),n.formatter(o.formatter()),c={name:u,value:l,dataField:s},s&&h.push(c),this.xNb(r,1,u);this.yNb=h,this.wq&&(this.wq.qia=h)},st.prototype.bindingPath=function(e){return 0===arguments.length?this.UZ:(this.UZ=e,this.JZ(),this)},st.prototype.bind=function(e,t,r){var n=r;return M(e)||this.bindColumns(e),M(r)&&(n=this.LZ()),t&&(this.UZ=t,n=_.LL(n,t)),_.qL&&n&&this.zNb(n),this},st.prototype.getColumnName=function(e){var t,r,n=this.Nz;return n&&0<=e&&e<n.length&&(t=n[e])?((r=t.name())!==se&&(r=s(r)),r):se},st.prototype.setColumnName=function(e,t){var r,n,o,i,a=this;return a.VZ(t)||(r=a.Nz)&&0<=e&&e<r.length&&(o=(n=(n=r[e])||(a.Nz[e]=new Ke(a.TZ()))).name(),i=a.kj,o!==t&&i&&(i._modelManager.sVa(n,"name",o),n.name(t)),a.MZ&&i&&i.setText(a.headerIndex(),a.dj+e,t),a.WZ(o,n.name(),e)),a},st.prototype.WZ=function(e,t,r){var n,o=this.Nz[r];this.xNb(r,1,o.name()),(n=this.ZX)&&n.onColumnNameChanged(e,t)},st.prototype.setColumnDataField=function(e,t){var r,n,o,i=this.Nz;return i&&0<=e&&e<i.length&&(r=(r=i[e])||(this.Nz[e]=new Ke(this.TZ())),n=this.kj,o=r.dataField(),n&&t!==o&&n._modelManager.sVa(r,"dataField",o),r.dataField(t)),this},st.prototype.getColumnDataField=function(e){var t,r,n=this.Nz;return n&&0<=e&&e<n.length&&(t=n[e])?((r=t.dataField())!==se&&(r=s(r)),r):se},st.prototype.getColumnFormula=function(e){var t,r,n,o,i=this.Nz,a=this.kj;return i&&a&&0<=e&&e<i.length&&(t=i[e])?(r=this.footerIndex(),n=this.dj+e,(o=t.footerFormula())&&x(a,o,r,n,!1)):se},st.prototype.setColumnFormula=function(e,t){return this.i$(e,t),this},st.prototype.setColumnDataFormula=function(e,t){var r,n,o,i,a,s,l,u,c;if(C){if((r=this.Nz)&&0<=e&&e<r.length&&(n=r[e])){for(o=this.kj,h(o),i=e+this.dj,a=this.cj,s=this.Xj,this.showHeader()&&(a++,s--),this.showFooter()&&s--,l=I(o,t,a,i,!0),u=n.dataAreaFormula(),o&&l!==u&&o._modelManager.sVa(n,"dataAreaFormula",u),n.ANb(t),n.dataAreaFormula(l),c=a;c<a+s;c++)A(o,c,i,t,l);p(o,!1)}return this}},st.prototype.getColumnValue=function(e){var t,r,n=this.Nz;return n&&0<=e&&e<n.length&&(t=n[e])?this.NZ&&t.footerFormula()&&(r=this.kj)?r.getValue(this.footerIndex(),this.dj+e):t.footerValue():se},st.prototype.setColumnValue=function(e,t){var r,n,o=this.Nz,i=this.kj;return o&&0<=e&&e<o.length&&((r=o[e])&&(n=r.footerValue(),i&&t!==n&&i._modelManager.sVa(r,"footerValue",n),r.footerValue(t)),this.NZ&&i&&w(i,this.footerIndex(),this.dj+e,t)),this},st.prototype.filterButtonVisible=function(e,t){var r,n,o,i,a=this.kj,s=this.rowFilter();if(!(e<0||e>=this.OZ))switch(r=arguments,r.length){case 0:return s&&s.filterButtonVisible();case 1:if("number"==(o=typeof(n=r[0])))return s&&s.filterButtonVisible(n);if("boolean"==o&&s){for(v(a),i=0;i<this.OZ;i++)s.filterButtonVisible(i,n);S(a)}return this;case 2:return s&&s.filterButtonVisible(e,t),this}},st.prototype.allowAutoExpand=function(e){var t=this.kj;return 0===arguments.length?this.qNb:(this.qNb!==e&&(t._modelManager.pVa(this,"allowAutoExpand",this.qNb),this.qNb=e),this)},st.prototype.Aq=function(){return!!this.ZX},st.prototype.Yv=function(e){var t=this.tc;this.BNb(e),this.kj&&this.kj._modelManager&&this.kj._modelManager.CNb(this,t)},st.prototype.BNb=function(e){var t;this.tc=e,this.kj=e&&e.kj,t=this.xr,e&&t&&t.kj!==e.kj&&t.table(this)},st.prototype._bind=function(e){var r,n,t,o,i,a,s,l,u,c=this,h=c.autoGenerateColumns(),f=c.xr&&c.xr.qZ;if(c.RZ(),(r=c.kj)&&(n=c.dataRange(),h?r.cg(n.row,n.col,N(n),B(n),3,17,!1,!0):O(c.Nz,function(e,t){t.dataField()&&r.cg(n.row,n.col+e,N(n),1,3,17,!1,!0)})),h&&(t=c.range(),c.$b(t.row,t.col,N(t),B(t))),e.qia=c.yNb,c.wq=e)if(r&&r._modelManager.pVa(c,je,{row:c.cj,col:c.dj,rowCount:c.Xj,colCount:c.OZ}),o=e.getRowCount(),i=e.getColumnCount(),c.MZ&&o++,c.NZ&&o++,c.Xj=o,h)for(c.OZ=i,c.Nz=[],a=e.rL(),s=0;s<c.OZ;s++)l=new Ke(s+1),c.Nz[s]=l,a&&(l.name(a[s]),l.dataField(a[s]));else u=[],c.Nz.forEach(function(e){var t=e.dataField();t&&u.push(t)}),e.Nka(u);c.xr&&(c.xr.EZ(c.dataRange()),c.xr.qZ=f)},st.prototype.XZ=function(e){var t,r,n,o,i,a=this.wq;if(a&&(t=a.rL()))for(n=(r=this.Nz[e-this.startColumn()])&&r.dataField(),o=0,i=t.length;o<i;o++)if(t[o]===n)return o;return-1},st.prototype.ge=function(e,t){var r,n=!1,o=le,i=this.wq,a=e-this.dataRange().row;return i&&a<i.getRowCount()&&0<=(r=this.XZ(t))&&(n=!0,o=i.getValue(a,r).value),{gt:n,Qb:o}},st.prototype.yq=function(e,t,r,n){var o,i,a,s,l,u,c=this.wq,h=V(this,e),f=this.xr,d=!1;return c&&0<=(o=this.XZ(t))&&(n&&f&&f.isRowFilteredOut(e)||(i=(a=c.getValue(h,o)).value,(l=(s=this.kj)&&s._modelManager)&&a.hasBinding&&i!==r&&(u=q(!0),this.DNb(e,h,u),l.ENb(this,e,se,u,qe.dirty),l.Cp(e,t,{Ep:i})),c.setValue(h,o,r,l&&l.zTa)),d=!0),d},st.prototype.Gq=function(e,t,r){var n=new Y.Style;return this.Yo(e,t,n,r),n},st.prototype.D3=function(e){var t,r=this.tc.$m,n=r[e];return n!==le?n:(t=this.kj,n=r[e]=t.getRowHeight(e))},st.prototype.C3=function(e){return this.kj.getColumnWidth(e)},st.prototype.Yo=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q=this,Z=q.style();if(Z){if(o=q.kj,i=q.MZ,a=q.NZ,s=q.Nz,l=q.highlightLastColumn(),u=q.highlightFirstColumn(),c=q.headerIndex(),h=q.footerIndex(),f=i?e===q.cj+1:e===q.cj,d=a?e===q.cj+q.Xj-2:e===q.cj+q.Xj-1,p=t===q.dj,g=t===q.dj+q.OZ-1,m=i?e===c:e===q.cj,b=a?e===h:e===q.cj+q.Xj-1,y=Z.highlightLastColumnStyle(),C=Z.highlightFirstColumnStyle(),w=new Y.Style,c===e)v=Z.lastHeaderCellStyle(),g&&l&&v&&v.Yo(w,!0,!0,!0,!0),S=Z.firstHeaderCellStyle(),p&&u&&S&&S.Yo(w,!0,!0,!0,!0),(x=Z.headerRowStyle())&&x.Yo(w,!0,p,!0,g),g&&l&&y&&y.Yo(w,!0,!0,!1,!0),p&&u&&C&&C.Yo(w,!0,!0,!1,!0);else if(h===e)T=Z.lastFooterCellStyle(),g&&l&&T&&T.Yo(w,!0,!0,!0,!0),A=Z.firstFooterCellStyle(),p&&u&&A&&A.Yo(w,!0,!0,!0,!0),(k=Z.footerRowStyle())&&k.Yo(w,!0,p,!0,g),g&&l&&y&&y.Yo(w,!1,!0,!0,!0),p&&u&&C&&C.Yo(w,!1,!0,!0,!0);else{if(g&&l&&y&&y.Yo(w,m,!0,b,!0),p&&u&&C&&C.Yo(w,m,!0,b,!0),M=i?e-q.cj-1:e-q.cj,I=t-q.dj,P=_=F=N=D=R=E=void 0,L=!n||"cellType"!==n&&"formatter"!==n,q.bandRows()&&L&&0<(R=(E=Z.firstRowStripSize())+Z.secondRowStripSize())){if(void 0===(D=q.oNb[e])){if(Y.mn.nn&&Y.mn.sn){for(O=Y.mn.sn,B=q.dataRange().row;-1===O[B];)B++;if(e<B)return;M=O[e]-O[B]}else if(o){for(j=0,B=q.dataRange().row;B<e;B++)0<q.D3(B)&&j++;M=j}D=q.oNb[e]=M%R}N=Z.firstRowStripStyle(),F=Z.secondRowStripStyle(),D<E&&N?(_=0===D,P=d||D===E-1,N.Yo(w,_,p,P,g)):E<=D&&F&&(_=D===E,P=d||D===R-1,F.Yo(w,_,p,P,g))}if(q.bandColumns()&&L&&0<(R=(E=Z.firstColumnStripSize())+Z.secondColumnStripSize())){if(void 0===(D=q.pNb[t])){if(H=0,o)for(G=q.dj;G<t;G++)0<q.C3(G)&&H++;D=q.pNb[t]=H%R}N=Z.firstColumnStripStyle(),F=Z.secondColumnStripStyle(),D<E&&N?(_=0===D,P=g||D===E-1,N.Yo(w,f,_,d,P)):E<=D&&F&&(_=D===E,P=g||D===R-1,F.Yo(w,f,_,d,P))}s&&0<s.length&&(U=s[I])&&(W=U.cellType(),V=U.formatter(),W&&(w.cellType=W),V&&(w.formatter=V))}(z=Z.wholeTableStyle())&&z.Yo(w,m,p,b,g),q.Oka(r,w)}},st.prototype.jNb=function(e,t,r){var n,o,i,a=this.NZ,s=this.kNb;this.footerIndex()===e&&a&&this.uNb()&&(n=this.mNb[t-this.dj])&&s&&(o=r.cellButtons,i=r.dropDowns,M(o)&&(o=[]),r.cellButtons=o.concat(n.cellButtons),M(i)&&(i=[]),r.dropDowns=i.concat(n.dropDowns))},st.prototype.Oka=function(e,t){var r,n,o,i,a=e;M(a.backColor)&&(a.backColor=t.backColor),ae(a.foreColor)&&(a.foreColor=t.foreColor),M(a.themeFont)&&M(a.font)?(a.themeFont=t.themeFont,a.font=t.font):!M(a.themeFont)&&M(a.font)&&(a.font=t.font),M(a.borderLeft)&&(r=t.borderLeft,a.borderLeft=r&&r.Uo()||r,a.borderLeft&&(a.borderLeft.level=20)),M(a.borderTop)&&(n=t.borderTop,a.borderTop=n&&n.Uo()||n,a.borderTop&&(a.borderTop.level=20)),M(a.borderRight)&&(o=t.borderRight,a.borderRight=o&&o.Uo()||o,a.borderRight&&(a.borderRight.level=20)),M(a.borderBottom)&&(i=t.borderBottom,a.borderBottom=i&&i.Uo()||i,a.borderBottom&&(a.borderBottom.level=20)),M(a.textDecoration)&&(a.textDecoration=t.textDecoration),M(a.cellType)&&(a.cellType=t.cellType),M(a.formatter)&&(a.formatter=t.formatter)},st.prototype.YZ=function(e,t){var r,n,o,i,a,s=this;if((e!==s.cj||t!==s.dj)&&(r=s.kj)){if((e<0||r.getRowCount()<e+s.Xj||t<0||r.getColumnCount()<t+s.OZ)&&D(Ve().Exp_TableMoveOutOfRange),i=o=void 0,n=s.tc)for(i=0,a=(o=n.l$).length;i<a;i++)if(o[i]===s){o.splice(i,1),s.ZZ();break}r.moveTo(s.cj,s.dj,e,t,s.Xj,s.OZ,3),o&&i<=a&&(s.$Z(e,t),o.splice(i,0,s),s._Z()),this.Cec(1)}},st.prototype.$Z=function(e,t){var r=this,n=r.kj;n&&n._modelManager.pVa(r,je,{row:r.cj,col:r.dj,rowCount:r.Xj,colCount:r.OZ}),r.cj=e,r.dj=t,r.a$(),r.Nm()},st.prototype.ZZ=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b=this,y=b.kj;if(y&&C){for(n=b.Nz,o=b.footerIndex(),i=b.range(),s=(a=b.dataRange()).row,l=N(a),M(e)&&(e=0,t=n.length);e<t;e++)if(u=n[e],c=i.col+e,u){for(u.footerFormula()&&0<=o&&(A(y,o,c,se),w(y,o,c,se)),h=u.ANb(),f=re(h),p=d=void 0,g=0;g<l;g++)p=s+g,d=y.getFormula(p,c),M(d)||(M(b.FNb)&&(b.FNb=[]),b.FNb.push({row:p,col:c,formula:d})),M(d)||!M(f)&&x(y,I(y,f,b.cj,c),p,c)===d||(M(b.GNb)&&(b.GNb=[]),m=ne(b.GNb,c),M(m)?((m={}).col=c,m.rowIndexes=[],m.rowIndexes.push(p),b.GNb.push(m)):m.rowIndexes.push(p));if(u.ANb(le),u.dataAreaFormula())for(g=0;g<l;g++)A(y,p=s+g,c,se),w(y,p,c,se)}!0===r&&(b.FNb=[])}},st.prototype.HNb=function(e,t,r){var n,o,i,a,s,l,u=this.kj,c=this.FNb;if(c){for(i=0;i<c.length;i++)n=!0,(o=c[i])&&(a=o.row,s=o.col,l=o.formula,e<=a&&(!0===r&&(a+=t),!1===r&&(a<e+t?n=!1:a-=t)),n&&A(u,a,s,l));this.FNb=[]}this.Gj(e,t,!0,r)},st.prototype.INb=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x=this.kj,T=this.FNb;if(T){for(i=0;i<T.length;i++)n=!0,(o=T[i])&&(a=o.row,s=o.col,l=o.formula,e<=s&&(!0===r&&(s+=t),!1===r&&(s<e+t?n=!1:s-=t)),n&&A(x,a,s,l));for(u=this.GNb||[],c=void 0,i=0;i<u.length;i++)(c=u[i])&&e<=(h=c.col)&&(!0===r&&(c.col+=t),!1===r&&e+t<=h&&(c.col-=t));for(this.Gj(e,t,!1,r),d=(f=this.Nz).length,g=(p=this.dataRange()).row,m=p.col,b=p.rowCount,v=w=C=y=void 0,i=0;i<d;i++)if(v=m+i,(C=f[i])&&C.dataAreaFormula()){for(y=g,S=0;S<u.length;S++)if((c=u[S])&&c.col===v){for(;-1<c.rowIndexes.indexOf(y)&&y<g+b;)y++;break}y<g+b&&(w=x.getFormula(y,v))&&C.dataAreaFormula(I(x,w,g,v))}this.FNb=[],this.GNb=[]}},st.prototype.Gj=function(e,t,r,n,o){var i,a,s,l,u,c,h=this.kj,f=this.Nz,d=this.footerIndex(),p=this.dataRange(),g=p.row,m=p.col,b=p.rowCount,y=p.colCount,C=h.Bj(),w=h.Wu;if(w&&C&&(i=w.ih())&&(o||(i.Dj(C,g,m,b,y),i.Gj(C._source,e,t,r,n,!0)),this.NZ))for(o||(i.Dj(C,d,m,1,y),i.Gj(C._source,e,t,r,n,!1)),c=0;c<y;c++)(a=f[c])&&(u=m+c,(s=a.footerFormula())&&(l=h.getFormula(d,u))&&(h&&h._modelManager.sVa(a,"footerFormula",s),a.footerFormula(I(h,l,d,u))))},st.prototype._Z=function(){var l,u,c,h=this.kj;h&&C&&(l=this.footerIndex(),u=this.range(),c=this.dataRange(),O(this.Nz,function(e,t){var r,n,o,i=u.col+e,a=t.footerFormula(),s=t.dataAreaFormula();if(a&&0<=l&&A(h,l,i,se,a),s)for(r=0,n=N(c);r<n;r++)o=c.row+r,A(h,o,i,se,s)}))},st.prototype.b$=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E=this,R=E.dataRange();if(!e.equals(E.range())){if(t=e.row,r=e.col,n=N(e),o=B(e),i=E.MZ,a=E.NZ,s=E.kNb,l=0,i&&(l+=1),a&&(l+=1),(u=E.kj)&&((n<l||o<1||t+n>u.getRowCount()||r+o>u.getColumnCount())&&D(Ve().Exp_TableResizeOutOfRange),t===E.cj&&e.intersect(E.cj,E.dj,E.Xj,E.OZ)||D(Ve().Exp_TableResizeInvalidRange),u._modelManager.pVa(E,je,{row:E.cj,col:E.dj,rowCount:E.Xj,colCount:E.OZ}),u._modelManager.pVa(E,He,E.Nz.slice())),c=E.Nz,f=(h=r)+o-1,d=E.dj,p=E.dj+E.OZ-1,g=E.OZ,E.dj=r,E.OZ=o,h<d){for(m=0,b=h;b<d;b++)y=new Ke(E.TZ()),c.splice(m,0,y),m++;i&&E.PZ(0,d-h),a&&E.SZ(0,d-h)}else h<=p&&(E.ZZ(d,h),c.splice(0,h-d));if(p<f){for(b=1+p;b<=f;b++)y=new Ke(E.TZ()),c.push(y);i&&E.PZ(g,f-p),a&&E.SZ(g,f-p),s&&E.JNb(g)}else d<=f&&(E.ZZ(f,p),c.splice(c.length-(p-f),p-f));n!==E.Xj&&(C=E.wq,v=(w=E.dataRange()).row,S=N(w),C?n>E.Xj?(x=v+S-1,T=n-E.Xj,u&&(A=x+T+1,(k=U(u,new Y.Range(A,h,u.getRowCount()-A,f)))&&k.row<A||E.eMb(x,T,!0,!1))):u&&(M=E.Xj-n,E.STa(v+S-M,M)):(I=void 0,a&&(E.SZ(),I=E.footerIndex()),E.Xj=n,E.LNb(),a&&(E.e$(),E.QZ(I)))),E.a$(),E.f$(R,E.dataRange()),E.NAb(),E.Cec(0)}},st.prototype.f$=function(e,t){var r,n,o,i,a,s,l,u,c,h,f=this.ZX;f&&(r=e.col,n=N(e),o=B(e),i=t.col,a=N(t),s=B(t),l=e.row+n,u=r+o,h=i+s,(c=t.row+a)<l&&f.onRowsRemoved(a,l-c),l<c&&f.onRowsAdded(n,c-l),r<i&&f.onColumnsRemoved(0,i-r),h<u&&f.onColumnsRemoved(s,u-h),i<r&&f.onColumnsAdded(0,r-i),u<h&&f.onColumnsAdded(r+o-i,h-u))},st.prototype.a$=function(){var e=this.xr;e&&(e.EZ(this.dataRange()),e.reFilter())},st.prototype.RZ=function(){var e=this.xr;e&&(e.unfilter(),e.reset())},st.prototype.VZ=function(e,t){var r;for(e!==se&&(e=s(e)),r=0;r<this.OZ;r++)if(r!==t&&e===this.getColumnName(r))return!0;return!1},st.prototype.g$=function(e){var t,r,n,o=this.Nz;return this.MZ&&o&&0<=(t=e-this.dj)&&t<o.length&&(r=o[t])?(n=r.name(),M(n)||(n=s(n)),n):se},st.prototype.h$=function(e,t){var r,n,o,i,a,s=this.Nz;this.MZ&&s&&(r=s.length,0<=(n=e-this.dj)&&n<r&&(o=s[n])&&(i=o.name(),(a=this.kj)&&t!==i&&a._modelManager.sVa(o,"name",i),o.name(t),this.WZ(i,o.name(),n)))},st.prototype.i$=function(e,t,r){var n,o,i=this.Nz,a=this.footerIndex(),s=this.dj+e,l=this.kj;C&&0<=e&&e<i.length&&(n=i[e],t&&!r&&l&&(r=I(l,t,a,s),this.NZ&&A(l,a,s,t,r)),n&&(o=n.footerFormula(),l&&r!==o&&l._modelManager.sVa(n,"footerFormula",o),n.footerFormula(r)))},st.prototype.j$=function(e,t,r){var n,o,i,a,s=this.Nz;!r&&!this.NZ||!s||0<=(n=e-this.dj)&&n<s.length&&(o=s[n])&&(t===(i=o.footerValue())||(a=this.kj)&&(a._modelManager.sVa(o,"footerValue",i),a._modelManager.Cp(this.cj+this.Xj-1,e,{Ep:o.footerValue()})),o.footerValue(t))},st.prototype.TZ=function(){var e,t,r=this.Nz,n=r&&r.length,o=[];for(t=0;t<n;t++)(e=r[t])&&e.k$()&&o.push(e.id());if(o.sort(function(e,t){return e-t}),0<(n=o.length)){for(t=0;t<n;t++)if(o[t]!==t+1)return t+1;return n+1}return 1},st.prototype.dga=function(e,t){var r,n,o,i;if(e&&!this.VZ(e,t))return e;if(n=Se,o=0,e)n=e,o=1;else if(0<t&&(e=this.Nz[t-1].name(),i=/[0-9]+$/.exec(e))){if(r=(n=e.substr(0,i.index))+((o=parseInt(e.substr(i.index),10))+1),!this.VZ(r))return r;n=e,o=1}for(;;)if(r=n+ ++o,!this.VZ(r))return r},st.prototype.PZ=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d=this,p=d.Nz,g=d.kj;if(d.MZ&&p&&g)for(n=p.length,o=d.headerIndex(),i=d.dj,M(e)&&(e=0),M(t)&&(t=n),s=ue(n,e+t),u=e;u<s;u++)(a=p[u])&&(c=d.tc.l$,-1<(h=m(d,c))&&c.splice(h,1),l=ie(g.getValue(o,i+u)),-1<h&&c.splice(h,0,d),A(g,o,i+u,se),l&&!r?(C&&g.zq(o,i+u),(f=d.dga(l,u))===l?(g._modelManager.sVa(a,"name",a.name()),a.name(l)):g.setText(o,i+u,f)):(d.KNb=r,g.setText(o,i+u,a.name()),delete d.KNb))},st.prototype.JNb=function(e){var t,r,n=this.Nz;for(t=e;t<n.length;t++)r=it(this.name(),n[t].name()),this.mNb.push(r)},st.prototype.SZ=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d=this,p=d.Nz,g=d.kj;if(d.NZ&&p&&g)for(d.useFooterDropDownList()&&!d.uNb()&&d.sNb(),n=p.length,o=d.footerIndex(),i=d.dj,M(e)&&(e=0),M(t)&&(t=n),M(r)&&(r=d.nhc),s=ue(n,e+t),c=e;c<s;c++)(a=p[c])&&(u=g.getValue(o,i+c),M(u)||r?(d.KNb=r,w(g,o,i+c,a.footerValue()),delete d.KNb):(u!==(h=a.footerValue())&&g._modelManager.sVa(a,"footerValue",h),a.footerValue(u)),(l=g.Ima&&g.Ima(o,i+c))&&!r?(l!==(f=a.dataAreaFormula())&&g._modelManager.sVa(a,"dataAreaFormula",f),a.footerFormula(l)):d.S3||(d.KNb=r,A(g,o,i+c,se,a.footerFormula()),delete d.KNb))},st.prototype.m$=function(e,t){var r,n,o,i,a,s,l=this.Nz;if(this.MZ&&l)for(r=l.length,M(e)&&(e=0),M(t)&&(t=r),o=ue(r,e+t),i=e;i<o;i++)(n=l[i])&&(a=n.name(),(s=this.kj)&&a!==se&&s._modelManager.sVa(n,"name",a),n.name(se),this.WZ(a,n.name(),i))},st.prototype.n$=function(e){var t,r,n,o,i,a,s,l,u=this.dataRange();if(u.containsRange(e)){for(t=e.row,r=e.col,n=N(e),o=B(e),i=[],a=0;a<n;a++)for(s=0;s<o;s++)this.yq(t+a,r+s,se,!0),i.push({columnName:this.getColumnName(r+s-u.col),row:t+a-u.row,data:""});(l=this.ZX)&&l.onDataChanged(i)}},st.prototype.o$=function(e,t){var r,n,o,i,a,s,l=this.Nz;if(this.NZ&&l)for(M(e)&&(e=0),M(t)&&(t=l.length),n=ue(l.length,e+t),o=e;o<n;o++)(r=l[o])&&(i=this.kj,a=r.footerFormula(),i&&se!==a&&i._modelManager.sVa(r,"footerFormula",a),r.footerFormula(se),s=r.footerValue(),i&&se!==s&&i._modelManager.sVa(r,"footerValue",s),r.footerValue(se))},st.prototype.e$=function(){var e,t,r,n,o,i,a,s=this.Nz;if(this.NZ&&s&&(e=this.kj))for(t=s.length,n=this.dj,i=this.footerIndex(),a=0;a<t;a++)(r=s[a])&&(w(e,i,o=n+a,r.footerValue()),A(e,i,o,se,r.footerFormula()))},st.prototype.QZ=function(e){var t,r,n,o,i=this.kj;if(i&&!(e<0||i.getRowCount()<=e))for(t=this.dj,r=this.OZ,o=0;o<r;o++)A(i,e,n=t+o,se),w(i,e,n,se)},st.prototype.rI=function(e,t,r,n,o){var i,a,s,l=this,u=!1,c=r?1:0;return e>=l.cj+l.Xj+c||((i=l.kj)&&i._modelManager.pVa(l,je,{row:l.cj,col:l.dj,rowCount:l.Xj,colCount:l.OZ}),l.ohc(e,t,!1),a=l.cj,s=l.cj+l.Xj-1+c,e<=a&&!o?l.cj+=t:e<=s&&(n||(u=l.c$(e,t)),l.Xj+=t)),u},st.prototype.KZ=function(e,t,r){var n,o,i,a=this,s=a.cj+a.Xj-1;!r&&e>=a.cj&&e<=s&&a.LNb(e,t),r||(a.Gj(e,t,!0,!0,!0),a.MNb()),n=a.ZX,o=a.dataRange().row,i=a.endRow(),o<=e&&e<=i&&n&&n.onRowsAdded(e-o,t),a.xr&&a.xr.rI(e,t)},st.prototype.c$=function(e,t){var r,n,o,i=this.wq;return!!i&&(o=void 0,(n=(r=this.kj)&&r._modelManager.zTa)&&(o=(o=n.uVa)||[]),i.uL(V(this,e),t,o),!0)},st.prototype.LNb=function(i,a){if(C){var s=this,l=s.kj,e=s.dataRange();M(i)&&(i=e.row),M(a)&&(a=e.rowCount),h(l),O(s.Nz,function(e,t){var r,n,o=t.dataAreaFormula();if(o)for(r=e+s.dj,n=i;n<i+a;n++)A(l,n,r,se,o)}),p(l,!1)}},st.prototype.MNb=function(){if(C){var s,l,u=this,e=u.kj,c=e.Bj(),t=u.dataRange();M(s)&&(s=t.row),M(l)&&(l=t.rowCount),h(e),O(u.Nz,function(e,t){var r,n,o,i,a=t.NNb();if(a&&a.isArrayFormula)for(r=a.isDynamicArray,n=e+u.dj,o=s;o<s+l;o++)M(c.Qf(o,n))&&(i={row:o,col:n,rowCount:1,colCount:1,isDynamicArray:r},c.Xf(o,n,i))}),p(e,!1)}},st.prototype.tI=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g=this,m=r?1:0;if(!(e>=g.dj+g.OZ+m)){if(i=g.dj,(a=g.kj)&&(a._modelManager.pVa(g,je,{row:g.cj,col:g.dj,rowCount:g.Xj,colCount:g.OZ}),a._modelManager.pVa(g,He,g.Nz.slice())),e<=g.dj&&!o)g.dj+=t;else if(e<g.dj+g.OZ+m&&(g.OZ+=t,s=g.Nz)){for(l=e-g.dj,u=0;u<t;u++)c=g.TZ(),h=l+u,(f=new Ke(c)).name(g.dga(se,h)),s.splice(h,0,f),d=g.getColumnName(h),g.xNb(h,0,d);n&&g.PZ(l,le,!0)}g.xr&&g.xr.tI(e,t),i<=e&&(p=g.ZX)&&p.onColumnsAdded(e-i,t)}},st.prototype.khc=function(){var e,r,n,o,i=this.kj.Bj();i&&this.NZ&&(e=this.Nz,r=this.footerIndex(),n=this.dj,e.forEach(function(e,t){o=i.Kf(r,n+t),M(o)||e.footerFormula(o)}))},st.prototype.GR=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g=this,m=!1;return e>=g.cj+g.Xj||(i=(o=g.dataRange()).row,a=N(o),s=g.cj,l=g.cj+g.Xj-1,u=g.kj,c=g.wq,u&&((f=u._modelManager).pVa(g,je,{row:g.cj,col:g.dj,rowCount:g.Xj,colCount:g.OZ}),(h=f.zTa)&&(d=(d=h.uVa)||[])),g.ohc(e,t,!0),e<s?e+t<=s&&(g.cj-=t):e===s?g.MZ||(g.Xj-=ue(l-e+1,t),!r&&c&&(f&&f.ENb(g,e,t,n,qe.deleted),c.wL(V(g,e),ue(l-e+1,t),d),m=!0)):e<=l&&(g.Xj-=ue(l-e+1,t),!r&&c&&(f&&f.ENb(g,e,t,n,qe.deleted),c.wL(V(g,e),ue(l-e+1,t),d),m=!0),e===l&&g.NZ&&(u&&u._modelManager.pVa(g,"showFooter",g.NZ),g.NZ=!1)),g.xr&&g.xr.GR(e,t),i<=e&&e<i+a&&(p=g.ZX)&&p.onRowsRemoved(e-i,t)),m},st.prototype.HR=function(e,t){var r,n,o,i,a,s=this,l=s.Nz;e>=s.dj+s.OZ||((r=s.kj)&&(r._modelManager.pVa(s,je,{row:s.cj,col:s.dj,rowCount:s.Xj,colCount:s.OZ}),r._modelManager.pVa(s,He,s.Nz.slice())),n=s.dj,o=s.dj,i=s.dj+s.OZ-1,e<o?e+t<=o?s.dj-=t:(s.dj=e,s.OZ-=e+t-o,l&&(l.splice(0,e+t-o),s.xNb(0,e+t-o))):(s.OZ-=ue(i-e+1,t),l&&(l.splice(e-o,ue(i-e+1,t)),s.xNb(e-o,ue(i-e+1,t)))),s.xr&&s.xr.HR(e,t),n<=e&&(a=s.ZX)&&a.onColumnsRemoved(e-n,t))},st.prototype.$b=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m=this,b=r,y=n,C=m.kj;C&&(b=C.getRowCount(),y=C.getColumnCount()),o=e<0?0:e,i=t<0?0:t,a=e<0?b:r,s=t<0?y:n,l=Y.kf(o,i,a,s),u=m.headerIndex(),m.MZ&&o<=u&&u<o+a&&(c=Y.kf(u,m.dj,1,m.OZ),(h=l.getIntersect(c,b,y))&&m.m$(h.col-m.dj,B(h))),f=m.dataRange(),(d=l.getIntersect(f,b,y))&&m.n$(d),p=m.footerIndex(),m.NZ&&o<=p&&p<o+a&&(g=Y.kf(p,m.dj,1,m.OZ),(h=l.getIntersect(g,b,y))&&m.o$(h.col-m.dj,B(h))),m.xr&&m.xr.$b(e,t,r,n)},st.prototype.toJSON=function(){var e,t,r,n,o,i,a,s=this,l=s.style(),u=s.xr,c="columns",h={name:[s.name(),se],row:[s.cj,-1],col:[s.dj,-1],rowCount:[s.Xj,-1],colCount:[s.OZ,-1],showHeader:[s.MZ,!0],showFooter:[s.NZ,!1],useFooterDropDownList:[s.kNb,!1],showResizeHandle:[s.lNb,!1],highlightFirstColumn:[s.highlightFirstColumn(),!1],highlightLastColumn:[s.highlightLastColumn(),!1],bandRows:[s.bandRows(),!0],expandBoundRows:[s.expandBoundRows(),!1],bandColumns:[s.bandColumns(),!1],style:[l?l.toJSON():se,se],autoGenerateColumns:[s.autoGenerateColumns(),!0],bindingPath:[s.bindingPath(),le],rowFilter:[u?u.toJSON():se,se],reservedElement:[s.ONb,se],allowAutoExpand:[s.qNb,!0],columns:[[]]};for(e=0;e<s.Nz.length;e++)r=(t=s.Nz[e].toJSON())[xe],n=t[Te],r&&(t[xe]=x(s.kj,r,s.footerIndex(),e+s.dj)),n&&(t[Te]=x(s.kj,n,s.dataRange().row,e+s.dj)),h[c][0][e]=t;for(i in h[c][1]=se,o={},h)(a=h[i])[0]!==a[1]&&(o[i]=a[0]);return f(o)?le:o},st.prototype.fromJSON=function(r,e){var n,t,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N;if(r){if(n=this,O([pe,me,be,ye,Ce,we],function(e,t){L(r[t])&&n[t](r[t],!1)}),t=r.row,L(t)&&(n.cj=t),o=r.col,L(o)&&(n.dj=o),i=r.rowCount,L(i)&&(n.Xj=i),a=r.colCount,L(a)&&(n.OZ=a),s=r.showHeader,L(s)&&(n.MZ=s),l=r.showFooter,L(l)&&(n.NZ=l),u=r.expandBoundRows,L(u)&&(n.lhc=u),c=r.useFooterDropDownList,L(c)&&(n.kNb=c),h=r.showResizeHandle,L(h)&&(n.lNb=h),(f=r.style)&&((d=new P.TableTheme).fromJSON(f,e),n.style(d)),p=r.dataSource,g=r.dataBinding,m=r.bindingPath,e?(p&&_.qL&&(n.wq=new _.qL,n.wq.bind(p)),g&&_.qL&&(n.wq=new _.qL,n.wq.fromJSON(g))):m&&(n.UZ=m,y=(b=n.kj)&&b.getDataSource&&b.getDataSource(),_.CellBindingSource&&y instanceof _.CellBindingSource&&(C=_.LL(y.getSource(),m))&&(n.wq=new _.qL,n.wq.bind(C))),w=r.columns){for(S=(v=w).length,x=n.Nz=[],A=T=void 0,k=0;k<S;k++)A=v[k],(T=new Ke(n.TZ())).fromJSON(A),M=T.name(),I=n.dga(M,k),x.push(T),I!==M&&n.setColumnName(k,I);n.Qdc()}n.kNb&&n.sNb(!0),(E=r.rowFilter)&&(R=F.MAb&&new F.MAb)&&(R.table(n),R.fromJSON(E,e),n.xr=R,n.xr.reFilter()),(D=r.reservedElement)&&(n.ONb=D),N=r.allowAutoExpand,L(N)&&(n.qNb=N)}},st.prototype.formulaFromJSON=function(){var e,t,r,n,o,i,a=this.kj,s=a.Bj(),l=this.Nz,u=this.footerIndex(),c=this.dataRange().row,h=this.dj;for(r=0;r<l.length;r++)t=r+h,(n=(e=l[r]).footerFormula())&&"string"==typeof n&&e.footerFormula(I(a,n,u,t)),(o=e.dataAreaFormula())&&s&&(i=s.Qf(c,t),M(i)||e.NNb({isArrayFormula:!0,isDynamicArray:i.isDynamicArray})),o&&"string"==typeof o&&e.dataAreaFormula(I(a,o,c,t))},st.prototype.Qdc=function(){var e,t,r=this.Nz,n=r.length;for(t=0;t<n;t++)(e=r[t]).id()<1&&e.id(this.TZ())},st.prototype.startRow=function(){return this.cj},st.prototype.startColumn=function(){return this.dj},st.prototype.endRow=function(){return this.cj+this.Xj-1},st.prototype.endColumn=function(){return this.dj+this.OZ-1},st.prototype.hasHeadersRow=function(){return this.MZ},st.prototype.hasTotalsRow=function(){return this.NZ},st.prototype.tableName=function(){return this.name()},st.prototype.getColumnIndexInTable=function(n){n=n.toLowerCase().replace(/\u00A0/g," ");var o=-1,i=r.Common.u.Gb(n,"\r\n","\n");return M(n)||O(this.Nz,function(e,t){var r=(""+t.name()).toLowerCase().replace(/\u00A0/g," ");if(r===n||r===i)return o=e,!1}),o},st.prototype.source=function(){var e=this.kj;return e&&e.yj&&e.yj()},st.prototype.JZ=function(){var e,t,r,n=this.kj;!n||(e=this.bindingPath())&&(t=n.getDataSource&&n.getDataSource(),_.CellBindingSource&&t instanceof _.CellBindingSource&&(r=_.LL(t.getSource(),e),this.zNb(r)))},st.prototype.zNb=function(e){var t,r,n,o,i,a,s,l=this,u=l.kj;if(e){r=(t=l.dataRange()).row,n=N(t),(o=new _.qL).bind(e,u._modelManager.zTa),i=o.getRowCount();try{v(u),n<i?l.lhc?u.addRows(r+n,i-n):((a=u.wq)&&a.aLb&&(a.bLb=!0),l.PNb=!0,0===n?l.Nia(r,i):l.Nia(r+n-1,i-n,!0),delete l.PNb):i<n&&(l.lhc?u.deleteRows(r+i,n-i):(l.PNb=!0,l.STa(r+i,n-i),delete l.PNb)),l.wq=se,l._bind(o),(s=C&&u.Cf())&&!s.IsSuspended()&&u.recalcAll()}finally{S(u)}}},st.prototype.clone=function(){var e=new st,t=fe(this.toJSON());return e.Yv(this.tc),e.fromJSON(de(t)),e},st.prototype.p$=function(e){var t=new _.qL;t.bind(e),this.wq=t},st.prototype.Az=function(e){if(e&&!e.bindingPath()){var t=e.wq;t&&this.p$(t.getSource())}},st.prototype.LZ=function(){var e=this.wq;return e?e.getSource():se},st.prototype.q$=function(){var e=this.wq;return e?e.getRowCount():0},st.prototype.Eec=function(e,t){var r,n=this.Bec;t?n.push(e):-1!==(r=n.indexOf(e))&&n.splice(r,1)},st.prototype.Cec=function(t){var r=this;r.Bec.forEach(function(e){e.Jec(r,t)}),2===t&&(r.Bec=[])},st.prototype.wzb=function(e,t,r){var n;this.OAb||(((n=this.LAb)[r]||(n[r]={}))[[e,t].join(",")]=!0)},st.prototype.NAb=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d=this.kj,p=d&&d.getCalcService&&d.getCalcService();if(this.OAb=!0,p)for(o in o=void 0,n=this.LAb)if(i=p.jh[o])for(l in a=i.dUa(),s=n[o])c=+(u=l.split(","))[0],h=+u[1],(f=i.Kf(c,h))?(this.QNb(c,h)||this.RNb(f,e,t,r,!1,c,h),i.fg(c,h,f,void 0,!1,a)):delete s[l];else delete n[o];delete this.OAb},st.prototype.SNb=function(e,t,r){var n,o,i,a,s,l,u,c,h,f=this.kj,d=f&&f.getCalcService();if(this.OAb=!0,d)for(o in o=void 0,n=this.LAb)for(a in i=d.jh[o],n[o])l=+(s=a.split(","))[0],u=+s[1],(c=i.Kf(l,u))&&e===l&&t===u&&-1<(h=ee(c))&&(c.arguments[h]=r);delete this.OAb},st.prototype.QNb=function(e,t){var r,n,o=this.footerIndex(),i=!1;return-1<o&&e===o&&(n=(r=this.dj)+this.OZ,i=r<=t&&t<n),i},st.prototype.sort=function(e,t){var r=this.kj,n=this.dataRange(),o=this.rowFilter();r&&0<=e&&e<n.colCount&&(r.suspendPaint(),r.sortRange(n.row,n.col,n.rowCount,n.colCount,!0,[{index:e+n.col,ascending:t}]),o&&(o.zZ={index:e+n.col,ascending:t}),r.resumePaint())},st.prototype.hJb=function(){return!!this.wq},st.prototype.eMb=function(e,t,r,n,o){var i,a,s,l,u,c,h=this,f=h.kj,d=h.cj,p=h.dj,g=h.Xj,m=h.OZ,b=d+g-1,y=r?e+1:e,C=y+t,w=h.dataRange();K(f);try{h.eJb(!1),h.TNb(),h.rI(y,t,r,!1,!0),h.NAb(),n&&!h.UNb&&(a=(i=1+b)+t,s=o-i+1,f.moveTo(i,p,a,p,s,m,1023)),l=b-y+1,(!r||e!==b)&&0<l&&(f.dJb=!0,f.zFc=w,f.moveTo(y,p,C,p,l,m,1023),delete f.zFc,delete f.dJb),u=f._modelManager,c=h.dataRange(),u._Ua&&u._Ua(y,t,[c]),u.CVa&&u.CVa(y,t,[c]),h.VNb(),h.KZ(y,t,!0),h.LNb(),h.HNb(y,t,!0),h.MNb(),h.tc.Nm()}finally{h.eJb(!0),X(f),h.Cec(0),f.recalcAll(!0)}},st.prototype.eJb=function(e){this.kj.eJb(e)},st.prototype.insertRows=function(e,t,r){M(e)||M(t)||t<=0||(e=te(this,e,!0),this.Nia(e,t,r))},st.prototype.Nia=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d;M(e)||M(t)||t<=0||(n=this.kj,i=(o=this.dataRange()).row,0===(a=o.rowCount)&&e===i||!(e<i||i+a<=e)||D(Ve().Exp_RowParamOutOfRange),s=this.cj,l=this.dj,u=this.Xj,h=l+this.OZ-1,d=(c=s+u-1)<(f=j(n,this)),G(n,this,1+c,f,l,h,t)||this.eMb(e,t,r,d,f))},st.prototype.deleteRows=function(e,t){M(e)||M(t)||t<=0||(e=te(this,e,!0),this.STa(e,t))},st.prototype.STa=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w;if(!(M(e)||M(t)||t<=0||(n=(r=this).kj,i=(o=r.dataRange()).row,a=o.rowCount,(e<i||i+a<=e)&&D(Ve().Exp_RowParamOutOfRange),s=r.cj,l=r.dj,h=s+(u=r.Xj)-1,f=l+(c=r.OZ)-1,(u<=1||e===i&&!r.MZ&&!r.NZ&&a<=t)&&D(Ve().Exp_TableDeleteCountInvalid),p=h<(d=j(n,r)),G(n,r,h+1,d,l,f,t,!0)))){K(n);try{r.eJb(!1),g=r.hJb(),m=void 0,g&&(m=q(!0),r.WNb(e,t,m)),r.TNb(),r.GR(e,t,le,m),r.NAb(),b=ue(t,h-e+1),n.clear(e,l,b,c,3,127),e+t<=h&&!g&&n.moveTo(e+t,l,e,l,h-t-e+1,c,1023),p&&(C=(y=h+1)-b,w=d-y+1,n.moveTo(y,l,C,l,w,c,1023)),r.VNb(),r.LNb(),r.HNb(e,t,!1),r.tc.Nm()}finally{r.eJb(!0),X(n),r.Cec(0),n.recalcAll(!0)}}},st.prototype.insertColumns=function(e,t,r){M(e)||M(t)||t<=0||(e=te(this,e,!1),this.hMb(e,t,r))},st.prototype.hMb=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A;if(!(M(e)||M(t)||t<=0||(o=(n=this).kj,a=(i=n.dataRange()).row,s=i.col,l=i.rowCount,u=i.colCount,(e<s||s+u<=e)&&D(Ve().Exp_ColParamOutOfRange),c=n.cj,h=n.dj,d=c+(f=n.Xj)-1,m=(p=h+n.OZ-1)<(g=H(o,n)),G(o,n,c,d,p+1,g,t,!1,!0)))){y=(b=r?e+1:e)+t,K(o);try{n.eJb(!1),n.TNb(),C=!n.hJb(),v=(w=p+1)+t,S=g-w+1,m&&o.moveTo(c,w,c,v,f,S,1023),n.tI(b,t,r,C,!0),n.XNb(b,t,!0),n.NAb(b,t,!0),r&&e===p||!C||(o.dJb=!0,x=n.NZ?1:0,o.moveTo(a,b,a,y,l+x,p-b+1,1023),delete o.dJb),T=o._modelManager,A=n.dataRange(),T.bVa&&T.bVa(b,t,[A]),T.EVa&&T.EVa(b,t,[A]),n.VNb(),n.LNb(),n.INb(b,t,!0),k.kDc(o,b,t,!0,!1),n.tc.Nm()}finally{n.eJb(!0),X(o),n.Cec(0),o.recalcAll(!0)}}},st.prototype.deleteColumns=function(e,t){M(e)||M(t)||t<=0||(e=te(this,e,!1),this.TTa(e,t))},st.prototype.TTa=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C;if(!(M(e)||M(t)||t<=0||(n=(r=this).kj,i=(o=r.dataRange()).col,a=o.colCount,(e<i||i+a<=e)&&D(Ve().Exp_ColParamOutOfRange),s=r.cj,l=r.dj,h=s+(u=r.Xj)-1,f=l+(c=r.OZ)-1,d=r.NZ?1:0,(c<=1||e===l&&c<=t)&&D(Ve().Exp_TableDeleteCountInvalid),g=f<(p=H(n,r)),G(n,r,s,h,f+1,p,t,!0,!0)))){K(n);try{r.eJb(!1),r.TNb(),r.HR(e,t),r.XNb(e,t,!1),r.NAb(e,t,!1),m=ue(t,f-e+1),n.clear(s,e,u,m,3,127),e+t<=f&&n.moveTo(s,e+t,s,e,u-d,f-t-e+1,1023),g&&(y=(b=f+1)-m,C=p-b+1,n.moveTo(s,b,s,y,u,C,1023)),r.VNb(!0),r.LNb(),r.INb(e,t,!1),k.kDc(n,e,t,!1,!1),r.tc.Nm()}finally{r.eJb(!0),X(n),r.Cec(0),n.recalcAll(!0)}}},st.prototype.TNb=function(){var e=this.kj,t=this.tc.l$;e&&e._modelManager.tVa([this]),t.splice(t.indexOf(this),1),this.ZZ()},st.prototype.VNb=function(e){this.PNb=!0,this.nhc=e,this.tc.Cz(this),delete this.nhc,delete this.PNb},st.prototype.XNb=function(e,t,r){var n,o,i,a=this.Nz,s=a.length,l=z(this,e);for(o=l;o<s;o++)i=void 0,r?l+t-1<o&&(i=o-t):l<=o&&(i=o+t),(n=a[o].footerFormula())&&this.RNb(n,e,t,r,!0,i)},st.prototype.RNb=function(e,t,r,n,o,i,a){var s,l,u,c,h=this.kj;if(0<r&&e&&e.arguments)for(s=e.arguments,u=l=void 0,c=0;c<s.length;c++)(l=s[c])instanceof k.xzb&&(h&&(o?h._modelManager.YNb(this,l,i):h._modelManager.ZNb(this,l,i,a)),l.JUa(),u=l.offsetWhenInsertRemoveColumn(t,r,n,o),s[c]=u)},st.prototype.ru=function(e){var t,r,n,o,i,a,s,l=this.wq,u=this.kj,c=this.MZ?1:0,h=this.cj+c+e,f=this.dj;if(!l||0===l.getRowCount())return se;if(t=this.OZ,r={},n=l.ru(e))for(o in n)d(n,o)&&"function"!=typeof o&&(r[o]=n[o]);for(i=0;i<t;i++)s=(a=this.Nz[i])&&a.dataField(),a&&s&&0<s.length&&M(r[s])&&(r[s]=u.getValue(h,f+i));return r},st.prototype.WNb=function(e,t,r){var n,o,i,a,s=[],l=this.wq;if(l)for(o=l.getRowCount(),i=0;i<t;i++)a=se,(n=V(this,e+i))<o&&(a=this.ru(n)),s.push({key:r,data:a});this.Ts=s},st.prototype.nKb=function(){var r=[],e=this.Ts;return e&&O(e,function(e,t){t&&!Y.GC$.isFunction(t)&&r.push(t.data)}),r},st.prototype.DNb=function(e,t,r){var n,o,i,a;0<this.kj.gga||(n=this.nNb,(o=this.wq)&&(i=se,t<o.getRowCount()&&(i=this.ru(t)),a={key:r,data:i},n[e]=a))},st.prototype.ohc=function(e,t,r){var n,o,i;if(!(0<this.kj.gga))if(n=this.nNb,r)o=n.splice(e,t),this.mhc.push({rowIndex:e,count:t,deletedDirtyItems:o});else for(i=0;i<t;i++)n.splice(e,0,se)},st.prototype.ihc=function(e,t){this.nNb.splice(e,t)},st.prototype.phc=function(){var e,t,r=this.mhc.pop(),n=r.rowIndex,o=r.count,i=r.deletedDirtyItems;for(e=0;e<o;e++)t=i[e],this.nNb[n+e]=nt({},t)},st.prototype.getDirtyRows=function(){var e,t,r,n=this.nNb,o=[];for(r=0;r<n.length;r++)e=n[r],M(e)||(t=V(this,r),o.push({row:t,originalItem:e.data,item:this.ru(t)}));return o},st.prototype.clearPendingChanges=function(){this.nNb=[]},st.prototype.footerRowDropDowns=function(e,t){var r,n,o,i,a=this.mNb[e];if(a){if(1===arguments.length)return a.dropDowns&&a.dropDowns.slice();if(r=a.dropDowns[0],t)return n=t.listOption,o=t.submitCommand,i=t.type,n&&(r.option=n),o&&(r.submitCommand=o),L(i)&&(r.type=i),this}},st.prototype.checkTableLastRow=function(e){var t=this.dataRange();return this.headerIndex()===e||t.row+t.rowCount-1!==e},st.prototype.checkTableLastCol=function(e){var t=this.dataRange();return t.col+t.colCount-1!==e},st.prototype.PIb=function(e,t,r,n,o){var i,a,s,l=this.kj;c(l,this,r?Ne:Ee,e,t,n,o),i=l._modelManager,a=r?Ee:Ne,s=!r&&le,i&&i.ZVa(["tableRowsChanged",this,a,e,t,s,r])},st.prototype.QIb=function(e,t,r,n){var o,i,a,s=this.kj;J(s,this,r?_e:Fe,e,t,n),o=s._modelManager,i=r?Fe:_e,a=!r&&le,o&&o.ZVa(["tableColumnsChanged",this,i,e,t,a])},Ze=st,(F.Table=Ze).prototype.name=a(pe,"",at(pe),l),Ze.prototype.bandRows=a(ye,!0,at(ye)),Ze.prototype.bandColumns=a(Ce,!1,at(Ce)),Ze.prototype.highlightFirstColumn=a(me,!1,at(me)),Ze.prototype.highlightLastColumn=a(be,!1,at(be)),Ze.prototype.style=a("style",le,at("style")),Ze.prototype.autoGenerateColumns=a(we,!0,at(we)),n&&n.HideRowFilter&&(Ye=n.HideRowFilter,rt(ct,tt=Ye),ct.prototype.oZ=function(){return 0},ct.prototype.pZ=function(){return this.range.colCount},ct.prototype.table=function(e){return 0===arguments.length?this.sj:void((this.sj=e)&&(this.kj=e.kj))},ct.prototype.rI=function(e,t){var r=this.sj;tt.prototype.rI.call(this,e,t),r&&this.BZ(r.dataRange())},ct.prototype.GR=function(e,t){var r=this.sj;tt.prototype.GR.call(this,e,t),r&&this.BZ(r.dataRange())},ct.prototype.no=function(){this.sj=se,this.kj=se},F.MAb=ct),ut.prototype.k$=function(){return 0<this.id()},ut.prototype.toJSON=function(){var n=this,o={};return O(Me,function(e,t){var r=n[t]();M(r)||(t===ge&&r.toJSON&&"function"==typeof r.toJSON?o[t]=r.toJSON():o[t]=r)}),f(o)?le:o},ut.prototype.fromJSON=function(s){if(s){var l=this;O(Me,function(e,t){var r,n,o,i,a=s[t]!==le?s[t]:s["_"+t];M(a)||t===ge&&(r=a.typeName,(o=(n=Y.CellTypes&&Y.CellTypes._o)&&n[r]||n[a.type]||Y.getTypeFromString(r))&&((i=new o).fromJSON(a,!1),a=i)),M(a)||l[t](a,!1)})}},Ke=ut,(F.TableColumn=Ke).prototype.id=function(e){var t=a("id",le,function(e){this.name()||this.name(Se+e)});return 0===arguments.length?t.call(this):M(e)?this:t.call(this,e)},Ke.prototype.name=a(pe,le,function(e){if(!e){this.name(Se+this.id())}}),Ke.prototype.formatter=a("formatter"),Ke.prototype.cellType=a(ge),Ke.prototype.value=a("value"),Ke.prototype.dataField=a("dataField"),Ke.prototype.footerValue=a(Ae),Ke.prototype.dataAreaFormula=a(Te),Ke.prototype.footerFormula=a(xe),Ke.prototype.ANb=a("dataAreaFormulaStr"),Ke.prototype.NNb=a("isArrayFormula"),lt.prototype.no=function(){var e,t,r=this.l$,n=r.length;for(t=0;t<n;t++)(e=r[t])&&e.no();this.l$=[],this.Nm(),this.kj=se},lt.prototype.Nm=function(){var e,t,r;for(this.$m=[],this.an=[],t=(e=this.l$).length,r=0;r<t;r++)e[r].Nm()},lt.prototype.hNb=function(e){var t,r,n=this.l$,o=n.length;for(r=0;r<o;r++)ot((t=n[r]).oNb,e),t.oNb[e]=le},lt.prototype.iNb=function(e){var t,r,n=this.l$,o=n.length;for(r=0;r<o;r++)ot((t=n[r]).pNb,e),t.pNb[e]=le},lt.prototype.add=function(e,t,r,n,o,i,a){return this.LA(this.kj,e,t,r,n,o,!0),this.Cz(new Ze(e,t,r,n,o,i||P.TableThemes.medium2,a))},lt.prototype.addFromDataSource=function(e,t,r,n,o,i){var a,s,l,u,c;if(n||D(Ve().Exp_TableDataSourceNullError),_.qL)return(a=this.kj).suspendPaint(),(s=new _.qL).bind(n),l=s.getRowCount()+1,u=s.getColumnCount(),(c=this.add(e,t,r,l,u,o,i))._bind(s),a.clearPendingChanges(),a.resumePaint(),c},lt.prototype.find=function(e,t){var r,n,o,i=this.l$,a=i.length;for(n=0;n<a;n++)if((o=(r=i[n]).range()).row<=e&&e<o.row+N(o)&&o.col<=t&&t<o.col+B(o))return r;return se},lt.prototype.findByName=function(e){var t,r,n=this.l$,o=n.length;for(r=0;r<o;r++)if((t=n[r]).name().toLowerCase()===e.toLowerCase())return t;return se},lt.prototype.pJb=function(e,t,r,n){var o,i,a=this.l$,s=a.length,l=Y.kf(e,r,t,n),u=[];for(i=0;i<s;i++)o=a[i],l.containsRange(o.range())&&u.push(o);return u},lt.prototype.s$=function(e,t,r,n){var o,i,a=this.l$,s=a.length,l=[];for(i=0;i<s;i++)(o=a[i]).range().intersect(e,t,r,n)&&l.push(o);return l},lt.prototype.KHb=function(){var e=this.kj,t=this.find(e.Jl,e.Kl);if(t)return e.cm(new Y.Range(-1,t.dj,-1,t.OZ))},lt.prototype.Cz=function(e,t){var r;if(e)return this.findByName(e.name())&&D(Ve().Exp_TableHasSameNameError),(r=this.kj).suspendPaint(),e.Yv(this),r._modelManager.tVa([]),this.l$.push(e),e.PNb||e.JZ(),e.showHeader()&&e.PZ(),!t&&e.showFooter()&&e.SZ(),this.t$(e),r.resumePaint(),e},lt.prototype.vV=function(e){var t,r=m(e,this.l$);return-1<r?((t=this.kj)&&t._modelManager.tVa([e]),this.l$.splice(r,1),this.u$([e],!1),e):se},lt.prototype.remove=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b;if(Z(e)&&(e=this.findByName(e)),e&&(t=t||0,e.RZ(),e=this.vV(e))){r=e.range(),n=this.kj;try{if(v(n),o=r.row,i=r.row+N(r),a=r.col,s=r.col+B(r),u=l=void 0,c=e.showHeader(),h=e.headerIndex(),1!=(1&t))for(l=o;l<i;l++)for(u=a;u<s;u++)A(n,l,u,se),w(n,l,u,se);else if(e.hJb()){if(c)for(l=h,u=a;u<s;u++)n.setValue(l,u,e.getColumnName(u-r.col));for(p=(d=(f=e.dataRange()).row)+N(f),m=g=void 0,l=d;l<p;l++)for(u=a;u<s;u++)(g=e.Nz[z(e,u)])&&(m=e.ru(V(e,l))[g.dataField()],M(m)||n.setValue(l,u,m))}else if(c)for(l=h,u=a;u<s;u++)n.setValue(l,u,e.getColumnName(u-r.col));if(2==(2&t))for(l=o;l<i;l++)for(u=a;u<s;u++)b=n.getStyle(l,u)||new Y.Style,e.Yo(l,u,b),n.setStyle(l,u,b)}finally{S(n)}e.Cec(2)}return e},lt.prototype.move=function(e,t,r){var n,o,i,a=this.kj;if(Z(e)&&(e=this.findByName(e)),e&&0<=t&&0<=r&&(n=e.range(),0===(i=(o=this.s$(t,r,N(n),B(n))).length)||1===i&&o[0]===e)){v(a);try{e.YZ(t,r)}finally{S(a)}}},lt.prototype.resize=function(e,t){var r,n,o,i,a,s,l,u,c,h=this.kj;if(Z(e)&&(e=this.findByName(e)),e&&(r=e.range(),n=e.dataRange(),i=t,3===(o=arguments).length&&(i=Y.kf(r.row,r.col,o[1],o[2])),i&&(a=N(i),s=B(i),0<=a&&0<=s&&this.s$(i.row,i.col,a,s).length<=1))){K(h);try{e.b$(i),!e.hJb()&&r.rowCount<i.rowCount&&(l=h._modelManager,u=r.row+r.rowCount,c=i.rowCount-r.rowCount,e.showFooter()&&u--,l._Ua&&l._Ua(u,c,[n]),l.CVa&&l.CVa(u,c,[n]))}finally{X(h)}}},lt.prototype.all=function(){var r=[];return O(this.l$,function(e,t){r.push(t)}),r},lt.prototype.Xec=function(e){var t,r=e||this.l$,n=r.length;for(t=0;t<n;t++)r[t].clearPendingChanges()},lt.prototype.Nec=function(e,t,r,n){var o,i,a=[],s=this.l$,l=s.length;for(o=0;o<l;o++)(i=s[o]).cj>=e&&i.dj>=t&&i.cj+i.Xj<=e+r&&i.dj+i.OZ<=t+n&&a.push(i);return a},lt.prototype.Oec=function(e,t,r,n){var o=this.s$(e,t,r,n),i=this.Nec(e,t,r,n),a=[];return 0<i.length?o.forEach(function(e){-1===i.indexOf(e)&&a.push(e)}):a=o,a},lt.prototype.Pec=function(e,t,r){var n,o,i=e.length;for(n=0;n<i;n++)if((o=e[n].range()).row<=t&&t<o.row+N(o)&&(r<0||o.col<=r&&r<o.col+B(o)))return!0;return!1},lt.prototype.LA=function(e,t,r,n,o,i,a){var s,l,u,c;return t?g(t)?r<0||o<1||r+o>e.getRowCount()?(a&&D(Ve().Exp_TableInvalidRow),!1):n<0||i<1||n+i>e.getColumnCount()?(a&&D(Ve().Exp_TableInvalidColumn),!1):(s=e.tables).rn(r,n,o,i)?(a&&D(Ve().Exp_TableIntersectError),!1):s.findByName(t)?(a&&D(Ve().Exp_TableHasSameNameError),!1):(u=(l=C&&e.Ms(r,n,o,i))&&l.ranges,c=!0,u&&O(l,function(e,t){if(1<N(t)||1<B(t))return a&&D(Ve().Exp_ArrayFormulaTable),c=!1}),c):(a&&D(Ve().Exp_TableNameInvalid),!1):(a&&D(Ve().Exp_TableEmptyNameError),!1)},lt.prototype.$Hb=function(e,t,r,n){var o,i,a=[],s=this.l$;for(o=0;o<s.length;o++)(i=s[o]).cj>=e&&i.dj>=t&&i.cj+i.Xj<=e+r&&i.dj+i.OZ<=t+n&&a.push(i.name());return a},lt.prototype.HZ=function(e,t,r,n){var o,i,a,s,l=this.all();if(l)for(o=Y.kf(e,t,r,n),i=l.length,a=void 0,s=0;s<i;s++)if(a=l[s].range(),o.intersect(a.row,a.col,N(a),B(a))&&!o.containsRange(a))return!0;return!1},lt.prototype.rn=function(e,t,r,n){var o,i=this.l$,a=i.length;for(o=0;o<a;o++)if(i[o].range().intersect(e,t,r,n))return!0;return!1},lt.prototype._getTable=function(e,t,r,n,o){var i,a,s,l=e.tables.all(),u=l.length,c=[];for(a=0;a<u;a++)(s=(i=l[a]).range()).row>=t&&s.col>=r&&s.row+s.rowCount<=t+n&&s.colCount+s.col<=r+o&&c.push({table:i,index:a});return c},lt.prototype.zxb=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d=r.tables.all(),p=d.length;if(!M(t)&&(a=n.row-t.row,s=n.col-t.col,0!==(l=this._getTable(e,t.row,t.col,t.rowCount,t.colCount)).length))for(u=0;u<p;u++)for(i=d[u],c=0;c<l.length;c++)if(h=l[c],(!o||u!==h.index)&&(f=h.table.range(),i.range().intersect(f.row+a,f.col+s,f.rowCount,f.colCount)))return r.Os(6,Ve().Exp_TableIntersectError),!0;return!1},lt.prototype.KZ=function(e,t){var r,n,o=this.l$;for(r=0,n=o.length;r<n;r++)o[r].KZ(e,t)},lt.prototype.rI=function(e,t){var r,n,o,i,a,s,l,u,c,h,f=this.l$,d=[];for(r=0,n=f.length;r<n;r++)i=(o=f[r]).LZ(),y(d,i)?o.rI(e,t,!0):o.rI(e,t)&&d.push(i);a=this.kj;try{for(v(a),l=s=void 0,r=0,n=f.length;r<n;r++)s=(o=f[r]).q$(),l=o.dataRange(),0<s&&s!==N(l)&&(u=s,o.showHeader()&&(u+=1),o.showFooter()&&(u+=1),c=o.range(),h=Y.kf(c.row,c.col,u,B(l)),o.b$(h))}finally{S(a)}},lt.prototype.tI=function(e,t){var r,n=this.l$,o=n.length;for(r=0;r<o;r++)n[r].tI(e,t)},lt.prototype.khc=function(e){var t,r,n,o,i=this.l$,a=i.length;for(o=0;o<a;o++)r=(t=i[o]).dj,n=t.endColumn(),r<=e&&e<=n&&t.khc()},lt.prototype.GR=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d=this.l$,p=[],g=[],m=[];for(r=0,n=d.length;r<n;r++)i=(o=d[r]).LZ(),e<=(a=o.range()).row&&a.row+N(a)<=e+t?m.push(o):(y(p,i)?o.GR(e,t,!0):(o.hJb()&&o.WNb(e,t,q(!0)),o.GR(e,t)&&p.push(i)),g.push(o));this.kj._modelManager.tVa(m),this.l$=g,this.u$(m,!0),s=this.kj;try{for(v(s),d=this.l$,u=l=void 0,r=0,n=d.length;r<n;r++)l=(o=d[r]).q$(),u=o.dataRange(),0<l&&l!==N(u)&&(c=l,o.showHeader()&&(c+=1),o.showFooter()&&(c+=1),h=o.range(),f=Y.kf(h.row,h.col,c,B(u)),o.b$(f))}finally{S(s)}},lt.prototype.HR=function(e,t){var r,n,o,i=this.l$,a=[],s=[],l=i.length;for(n=0;n<l;n++)e<=(o=(r=i[n]).range()).col&&o.col+B(o)<=e+t?s.push(r):(r.HR(e,t),a.push(r));this.kj._modelManager.tVa(s),this.l$=a,this.u$(s,!0)},lt.prototype.$b=function(e,t,r,n,o){var i,a,s,l,u,c=Y.kf(e,t,r,n),h=[],f=this.kj;if(1==(1&o)){for(l=[],a=(i=this.l$).length,u=0;u<a;u++)s=i[u],c.containsRange(s.range())?h.push(s):l.push(s);for(a=l.length,u=0;u<a;u++)(s=l[u]).$b(e,t,r,n);f&&f._modelManager.tVa(h),this.l$=l}if(2==(2&o))for(a=(i=this.l$).length,u=0;u<a;u++)s=i[u],c.containsRange(s.range())&&(f&&f._modelManager.pVa(s,"style",s.style()),s.style(se));return this.u$(h,!0),h},lt.prototype.u$=function(e,t){if(e&&0!==e.length){var r=this.kj;Y.GC$.each(e,function(e,t){t.Aq()&&t.getSlicerData().onTableRemoved(t),t.uNb()&&(r&&r._modelManager.pVa(t,ke,t.wNb()),t.mNb=[])}),C&&(i=this.kj,o=e,a=t,s=i.parent,l=u(i),s?(n(s.getCustomNames(),o),O(s.sheets,function(e,t){n(t.getCustomNames(),o)})):n(i.getCustomNames(),o),l.onAfterRemoveTable(o,a))}function n(e,o){O(e,function(e,t){var r=t.getExpression(),n=k.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(r,o,-1,-1,a);n!==r&&(t.fg(n),l.invalidName(i.yj(),t.getName()))})}var i,o,a,s,l},lt.prototype.t$=function(e){e&&e.Aq()&&e.getSlicerData().onTableAdded(e)},lt.prototype.v$=function(e){for(var t=1;this.findByName(e);)e=Ie+t,t++;return e},lt.prototype.ge=function(e,t){var r=!1,n=se,o=this.find(e,t);return o&&(o.showHeader()&&e===o.headerIndex()?(n=o.g$(t),M(n)||(n=s(n)),r=!0):(r=(n=o.ge(e,t)).gt,n=n.Qb)),{gt:r,Qb:n}},lt.prototype.yq=function(e,t,r){var n=!1,o=!0,i=this.find(e,t);return i&&!0!==i.KNb&&(i.showHeader()&&e===i.headerIndex()?i.VZ(r)?o=!1:(r=M(r)?r:s(r),i.h$(t,r)):i.showFooter()&&e===i.footerIndex()?i.j$(t,r):n=i.yq(e,t,r)),n||!o},lt.prototype.Hma=function(e,t,r,n,o,i){var a=this.find(e,t);if(C&&a){if(1<r||1<n)return this.kj.Os(0,Ve().Exp_ArrayFormulaTable),!1;if(a.showHeader()&&e===a.headerIndex()&&o)return!1;!a.KNb&&a.showFooter()&&e===a.footerIndex()&&(M(o)||a.j$(t,se),a.i$(t-a.dj,o,i))}return!0},lt.prototype.IZ=function(){var e,t,r,n=this.all();for(e=0,t=n.length;e<t;e++)(r=n[e]).bindingPath()&&(r.wq=se)},lt.prototype.dB=function(e,t){var r,n,o,i=[];if(this&&(r=this.all()))for(o=r.length-1;0<=o;o--)n=r[o],e.containsRange(n.range())&&(t&&(this.kj&&this.kj._modelManager.tVa([n]),this.l$.splice(o,1),n.ZZ(le,le,t)),i.push(n));return i},lt.prototype.eB=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d=[];for(a=0,s=e.length;a<s;a++)l=e[a],c=u=void 0,i?c=l:(u=l.bindingPath()?le:l.LZ(),(c=new Ze).Yv(this),c.fromJSON(de(fe(l.toJSON()))),c.name(this.v$(c.name())),d.push(c)),h=c.range(),c.S3=!0,c.$Z(n+h.row-t,o+h.col-r),this.Cz(c,i),i?(f=c.ZX)&&(f.kj=this.kj,f.refresh()):u&&c.p$(u),c.S3=!1;for(a=0;a<d.length;a++)d[a].formulaFromJSON()},lt.prototype.R3=function(e){for(var t=0,r=e.length;t<r;t++)e[t]._Z()},lt.prototype.toJSON=function(){var e,t=this.l$,r=[];if(t)for(e=0;e<t.length;e++)r.push(t[e].toJSON());return 0===r.length?le:r},lt.prototype.fromJSON=function(e,t){var r,n,o,i;if(e)for(this.l$=[],this.Nm(),r=0,n=e.length;r<n;r++)o=e[r],(i=new Ze).Yv(this),this.l$.push(i),i.fromJSON(o,t)},lt.prototype.containTableHeaderTotalRowForSheet=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f=this.kj;if(f&&(e=f.getSelections(),o=n=r=void 0,(t=f.tables)&&e))for(i=t.l$,u=l=s=a=void 0,c=0;c<e.length;c++)for(o=(n=(r=e[c]).row)+r.rowCount-1,h=0;h<i.length;h++)if(s=(a=i[h]).range(),l=a.headerIndex(),u=a.footerIndex(),!r.containsRange(s)&&(n<=l&&l<=o||n<=u&&u<=o))return!0;return!1},lt.prototype.containTableHeaderTotalRow=function(){var e,t,r,n,o,i,a,s,l=this.kj,u=!1;if(l&&(e=l.getSelections(),r=t=void 0,l.tables&&e)){if(1<e.length)return u;n=e[0],s=a=i=void 0,(o=oe(l,n))&&1===o.length&&(r=(t=n.row)+n.rowCount-1,a=(i=o[0]).headerIndex(),s=i.footerIndex(),(t<=a&&a<=r||t<=s&&s<=r)&&(u=!0))}return u},lt.prototype.noRoomToInsertColumn=function(){var e,t,r,n,o,i,a,s,l=this.kj;return!!(l&&(e=l.getSelections(),(t=l.tables)&&e&&1===e.length&&(n=(r=e[0]).row,o=r.col,i=r.colCount,a=t.find(n,o),s=l.getColumnCount(3),a&&a.endColumn()+i>=s)))},lt.prototype.noRoomToInsertRow=function(){var e,t,r,n,o,i,a,s,l=this.kj;return!!(l&&(e=l.getSelections(),(t=l.tables)&&e&&1===e.length&&(n=(r=e[0]).row,o=r.col,i=r.rowCount,a=t.find(n,o),s=l.getRowCount(3),a&&a.endRow()+i>=s)))},lt.prototype.checkTableRow=function(){var e,t,r,n,o,i,a,s=this.kj;return!!(s&&(e=s.getSelections(),(t=s.tables)&&e&&1===e.length&&(n=(r=e[0]).row,o=r.col,a=(i=t.find(n,o))&&i.range(),i&&a&&!i.MZ&&!i.NZ&&1===a.rowCount)))},lt.prototype.checkTableCol=function(){var e,t,r,n,o,i,a,s=this.kj;return!!(s&&(e=s.getSelections(),(t=s.tables)&&e&&1===e.length&&(n=(r=e[0]).row,o=r.col,(a=(i=t.find(n,o))&&i.range())&&1===a.colCount)))},lt.prototype.isAcrossTables=function(){var e,t,r,n=this.kj,o=!1;if(n&&(e=n.getSelections(),n.tables&&e)){if(1<e.length)return o;t=e[0],(r=oe(n,t))&&(o=1<r.length)}return o},lt.prototype.isWholeTableCol=function(){var e,t,r,n,o,i,a,s,l=this.kj,u=!1;return l&&(e=l.getSelections(),l.tables&&e&&(1<e.length?u=!0:(t=e[0],1===(r=oe(l,t)).length&&(o=(n=r[0]).dj,i=n.OZ,a=t.col,s=t.colCount,u=o===a&&i===s)))),u},lt.prototype.containTableHeader=function(){var e,t,r,n,o,i,a=this.kj,s=!1;if(a&&(e=a.getSelections(),r=t=void 0,a.tables&&e)){if(1<e.length)return s;n=e[0],(o=oe(a,n))&&1===o.length&&(i=o[0].headerIndex(),r=(t=n.row)+n.rowCount-1,t<=i&&i<=r&&(s=!0))}return s},lt.prototype.mKb=function(){var e,t,r,n,o,i,a,s,l=this.kj,u=!1;if(l&&(e=l.getSelections(),(t=l.tables)&&e)){if(r=l.getActiveRowIndex(),n=l.getActiveColumnIndex(),1<e.length||!t.find(r,n))return u;for(o=t.l$,i=e[0],a=void 0,s=0;s<o.length;s++)a=o[s],i&&i.intersect(a.cj,a.dj,a.Xj,a.OZ)&&(u=!0)}return u},lt.prototype.PMb=function(e){var t,r,n,o,i=-1,a=this.l$;if(a)for(t=a.length,n=r=void 0,o=0;o<t;o++)r=a[o].range(),e&&!r.intersect(e.row,e.col,e.rowCount,e.colCount)||i<(n=r.row+r.rowCount-1)&&(i=n);return i},lt.prototype.QMb=function(e){var t,r,n,o,i=-1,a=this.l$;if(a)for(t=a.length,n=r=void 0,o=0;o<t;o++)r=a[o].range(),e&&!r.intersect(e.row,e.col,e.rowCount,e.colCount)||i<(n=r.col+r.colCount-1)&&(i=n);return i},lt.prototype.fIb=function(e,t,r,n){var o,i,a,s,l,u;if(!this.kj.options.isProtected&&0!==(o=this.all()).length)for(s=0;s<o.length;s++)(i=o[s]).qNb&&(a=i.range(),l=t&&t.equals(a),u=t&&0!==this.kj._modelManager.getSpans(t,3).length,t&&(l||u)||(i.UNb=n,this.$Nb(i,a,e,r),delete i.UNb))},lt.prototype.$Nb=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x=this.kj,T=null,A=!1,k=t.row+t.rowCount-1,M=new Y.Range(t.row,t.col,t.rowCount,t.colCount);if(e.showFooter()){if(o=new Y.Range(t.row+t.rowCount-1,t.col,1,t.colCount),r.row===o.row&&r.col>=t.col&&r.col+r.colCount<=t.col+t.colCount)return;A=!0,M.rowCount--}if(i=r.row,a=r.col,s=r.row+r.rowCount-1,l=r.col+r.colCount-1,u=t.row+t.rowCount-1,c=t.col+t.colCount-1,h=le,f=x.getRowCount(),d=M.contains(i-1,a)&&!M.contains(i,a),A||(d=d&&l<=c&&a>=t.col),p=M.contains(i,a-1)&&!M.contains(i,a)&&s<=k&&i>=t.row,M.contains(i,a)&&!M.contains(s,l)){if(g=he(u,s)-t.row+1,m=he(c,l)-t.col+1,c<l&&(b=U(x,new Y.Range(t.row,1+c,t.rowCount,l-c)))&&l>b.col&&(m=t.colCount),T=new Y.Range(t.row,t.col,g,m),A&&(T.rowCount++,s++),u<s&&(h=U(x,new Y.Range(1+u,t.col,T.row+T.rowCount-1,t.colCount))),h&&0<(y=s-h.row+1)){if(U(x,new Y.Range(f-Math.abs(y),t.col,Math.abs(y),t.colCount)))return void x.Os(6,Ve().Exp_TableAddRowNoEnoughRoom);x.moveTo(h.row,t.col,T.row+T.rowCount,t.col,f-T.row-T.rowCount,t.colCount,1)}}else if(d&&!A){if(T=new Y.Range(i,t.col,r.rowCount,t.colCount),(C=U(x,T,r))&&!r.containsRange(C))return}else if(p&&(T=new Y.Range(t.row,a,t.rowCount,r.colCount),(C=U(x,T,r))&&!r.containsRange(C)))return;if(d&&!A&&$(n)&&(e.useFooterDropDownList(!0),S=e,(v=x).wu().execute({cmd:De,sheetName:v.name(),tableName:S.name()})),T){if(t.containsRange(T))return;w=t.union(T),this._Nb(e,t,w)}},lt.prototype._Nb=function(e,t,r){var n=this.kj,o=n.getParent();o&&o.commandManager().execute({cmd:"tableResize",sheetName:n.name(),tableName:e.name(),resizeToRange:r})},lt.prototype.gJb=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b=this.kj,y=r.col,C=r.row,w=ze.TABLE_SELECT,v=ze.TABLE_CORNER_SELECT,S=ze.TABLE_COL_SELECT,x=ze.TABLE_ROW_SELECT,T=b.getActiveRowIndex(),A=b.getActiveColumnIndex();if(-1===r.rowViewportIndex&&(n=b.getCellRect(C,y,r.rowViewportIndex,r.colViewportIndex),(o=this.find(T,A))instanceof Ze&&o.showHeader()&&T>=o.cj&&T<o.cj+o.Xj&&A>=o.dj&&A<o.dj+o.OZ&&o.cj<b.lq&&o.cj+o.Xj>b.lq&&r.col<o.dj+o.OZ&&r.col>=o.dj))if(e>n.x+5&&e<n.x+n.width-18&&t<n.height-5){for(i=b.getSelections(),a=0;a<i.length;a++)if(!((s=i[a]).col===r.col&&1===s.colCount&&s.row===o.cj&&s.rowCount===o.Xj||s.col===r.col&&1===s.colCount&&-1===s.row&&s.rowCount===b.getRowCount()))return W(o,S)}else if(e>n.x+18)return W(o,"default");if(l=b.getCellRect(C,y),this.find(C,y)instanceof Ze&&-1!==r.colViewportIndex&&-1!==r.rowViewportIndex){if(u=!1,o=this.find(C,y),c=this.find(T,A),h=!0,1===(i=b.getSelections()).length&&(f=i[0]).row<=C&&f.row+f.rowCount>C&&f.col<=y&&f.col+f.colCount>y&&(h=!1),o===c&&(u=!0),y===o.dj&&C===o.cj){if(h&&u&&(e<=l.x+2||t<=l.y+2))return W(o,w);if(e>l.x+2&&e<l.x+18&&t>l.y+2&&t<l.y+6)return W(o,v);if(e>l.x+18&&t>l.y+2&&t<l.y+6)return W(o,S);if(e>l.x+2&&e<l.x+18&&t>l.y+6)return W(o,x)}if(y===o.dj+o.OZ-1&&C===o.cj){if(h&&u&&(e>=l.x+b.getColumnWidth(y)-2||t<=l.y+2))return W(o,w);if(e<l.x+b.getColumnWidth(y)-2&&t>l.y+2&&t<l.y+6)return W(o,S)}if(y===o.dj&&C===o.cj+o.Xj-1){if(h&&u&&(e<=l.x+2||t>=l.y+b.getRowHeight(C)-2))return W(o,w);if(e>l.x+2&&e<l.x+18&&t<l.y+b.getRowHeight(C)-2)return W(o,x)}if(h&&u&&y>o.dj&&y<o.dj+o.OZ&&C===o.cj&&t<=l.y+2)return W(o,w);if(y>o.dj&&y<o.dj+o.OZ&&C===o.cj&&t>l.y+2&&t<l.y+6)return W(o,S);if(h&&u&&C>o.cj&&C<o.cj+o.Xj&&y===o.dj&&e<=l.x+2)return W(o,w);if(C>o.cj&&C<o.cj+o.Xj&&y===o.dj&&e>l.x+2&&e<l.x+18)return W(o,x);if(d=b.getColumnWidth(o.dj+o.OZ-1),p=b.getRowHeight(o.cj+o.Xj-1),g=l.x+d,m=l.y+p,u&&(C>o.cj&&C<o.cj+o.Xj&&y===o.dj+o.OZ-1&&g-2<=e&&e<=g||y>o.dj&&y<o.dj+o.OZ&&C===o.cj+o.Xj-1&&m-2<=t&&t<=m)){if(y===o.dj+o.OZ-1&&C===o.cj+o.Xj-1&&m-10<=t&&g-10<=e)return se;if(h)return W(o,w)}}return se},lt.prototype.bJb=function(e,t){var r,n,o,i,a=this.kj;if(this.find(e,t)instanceof Ze){for(n=0,(r=this.find(e,t)).NZ&&(n=1),o=0,r.MZ&&(o=1);0<e&&0===a.getRowHeight(e-1);)e--;if(1===o&&t===r.dj&&e===r.cj)return i=T(a,r,!0),E(i,r.dj+r.OZ-1,i);if(t===r.dj&&e===r.cj)return i=T(a,r,!0),E(i,r.dj+r.OZ-1,i);if(e>r.cj&&e<r.cj+r.Xj-n&&t===r.dj)return e===r.cj+o?(e=T(a,r,!0),E(e,r.dj+r.OZ-1,e)):E(e-1,r.dj+r.OZ-1,e-1)}return null},lt.prototype.cJb=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=this.kj;if(this.find(e,t)instanceof Ze){for(n=0,(r=this.find(e,t)).NZ&&(n=1),o=0,r.MZ&&(o=1),i=T.getRowCount()-1;e+1<T.getRowCount()&&0===T.getRowHeight(e+1);)e++;if(i!==e&&t===r.dj+r.OZ-1&&e<r.cj+r.Xj-n)return a=r.cj+r.Xj,l=(s=r.dj)+r.OZ-1,u=E(e+1,r.dj,e+1),e===a-n-1&&(r.qNb?(c=j(T,r),1===n&&G(T,r,a,c,s,l,1,!0,!1,!0)||(f=((h=U(T,new Y.Range(a,s,c-a+1,l-s+1)))&&h.row)===a,a!==T.getRowCount()&&(f?(w=r,v=e,S=1,x=!0,(C=T).wu().execute({cmd:Ee,sheetName:C.name(),tableName:w.name(),row:v,count:S,isAfter:x})):(g=r,m=e,b=1,y=!0,(p=T).wu().execute({cmd:Re,sheetName:p.name(),tableName:g.name(),row:m,count:b,isAfter:y}))))):u=E(e,1+l,e)),u;if(T.getRowCount()-1===e&&t===r.dj+r.OZ-1&&0===n){for(d=r.cj+o;d+1<T.getRowCount()&&0===T.getRowHeight(d);)d++;return d+1===T.getRowCount()&&0===T.getRowHeight(d)?E(r.cj,r.dj,r.cj):E(d,r.dj,d)}}return null},lt.prototype.fg=function(){var e,t=this.l$,r=t.length;for(e=0;e<r;e++)t[e].e$()},lt.prototype.Cec=function(e,t){var r,n,o,i,a,s,l=this.l$,u=l.length;for(r=0;r<u;r++)n=l[r],e?(o=n.cj,i=n.cj+n.Xj-1,o<=t&&t<=i&&n.Cec(0)):(a=n.dj,s=n.dj+n.OZ-1,a<=t&&t<=s&&n.Cec(0))},lt.prototype.KFc=function(e,t,r,n,o){var i,a,s,l=this.s$(e,t,r,n),u=[];for(i=0,a=l.length;i<a;i++)s=l[i].dataRange(),o?s.rowCount+=r:s.colCount+=n,u.push(s);return u},Xe=lt,F.TableManager=Xe,(et=F.TableRemoveOptions||(F.TableRemoveOptions={}))[et.none=0]="none",et[et.keepData=1]="keepData",et[et.keepStyle=2]="keepStyle",Y.GC$.extend(Y.lUa.prototype,{CNb:function(e,t){var r=this.zTa;r&&(r.uVa||(r.uVa=[]),r.uVa.push({type:"changeTableManager",table:e,oldTableManager:t}))},pVa:function(e,t,r){var n=this.zTa;n&&(n.uVa||(n.uVa=[]),n.uVa.push({type:"property",table:e,name:t,value:r}))},tVa:function(e){var t,r,n=this.zTa;n&&(n.uVa||(n.uVa=[]),t=n.uVa,r=this.noa,t.push({type:Pe,tableList:r.l$.slice(),changedTables:e}))},sVa:function(e,t,r){var n=this.zTa;n&&(n.uVa||(n.uVa=[]),n.uVa.push({type:Le,tableColumn:e,name:t,value:r}))},vVa:function(e,t,r){var n=e.getValue(t,r).value,o=this.zTa;o&&(o.uVa||(o.uVa=[]),o.uVa.push({type:Oe,bindingManager:e,row:t,col:r,oldValue:n}))},ENb:function(e,t,r,n,o){var i=this.zTa;i&&(i.uVa||(i.uVa=[]),i.uVa.push({type:Be,table:e,key:n,row:t,count:r,stateType:o}))},YNb:function(e,t,r){var n=this.zTa;n&&(n.aOb||(n.aOb=[]),n.aOb.push({type:Ge,table:e,expression:t,col:r}))},ZNb:function(e,t,r,n){var o=this.zTa;o&&(o.bOb||(o.bOb=[]),o.bOb.push({type:Ue,table:e,expression:t,row:r,col:n}))},wVa:function(e){var t,r,n,o,i,a,s,l;if(e)for(function(e){var t,r;if(e)for(t=e.length-1;0<=t;t--)(r=e[t]).bindingManager.sUa(r)}(e.rUa),t=e.length-1;0<=t;t--)switch(r=e[t],n=void 0,r.type){case Pe:o=this.noa,i=r.changedTables,o.l$=r.tableList,i&&0<i.length&&i.forEach(function(e){e&&(e.e$(),e.JZ())});break;case Le:r.tableColumn[r.name](r.value);break;case"property":n=r.table,a=r.name,s=r.value,a===je?(n.cj=s.row,n.dj=s.col,n.Xj=s.rowCount,n.OZ=s.colCount):a===He?n.Nz=s:a===ke?n.mNb=s:n[a](s),n.Cec(0);break;case"changeTableManager":n=r.table,l=r.oldTableManager,n.BNb(l);break;case Oe:r.bindingManager.setValue(r.row,r.col,r.oldValue);break;case Be:ht(r.table,r.row,r.count,r.key,r.stateType)}},cOb:function(e){var t,r,n,o,i,a,s;if(e){for(t=void 0,r=e.length-1;0<=r;r--)(n=e[r]).type===Ge&&(t=n.table,o=n.expression,i=n.col,a=void 0,(a=t.Nz[i].footerFormula())&&(-1<(s=ee(a))&&(a.arguments[s]=o)));t&&t.e$()}},dOb:function(e){var t,r,n,o,i;if(e)for(t=e.length-1;0<=t;t--)(r=e[t]).type===Ue&&(n=r.expression,o=r.row,i=r.col,r.table.SNb(o,i,n))}}),Y.lUa.$n(Ie,{priority:7e3,init:function(){this.noa=new Xe(this.kj)},clearPendingChanges:function(e){var t=this.tables;t&&t.Xec(e.tableList)},undoAddRows:function(e){var t=this.kj,r=e.row,n=e.rowCount;t.tables.s$(r,-1,n,-1).forEach(function(e){e.WNb(r,n,q(!0))})},getValue:function(e){var t,r=e.row,n=e.col,o=e.sheetArea,i=this.kj.tables;3!==o||!i||i.find(r,n)&&(t=i.ge(r,n),e.isValueGet=t.gt,e.value=t.Qb)},setValue:function(e){var t,r=e.row,n=e.col,o=e.value,i=e.sheetArea,a=this.kj.tables;3!==i||!a||a.find(r,n)&&((t=e.changes)&&(t.uVa||(t.uVa=[])),e.isValueSet=a.yq(r,n,o))},undo:function(e){var t=e.uVa,r=e.aOb,n=e.bOb;t&&this.wVa(t),r&&this.cOb(r),n&&this.dOb(n),this.noa.Nm()}}),Y.Workbook.$n(Ie,{init:function(){Y.Commands.mMb(this.commandManager())}})},"./dist/plugins/table/table.ns.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./dist/plugins/table/table.res.en.js");t.SR={en:n}},"./dist/plugins/table/table.res.en.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",t.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",t.Exp_TableEmptyNameError="The table name cannot be empty.",t.Exp_TableNameInvalid="The table name is not valid.",t.Exp_TableInvalidRow="Invalid row index or row count.",t.Exp_TableInvalidColumn="Invalid column index or column count.",t.Exp_TableIntersectError="The tables cannot be intersected.",t.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",t.Exp_TableDataSourceNullError="Table datasource cannot be null.",t.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",t.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",t.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",t.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",t.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",t.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",t.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",t.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",t.Exp_RowParamOutOfRange="The param row out of data range of table.",t.Exp_ColParamOutOfRange="The param col out of data range of table.",t.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",t.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",t.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",t.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",t.Table_Total="Total",t.Table_None="None",t.Table_Average="Average",t.Table_Count="Count",t.Table_Count_Numbers="Count Numbers",t.Table_Max="Max",t.Table_Min="Min",t.Table_Sum="Sum",t.Table_StdDev="StdDev",t.Table_Var="Var"},"./dist/plugins/touch/touch.entry.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(t("./dist/plugins/touch/touch.js"))},"./dist/plugins/touch/touch.js":function(e,t,r){"use strict";var E,ue,n,L,o,R,i,b,h,l,ce,a,_,s,O,B,D,he,fe,C,u,f,y,c,d,w,v,p,N,F,P,j,H,G,U,g,m,W,S,V,z,x,T,A,k,M,I,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,Ee,Re,De,Ne,Fe,_e,Pe,Le,Oe=this&&this.__extends||(Pe=function(e,t){return(Pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}Pe(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function Be(e){return e.height}function je(e){return e.width}function He(e){clearInterval(e)}function Ge(){return(new Date).valueOf()}function Ue(e,t){var r,n;return e&&t&&(0,0,r=e.X-t.X,n=e.Y-t.Y,D(r)<13&&D(n)<13&&c(r*r+n*n)<he(15,15))}function We(e){return e.getActiveSheet()}function Ve(e){return e.getSelections()}function ze(e){return e.frozenTrailingColumnCount()}function qe(e){return e.frozenTrailingRowCount()}function Ze(e,t){return e.getColumnCount(t)}function Ye(e,t){return e.getRowCount(t)}function Ke(e){var t=R(e).offset(),r=z.body,n=0,o=0;return t&&(n=t.top+r.clientTop||0,o=t.left+r.clientLeft||0),{FB:n,EB:o}}function Xe(){this.rM=[],this.sM={length:0},this.tM=new q,this.uM=new Z}function Je(e,t){var r=u(t.Y,t.X)-u(e.Y,e.X);return f<r?r-=2*f:r<-f&&(r+=2*f),r}function Qe(e,t){return c((t.X-e.X)*(t.X-e.X)+(t.Y-e.Y)*(t.Y-e.Y))}function $e(e){return D(e)<=2220446049250313e-31}function et(){}function tt(){var e=this;e.AN=0,e.BN=0,e.CN=1,e.DN=0,e.EN=0,e._process=0,e.FN=511,e.GN=new te,e.HN=20,e.IN=new K}function rt(e){return new Y(e?y(e.X):-1,e?y(e.Y):-1)}function nt(){this.FP=[]}function ot(e,t){this.BP=e,this.CP=t,this.UO=0,this.VO=0,this.AP=0,this.DP=c(e*e+t*t)}function it(e){this.zP=e,this.AP=0}function at(e){this.zP=e,this.AP=0}function st(e,t,r,n,o){e?this.qP=e:(this.xP=new Y(t,r),this.yP=n,this.lO=o)}function lt(){this.Jb=0,this.oI=0,this.pP=10,this.qP=[]}function ut(e,t){var r=e*t;return 4<r?r=4:r<.5&&(r=.5),r}function ct(e){this.kj=e}function ht(e,t){return W(-t/(e/t+1)+t+"")}function ft(e,t){return W(t*(-t/(e-t)-1)+"")}function dt(e,t,r,n,o,i){e.fillStyle=t,e.fillRect(r,n,o,i)}function pt(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m=e.am(),b=e._render,y=e.options.sheetAreaOffset,C=y.left,w=y.top,v=b.zI(!1),S=b.bm(),x=b.vI(),T=e.jt(1),A=mt(e),k=m.zr,M=1<=C?1:0,I=1<=w?1:0,E=je(m),R=e.Rt(-1),D=T.findRow(R);D&&(r=m.qt,0<(n=D.y-r-1-I)&&(t?(o=m.Br,dt(S,i=(g=ue.Im.Km(0,"gc-rowHeader-normal"))&&g.backgroundColor,k,r,o-1,n+1),dt(x,i,k,r,o-1,n+1),dt(S,v,k+o,r,E-o-A.width,n),dt(x,v,k+o,r,E-o-A.width,n)):(dt(S,v,k,r,E,n),dt(x,v,k,r,E,n)))),a=e.Rt(Ye(e),!0),(s=T.findRow(a))&&(r=s.y+Be(s),0<(n=m.ot-r-1-I)&&(dt(S,v,k,r,E,n),dt(x,v,k,r,E,n))),l=e.it(1),r=m.Ar,n=Be(m),u=e.Ot(-1),(c=l.findCol(u))&&(k=m.pt,0<(E=c.x-k-1-M)&&(t?(dt(S,f=function(e,t,r,n,o){var i,a,s,l,u,c=ue.Im.Km(0,"gc-columnHeader-normal"),h=c&&c.backgroundImage,f=c&&c.backgroundColor;if(h&&-1!==h.indexOf("linear-gradient"))for(a=ue.Ul.wl(h),i=e.createLinearGradient(t+n/2,r,t+n/2,r+o),s=0,l=a.length;s<l;s++)u=a[s],i.addColorStop(u.point,u.color);else f&&(i=f);return i}(S,k,r,E+1,(h=m.Cr)-1),k,r,E+1,h-1),dt(x,f,k,r,E+1,h-1),dt(S,v,k,r+h,E,n-h-A.height),dt(x,v,k,r+h,E,n-h-A.height)):(dt(S,v,k,r,E,n),dt(x,v,k,r,E,n)))),d=e.Ot(Ze(e),!0),(p=l.findCol(d))&&(k=p.x+je(p),0<(E=m.lt-k-1-M)&&(dt(S,v,k,r,E,n),dt(x,v,k,r,E,n)))}function gt(e,t,r,n,o,i){e.beginPath(),e.strokeStyle=t,e.moveTo(r,n),e.lineTo(o,i),e.stroke()}function mt(e){var t=e.options.sheetAreaOffset;return e.Gt&&e.Gt()||{x:t.left,y:t.top,width:0,height:0}}function bt(e,t){var r=0;return e||(r|=1),t||(r|=2),r}function yt(e){this.kj=e}function Ct(e,t,r,n,o){t===n&&r===o||(e._modelManager.setCellState(t,r,ue.CellStatesType.active,!1,ue.SheetArea.viewport),e.xIb&&e.xIb(ue.CellStatesType.active,t,r,ue.SheetArea.viewport),e._modelManager.setCellState(n,o,ue.CellStatesType.active,!0,ue.SheetArea.viewport),e.xIb&&e.xIb(ue.CellStatesType.active,n,o,ue.SheetArea.viewport))}function wt(e,t){var r,n=Le.call(this,t,ue.Ul.vl(e._host))||this,o=n;return o.JQ=32,o.KQ=45,o.LQ={},o.MQ=!1,o.OC=e,r=o.yo(),(o.NQ=r).addClass("gc-toolstrip-default ui-state-default well"),r.appendTo(o.zo()),r.hide(),o.OQ(),o.PQ(),o.QQ(),n}function vt(e,t,r){this.BQ=r,this.yM=new Ee(t),this.CQ=new be(t),this.DQ=new Re(e,"sheet",this.yM,100,10),this.BQ.xN(this.DQ,!0)}function St(e){this.KN=!1,this.hQ=new ge(e),this.iQ=new me(e),this.kj=e}function xt(e,t,r){var n,o;this.yM=new Ee(this),this.DQ=new Re(e,"tabStrip",this.yM,1,-1),this.BQ=r,this.CQ=new Ne(t),n=this.CQ,(o=this.DQ).eN=function(e){return n.lQ(e)},o.fN=function(e){return n.pQ(e)},o.hN=function(e){return n.qQ(e)},o.iN=function(e){return n.sQ(e)},o.jN=function(e){return n.yQ(e)}}function Tt(e){this.hq=e}function At(){}function kt(e){this.tc=e}function Mt(e){this.Cj=function(){for(var e=0,t="separator"+e;z.getElementById(t);)t="separator"+ ++e;return t}(),e&&(this.RQ=e)}function It(e,t,r,n,o){this._font="normal 12px Arial";this.Cj=e,this._text=t,this.fR=r,n&&(this.VQ=n),o&&(this.RQ=o)}function Et(e,t,r,n){var o=e.vu();o.ko(t)?r.drawImage(o.lo(t),n.x,n.y,je(n),Be(n)):o.fo(t)}function Rt(e){var t,r,n=O,o=Ve(e),i=o.length;return e.CH&&0<i&&(t=o[i-1],r=e.cm(t),n=new ue.Rect(r.x+je(r)-17,r.y+Be(r),17,20)),n}function Dt(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b=e.Er(t),y=e.Fr(r),C=e.am().Ft(b,y),w=(s=t,l=r,u=(a=e).Er(s),c=a.Fr(l),h=a.jt(u),f=a.it(c),(m=g=p=d=0)<h.length&&(d=h[0].row,p=h[h.length-1].row),0<f.length&&(g=f[0].col,m=f[f.length-1].col),ue.kf(d,g,p-d+1,m-g+1)),v=w.row<=t&&t<=w.row+w.rowCount-1&&C.y<=o&&o<=C.y+Be(C),S=w.col<=r&&r<=w.col+w.colCount-1&&C.x<=n&&n<=C.x+je(C);return i&&i.colCheck?S:(i&&i.rowCheck||S)&&v}function Nt(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S=Ve(e),x=[];if(e.CH&&0<S.length)for(t=S[S.length-1],r=e.cm(t),n=e.am(),o=t.row,i=t.row+t.rowCount-1,a=t.col,s=t.col+t.colCount-1,-1!==t.row&&-1!==t.col?(Dt(e,o,a,r.x,r.y)&&(x[0]=new ue.Rect(r.x-8,r.y-8,16,16)),Dt(e,i,s,r.x+je(r),r.y+Be(r))&&(x[1]=new ue.Rect(r.x+je(r)-8,r.y+Be(r)-8,16,16))):-1!==t.row?(l=n.Ft(1,0),u=n.Ft(1,1),c=l.x+(je(l)+je(u))/2-8,h=Ze(e)-1-ze(e),(d=(f=e.it(1)).findCol(h))&&((p=e.it(0)[0]||f[0])&&(c=p.x+(d.x+je(d)-p.x)/2-8)),Dt(e,o,a,c+8,r.y,{rowCheck:!0})&&(x[0]=new ue.Rect(c,r.y-8,16,16)),Dt(e,i,s,c+8,r.y+Be(r),{rowCheck:!0})&&(x[1]=new ue.Rect(c,r.y+Be(r)-8,16,16))):-1!==t.col&&(l=n.Ft(0,1),u=n.Ft(1,1),g=l.y+(Be(l)+Be(u))/2-8,m=Ye(e)-1-qe(e),(y=(b=e.jt(1)).findRow(m))&&((C=e.jt(0)[0]||b[0])&&(g=C.y+(y.y+Be(y)-C.y)/2-8)),Dt(e,o,a,r.x,g+8,{colCheck:!0})&&(x[0]=new ue.Rect(r.x-8,g,16,16)),Dt(e,i,s,r.x+je(r),g+8,{colCheck:!0})&&(x[1]=new ue.Rect(r.x+je(r)-8,g,16,16))),w=void 0,v=x.length-1;0<=v;v--)(!(w=x[v])||w.x<0||w.y<0)&&(x[v]=O);return x}Object.defineProperty(t,"__esModule",{value:!0}),E=r("@grapecity/js-sheets-common"),ue=r("Core"),n=r("./dist/plugins/touch/touch.res.en.js"),t.SR={en:n},L=E.Common.j.Fa,o=ue.Go,(R=ue.GC$).extend,i=R.isEmptyObject,b=ue.Ul.Nl,h=ue.Ul.nl,l=ue.Ul.Ml.mozilla,ce=ue.Im.Lm,a=ue.Ul.rl(),_=a.ipad,s=_||a.iphone,O=null,B=void 0,D=Math.abs,he=Math.min,fe=Math.max,C=Math.pow,u=Math.atan2,f=Math.PI,y=Math.round,c=Math.sqrt,d=Math.atan,w=Math.log,v=Math.floor,p="touch",N="none",F="MSPointerDown",P="MSPointerMove",j="MSPointerUp",H="pointerdown",G="pointermove",U="touchstart",g="MSPOINTER_TYPE_TOUCH",m=isNaN,W=parseInt,S=parseFloat,V=window,z=document,x=V.Yl,T="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",A="AAAAAElFTkSuQmCC",ue.Rxb.touch=!0,k=new E.Common.ResourceManager(t.SR),M=k.getResource.bind(k),Xe.prototype.vM=function(e){this.tM.vM=e},Xe.prototype.wM=function(e){this.tM.wM=e},Xe.prototype.xM=function(r){var n=this;n.tM.xM=function(e){if(r){r(e);var t=n.yM;t&&t.zM()}}},Xe.prototype.AM=function(e){this.tM.AM=e},Xe.prototype.BM=function(e){this.tM.BM=e},Xe.prototype.CM=function(e){this.uM.CM=e},Xe.prototype.DM=function(e){this.uM.DM=e},Xe.prototype.EM=function(e){this.uM.EM=e},Xe.prototype.FM=function(e){this.GM=e},Xe.prototype.HM=function(e){this.IM=e},Xe.prototype.JM=function(e,t){var r=t?t.KM:this.LM.KM;return ue.Ul.Z3(e,r)},Xe.prototype.MM=function(e,t){var r,n,o,i,a,s=t.pointerType,l=t.target,u=t.offsetX,c=t.offsetY;s!==t[g]&&s!==p||(n=(r=this.JM(l,e)).EB,o=r.FB,this.NM(e,l,t.pointerId,new Y(u+n,c+o),t.timeStamp)&&h(t),"sheet"===this.LM.OM&&(i=t.pageX-(u+n),a=t.pageY-(c+o),this.LM.KM.canvasOffset={top:a,left:i}))},Xe.prototype.PM=function(e){var t,r=e.pointerType,n=e.pointerId;if(r===e[g]||r===p){if(this.sM[n]===B)return!1;t=this.JM(e.target),this.aB(n,new Y(e.offsetX+t.EB,e.offsetY+t.FB),e.timeStamp)&&h(e)}},Xe.prototype.QM=function(e){var t,r=e.pointerType,n=e.pointerId;if(r===e[g]||r===p){if(this.sM[n]===B)return!1;t=this.JM(e.target),this.RM(n,new Y(e.offsetX+t.EB,e.offsetY+t.FB))&&h(e)}},Xe.prototype.SM=function(e){var t,r=e.pointerType,n=e.pointerId;if(r===e[g]||r===p){if(this.sM[n]===B)return!1;t=this.JM(e.target),this.TM(n,new Y(e.offsetX+t.EB,e.offsetY+t.FB))&&h(e)}},Xe.prototype.UM=function(e,t){var r,n,o,i=Ke(e.KM),a=t.changedTouches,s=!1;for(r=0;r<a.length;r++)n=a[r],o=l?Ge():t.timeStamp,s=this.NM(e,t.target,n.identifier,new Y(n.pageX-i.EB,n.pageY-i.FB),o)||s;s&&h(t)},Xe.prototype.VM=function(e){var t,r,n,o=Ke(this.LM.KM),i=e.changedTouches,a=!1;for(t=0;t<i.length;t++)r=i[t],n=l?Ge():e.timeStamp,a=this.aB(r.identifier,new Y(r.pageX-o.EB,r.pageY-o.FB),n)||a;a&&h(e)},Xe.prototype.WM=function(e){var t,r,n=Ke(this.LM.KM),o=e.changedTouches,i=!1;for(t=0;t<o.length;t++)r=o[t],i=this.RM(r.identifier,new Y(r.pageX-n.EB,r.pageY-n.FB))||i;i&&h(e)},Xe.prototype.XM=function(e){var t,r,n=Ke(this.LM.KM),o=e.changedTouches,i=!1;for(t=0;t<o.length;t++)r=o[t],i=this.TM(r.identifier,new Y(r.pageX-n.EB,r.pageY-n.FB))||i;i&&h(e)},Xe.prototype.YM=function(e){var t,r,n=this.LM,o=this.ZM;n!==o&&(t=R(n.KM).offset(),r=R(o.KM).offset(),e.X+=t.left-r.left,e.Y+=t.top-r.top)},Xe.prototype.$M=function(e,t){var r,n,o,i,a,s=this,l=s.rM;for(s.ZM=O,s.yM=O,n=0;n<l.length;n++)if(l[n]===e){if(o=l[n],a=i=O,o._M&&!o._M()){for(n=0;n<l.length;n++)if((r=l[n])!==o&&0<=r.aN&&r.aN<o.aN&&(!r._M||r._M())){i=r;break}if(i===O)return!1}if(o.bN&&!o.bN()){for(n=0;n<l.length;n++)if((r=l[n])!==o&&0<=r.aN&&r.aN<o.aN&&(!r.bN||r.bN())){a=r;break}if(a===O)return!1}i===O&&(i=o),a===O&&(a=o),s.LM=o,s.ZM=i,s.cN=a,s.vM(a.dN||O),s.wM(i.eN||O),s.BM(i.fN||O),s.AM(i.gN||O),s.xM(i.hN||O),s.CM(a.iN||O),s.DM(a.jN||O),s.EM(a.kN||O),s.FM(i.GM||O),s.HM(i.IM||O),i.lN&&(s.yM=o.lN);break}return!0},Xe.prototype.NM=function(e,t,r,n,o){var i=this;return!(i.sM[r]!==B||0===i.sM.length&&!i.$M(e,t)||!i.ZM||!(i.sM.length>=i.ZM.mN)&&(i.yM&&i.yM.nN()||(i.YM(n),i.yM&&0===i.sM.length&&i.yM.oN(),i.sM[r]={id:r,time:Ge(),position:n},i.sM.length++,i.tM.pN(t,r,n,o),i.tM.qN(r,n,i.sM.length,o),1===i.sM.length&&i.uM.qN(n),1===i.sM.length&&i.GM&&i.GM({rN:n}),0)))},Xe.prototype.aB=function(e,t,r){return!(this.sM[e]===B||this.yM&&this.yM.sN()||(this.YM(t),this.sM[e]={id:e,time:Ge(),position:t},this.tM.tN(e,t,r),0))},Xe.prototype.RM=function(e,t){var r=this;return r.sM[e]!==B&&(delete r.sM[e],r.sM.length--,!(r.yM&&r.yM.uN()||(r.YM(t),r.tM.vN(e),r.tM.wN(),0===r.sM.length&&(r.uM.vN(t),r.uM.wN()),0===r.sM.length&&r.IM&&r.IM({rN:t}),r.yM&&0===r.sM.length&&0===r.tM._process&&r.yM.zM(),0)))},Xe.prototype.TM=function(e,t){return this.RM(e,t)},Xe.prototype.xN=function(t,e){var r,n,o,i,a,s=this,l="."+t.OM,u=".gcSheet",c=F+u,h=P+u+l,f=j+u+l,d="MSPointerCancel"+u+l,p="MSLostPointerCapture"+u+l,g=H+u,m=G+u+l,b="pointerup"+u+l,y="LostPointerCapture"+u+l,C="pointercancel"+u+l,w=U+u,v="touchmove"+u,S="touchend"+u,x="touchcancel"+u;function T(){R(z).unbind(h).unbind(m).unbind(f).unbind(b).unbind(d).unbind(C).unbind(p).unbind(y)}function A(e){R(z).bind(h,k).bind(f,M).bind(m,k).bind(b,M).bind(d,I).bind(p,I).bind(y,I).bind(C,I),s.MM(t,e)}function k(e){s.PM(e)}function M(e){s.QM(e),0===s.sM.length&&T()}function I(e){s.SM(e),0===s.sM.length&&T()}r=t.KM,n=s.rM,0<=(o=E.Common.k.Cb(n,t))&&e||o<0&&!e||(i=ue.Ul._Va(),e?i?(a=r.style,L(a.msTouchAction)||(a.msTouchAction=N),L(a.touchAction)||(a.touchAction=N),R(r).bind(c,A).bind(g,A)):(R(r).bind(w,function(e){s.UM(t,e)}),R(r).bind(v,function(e){s.VM(e)}).bind(S,function(e){s.WM(e)}).bind(x,function(e){s.XM(e)})):i?R(r).unbind(c).unbind(g):R(r).unbind(w).unbind(v).unbind(S).unbind(x),e?n.push(t):n.splice(o,1))},Xe.prototype.no=function(){var e,t=this.rM;for(e=t.length-1;0<=e;e--)this.xN(t[e],!1)},I=Xe,t.TouchEventProvider=I,tt.prototype.pN=function(e,t,r,n){var o,i=this;3===i._process&&i.JN(!0),i.KN=2===i._process&&1===i.GN.MN(),i.NN=e,(o={}).Np=t,o.ON=r,o.PN=r,i.GN.QN(o),i.RN=n,1<i.GN.MN()&&(i.SN=!1,i.TN=!1,1===i._process&&i.UN())},tt.prototype.qN=function(e,t,r,n){0===this._process&&1===r&&this.VN(this.GN.WN(0).PN)},tt.prototype.tN=function(e,t,r){var n,o,i,a,s,l,u,c=this;if(0!==c.FN&&c.GN.XN(e)){if(1===c._process&&1===c.GN.MN()){if(n=c.YN(),!c.ZN(1)&&!c.ZN(2)&&!n)return;if(Ue(t,o=c.GN.$N(e).PN))return;i=D(t.X-o.X),a=D(t.Y-o.Y),c._N(i,a)}if(!(r-c.RN<20)){if(c.GN.$N(e).aO=t,1<(s=c.GN.MN()))for(l=0;l<s;l++)if(!(u=c.GN.WN(l)).aO)return;for(c.bO(r),c.RN=r,s=c.GN.MN(),l=0;l<s;l++)(u=c.GN.WN(l)).ON=u.aO,u.aO=O}}},tt.prototype.wN=function(){this.cO&&(this.dO(this.cO),this.cO=O)},tt.prototype.vN=function(e){var t=this;t.GN.XN(e)&&(t.GN.eO(e),2===t._process?0===t.GN.MN()&&(t.ZN(64)||t.ZN(256)||t.ZN(128)?t.fO():t.JN(!0)):3===t._process?t.JN(!0):1===t._process&&t.JN(!1))},tt.prototype.bO=function(e){var t,r,n,o,i=this,a=i.gO(),s=a.hO,l=a.iO,u=a._position,c=i.jO(),h=c.kO,f=c.eb,d=c.lO;if(i.AN+=s,i.BN+=l,i.CN*=f,i.DN+=h,i.EN+=d,(t={}).lO=d,t.kO=h,t.mO=e-i.RN,t.hO=s,t.iO=l,i.IN.nO(t),i.oO=u,1===i._process||2===i._process){if(1===i._process&&i.UN())return;if((r=new ee).pO=d,r.qO=h,r.rO=f,r.sO=new Y(s,l),n=new X(i.IN),o=new oe(i.NN,i.tO(),r,!1,u,n),i.uO(o),o.vO)return void i.JN(!0)}},tt.prototype.UN=function(){var e;return this._process=2,e=new ae(this.NN,this.GN.MN(),this.tO(),this.GN.WN(0).PN),this.wO(e),!!e.vO&&(this.JN(!0),!0)},tt.prototype._N=function(e,t){var r,n,o,i,a,s=(n=t,a=i=!1,0===(r=e)||(o=d(n/r)/f*180)<20&&(i=!0),(0===r||75<(o=d(n/r)/f*180)&&o<105)&&(a=!0),{yN:i,zN:a});this.SN=s.yN,this.TN=s.zN},tt.prototype.gO=function(){var e=this.xO(),t=e.yO,r=e.zO,n=new Y(t.X,t.Y);return{hO:t.X-r.X,iO:t.Y-r.Y,_position:n}},tt.prototype.jO=function(){var e,t,r,n,o,i,a,s,l,u=0,c=1,h=0;return this.ZN(16)&&1===this.GN.MN()&&this.YN()&&(t=this.GN.WN(0).aO,r=this.GN.WN(0).ON,n=this.AO,o=new Y(n._Center.X,n._Center.Y),i=new Y(r.X-o.X,r.Y-o.Y),a=new Y(t.X-o.X,t.Y-o.Y),s=he(1,C(Qe(r,o)/n._Radius,4)),l=Je(i,a),u=m(l)?0:l*s),1<this.GN.MN()&&(u=(e=this.BO()).kO,c=e.eb,h=e.lO),{kO:u=u/f*180,eb:c,lO:h}},tt.prototype.BO=function(){var e,t,r,n,o,i,a,s,l,u,c=this,h=c.xO(),f=h.yO,d=h.zO,p=c.YN(),g=p?c.AO._Center:new Y(0,0),m=0,b=1,y=0,C=0,w=0,v=0,S=0,x=c.GN.MN();for(e=0;e<x;e++)r=(t=c.GN.WN(e)).aO,n=t.ON,o=Qe(r,f),i=Qe(n,d),a=p?new Y(n.X-g.X,n.Y-g.Y):new Y(n.X-d.X,n.Y-d.Y),s=p?new Y(r.X-g.X,r.Y-g.Y):new Y(r.X-f.X,r.Y-f.Y),l=Qe(n,g),u=Qe(r,g),i>=c.HN&&o>=c.HN&&(w++,v+=o,S+=i,(!p||l>=c.HN)&&u>=c.HN&&(m+=Je(a,s),C++));return 0<C&&c.ZN(16)?m/=C:m=0,0<w&&c.ZN(32)?(c.KN||(b=v/S),y=(v-S)/w,c.CO=v/w):c.CO=0,{kO:m,eb:b,lO:y}},tt.prototype.ZN=function(e){return 0!=(this.FN&e)},tt.prototype.xO=function(){var e,t,r,n,o,i=0,a=0,s=0,l=0,u=this.GN,c=u.MN();for(e=0;e<c;e++)r=(t=u.WN(e)).ON,n=t.aO,i+=r.X,a+=r.Y,s+=n.X,l+=n.Y;return o=new Y(i/c,a/c),{yO:new Y(s/c,l/c),zO:o}},tt.prototype.YN=function(){var e=this.AO;return e&&!m(e._Radius)},tt.prototype.VN=function(e){var t=new se(this.NN,this.FN,O,e);return t.DO=511,this.EO(t),this.FO=t.DO,0===t.DO?(this.JN(!1),!1):(this.FN=t.DO,this.AO=t.GO,this._process=1,!0)},tt.prototype.JN=function(e){var t,r=this,n=3===r._process;r._process=0,r.HO&&(He(r.HO),r.HO=O),e&&(t=new ne(r.NN,r.tO(),n,rt(r.oO),new X(r.IN)),3===r._process?r.cO=t:r.dO(t)),r.IN.IO(),r.GN.IO(),r.AO=O,r.AN=0,r.BN=0,r.CN=1,r.DN=0,r.EN=0,r.SN=!1,r.TN=!1,r.FN=0},tt.prototype.fO=function(){var e,t,r=this,n={},o=new X(r.IN);return n.JO=r.ZN(64)?o.KO().X:0,n.LO=r.ZN(64)?o.KO().Y:0,n.MO=r.ZN(256)?o.pO():0,n.NO=r.ZN(128)?o.OO():0,0===n.JO&&0===n.LO&&0===n.MO&&0===n.NO?void r.JN(!0):(n.PO=new $(n.JO,n.LO),n.QO=new J(n.MO),n.RO=new Q(n.NO),o=new X(O,n.JO,n.LO,n.NO,n.MO),e=new ie(r.NN,r.tO(),new ee,o,n.QO,n.RO,n.PO),r.SO(e),n.PO=e.TO,n.QO=e.QO,n.RO=e.RO,n.PO.UO<=0&&n.PO.VO<=0&&n.PO.WO(.003),n.QO.XO()<=0&&n.QO.WO(.002),n.RO.XO()<=0&&n.RO.WO(.003),t=Ge(),n.YO=t,n.ZO=t,n.$O=0,n._O=0,r._process=3,void(r.HO=V.setInterval(function(){try{r.aP(n)}catch(e){}},20)))},tt.prototype.aP=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p=this,g=Ge(),m=g-e.ZO;if(0!=m){if(t=e.JO,r=e.LO,n=e.MO,o=e.NO,e.JO=p.bP(m,e.PO.UO,e.JO),e.LO=p.bP(m,e.PO.VO,e.LO),e.MO=p.bP(m,e.QO.XO(),e.MO),e.NO=p.bP(m,e.RO.XO(),e.NO),t=(t+e.JO)/2,r=(r+e.LO)/2,n=(n+e.MO)/2,o=(o+e.NO)/2,e.ZO=g,i=!1,$e(t)&&$e(r)&&$e(n)&&$e(o)&&(i=!0),a=m*t,s=m*r,l=m*n,u=m*o,c=1,0<p.CO&&(p.CO+2*l<0&&(l=-p.CO/2+1),0!==p.CO&&(c=(p.CO+2*l)/p.CO)),p.EN+=l,p.DN+=u,p.AN+=a,p.BN+=s,p.CN*=c,p.CO+=l,p.oO=new Y(p.oO.X+a,p.oO.Y+s),e.$O+=a,e._O+=s,i){if(a=y(e.$O),s=y(e._O),$e(a)&&$e(s))return void p.JN(!0)}else 1<=D(e.$O)&&(a=e.$O,e.$O-=a),1<=D(e._O)&&(s=e._O,e._O-=s);return(h=new ee).sO=new Y(a,s),h.rO=c,h.pO=l,h.qO=u,f=new X(O,e.JO,e.LO,e.NO,e.MO),d=new oe(p.NN,p.tO(),h,!0,rt(p.oO),f),p.uO(d),d.vO?void p.JN(!0):void(i&&p.JN(!0))}},tt.prototype.bP=function(e,t,r){return $e(r)?0:(((n=r<0?r+t*e:r-t*e)<0&&0<r||0<n&&r<0)&&(n=0),n);var n},tt.prototype.tO=function(){var e=new ee;return e.pO=this.EN,e.qO=this.DN,e.rO=this.CN,e.sO=new Y(this.AN,this.BN),e},tt.prototype.cP=function(e,t,r,n){var o,i=this,a=new ee,s=new ee,l=0,u=0,c=0,h=0,f=i.ZN(4)&&i.SN,d=i.ZN(8)&&i.TN;return!i.ZN(1)||d||e&&!i.ZN(64)||(a.sO.X=t.sO.X,s.sO.X=r.sO.X,l=n.KO().X),!i.ZN(2)||f||e&&!i.ZN(64)||(a.sO.Y=t.sO.Y,s.sO.Y=r.sO.Y,u=n.KO().Y),!i.ZN(32)||e&&!i.ZN(256)?(a.rO=t.rO,s.rO=1):(a.rO=t.rO,a.pO=t.pO,s.rO=r.rO,s.pO=r.pO,h=n.pO()),!i.ZN(16)||e&&!i.ZN(128)||(a.qO=t.qO,s.qO=r.qO,c=n.OO()),o=new X(O,l,u,c,h),new re(a,s,o)},tt.prototype.EO=function(e){this.vM&&e&&this.vM(e)},tt.prototype.wO=function(e){this.wM&&e&&this.wM(e)},tt.prototype.dO=function(e){var t;this.xM&&e&&(t=this.cP(!1,e.dP,e.dP,e.eP),e.dP=t.dP,e.eP=t.eP,this.xM(e))},tt.prototype.SO=function(e){var t;this.AM&&e&&(t=this.cP(!1,e.dP,e.fP,e.eP),e.dP=t.dP,e.fP=t.fP,e.eP=t.eP,this.AM(e))},tt.prototype.uO=function(e){var t;this.BM&&e&&(t=this.cP(e.gP,e.dP,e.fP,e.eP),e.dP=t.dP,e.fP=t.fP,e.eP=t.eP,this.BM(e))},q=tt,et.prototype.qN=function(e){var t,r=this;r._pointerCount++,1<r._pointerCount||(t=Ge(),r.hP&&Ue(e,r.hP)&&t-r.iP<400?r.Jb++:(r.hP=e,r.Jb=1),r.jP=e,r.iP=t)},et.prototype.wN=function(){this.cO&&(this.cO instanceof le?this.kP(this.cO):this.cO instanceof de&&this.lP(this.cO),this.cO=O)},et.prototype.vN=function(e){var t,r=this;r._pointerCount--,0<r._pointerCount||(t=Ge(),Ue(e,r.jP)?1e3<t-r.iP?r.cO=new de(r.jP):1<r.Jb?(r.Jb=0,r.mP(new pe(r.hP)),r.hP=O):r.cO=new le(r.jP):r.hP=O)},et.prototype.nP=function(){this.hP=O},et.prototype.kP=function(e){this.CM&&e&&this.CM(e)},et.prototype.mP=function(e){this.DM&&e&&this.DM(e)},et.prototype.lP=function(e){this.EM&&e&&this.EM(e)},Z=et,Y=function(e,t){this.X=e,this.Y=t},t.oP=Y,lt.prototype.rP=function(e){var t,r,n,o,i,a;if(0===this.Jb)return 0;for(t=0,r=(1+this.Jb)*this.Jb/2,n=this.Jb-1;0<=n;n--)o=0,i=this.sP(n),0===e?o=i.hO:1===e?o=i.iO:2===e?o=i.lO:3===e&&(o=i.kO),a=this.tP(o,i.mO),t+=a*=n+1;return t/r},lt.prototype.tP=function(e,t){return e/t},lt.prototype.sP=function(e){return this.qP[this.uP(e)]},lt.prototype.vP=function(){return this.qP[this.Jb-1]},lt.prototype.nO=function(e){var t,r,n=this;for(10===n.Jb&&n.wP(),n.Jb++,n.qP[n.uP(n.Jb-1)]=e,t=20*n.pP,r=0;r<n.Jb;r++)e.mO-n.qP[r].mO>t&&(n.wP(),r--)},lt.prototype.wP=function(){this.oI++,this.oI===this.pP&&(this.oI=0),this.Jb--},lt.prototype.IO=function(){this.Jb=0},lt.prototype.uP=function(e){return(this.oI+e)%this.pP},K=lt,st.prototype.KO=function(){return this.xP||(this.xP=new Y(this.qP.rP(0),this.qP.rP(1))),this.xP},st.prototype.OO=function(){return L(this.yP)&&(this.yP=this.qP.rP(3)),this.yP},st.prototype.pO=function(){return L(this.lO)&&(this.lO=this.qP.rP(2)),this.lO},X=st,at.prototype.XO=function(){var e=this._DesiredExpansion,t=this._DesiredDeceleration,r=this.zP;return m(e)||0===e?m(t)?this.AP:t:.5*r*r/e},at.prototype.WO=function(e){this.AP=e},J=at,it.prototype.XO=function(){var e=this._DesiredRotation,t=this._DesiredDeceleration,r=this.zP;return m(e)||0===e?m(t)?this.AP:t:.5*r*r/e},it.prototype.WO=function(e){this.AP=e},Q=it,ot.prototype.EP=function(){var e=this,t=e._DesiredDisplacement,r=e.DP,n=e.BP,o=e.CP,i=e.XO();m(t)||0===t?m(i)||0===i?(e.UO=0,e.VO=0):(e.UO=i*D(n)/r,e.VO=i*D(o)/r):(e.UO=.5*r*D(n)/t,e.VO=.5*r*D(o)/t)},ot.prototype.XO=function(){var e=this._DesiredDeceleration;return m(e)&&m(this._DesiredDisplacement)?this.AP:e},ot.prototype.WO=function(e){this.AP=e,this.EP()},$=ot,ee=function(){this.sO=new Y(0,0),this.rO=0,this.qO=0,this.pO=0},nt.prototype.XN=function(e){var t,r=this.FP;for(t=0;t<r.length;t++)if(r[t].Np===e)return!0;return!1},nt.prototype.QN=function(e){this.FP.push(e)},nt.prototype.eO=function(e){var t,r=this.FP;for(t=0;t<r.length;t++)if(r[t].Np===e){r.splice(t,1);break}},nt.prototype.MN=function(){return this.FP.length},nt.prototype.WN=function(e){return this.FP[e]},nt.prototype.$N=function(e){var t,r,n=this.FP;for(t=0;t<n.length;t++)if((r=n[t]).Np===e)return r;return O},nt.prototype.IO=function(){var e=this.FP;e.splice(0,e.length)},te=nt,re=function(e,t,r){this.dP=e,this.fP=t,this.eP=r},ne=function(e,t,r,n,o){this.GP=e,this.dP=t,this.gP=r,this.rN=n,this.eP=o},t.ManipulationCompletedEventArgs=ne,oe=function(e,t,r,n,o,i){this.GP=e,this.dP=t,this.fP=r,this.gP=n,this.rN=o,this.eP=i},t.ManipulationDeltaEventArgs=oe,ie=function(e,t,r,n,o,i,a){this.GP=e,this.dP=t,this.fP=r,this.eP=n,this.QO=o,this.RO=i,this.TO=a},ae=function(e,t,r,n){this.GP=e,this.HP=t,this.dP=r,this.rN=n},t.ManipulationStartedEventArgs=ae,se=function(e,t,r,n){this.GP=e,this.DO=t,this.GO=r,this.rN=n},t.ManipulationStartingEventArgs=se,le=function(e){this.rN=e},de=function(e){this.rN=e},pe=function(e){this.rN=e},ct.prototype.IP=function(e,t){var r=this.Xs;return r?e===ue.En.Nn(r)&&t===ue.En.On(r)||ue.En.Pn(r,e,t):(r=b("canvas"),ue.En.Kn(r,O,this.kj),ue.En.Pn(r,e,t)),r},ct.prototype.JP=function(e,t,r,n){var o=ue.En.Nn(e),i=ue.En.On(e),a=this.IP(o,i),s=a.getContext("2d"),l=ue.En.Ln(a),u=ue.En.Mn(a);ue.Bn.Cn(s,1,1),s.drawImage(e,0,0,je(a),Be(a),0,0,je(a),Be(a)),ue.Bn.Cn(s,l,u),this.Xs=a,this.KP=t,this.LP=r,this.MP=n},ct.prototype.NP=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d=this.kj,p=ue.En.Nn(e),g=ue.En.On(e),m=ze(d),b=qe(d),y=0<m?1:0,C=0<b?1:0,w=this.LP,v=mt(d),S=this.KP,x=d.am(),T=t/this.MP,A=e.getContext("2d"),k=ue.En.Ln(e),M=ue.En.Mn(e),I=this.Xs;A.save(),A.fillStyle=r,A.fillRect(0,0,p,g),h=d.rowOutlines,f=d.columnOutlines,h&&h.jp(d,A,O,!0),f&&f.jp(d,A,O,!1),n=w.x+je(w),o=w.y+Be(w),i=S.lt-n-y,a=S.ot-o-C,s=v.x+je(v),l=v.y+Be(v),u=i*T,c=a*T,n*=k,o*=M,i*=k,a*=M,s*=k,l*=M,u*=k,c*=M,ue.Bn.Cn(A,1,1),A.drawImage(I,n,o,i,a,s,l,u,c),0<m&&(n=S.lt-y,o=w.y+Be(w),i=S.js+y,a=S.ot-o-C,s=x.lt-y,l=v.y+Be(v),u=x.js+y,c=a*T,n*=k,o*=M,i*=k,a*=M,s*=k,l*=M,u*=k,c*=M,A.drawImage(I,n,o,i,a,s,l,u,c)),0<b&&(n=w.x+je(w),o=S.ot-C,i=S.lt-n-y,a=S.gs+C,s=v.x+je(v),l=x.ot-C,u=i*T,c=x.gs+C,n*=k,o*=M,i*=k,a*=M,s*=k,l*=M,u*=k,c*=M,A.drawImage(I,n,o,i,a,s,l,u,c)),0<m&&0<b&&(n=S.lt-y,o=S.ot-C,i=S.js+y,a=S.gs+C,s=x.lt-y,l=x.ot-C,u=x.js+y,c=x.gs+C,n*=k,o*=M,i*=k,a*=M,s*=k,l*=M,u*=k,c*=M,A.drawImage(I,n,o,i,a,s,l,u,c)),ue.Bn.Cn(A,k,M),A.restore()},ct.prototype.OP=function(){var e=this.kj,t=e.zoom(),r=e._render.vI();r&&this.JP(r.canvas,e.am(),mt(e),t)},ct.prototype.PP=function(e){var t,r,n,o,i,a,s=this.kj;if(s.endEdit()&&(t=ut(e,this.MP),r=s.zoom(),n=s.name(),r!==t)){if(o={sheet:s,sheetName:n,oldZoomFactor:r,newZoomFactor:t,cancel:!1},s.Wq(ue.Events.ViewZooming,o),!0===o.cancel)return;t=o.newZoomFactor,s.XSa(t),s.Wq(ue.Events.UserZooming,{sheet:s,sheetName:n,oldZoomFactor:r,newZoomFactor:t}),s.Wq(ue.Events.ViewZoomed,{sheet:s,sheetName:n,oldZoomFactor:r,newZoomFactor:t}),s.invalidateLayout(),(a=(i=s._render).bm())&&this.NP(a.canvas,t,i.zI(!1)),s.QP&&s.QP(O,t),s.RP&&s.RP(O)}},ct.prototype.SP=function(e){var t,r=this.kj,n=r.name(),o=ut(e,this.MP),i=r.zoom();if(o!==i){if(t={sheet:r,sheetName:n,oldZoomFactor:i,newZoomFactor:o,cancel:!1},r.Wq(ue.Events.ViewZooming,t),!0===t.cancel)return;o=t.newZoomFactor,r.XSa(o),r.Wq(ue.Events.UserZooming,{sheet:r,sheetName:n,oldZoomFactor:i,newZoomFactor:o}),r.Wq(ue.Events.ViewZoomed,{sheet:r,sheetName:n,oldZoomFactor:i,newZoomFactor:o})}r.oq=!0,r.jq=!0,r.$p()},ge=ct,t.TP=ge,yt.prototype.VP=function(e){this.kj.eCb=e},yt.prototype.WP=function(e){this.kj.cCb=e},yt.prototype.XP=function(){this.kj.invalidateLayout()},yt.prototype.ju=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=this,v=w.kj,S=v.options,x=function(e,t,r){var n,o,i=r,a=0,s=0,l=e.ss,u=e.am().qt,c=e.jt(1).findRow(i);if(c)if(0<t){for(n=e.Rt(-1),a=u-c.y;n<i&&a<t;)i--,a+=l.Sl(i);s=t-a}else if(t<0){for(o=e.ns(),a=-(c.y+Be(c)-u);i<o&&t<a;)i++,a-=l.Sl(i);s=t-a}return{cj:i,UP:s}}(v,e,v.lq),T=x.cj,A=x.UP;if(v.lq=T,0<v.Xq)return!1;if(o=v.Dr(),a=(i=v.am()).qt,s=i.jr,l=o?o.x:i.x,u=je(i),u+=(d=S.sheetAreaOffset).left,e<0)w.YP=0,g=p=void(w.ZP=0),(m=v.jt(1))&&0<m.length&&(p=m.findRow(T)),p&&(g=m[m.length-1]).row>=T&&(c=2+d.top,h=a+D(e),0<=(f=he(a+s,g.y+Be(g))-h)&&(f-=c,w.WP(A-Be(p)),r.x=l,r.y=h,r.width=u,r.height=f,r.tx=l,r.ty=a,n.x=l,n.y=a+f,n.width=u,n.height=s-f));else if(0<e){if(b=v.Rt(-1),C=y=void 0,v.parent&&v.parent.options.scrollByPixel&&0<A&&(e-=A,A=0),T===b&&0<A)if(0<w.YP&&0<w.ZP){if(A=C=ht(y=w.YP+e,200),(e=C-w.ZP)<=0)return t;if(t&&20<=C)return!0;w.YP=y,w.ZP=C}else{if(200<=A&&(e-=A-199,A=199,e<=0))return t;if(y=ft(A,200),C=A,t&&20<=C)return!0;w.YP=y,w.ZP=C}else w.YP=0,w.ZP=0;e<s&&(c=2+d.top,h=a,f=s-e,0<qe(v)&&--f,w.WP(A),r.x=l,r.y=h,r.width=u,r.height=f,r.tx=l,r.ty=h+e,n.x=l,n.y=h,n.width=u,n.height=e+c)}return!1},yt.prototype.lu=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=this,v=w.kj,S=function(e,t,r){var n,o,i=r,a=0,s=0,l=e.ss,u=e.am().pt,c=e.it(1).findCol(i);if(c)if(0<t){for(n=e.Ot(-1),a=u-c.x;n<i&&a<t;)i--,a+=l._m(i);s=t-a}else if(t<0){for(o=e.ps(),a=-(c.x+je(c)-u);i<o&&t<a;)i++,a-=l._m(i);s=t-a}return{dj:i,UP:s}}(v,e,v.qq),x=S.dj,T=S.UP;if(v.qq=x,0<v.Xq)return!1;if(o=v.Dr(),a=(i=v.am()).pt,s=i.er,l=o?o.y:i.y,u=Be(i),u+=(g=v.options.sheetAreaOffset).top,e<0)w.$P=0,b=m=void(w._P=0),(y=v.it(1))&&0<y.length&&(m=y.findCol(x)),m&&(b=y[y.length-1]).col>=x&&(c=2+g.left,h=a+D(e),0<=(f=he(a+s,b.x+je(b))-h)&&(f-=c,w.VP(T-je(m)),r.x=h,r.y=l,r.width=f,r.height=u,r.tx=a,r.ty=l,n.x=a+f,n.y=l,n.width=s-f,n.height=u));else if(0<e){if(C=v.Ot(-1),v.parent&&v.parent.options.scrollByPixel&&0<T&&(e-=T,T=0),x===C&&0<T)if(0<w.$P&&0<w._P){if(T=p=ht(d=w.$P+e,200),(e=p-w._P)<=0)return t;if(t&&20<=p)return!0;w.$P=d,w._P=p}else{if(200<=T&&(e-=T-199,T=199,e<=0))return t;if(d=ft(T,200),p=T,t&&20<=p)return!0;w.$P=d,w._P=p}else w.$P=0,w._P=0;e<s&&(c=2+g.left,h=a,f=s-e,0<ze(v)&&--f,w.VP(T),r.x=h,r.y=l,r.width=f,r.height=u,r.tx=h+e,r.ty=l,n.x=h,n.y=l,n.width=e+c,n.height=u)}return!1},yt.prototype.aQ=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re=this.kj,ne=!0,oe=!0,ie=re._render,ae=ie.bm(),se=0!=(2&r),le=0!=(1&r);if(le||se)return l=re.Dr(),u=re.am(),c=l?l.y:u.y,h=Be(u),f=l?l.x:u.x,d=je(u),se&&(i={},o={},ne=this.ju(t,n,o,i),ie.Ow(o.x,o.y,je(o),Be(o),o.tx,o.ty)),le&&(a={},s={},oe=this.lu(e,n,a,s),ie.Ow(a.x,a.y,je(a),Be(a),a.tx,a.ty),se||(i=s)),(p=re.parent)&&!p.options.scrollbarShowMax&&(le&&(re.oq=!0),se&&(re.jq=!0)),this.XP(),g=re.rowOutlines&&!re.rowOutlines.iT()?1:0,m=re.columnOutlines&&!re.columnOutlines.iT()?1:0,le&&se?ie._l(ae,new ue.Rect(i.x,i.y,je(i),Be(i)+g),new ue.Rect(s.x,s.y,je(s)+m,Be(s))):ie._l(ae,new ue.Rect(i.x,i.y,je(i)+m,Be(i)+g)),b=new ue.Rect(f,c,d,h),(y=re.getSelections())&&0<y.length&&(C=re.getRangeRect(1,1,y[0]),w=fe(b.x+b.width,C.x+C.width),v=fe(b.y+b.height,C.y+C.height),b.x=he(b.x,C.x),b.y=he(b.y,C.y),b.width=w-b.x+1,b.height=v-b.y+1),ie.Pw(ae,b),B=!0,V=(O=re).am(),z=O._render,q=O.options.gridline.color,Z=ue.Im.Km(0,"gc-columnHeader-normal"),Y=Z&&Z.borderBottomColor,K=z.bm(),X=O.jt(1),J=mt(O),Q=V.zr,$=je(V),ee=O.Rt(-1),(te=X.findRow(ee))&&(j=V.qt,0<(H=te.y-j)&&(gt(K,q,Q,te.y-.5,Q+$-J.width,te.y-.5),B&&(0===J.width&&gt(K,q,V.zr-.5,j,V.zr-.5,te.y),gt(K,Y,V.kt-.5,j,V.kt-.5,te.y)))),G=O.it(1),j=V.Ar,H=Be(V),U=O.Ot(-1),(W=G.findCol(U))&&(Q=V.pt,0<($=W.x-Q)&&(gt(K,q,W.x-.5,j,W.x-.5,j+H-J.height),B&&(0===J.height&&gt(K,q,Q,V.Ar-.5,W.x,V.Ar-.5),gt(K,Y,Q,V.nt-.5,W.x,V.nt-.5)))),pt(re,!0),this.bQ(le,se),T=!0,R=(x=re).am(),D=x._render.bm(),N=x.jt(1),F=mt(x),_=x.Rt(-1),P=N.findRow(_),L=ce("gc-group").color,P&&(A=R.qt,0<P.y-A&&T&&0<F.width&&0===R.Br&&gt(D,L,R.kt-.5,A,R.kt-.5,P.y)),k=x.it(1),M=x.Ot(-1),(I=k.findCol(M))&&(E=R.pt,0<I.x-E&&T&&0<F.height&&0===R.Cr&&gt(D,L,E,R.nt-.5,I.x,R.nt-.5)),S=re.options.sheetAreaOffset,re.options.rowHeaderVisible||ie.B0a(ae,new ue.Rect(f,c,2,h+S.top)),re.options.colHeaderVisible||ie.B0a(ae,new ue.Rect(f,c,d+S.left,2)),ne&&oe},yt.prototype.bQ=function(e,t){var r,n=this.kj;t&&n.os(),e&&n.qs(),n._eventHandler._updateEditingEditor(),(r=n._modelManager.Ky)&&r.cQ()},yt.prototype.dQ=function(i,a,s){function l(e,t,r,n){return C(.75,e/=r)*n*(t?1:-1)}function e(e,t,r){return e=D(e),w(e/=r)/w(.75)*t}var u=this,c=u.kj,h=e(i,10,200),f=e(a,10,200),d=i,p=a,g=0,m=0,b=!1,y=!1;u.jI=V.setInterval(function(){var e,t,r,n,o;return b&&y?(c.ss.jn(),(e=c.parent)&&!e.options.scrollbarShowMax&&(c.oq=!0,c.jq=!0),c.ss.kn(),c.cCb=0,c.eCb=0,c.$p(),c.qs(),c.os(),He(u.jI),void(u.jI=O)):(f+=20,void(100<(h+=20)&&100<f?(u.aQ(i-g,a-m,bt(b,y),s),y=b=!0):(100<h&&!b&&(u.aQ(i-g,0,1,s),b=!0),100<f&&!y&&(u.aQ(0,a-m,2,s),y=!0),t=l(h,0<i,10,200),r=l(f,0<a,10,200),n=v(d-t),o=v(p-r),u.aQ(n,o,bt(b,y),s),d=t,p=r,g+=n,m+=o)))},20)},yt.prototype.qG=function(e){var t=this,r=t.kj,n=r.ss;t.jI&&(n.kn(),He(t.jI),t.jI=O),t.$P=0,t._P=0,t.YP=0,t.ZP=0,t.eQ=r.lq,t.fQ=r.qq,e&&n.hn()},yt.prototype.NG=function(e,t){var r,n=this.kj.parent,o=n.options.scrollbarAppearance===ue.ScrollbarAppearance.mobile,i=n.St,a=n.Pt,s=n.ku,l=W(e.X+""),u=W(e.Y+""),c=(r=0,(r|=0!==l?1:0)|(0!==u?2:0));return o&&(0!==u&&(i.Jwa(ue.ScrollbarState.show),s.Rdc(!0)),0!==l&&(a.Jwa(ue.ScrollbarState.show),s.Rdc(!1))),this.aQ(l,u,c,t)},yt.prototype.gQ=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m=this.kj;return m.parent&&m.parent.options.scrollByPixel?(m.ss.kn(),void m.$p()):(r=(t=m.am()).pt,n=t.qt,o=m.lq,i=m.qq,a=m.it(1),l=m.ps(),u=1,a&&0<a.length&&(s=a.findCol(i),i<l&&s&&s.x+je(s)-r<je(s)/2?i++:u=-1),c=m.jt(1),f=m.ns(),d=1,c&&0<c.length&&(h=c.findRow(o),o<f&&h&&h.y+Be(h)-n<Be(h)/2?o++:d=-1),g=p=0,a&&0<a.length&&(p=r-(s=a.findCol(i)).x),c&&0<c.length&&(g=n-(h=c.findRow(o)).y),o!==this.eQ&&m.mq(o,0,!0),i!==this.fQ&&m.rq(i,0,!0),p*=u,g*=d,void this.dQ(p,g,e))},me=yt,St.prototype.jQ=function(e){var t=this.kj,r=t.am(),n=r.pt,o=r.qt,i=r.lt,a=r.ot,s=e.rN,l=0,u=this.kQ(s.X,s.Y),c=u.dragInfo,h=u.x,f=u.y;u&&(u.resizeInfo||c&&"corner"===c.side||u.selectionHitInfo)?(l|=2,l|=1):(o<=f&&f<a&&(l|=2),n<=h&&h<i&&(l|=1),l|=96,t.parent&&(l|=12)),e.DO=l},St.prototype.lQ=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w={e:e,r:O};if(St.ao(this,"preProcessManipulationStarted",w),!w.r)if(t=e.rN,n=(r=this.kj).parent,o=r._eventHandler,i=r._render,s=(a=this.kQ(t.X,t.Y)).dragInfo,l=a.selectionHitInfo,(r.yt=a).resizeInfo){if(!r.endEdit())return;o.fG(a)}else if(s&&"corner"===s.side)o.hG&&o.hG(a);else if(l){if(!r.endEdit())return;u=l.isHeader,c=l.isFirstIndicator,h=l.type,u&&o.ZG(a,!0),f=a.hitTestType,a.hitTestType=h,o.bH(a),a.hitTestType=f,d=r,p=c,g=h,u||(b=(m=Ve(d))[m.length-1],y=d.Jl,C=d.Kl,p?3===g?(d.Jl=b.row+b.rowCount-1,d.Kl=b.col+b.colCount-1):2===g?(d.Jl=b.row+b.rowCount-1,d.Kl=0):1===g&&(d.Jl=0,d.Kl=b.col+b.colCount-1):3===g?(d.Jl=b.row,d.Kl=b.col):2===g?(d.Jl=b.row,d.Kl=0):1===g&&(d.Jl=0,d.Kl=b.col),Ct(d,y,C,d.Jl,d.Kl)),r.mQ=!1,i.DH()}else r.nQ&&(r.nQ().oQ=!1),r.mQ=!1,i.DH(),1<e.HP&&n&&n.options.allowUserZoom?(this.KN=!1,this.hQ.OP()):(this.KN=!0,this.iQ.qG(1===e.HP))},St.prototype.pQ=function(e){var t,r,n,o,i,a,s,l,u,c,h={e:e,r:O};if(St.ao(this,"preProcessManipulationDelta",h),!h.r&&(t=e.rN,n=(r=this.kj)._eventHandler,o=r.yt,i=t.X,a=t.Y,o))if(s=o.dragInfo,l=o.selectionHitInfo,o.resizeInfo)n.$F={e:e,x:i,y:a},n.WG();else if(s&&"corner"===s.side)n.$F={e:e,x:i,y:a},n.CG&&n.CG();else if(l||n.xG){if(l){if(!n.rG||!n._isWorking)return;if(!0===n.DA)return;u=l.type,n.$F={e:e,x:i,y:a},3===u?n.cH():2===u?n.dH():1===u&&n.eH()}}else this.KN?e.vO=this.iQ.NG(e.fP.sO,e.gP):(c=e.dP.rO,this.hQ.PP(c))},St.prototype.qQ=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p={e:e,r:O};St.ao(this,"preProcessManipulationCompleted",p),p.r||(r=(t=this.kj)._eventHandler,t.mQ=!0,o=(n=t.yt).selectionHitInfo,n.resizeInfo?r.YG():n.dragInfo&&r.BG?(r.xH&&r.xH(),t.parent.touchToolStrip.rQ()):o||r.xG?(r.hH(),o&&(a=t,s=o.isHeader,l=o.isFirstIndicator,u=o.type,s||(h=(c=Ve(a))[c.length-1],f=a.Jl,d=a.Kl,l&&(3===u?(a.Jl=h.row,a.Kl=h.col):2===u?(a.Jl=h.row,a.Kl=0):1===u&&(a.Jl=0,a.Kl=h.col)),Ct(a,f,d,a.Jl,a.Kl))),t._render.im()):(t.nQ&&(t.nQ().oQ=!0),this.KN?this.iQ.gQ(e.gP):(i=e.dP.rO,this.hQ.SP(i))))},St.prototype.sQ=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N=this,F={e:e,r:O};if(St.ao(N,"preProcessTapped",F),F.r)N.kj.repaint();else if(t=e.rN,r=N.kj,n=r.parent,o=!1,r.Uja=B,N.tQ(),r.uQ&&r.uQ(),(i=r._modelManager.Ky)&&i.vQ(),a=r._eventHandler,l=(s=N.kQ(t.X,t.Y,!0)).filterButtonHitInfo,u=s.hitTestType,c=s.row,h=s.col,f=s.outlineHitInfo)r.isEditing()||(d=f.what,p=r.rowOutlines,g=r.columnOutlines,"rg"===d||"rgh"===d?p&&p.UL(r,f):"cg"!==d&&"cgh"!==d||g&&g.UL(r,f));else if(r.yt=s,l){if(!r.endEdit())return;(m=l.rowFilter)&&m.openFilterDialog(l)}else if(!s.resizeInfo&&r.Qs(s.rowViewportIndex<0?-1:c,s.colViewportIndex<0?-1:h)){if(r.wQ&&!a.BG&&n.touchToolStrip.rQ(),b=r.getActiveRowIndex(),y=r.getActiveColumnIndex(),C=s.cellTypeHitInfo){if(w=r.getCellType(C.row,C.col,u),C.sheet||(C.sheet=r),N.Sia(w,C))if(v=C.sheetArea,!L(v)&&3!==v||c===b&&h===y)r._render.DH();else{if(r.suspendPaint(),!r.endEdit())return;if(S={sheet:r,sheetName:r.name(),row:b,col:y,cancel:!1},r.Wq(ue.Events.LeaveCell,S),!0===S.cancel)return;x=r._modelManager.getSelections(),T=r._modelManager.getSpan(c,h),A=[ue.kf(T.row,T.col,T.rowCount,T.colCount)],r.yu(x,A),r.Wq(ue.Events.FloatingElementSelected,{type:"worksheet"}),k=C.isReservedLocation&&C.isFocusAware,r.Sr(c,h,B,B,k?0:1),M={sheet:r,sheetName:r.name(),row:c,col:h},r.Wq(ue.Events.EnterCell,M),r.Wq(ue.Events.FormulatextboxEnterCell,M),r.Au(x),r.Uja=!0,a.cs&&a.cs(c,h),r.resumePaint(),o=!0}w.processCellAndPaddingMouseDown(C),w.XGb(C)}if(C&&C.isReservedLocation)return!0;C&&C.cellButtonHitInfo&&(o=!0),r.Wq(ue.Events.CellClick,{sheet:r,sheetName:r.name(),sheetArea:u,row:s.row,col:s.col});try{if(a.mG=s,I=r.isEditing(),E=r.endEdit(),r.CH&&_&&I&&E&&(a.shift=!1),I&&b===r.getActiveRowIndex()&&y===r.getActiveColumnIndex()&&!E)return}finally{a.mG=O}if(L(c)||L(h))return;3===u&&a.cs&&a.cs(c,h),function(e,t,r,n){var o,i,a,s,l,u,c,h,f=!1,d=e._modelManager.getSelections();for(o=0,i=d.length;o<i;o++){if(a=d[o],(s=3===n||L(n))&&(a=e.Tq(a)),l=a.row,u=a.col,c=a.rowCount,h=a.colCount,s)f=l<=t&&t<l+c&&u<=r&&r<u+h;else if(2===n)f=-1===u&&l<=t&&t<l+c;else if(1===n)f=-1===l&&u<=r&&r<u+h;else if(0===n)return f;if(f)break}return f}(r,c,h,u)&&!o?N.xQ=V.setTimeout(function(){var e={x:s.x,y:s.y,handled:!1},t=n.touchToolStrip;r.Wq(ue.Events.TouchToolStripOpening,e),e.handled||t.open(s.x,s.y-100),N.tQ()},420):(r.Wq(ue.Events.FloatingElementSelected,{type:"worksheet"}),R=r._modelManager.getSelections(),a.ZG(s),D=r._modelManager.getSelections(),r.yu(R,D),a.hH())}},St.prototype.Sia=function(e,t){return!(e&&e.activedOnClick&&!e.activedOnClick()&&t.isReservedLocation)},St.prototype.yQ=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b={e:e,r:O};if(St.ao(this,"preProcessDoubleTapped",b),!b.r)if(t=this.kj,r=e.rN,this.tQ(),(i=t.yt)&&(t.Wq(ue.Events.CellDoubleClick,{sheet:t,sheetName:t.name(),sheetArea:i.hitTestType,row:i.row,col:i.col}),a=i.resizeInfo))if(s=t._modelManager.getSelections(),"sizeRow"===a.action||"sizeHiddenRow"===a.action){if(l=[],t.tp(a.index)){for(n=0;n<s.length;n++)if(-1===(o=s[n]).col)for(o=t.Tq(o),u=0;u<o.rowCount;u++)l.push({row:o.row+u})}else l.push({row:a.index});t.wu().execute({cmd:"autoFitRow",sheetName:t.name(),rows:l,columnHeader:1===a.sheetArea})}else{if(c=[],t.sp(a.index)){for(n=0;n<s.length;n++)if(-1===(o=s[n]).row)for(o=t.Tq(o),h=0;h<o.colCount;h++)c.push({col:o.col+h})}else c.push({col:a.index});t.wu().execute({cmd:"autoFitColumn",sheetName:t.name(),columns:c,rowHeader:2===a.sheetArea})}else!((f=this.kQ(r.X,r.Y,!0))&&0<=f.row&&0<=f.col&&0<=f.rowViewportIndex&&0<=f.colViewportIndex)||f.resizeInfo||t.options.isProtected&&t.tq(f.row,f.col,"locked")||((d=t.isCtrlPressed(f.hitTestType))||t.Tr(),p=t.Er(f.row),g=t.Fr(f.col),m=!0,t.Jl===f.row&&t.Kl===f.col||(m=!1),t.Kr(f.row,f.col,p,g,m),d?t.$p():t.addSelection(f.row,f.col,1,1),t._eventHandler.dI(!1,!0),t.EF(t.Ws(),f.row,f.col))},St.prototype.zQ=function(e){var t,r=this.kj,n=e.rN,o=this.kQ(n.X,n.Y);r.isEditing()?o.row===r.Jl&&o.col===r.Kl||r._eventHandler.cI(o):(this._target=o,(t=this.kQ(n.X,n.Y,!0))&&t.cellTypeHitInfo&&t.cellTypeHitInfo.isEditting||r._eventHandler.cI(t))},St.prototype.AQ=function(e){var t,r,n,o,i=this.kj;i.isEditing()||(r=!0,(t=this._target)&&((n=t.cellTypeHitInfo)&&n.isReservedLocation||(o=i.getCellType(t.row,t.col))&&o.isEditting())&&(r=!1),r&&i._eventHandler.dI(!0))},St.prototype.kQ=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P=this.kj;return P.am(),n={x:e,y:t,rowViewportIndex:O,colViewportIndex:O,row:-1,col:-1,resizeInfo:O,hitTestType:O,outlineHitInfo:O,filterButtonHitInfo:O,dragInfo:O,cellTypeHitInfo:O,selectionHitInfo:O},o=P.rowOutlines,i=P.columnOutlines,o&&(a=o.hitTest(P,e,t)),!a&&i&&(a=i.hitTest(P,e,t)),a?n.outlineHitInfo=a:(s=P.nr(t),l=P.or(e),n.rowViewportIndex=s,n.colViewportIndex=l,n.row=P.pr(t,s),n.col=P.qr(e,l),0<=s&&s<=2&&0<=l&&(u=P.rr(s,l,B,n.row,n.col))&&(n.row=u.row,n.col=u.col),n.hitTestType=P.sr(s,l),p=d=f=h=c=void 0,C=n,w=e,v=t,S=10,I=(y=P).parent,E=y._eventHandler,R=y.options,D=C.rowViewportIndex,N=C.colViewportIndex,F=Ve(y),_=O,y.CH&&0<F.length&&(T=(x=F[F.length-1]).row,A=x.row+x.rowCount-1,k=x.col,M=x.col+x.colCount-1,I&&!I.options.allowUserResize||(-1!==T&&-1===k&&0<=D&&N<0&&R.rowHeaderVisible?!(_=E.mH(y,C,S,2,v))||"sizeRow"!==_.action&&"sizeHiddenRow"!==_.action||2!==_.sheetArea||_.index===A||(_=O):-1===T&&-1!==k&&D<0&&0<=N&&R.colHeaderVisible&&(!(_=E.oH(y,C,S,1,w))||"sizeCol"!==_.action&&"sizeHiddenCol"!==_.action||1!==_.sheetArea||_.index===M||(_=O)))),c=_,(d=(f=P.xr)&&f.hitTest(n,e,t))||(d=(b=(m=(g=P.tables)&&g.find(n.row,n.col))&&m.xr)&&b.hitTest(n,e,t)),P.wQ?(h=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m=O,b=t.rowViewportIndex,y=t.colViewportIndex;if(L(b)||L(y))return m;if(o=e.parent,i=e._getActiveSelectedRange(),0<=b&&0<=y&&1===e._modelManager.getSelections().length){if(a=e.Tq(i),s=ze(e),l=qe(e),u=Ze(e)-s,c=Ye(e)-l,1===y&&0<s&&a.col<u&&a.col+a.colCount>u&&(h=e.Hr(y))&&0<h.length&&r>(f=h[h.length-1]).x+je(f))return m;if(1===b&&0<l&&a.row<c&&a.row+a.rowCount>c&&(d=e.Gr(b))&&0<d.length&&n>(p=d[d.length-1]).y+Be(p))return m}return(g=Rt(e))&&(m||(g.x-=je(g),g.y-=Be(g),g.width*=3,g.height*=3,g.contains(r,n)&&(m={action:"drag",side:"corner"})),o&&o.options.allowUserDragFill||m&&"corner"===m.side&&(m.side=O)),m}(P,n,e,t),n.dragInfo=h):c?n.resizeInfo=c:d?n.filterButtonHitInfo=d:r?n.cellTypeHitInfo=P.yr(n,e,t):(p=function(e,t,r,n){var o,i,a,s,l,u,c,h,f;if(0===e.selectionPolicy())return O;for(o=t.hitTestType,i=Nt(e),a=Ve(e),s=3,e.CH&&0<a.length&&(-1!==(l=a[a.length-1]).row&&-1!==l.col?s=3:-1!==l.row?s=2:-1!==l.col&&(s=1)),u=0;u<i.length;u++)if((c=i[u])&&(c.x-=je(c),c.y-=Be(c),c.width*=3,c.height*=3,c.contains(r,n)))return L(t.row)&&(h=e.jt(1))&&0<h.length&&(t.row=h[h.length-1].row),L(t.col)&&(f=e.it(1))&&0<f.length&&(t.col=f[f.length-1].col),{x:r,y:n,type:s,isHeader:!1,isFirstIndicator:0===u};return 1===o?{x:r,y:n,type:1,isHeader:!0}:2===o?{x:r,y:n,type:2,isHeader:!0}:O}(P,n,e,t),n.selectionHitInfo=p)),n},St.prototype.tQ=function(){var e=this.xQ;e&&(clearTimeout(e),this.xQ=O)},be=St,t.TouchEventHandler=be,ue.Zn(be),vt.prototype.EQ=function(){var t=this.CQ,e=this.DQ;e.dN=function(e){return t.jQ(e)},e.eN=function(e){return t.lQ(e)},e.fN=function(e){return t.pQ(e)},e.hN=function(e){return t.qQ(e)},e.iN=function(e){return t.sQ(e)},e.jN=function(e){return t.yQ(e)},e.GM=function(e){return t.zQ(e)},e.IM=function(e){return t.AQ(e)}},vt.prototype.FQ=function(){var e=this.DQ;e&&(this.BQ.xN(e,!1),e.dN=O,e.eN=O,e.fN=O,e.gN=O,e.hN=O,e.iN=O,e.jN=O,e.kN=O,e.GM=O,e.IM=O,this.DQ=O)},vt.prototype.GQ=function(e){return this.yM.GQ()},vt.prototype.HQ=function(e){return this.yM.HQ()},vt.prototype.IQ=function(e){return this.yM.IQ()},ye=vt,Ce="gc-toolstrip-button",we="gc-toolstrip-text",ve="gc-toolstrip-image",Se="gc-toolstrip-item",xe="gc-touch-sperate-line",Te="height",Ae="button",Oe(wt,Le=o),wt.prototype.open=function(e,t){var r,n,o;if(We(this.OC)&&(ue.Vl.Zl(O,!0),this.NQ.css({left:e,top:t}),this.Ao(),this.MQ=!0,this.Do(),!i(this.LQ)))for(n in r=this.LQ)r.hasOwnProperty(n)&&(!(o=r[n]).RQ||o.RQ.call(this)?R("#"+n).show():R("#"+n).hide())},wt.prototype.add=function(e){var t,r,n;e&&(t=this.LQ,e instanceof Ie?(r=e.name())&&(t[r]=e,this.SQ(e.TQ(xe,this.KQ+"px"))):e instanceof Me&&(n=e.name(),this.getItem(n)||(t[n]=e,this.SQ(e.TQ(ve,this.JQ+"px",we,Ce)))))},wt.prototype.getItem=function(e){return this.LQ[e]},wt.prototype.getItems=function(){var e,t=[],r=this.LQ;if(i(r))return O;for(e in r)r.hasOwnProperty(e)&&t.push(r[e]);return t},wt.prototype.remove=function(e){var t;return this.getItem(e)?(R("#"+e).parent().remove(),t=this.LQ[e],delete this.LQ[e],t):O},wt.prototype.clear=function(){this.NQ&&(this.NQ.find("td."+Se).remove(),this.LQ={})},wt.prototype.close=function(){var e,t;x.Hm(),this.NQ&&this.NQ.hide(),this.MQ=!1,this.Eo(),(e=We(this.OC))&&(e.zt(),0<(t=Ve(e)).length&&!e.wQ&&-1===t[0].row&&-1===t[0].col&&e.Tr())},wt.prototype.imageAreaHeight=function(e){return 0===arguments.length?this.JQ:(0<e&&(this.JQ=e,this.NQ.find("span."+ve).css(Te,e+"px")),this)},wt.prototype.itemHeight=function(e){var t=this.NQ.find("button."+Ce);return 0===arguments.length?S(t.css(Te)):(0<e&&t.css(Te,e+"px"),this)},wt.prototype.itemWidth=function(e){var t=this.NQ.find("button."+Ce);return 0===arguments.length?S(t.css("width")):(0<e&&(e<S(t.css("min-width"))&&t.css("min-width",e+"px"),t.css("width",e+"px")),this)},wt.prototype.separatorHeight=function(e){return 0===arguments.length?this.KQ:(0<e&&(this.KQ=e,this.NQ.find("div."+xe).css(Te,e+"px")),this)},wt.prototype.OQ=function(){var e=R(b("table")).css({padding:0,display:"table"}).attr({cellspacing:0,cellpadding:0});this.UQ=R(b("tr")).appendTo(e),e.appendTo(this.NQ)},wt.prototype.no=function(){var e=this.NQ;e&&(this.MQ&&x.Hm(),e.unbind("click"),e.remove(),this.Eo(),this.NQ=O)},wt.prototype.QQ=function(){var i=this;i.NQ.bind("click",function(e){var t,r,n,o=e.target;o.tagName.toLowerCase()===Ae?t=o.id:(r=o.parentElement)&&r.tagName.toLowerCase()===Ae&&(t=r.id),n=i.LQ[t],t&&n&&n.VQ.call(i)})},wt.prototype.SQ=function(e){this.NQ&&e&&R(b("td")).append(e).appendTo(this.UQ).addClass(Se)},wt.prototype.PQ=function(){var e,t,r,n,o,i,a;function s(e){for(var t=0,r=e+t;z.getElementById(r);)r=e+ ++t;return r}n=(t={0:T+(e="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA")+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+A,1:T+e+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+A,2:T+e+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:T+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="})[0],o=t[1],i=t[2],a=t[3],(r=this).WQ=new Me(s("wijspread_toolstrip_paste"),M().ToolStrip_PasteText,n,r.XQ),r.YQ=new Me(s("wijspread_toolstrip_cut"),M().ToolStrip_CutText,o,r.ZQ),r.$Q=new Me(s("wijspread_toolstrip_copy"),M().ToolStrip_CopyText,i,r._Q),r.aR=new Me(s("wijspread_toolstrip_autofill"),M().ToolStrip_AutoFillText,a,r.bR,r.cR),r.add(r.WQ),r.add(r.YQ),r.add(r.$Q),r.add(new Ie(r.cR)),r.add(r.aR)},wt.prototype.cR=function(){var e,t,r,n=We(this.OC);if(!n)return!1;for(e=Ve(n),t=0;t<e.length;t++)if(-1===(r=e[t]).row&&-1===r.col)return!1;return!0},wt.prototype.bR=function(){var e;this.close(),!(e=We(this.OC))||Ve(e).length<=1&&(e.wQ=!0,e._render.im())},wt.prototype.rQ=function(){var e=We(this.OC);e&&(e.wQ=!1,e._render.im())},wt.prototype._Q=function(){var e=We(this.OC);e&&(this.dR=e.ux(!0)),this.close()},wt.prototype.ZQ=function(){var e=We(this.OC);e&&(this.dR=e.sx(!0)),this.close()},wt.prototype.XQ=function(){var e=this.dR,t=We(this.OC);t&&!L(e)&&t.vx({pasteHtml:e.copyHtml,pasteText:e.copyText}),this.close()},wt.prototype.eR=function(){var e="span."+we;R("#"+this.WQ.Cj).find(e).text(M().ToolStrip_PasteText),R("#"+this.YQ.Cj).find(e).text(M().ToolStrip_CutText),R("#"+this.$Q.Cj).find(e).text(M().ToolStrip_CopyText),R("#"+this.aR.Cj).find(e).text(M().ToolStrip_AutoFillText)},ke=wt,t.TouchToolStrip=ke,It.prototype.name=function(e){return 0===arguments.length?this.Cj:(R("#"+this.Cj).attr("id",e),R("#"+this.Cj+"Text").attr("id",e+"Text"),R("#"+this.Cj+"Image").attr("id",e+"Image"),this.Cj=e,this)},It.prototype.text=function(e){return 0===arguments.length?this._text:(this._text=e,R("#"+this.name()+"Text").text(e),this)},It.prototype.font=function(e){var t=R("#"+this.name()+"Text");return 0===arguments.length?this._font:(this._font=e,t.css("font",e),this)},It.prototype.foreColor=function(e){var t=R("#"+this.name()+"Text");return 0===arguments.length?this.Nra?this.Nra:t.css("color"):(t.css("color",e),this)},It.prototype.image=function(e){return 0===arguments.length?this.fR:(this.fR=e,R("#"+this.name()+"Image").css("background-image","url("+e+")"),this)},It.prototype.TQ=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d=this.name(),p=this.font(),g=this.text(),m=R(b("span"));return m.attr("id",d+"Image"),m.addClass(e),m.css({"background-image":"url("+this.image()+")","background-repeat":"no-repeat",display:"block",height:t,"background-position-x":"50%"}),(o=R(b("span"))).attr("id",d+"Text"),o.addClass(r),o.css("font",p),o.text(g),s=p,l=g,u=r,h=b("span"),f=z.body,h.className=u,h.style.font=s,h.style.cssFloat="left",h.textContent=l,f.insertBefore(h,O),c=R(h).width(),f.removeChild(h),(i=60)<c&&(i=c),(a=R(b(Ae))).attr("type",Ae),a.attr("id",d),a.addClass(n+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),a.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:i+"px"}),a.append(m),a.append(o),a[0]},Me=It,t.TouchToolStripItem=Me,Mt.prototype.name=function(){return this.Cj},Mt.prototype.TQ=function(e,t){var r=R(b("div"));return r.attr("id",this.name()),r.addClass(e),r.css({width:"1px",height:t,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),r[0]},Ie=Mt,t.TouchToolStripSeparator=Ie,kt.prototype.oN=function(){this.gR=2,this.tc.CH=!0},kt.prototype.zM=function(){this.gR=0,this.hR=Ge()},kt.prototype.nN=function(){return 1===this.gR},kt.prototype.uN=function(){return 1===this.gR},kt.prototype.sN=function(){return 1===this.gR},kt.prototype.GQ=function(){if(2===this.gR)return!0;if(this.hR){if(Ge()-this.hR<=200)return this.iR++,!0;this.hR=0,this.iR=0,this.gR=1}else this.gR=1;return this.tc.CH=!1},kt.prototype.HQ=function(){return this.iR?(this.iR--,!0):2===this.gR||(this.gR=0,!1)},kt.prototype.IQ=function(){return 2===this.gR},Ee=kt,t.jR=Ee,Re=function(e,t,r,n,o){this.KM=e,this.lN=r,this.OM=t,this.mN=n,this.aN=o},t.kR=Re,At.prototype.lR=function(e,t){var r,n,o=e,i=o.touches,a=o.targetTouches,s=o.changedTouches;!1!==o.isPrimary&&(i&&1<=i.length&&a&&1<=a.length&&(i[0].clientX!==a[0].clientX||i[0].clientY!==a[0].clientY)||(h(e),r=L(s)?o:s[0],(n=z.createEvent("MouseEvents")).initMouseEvent(t,!0,!0,V,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,O),e.target.dispatchEvent(n)))},At.prototype.NM=function(e){var t,r=e.pointerType;if(!r||r===e[g]||r===p){if((t=e.data).mR)return;t.mR=!0,t.nR=!1,t.lR(e,"mouseover"),t.lR(e,"mousemove"),t.lR(e,"mousedown")}},At.prototype.aB=function(e){var t,r=e.pointerType;if(!r||r===e[g]||r===p){if(!(t=e.data).mR)return;t.nR=!0,t.lR(e,"mousemove")}},At.prototype.RM=function(e){var t,r=e.pointerType;if(!r||r===e[g]||r===p){if(!(t=e.data).mR)return;t.lR(e,"mouseup"),t.lR(e,"mouseout"),t.nR||t.lR(e,"click"),t.mR=!1}},At.prototype.oR=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p=this;"."!==r.charAt(0)&&(r="."+r),n=F+r,o=P+r,i=j+r,a=H+r,s=G+r,l="pointerup"+r,u=U+r,c="touchmove"+r,h="touchend"+r,f=ue.Ul._Va(),t?f?(d=e.style,L(d.msTouchAction)||(d.msTouchAction=N),L(d.touchAction)||(d.touchAction=N),R(e).bind(n,p,p.NM).bind(a,p,p.NM),R(z).bind(o,p,p.aB).bind(s,p,p.aB).bind(i,p,p.RM).bind(l,p,p.RM)):R(e).bind(u,p,p.NM).bind(c,p,p.aB).bind(h,p,p.RM):f?(R(e).unbind(n).unbind(a),R(z).unbind(o).unbind(s).unbind(i).unbind(l)):R(e).unbind(u).unbind(c).unbind(h)},De=At,t.pR=De,Tt.prototype.lQ=function(e){var t,r,n,o,i,a,s,l,u=e.rN,c=this.hq,h=We(c.OC);c.FD&&c.GD(h,!1),"resize"===(t=c.hitTest(u.X,u.Y).element)?(c.HD=!0,c.ID=u.X):"tab"!==t&&"newSheet"!==t&&""!==t||(r=c.Xs,n=ue.En.Nn(r),o=ue.En.On(r),a=(i=this.IP(n,o)).getContext("2d"),s=ue.En.Ln(i),l=ue.En.Mn(i),ue.Bn.Cn(a,1,1),a.drawImage(r,0,0,je(i),Be(i),0,0,je(i),Be(i)),ue.Bn.Cn(a,s,l),this.Xs=i,this.qR=c.gq,this.rR=c.VC(),this.sR=c.UC(),this.KC=c.TC(),c.SC=!0),this.tR=c.jw(-1),this.uR=c.rD(c.sD())},Tt.prototype.pQ=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M=e.rN.X,I=this.hq;if(I.HD)t=M-I.ID,n=(r=I.OC).options,o=r.xs.clientWidth,n.tabStripRatio=r.Iv()+t/o,i=I.kw/o,r.Iv()<i?(n.tabStripRatio=i,I.ID=I.kw):1<=r.Iv()?(n.tabStripRatio=1,I.ID=o):I.ID=M;else{if(a=this.Xs,s=this.qR,!a||L(s))return;l=this.tR,u=this.uR,c=this.KC,h=this.rR,f=this.sR,d=e.dP.sO.X,p=this.vR(d,s),I.gq=p.gq,g=p.Vo,(0<d&&s===l&&I.gq===l||d<0&&s===u&&I.gq===u)&&(g=0),0<d&&g+c<d?d=g+c:d<0&&d<g-c&&(d=g-c),0!==d&&(b=(m=I.Xs).getContext("2d"),y=ue.En.Ln(m),C=ue.En.Mn(m),b.save(),b.clearRect(0,0,ue.En.Nn(m),ue.En.On(m)),w=I.Dr(),I.dD(b,w),S=v=void 0,x=Be(w),A=T=void 0,0<d?(0<(S=f-(T=(v=h)+d))&&(ue.Bn.Cn(b,1,1),b.drawImage(a,v*y,0,S*y,x*C,T*y,0,S*y,x*C),ue.Bn.Cn(b,y,C)),A=d-g,f-h<=d&&(A=0),v=h,0<(S=g)&&(ue.Bn.Dn(b,A,0),I.iE(b,new ue.Rect(v,0,S,x)),ue.Bn.Dn(b,-A,0))):d<0&&(0<(S=f-(v=(T=h)+D(d)))&&(ue.Bn.Cn(b,1,1),b.drawImage(a,v*y,0,S*y,x*C,T*y,0,S*y,x*C),ue.Bn.Cn(b,y,C)),A=d-g,f-h<=D(d)&&(A=0),v=f-(S=D(g)),0<S&&(ue.Bn.Dn(b,A,0),I.iE(b,new ue.Rect(v,0,S,x)),ue.Bn.Dn(b,-A,0))),ue.Bn.Cn(b,1,1),v=0,S=h,b.drawImage(a,v*y,0,S*y,x*C,v*y,0,S*y,x*C),k=ue.Im.Lm(""),2007<W(k.zIndex)&&(v=f,S=w.x+je(w)-I.kw-v,b.drawImage(a,v*y,0,S*y,x*C,v*y,0,S*y,x*C)),v=je(w)-I.kw,S=I.kw,b.drawImage(a,v*y,0,S*y,x*C,v*y,0,S*y,x*C),ue.Bn.Cn(b,y,C),b.restore())}},Tt.prototype.qQ=function(e){var t=this.hq;t.HD?(t.HD=!1,t.OC.aq()):(t.SC=B,t.repaint())},Tt.prototype.sQ=function(e){var t,r,n,o,i=this.hq,a=i.OC,s=e.rN,l=We(a);i.FD&&i.GD(l,!1),t=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],n=(r=i.hitTest(s.X,s.Y)).element,a.mv=!0;try{0<=t.indexOf(n)?i.JD(r.index,!0):"tab"===n?i.KD(r.index,r.position):"newSheet"===n&&i.MD(r.position)}finally{a.mv=!1,(o=We(a))!==l&&(o.CH=!0,o.zt())}},Tt.prototype.yQ=function(e){return this.hq.cE(e.rN.X,e.rN.Y)},Tt.prototype.IP=function(e,t){var r=this.Xs;return r?e===ue.En.Nn(r)&&t===ue.En.On(r)||ue.En.Pn(r,e,t):(r=b("canvas"),ue.En.Kn(r,this.hq.OC),ue.En.Pn(r,e,t)),r},Tt.prototype.vR=function(e,t){var r=this.hq.WC,n=this.tR,o=this.uR,i=t,a=0;if(0<e){for(;n<=i&&!(e<a);)a+=r[i],i--;i<n&&(i=n)}else if(e<0&&-1!==o){for(;i<=o&&!(a<e);)a-=r[i],i++;o<i&&(i=o)}return{gq:i,Vo:a}},Ne=Tt,xt.prototype.EQ=function(){var e=this.BQ;e&&e.xN(this.DQ,!0)},xt.prototype.FQ=function(){var e=this.BQ;e&&e.xN(this.DQ,!1)},xt.prototype.GQ=function(e){return this.yM.GQ()},xt.prototype.HQ=function(e){return this.yM.HQ()},xt.prototype.IQ=function(e){return this.yM.IQ()},Fe=xt,ue.oJ.prototype.DH=function(){var e=this.kj,t=Ve(e),r=t.length;e.Xq<=0&&0<r&&this.im(t[r-1],B,B,!0)},ue.Worksheet.$n(p,{init:function(){this.wQ=!1,this.mQ=!0},setHost:function(e){var t=this.parent,r=t&&t.BQ||new I,n=new ye(e[0],this,r);n.EQ(),this.wR=n},dispose:function(e){this.wR&&this.wR.FQ(),!1!==e.clearCache&&(this.wR=O)},startEdit:function(){this._render.DH()},paintAdornment:function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v=e.ctx;this.CH&&(this.options.isProtected||(i=v,C=(o=this).am(),w=Ve(o),o.CH&&0<w.length&&(h=(c=w[w.length-1]).row,f=c.row+c.rowCount-1,d=c.col,p=c.col+c.colCount-1,m="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",(g=o.parent)&&!g.options.allowUserResize||(-1!==h&&-1===d&&o.getRowResizable(f)?(b=o.Er(f),a=T+m+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",s=o.getCellRect(f,Ze(o,2)-1,b,-1),(u=C.fm(b)).y<=s.y&&s.y+Be(s)<=u.y+Be(u)&&(l=new ue.Rect(C.kt-16,s.y+Be(s)-8,16,16))):-1===h&&-1!==d&&o.getColumnResizable(p)&&(y=o.Fr(p),a=T+m+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+A,s=o.getCellRect(Ye(o,1)-1,p,-1,y),(u=C.gm(y)).x<=s.x&&s.x+je(s)<=u.x+je(u)&&(l=new ue.Rect(s.x+je(s)-8,C.nt-16,16,16))),a&&l&&Et(o,a,i,l)))),this.wQ?(r=v,(n=Rt(t=this))&&Et(t,T+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+A,r,n)):function(e,t,r){var n,o,i,a;if(ue.needPaintSelection(e)){if(e.isEditing()||!t||0===e.selectionPolicy())return;if(i=void 0,0<(o=(n=Nt(e)).length)){for(r.save(),r.fillStyle=e.m_a()||"white",r.strokeStyle=e.getSelectionBorderColor(),a=0;a<o;a++)(i=n[a])&&(r.beginPath(),r.arc(i.x+je(i)/2,i.y+Be(i)/2,je(i)/2,0,2*Math.PI,!1),r.fill(),r.stroke());r.restore()}}}(this,this.mQ,v))},preProcessMouseDown:function(e){var t=e.e,r=this.wR;(s||r.GQ(t))&&(h(t),e.r=!0)},preProcessMouseMove:function(e){var t=e.e,r=this.wR;(s||r.IQ(t))&&(h(t),e.r=!0)},preProcessMouseUp:function(e){var t=e.e,r=this.wR;(s||r.HQ(t))&&(h(t),e.r=!0)},preProcessMouseDbClick:function(e){(s||this.CH)&&(e.r=!0)},preProcessMouseOut:function(e){s&&(e.r=!0)},preProcessMouseWheel:function(e){s&&(e.r=!0)}}),ue.Workbook.$n(p,{init:function(){this.BQ=new I},setHost:function(){this.touchToolStrip=new ke(this,this.xv())},dispose:function(){var e=this.BQ,t=this.touchToolStrip;e&&e.no(),t&&(t.no(),this.touchToolStrip=O)},onCultureChanged:function(){var e=this.touchToolStrip;e&&e.eR()}}),ue.DC.$n(p,{setHost:function(){var e=new Fe(this.Xs,this,this.OC.BQ);e.EQ(),this.wR=e},dispose:function(){var e=this.wR;e&&(e.FQ(),this.wR=O)},preProcessMouseDown:function(e){var t=this.wR,r=e.e;(s||t.GQ(r))&&(h(r),e.r=!1)},preProcessMouseMove:function(e){var t=this.wR,r=e.e;(s||t.IQ(r))&&(h(r),e.r=!1)},preProcessMouseUp:function(e){var t=this.wR,r=e.e;(s||t.HQ(r))&&(h(r),e.r=!1)},preProcessMouseDbClick:function(e){var t=We(this.OC);(s||t&&t.CH)&&(e.r=!1)},preProcessMouseOut:function(e){s&&(e.r=!1)}}),_e=".gcScrollbar",ue.hv.$n(p,{initEvents:function(e){(this.xR=new De).oR(e,!0,_e)},dispose:function(e){var t=this.xR;t&&t.oR(e,!1,_e)}})},"./dist/plugins/touch/touch.res.en.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToolStrip_PasteText="Paste",t.ToolStrip_CutText="Cut",t.ToolStrip_CopyText="Copy",t.ToolStrip_AutoFillText="AutoFill"},"./dist/plugins/validation/datavalidation-event.js":function(e,t,r){"use strict";var n,o,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe;Object.defineProperty(t,"__esModule",{value:!0}),n=r("Core"),o=r("@grapecity/js-sheets-common"),q=r("@grapecity/js-calc"),Z=r("./dist/plugins/validation/datavalidation.js"),Y=o.Common.j.Fa,K=o.Common.l,X=o.Common.u,J=n.Ul,Q=n.kf,$=J.rl(),ee=J.Ml,te=n.GC$,re=J.Nl,ne=J.hZa,oe=J.nl,ie=document,ae=Math.max,se=Math.min,le="position",ue="absolute",ce="background-color",he="z-index",fe="gcUIElement",te.extend(n.iI.prototype,{cs:function(t,r){var n,o,e,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V;function z(e,t){if(e&&e[t])return"function"==typeof e[t]?e[t]():e[t]}if((e=(o=(n=this).kj)&&o.parent)&&(o.hm()&&((i=e.getActiveSheet())&&o.name()===i.name()&&((a=o.getDataValidator(t,r))&&(s=o.getCellRect(t,r),!n.oG(s)&&(l=e.xv(),u=e.getHost(),c=J.vl(u),z(a,"showInputMessage")&&z(a,"inputMessage")&&(d=(h=X.Gb)((f=X.Ob)(z(a,"inputTitle")),"\n","<br/>"),p=h(f(z(a,"inputMessage")),"\n","<br/>"),g=re("span"),te(g).css(le,ue).css("border","1px #C0C0C0 solid").css("padding","3px 8px 3px 8px").css(ce,"#FFFFFF").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("font","normal normal normal 12px/normal Arial").width("auto").height("auto").css("top",s.y+s.height+5).css("left",s.x+s.width/2).css(he,c).html("<b>"+d+"</b><br/>"+p).attr(fe,"gcValidationInputMessage").appendTo(l),o.KH=g),a&&3===z(a,"type")&&z(a,"inCellDropdown")&&z(a,"condition"))))))){for(m=z(a,"condition").getValidListImp(o,t,r),b=z(a,"condition").CIc(),y=m.length,C=re("select"),w=o.getText(t,r),v=-1,S=ie.createDocumentFragment(),x=RegExp(String.fromCharCode(32),"g"),T=String.fromCharCode(160),A=0;A<y;A++)k=m[A].text,Y(k)||q&&k instanceof q.CalcError||(v<0&&k===w&&(v=A),k instanceof Date&&(k=K.Vb(k,"M/d/yyyy h:mm:ss")),(M=re("option")).value=k,M.text=k.replace(x,T),S.appendChild(M));C.appendChild(S),C.selectedIndex=0<v?v:0,I=o.getActualStyle(t,r),E=o._render,R=I&&I.font?I.font:E.Bl(),1<o.zoom()&&(R=E.Cl(R)),N=1,(D=o._modelManager.getSpans(Q(t,r,1,1)))&&0<D.length&&D[0]&&(N=D[0].colCount),F=r+N-1==o.getColumnCount()-1,_=o.Sl(t),P=o.parent&&o.parent.options.useTouchLayout,_=se(P?50:15,_),L=ee.safari&&($.ipad||$.iphone),O=$.android,U=G=H=j=B=void 0,U=L?(B=s.width+3,j=s.height+3,H=s.y-1.5,G=s.x-1.5,"white"):(B=ae(s.width+(F?0:_),o.defaults.colWidth),j=8<y?140:"auto",H=s.y+s.height,G=s.x+s.width+(F?0:_)-B,""),W=te(C).css("outline","none").css(le,ue).css("font",ne(R)).css(he,c).css(ce,U).width(B).height(j).css("left",G).attr(fe,"gcValidationSelect").appendTo(l).attr("size",2<y?y:2).hide().bind("click",function(){O||(n.pG(C,t,r,m,b),L&&te(o.y$).show())}).bind("keydown",function(e){13!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey?27!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey||te(C).hide():n.pG(C,t,r,m,b),L&&te(o.y$).show()}).bind("change",function(){O&&n.pG(C,t,r,m,b)}),te(u).height()<(j=W.outerHeight()+1)+H&&j<H&&(L||(H=s.y-j)),W.css("top",H),L&&W.bind("blur",function(){n.pG(C,t,r,m,b),te(o.y$).show()}),o.lm=C,(V=re("input")).type="image",V.src=Z.zW(),V.alt="v",te(V).css(le,ue).width(_).height(_).css("top",s.y+s.height-(_+3)).css("left",s.x+s.width-(F?_:0)).css(he,c).css(ce,"white").css("border","1px solid gray").attr(fe,"gcValidationButton").appendTo(l).bind("click",function(e){o.isEditing()&&!o.endEdit()||(te(o.lm).toggle().focus(),L&&te(o.y$).toggle(),oe(e))}),o.y$=V}}})},"./dist/plugins/validation/datavalidation.entry.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r("./dist/plugins/validation/datavalidation-event.js");var n=r("./dist/plugins/validation/datavalidation.js");t.CriteriaType=n.CriteriaType,t.DataValidationResult=n.DataValidationResult,t.ErrorStyle=n.ErrorStyle,t.DefaultDataValidator=n.DefaultDataValidator,t.HighlightType=n.HighlightType,t.HighlightPosition=n.HighlightPosition,t.zW=n.zW,t.bW=n.bW,t.createNumberValidator=n.createNumberValidator,t.createDateValidator=n.createDateValidator,t.createTimeValidator=n.createTimeValidator,t.createTextLengthValidator=n.createTextLengthValidator,t.createFormulaValidator=n.createFormulaValidator,t.createFormulaListValidator=n.createFormulaListValidator,t.createListValidator=n.createListValidator},"./dist/plugins/validation/datavalidation.js":function(e,t,r){"use strict";var l,n,o,u,i,a,p,g,h,s,c,m,f,d,b,y,C,O,B,j,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_;function P(e){this.id=P.w$,P.w$++,this.QAb=s(S),e&&(this.condition(e),this.condition().ignoreBlank(this.ignoreBlank())),this.n5=[]}function L(e){return a&&e&&"="===e[0]}function H(e,t,r,n){var o,i,a,s,l=m,u=m,c=m,h=m;return L(t)?l=g(t,"="):u=t,L(r)?c=g(r,"="):h=r,o=m,6===e&&((i=p(1,3,u,l)).integerValue(n),(a=p(1,5,h,c)).integerValue(n),o=p(0,1,m,m,m,m,m,i,a)),7===e&&((i=p(1,4,u,l)).integerValue(n),(a=p(1,2,h,c)).integerValue(n),o=p(0,0,m,m,m,m,m,i,a)),0<=e&&e<=5&&(o=p(1,e,u,l)).integerValue(n),(s=new M(o)).type(n?1:2),s.comparisonOperator(e),s}function G(e,t,r,n,o){var i,a,s,l,u,c=m,h=m,f=m,d=m;if(L(t)?c=g(t,"="):h=t,L(r)?f=g(r,"="):d=r,i=m,6===e&&(a=p(n,5,h,c),s=p(n,3,d,f),i=p(0,1,m,m,m,m,m,a,s)),7===e&&(a=p(n,2,h,c),s=p(n,4,d,f),i=p(0,0,m,m,m,m,m,a,s)),0<=e&&e<=5){switch(e){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}i=p(n,l,h,c)}return(u=new M(i)).type(o),u.comparisonOperator(e),u}function U(e,t,r){return G(e,t,r,5,4)}function W(e,t,r){return G(e,t,r,13,5)}function V(e,t,r){var n,o,i,a,s=m,l=m,u=m,c=m;return L(t)?s=g(t,"="):l=t,L(r)?u=g(r,"="):c=r,n=m,6===e&&(o=p(7,3,l,s),i=p(7,5,c,u),n=p(0,1,m,m,m,m,m,o,i)),7===e&&(o=p(7,4,l,s),i=p(7,2,c,u),n=p(0,0,m,m,m,m,m,o,i)),0<=e&&e<=5&&(n=p(7,e,l,s)),(a=new M(n)).type(6),a.comparisonOperator(e),a}function z(e){if(!a)return m;var t=new M(p(4,m,m,g(e,"="),4));return t.type(7),t}function q(e){if(!a)return m;var t=new M(o.Condition.fromFormula(e));return t.type(3),t}function Z(e){var t=new M(o.Condition.fromSource(e));return t.type(3),t}function Y(e,t){if(e&&t&&t.length)return t.map(function(e){return this.Tq(e)}.bind(e))}function K(e,t){var s=e.getRowCount(),l=e.getColumnCount();return t.map(function(e){return r=s,n=l,o=(t=e).rowCount,i=t.colCount,a=O(t.row,t.col,o,i),0===t.row&&o===r&&(a.row=-1),0===t.col&&i===n&&(a.col=-1),a;var t,r,n,o,i,a})}function X(e,t){var r,n,o,i,a,s,l,u,c=t.Eja;for(n=0,o=e.row,i=e.rowCount;n<i;n++,o++)if(r=c[o])for(a=0,s=e.col,l=e.colCount;a<l;a++,s++)(u=r[s])&&u.IW(e,t),r[s]=f}function J(e){var t,r,n=[];if(e)for(t in e)(r=e[t])&&n.push(r);return n}function Q(e){this.WS=e,this.Dja={},this.Eja={},this.SAb=[]}Object.defineProperty(t,"__esModule",{value:!0}),l=r("@grapecity/js-sheets-common"),n=r("Core"),o=r("ConditionalFormatting"),u=r("SheetsCalc"),i=r("@grapecity/js-calc"),a=!!i,p=o.$V,g=l.Common.u.Db,h=l.Common.j.Fa,s=l.Common.j.C4,c=n.GC$,m=null,f=void 0,b=(d=n.Ul).Pl,y=d.Ol,C=d.T$a,O=n.kf,B=Math.min,j=Math.max,w=l.Common.l,v=".validator",S={type:0,color:"red"},x={type:1,color:"red",position:1},T={type:2,color:"red",position:5,image:null},A=window,(_=t.CriteriaType||(t.CriteriaType={}))[_.anyValue=0]="anyValue",_[_.wholeNumber=1]="wholeNumber",_[_.decimalValues=2]="decimalValues",_[_.list=3]="list",_[_.date=4]="date",_[_.time=5]="time",_[_.textLength=6]="textLength",_[_.custom=7]="custom",(F=t.DataValidationResult||(t.DataValidationResult={}))[F.forceApply=0]="forceApply",F[F.discard=1]="discard",F[F.retry=2]="retry",(N=t.ErrorStyle||(t.ErrorStyle={}))[N.stop=0]="stop",N[N.warning=1]="warning",N[N.information=2]="information",(D=t.HighlightType||(t.HighlightType={}))[D.circle=0]="circle",D[D.dogEar=1]="dogEar",D[D.icon=2]="icon",(R=t.HighlightPosition||(t.HighlightPosition={}))[R.topLeft=0]="topLeft",R[R.topRight=1]="topRight",R[R.bottomRight=2]="bottomRight",R[R.bottomLeft=3]="bottomLeft",R[R.outsideLeft=4]="outsideLeft",R[R.outsideRight=5]="outsideRight",k=["errorStyle","ignoreBlank","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],P.prototype.value1=function(e,t){var r,n=this.condition(),o=n&&n.item1()?n.item1():n;return o?(r=o.formula(e,t))&&0<r.length?"="+g(c.trim(""+r),"="):o.expected():m},P.prototype.value2=function(e,t){var r,n=this.condition(),o=n&&n.item2()?n.item2():n;return o?(r=o.formula(e,t))&&0<r.length?"="+g(c.trim(""+r),"="):o.expected():m},P.prototype.isValid=function(e,t,r,n){var o,i,a,s=this.condition();if(s){if(this.ignoreBlank()&&(h(n)||""===n))return!0;if(i=void 0,!h(o=n))switch(this.type()){case 0:return!0;case 2:case 1:i=function(e){if(h(e))return 0;if("number"==typeof e)return e;if("string"==typeof e){var t=parseFloat(e);if(!isNaN(t)&&""+t===e)return t}return m}(n),h(i)||(o=i);break;case 4:case 5:i=function(e){var t,r,n,o;if(e instanceof Date)return e;if("string"!=typeof e)return m;if(!(t=l.Common.l.Qa(e)))if(isNaN(e)){if(t=new Date(e),isNaN(t.valueOf()))return m;try{if(r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,n=l.Common.u.ib(l.Common.u.Db(e.replace(/ |\n/g,"")," ")," "),(o=r.exec(n))&&4===o.length&&(-1===o.indexOf(""+t.getFullYear())||-1===o.indexOf(""+t.getMonth())||-1===o.indexOf(""+t.getDate())))return m}catch(e){return m}}else if(!(t=l.Common.l.Xb(parseFloat(e))))return m;return t}(n),h(i)||(o=i)}e&&(e.lRa=!0),a=void 0;try{a=s.evaluate(e,t,r,o,o)}catch(e){a=!0}finally{e&&(e.lRa=!1)}return a}return!0},P.prototype.reset=function(){var e=this;e.errorStyle(0),e.ignoreBlank(!0),e.inCellDropdown(!0),e.showInputMessage(!0),e.showErrorMessage(!0),e.inputTitle(""),e.errorTitle(""),e.inputMessage(""),e.errorMessage(""),e.comparisonOperator(6),e.type(0),e.condition(m),e.n5.length=0},P.prototype.getValidList=function(e,t,r){var n=this.condition();return n!==m&&3===this.type()&&12===n.conType()?n.getValidList(e,t,r):m},P.prototype.highlightStyle=function(e){var t,r;if(0===arguments.length)return this.QAb;if(!h(e)){if(this.QAb.type!==e.type)switch(e.type){case 1:this.QAb=s(x);break;case 2:this.QAb=s(T);break;default:this.QAb=s(S)}for(r in t=this.QAb)t.hasOwnProperty(r)&&e.hasOwnProperty(r)&&(t[r]=e[r]);return this.kj&&this.kj.repaint(),this}},P.prototype.toJSON=function(r){var e,n=this,o={};return k.forEach(function(e){var t=n[e]();n[e].isDefault(t)||(o[e]=t&&t.toJSON?t.toJSON(r):t)}),e=n.n5.map(function(e){return-1===e.row&&-1===e.col?O(-1,0,e.rowCount,e.colCount):e}),o.ranges=u.rangesToFormula(e,0,0,15,!1),o.highlightStyle=JSON.stringify(n.QAb),c.isEmptyObject(o)?f:o},P.prototype.fromJSON=function(o,i,a){var s,e,t,r,n;o&&!c.isEmptyObject(o)&&(s=this,o.ranges&&(s.n5=u.formulaToRanges(a,o.ranges,0,0,!0)[0].ranges),o.highlightStyle&&(s.QAb=JSON.parse(o.highlightStyle)),k.forEach(function(e){var t,r,n=o[e];y(n)&&("condition"===e?((t=p()).fromJSON(o.condition,a,i),s.condition(t,!1),(r=t.ranges())&&r.length?s.n5=r:t.ranges(s.n5),t.context(a)):s[e](n,!1))}),(e=o.validatorInfo)&&(t=a.Wu.useR1C1,r=function(e,t){var r,n,o;if(!h(e))return 1===e||2===e?r=H(t.operator,t.value1,t.value2,1===e):3===e?t.value?r=Z(t.value):t.formula&&(r=q(t.formula)):4===e||5===e?(n=t.value1,o=t.value2,n&&"/OADate("===n.substr(0,8)&&(n=w.Rka(n)),o&&"/OADate("===o.substr(0,8)&&(o=w.Rka(o)),r=(5===e?W:U)(t.operator,n,o)):6===e?r=V(t.operator,t.value1,t.value2):7===e&&void 0!==t.formula&&(r=z(t.formula)),r?r.condition():void 0}(o.type,e),n=e.operator,r&&(r.ranges(s.n5),r.ignoreBlank(s.ignoreBlank()),r.context(a),t&&C(r),s.condition(r)),h(n)||s.comparisonOperator(n)))},P.prototype.clone=function(e){var t,r;return this.Nja?((t=this.condition())&&t.initExpression(),this):((r=new P).fromJSON(this.toJSON(e),!1,e||this.kj),r.n5=[],r)},P.prototype.context=function(e){if(e){this.xc=e;var t=this.condition();t&&(t.ranges(this.n5),t.context(e))}return this.xc},P.prototype.xja=function(e){var t,r;if(e){for(t=this.n5,r=0;r<t.length;r++)if(t[r].containsRange(e))return;t.push(e)}},P.prototype.IW=function(e,t){var R,D,N,F,_,P,r,L,n=this.n5;e&&n.length&&(R=e.row,D=e.col,N=e.rowCount,F=e.colCount,P=!(_=[]),r=this.kj,L=r&&[r.getRowCount(),r.getColumnCount()],n.forEach(function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E=(r=R,n=D,o=N,i=F,a=L,(t=e).intersect(r,n,o,i)?(s=t.rowCount,l=t.colCount,u=j(0,t.row),c=j(0,t.col),d=f=h=!1,r=j(0,r),n=j(0,n),p=(a=a||[-1,-1])[0],g=a[1],-1===s&&(s=p-u,f=!0),-1===l&&(l=g-c,h=!0),-1===o&&(o=p-r),-1===i&&(i=g-n,d=!0),b=(m=u)+s-1,C=(y=c)+l-1,v=(w=r)+o-1,x=(S=n)+i-1,T=[],-1!==m&&-1!==y&&-1!==w&&-1!==S&&(0<S-y&&(A=O(m,y,f?-1:s,S-y),T.push(A)),0<C-x&&(k=O(m,1+x,f?-1:s,C-x),T.push(k)),0<w-m&&(M=O(m,j(S,y),w-m,h&&d?-1:B(x,C)-j(S,y)+1),T.push(M)),0<b-v&&(I=O(1+v,j(S,y),b-v,h&&d?-1:B(x,C)-j(S,y)+1),T.push(I))),T.PAb=!0,T):[t]);E.PAb&&(P=!0),_.push(E)}),this.n5=[].concat.apply([],_),P&&t.RAb(this))},P.prototype.l1=function(){return this.n5},P.prototype.rI=function(e,t,r){var n,o,i,a,s,l,u;if(!(e<0||t<=0)){for(this.condition()&&this.condition().initExpression(),n=0;n<this.n5.length;n++){if(i=(o=this.n5[n]).row,r&&0<r.length){for(a=!1,s=0,l=r.length;s<l;s++)if((u=r[s])&&u.row===o.row&&u.row+u.rowCount-t===o.row+o.rowCount&&o.row===e){o.rowCount+=t,a=!0;break}if(a)break}e<=i?o.row+=t:e<=i+o.rowCount&&(o.rowCount+=t)}this.condition()&&this.condition().ranges(this.n5)}},P.prototype.GR=function(o,i){if(!(o<0||i<=0)){this.condition()&&this.condition().initExpression();var a=[];this.n5.forEach(function(e){var t,r=e.row,n=e.rowCount;o<r?((t=o+i-r)<=0?r-=i:(r-=t,e.rowCount-=t),r<0&&(e.rowCount+=r,r=0),e.row=r):r<=o&&o<r+n&&(e.rowCount-=B(i,r+n-o)),(0<e.rowCount||-1===e.row&&-1===e.rowCount)&&a.push(e)}),this.n5=a,this.condition()&&this.condition().ranges(this.n5)}},P.prototype.tI=function(e,t,r){var n,o,i,a,s,l,u,c;if(!(e<0||t<=0)){for(this.condition()&&this.condition().initExpression(),n=0;n<this.n5.length;n++){if(o=this.n5[n],r&&0<r.length){for(a=i=!1,s=0,l=r.length;s<l;s++)if(!(u=r[s])||u.containsRange(o)){if(u&&u.col===o.col&&u.col+u.colCount-t===o.col+o.colCount&&u.col===e){o.colCount+=t,a=!0;break}}else i=!0;if(i)continue;if(a)break}e<=(c=o.col)?o.col+=t:e<=c+o.colCount&&(o.colCount+=t)}this.condition()&&this.condition().ranges(this.n5)}},P.prototype.HR=function(o,i){if(!(o<0||i<=0)){this.condition()&&this.condition().initExpression();var a=[];this.n5.forEach(function(e){var t,r=e.col,n=e.colCount;o<r?((t=o+i-r)<=0?r-=i:(r-=t,e.colCount-=t),r<0&&(e.colCount+=r,r=0),e.col=r):r<=o&&o<r+n&&(e.colCount-=B(i,r+n-o)),(0<e.colCount||-1===e.col&&-1===e.colCount)&&a.push(e)}),this.n5=a,this.condition()&&this.condition().ranges(this.n5)}},P.w$=1,M=P,t.DefaultDataValidator=M,I={errorStyle:b("errorStyle",0),ignoreBlank:b("ignoreBlank",!0,function(e){this.condition()&&this.condition().ignoreBlank(e)}),inCellDropdown:b("inCellDropdown",!0),showInputMessage:b("showInputMessage",!0),showErrorMessage:b("showErrorMessage",!0),inputTitle:b("inputTitle",""),errorTitle:b("errorTitle",""),inputMessage:b("inputMessage",""),errorMessage:b("errorMessage",""),comparisonOperator:b("comparisonOperator",6),condition:b("condition",m),type:b("type",0)},c.extend(M.prototype,I),t.zW=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="},t.bW=L,t.createNumberValidator=H,t.createDateValidator=U,t.createTimeValidator=W,t.createTextLengthValidator=V,t.createFormulaValidator=z,t.createFormulaListValidator=q,t.createListValidator=Z,c.extend(n.Worksheet.prototype,{getDataValidator:function(e,t,r){return h(r)&&(r=3),3===r?this.uja.Aja(e,t)[0]:f},setDataValidator:function(e,t,r,n,o,i){var a,s,l,u,c=this.uja;if(arguments.length<5&&(o=r,i=n,r=-1===e?-1:1,n=-1===t?-1:1),h(i)&&(i=3),3===i){if(a=this.getDataValidator(e,t,i),(s=1===r&&1===n)&&a===o)return;this._modelManager.zVa(),l=O(e,t,r,n),c.Cja(l),o&&c.Bja(o,l),u="validator",s&&(this.Bq(u,e,t,i,a,o),-1!==e&&-1===t?this.kq(e,i,u,o,a):-1===e&&-1!==t&&this.pq(t,i,u,o,a)),this.$p()}},isValid:function(e,t,r){var n,o=this;try{if(o.Ku=e,o.Lu=t,o.Mu=r,o.Ju=!0,n=o.getDataValidator(e,t))return n.isValid(o,e,t,r)}finally{o.Ku=-1,o.Lu=-1,o.Mu=m,o.Ju=!1}return!0},hm:function(){var e,t,r,n;return!this.x$&&(this.x$=!0,(e=this.KH)&&((t=e.parentNode)&&t.removeChild(e),this.KH=m),(r=this.y$)&&(c(r).unbind("click"),(t=r.parentNode)&&t.removeChild(r),this.y$=m),(n=this.lm)&&(c(n).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(t=n.parentNode)&&t.removeChild(n),this.lm=m),!(this.x$=!1))},tja:function(){var e,t,r,n=[],o=this.uja,i=o&&o.Dja;if(i)for(e in i)(r=(t=i[e])&&t.condition())&&r.getExpressions&&0<r.getExpressions().length&&n.push({validator:t,sheet:this});return n}}),c.extend(n.Workbook.prototype,{tja:function(){var r=[];return this.sheets.forEach(function(e){var t=e.tja();t&&t.length&&t.forEach(function(e){r.push(e)})}),r}}),c.extend(n.CellRange.prototype,{validator:function(e){var t=this.sheet,r=this.sheetArea,n=this.row,o=this.col,i=this.rowCount,a=this.colCount;return 0===arguments.length?t.getDataValidator(n,o,r):(t.setDataValidator(n,o,i,a,e,r),this)}}),Q.prototype.no=function(){this.WS=m},Q.prototype.UV=function(e){return Y(this.WS,e)},Q.prototype.EW=function(e){return K(this.WS,e)},Q.prototype.QV=function(e){var t,r,n=this.Dja;if(this.Eja={},n)for(t in n)(r=n[t])&&(e&&delete r.yja,this.FW(r,!0));this.Fja()},Q.prototype.RAb=function(e){var t=this.SAb;-1===t.indexOf(e)&&t.push(e)},Q.prototype.FW=function(t,e){var r=this,n=r.UV(t.l1()),o=r.WS,i=o.getRowCount(),a=o.getColumnCount();n&&(r.SAb.length=0,n.forEach(function(e){!function(e,t,r,n,o){var i,a,s,l,u,c,h=n.Eja,f=e.row,d=e.col,p=e.rowCount,g=e.colCount;for(t<=f+p-1&&(p=t-f),r<=d+g-1&&(g=r-d),i=0,a=f;i<p;i++,a++)for((s=h[a])||(h[a]=s={}),l=0,u=d;l<g;l++,u++)(c=s[u])&&c!==o&&c.IW(e,n),s[u]=o}(e,i,a,r,t)}),e||r.Fja())},Q.prototype.GW=function(e){var t=this,r=t.UV(e.l1());t.SAb.length=0,r.forEach(function(e){X(e,t)}),t.Fja()},Q.prototype.HW=function(e){e&&X(this.WS.Tq(e),this),this.Fja()},Q.prototype.Fja=function(){var t,e=this.SAb;e.length&&(t=this.Dja,e.forEach(function(e){e.l1().length?e.condition()&&e.condition().ranges(e.l1()):(delete t[e.id],delete e.kj)}),e.length=0)},Q.prototype.Bja=function(e,t){var r=this.WS;if(t&&(e.kj&&r!==e.kj&&(e=e.clone(r)),e.kj=r,e.xja(t)),r)return e.context(r),this.Dja[e.id]=e,this.FW(e),e},Q.prototype.Cja=function(e){if(e){var t=this.WS;this.HW(e),t.$p()}},Q.prototype.$b=function(){this.WS&&(this.Dja={},this.QV())},Q.prototype.Aja=function(e,n){var o,t,r,i=this.Dja;return 0===arguments.length?J(i):(o=[],t=this.Eja,e===f&&(e=-1),n===f&&(n=-1),-1===e&&-1===n?J(i):(-1!==e&&-1!==n?(r=t[e])&&r[n]&&o.push(r[n]):-1===e?c.each(t,function(e,t){var r=t[n];r&&-1===o.indexOf(r)&&o.push(r)}):(r=t[e])&&c.each(r,function(e,t){t&&-1===o.indexOf(t)&&o.push(t)}),o))},Q.prototype._V=function(e,t,r,n){var o,i,a=this.Dja;if(a)for(o in a)(i=a[o])&&(r?i.rI(e,t,n):i.tI(e,t,n));this.QV()},Q.prototype.rI=function(e,t,r){this._V(e,t,!0,r)},Q.prototype.tI=function(e,t,r){this._V(e,t,!1,r)},Q.prototype.aW=function(e,t,r){var n,o,i=this.Dja;if(i)for(n in i)(o=i[n])&&(r?o.GR(e,t):o.HR(e,t),0===o.n5.length&&(i[n]=f));this.QV()},Q.prototype.GR=function(e,t){this.aW(e,t,!0)},Q.prototype.HR=function(e,t){this.aW(e,t,!1)},Q.prototype.toJSON=function(e){var t,r,n=this.Dja,o=[];for(t in n)(r=n[t])&&o.push(r.toJSON(e));return o},Q.prototype.fromJSON=function(e,r,n){var o=this,i=o.WS;o.Dja={},e&&e.length&&(e.forEach(function(e){var t=new M;t.fromJSON(e,r,n),t.kj=i,o.Dja[t.id]=t}),o.QV())},Q.prototype.vja=function(e,t,r){this.WS.setDataValidator(e,t,r)},E=Q,c.extend(n.lUa.prototype,{zVa:function(){var e,t,r,n,o,i=this.zTa;if(i&&!i.AVa){for(r in t=[],e=this.uja.Dja)(n=e[r])&&(o=n.n5.map(function(e){return O(e.row,e.col,e.rowCount,e.colCount)}),t.push({validator:n,ranges:o}));i.AVa=t}},BVa:function(e){var t,r;e&&(t=this.uja,r={},e.forEach(function(e){var t=e.validator;t.n5=e.ranges,t.condition()&&t.condition().ranges(t.n5),r[t.id]=t}),t.Dja=r,t.QV(!1))},CVa:function(e,t,r){this.zVa(),this.uja.rI(e,t,r)},DVa:function(e,t){this.zVa(),this.uja.GR(e,t)},EVa:function(e,t,r){this.zVa(),this.uja.tI(e,t,r)},FVa:function(e,t){this.zVa(),this.uja.HR(e,t)},GVa:function(e){this.zVa(),this.uja.HW(e)},HVa:function(){this.zVa(),this.uja.QV()}}),n.lUa.$n("validator",{init:function(){this.uja=new E(this.kj)},undo:function(e){var t=e.AVa;t&&this.BVa(t)},dispose:function(e){!1!==(e&&e.clearCache)&&this.uja&&(this.uja.no(),this.uja=m)}}),n.Worksheet.$n("validator",{init:function(){var r=this;r.uja=r._modelManager.uja,r._unbind(n.Events.FloatingElementSelected+v),r._bind(n.Events.FloatingElementSelected+v,function(e,t){"worksheet"!==t.type&&r.hm()})},dispose:function(e){this.hm(),e.clearCache&&this.uja.$b(),!1!==e.clearCache&&this._unbind(n.Events.FloatingElementSelected+v)},onLayoutChanged:function(e){var t=e.changeType,r=e.row,n=e.rowCount,o=e.col,i=e.colCount,a=e.sheetArea,s=this._modelManager,l=this.tables;"addRows"===t?s.CVa(r,n,l&&l.KFc(r,-1,n,-1,!0)):"deleteRows"===t?s.DVa(r,n):"addColumns"===t?s.EVa(o,i,l&&l.KFc(-1,o,-1,i,!1)):"deleteColumns"===t?s.FVa(o,i):"clear"===t?3===a&&2==(2&e.type)&&s.GVa(O(r,o,n,i)):"setColumnCount"!==t&&"setRowCount"!==t||3!==a&&1!==a||s.HVa()},toJson:function(e,t){var r,n=this.uja,o=t&&t.ignoreStyle;!n||o||(r=n.toJSON(this))&&r.length&&(e.validations=r)},fromJson:function(e,t,r){var n,o=r&&r.ignoreStyle;e&&e.validations&&!o&&(n=e.validations,this.uja.fromJSON(n,t,this))}}),n.Style.$n("validator",{fromJson:function(e){if("validator"===e.p){var t=new M;t.fromJSON(e.v,e.noSchema,e.context),this.validator=t,e.r=!0}}}),A.Yl.km.push(function(e,t){!t&&e.hm&&e.hm()})},"./node_modules/process/browser.js":function(e,t){var r,n,o,i,a,s,l=e.exports={};function u(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function h(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}function f(){i&&a&&(i=!1,a.length?o=a.concat(o):s=-1,o.length&&d())}function d(){var e,t;if(!i){for(e=h(f),i=!0,t=o.length;t;){for(a=o,o=[];++s<t;)a&&a[s].run();s=-1,t=o.length}a=null,i=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===c||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(e){r=u}try{n="function"==typeof clearTimeout?clearTimeout:c}catch(e){n=c}}(),i=!(o=[]),s=-1,l.nextTick=function(e){var t,r=Array(arguments.length-1);if(1<arguments.length)for(t=1;t<arguments.length;t++)r[t-1]=arguments[t];o.push(new p(e,r)),1!==o.length||i||h(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=g,l.addListener=g,l.once=g,l.off=g,l.removeListener=g,l.removeAllListeners=g,l.emit=g,l.prependListener=g,l.prependOnceListener=g,l.listeners=function(e){return[]},l.binding=function(e){throw Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw Error("process.chdir is not supported")},l.umask=function(){return 0}},"./node_modules/util/node_modules/inherits/inherits_browser.js":function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;function r(){}r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},"./node_modules/util/support/isBufferBrowser.js":function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},"./node_modules/util/util.js":function(e,R,p){(function(a){var e,n,r,t,o=Object.getOwnPropertyDescriptors||function(e){var t,r=Object.keys(e),n={};for(t=0;t<r.length;t++)n[r[t]]=Object.getOwnPropertyDescriptor(e,r[t]);return n},s=/%[sdj%]/g;function l(e,t){var r={seen:[],stylize:u};return 3<=arguments.length&&(r.depth=arguments[2]),4<=arguments.length&&(r.colors=arguments[3]),w(t)?r.showHidden=t:t&&R.Ia(r,t),T(r.showHidden)&&(r.showHidden=!1),T(r.depth)&&(r.depth=2),T(r.colors)&&(r.colors=!1),T(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),m(r,e,r.depth)}function i(e,t){var r=l.styles[t];return r?"["+l.colors[r][0]+"m"+e+"["+l.colors[r][1]+"m":e}function u(e,t){return e}function m(t,r,n){var e,o,i,a,s,l,u,c,h,f,d,p,g;if(t.customInspect&&r&&I(r.inspect)&&r.inspect!==R.inspect&&(!r.constructor||r.constructor.prototype!==r))return x(e=r.inspect(n,t))||(e=m(t,e,n)),e;if(o=function(e,t){if(T(t))return e.stylize("undefined","undefined");if(x(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return S(t)?e.stylize(""+t,"number"):w(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}(t,r))return o;if(i=Object.keys(r),f={},i.forEach(function(e,t){f[e]=!0}),a=f,t.showHidden&&(i=Object.getOwnPropertyNames(r)),M(r)&&(0<=i.indexOf("message")||0<=i.indexOf("description")))return b(r);if(0===i.length){if(I(r))return s=r.name?": "+r.name:"",t.stylize("[Function"+s+"]","special");if(A(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(k(r))return t.stylize(Date.prototype.toString.call(r),"date");if(M(r))return b(r)}return l="",u=!1,c=["{","}"],C(r)&&(u=!0,c=["[","]"]),I(r)&&(l=" [Function"+(r.name?": "+r.name:"")+"]"),A(r)&&(l=" "+RegExp.prototype.toString.call(r)),k(r)&&(l=" "+Date.prototype.toUTCString.call(r)),M(r)&&(l=" "+b(r)),0!==i.length||u&&0!=r.length?n<0?A(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),h=u?function(t,r,n,o,e){var i,a,s=[];for(i=0,a=r.length;i<a;++i)E(r,i+"")?s.push(y(t,r,n,o,i+"",!0)):s.push("");return e.forEach(function(e){e.match(/^\d+$/)||s.push(y(t,r,n,o,e,!0))}),s}(t,r,n,a,i):i.map(function(e){return y(t,r,n,a,e,u)}),t.seen.pop(),p=l,g=c,60<(d=h).reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)?g[0]+(""===p?"":p+"\n ")+" "+d.join(",\n  ")+" "+g[1]:g[0]+p+" "+d.join(", ")+" "+g[1]):c[0]+l+c[1]}function b(e){return"["+Error.prototype.toString.call(e)+"]"}function y(e,t,r,n,o,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),E(n,o)||(a="["+o+"]"),s||(e.seen.indexOf(l.value)<0?-1<(s=v(r)?m(e,l.value,null):m(e,l.value,r-1)).indexOf("\n")&&(s=i?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),T(a)){if(i&&o.match(/^\d+$/))return s;a=(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),e.stylize(a,"string"))}return a+": "+s}function C(e){return Array.isArray(e)}function w(e){return"boolean"==typeof e}function v(e){return null===e}function S(e){return"number"==typeof e}function x(e){return"string"==typeof e}function T(e){return void 0===e}function A(e){return c(e)&&"[object RegExp]"===h(e)}function c(e){return"object"==typeof e&&null!==e}function k(e){return c(e)&&"[object Date]"===h(e)}function M(e){return c(e)&&("[object Error]"===h(e)||e instanceof Error)}function I(e){return"function"==typeof e}function h(e){return Object.prototype.toString.call(e)}function f(e){return e<10?"0"+e.toString(10):e.toString(10)}function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function d(e,t){if(!e){var r=Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}R.format=function(e){var t,r,n,o,i,a;if(!x(e)){for(t=[],r=0;r<arguments.length;r++)t.push(l(arguments[r]));return t.join(" ")}for(r=1,o=(n=arguments).length,i=(e+"").replace(s,function(e){if("%%"===e)return"%";if(o<=r)return e;switch(e){case"%s":return n[r++]+"";case"%d":return+n[r++];case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),a=n[r];r<o;a=n[++r])i+=v(a)||!c(a)?" "+a:" "+l(a);return i},R.deprecate=function(e,t){if(void 0!==a&&!0===a.noDeprecation)return e;if(void 0===a)return function(){return R.deprecate(e,t).apply(this,arguments)};var r=!1;return function(){if(!r){if(a.throwDeprecation)throw Error(t);a.traceDeprecation?console.trace(t):console.error(t),r=!0}return e.apply(this,arguments)}},e={},R.debuglog=function(t){if(T(n)&&(n=a.env.NODE_DEBUG||""),t=t.toUpperCase(),!e[t])if(RegExp("\\b"+t+"\\b","i").test(n)){var r=a.pid;e[t]=function(){var e=R.format.apply(R,arguments);console.error("%s %d: %s",t,r,e)}}else e[t]=function(){};return e[t]},(R.inspect=l).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},R.isArray=C,R.isBoolean=w,R.isNull=v,R.isNullOrUndefined=function(e){return null==e},R.isNumber=S,R.isString=x,R.isSymbol=function(e){return"symbol"==typeof e},R.isUndefined=T,R.isRegExp=A,R.isObject=c,R.isDate=k,R.isError=M,R.isFunction=I,R.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},R.isBuffer=p("./node_modules/util/support/isBufferBrowser.js"),r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],R.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[f(e.getHours()),f(e.getMinutes()),f(e.getSeconds())].join(":"),[e.getDate(),r[e.getMonth()],t].join(" ")),R.format.apply(R,arguments))},R.inherits=p("./node_modules/util/node_modules/inherits/inherits_browser.js"),R.Ia=function(e,t){var r,n;if(!t||!c(t))return e;for(n=(r=Object.keys(t)).length;n--;)e[r[n]]=t[r[n]];return e},t="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0,R.promisify=function(i){if("function"!=typeof i)throw new TypeError('The "original" argument must be of type Function');if(t&&i[t]){var e;if("function"!=typeof(e=i[t]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,t,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){var r,n,e,t=new Promise(function(e,t){r=e,n=t}),o=[];for(e=0;e<arguments.length;e++)o.push(arguments[e]);o.push(function(e,t){e?n(e):r(t)});try{i.apply(this,o)}catch(r){n(r)}return t}return Object.setPrototypeOf(e,Object.getPrototypeOf(i)),t&&Object.defineProperty(e,t,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,o(i))},R.promisify.custom=t,R.callbackify=function(i){if("function"!=typeof i)throw new TypeError('The "original" argument must be of type Function');function e(){var e,t,r,n,o=[];for(e=0;e<arguments.length;e++)o.push(arguments[e]);if("function"!=typeof(t=o.pop()))throw new TypeError("The last argument must be of type Function");r=this,n=function(){return t.apply(r,arguments)},i.apply(this,o).then(function(e){a.nextTick(n,null,e)},function(e){a.nextTick(d,e,n)})}return Object.setPrototypeOf(e,Object.getPrototypeOf(i)),Object.defineProperties(e,o(i)),e}}).call(this,p("./node_modules/process/browser.js"))},"./node_modules/webpack/buildin/global.js":function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},"./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js":function(e,t,r){var n,o,i="object"==typeof i?i:{};function a(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}i.Spread=i.Spread||{},i.Spread.CalcEngine=i.Spread.CalcEngine||{},i.Spread.CalcEngine.AdvancedFunctions=(o={},a.m=n={"./src/advancedFunctions.entry.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("CalcEngine");t.Functions=n.Functions,r("./src/functions-db.ts"),r("./src/functions-eng.ts"),r("./src/functions-fin.ts"),r("./src/functions-lookup.ts"),r("./src/functions-stat.ts")},"./src/functions-db.ts":function(e,t,r){"use strict";var a,l,m,g,b,y,C,w,v,n,S,x,o,T,i,s,A,u,c,h;function f(e,t,r){this.Gk=e,this.Hk=t,this.Wob=r}function d(e,t,r){var n=this;if(n.cj=0,n.Jk=e,n.Kk=r,n.Xob={},3===arguments.length){if(n.Lk=n.Mk(e,t),e.rowCount<2||e.colCount<1||r.rowCount<2||r.colCount<1||n.Lk<0||n.Jk.colCount<=n.Lk)throw i}else if(2===arguments.length&&(n.Lk=-1,e.rowCount<2||e.colCount<1||r.rowCount<2||r.colCount<1))throw i}function p(e,t,r,n){for(var o,i=0,a=new A(e,t,r);a.Pk();)o=a.Ok(),(o=n?b(o):o)&&i++;return C(i)}function k(e,t,r,n,o,i,a){for(var s,l,u,c,h=a?1:0,f=0,d=0,p=new A(e,t,r);p.Pk();)if(s=p.Ok(),b(s)){if(l=g(s),x(l))return v;h=a?h*l:h+l,f+=l*l,d++}else if(y(s))return s;return i||a?C(h):(u=Math.max(0,(d*f-h*h)/(d*(d-o))),c=n?Math.sqrt(u):u,d<=1?w:C(c))}Object.defineProperty(t,"__esModule",{value:!0}),a=r("Common"),l=r("CalcEngine"),m=a.Common.q,g=l.Convert.Pa,b=l.Convert.Na,y=l.Convert.vf,C=l.Convert.Nh,w=l.Errors.DivideByZero,v=l.Errors.Value,n=l.Functions.ak,S=l.Functions.jk,x=isNaN,o=a.Common.u,T=o.kb,i=l.sR().Exp_InvalidCast,f.prototype.Ik=function(e){var t=l.evaluateOperator({"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14}[this.Gk],e,this.Hk);return!!l.Functions.ik(t)&&l.Convert.Vh(t)},s=f,d.prototype.Mk=function(e,t){var r,n;if(S(t)){for(r=0;r<e.colCount;r++)if((n=l.Convert.bc(e[0][r]))&&this.Nk(n,t))return r;return-1}return l.Convert.Rh(t)-1},d.prototype.Ok=function(){if(this.cj<=0||this.Jk.rowCount<=this.cj)throw l.sR().Exp_InvalidOperation;return this.Jk[this.cj][this.Lk]},d.prototype.Pk=function(){for(var e=!1,t=this.Jk.rowCount;!e&&this.cj<t;)this.cj++,this.cj<t&&(e=this.Qk());return e},d.prototype.Rk=function(e){var t,r,n,o,i;if(S(e)){for(t=["=","<>","<=",">=","<",">"],r=l.Convert.bc(e),o=n=void 0,n=0;n<t.length;n++)if(a.Common.u.kb(r,t[n]))return r=r.substring(t[n].length),i=a.Common.o.lb(r),x(i)?this.Nk("true",r)?e=!0:this.Nk("false",r)?e=!1:(e=r,o=0===n):e=i,new s(t[n],e,o);return new s("=",e)}return e?new s("=",e):null},d.prototype.Yob=function(e,t){var r,n=this.Xob,o=[e,t].join(","),i=n[o];return i||n[r="_"+o]||(i=n[o]=this.Rk(this.Kk[e][t]),n[r]=!0),i},d.prototype.Qk=function(){var e,t,r,n,o,i,a,s,l,u=!1,c=this.Kk,h=this.cj,f=c.rowCount,d=c.colCount,p=this.Jk,g=this.Zob;if(!g){for(n=c[0],g=[],t=0;t<d;t++){if((r=this.Mk(p,n[t]))<0)return!1;g[t]=r}this.Zob=g}for(e=1;!u&&e<f;e++)for(u=!0,t=0;u&&t<d;t++)if(o=this.Yob(e,t)){if(i=p[h][g[t]],"="===o.Gk&&(a=o.Hk,S(a)&&S(i))){s=m.ub(a,!0),l=o.Wob,u=s?m.sb("^"+s+(l?"$":"")).test(i):l?i.toLowerCase()===a.toLowerCase():T(i,a,!0);continue}u=o.Ik(i)}return u},d.prototype.Nk=function(e,t){return e.toLowerCase()===t.toLowerCase()},A=d,n("DAVERAGE",function(e,t,r){for(var n,o,i=0,a=0,s=new A(e,t,r);s.Pk();){if(n=s.Ok(),y(n))return n;if(b(n)){if(o={value:0},!l.Convert.Th(n,o))return v;i+=o.value,a++}}return 0===a?w:C(i/a)},3,3,h=[c={Yi:!0,Hi:4,Ii:0},{Yi:!0},c],u="!= 1",u),n("DCOUNT",function(e,t,r){return p(e,t,r,!0)},3,3,h,u,u),n("DCOUNTA",function(e,t,r){return p(e,t,r,!1)},3,3,h,u,u),n("DGET",function(e,t,r){var n,o=new A(e,t,r);return o.Pk()?(n=o.Ok(),o.Pk()?l.Errors.Number:n):v},3,3,h,u,u),n("DMAX",function(e,t,r){for(var n,o,i=!1,a=-l.Functions.hk,s=new A(e,t,r);s.Pk();){if(n=s.Ok(),y(n))return n;if(b(n)){if(o=g(n),x(o))return v;(!i||a<o)&&(a=o),i=!0}}return i?C(a):0},3,3,h,u,u),n("DMIN",function(e,t,r){for(var n,o,i=!1,a=l.Functions.hk,s=new A(e,t,r);s.Pk();){if(n=s.Ok(),y(n))return n;if(b(n)){if(o=g(n),x(o))return v;(!i||n<a)&&(a=n),i=!0}}return i?C(a):0},3,3,h,u,u),n("DPRODUCT",function(e,t,r){return k(e,t,r,!1,0,!1,!0)},3,3,h,u,u),n("DSTDEV",function(e,t,r){return k(e,t,r,!0,1)},3,3,h,u,u),n("DSTDEVP",function(e,t,r){return k(e,t,r,!0,0)},3,3,h,u,u),n("DSUM",function(e,t,r){return k(e,t,r,!1,0,!0)},3,3,h,u,u),n("DVAR",function(e,t,r){return k(e,t,r,!1,1)},3,3,h,u,u),n("DVARP",function(e,t,r){return k(e,t,r,!1,0)},3,3,h,u,u)},"./src/functions-eng.ts":function(e,t,r){"use strict";var n,d,k,o,C,F,_,P,L,p,i,a,s,O,l,M,f,u,c,h,B,g,m,b,y,w,v,S,x,T,A,I,E,R,D,N,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,Ee,Re,De,Ne,Fe,_e,Pe,Le,Oe;function Be(e,t){return new d.Functions.Ui(e,t)}function je(e,t){return{Ld:e,Sk:t}}function He(e,t){var r,n=[];for(r=0;r<k(e);r++)n.push(je(e[r],t[r]));return n.push(je(null,0)),n}function Ge(e,t,r){var n,o,i,a,s,l,u,c=100,h=.5*e,f=h*h;for(h=p(h,O(t)),n=d.Functions.tk(t),o=1,i=0,a=O(t),l=.9*(s=h/n),u=!1;s!==l&&0!==c;)h*=f,n*=++i,o*=++a,l=s,s=r||u?s+h/n/o:s-h/n/o,c--,u=!u;return s}function Ue(e,t){var r=p(t,10),n=parseInt(e,t);return l(n)?f:r/2<=n?n-r:n}function We(e,t,r){e<0&&(e+=p(t,10));var n,o=e.toString(t),i=r-k(o);for(n=0;n<i;n++)o="0"+o;return o.toUpperCase()}function Ve(e,t){var r=Ue(e,t);return g(r)?f:r}function ze(e,t,r){var n=We(e,r,t.Qb);return 0<=n&&t.Qb<k(n)&&t.$i?f:n}function qe(e,t,r,n,o){var i,a=Ue(e,r);return g(a)||o&&(a<-o||o-1<a)?f:(i=We(a,n,t.Qb),0<=a&&t.Qb<k(i)&&t.$i?f:i)}function Ze(e,t){var r=Number.POSITIVE_INFINITY,n=e.Pi(),o=e.Qi();return l(n)||n===r||l(o)||o===r?f:e.bc(t)}function Ye(e,t,r,n){var o=e,i=t,a=r.Pi(),s=r.Qi();return{Ri:e=n?o*a-i*s:o+a,Si:t=n?o*s+i*a:i+s}}function Ke(e,t){var r,n,o,i,a,s,l,u,c=t?1:0,h=0;for(n=0;n<k(e);n++)if(d.Convert.Ca(e[n]))for(l=e[n],o=0;o<l.rowCount;o++)for(i=0;i<l.columnCount;i++){if(!(r=y(l.getValue(o,i))))return f;c=(s=Ye(c,h,r,t)).Ri,h=s.Si}else if(d.Convert._isReference(e[n]))for(u=e[n],a=0;a<u.getRangeCount();a++)for(o=0;o<u.getRowCount(a);o++)for(i=0;i<u.getColumnCount(a);i++){if(!(r=y(u.getValue(a,o,i))))return f;c=(s=Ye(c,h,r,t)).Ri,h=s.Si}else{if(!(r=y(e[n])))return f;c=(s=Ye(c,h,r,t)).Ri,h=s.Si}return Ze(Be(c,h))}function Xe(e,t){var r=h(e*P(2)),n=2*r-1;return t.$i&&(n=2*(r=h(t.Qb*P(2)))-1-n),n}function Je(e){return 1-Xe(e,{$i:!1})}function Qe(e){var t,r=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"];for(t=0;r[t];t++)if(0===e.localeCompare(r[t]))return;return 1}function $e(e,t,r){var n,o,i=0,a=1;for(n=0;e[n].Ld;n++)if(0===r.localeCompare(e[n].Ld))return{Tk:!0,Uk:a,Vk:i=e[n].Sk};if(t)for(n=0;t[n].Ld;n++)r.substr(0,1)===t[n].Ld.substr(0,1)&&Qe(r)&&(a=t[n].Sk);for(n=0;e[n].Ld;n++)if(o=k(e[n].Ld),r.substr(1,o)===e[n].Ld.substr(0,o)&&Qe(r))return{Tk:!0,Uk:a,Vk:i=e[n].Sk};return{Tk:!1,Uk:a,Vk:i}}function et(e){if(!(0<=ke.indexOf(e))){var t=[e.slice(0,1),e.slice(1)],r=t[0],n=t[1];return 0<=xe.indexOf(r)&&0<=ke.indexOf(n)}}function tt(e){for(var t=0;t<G.length;t++)if(e===G[t].Ld)return 1;return"sec"===e.slice(1)||"s"===e.slice(1)}function rt(e){var t,r,n,o,i,a,s;if(-1<e.indexOf(Ce.bit)?(n=(t=[e.slice(0,-3),e.slice(-3)])[0],i=t[1]):-1<e.indexOf(Ce.byte)&&(n=(r=[e.slice(0,-4),e.slice(-4)])[0],i=r[1]),n)for(s=0;Ae[s].Ld;s++)n===Ae[s].Ld&&(o=Ae[s].Sk);else o=1;return i===Ce.bit?a=ye[0].Sk:i===Ce.byte&&(a=ye[1].Sk),{Uk:o,Vk:a}}function nt(e){var t,r,n=1;if(we[e])return{unit:e,prefixNumber:n};if("K"!==we[e.slice(1)]&&"kel"!==we[e.slice(1)])return{unit:void 0,prefixNumber:n};for(t=e.slice(0,1),e=e.slice(1),r=0;Te[r].Ld;r++)t===Te[r].Ld&&(n=Te[r].Sk);return{unit:e,prefixNumber:n}}function ot(e,t,r,n){var o,i;if(""===e&&""===t)return u;if(i={value:0},!0!==v(e,o={value:0})||!0!==v(t,i))return u;if(t=i.value,(e=o.value)<0||w<e||e%1!=0)return f;if("bitOperator"===r){if(t<0||w<t||t%1!=0)return f}else if("shiftOperator"===r&&0===e)return 0;return n(e,t)}function it(e,t){if(""===e)return f;if(!0===e||!1===e)return u;var r=y(e);return r?t(r):f}function at(e){var t=e.Pi(),r=e.Qi();return Be(F(t)*b(r,!1),_(t)*b(r,!0))}function st(e){var t=e.Pi(),r=e.Qi();return Be(_(t)*b(r,!1),-(F(t)*b(r,!0)))}function lt(e){var t=e.Pi(),r=e.Qi();return Be(b(t,!0)*_(r),b(t,!1)*F(r))}function ut(e){var t=e.Pi(),r=e.Qi();return Be(b(t,!1)*_(r),b(t,!0)*F(r))}function ct(e,t){var r,n,o=e.Pi(),i=e.Qi(),a=t.Pi(),s=t.Qi();return Math.abs(s)<Math.abs(a)?Be((o+i*(r=s/a))/(a+s*r),(i-o*r)/(a+s*r)):Be((i+o*(n=a/s))/(s+a*n),(i*n-o)/(s+a*n))}function ht(e,t){return e.Pi()===t.Pi()&&e.Qi()===t.Qi()}Object.defineProperty(t,"__esModule",{value:!0}),n=r("Common"),d=r("CalcEngine"),k=n.Common.k.ac,o=void 0,C=Math.abs,F=Math.sin,_=Math.cos,P=Math.sqrt,L=Math.log,p=Math.pow,i=Math.exp,a=Math.E,s=Math.atan2,O=parseFloat,l=isNaN,M=d.Errors.NotAvailable,f=d.Errors.Number,u=d.Errors.Value,c=d.Functions.ak,h=d.Functions.qk,B=d.Convert.Nh,g=d.Convert.vf,m=d.Functions.MathHelper,b=m.Dk,y=d.Functions.Wi,w=0xffffffffffff,v=d.Convert.Th,S=Be(1,0),x=.00220462262184878,E=He(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,685217658567918e-19,x,602214179421676e9,.0352739619495804,15.432358352941462,T=x/100,T,A=x/112,A,A,.00015747304441777001,110231131092439e-20,I=x/2240,I,I]),N=(D=(R=1e4/254)/12)/3,H=He(["m","mi","Nmi","in","ft","yd","ang","Pica","ell","ly","pc","pica","survey_mi","parsec","Picapt"],[1,.000621371192237334,1/1852,R,D,N,1e10,2834.64566929134,.8748906386701663,105700083402462e-30,j=324077928966473e-31,236.2204724409449,.00062136994949495,j,2834.64566929134]),G=He(["yr","day","hr","mn","sec","d","min","s"],[1,365.25,8766,525960,31557600,365.25,525960,31557600]),U=He(["Pa","atm","mmHg","p","at","psi","Torr"],[1,986923266716013e-20,.007500637554192,1,986923266716013e-20,.000145037737730209,.0075006168270417]),W=He(["N","dyn","lbf","dy","pond"],[1,1e5,.22480894309971,1e5,101.971621297793]),z=He(["HP","W","h","w","PS"],[1,V=745.69987158227,1,V,1.013869665424]),X=He(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,1e-7,K=.239005736137667,K,q=624150964712042e4,Z=1/(3600*V),1/3600,.737562149277265,Y=.000947817120313317,q,Z,1/3600,Y]),J=He(["T","ga"],[1,1e4]),le=He(["tsp","tspm","tbs","oz","cup","pt","qt","uk_qt","gal","uk_gal","l","uk_pt","us_pt","lt","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Pica3","Pica^3","Picapt3","Picapt^3","GRT","regton","MTON","L"],[1,.98578431875,1/3,1/6,1/48,1/96,1/192,.00433684471160932,1/768,.00108421117790233,Q=.00492892159375,.00867368942321863,1/96,Q,$=1e27*Q,$,1/32256,.000139870932189991,ee=.00017406322338,ee,.30078125,.30078125,te=82073596535e-54,te,re=492892159375e-17,re,ne=118251117638e-26,ne,oe=64467860511e-16,oe,ie=775941468987e-27,ie,ae=112266,ae,ae,ae,se=1740632233796e-18,se,4351580584491e-18,Q]),ue=He(["admkn","kn","m/h","m/hr","m/s","m/sec","mph"],[1,1.00063930885529,1853.184,1853.184,.514773333333333,.514773333333333,1.15151515151515]),be=He(["m2","m^2","ft2","ft^2","in2","in^2","yd2","yd^2","uk_acre","us_acre","ang2","ang^2","ar","ha","Morgen","mi2","mi2","Nmi2","Nmi^2","Pica2","Picapt2","Pica^2","Picapt^2","ly2","ly^2"],[1,1,ce=10.7639104167097,ce,he=144*ce,he,fe=ce/9,fe,.000247105381467165,.000247104393046628,1e20,1e20,.01,1e-4,4e-4,de=fe/3097600,de,pe=2.91553349598123e-7,pe,ge=8035216.07043214,ge,ge,ge,me=111725076312873e-46,me]),ye=He(["bit","byte"],[1,.125]),Ce={bit:"bit",byte:"byte"},we={K:"K",kel:"kel",cel:"cel",C:"C",F:"F",fah:"fah",Rank:"Rank",Reau:"Reau"},ve=273.15,Se=459.67,Te=He(xe=["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),Ae=He(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24,Math.pow(2,80),Math.pow(2,70),Math.pow(2,60),Math.pow(2,50),Math.pow(2,40),Math.pow(2,30),Math.pow(2,20),Math.pow(2,10)]),ke=["sg","lbm","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","uk_ton","lcwt","hweight","stone","uk_ton","LTON","brton","ton","mi","Nmi","in","ft","yd","ell","Pica","survey_mi","Picapt","psi","Torr","lbf","HP","h","PS","HPh","flb","BTU","hh","btu","tsp","tspm","tbs","oz","cup","pt","us_pt","uk_pt","qt","UK_qt","gal","uk_gal","barrel","bushel","ft3","ft^3","in3","in^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON","kn","admkn","uk_acre","us_acre","ft2","ft^2","in2","in^2","ly2","ly^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Pica2","Picapt^2","Pica^2","Picapt^2","yd2","yd^2"],Ie={Hi:5},Ne={Hi:8},Fe={Hi:8,Oi:!0},Pe=[{Hi:0,aj:"<= 0"},De={Hi:2,aj:"< 0"}],Le=[Me={Hi:0},{Hi:0,_i:0}],Oe=[Ee={Hi:5,aj:["checkLength 10"]},Re={Zi:!0,Hi:2,_i:1,aj:["< 1","> 10"]}],c("BESSELI",function(e,t){return B(Ge(e,t,!0))},2,2,_e=[Me,De]),c("BESSELJ",function(e,t){return B(Ge(e,t,!1))},2,2,_e),c("BESSELK",function(e,t){var r,n,o,i,a,s,l,u,c,h=17976931348623157e292,f=.5772156649015329,d=0,p=.25*e*e,g=1,m=0,b=1,y=2/e;if(0<t){for(m=-f,i=1;i<t;i++)m+=1/i,g*=i+1;if(b=y,1===t)d=1/e;else{for(r=a=g/t,i=l=s=1;i<t;i++){if(r+=n=(a/=t-i)*(l*=-p)/(s*=i),h-C(n)<C(r)||1<y&&h/y<b)return h;b*=y}if(n=C(r*=.5),1<b&&h/b<n||1<n&&h/n<b)return h;d=r*b}}for(c=-f,n=0===t?(m=c,1):(m+=1/t,1/g),r=(c+m-(u=2*L(e/2)))*n,o=1;n*=p/(o*(o+t)),c+=1/o,m+=1/(o+t),o++,11102230246251565e-32<C(n/(r+=(c+m-u)*n)););return r=.5*r/b,0!=(1&t)&&(r=-r),B(d+=r)},2,2,Pe),c("BESSELY",function(e,t){var d=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],p=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],g=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],m=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],b=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],y=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],C=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],w=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],v=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],S=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],x=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],T=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],f=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],A=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],k=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],M=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],I=.7978845608028654,E=2.356194490192345,R=.7853981633974483;function D(e,t,r,n){var o=0,i=O(t[o++]),a=r;for(n&&(i+=e,a--);i=i*e+O(t[o++]),0!=--a;);return i}function N(e,t){var r,n,o,i,a,s=t?d:p,l=t?g:m,u=t?b:y,c=t?C:w,h=t?k:M;return e<=5?(n=e*e,t&&e<1e-5?1-n/4:(o=(n-(t?5.783185962946784:14.681970642123893))*(n-(t?30.471262343662087:49.2184563216946)),o*=r=D(n,t?f:A,3)/D(n,h,8,!0),t?o:o*e)):(r=5/e,o=D(n=t?25/(e*e):r*r,s,6)/D(n,l,6),i=D(n,u,7)/D(n,c,7,!0),(o=o*_(a=e-(t?R:E))-r*i*F(a))*I/P(e))}function s(e,t){var r,n,o,i,a,s=t?d:p,l=t?g:m,u=t?b:y,c=t?C:w,h=t?x:T,f=t?7:8;return e<=5?(r=(t?1:e)*D(n=e*e,t?v:S,t?7:5)/D(n,h,f,!0),r+=.6366197723675814*(t?L(e)*N(e,!0):N(e,!1)*L(e)-1/e)):(r=5/e,o=D(n=t?25/(e*e):r*r,s,6)/D(n,l,6),i=D(n,u,7)/D(n,c,7,!0),(o=o*F(a=e-(t?R:E))+r*i*_(a))*I/P(e))}return B(function(e,t){var r,n=s(e,!0),o=s(e,!1),i=1,a=2*i;if(0===t)return n;if(1===t)return o;for(;r=a*o/e-n,n=o,o=r,a+=2,++i<t;);return r}(e,t))},2,2,Pe),c("BIN2DEC",function(e){return Ve(e,2)},1,1,Ee),c("BIN2HEX",function(e,t){return qe(e,t,2,16)},1,2,Oe,o,o,{bk:1}),c("BIN2OCT",function(e,t){return qe(e,t,2,8)},1,2,Oe,o,o,{bk:1}),c("DEC2BIN",function(e,t){return ze(e,t,2)},1,2,[{Hi:0,aj:["< -512","> 511"]},Re],o,o,{bk:1}),c("DEC2HEX",function(e,t){return ze(e,t,16)},1,2,[{Hi:0,aj:["< -549755813888","> 549755813887"]},Re],o,o,{bk:1}),c("DEC2OCT",function(e,t){return ze(e,t,8)},1,2,[{Hi:0,aj:["< -536870912","> 536870911"]},Re],o,o,{bk:1}),c("HEX2BIN",function(e,t){return qe(e,t,16,2,512)},1,2,Oe,o,o,{bk:1}),c("HEX2DEC",function(e){return Ve(e,16)},1,1,Ee),c("HEX2OCT",function(e,t){return qe(e,t,16,8,536870912)},1,2,Oe,o,o,{bk:1}),c("OCT2BIN",function(e,t){return qe(e,t,8,2,512)},1,2,Oe,o,o,{bk:1}),c("OCT2DEC",function(e){return Ve(e,8)},1,1,Ee),c("OCT2HEX",function(e,t){return qe(e,t,8,16,549755813888)},1,2,Oe,o,o,{bk:1}),c("ERF",Xe,1,2,[Me,{Zi:!0,Hi:0}],o,o,{bk:1}),c("ERF.PRECISE",function(e){return Xe(e,{$i:!1})},1,1,Me),c("ERFC",Je,1,1,Me),c("ERFC.PRECISE",Je,1,1,Me),c("DELTA",function(e,t){return d.Zh.Yh(e,t)?1:0},1,2,Le,o,o,{bk:1}),c("GESTEP",function(e,t){return t<=e?1:0},1,2,Le,o,o,{bk:1}),c("COMPLEX",function(e,t,r){return"i"!==r&&"j"!==r?d.Errors.Value:Ze(Be(e,t),r)},2,3,[Me,Me,{Hi:5,_i:"i"}],o,o,{bk:2}),c("IMABS",function(e){return B(P(e.Ri*e.Ri+e.Si*e.Si))},1,1,Ne),c("IMAGINARY",function(e){return B(e.Si)},1,1,Ne),c("IMARGUMENT",function(e){return 0===e.Ri&&0===e.Si?d.Errors.DivideByZero:B(s(e.Si,e.Ri))},1,1,Ne),c("IMCONJUGATE",function(e){return Ze(Be(e.Ri,-e.Si))},1,1,Ne),c("IMCOS",function(e){return Ze(Be(_(e.Ri)*b(e.Si,!1),-F(e.Ri)*b(e.Si,!0)))},1,1,Ne),c("IMDIV",function(e,t){var r=e.Ri,n=e.Si,o=t.Ri,i=t.Si;return Ze(Be((r*o+n*i)/(o*o+i*i),(n*o-r*i)/(o*o+i*i)))},2,2,[Ne,Fe]),c("IMEXP",function(e){return Ze(Be(i(e.Ri)*_(e.Si),i(e.Ri)*F(e.Si)))},1,1,Ne),c("IMLN",function(e){var t=e.Ri,r=e.Si;return Ze(Be(L(P(t*t+r*r)),s(r,t)))},1,1,Fe),c("IMLOG10",function(e){var t=e.Ri,r=e.Si,n=m.Ek(a,10);return Ze(Be(n*L(P(t*t+r*r)),n*s(r,t)))},1,1,Fe),c("IMLOG2",function(e){var t=e.Ri,r=e.Si,n=m.Ek(a,2);return Ze(Be(n*L(P(t*t+r*r)),n*s(r,t)))},1,1,Fe),c("IMREAL",function(e){return B(e.Ri)},1,1,Ne),c("IMSIN",function(e){return Ze(Be(F(e.Ri)*b(e.Si,!1),_(e.Ri)*b(e.Si,!0)))},1,1,Ne),c("IMSQRT",function(e){var t,r,n=e.Ri,o=e.Si;return 0===n&&0===o?"0":(t=P(n*n+o*o),r=s(o,n),Ze(Be(P(t)*_(r/2),P(t)*F(r/2))))},1,1,Ne),c("IMSUB",function(e,t){return Ze(Be(e.Ri-t.Ri,e.Si-t.Si))},2,2,[Ne,Ne]),c("IMPOWER",function(e,t){var r,n,o=e.Ri,i=e.Si;return 0===o&&0===i?0<t?"0":f:(r=P(o*o+i*i),n=s(i,o),Ze(Be(p(r,t)*_(t*n),p(r,t)*F(t*n))))},2,2,[Ne,{Hi:2}]),c("IMPRODUCT",function(){return Ke(arguments,!0)},1,255,o,-1,-1),c("IMSUM",function(){return Ke(arguments,!1)},1,255,o,-1,-1),c("CONVERT",function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A;if(nt(t).unit&&nt(r).unit)return function(e,t,r){var n,o=nt(t);switch(o.unit){case we.Rank:n=function(e,t){var r,n=nt(t);switch(n.unit){case we.Rank:return e;case we.Reau:return.8*(e-Se-32)*5/9;case we.C:case we.cel:return 5*(e-Se-32)/9;case we.F:case we.fah:return e-Se;case we.K:case we.kel:return r=n.prefixNumber,(ve+5*(e-Se-32)/9)/r}}(e,r);break;case we.Reau:n=function(e,t){var r,n=nt(t);switch(n.unit){case we.Rank:return 1.25*e*9/5+32+Se;case we.Reau:return e;case we.C:case we.cel:return 1.25*e;case we.F:case we.fah:return 1.25*e*9/5+32;case we.K:case we.kel:return r=n.prefixNumber,(1.25*e+ve)/r}}(e,r);break;case we.C:case we.cel:n=function(e,t){var r,n=nt(t);switch(n.unit){case we.Rank:return 9*e/5+32+Se;case we.Reau:return.8*e;case we.cel:case we.C:return e;case we.F:case we.fah:return 9*e/5+32;case we.K:case we.kel:return r=n.prefixNumber,(e+ve)/r}}(e,r);break;case we.F:case we.fah:n=function(e,t){var r,n=nt(t);switch(n.unit){case we.Rank:return e+Se;case we.Reau:return 4*(e-32)/9;case we.F:case we.fah:return e;case we.C:case we.cel:return 5*(e-32)/9;case we.K:case we.kel:return r=n.prefixNumber,(5*(e-32)/9+ve)/r}}(e,r);break;case we.K:case we.kel:n=function(e,t){var r,n=nt(t);switch(n.unit){case we.Rank:return 9*e/5;case we.Reau:return.8*(e-ve);case we.C:case we.cel:return e-ve;case we.F:case we.fah:return 9*(e-ve)/5+32;case we.K:case we.kel:return r=n.prefixNumber,e/r}}(e*o.prefixNumber,r)}return n}(e,t,r);if(g=r,m=-1<(p=t).indexOf("bit")||-1<p.indexOf("byte"),b=-1<g.indexOf("bit")||-1<g.indexOf("byte"),1==(n=m&&b?2:b||m?1:0))return M;if(2==n)return y=e,C=r,w=rt(t),v=rt(C),y*w.Uk/w.Vk*v.Vk/v.Uk;if(tt(t)&&tt(r))return S=e,x=r,T=$e(G,Te,t),A=$e(G,Te,x),S*T.Uk/T.Vk*A.Vk/A.Uk;if(et(t)||et(r))return M;for(o=[E,H,U,W,X,z,J,le,J,ue,be],i=0;i<k(o);i++)if(l=(s=$e(a=o[i],Te,t)).Tk,u=s.Vk,c=s.Uk,h=(s=$e(a,Te,r)).Tk,f=s.Uk,d=s.Vk,l&&h&&0!==u&&0!==f)return e*c/u*d/f;return M},3,3,[{Hi:1},Ie,Ie]),c("BITAND",function(e,t){return ot(e,t,"bitOperator",function(e,t){return e&t})},0,2),c("BITLSHIFT",function(e,t){return ot(e,t,"shiftOperator",function(e,t){if(48<=t)return f;if(t<0&&e<1<<-t)return 0;var r=e<<t;return w<r?f:r})},0,2),c("BITOR",function(e,t){return ot(e,t,"bitOperator",function(e,t){return e|t})},0,2),c("BITRSHIFT",function(r,n){return ot(r,n,"shiftOperator",function(e,t){return 53<t?f:0<=n?r>>n:r<<-n})},0,2),c("BITXOR",function(e,t){return ot(e,t,"bitOperator",function(e,t){return e^t})},0,2),c("IMCOSH",function(e){return it(e,function(e){return Ze(ut(e),e.lja())})},1,1),c("IMCOT",function(e){return it(e,function(e){return ht(at(e),Be(0,0))?f:Ze(ct(st(e),at(e)),e.lja())})},1,1),c("IMCSC",function(e){return it(e,function(e){return ht(e,Be(0,0))?f:Ze(ct(S,at(e)),e.lja())})},1,1),c("IMCSCH",function(e){return it(e,function(e){return ht(lt(e),Be(0,0))?f:Ze(ct(S,lt(e)),e.lja())})},1,1),c("IMSEC",function(e){return it(e,function(e){return ht(st(e),Be(0,0))?f:Ze(ct(S,st(e)),e.lja())})},1,1),c("IMSECH",function(e){return it(e,function(e){return ht(ut(e),Be(0,0))?f:Ze(ct(S,ut(e)),e.lja())})},1,1),c("IMSINH",function(e){return it(e,function(e){return Ze(lt(e),e.lja())})},1,1),c("IMTAN",function(e){return it(e,function(e){return Ze(ct(at(t=e),st(t)),e.lja());var t})},1,1)},"./src/functions-fin.ts":function(e,t,r){"use strict";var y,s,C,l,w,n,D,F,v,p,b,S,a,u,c,g,A,x,T,_,k,i,M,m,f,I,E,h,N,o,d,R,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce;function we(e){return e.getMonth()}function ve(e){return e.getDate()}function Se(e){return e.getFullYear()}function xe(e){return e instanceof Date?y.Common.l.Ra(e):e}function Te(e,t,r){var n=Se(t)-Se(e),o=we(t)-we(e)+12*n,i=ve(t)-ve(e),a=-1;return 0===r?a=s.Functions.uk(e,t):0<=D(r,[1,2,3])?a=xe(t)-xe(e):4===r&&(a=30*o+i),a}function Ae(e,t,r,n,o){var i,a=T(1+e,t),s=l(a)?a:N;return 0===e?t:S(s)||(i=l(a=(a-1)/e)?a:N,S(i))?N:l(a=(-r*s-n)/((1+e*o)*i))?a:N}function ke(e,t,r,n){var o=Se(t),i=we(t),a=ve(t),s=new Date(1,0,1),l=0,u=a===O(o,i),c=12/r,h=o-Se(e);for(s.setFullYear(1),0<h&&(h=(h-1)*r);h++,(s=new Date(o,i,a)).setMonth(i-h*c),u&&(l=O(Se(s),we(s)),s=new Date(Se(s),we(s),l)),B(e,s)<0;);return n&&(h--,(s=new Date(o,i,a)).setMonth(i-h*c),u&&(l=O(Se(s),we(s)),s=new Date(Se(s),we(s),l))),s}function Me(e,t,r,n){return j(ke(e,t,r,!1),e,n)}function Ie(e,t,r,n){return 0<=D(n,[0,2,4,5])?360/r:3===n?365/r:j(ke(e,t,r,!1),ke(e,t,r,!0),1)}function Ee(e,t,r,n){return j(e,ke(e,t,r,!0),n)}function Re(e,t,r){var n=Se(t),o=we(t),i=ve(t),a=new Date(n,o,i),s=o-we(e)+12*(n-Se(e));if(a.setMonth(we(a)-s),i===O(n,o))for(;ve(a)!==O(Se(a),we(a));)a.setDate(ve(a)+1);return ve(e)>=ve(a)&&s--,w(""+(1+s/(12/r)))}function De(e,t,r){return 0<t?(r.Wk?r.Xk?_(e-r.Yk)<_(r.Zk-r.Yk)&&(r.Zk=e,r.$k=t):t<r.$k&&(r.Zk=e,r.$k=t):(r.Zk=e,r.$k=t,r.Wk=!0),[!1,r]):t<0?(r.Xk?r.Wk?_(e-r.Zk)<_(r.Zk-r.Yk)&&(r.Yk=e,r._k=t):-t<-r._k&&(r.Yk=e,r._k=t):(r.Yk=e,r._k=t,r.Xk=!0),[!1,r]):isNaN(t)?[!1,r]:(r.al=e,[!0,r])}function Ne(e,t,r,n,o){var i,a=ke(e,r,n,!0),s=ke(e,r,n,!1);if(0<=B(a,t))return j(e,t,o)/Ie(s,a,n,o);for(i=j(e,a,o)/Ie(s,a,n,o);;){if(s=new Date(Se(a),we(a),ve(a)),a.setMonth(we(a)+12/n),0<=B(a,t))return i+j(s,t,o)/Ie(s,a,n,o);i+=1}}function Fe(e,t,r,n,o,i,a){var s,l=Me(e,t,i,a),u=Ee(e,t,i,a),c=Ie(e,t,i,a),h=w(""+Re(e,t,i)),f=0,d=100*r/i,p=1+n/i,g=u/c;for(s=0;s<h;s++)f+=d/T(p,g+s);return o/T(p,h-1+u/c)+f-l/c*d}function _e(e,t,r,n,o,i,a,s,l){var u,c,h,f=j(s,e,a),d=j(e,l,a),p=j(s,l,a),g=Ie(e,t,i,a),m=w(""+Re(e,t,i)),b=100*r/i,y=1+n/i;if(g<d)switch(a){case 0:case 4:u=j(l,t,a),m=1+w(""+k(u/g));break;default:for(c=new Date(Se(l),we(l),ve(l)),m=0;m<32767;m++)if(h=new Date(Se(c),we(c),ve(c)),c.setMonth(we(c)+12/i),0<=B(c,t)){m+=w(""+k(j(h,t,a))/Ie(h,c,i,a))+1;break}f=g*Ne(s,e,l,i,a),d=g*Ne(e,l,l,i,a),p=g*Ne(s,l,l,i,a)}return o/T(y,m-1+d/g)+b*(p/g/T(y,d/g)+T(y,-d/g)*(T(y,-m)-1/y)/(1/y-1)-f/g)}function Pe(e,t){var r=e.substr(0,3),n={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return n[r]?R(n[r],t):-1}function Le(e,t,r,n,o){var i=T(1+e,t);return-(0===e?n+r*t:n*i+r*(0<o?1+e:1)*(i-1)/e)}function Oe(e,t,r,n,o,i,a){if(i<o||r<i||0!==a&&1!==a)return N;var s,l,u,c,h,f,d,p,g,m=(h=n,f=0,d=a,g=T(1+(u=t),c=r),0===u?p=(h+f)/c:(p=f*u/(g-1)+h*u/(1-1/g),0<d&&(p/=1+u)),-p),b=0;for(1===o&&(e&&(b=m),a<=0&&(b+=e?n*t:-n),o++),s=o;s<=i;s++)l=0<a?Le(t,s-2,m,n,1)-m:Le(t,s-1,m,n,0),b+=e?m-l*t:l;return e?b:b*t}function Be(e,t,r,n){var o=T(1+r,n),i=-(e*o*r+t*(o-1));return l(i)?i:N}function je(e,t,r,n,o){return D(n,[1,2,4])<0||0<=B(t,r)?N:e(t,r,n,o)}function He(e,t,r,n,o,i){if(D(i,[1,2,4])<0||0<B(t,r))return N;var a=function(e,t,r,n){var o,i=0,a=0;for(e*=100/c(r),t/=r,t++,o=1;o<n;o++)i+=o*e/T(t,o);for(i+=n*(e+100)/T(t,n),o=1;o<n;o++)a+=e/T(t,o);return(i/=a+=(e+100)/T(t,n))/c(r)}(n,o,i,Re(t,r,i));return e?a/(1+o/i):a}function Ge(e,t,r,n,o,i,a,s,l){var u,c,h,f;if(D(a,[1,2,4])<0||0<B(t,r)||0<B(n,t))return N;for(u=new Date(Se(n),we(n),ve(n));u.setMonth(we(u)+12/a),B(u,r)<0;);return c=Ne(n,t,u,a,s),h=Ne(n,r,u,a,s),f=Ne(t,r,u,a,s),e?(i*a+100*o*(h-c*(1+l*f/a)))/(l*f+a):(a*(i-l)+100*o*(h-c))/(f*l+100*o*c*f/a)}function Ue(e,t,r){var n,o,i;return 0===r?E:(n=(t<0?k:m)(t),o=T(10,k(d.Ek(r,10))),i=t-n,a(n+(e?i*o/r:i*r/o)))}function We(e,t,r,n){var o,i,a=p(t),s=0,l=1+e,u=0;if(.75<=l&&l<=1.25&&12<a&&n&&(u=2.5),r)for(o=0;o<a;o++){if(i=-(o-u)*t[o]*Math.pow(l,-(o-u)-1),isNaN(i))return s;s+=i}else for(o=0;o<a;o++){if(i=t[o]*Math.pow(l,-(o-u)),isNaN(i))return s;s+=i}return s}function Ve(e,t,r,n){var o,i,a=0,s=p(t);for(e<=-1&&(e=1e-10-1),o=0;o<s;o++){if((i=xe(n[o])-xe(n[0]))<0)return[!1,r];a+=t[o]/d.Ck(e,i/365)}return l(a)?r=isNaN(a)?5e-324:a:a===Number.POSITIVE_INFINITY?r=P:a===Number.NEGATIVE_INFINITY&&(r=-P),[!0,r]}function ze(e,t,r,n){var o,i,a;return-1<e&&0!==e?(i=T(1+e,(o=r).bl-(n?1:0)),a=(T(1+e,o.bl)-1)/e,[!0,t=n?-o.cl*a/e+i*o.bl*(o.dl+o.cl*(o.Nc+1/e)):o.dl*i+o.cl*(1+e*o.Nc)*a+o.el,r]):[!1,t,r]}function qe(e,t,r,n,o,i,a,s,l,u,c,h,f,d,p){var g,m,b,y,C=0,w=0,v=r-o,S=r+o,x=2===e;if(v<i.fl&&(v=r),S>i.gl&&(S=r),v===S)return x?[!1,n,i,a]:[!1,n,i];if(m=0===e?(g=t(a,s,l,v,c,h,f,d,p)-u,t(a,s,l,S,c,h,f,d,p)-u):1===e?(g=t(v,a,C,s),t(S,a,w,s)):(g=ze(v,C,a),ze(S,w,a)),F(g)){if(y=g[2],C=g[1],!(b=g[0]))return x?[b,n,i,y]:[b,n,i]}else C=g;if(F(m)){if(y=m[2],w=m[1],!(b=m[0]))return x?[b,n,i,y]:[b,n,i]}else w=m;return n=(w-C)/(S-v),x?[!0,n,i,y]:[!0,n,i]}function Ze(e,t,r,n,o,i,a,s,l,u,c,h,f){var d;return n<r.fl||n>r.gl?[!1,r]:(r=(d=De(n,e?We(n,o):t(o,i,a,n,l,u,c,h,f)-s,r))[1],[!!d[0],r])}function Ye(e,t,r){var n,o,i=0;return t<e.fl||t>e.gl?[!1,e,r]:(r=(n=ze(t,i,r))[2],i=n[1],n[0]?(e=(o=De(t,i,e))[1],[!!o[0],e,r]):[n[0],e,r])}function Ke(e,t,r,n,o,i,a,s,l,u){var c,h,f,d,p=0,g=e?15:2;if(!r.Wk||!r.Xk)return e?[!1,r,n]:[!1,r];for(h=_(r.Zk-r.Yk)/(_(r.Zk)+_(r.Yk)),c=0;c<100+4*g;c++)if(0,f=c%4==0?1:c%4==2?2:3,r=(d=e?Qe(r,n,h,p,0,f):t?$e(!0,r,p,0,0,f,Ve,h,o,n,qe):$e(!1,r,p,0,0,f,Fe,h,i,a,s,n,o,l,u))[1],e&&(n=d[2]),p=e?d[3]:d[2],d[0])return e?[!0,r,n]:[!0,r];return e?[!1,r,n]:[!1,r]}function Xe(e,t,r,n,o,i,a,s,l,u,c,h,f){var d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D=r.hl/2,N=!1;for(p=0;p<20;p++){if(n<r.fl||n>r.gl){if(!e||r.Xk&&r.Wk||!(n<=-1))return[!1,r];n=-1,N=!0}if(b=e?Ve(n,o,0,i):t(o,i,a,n,l,u,c,h,f)-s,F(b)){if(m=b[1],!(g=b[0]))return[g,r]}else m=b;if(r=(y=De(n,m,r))[1],y[0])return[!0,r];if(N)return[!1,r];if(C=r.Xk&&r.Wk?_(r.Zk-r.Yk):r.gl-r.fl,w=(_(n)<1e-10?C:_(n))/1e6,v=0,r=(y=e?qe(1,Ve,n,v,w,r,o,i):qe(0,t,n,v,w,r,o,i,a,s,l,u,c,h,f))[2],v=y[1]<0?y[1]:-y[1],!(g=y[0]))return[g,r];if(0===v)return[!1,r];if((S=n-1.000001*m/v)===n)return r.al=n,[!0,r];if(e&&r.Xk&&r.Wk&&(S<(T=(x=[r.Zk,r.Yk])[0])==S<(A=x[1])&&(k=!0,A<T&&(T=(d=[A,T])[0],A=d[1],k=!1),I=(M=[r.$k,r._k])[0],E=M[1],S=T+_((k?I:E)/(E-I))*(A-T))),R=_(S-n)/(_(n)+_(S)),n=S,R<D)return r.al=n,[!0,r]}return[!1,r]}function Je(e,t,r,n){var o,i,a,s,l,u;for(o=0;o<32;o++){if(r<e.fl||r>e.gl)return[!1,e];if(e=(a=De(r,i=We(r,t,!1,!0),e))[1],a[0])return[!0,e];if(0===(s=We(r,t,!0,!0)))return[!1,e];if((l=r-1.0000001*i/s)===r)return e.al=r,[!0,e];if(u=_(l-r)/(_(r)+_(l)),r=l,u<n)return e.al=r,[!0,e]}return[!1,e]}function Qe(e,t,r,n,o,i){var a,s,l,u,c,h,f;if(1===i){if(t=(s=ze(a=(e.Zk+e.Yk)/2,o,t))[2],o=s[1],!s[0])return[A,e,t,n];if(0===o)return[!0,e=De(a,o,e)[1],t,n];if(0===M(o*o-e.$k*e._k))return[A,e,t,n]}else if(2===i){if(l=void 0,c=u=0,.1<r)return Qe(e,t,r,n,o,i=3);if(0==(h=n++%4))l=e.Zk,u=e.$k;else if(2==h)l=e.Yk,u=e._k;else if(t=(s=ze(l=(e.Zk+e.Yk)/2,u,t))[2],u=s[1],!s[0])return[A,e,t,n];if(t=(f=qe(2,void 0,l,c,_(e.Zk-e.Yk)/1e6,e,t))[3],e=f[2],c=f[1],!f[0]||0===c)return[A,e,t,n];if((a=l-1.01*u/c)<e.Zk&&a<e.Yk||a>e.Zk&&a>e.Yk)return[A,e,t,n]}return[!1,e,t,n]}function $e(e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m){var b,y,C,w,v,S,x,T;switch(i){case 0:n=t.Zk-t.$k*((t.Yk-t.Zk)/(t._k-t.$k));break;case 1:if(n=(t.Zk+t.Yk)/2,b=e?a(n,u,o,l):a(h,f,l,n,c,d,p,g,m)-u,F(b)){if(o=b[1],!b[0])return[A,t,r,n,o,i]}else o=b;if(0===o)return[!0,t=De(n,o,t)[1],r,n,o,i];if(0===(y=M(o*o-t.$k*t._k)))return[A,t,r,n,o,i];n+=(n-t.Zk)*o/y;break;case 3:n=(t.Zk+t.Yk)/2;break;case 2:if(C=void 0,w=0,S=0,.1<s)return $e(e,t,r,n,o,i=3,a,s,l,u,c,h,f,d,p);if(0==(x=r++%4))C=t.Zk,w=t.$k;else if(2==x)C=t.Yk,w=t._k;else if(C=(t.Zk+t.Yk)/2,b=e?a(C,u,w,l):a(h,f,l,C,c,d,p,g,m)-u,F(b)){if(w=b[1],!b[0])return[A,t,r,n,o,i]}else w=b;if(v=_(t.Zk-t.Yk)/1e6,t=(T=e?c(1,a,C,S,v,t,u,l):qe(0,a,C,S,v,t,h,f,l,u,c,d,p,g,m))[2],S=T[1],!T[0]||0===S)return[A,t,r,n,o,i];if((n=C-1.01*w/S)<t.Zk&&n<t.Yk||n>t.Zk&&n>t.Yk)return[A,t,r,n,o,i]}return b=e?a(n,u,o,l):a(h,f,l,n,c,d,p,g,m)-u,F(b)&&(o=b[1],!b[0])?[A,t,r,n,o,i]:De(n,o,t)[0]?[!0,t,r,n,o,i]:(s=_(t.Zk-t.Yk)/(_(t.Zk)+_(t.Yk)))<t.hl?(t._k<o&&(o=t._k,n=t.Yk),t.$k<o&&(o=t.$k,n=t.Zk),t.al=n,[!0,t,r,n,o,i]):[!1,t,r,n,o,i]}function et(e,t){var r,n,o,i=arguments,a=0,s=1;for(n=1;n<p(i);n++){if((o=u(i[n],1,!0,!0,!1,!0)).isError)return o[0];for(r=0;r<p(o);r++)o[r]!==g&&(a+=o[r]/T(1+e,s++))}return a}function tt(e,t,r){return xe(ke(e,t,r,!0))}function rt(e,t,r){return xe(ke(e,t,r,!1))}function nt(e,t,r,n){var o,i,a=n.hl,s=n.Xk&&n.Wk?[n.Zk,n.Yk]:function(e,t,r,n){for(var o=r-.5,i=r+.5,a=0;0<Ve(o,e,0,t)[1]*Ve(i,e,0,t)[1]&&a++<n;)o-=.5,i+=.5;return n<=a?[0,0]:[o,i]}(e,t,r,100),l=s[0],u=s[1],c=Ve(l,e,0,t)[1],h=Ve(u,e,0,t)[1],f=0;for(o=0;o<100&&!(0<c*h);o++)if((i=Ve(f=(l+u)/2,e,0,t)[1])*c<0?(u=f,h=i):(l=f,c=i),_(l-u)<a)return[_(i)<1||_(c+h)<1,f];return[!1,f]}function ot(e,t,r,n,o){var i,a,s=o/r;return(i=(1<=s?(s=1)===n?e:0:e*T(1-s,n-1))-((a=e*T(1-s,n))<t?t:a))<0?0:i}function it(e,t,r,n,o,i){var a,s,l,u=0,c=0,h=k(o),f=h,d=e-t,p=!1;for(l=1;l<=f;l++)p?s=c:(a=ot(e,t,r,l,i))<(c=d/(n-(l-1)))?(s=c,p=!0):d-=s=a,l===f&&(s*=o+1-h),u+=s;return u}function at(e,t,r,n){var o,i,a;return""===e&&""===t&&""===r?h:(e=G(e,o={value:0}),t=G(t,i={value:0}),r=G(r,a={value:0}),!0===e&&!0===t&&!0===r?n(o,i,a):h)}Object.defineProperty(t,"__esModule",{value:!0}),y=r("Common"),s=r("CalcEngine"),C=y.Common.j.C4,l=isFinite,w=parseInt,n=y.Common.j,D=n.Ea,F=n.Ca,v=n.Fa,p=y.Common.k.ac,b=s.Convert.Rh,S=s.Convert.vf,a=s.Convert.Nh,u=s.Convert.Ph,c=s.Convert.Pa,g=s.Convert.CalcConvertedError,A=null,x=void 0,T=Math.pow,_=Math.abs,k=Math.ceil,i=Math.log,M=Math.sqrt,m=Math.floor,f=Math.max,I=Math.min,E=s.Errors.DivideByZero,h=s.Errors.Value,N=s.Errors.Number,o=s.Functions.ak,d=s.Functions.MathHelper,R=d.Ak,P=s.Functions.hk,L=s.Functions.lk,O=s.Functions.nk,B=s.Functions.mk,j=s.Functions.pk,H=s.Functions.vk,G=s.Convert.Th,z={Hi:0,aj:"< 1"},q={Hi:0,aj:"< 0"},Z={_i:.1,Hi:0},Y={_i:2,Hi:0},K={_i:1e3,Hi:0,aj:"<= 0"},Q={_i:!(J={Hi:5}),Hi:7},re={_i:0,Hi:2},oe={Hi:2,aj:"= 0",bj:E},ae={Hi:4,Ii:1,Ji:!0,Ki:!0},se={Hi:4,Ii:1,Ji:!0,Mi:!0,Ki:!0},le={Hi:4,Ii:4,Ji:!0,Ki:!0,Mi:!0,breakOnConvertError:!0},ue={Hi:4,Ii:1,Ji:!0,Ki:!0,breakOnConvertError:!0},ce={Hi:4,Ii:11,Ji:!0,Ki:!0,breakOnConvertError:!0},he=[X={Hi:6},X,$={Hi:2},ne={_i:0,Hi:2,aj:["< 0","> 4"]}],fe=[X,X,U={Hi:0},U,$,ne],de=[X,X,V={Hi:0,aj:"<= 0"}],pe=[U,X,X,U,$,V,{_i:0,Hi:2,aj:["< 0","> 4","= 2"]}],me=[X,X,V,V,ne],be=[V,ee={Hi:2,aj:"<= 0"},V,te={Hi:2,aj:"< 1"},$,$],ye=[V,te],Ce=[U,ie={Hi:2,aj:"< 0"}],o("FV",function(e,t,r,n,o){o=o?1:0;var i=T(1+e,t);return a(-(i=0===e?r*t+n:n*i+r*(1+e*o)*(i-1)/e))},3,5,ge=[U,U,U,W={_i:0,Hi:0},W],x,x,{bk:[3,4]}),o("FVSCHEDULE",function(e,t){for(var r=0;r<p(t);r++)t[r]!==g&&(e*=1+t[r]);return e},2,2,[U,ae],1,1),o("NPV",et,2,x,U,"> 0","> 0"),o("PV",function(e,t,r,n,o){if(o=o?1:0,0===e)return a(-(r*t+n));var i=T(1+e,t);return-1===e?E:a(-(n+r*(1+e*o)*(i-1)/e)/i)},3,5,ge,x,x,{bk:[3,4]}),o("RECEIVED",function(e,t,r,n,o){var i,a,s;return 0<=B(e,t)?N:(i=Te(e,t,o),a=L(e,o),i<=0||a<=0?N:(s=1-n*i/a)<=0?N:r/s)},4,5,me,x,x,{bk:3}),o("XNPV",function(e,t,r){var n,o=p(t),i=0;if(o!==p(r))return N;if(t.some(function(e){return e===g}))return h;for(n=0;n<o;n++)i+=t[n]/T(1+e,(r[n]-r[0])/365);return i},3,3,[U,ue,ue],"!= 0","!= 0"),o("CUMIPMT",function(e,t,r,n,o,i){return Oe(!1,e,t,r,n,o,i)},6,6,be),o("CUMPRINC",function(e,t,r,n,o,i){return Oe(!0,e,t,r,n,o,i)},6,6,be),o("IPMT",function(e,t,r,n,o,i){return r+1<=t||0!==i&&1!==i?N:Be(n,Ae(e,r,n,o,i),e,t-1)},4,6,[U,z,z,U,W,re],x,x,{bk:[4,5]}),o("ISPMT",function(e,t,r,n){return a(n*e*(t/r-1))},4,4,[U,$,oe,U]),o("PMT",function(e,t,r,n,o){o=o?1:0;var i=T(1+e,t);return a(-(i=0===e?(r+n)/t:(r*i+n)/((1+e*o)*(i-1)/e)))},3,5,[U,{Hi:0,aj:"= 0",bj:E},U,W,W],x,x,{bk:[3,4]}),o("PPMT",function(e,t,r,n,o,i){var a,s;return i=i?1:0,r+1<=t?N:(a=Ae(e,r,n,o,i),S(a)||(s=Be(n,a,e,t-1),S(s))?N:a-s)},4,6,[U,z,U,U,W,W],x,x,{bk:[4,5]}),o("COUPDAYBS",function(e,t,r,n){return je(Me,e,t,r,n)},3,4,he,x,x,{bk:3}),o("COUPDAYS",function(e,t,r,n){return je(Ie,e,t,r,n)},3,4,he,x,x,{bk:3}),o("COUPDAYSNC",function(e,t,r,n){return je(Ee,e,t,r,n)},3,4,he,x,x,{bk:3}),o("COUPNCD",function(e,t,r){return je(tt,e,t,r)},3,4,he,x,x,{bk:3}),o("COUPNUM",function(e,t,r){return je(Re,e,t,r)},3,4,he,x,x,{bk:3}),o("COUPPCD",function(e,t,r){return je(rt,e,t,r)},3,4,he,x,x,{bk:3}),o("DURATION",function(e,t,r,n,o){return He(!1,e,t,r,n,o)},5,6,fe,x,x,{bk:5}),o("MDURATION",function(e,t,r,n,o){return n<0||r<0?N:He(!0,e,t,r,n,o)},5,6,fe,x,x,{bk:5}),o("NPER",function(e,t,r,n,o){return o=o?1:0,0===e?0===t?E:a(-(r+n)/t):a(i((t*(1+e*o)-n*e)/(r*e+t*(1+e*o)))/i(1+e))},3,5,[{Hi:0,aj:"<= -1"},U,U,W,W],x,x,{bk:[3,4]}),o("YIELD",function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d;if(D(i,[1,2,4])<0||0<B(e,t))return N;if(Re(e,t,i)<=1)return s=Me(e,t,i,a),l=Ee(e,t,i,a),(o/100+r/i-(n/100+s/(u=Ie(e,t,i,a))*r/i))/(n/100+s/u*r/i)*(i*u/l);if(f=(d=Xe(!(f={fl:0,gl:1e3,hl:1e-10,Wk:!(h=.1),Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0}),Fe,f,h,e,t,r,n,o,i,a))[1],!(c=d[0])){for(h=1e-10;h<f.gl;h*=2)f=Ze(!1,Fe,f,h,e,t,r,n,o,i,a)[1];f=(d=Ke(!1,!1,f,e,t,r,n,o,i,a))[1],c=d[0]}return c?f.al:N},6,7,[X,X,q,V,V,$,ne],x,x,{bk:6}),o("YIELDDISC",function(e,t,r,n,o){return 0<=B(e,t)?N:(n/r-1)/H(e,t,o)},4,5,[X,X,V,V,ne],x,x,{bk:3}),o("YIELDMAT",function(e,t,r,n,o,i){var a;return 0<=B(e,t)?N:(a=1+H(r,t,i)*n,a/=o/100+H(r,e,i)*n,a--,a/=H(e,t,i))},5,6,[X,X,X,q,V,ne],x,x,{bk:5}),o("AMORDEGRC",function(e,t,r,n,o,i,a){var s=1/i;return 0<s&&s<1||1<s&&s<2||2<s&&s<3||4<s&&s<5||0<B(t,r)?N:function(e,t,r,n,o,i,a){var s,l,u,c,h,f=1/i;if(i*=f<3?1:f<5?1.5:f<=6?2:2.5,c=H(t,r,a),S(c))return 0;for(u=(e-=l=m(c*i*e+.5))-n,s=0;s<o;s++){if((u-=l=m(i*e+.5))<0)return 0==(h=o-s)||1==h?m(.5*e+.5):0;e-=l}return l}(e,t,r,n,o,i,a)},6,7,pe,x,x,{bk:6}),o("AMORLINC",function(e,t,r,n,o,i,a){return 0<B(t,r)?N:(u=o,p=(s=e)*(c=i),g=s-(l=n),m=H(t,r,a),S(m)?0:(d=b(f=(s-l-(h=m*c*s))/p),0===u?h:u<=d?p*(f<1?f:1):u===d+1?g-p*d-h:0));var s,l,u,c,h,f,d,p,g,m},6,7,pe,x,x,{bk:6}),o("ODDFYIELD",function(e,t,r,n,o,i,a,s,l){var u,c,h,f=.1;if(D(s,[1,2,4])<0||0<B(r,e)||0<B(e,n)||0<B(n,t))return N;if(u=(c=Xe(!(u={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0}),_e,u,f,e,t,o,i,a,s,l,r,n))[1],h=c[0]){for(f=1e-10;f<u.gl;f*=2)u=Ze(!1,_e,u,f,e,t,o,i,a,s,l,r,n)[1];u=(c=function(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y=0,C=e?15:2;if(!t.Wk||!t.Xk)return[!1,t];for(f=_(t.Zk-t.Yk)/(_(t.Zk)+_(t.Yk)),h=0;h<100+4*C;h++)if(p=d=0,g=h%4==0?1:h%4==2?2:3,t=(m=e?$e(!0,t,y,d,p,g,We,f,x,r,qe):$e(!1,t,y,d,p,g,_e,f,a,s,l,r,n,u,c,o,i))[1],y=m[2],d=m[3],!(e&&m[0]===A||!e&&v(m[0]))){if(m[0])return[!0,t];if(t=(b=De(d,p=e?We(d,r):_e(r,n,a,d,l,u,c,o,i)-s,t))[1],b[0])return[!0,t];if((f=_(t.Zk-t.Yk)/(_(t.Zk)+_(t.Yk)))<t.hl)return t._k<p&&(p=t._k,d=t.Yk),t.$k<p&&(d=t.Zk),t.al=d,[!0,t]}return[!1,t]}(!1,u,e,t,r,n,o,i,a,s,l))[1],h=c[0]}return h?u.al:N},8,9,[X,X,X,X,q,V,V,$,ne],x,x,{bk:8}),o("ODDLYIELD",function(e,t,r,n,o,i,a,s){return Ge(!1,e,t,r,n,i,a,s,o)},7,8,[X,X,X,q,V,V,U,ne],x,x,{bk:7}),o("ODDLPRICE",function(e,t,r,n,o,i,a,s){return Ge(!0,e,t,r,n,i,a,s,o)},7,8,[X,X,X,q,q,V,$,ne],x,x,{bk:7}),o("TBILLEQ",function(e,t,r){var n,o=xe(t)-xe(e);return 0<=B(e,t)||365<o?N:0==(n=360-r*o)?E:n<0?N:a(365*r/n)},3,3,de),o("TBILLYIELD",function(e,t,r){var n=xe(t)-xe(e);return 0<=B(e,t)||365<n?N:(100-r)/r*(360/n)},3,3,de),o("IRR",function(e,t){var r,n,o,i,a,s=p(e),l=[],u=!1,c=!1,h={fl:-1,gl:9999999,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0};for(1<_(t)&&(t=.1),r=-1,o=n=0;o<s;o++)(i=e[o])!==g&&(0!==i&&(n=l.length+1,-1===r&&(r=l.length)),l.push(i),0<i&&(u=!0),i<0&&(c=!0));return l=l.slice(r,n+1),!u||!c||p(l)<2?N:(h=(a=function(e,t,r){for(var n,o,i,a,s,l,u,c=e.hl/2,h=0;0===t[h];)h++;for(n=t.slice(h),i=[!1,null],a=[r],.1!==r&&a.push(.1),a.push(-.1,.99*e.gl,e.fl+.01),s=0;!i[0]&&s<a.length;s++)i=Je(C(e),n,a[s],c),d=n,m=g=p=void 0,(f=i)[0]&&(p=f[1].al,g=15,"number"==typeof p&&-10<p&&p<10&&((1<(m=""+p).indexOf("000000000000")||1<m.indexOf("999999999999"))&&(g=14)),p=y.Common.o.Lma(p,g),(.001<(b=et(p,d))||b<-.001)&&(f[0]=!1));var f,d,p,g,m,b;if(!i[0]){for(l=0,s=1,u=n.length;s<u;s++)l+=n[s];o=-l/n[0]-1,i=Je(C(e),n,o,c)}return i}(h,l,t))[1],a[0]?h.al:N)},1,2,[se,Z],0,0,{bk:1}),o("MIRR",function(e,t,r){var n,o,i,a,s=0,l=0,u=0,c=0,h=0,f=[],d=p(e);if(d<2)return E;for(n=0;n<d;n++)(o=e[n])!==g&&(f.push(o),u++,0!==o&&(0<o?s++:l++));if(l<1||s<1)return E;for(i=0;i<u;i++)0!==(a=f[i])&&(0<a?c+=a/T(1+r,i):h+=a/T(1+t,i));return 0===h||0===c||r<=-1?E:T(-c*T(1+r,u)/(h*(1+r)),1/(u-1))-1},3,3,[se,U,U],0,0),o("XIRR",function(e,t,r){var n,o,i,a,s,l,u,c=p(e);if(c!==p(t))return N;for(i=c-1;0<=i;i--)n=0<e[i]||n,o=e[i]<0||o,t[i]===g&&(0!==e[i]?t[i]=0:(e.splice(i,1),t.splice(i,1)));return n&&o?0===e[0]?0===r?4.88281e-9:2.98023e-9:(a=(s=Xe(!0,qe,a={fl:-1,gl:1e10,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},r,e,t))[1],s[0]?(l=a.al,Math.abs(l)<a.hl?2.98023e-9:l):(u=nt(e,t,r,a))[0]?u[1]:N):N},2,3,[ce,le,Z],"!= 2","!= 2",{bk:2}),o("RATE",function(e,t,r,n,o,i){var a,s,l,u,c,h;if(o=o?1:0,a=T(17976931348623157e282,1/e),l=(u=function(e,t,r){var n,o,i,a,s,l,u,c,h=e.hl/2;for(n=0;n<100;n++){if(a=void 0,l=s=0,r<e.fl||r>e.gl)return[!1,e,t];if(t=(u=ze(r,s,t))[2],s=u[1],!(a=u[0]))return[a,e,t];if(e=(c=De(r,s,e))[1],c[0])return[!0,e,t];if(t=(u=ze(r,l,t,!0))[2],l=u[1],!(a=u[0]))return[a,e,t];if(0===l)return[!1,e,t];if((o=r-1.000001*s/l)===r)return e.al=r,[!0,e,t];if(i=_(o-r)/(_(r)+_(o)),r=o,i<h)return e.al=r,[!0,e,t]}return[!1,e,t]}(s={hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0,fl:f(-1e10,1-a),gl:I(1e10,a-1)},l={bl:e,cl:t,dl:r,el:n,Nc:o},i))[2],s=u[1],!(c=u[0])){for(h=2;(!s.Xk||!s.Wk)&&h<100;h*=2)l=(u=Ye(s,i*h,l))[2],l=(u=Ye(s=u[1],i/h,l))[2],s=u[1];s=(u=Ke(!0,!1,s,l))[1],c=u[0]}return c?s.al:N},3,6,[V,U,U,W,{_i:0,Hi:2,aj:"< 0",bj:h},Z],x,x,{bk:[3,4,5]}),o("VDB",function(e,t,r,n,o,i,a){return o<n?N:e<t&&0===n&&1===o?e-t:function(e,t,r,n,o,i,a){var s,l,u,c,h=m(n),f=h,d=k(o),p=d,g=0;if(a)for(s=f+1;s<=p;s++)l=ot(e,t,r,s,i),s===f+1?l*=I(o,h+1)-n:s===p&&(l*=o+1-d),g+=l;else u=r,c=void 0,n!==m(n)&&1<i&&r/2<=n&&(c=n-r/2,n=r/2,o-=c,u+=1),e-=it(e,t,r,u,n,i),g=it(e,t,r,r-n,o-n,i);return g}(e,t,r,n,o,i,a)},5,7,[q,q,ie,q,q,Y,Q],x,x,{bk:[5,6]}),o("ACCRINT",function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R;if(D(i,[1,2,4])<0||0<=B(e,r))return N;if(1===i||0===a||4===a)return k=n,M=o,E=Te(A=e,r,I=a),R=L(A,I),E<0||R<=0?N:M*k*(E/R);for(s=e.getFullYear(),l=e.getMonth(),u=e.getDate(),c=r.getFullYear(),h=r.getMonth(),f=r.getDate(),d=t.getMonth(),p=t.getDate(),g=[],m=[],b=[],y=[31,28,31,30,31,30,31,31,30,31,30,31],C=0;C<i;C++)g[C]=(d+12*C/i)%12,m[C]=p<=y[g[C]]?p:y[g[C]],2===a?b[C]=360/i:3===a&&(b[C]=365/i);for(C=0;C<i;C++)v=g[w=C===i-1?0:C+1]>g[C]?2001:2002,b[C]=xe(new Date(v,g[w],m[w]))-xe(new Date(2001,g[C],m[C]));for(S=0,x=xe(r);s<c||s===c&&l<h||s===c&&l===h&&u<f;){for(C=0;C<i&&(l<g[C]||l===g[C]&&u<m[C])&&(0===C||g[C]>g[C-1]);)C++;for(;C<i&&(l>g[C]||l===g[C]&&u>=m[C])&&(l!==g[++C-1]||u!==m[C-1]););w=--C===i-1?0:C+1,v=12<=l+12/i?s+1:s,T=xe(new Date(s,l,u)),S+=o*n/i*(Math.min(xe(new Date(v,g[w],m[w])),x)-T)/b[C],s=v,l=g[w],u=m[w]}return S},6,8,[X,X,X,V,K,$,ne],x,x,{bk:[4,6,7]}),o("ACCRINTM",function(e,t,r,n,o){if(0<B(e,t))return N;var i=Te(e,t,o),a=L(e,o);return i<0||a<=0?N:n*r*i/a},3,5,[X,X,V,K,ne],x,x,{bk:[3,4]}),o("DISC",function(e,t,r,n,o){if(0<=B(e,t))return N;var i=L(e,o),a=Te(e,t,o);return a<=0||i<=0?N:(n-r)/n*(i/a)},4,5,[X,X,V,V,ne],x,x,{bk:3}),o("EFFECT",function(e,t){return T(1+e/t,t)-1},2,2,ye),o("INTRATE",function(e,t,r,n,o){if(0<=B(e,t))return N;var i=Te(e,t,o),a=L(e,o);return i<=0||a<=0?N:(n-r)/r*(a/i)},4,5,me,x,x,{bk:3}),o("NOMINAL",function(e,t){return t*(T(1+e,1/t)-1)},2,2,ye),o("DB",function(e,t,r,n,o){var i,a,s,l;if(r+(o<12?1:0)<n)return N;if(0===e)return 0;for(i=R(1-T(t/e,1/r),3),s=a=0,l=1;l<=n;l++)a+=s=1===l?e*i*o/12:l===r+1?(e-a)*i*(12-o)/12:(e-a)*i;return s},4,5,[q,U,te,te,{_i:12,Hi:2,aj:["< 1","> 12"]}],x,x,{bk:3}),o("DDB",function(e,t,r,n,o){var i,a=0,s=0;if(r<n)return N;if(e<=t)return 0;for(i=1;i<=n;i++)a+=s=I(s=o/r*(e-a),e-a-t);return s},4,5,[q,U,ee,ee,{_i:2,Hi:0,aj:"<= 0"}],x,x,{bk:3}),o("SLN",function(e,t,r){return(e-t)/r},3,3,[U,U,oe]),o("SYD",function(e,t,r,n){return r<n?N:(e-t)*(r-n+1)*2/(r*(r+1))},4,4,[U,q,te,ee]),o("DOLLARDE",function(e,t){return t<1?E:Ue(!0,e,t)},2,2,Ce),o("DOLLARFR",function(e,t){return 0===t?E:Ue(!1,e,t)},2,2,Ce),o("PRICE",function(e,t,r,n,o,i,a){return D(i,[1,2,4])<0||0<B(e,t)?N:Fe(e,t,r,n,o,i,a)},6,7,[X,X,q,q,V,$,ne],x,x,{bk:6}),o("PRICEDISC",function(e,t,r,n,o){if(0<=B(e,t))return N;var i=Te(e,t,o),a=L(e,o);return i<=0||a<=0?N:n-r*n*i/a},4,5,me,x,x,{bk:3}),o("PRICEMAT",function(e,t,r,n,o,i){var a,s,l,u,c;return 0<=B(e,t)?N:(a=Te(e,t,i),s=Te(r,t,i),l=Te(r,e,i),u=L(e,i),l<=0||u<=0||a<=0||s<=0?N:0==(c=1+a/u*o)?N:(100+s/u*n*100)/c-l/u*n*100)},5,6,[X,X,X,q,q,ne],x,x,{bk:5}),o("ODDFPRICE",function(e,t,r,n,o,i,a,s,l){return D(s,[1,2,4])<0||0<B(r,e)||0<B(e,n)||0<B(n,t)?N:_e(e,t,o,i,a,s,l,r,n)},8,9,[X,X,X,X,q,q,V,$,ne],x,x,{bk:8}),o("TBILLPRICE",function(e,t,r){var n=xe(t)-xe(e);return 0<=B(e,t)||365<n?N:100*(1-r*n/360)},3,3,[X,X,V]),o("EURO",function(e){var t=Pe(e,2);return 0<=t?t:N},1,1,J),o("EUROCONVERT",function(e,t,r,n,o){var i,a,s,l,u,c;return i=0,n||(c=r.substr(0,3),i=0<=D(c,["BEF","LUF","ESP","ITL","LUX"])?0:2),o.$i||(o.Qb=(u=t.substr(0,3),0<=D(u,["BEF","LUF","ESP","ITL","PTE","GRD","LUX"])?0:2)),s=Pe(t,o.Qb),l=Pe(r,o.Qb),0<=s&&0<=l?(a=e*l/s,n||(a=R(a,i)),a):h},3,5,[U,J,J,Q,{Zi:!0,Hi:2,_i:3,aj:"< 3",bj:h}],x,x,{bk:[3,4]}),o("PDURATION",function(e,t,r){return at(e,t,r,function(e,t,r){var n,o;return 0<t.value&&0<e.value&&0<r.value?(n=(Math.log(r.value)-Math.log(t.value))/Math.log(1+e.value),(o=Math.abs(n))<=179769e303?22250738585072014e-324<=o?n:0:E):N})},3,3),o("RRI",function(o,e,t){return at(o,e,t,function(e,t,r){if(0<t.value&&0<e.value&&0<=r.value){o=Math.pow(r.value/t.value,1/e.value)-1;var n=Math.abs(o);if(n<=179769e303)return 22250738585072014e-324<=n?o:0}return N})},3,3)},"./src/functions-lookup.ts":function(e,t,r){"use strict";var u,I,C,w,y,m,n,i,v,S,o,a,E,x,T,s,l,R,D,c,N,A,k,h,f,d,p,M,g,b,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K=this&&this.__extends||(q=function(e,t){return(q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}q(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function X(e,t,r,n){return{row:e,col:t,rowCount:r,colCount:n}}function J(e,t,r){var n,o;return v(e)?C:e.isArray||e.isReference?((n=e.colCount)<t&&(o=t,t=r,r=o),e[r*n+t]):e[0]}function Q(e,t,r){return r&&(null===e||null===t)||!v(t)&&((v(e)||s(e,!0))&&s(t,!0)||p(e)&&p(t)||M(e)&&M(t))}function $(e,t,r,n,o){if(e<0||t<0||t<e||r<e||t<r)return-1;if(o)return F=e,_=t,L=P=r,B=O=n,P;if(O){if(_<++P){if(O!==B)return-1;P=L-1,O=!1}}else if(--P<F){if(O!==B)return-1;P=L+1,O=!0}return P}function ee(e,t,r){var n=i(e),o=r;return n===t?o=0:t<n?o=1:n<t&&(o=2),o}function te(t,r,n){var o,e,i,a;if(t===r)return 0;if(M(t)){if(!r&&0===S(""+t))return 0;if(s(r)&&!s(t))return 1;if(p(r))return 2;if(M(r)){o=void 0;try{o=(e=u.Common.CultureManager.getCultureInfo()).localeCompare?n?e.localeCompare(""+t,""+r):e.localeCompare(t.toLowerCase(),r.toLowerCase()):n?(""+t).localeCompare(""+r):t.toLowerCase().localeCompare(r.toLowerCase())}catch(e){o=n?(""+t).localeCompare(""+r):t.toLowerCase().localeCompare(r.toLowerCase())}return o<0?o=2:0<o&&(o=1),o}return r instanceof Date?ee(t,r,1):-1}return M(r)?t||0!==S(""+r)?s(t)?2:p(t)?1:t instanceof Date?ee(t,r,2):-1:0:p(t)&&s(r)?1:p(r)&&s(t)?2:(i=l(t))===(a=l(r))?0:i<a?2:1}function re(e,t,r){var n=J(e,t,r);return v(n)?0:n}function ne(e,t,r,n){var o,i,a,s,l=-1,u=0,c=-1,h=-1,f=n?t.rowCount:t.colCount;if(--f<u)return-1;for(;u<=f;){for(o=C,a=e[0],1<=r!=(2===l)&&(c=h),i=h=$(u,f,h=x((u+f)/2),0<=r,!0);!Q(a,o)&&-1!==h&&!Q(a,o=n?J(t,0,h):J(t,h,0));)h=$(0,0,0,!1,!1),0<=r&&h<i?f=h:r<0&&i<h&&(u=h);if(-1===h&&1<=r!=(2===l))return c;if(-1===h)return-1;if(l=te(a,o,!1),1<=r&&1===l)u=h+1;else if(1<=r&&2===l)f=h-1;else if(r<=-1&&1===l)f=h-1;else if(r<=-1&&2===l)u=h+1;else if(0===l){for(;r<=-1&&u<h||0<=r&&h<f;){if(s=0<=r?h+1:h-1,null===(o=n?re(t,0,s):re(t,s,0)))return-1;if(!Q(a,o))break;if(0!==(l=te(a,o,!1)))break;h=s}return h}}return 1<=r!=(2===l)?h:c}function oe(e,t,r,n,o,i){var a,s,l,u,c,h,f=C,d=-1,p=e[0],g=M(p),m=y.zb(p),b=n?t.rowCount:t.colCount;for(g&&m&&(l=y.sb(m)),s=0;s<b;s++)if(c=o?b-1-s:s,Q(p,u=n?J(t,0,c):J(t,c,0),i))if(h=M(u),a=g&&h&&m?(l.lastIndex=0,l.test(u)?0:1):te(p,u,!1),1<=r&&1===a)a=-1,0<=d&&(a=te(u,f,!1)),(d<0||0<=d&&1===a)&&(d=c,f=u);else if(r<=-1&&2===a)a=-1,0<=d&&(a=te(u,f,!1)),(d<0||0<=d&&2===a)&&(d=c,f=u);else if(0===a)return c;return d}function ie(e,t){var r,n;if(!t)for(r=S(e),n=void 0,n=1;n<r;n++)if(2===te(e[n-1],e[n],!1))return;return 1}function ae(e){var t=Z.call(this,w)||this;return t.il=e,t}function se(e,t,r,n,o,i){var a,s=Y.call(this,e,[X(t,r,n,o)])||this;return s.getValue=function(e,t,r){var n=this.Nc;return 0===n?this.getRow(0)+1+t:1===n?this.getColumn(0)+1+r:j.getValue.call(this,e,t,r)},(a=s).cj=t,a.Lk=r,a.Xj=n,a.Yj=o,a.Nc=i,s}function le(e,t,r){var n,o,i,a,s;if(!e)return N;if(e.arrayFormulaMode,!(t=t!==w?t:e.getReference(e.source,X(e.row,e.column,e.rowCount,e.columnCount)))||1!==t.getRangeCount())return N;if(i=[],r){if(a=t.getRow(0)+1,1<(o=t.getRowCount(0))){for(n=0;n<o;n++)i.push([a+n]);return new I.CalcArray(i)}return a}if(s=t.getColumn(0)+1,1<(o=t.getColumnCount(0))){for(n=0;n<o;n++)i.push(s+n);return new I.CalcArray([i])}return s}function ue(e,t,r,n,o){if(o&&r>t.colCount||!o&&r>t.rowCount)return A;var i=n?ne(e,t,1,o):oe(e,t,0,o);return 0<=i?o?re(t,r-1,i):re(t,i,r-1):k}function ce(e,t,r,n){return ue(e,t,r,n,!1)}function he(e,t,r,n){return ue(e,t,r,n,!0)}function fe(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g=t;if(!g.isArray&&!g.isReference)return k;if(o=g.colCount,i=g.rowCount,1<o&&1<i)return N;if(2===r&&(2===n||-2===n))return N;if(a=2===n&&!ie(g,!0),s=-2===n&&!ie(g,!1),a||s)return k;if(u=(l=e)&&e[0],c=-1,v(r)&&(r=0),!v(n)&&0!==n||(n=1),-1===n&&(h=!0),0!==r&&2!==r||(f=0),1===n||-1===n){if(1===r)f=-1;else if(-1===r){if(y.ub(u))return k;f=1}c=oe(l,g,f,1<i,h,!0)}else if(2===n||-2===n){if(1===o&&1===i){if(!Q(u,d=g[0]))return k;if(0===(p=te(u,d,!1)))return 1;if(0===r)return 0===p?1:k;if(1===r)return 2===p?1:k;if(-1===r)return 1===p?1:k}c=ne(l,g,f=2===n?1:-1,1<i)}return-1!==c&&(0!==r||we(u,g[c]))?!we(u,g[c])&&(2===n&&1===r||-2===n&&-1===r)?c+2:c+1:k}function de(e,t,r,n){return e+=t,n?0!==r&&(e+="[",e+=""+r,e+="]"):e+=r,e}function pe(e,t){var r;return void 0===t&&(t=!1),R(e)||D(e)?r=e.toArray(0,!1):e.length&&e[0].length&&(r=e),r?ge(r,t):E(e)?e:N}function ge(e,t){var r,n,o,i,a,s,l;if(void 0===t&&(t=!1),n=e.rowCount,o=e.colCount,n||o||(n=e.length,o=e[0].length),i=e,t){for(i=[],a=0;a<o;a++)for(s=[],i.push(s),l=0;l<n;l++)s.push(e[l][a]);n=(r=[o,n])[0],o=r[1]}return i.rowCount=n,i.colCount=o,i}function me(e){return 1===e||-1===e}function be(e,a){var s=a.length;e.sort(function(e,t){var r,n,o,i;for(r=0;r<s;r++)if(o=(n=a[r])[0],0!==(i=I.gOb(e[o],t[o])))return n[1]?i:-i;return 0})}function ye(e,r,t){if(t)e.forEach(function(e,t){e.push(r[t][0])});else{var n=r[0];e.forEach(function(e,t){e.push(n[t])})}}function Ce(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M;for(void 0===r&&(r=1),n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];if(l=s=0,u=N,D(e)?i=e:R(e)&&(s=(a=e).getRow(),l=a.getColumn()),c=i||a){if(h=c.getColumnCount(),f=c.getRowCount(),E(e))return u;for(d=[],p=void 0,y=b=void(m=g=0),C=1,w=arguments.length;C<w;C+=2){if(S=pe(v=arguments[C]),E(S))return u;if(x=v.getRowCount(),T=v.getColumnCount(),g||(g=(p=1===T)?2:1,y=pe(e,!p)),!(!p&&1===x&&T===h||p&&1===T&&x===f))return u;if(A=D(v),R(v)&&(k=void 0,p?0<=(k=l-v.getColumn())&&k<h?b=k:A=!0:0<=(k=s-v.getRow())&&k<f?b=k:A=!0),A&&(m+=1,b=p?h++:f++,ye(y,S,p)),!me(M=arguments[C+1]||1))return u;d.push([b,1===M])}return be(y,d),m&&y.forEach(function(e){e.length-=m}),new I.CalcArray(p?y:ge(y,!0))}return u}function we(e,t){return e===t||o(e)&&o(t)&&a(e)===a(t)||E(e)&&E(t)&&e._code===t._code}function ve(e,t){var r,n;for(r=0,n=e.length;r<n;r++)if(!we(e[r],t[r]))return;return 1}Object.defineProperty(t,"__esModule",{value:!0}),u=r("Common"),I=r("CalcEngine"),C=null,w=void 0,y=u.Common.q,m=u.Common.j,n=u.Common.l,i=n.lb,v=m.Fa,m.G,S=u.Common.k.ac,o=n.Ska,a=n.Ra,E=I.Convert.vf,x=I.Convert.Rh,T=I.Convert.Sh,s=I.Convert.Na,l=I.Convert.Pa,R=I.Convert._isReference,D=I.Convert.Ca,c=I.Convert.bc,N=I.Errors.Value,A=I.Errors.Reference,k=I.Errors.NotAvailable,h=I.Errors.Null,f=I.Errors.Calc,d=I.Functions.ak,p=I.Functions.ik,M=I.Functions.jk,g=1048576,b=16384,j=I.CalcReference.prototype,Y=I.CalcReference,K(se,Y),se.prototype.type=function(){return this.Nc},se.prototype.toArray=function(e,t){var r,n,o,i,a,s,l=[],u=this.cj,c=this.Lk,h=this.Nc,f=this.getRangeCount(),d=this.Xj,p=this.Yj;for(r=0;r<f;r++)for(t||(o=[],l.push(o)),a=0;a<d;a++)for(t||(i=[],o.push(i)),s=0;s<p;s++)n=0===h?u+1+a:1===h?c+1+s:j.getValue.call(this,r,u+a,c+s),t?l.push(n):i.push(n);return t||1!==f||(l=l[0]),l.rowCount=d,l.colCount=p,l.rangeCount=f,l},Z=I.CalcArray,K(ae,Z),ae.prototype.getRowCount=function(){return I.CalcArrayHelper.getColumnCount(this.il)},ae.prototype.getColumnCount=function(){return I.CalcArrayHelper.getRowCount(this.il)},ae.prototype.getValue=function(e,t){return I.CalcArrayHelper.getValue(this.il,t,e)},H=ae,W={Hi:2},V={Hi:2,aj:"<= 0",bj:N},z={Hi:4,Ii:0,Ji:!0},d("ADDRESS",function(e,t,r,n,o){var i,a=3===r||4===r||7===r||8===r,s=2===r||4===r||6===r||8===r,l="";return e<1&&(n||!a)||g<e||t<1&&(n||!s)||b<t||r<1||8<r?N:(l=function(e,t){if(t&&0<S(t)){var r=void 0,n=!I.ei(t[0])&&"_"!==t[0];for(r=1;!n&&r<S(t);r++)n=!I.fi(t[r])&&"_"!==t[r];n?(e+="'",e+=t.replace("'","''"),e+="'"):e+=t,e+="!"}return e}(l,o),l=n?(l=function(e,t,r){r||(e+="$");for(var n=e.length;.1<t;t=parseInt(""+(t-1)/26,10))e=u.Common.u.Eb(e,n,String.fromCharCode("A".charCodeAt(0)+(t-1)%26));return e}(l,t,s),i=l,a||(i+="$"),i+e):(l=de(l,"R",e,a),de(l,"C",t,s)))},2,5,[U={Hi:2},U,{_i:1,Hi:2},G={_i:!0,Hi:7},{_i:"",Hi:5}],w,w,{bk:[2,3,4]}),d("INDEX",function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b;function y(e){return!v(e)&&!e._error}if(i=C,s=(a=e instanceof I.EvaluateContext?e:w)!==C&&a.acceptsReference,l=a!==C&&a.arrayFormulaMode,t instanceof I.CalcReference){if(u={value:-1},c=t,o===w&&(o=1),(o=y(o)&&T(o,u)?u.value-1:i)>=c.getRangeCount())return A;if(o===i||o<0)return N;if(h=c.getRowCount(o),f=c.getColumnCount(o),d=c.getRow(o),p=c.getColumn(o),m=g=void 0,3===S(arguments)){if(1!==h&&1!==f)return A;1!==f?(n=r,r=1):1!==h&&(n=1)}if(r===w&&(r=0),-1===(r=y(r)&&T(r,u)?u.value-1:i)){if(1!==h&&!s&&!l&&(d>a.row||a.row>=d+h))return N}else{if(r<-1||r===i)return N;if(h<=r)return A;g=r+d}if(n===w&&(n=0),-1===(n=y(n)&&T(n,u)?u.value-1:i)){if(1!==f&&!s&&!l&&(p>a.column||a.column>=p+f))return N}else{if(n<-1||n===i)return N;if(f<=n)return A;m=n+p}return-1===r&&-1===n?c.create([X(d,p,h,f)]):-1===r?c.create([X(d,m,h,1)]):-1===n?c.create([X(g,p,1,f)]):c.create([X(g,m,1,1)])}if(I.Convert.Ca(t))return h=(b=t).getRowCount(),r=r!==w?x(r):-1,n=n!==w?x(n):-1,1!==(o=o!==w?x(o)-1:1)?A:(-1===r&&-1===n?r=n=0:-1===n&&1===h&&(n=r,r=1),r=-1===r?0:r,n=-1===n?0:n,h=b.getRowCount(),f=b.getColumnCount(),r<0||n<0||o<0?N:(h<r&&1===h&&n===w&&(n=r,r=0),h<r||f<n?A:0===r&&0===n?b.slice(0,0,h,f):0===r?b.slice(0,n-1,h,1):0===n?b.slice(r-1,0,1,f):b.getValue(r-1,n-1)))},2,4,w,0,0,{bk:[1,2,3],dk:!0,fk:3}),d("OFFSET",function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p;return e?t&&t instanceof I.CalcReference&&1===t.getRangeCount()?(o=o!==w?x(o):t.getRowCount(0),i=i!==w?x(i):t.getColumnCount(0),a=t.getRow(0)+r,s=t.getColumn(0)+n,o<=0||i<=0||a<0||s<0?A:(l=t.create([{row:a,col:s,rowCount:o,colCount:i}]),u=e.row,c=e.column,h=e.source.getCalcSourceModel().qg(u,c),l.ck=!0,f=t.getSource(),h&&f.getRangeKey&&(d={id:f.id,row:a,col:s,rowCount:o,colCount:i},p=f.getRangeKey(f,d),h.eOb||(h.eOb={}),h.eOb[p]=d),l)):N:k},3,5,[{},U,U],0,0,{bk:[3,4],dk:!0,fk:2,returnReference:!0}),d("ROW",function(e,t){return le(e,t,!0)},0,1,w,-1,w,{dk:!0,ek:-1,expandColumns:!1}),d("COLUMN",function(e,t){return le(e,t,!1)},0,1,w,-1,w,{bk:0,dk:!0,ek:-1,expandRows:!1}),d("ROWS",function(e){return I.CalcArrayHelper.getRowCount(e)},1,1,w,-1,-1,{ek:-1,expandColumns:!1,ck:!0}),d("COLUMNS",function(e){return I.CalcArrayHelper.getColumnCount(e)},1,1,w,-1,-1,{ek:-1,expandRows:!1,ck:!0}),d("TRANSPOSE",function(e){return new H(e)},1,1,w,-1,-1),d("LOOKUP",function(e,t,r){var n,o,i,a,s,l,u,c=[];if(t)for(n=0;n<t.length;n++)v(t[n])||c.push(t[n]);if(t.colCount<=t.rowCount?(c.colCount=t.colCount,c.rowCount=Math.ceil(c.length/c.colCount)):(c.rowCount=t.rowCount,c.colCount=Math.ceil(c.length/c.rowCount)),v(t.isReference)||(c.isReference=t.isReference),v(t.isArray)||(c.isArray=t.isArray),c.rangeCount=t.rangeCount,a=c.colCount,s=c.rowCount,l=e,r===w)return u=s<a?ce(l,c,s,!0):he(l,c,a,!0),E(u)?k:u;if(i=I.Convert.Ph(r,0,!0,!1,!1)){if(1<i.colCount&&1<i.rowCount)return k}else i=c;return 0<=(o=ne(l,c,1,!(s<a)))?(a=i.colCount,(s=i.rowCount)<a?re(i,o,s-1):re(i,a-1,o)):k},2,3,[z,{Hi:4,Ii:0,Ji:!0,xTa:!0}],"!= 0","!= 0",{fk:1}),d("HLOOKUP",ce,3,4,[z,z,V,G],1,1,{bk:3}),d("VLOOKUP",he,3,4,[z,z,V,G],1,1,{bk:3,TAb:!0}),d("XLOOKUP",function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m=r.getRowCount(),b=r.getColumnCount(),y=1===t.rowCount&&1<=t.colCount,C=1===m&&1<=b;if(y&&t.colCount!==b||!y&&t.rowCount!==m)return N;if((a=fe(e,t,o,i))===k)return"string"==typeof n?n:k;if(a===N)return N;if(0<a){if(--a,s=[],I.Convert.Ca(r)){if(y)for(l=0;l<m;l++)u=r.getValue(0,a),s.push([u]);else c=C?[r.getValue(0,a)]:[r.getValue(a,0)],s.push(c);return new I.CalcArray(s)}if(r instanceof I.CalcReference)return f=(h=r).getRow(),d=h.getColumn(),p=m,g=b,y?(d=h.getColumn()+a,g=1):(f=h.getRow()+a,p=1),h.create([{row:f,col:d,rowCount:p,colCount:g}])}},3,6,[z,z,{},{Hi:5},{Hi:2,_i:0},{Hi:2,_i:1}],[1,2],[1,2],{bk:[3,4,5]}),d("CHOOSE",function(e){var t=arguments;return e<1||S(t)<=e?N:v(t[e])?0:t[e]},2,255,U,">= 1",">= 1",{gk:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(e){var t={value:-1};return E(e)?-1:(T(e,t),t.value)}}),d("MATCH",function(e,t,r){var n,o,i,a=e,s=t;return s.isArray||s.isReference?(n=s.colCount,o=s.rowCount,i=-1,1<n&&1<o||1===r&&!ie(s,!0)||-1===r&&!ie(s,!1)?k:(r===w?r=1:r===C&&(r=0),1===r?i=ne(a,s,1,1<o):0===r?i=oe(a,s,0,1<o):-1===r&&(i=ne(a,s,-1,1<o)),-1===i?k:i+1)):k},2,3,[z,z,W],1,1,{}),d("XMATCH",fe,2,4,[z,z,W,W],1,1,{}),d("INDIRECT",function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g;return e?t?(i={row:n=e.row,col:o=e.column},a=(a=e.parser)||(e.parser=new I.Parser),(l=(s=e.source).parserContext)?(l.useR1C1=!r,l.row=i.row||0,l.column=i.col||0,l.baseIdentity=i,l.source=e.source):(s.parserContext=l=e.source?e.source.getParserContext(!r,i):new I.ParserContext(e.source,!r,i),l.onlyValidateSourceNameWithSpecial=!0),r?u=a.parse(l,t):(u=(h=(h=s.expressions)||(s.expressions={}))[t])||(u=a.parse(l,t),h[t]=u),u?(8===u.type&&(u=u.source?(c=u.source).getCustomName(u.value):e.getName(u.value)),!u||m.Ea(u.type,[1,13])<0?A:(c=u.source||e.source,25===u.type||26===u.type?c.getValueByName(u.nameIdentity):(f=u.getRange(n,o),13===u.type&&(c=u.source),d=e.source.getCalcSourceModel().qg(n,o),p=null,1!==f.rowCount||1!==f.colCount||e.acceptsReference||e.arrayFormulaMode?((p=c.getReference(f)).ck=!0,f.id=c.id,d&&c.getRangeKey&&(g=c.getRangeKey(c,f),d.eOb||(d.eOb={}),d.eOb[g]=f)):(p=c.getValue(f.row,f.col),d&&(d.fOb||(d.fOb={}),d.fOb[t]=u)),p))):A):A:k},1,2,[{Hi:5},G],w,w,{bk:2,dk:!0}),d("HYPERLINK",function(e,t){var r;return(r=c(2===arguments.length?t:e)).__proto__.hyperlink=c(e),r},1,2),d("AREAS",function(){var e,t=0;for(e=0;e<S(arguments);e++){if(0===arguments[e].length)return h;arguments[e].isReference&&(t+=arguments[e].rangeCount)}return t},1,w,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),d("FORMULATEXT",function(e,t){var r=t.getRow(0),n=t.getColumn(0),o=t.getSource().getCalcSourceModel().getFormula(r,n);return o?"="+o:k},1,1,w,-1,w,{dk:!0}),d("ISFORMULA",function(e,t){var r=t.getRow(0),n=t.getColumn(0);return!!t.getSource().getCalcSourceModel().getFormula(r,n)},1,1,w,-1,w,{dk:!0}),d("SORT",function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T;if(void 0===t&&(t=1),void 0===r&&(r=1),void 0===n&&(n=!1),o=pe(e,n),E(o))return o;if(i=o,a=[],R(t)||D(t)){if(h=(c=t.toArray(0,!1)).rowCount,f=c.colCount,d=0,R(r)||D(r)){if(d=(l=r.toArray(0,!1)).rowCount,1!==f){if(f<1||1!==l.colCount&&l.colCount!==f||1!==h||!function(e){if(e&&e.length&&0<=e.length){for(var t=0;t<e.length;t++)if("number"!=typeof e[t])return;return 1}}(c[0]))return N;if((p=[]).push(e),n)for(i=ge(i,n),g=0;g<f;g++){for(m=[],b=0;b<i[0].length;b++)m.push(i[c[0][g]-1][b]);p.push(new I.CalcArray([m])),1===d?p.push(l[0][0]):p.push(l[g][0])}else for(g=0;g<f;g++){for(m=[],b=0;b<i.length;b++)m.push([i[b][c[0][g]-1]]);p.push(new I.CalcArray(m)),1===d?p.push(l[0][0]):p.push(l[g][0])}return Ce.apply(Ce,p)}if(1!==l.colCount||1!==d&&d!==h)return N;1===d&&(u=l[d=0][0])}else u=r;for(s=0;s<h;s++)a.push([c[s][0],s<d?l[s][0]:u])}else if(R(r)||D(r)){if(1!==(l=r.toArray(0,!1)).colCount||1!==l.rowCount)return N;a.push([t,l[0][0]])}else a.push([t,r]);for(y=i.colCount,C=[],w=0,v=a;w<v.length;w++){if(x=(S=v[w])[0],T=S[1],x<1||y<x||!me(T))return N;C.push([x-1,1===T])}return be(i,C),new I.CalcArray(n?ge(i,n):i)},1,4,w,[0,1,2],[0,1,2],{bk:[1,2,3]},!0),d("SORTBY",Ce,2,w,w,[0,"%= 1"],[0,"%= 1"],w,!0),d("UNIQUE",function(e,t,i){var r,a,s,l;return void 0===t&&(t=!1),void 0===i&&(i=!1),r=pe(e,t),E(r)?r:(s=[],l=(a=r).rowCount,a.forEach(function(e,t){var r,n,o;if(!e.duplicated){for(r=0,n=t+1;n<l;n++)ve(e,o=a[n])&&(o.duplicated=!0,r++);i&&0!==r||s.push(e)}}),new I.CalcArray(t?ge(s,t):s))},1,3,w,[0],[0],{bk:[1,2]},!0),d("FILTER",function(e,t,r){var n,o,i,a=pe(e);return E(a)?a:(n=a,o=[].concat(pe(t)),i=[],n.forEach(function(e,t){o[t][0]&&i.push(e)}),0===i.length?v(r)?f:r:new I.CalcArray(i))},2,3,w,[0,1,2],[0,1,2],w,!0),d("@",function(e,t){var r,n,o,i,a,s,l,u,c,h;return D(t)?t.getValue(0,0):R(t)?(n=(r=t).getColumn(),o=r.getRow(),i=r.getColumnCount(),a=r.getRowCount(),u=(s=e.row)-o,c=(l=e.column)-n,h=e.source===r.getSource(),1===a&&(!h||o!==s)&&0<=c&&c<i?r.getValue(0,0,c):1===i&&(!h||n!==l)&&0<=u&&u<a?r.getValue(0,u,0):1===a&&1===i?r.getValue(0,0,0):N):t},1,1,w,[0],[0],{dk:!0},!0)},"./src/functions-stat.ts":function(e,t,r){"use strict";var a,U,A,W,V,k,M,s,I,E,v,S,u,p,g,d,z,R,q,Z,l,D,y,Y,K,m,N,X,x,J,o,c,b,C,F,n,i,h,w,f,T,_,P,L,O,B,j,H,G,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,Ee,Re,De,Ne,Fe,_e,Pe,Le,Oe,Be,je,He,Ge,Ue,We,Ve,ze,qe,Ze,Ye,Ke;function Xe(e){var t,r,n;return t=0===e?0:3<=(r=.5*Math.abs(e))?1:r<1?((((((((.000124818987*(n=r*r)-.001075204047)*n+.005198775019)*n-.019198292004)*n+.059054035642)*n-.151968751364)*n+.319152932694)*n-.5319230073)*n+.797884560593)*r*2:(((((((((((((-45255659e-12*(r-=2)+.00015252929)*r-19538132e-12)*r-.000676904986)*r+.001390604284)*r-.00079462082)*r-.002034254874)*r+.006549791214)*r-.010557625006)*r+.011630447319)*r-.009279453341)*r+.005353579108)*r-.002141268741)*r+.000535310849)*r+.999936657524,0<e?.5*(t+1):.5*(1-t)}function Je(e,t,r,n){var o,i,a=[];return ft(e,a),0===(o=A(a))||t<a[0]||a[o-1]<t?Y:0!==(i=1===o?1:function(e,t,r){var n,o,i,a,s,l=A(e);if(t!==e[0]){for(a=e[i=0],o=1;o<l&&e[o]<t;o++)e[o]!==a&&(a=e[i=o]);e[o]!==a&&(i=o),n=t===e[o]?r?i/(l-1):(o+1)/(l+1):0===i?0:(s=(t-e[i-1])/(e[i]-e[i-1]),r?(i-1+s)/(l-1):(i+s)/(l+1))}else n=r?0:1/(l+1);return n}(a,t,n))?l(i*I(10,r))/I(10,r):i}function Qe(e){return[22250738585072014e-324,17976931348623157e292,I(2,-53),I(2,-52),o.Ek(2,10)][e-1]||0}function $e(e,t,r){var n,o=0,i=0;if(t<1)return 0;for(n=1;n<=t;n++)if(r<(i+=R(J(e[o=t-n]))))return o;return o}function et(e,t,r){var n,o,i,a,s;if(r<1||1e3<r||e<-1.1||1.1<e)return NaN;for(n=2*e,i=o=0,a=0,s=1;s<=r;s++)i=o,a=n*(o=a)-i+J(t[r-s]);return.5*(a-i)}function tt(e){var t,r=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1809129475572494e-26,6221098041892606e-29,-3399615005417722e-31,2683181998482699e-33,-2.868042435334643e-20,39628370610464347e-38,-6831888753985767e-39,14292273559424982e-41,-35475981581010704e-43,1025680058010471e-43,-3.401102254316749e-30,1276642195630063e-46],n=$e(r,15,Qe(3)),o=1/q(Qe(3)),i=z(v(Z(Qe(2)/12),-Z(12*Qe(1))));return e<10?NaN:i<=e?4930380657631324e-47:e<o?et((t=10/e)*t*2-1,r,n)/e:1/(12*e)}function rt(e){var t=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-771908941348408e-25,1407574648135907e-26,-25769072058024682e-28,4734240666629442e-28,-8724901267474264e-29,1612461490274055e-29,-29875652015665774e-31,5548070120908289e-31,-10324619158271569e-32,19250239203049852e-33,-3595507346526515e-33,6726454253787686e-34,-1260262416873522e-34,2.364488440860621e-20,-44419377050807936e-37,8354659446403425e-37,-15731559416479563e-38,29653128740247425e-39,-5594958348181595e-39,1056635426883568e-39,-19972483680670205e-41,3778297781883936e-41,-7153158688908174e-42,13552488463674214e-43,-25694673048487566e-44,48747756066216946e-45,-9.254211253084972e-30,1.757859784176024e-30,-3341002667773101e-46,6353393618023618e-47],r=$e(t,43,.1*Qe(3));return e<=-1?NaN:R(e)<=.375?e*(1-e*et(e/.375,t,r)):Z(e+1)}function nt(e){var t,r,n,o,i,a,s=1,l=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,77823e-16,-36968e-16,51e-14,-206e-16,-54e-16,14e-16];if(171<e)return 1e308;if(e===x(e))if(0<e)for(t=1,o=2;o<e;o++)t*=o;else t=1e308;else{if(1<R(e)){for(n=R(e),i=x(n),r=s=1;r<=i;r++)s*=n-r;n-=i}else n=e;for(a=l[24],r=23;0<=r;r--)a=a*n+l[r];t=1/(a*n),1<R(e)&&(t*=s,e<0&&(t=-g/(e*t*u(g*e))))}return t}function ot(e){var t,r,n,o,i,a=0,s=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],l=e;if(e<=0)return 1e308;if(1===e||2===e)return 0;for(e<=7&&(l=e+(a=x(7-e))),r=1/(l*l),n=2*g,o=s[9],t=8;0<=t;t--)o=o*r+s[t];if(i=o/l+.5*Z(n)+(l-.5)*Z(l)-l,e<=7)for(t=1;t<=a;t++)i-=Z(l-1),--l;return i}function it(e,t){var r,n,o,i=n=e;return t<i&&(i=t),n<t&&(n=t),i<0?NaN:0===i?P:10<=i?(r=tt(i)+tt(n)-tt(i+n),-.5*Z(n)+.9189385332046728+r+(i-.5)*Z(i/(i+n))+n*rt(-i/(i+n))):10<=n?(r=tt(n)-tt(i+n),o=ir(i),F(o)?NaN:J(o)+r+i-i*Z(i+n)+(n-.5)*rt(-i/(i+n))):Z(nt(i)*(nt(n)/nt(i+n)))}function at(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p=Qe(3),g=Z(p),m=Qe(1),b=Z(m),y=e,C=t,w=r;if(C/(C+w)<e&&(y=1-y,C=r,w=t),(C+w)*y/(C+1)<p)n=0,b<(i=C*Z(E(y,m))-Z(C)-it(C,w))&&0!==y&&(n=z(i)),y===e&&C===t||(n=1-n);else{if(0===(l=w-S(w))&&(l=1),n=0,b<=(i=C*Z(y)-it(l,C)-Z(C))&&(o=(n=z(i))*C,1!==l))for(s=x(E(g/Z(y),4)),u=1;u<=s;u++)n+=(o=o*((a=u)-l)*y/a)/(C+a);if(1<w){for(i=C*Z(y)+w*Z(1-y)-it(C,w)-Z(w),c=x(E(i/b,0)),o=z(i-c*b),f=w*(h=1/(1-y))/(C+w-1),d=0,w===(s=x(w))&&--s,u=1;u<=s&&!(f<=1&&o/p<=d);u++)1<(o=(w-(a=u)+1)*h*o/(C+w-a))&&(--c,o*=m),0===c&&(d+=o);n+=d}y===e&&C===t||(n=1-n),n=E(v(n,1),0)}return n}function st(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g;function m(e,t){return e<0&&0<t||0<e&&t<0}for(o=e.ge(t),i=e.ge(r),s=0;s<1e3&&!m(o,i);s++)R(o)<=R(i)?((t+=2*((a=t)-r))<0&&(t=0),r=a,i=o,o=e.ge(t)):(r+=2*((a=r)-t),t=a,o=i,i=e.ge(r));if(0===o)return t;if(0===i)return r;if(!m(o,i))return n.jl=!0,0;for(h=i,d=u=o,p=.5*((f=l=t)+(c=r)),g=!0,s=0;s<500&&1e-307<R(d)&&r-t>222045e-21*E(R(t),R(r));)(g=g&&(u!==h&&h!==d&&d!==u&&(t<(p=l*d*h/(d-u)/(h-u)+f*h*u/(h-d)/(u-d)+c*u*d/(u-h)/(d-h))&&p<r)))||(p=.5*(t+r),c=r,h=i,g=!0),l=c,c=f,f=p,u=h,h=d,m(o,d=e.ge(p))?(r=f,i=d):(t=f,o=d),g=g&&2*R(d)<=R(h),++s;return f}function lt(e,t){var r,n,o,i,a=A(t);for(r=0;r<a;r++)i=(o=(n=J(t[r]))-e.M)/(e.N+1),e.M+=i,e.Q+=e.N*o*i,e.N++,e.kl+=n}function ut(e){var t,r=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],n=1.000000000190015,o=e,i=e+5.5;for(i-=(e+.5)*Z(i),t=0;t<=5;t++)n+=r[t]/++o;return-i+Z(2.5066282746310007*n/e)}function ct(e,t){var r,n,o,i,a=A(t);for(r=0;r<a;r++)(n=t[r])!==L&&(i=(o=n-e.M)/(e.N+1),e.M+=i,e.Q+=e.N*o*i,e.N++,e.kl+=n)}function ht(e){e.sort(function(e,t){return e-t})}function ft(e,t){var r,n;for(r=0;r<A(e);r++)(n=e[r])!==L&&t.push(n);ht(t)}function dt(e,t,r){var n,o,i,a,s,l,u,c,h=Math.expm1||function(e){return z(e)-1},f=Math.log1p||function(e){return Z(1+e)};return e<=0?0:1<=e?1:1===r?I(e,t):1===t?-h(r*f(-e)):(o=.5-e+.5,i=f(-e),s=Z(a=e),(c=(l=t)/(t+(u=r))<e)&&(l=r,u=t,a=o,s=i,i=Z(o=e)),n=function(e,t,r){var n,o,i,a,s,l,u,c,h,f=1,d=1,p=1-(t+r)/(t+1)*e;a=0===p?(n=0,o=1):(n=1)*(o=1/p),s=i=1,l=!5e4;for(;n=(f=(n+(c=s*(r-s)*e/(((u=t+2*s)-1)*u))*f)*o)+(h=-(t+s)*(t+r+s)*e/(u*(u+1)))*n*o,0!=(p=(d=(p+c*d)*o)+h*p*o)&&(l=R(a-(i=n*(o=1/p)))<222045e-21*R(a)),a=i,s+=1,s<5e4&&!l;);return a}(a,l,u),n/=l,n*=1<l&&1<u&&l/(l+u)<.97&&u/(l+u)<.97?pt(a,l,u)*a*o:z(l*s+u*i-gt(!1,l,u)),c&&(n=.5-n+.5),1<n&&(n=1),n<0&&(n=0),n)}function pt(e,t,r){var n,o,i,a,s,l;return 1===t?1===r?1:2===r?-2*e+2:e<=.01?r+r*z((r-1)*Z(1-e))-1:r*I(.5-e+.5,r-1):1===r?2===t?t*e:t*I(e,t-1):e<=0&&!(t<1&&0===e)||1<=e&&!(r<1&&1===e)?0:(n=Z(Qe(2)),o=Z(Qe(1)),i=Z(e<.1?1+e:1-e),a=(t-1)*Z(e),s=(r-1)*i,l=gt(!1,t,r),a<n&&o<a&&s<n&&o<s&&l<n&&o<l&&a+s<n&&o<a+s?I(e,t-1)*I(.5-e+.5,r-1)/gt(!0,t,r):z(a+s-l))}function gt(e,t,r){var n,o,i,a,s,l,u,c=r,h=t;return r<t&&(n=c,c=h,h=n),e&&c+h<171.624376956302?bt(c)/bt(c+h)*bt(h):(o=5.52468004077673,i=Ct(c),i/=Ct(c+h),i*=Ct(h),a=c+h+o,s=e?i*q(a/(c+o)/(h+o)):Z(i)+.5*(Z(a)-Z(c+o)-Z(h+o)),l=c/(h+o),u=-c*Z(1+h/(c+o))-h*Z(1+l)-o,e?z(u)*s:u+s)}function mt(e){var t=Ct(e),r=e+6.02468004077673-.5,n=I(r,e/2-.25);return t*=n,t/=z(r),t*=n,e<=20&&e===o.wk(e)&&(t=l(t)),t}function bt(e){var t,r=Z(g),n=Z(Qe(2));return 171.624376956302<e?K:1<=e?mt(e):.5<=e?mt(e+1)/e:-.5<=e?n<=mt(e+2)-Z(e+1)-Z(R(e))?K:mt(e+2)/(e+1)/e:n<=(t=mt(1-e)+Z(R(u(g*e))))-r?0:t<0&&n<r-t?K:z(r-t)*(u(g*e)<0?-1:1)}function yt(e){return 171.624376956302<=e?mt(e):1<=e?Z(mt(e)):.5<=e?Z(mt(e+1)/e):mt(e+2)-Z(e+1)-Z(e)}function Ct(e){var t,r,n,o,i=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],a=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(e<=1)for(t=i[12],r=a[12],n=11;0<=n;--n)t*=e,t+=i[n],r*=e,r+=a[n];else for(o=1/e,t=i[0],r=a[0],n=1;n<=12;++n)t*=o,t+=i[n],r*=o,r+=a[n];return t/r}function wt(e,t){return e<=0?0:(o=(r=t/2)*Z(n=e/2)-n-yt(r),i=z(o),r+1<n?1-i*function(e,t){for(var r=Qe(3),n=.5*r,o=1/r,i=0,a=0,s=1-e,l=t+2-e,u=0,c=t+1,h=1,f=1,d=l*t,p=t,g=c/d,m=!1,b=0;u=c*(l+=2)-h*(a=(s+=1)*(i+=1)),0!=(f=d*l-p*a)&&(m=R((g-(b=u/f))/b)<=n,g=b),h=c,p=d,d=f,R(c=u)>o&&(h*=r,c*=r,p*=r,d*=r),!m&&i<1e4;);return m?g:y}(r,n):i*function(e,t){for(var r=.5*Qe(3),n=e,o=1/e,i=o,a=1;i+=o=o*t/(n+=1),a+=1,r<o/i&&a<=1e4;);return 1e4<a?y:i}(r,n));var r,n,o,i}function vt(e,t,r,n){var o,i,a,s=c(r,e);return F(s)?s:(o=J(s),s=c(n-r,t-e),F(s)?s:(i=J(s),s=c(n,t),F(s)?s:(a=J(s),N(o*i/a))))}function St(e,t,r){var n,o=dt(t/(t+e*e),t/2,.5);switch(r){case 1:return.5*o;case 2:return o;case 3:return I(1+e*e/t,-(t+1)/2)/(q(t)*gt(!0,.5,t/2));case 4:return n=.5*dt(t/(e*e+t),.5*t,.5),e<0?n:1-n}return y}function xt(e,t,r){var n,o,i,a={jl:!1},s=st((n=e,i=r,{ge:function(e){return n-St(e,o,i)}}),.5*(o=t),t,a);return a.jl?Y:s}function Tt(e,t){var r,n,o,i,a,s=!1,l=0;for(n=0;n<A(t);n++)for(a=t[n],o=0;o<A(a);o++)if(i=a[o],C(i)||f(i)||T(i))r=T(i)?0:J(i),(!s||e&&l<r||!e&&r<l)&&(l=r),s=!0;else if(F(i))return i;return l}function At(e,t,r,n){var o,i,a,s=0,l=0,u=0;for(o=0;o<A(t);o++)(i=t[o])!==L&&(i<r?s++:r<i?u++:l++);return 0===l?Y:(a=(0===n?u:s)+1,e?a:a+(l-1)/2)}function kt(e,t,r,n){var o,i={ll:0,ml:0,n:0},a=function(e,t,r){var n,o,i,a,s,l,u,c;for(i=0;i<A(e);i++)for(l=!!(s=e[i]).isArray,u=!!s.isReference,a=0;a<A(s);a++)if((o=s[a])!==W)if(T(o)){if(U.ExcelCompatibleCalcMode){if(l)continue;if(u){t.n++;continue}}if(c={value:0},U.Convert.Th(o,c))n=c.value,t.ll+=n,t.ml+=n*n;else if(!s.isArray&&!s.isReference)return y;t.n++}else{if(F(o))return o;!C(o)||r&&"boolean"==typeof o&&s.isArray||(n=J(o),t.ll+=n,t.ml+=n*n,t.n++)}}(e,i,n);return F(a)?a:i.n<=t?D:(o=E(0,(i.n*i.ml-i.ll*i.ll)/(i.n*(i.n-t))),o=r?q(o):o,N(o))}function Mt(e,t,r){var n,o,i,a,s,l=0,u=0,c=0,h=0,f=A(t);if(f!==A(r))return Y;for(i=0;i<f;i++)n=t[i],o=r[i],n!==L&&o!==L&&(l+=n,u+=o,h++);if(h<=1)return D;for(a=l/h,s=u/h,i=0;i<f;i++)n=t[i],o=r[i],n!==L&&o!==L&&(c+=(n-a)*(o-s));return N(e?c/h:c/(h-1))}function It(e,t){var r,n,o,i,a=e?1:0,s=0;for(o=0;o<A(t);o++)for(r=t[o],i=0;i<A(r);i++)if((n=r[i])!==L){if(n<=0)return K;a=e?a*n:a+1/n,s++}return e?s<=0?D:N(I(a,1/s)):0===a?D:N(s/a)}function Et(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H=t.rowCount,G=t.colCount;if(l=(r=e?r!==V?X(r,1,!1,!0,!0):t:(i=r!==V?r:function(e,t){var r=[];for(a=0;a<e;a++)for(r[a]=[],s=0;s<t;s++)r[a][s]=a*t+s+1;return new U.CalcArray(r)}(H,G),X(i,1,!1,!0,!0))).rowCount,u=r.colCount,H===l&&G===u&&(n||!o)){for(f=e?l*u:J(l*u),M=void(k=A=T=x=S=0),a=0;a<l;a++)for(s=0;s<u;s++)d=r[a][s],p=t[a][s],e&&(p=Z(p)),S+=d,x+=d*d,T+=p,A+=p*p,k+=d*p;return C=f*x-S*S,h=n?(f*k-S*T)/C:k/x,M=n?(T*x-S*k)/C:0,e&&(h=z(h),M=z(M)),b=[[h,M]],o&&(b[1]=[],b[2]=[],b[3]=[],b[4]=[],D=A-M*T-h*k,N=(R=f*k-S*T)*R/((I=f*x-S*S)*(E=f*A-T*T)),f<3?(b[1][0]=K,b[1][1]=K,b[2][1]=K,b[3][0]=K):(b[1][0]=q(D*f/(I*(f-2))),b[1][1]=q(D*x/(I*(f-2))),b[2][1]=q((E-R*R/I)/(f*(f-2))),b[3][0]=1==N?K:N*(f-2)/(1-N)),b[2][0]=N,b[3][1]=f-2,b[4][0]=E/f-D,b[4][1]=D),new U.CalcArray(b)}if(1===G&&H===l||1===H&&G===u){for(p=[],d=[],C=1===G,f=l,h=u,a=0;a<f;a++)p[a]=n?t[a][0]:t[0][a],e&&(p[a]=Z(p[a]));for(a=0;a<f;a++)for(d[a]=[],s=0;s<h;s++)d[a][s]=C?r[a][s]:r[s][a];for(F=[],c=0;c<h+1;c++)F[c]=[];for(g=0;g<h+1;g++)for(m=0;m<h+2;m++)F[g][m]=0;for(_=[],g=0;g<h+2;g++)_[g]=0;for(P=o?[]:W,c=0;c<f;c++)for(_[h+1]+=p[c]*p[c],F[0][h+1]+=p[c],_[0]=F[0][h+1],a=0;a<h;a++)for(F[0][a+1]+=d[c][a],F[a+1][0]=F[0][a+1],F[a+1][h+1]+=d[c][a]*p[c],_[a+1]=F[a+1][h+1],s=a;s<h;s++)F[s+1][a+1]+=d[c][a]*d[c][s],F[a+1][s+1]=F[s+1][a+1];if(F[0][0]=f,o){for(g=0;g<h+1;g++)for(P[g]=[],m=0;m<h+1;m++)P[g][m]=0;for(a=0;a<h+1;a++)P[a][a]=1}for(L=n?0:1,a=0;a<h+1;a++){if(0===F[a][a]){for(y=!1,s=a+1;!y&&s<h+1;s++)if(0!==F[s][a]){for(c=0;c<h+2;c++)C=F[a][c],F[a][c]=F[s][c],F[s][c]=C;if(o)for(c=0;c<h+1;c++)C=P[a][c],P[a][c]=P[s][c],P[s][c]=C;y=!0}if(!y)return K}for(w=1/F[a][a],c=L;c<h+2;c++)F[a][c]*=w;if(o)for(c=L;c<h+1;c++)P[a][c]*=w;for(s=L;s<h+1;s++)if(s!==a){for(w=-F[s][a],c=L;c<h+2;c++)F[s][c]+=w*F[a][c];if(o)for(c=L;c<h+1;c++)P[s][c]+=w*P[a][c]}n||(F[0][h+1]=0)}for(b=e?[[],h+1]:[[]],a=0;a<h+1;a++)b[0][a]=e?z(F[h-a][h+1]):F[h-a][h+1];if(o){if(e)b[1]=[],b[2]=[],b[3]=[],b[4]=[];else for(g=1;g<5;g++)for(b[g]=[],m=0;m<h+1;m++)b[g][m]=0;for(O=void 0,B=_[h+1]-_[0]*_[0]/f,O=_[h+1],a=0;a<h+1;a++)O-=F[a][h+1]*_[a];if(j=B-O,b[2][0]=0==B?K:j/B,b[4][0]=j,b[4][1]=O,0===(C=n?f-h-1:f-h)){for(a=0;a<h+1;a++)b[1][a]=K;b[2][1]=K}else{for(v=O/J(C),n||(b[1][h]=Y),a=L;a<h+1;a++)b[1][h-a]=q(v*P[a][a]);b[2][1]=q(v)}for(b[3][0]=0===O?K:J(C)*j/(O*J(h)),b[3][1]=J(C),a=2;a<5;a++)for(s=2;s<h+1;s++)b[a][s]=Y}return e||(b=[b[0]]),new U.CalcArray(b)}return K}function Rt(e,t){var r,n,o,i,a,s=0,l=0,u=0,c=[];for(o=0;o<A(t);o++)for(a=t[o],c.push(a),i=0;i<A(a);i++)(r=a[i])!==L&&(s+=r,u++);for(n=s/u,o=0;o<A(t);o++)for(a=c[o],i=0;i<A(a);i++)(r=a[i])!==L&&(l+=e?(r-n)*(r-n):R(r-n));return e?N(l):0===u?D:N(l/u)}function Dt(){return i(arguments,2,7)}function Nt(e,t){return h([e,t],16)}function Ft(e,t,r){var n,o,i,a=0,s=0,l=b(t);if(e.rowCount!==r.rowCount||e.colCount!==r.colCount)return y;for(n=0;n<A(e);n++)if(o=e[n],l&&l(o,!0)&&(i=r[n])!==L){if(F(i))return i;a+=i,s++}return 0===s?D:N(a/s)}function _t(e,t,r,n){var o,i,a,s=t,l=t,u=e?s.getRowCount():l.getRowCount(0),c=e?s.getColumnCount():l.getColumnCount(0),h=[];for(o=0;o<u;o++)for(h[o]=[],i=0;i<c;i++)a=e?s.getValue(o,i):l.getValue(0,o,i),h[o][i]=Ft(r,a,n);return new U.CalcArray(h)}function Pt(){return h(arguments,13)}function Lt(e,t,r){var n=U.CalcArrayHelper;if(U.Convert._isReference(e)){if(1!==n.getLength(e))return y;e=n.getValueByIndex(e,0)}return e=J(e),k(e)?y:At(!0,t,e,r)}function Ot(e,t,r){return Je(e,t,r,!0)}function Bt(e,t){return h([e,t],17)}function jt(e,t){var r,n,o=0,i=0===t||"*"===t,a=b(t);for(r=0;r<A(e);r++)n=e[r],i&&n===W||!a||!a(n)||o++;return N(o)}function Ht(){return i(arguments,2,8)}function Gt(){return i(arguments,2,10)}function Ut(){return i(arguments,2,11)}function Wt(e,t){return Mt(!0,e,t)}function Vt(e,t,r){var n=ur(e/2);return F(n)?n:-J(n)*(t/q(r))}function zt(e){var t,r=e,n=r+5.5;return n-=(r+.5)*Z(n),t=1.000000000190015+76.18009172947146/(e+1),t-=86.50532032941678/(e+2),t+=24.01409824083091/(e+3),t-=1.231739572450155/(e+4),t+=.001208650973866179/(e+5),Z(2.506628274631001*(t-=5395239384953e-18/(e+6))/r)-n}function qt(e,t,r,n,o){var i,a,s,l,u,c,h;return e<n||o<e||n===o?K:(i=(e-n)/(o-n),a=zt(t+r),s=zt(t),l=zt(r),u=Z(i),c=Z(1-i),h=z(a-s-l+t*u+r*c)*function(e,t,r){var n,o,i,a,s,l=1e-50,u=e+t,c=e+1,h=e-1,f=1,d=1-u*r/c;for(R(d)<l&&(d=l),n=d=1/d,o=1;o<=300&&(R(d=1+(a=(t-o)*o*r/((h+(i=o+o))*(e+i)))*d)<l&&(d=l),R(f=1+a/f)<l&&(f=l),n*=(d=1/d)*f,R(d=1+(a=0-(e+o)*(u+o)*r/((e+i)*(c+i)))*d)<l&&(d=l),R(f=1+a/f)<l&&(f=l),n*=s=(d=1/d)*f,!(R(s-1)<1e-20));o++);return n}(r,t,1-i)/r,N(i<(t+1)/(t+r+2)?h:1-h))}function Zt(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=it(t,r);for(i=e<=.5?(l=e,f=t,p=r,0):(l=1-e,f=r,p=t,1),w=(g=q(-Z(l*l)))-(2.30753+.27061*g)/(1+(.99229+.04481*g)*g),x=1<f&&1<p?(C=w*q((h=2/((m=1/(f+f-1))+(b=1/(p+p-1))))+(g=(w*w-3)/6))/h-(b-m)*(g+5/6-2/(3*h)),f/(f+p*z(C+C))):(b=(g=p+p)*I(1-(b=1/(9*p))+w*q(b),3))<=0?1-z((Z((1-l)*p)+T)/p):(b=(4*f+g-2)/b)<=1?z((Z(l*f)+T)/f):1-2/(b+1),g=1-f,b=1-p,v=0,u=1,x<3e-308?x=3e-308:1-222e-18<x&&(x=1-222e-18),S=E(1e-300,I(10,-13-2.5/(f*f)-.5/(l*l))),y=d=0,a=0;a<1e3;a++){for((w=((w=at(x,f,p))-l)*z(T+g*Z(x)+b*Z(1-x)))*v<=0&&(d=E(R(u),3e-308)),c=1,s=0;s<1e3;s++){if(R(u=c*w)<d&&(0<=(y=x-u)&&y<=1)){if(d<=S)return 0!==i&&(x=1-x),N((o-n)*x+n);if(R(w)<=S)return 0!==i&&(x=1-x),N((o-n)*x+n);if(0!==y&&1!==y)break}c/=3}if(y===x)return 0!==i&&(x=1-x),N((o-n)*x+n);x=y,v=w}return 0!==i&&(x=1-x),N((o-n)*x+n)}function Yt(e,t,r,n){var o,i,a,s;if(t<e)return K;if(!n){if(0===(i=I(o=1-r,t))){if(0===(i=I(r,t)))return K;for(a=0;a<t-e&&0<i;a++)i*=J(t-a)/J(a+1)*o/r;return i}for(a=0;a<e&&0<i;a++)i*=J(t-a)/J(a+1)*r/o;return i}if(t===e)return 1;if(0===(i=I(o=1-r,t))){if(0===(i=I(r,t)))return K;for(s=1-i,a=0;a<t-e&&0<i;a++)s-=i*=J(t-a)/J(a+1)*o/r;return s<0?0:s}for(s=i,a=0;a<e&&0<i;a++)s+=i*=J(t-a)/J(a+1)*r/o;return s}function Kt(e,t,r){var n,o,i=1-t,a=I(i,e);if(0===a){if(0===(a=I(t,e)))return K;for(n=1-a,o=0;o<e&&r<=n;o++)n-=a*=J(e-o)/J((o+1)*i/t);return J(e-o)}for(n=a,o=0;o<e&&n<r;o++)n+=a*=J(e-o)/J((o+1)*t/i);return J(o)}function Xt(e,t){var r,n,o,i,a,s,l=Z(q(g)),u=1/q(g),c=0,h=e,f=.5*h,d=t%2==0;if(1<t&&(c=z(-f)),a=w(-q(h)),F(a))return a;if(s=J(a),n=d?c:2*s,2<t){if(h=.5*(t-1),o=d?1:.5,20<f){for(r=d?0:l,i=Z(f);o<=h;)r=Z(o)+r,n+=z(i*o-f-r),o+=1;return n}for(r=d?1:u/q(f),i=0;o<=h;)i+=r*=f/o,o+=1;return i*c+n}return n}function Jt(e,t){var r=or(1-e,.5*t,2);return J(r)}function Qt(e,t){var r,n,o,i,a=0,s=e.rowCount,l=e.colCount;if(s!==t.rowCount||l!==t.colCount)return Y;if(1<s&&1<l)r=(s-1)*(l-1);else if(1<s&&1===l)r=s-1;else{if(!(1===s&&1<l))return Y;r=l-1}for(n=0;n<A(e);n++)if(o=e[n],i=t[n],o!==L&&i!==L){if(0===i)return D;a+=(o-i)*(o-i)/i}return a<0?K:Xt(a,r)}function $t(e,t,r){var n=z(-t*e);return N(r?1-n:t*n)}function er(e,t,r){var n=qt(t*e/(t*e+r),.5*t,.5*r,0,1);return F(n)?n:1-J(n)}function tr(e,t,r){var n=Zt(1-(1-e),r/2,t/2,0,1);return F(n)?n:(1/J(n)-1)*(r/t)}function rr(e,t){var r,n,o,i,a,s,l={N:0,M:0,Q:0,kl:0};return ct(l,e),i=l.N-1,1===l.N?D:0==(r=l.Q/(l.N-1))?D:(l.N=0,l.M=0,l.Q=0,l.kl=0,ct(l,t),a=l.N-1,1===l.N?D:0==(n=l.Q/(l.N-1))?D:(s=er(r/n,i,a),F(s)?s:(1<(o=2*(1-J(s)))&&(o=2-o),o)))}function nr(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y;if(!1===n)return o=I(r,t),k(o)||!M(o)?D:1/(o*nt(t))*(I(e,t-1)*z(-e/r));if((e/=r)<=0)return K;if(1e3<t)return y=sr(i=3*q(t)*(I(e/t,1/3)+1/(9*t)-1),0,1,!0),F(y)?y:J(y);if(1e8<e)return 1;if(e<=1||e<t){if(y=ir(t+1),F(y))return y;for(h=t*Z(e)-e-J(y),b=f=1,p=t;b+=f=f*e/(p+=1),2220446049250313e-31<f;);h+=Z(b),b=0,-88<=h&&(b=z(h))}else{if(y=ir(t),F(y))return y;for(h=t*Z(e)-e-J(y),f=0,b=(s=(a=e)+(i=1))/(l=e*(g=(p=1-t)+e+1));;){if(u=(g+=2)*s-(m=(p+=1)*(f+=1))*i,0<R(c=g*l-m*a)){if(R(b-(d=u/c))<=v(2220446049250313e-31,2220446049250313e-31*d))break;b=d}i=s,a=l,l=c,1e37<=R(s=u)&&(i/=1e37,a/=1e37,s/=1e37,l/=1e37)}h+=Z(b),b=1,-88<=h&&(b=1-z(h))}return b}function or(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m;if(e<2e-6)return 0;if(.999998<e)return P;if(u=2*t,i=t-1,m=ir(t),F(m))return m;if(s=J(m),u<-1.24*Z(e)){if((a=I(e*t*z(s+.6931471805599453*t),1/t))<5e-7)return NaN}else if(.32<u){if(m=lr(e,0,1),F(m))return m;p=J(m),2.2*u+6<(a=u*I(p*q(l=.222222/u)+1-l,3))&&(a=-2*(Z(1-e)-i*Z(.5*a)+s))}else for(a=.4,n=Z(1-e)+s+.6931471805599453*i;d=(4.67+2*(h=a))/(l=1+a*(4.67+a))-.5-(6.73+a*(13.32+3*a))/(c=a*(6.73+a*(6.66+a))),a-=(1-z(n+.5*a)*c/l)/d,.01<R(h/a-1););for(g=1;g<=20;g++){if(m=nr(l=.5*(h=a),t,1,!0),F(m))return m;if(d=(c=e-J(m))*z(.6931471805599453*t+s+l-i*Z(a)),5e-7<R(h/(a+=d*(1+.5*d*(f=(210+(n=.5*d-(o=d/a)*i)*(140+n*(105+n*(84+n*(70+60*n)))))/420)-o*i*(f-o*((420+n*(735+n*(966+n*(1141+1278*n))))/2520-o*((210+n*(462+n*(707+932*n)))/2520-o*((252+n*(672+1182*n)+i*(294+n*(889+1740*n)))/5040-o*((84+2264*n+i*(1175+606*n))/2520-o*((120+i*(346+127*i))/5040))))))))-1))return.5*r*a}return.5*r*a}function ir(e){return ot(e)}function ar(e,t,r){var n,o=ur(e);return F(o)?o:(n=J(o),N(z(t+r*n)))}function sr(e,t,r,n){return n?w((e-t)/r):N(z(-(e-t)*(e-t)/(2*r*r))/(q(2*g)*r))}function lr(e,t,r){var n,o,i,a,s,l=e-.5;if(R(l)<=.42)o=l*(((-25.44106049637*(n=l*l)+41.39119773534)*n-18.61500062529)*n+2.50662823884)/((((3.13082909833*n-21.06224101826)*n+23.08336743743)*n-8.4735109309)*n+1);else{if(n=e,0<l&&(n=1-e),!(2220446049250313e-31<n))return 1e-300<n?(o=-2*Z(e),n=Z(6.283185307179586*o),o=q(o*(1-(n=n/o+(2-n)/(o*o)+(6*n-14-n*n)/(2*o*o*o)))),l<0?-o:o):l<0?-P:P;o=(((2.32121276858*(n=q(-Z(n)))+4.85014127135)*n-2.29796479134)*n-2.78718931138)/((1.63706781897*n+3.54388924762)*n+1),l<0&&(o=-o)}return a=.3989422804014327*z(-.5*(i=+o)*i),s=sr(o,0,1,!0),F(s)?s:t+r*(o-=(s-e)/a)}function ur(e){return lr(e,0,1)}function cr(e,t,r){var n,o=0;if(r)for(n=0;n<=e;n++)o+=z(-t)*I(t,n)/U.Functions.tk(n);else o=z(-t)*I(t,e)/U.Functions.tk(e);return N(o)}function hr(e,t,r){var n,o,i,a,s,l,u,c,h,f;if(1!==r&&2!==r)return K;if(o=e/q(n=t),i=n/(n+e*e),a=n-2,s=n%2,n=u=l=1,h=c=2+s,2<=a)for(f=x(c);f<=a&&(l+=u=u*i*(h-1)/h)!==n;f+=2)n=l,h+=2;return 1!=s?r*(1-(.5+.5*o*q(i)*l)):(1===t&&(l=0),r*(1-(.5+.3183098862*(o*i*l+d(o)))))}function fr(e,t){var r,n,o,i,a,s,l,u,c,h,f=e/2,d=f;if(1e20<t)return ur(f);if(a=d<.5?(c=0,2*d):2*((c=1)-d),R(t-2)<1e-12)s=0<a?q(2/(a*(2-a))-2):P;else if(J(t)<1+1e-12)s=0<a?-p(1.5707963267948966*(a+1)):P;else{if(i=((94.5/((n=48/((r=1/(t-.5))*r))+(o=((20700*r/n-98)*r-16)*r+96.36))-3)/n+1)*q(1.5707963267948966*r)*t,.05+r<(u=I(i*a,2/t))){if(h=ur(.5*a),F(h))return h;l=J(h),t<5&&(o+=.3*(t-4.5)*(l+.6)),u=(((((.4*(u=l*l)+6.3)*u+36)*u+94.5)/(o=(((.05*i*l-5)*l-7)*l-2)*l+n+o)-u-3)/n+1)*l,u=.002<(u*=r*u)?z(u)-1:.5*u*u+u}else u=((1/(((t+6)/(t*u)-.089*i-.822)*(t+2)*3)+.5/(t+4))*u-1)*(t+1)/(t+2)+1/u;s=q(t*u)}return 0!==c&&(s=-s),N(s)}function dr(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T={N:0,M:0,Q:0,kl:0};if(1!==r&&2!==r)return K;if(1===n){if(C=y=b=m=g=p=d=void 0,A(e)!==A(t))return Y;for(w=A(e),C=0;C<w;C++)e[C]=e[C]-t[C];for(m=b=y=d=0,C=0;C<w;C++)m+=g=(p=(v=e[C])-m)/(y+1),b+=y*p*g,y++,d+=v;if(y-1==0||0===y)return D;if(s=q(b/(y-1)),k(s)||!M(s))return K;a=(o=d/y)/(s/q(y)),c=y-1}else T.N=0,T.M=0,T.Q=0,T.kl=0,lt(T,e),l=T.Q/(T.N-1),o=T.kl/T.N,h=T.N,T.N=0,T.M=0,T.Q=0,T.kl=0,lt(T,t),u=T.Q/(T.N-1),i=T.kl/T.N,f=T.N,c=2!==n?1/((S=l/h/(l/h+u/f))*S/J(h-1)+(1-S)*(1-S)/J(f-1)):J(h+f-2),a=(o-i)/q(l/J(h)+u/J(f));return x=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m=0===r||1===r?0:z(ut(e+t)-ut(e)-ut(t)+e*Z(r)+t*Z(1-r)),b=(e+1)/(e+t+2)<=r;for(b&&(n=e,e=t,t=n,r=1-r),o=4450147717014403e-323,s=e-1,R(u=(l=1)-(i=e+t)*r/(a=e+1))<o&&(u=o),c=u=1/u,h=1,f=2;h<=100;h++,f+=2)if(R(u=1+(d=h*(t-h)*r/((s+f)*(e+f)))*u)<o&&(u=o),R(l=1+d/l)<o&&(l=o),c*=(u=1/u)*l,R(u=1+(d=-(e+h)*(i+h)*r/((e+f)*(a+f)))*u)<o&&(u=o),R(l=1+d/l)<o&&(l=o),c*=p=(u=1/u)*l,R(J(p-1))<5e-324)return g=m*c/e,b?1-g:g;return K}(.5*c,.5,c/(c+(a=R(a))*a)),F(x)?x:.5*r*J(x)}function pr(e,t,r,n){var o=z(-I(e/r,t));return N(n?1-o:t/I(r,t)*I(e,t-1)*o)}function gr(e,t,r){var n,o,i,a,s,l,u=0,c=0,h=0,f=0;if(r!==V&&(u=J(r),k(u)))return y;for(a=0;a<A(e);a++)(s=e[a])!==L&&(c+=i=J(s),h+=i*i,f++);return 0===f?Y:1===f?D:(n=c/f,0===(o=r!==V?u:q((f*h-c*c)/(f*(f-1))))?D:(l=w((n-t)/(o/q(f))),F(l)?l:N(1-J(l))))}Object.defineProperty(t,"__esModule",{value:!0}),a=r("Common"),U=r("CalcEngine"),A=a.Common.k.ac,W=null,V=void 0,k=isNaN,M=isFinite,s=parseInt,I=Math.pow,E=Math.max,v=Math.min,S=Math.floor,u=Math.sin,p=Math.tan,g=Math.PI,d=Math.atan,z=Math.exp,R=Math.abs,q=Math.sqrt,Z=Math.log,l=Math.round,D=U.Errors.DivideByZero,y=U.Errors.Value,Y=U.Errors.NotAvailable,K=U.Errors.Number,m=U.Errors.Null,N=U.Convert.Nh,X=U.Convert.Ph,x=U.Convert.Rh,J=U.Convert.Pa,o=U.Functions.MathHelper,c=o.Bk,b=o.xk,C=U.Convert.Na,F=U.Convert.vf,n=U.Functions.Hfc,i=U.Functions.sk,h=U.Functions.sja,w=U.Functions.qk,f=U.Functions.ik,T=U.Functions.jk,_=U.Functions.Na,P=U.Functions.hk,L=U.Convert.CalcConvertedError,O=U.Functions.ak,B=U.Convert.Th,j=U.Convert.Sh,ne={Hi:0,aj:["< 0",">= 1"]},pe={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0,Xi:!0},ge={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},me={Hi:4,Ii:1,Ki:!0,Mi:!0},be={Hi:4,Ii:0,Ji:!0},we={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},ve={Hi:4,Ii:0,Ji:!0,Ki:!0,Mi:!0,Xi:!0},Se={Hi:4,Ii:0,Ji:!0,Ki:!0},Te=[fe={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0},{Hi:2}],Ae=[fe,re={Hi:0},{_i:3,Hi:2,aj:"< 1"}],ke=[oe={Hi:0,aj:["<= 0",">= 1"]},ie={Hi:0,aj:"<= 0"},$={Hi:2,aj:"< 1"}],Me=[oe,ie,ie,ae={_i:0,Hi:0},se={_i:1,Hi:0}],Ie=[ee={Hi:2,aj:"< 0"},ee,le={Hi:0,aj:["< 0","> 1"]},H={Hi:7}],Ee=[ee,le,oe],Re=[ue={Hi:0,aj:"< 0"},ce={Hi:0,aj:["< 1","> 10000000000"]}],De=[le,te={Hi:2,aj:["< 1","> 10000000000"]}],Ne=[de={Hi:4,Ii:1,Ji:!0,Ki:!0},de],Fe=[ue,ie,H],_e=[ue,he={Hi:0,aj:["< 1",">= 10000000000"]},he],Pe=[le,he,he],Le=[fe,fe],Oe=[ue,ie,ie,H],Be=[le,ie,ie],je=[le,re,ie],He=[re,re,ie,H],Ge=[ye={Hi:4,Ii:1,Ji:!0},ye],Ue=[ee,ue,H],We=[ue,$],Ve=[Ce={Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0},Ce,Q={Hi:2},{Hi:2,aj:["< 1","> 3"]}],ze=[ue,ie,ie,H],Ze=[xe={Hi:4,Ii:1,Ki:!0,Li:!0},{},G={_i:!0,Hi:7},{_i:!(qe=[fe,re]),Hi:7}],Ye=[{},fe,ae],Ke=[{Hi:4,Ii:1,Ji:!0,Ki:!0,hOb:!0,Mi:!0},re],O("TREND",function(e,t,r,n){var o,i;for(t=t!==V?X(t,0,!1,!0,!1):e,r=r!==V?X(r,0,!1,!0,!1):t,o=0;o<e.rowCount;o++)for(i=0;i<e.colCount;i++)if(!C(e[o][i]))return y;for(o=0;o<t.rowCount;o++)for(i=0;i<t.colCount;i++)if(!C(t[o][i]))return y;for(o=0;o<r.rowCount;o++)for(i=0;i<r.colCount;i++)if(!C(r[o][i]))return y;return a.Common.qc(e,t,r,n,J,U.CalcArray,y,Y)},1,4,[{Hi:4,Ii:0,Ki:!0},{},{},G],[0,1,2],[0,1,2],{bk:[1,2,3]}),O("GROWTH",function(e,t,r,n){return t=t!==V?X(t,1,!1,!0,!0):e,r=r!==V?X(r,1,!1,!0,!0):t,a.Common.sc(e,t,r,n,U.CalcArray,K,Y)},1,4,[xe,{},{},G],"!= 3","!= 3",{bk:[1,2,3]}),O("FORECAST",function(e,t,r){var n,o,i,a,s=0,l=0,u=0,c=0,h=A(t),f=0;if(h!==A(r))return Y;for(n=0;n<h;n++)o=t[n],i=r[n],o!==L&&i!==L&&(s+=o,l+=i,u+=i*i,c+=i*o,f++);return 0===f||f*u-l*l==0?D:N(s/f-l/f*(a=(f*c-l*s)/(f*u-l*l))+a*e)},3,3,[re,de,de],"> 0","> 0"),O("AVERAGE",function(){return n(arguments,2,1)},1,V,V,-1,-1),O("STDEV",Dt,1,V,V,-1,-1),O("STDEV.S",Dt,1,V,V,-1,-1),O("PERCENTILE",Nt,2,2,V,0,0),O("PERCENTILE.INC",Nt,2,2,V,0,0),O("MAX",function(){return n(arguments,2,4)},1,V,V,-1,-1),O("MAXA",function(){return Tt(!0,arguments)},1,V,we,-1,-1),O("MIN",function(){return n(arguments,2,5)},1,V,V,-1,-1),O("MINA",function(){return Tt(!1,arguments)},1,V,we,-1,-1),O("LARGE",function(e,t){return h([e,t],14)},2,2,Ke,0,0),O("SMALL",function(e,t){return h([e,t],15)},2,2,Ke,0,0),O("AVERAGEA",function(){var e,t,r,n,o=arguments,i=0,a=0;for(e=0;e<A(o);e++)for(n=o[e],t=0;t<A(n);t++)r=n[t],C(r,!0)||f(r)?(i+=J(r),a++):r!==W&&!T(r)||a++;return 0===a?D:N(i/a)},1,V,ve,-1,-1),O("AVERAGEIF",function(e,t,r){if(r!==V){if(e=X(e,0,!0,!1,!1),(r=X(r,1,!0,!1,!1,!0,V,!0)).isError)return r[0]}else{if((e=X(e,1,!0,!1,!1,!0,V,!0)).isError)return e[0];r=e}return U.Convert._isReference(t)?_t(!1,t,e,r):U.Convert.Ca(t)?_t(!0,t,e,r):Ft(e,t,r)},2,3,V,[0,1,2],[0,1,2],{bk:2}),O("AVERAGEIFS",function(e){var t,r,n,o,i,a,s=arguments,l=0,u=0,c=e.length,h=s.length,f=[];for(f.push(e),n=1;n<h;n+=2){if((o=X(s[n],0,!0,!1,!1)).isError)return o[0];f.push(o),i=b(s[n+1]),f.push(i)}for(r=0;r<c;r++)if((t=e[r])!==L){for(a=!0,n=1;n<h&&(a=(i=f[n+1])(f[n][r]));n+=2);a&&(l+=t,u++)}return 0===u?D:N(l/u)},3,V,fe,[0,"%= 1"],[0,"%= 1"]),O("MEDIAN",function(){return h(arguments,12)},1,V,pe,-1,-1),O("MODE",Pt,1,V,pe,-1,-1),O("MODE.SNGL",Pt,1,V,pe,-1,-1),O("GEOMEAN",function(){return It(!0,arguments)},1,V,ge,-1,-1),O("HARMEAN",function(){return It(!1,arguments)},1,V,pe,-1,-1),O("TRIMMEAN",function(e,t){var r,n,o,i=0,a=[];for(ft(e,a),r=function(e){var t,r=0;for(t=0;t<e.length;t++)e[t]!==L&&r++;return r}(a),o=n=s(""+r*t/2);o<r-n;o++)i+=J(a[o]);return i/(r-2*n)},2,2,[fe,ne],0,0),O("FREQUENCY",function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p=0,g=t.rowCount,m=t.colCount;for(r=0;r<g;r++)for(n=0;n<m;n++)t[r][n]!==L&&p++;for(i=e.rowCount,a=e.colCount,s=[],l=[],u=p+1,r=p=0;r<g;r++)for(n=0;n<m;n++)(o=t[r][n])!==L&&(s[p++]=J(o));for(c=s.slice(0),ht(s),r=0;r<u;r++)l[r]=[0];for(r=0;r<i;r++)for(n=0;n<a;n++)if(o=e[r][n],C(o)){for(h=J(o),f=!1,d=0;!f&&d<p;d++)h<=s[d]&&(l[c.indexOf(s[d])][0]++,f=!0);f||l[p][0]++}return new U.CalcArray(l)},2,2,[me,me],-1,-1),O("RANK",Lt,2,3,Ye,[0,1],[0,1],{bk:2}),O("RANK.EQ",Lt,2,3,Ye,[0,1],1,{bk:2}),O("KURT",function(){var e,t,r,n,o,i,a=arguments,s=0,l=0,u=0,c=0,h=A(a),f=[];if(0<h){for(i=a[0],f.push(i),n=0;n<A(i);n++)(e=i[n])!==L&&(s+=e,l+=e*e,c++);if(c<=3)return D;if(t=s/c,0===(r=q((c*l-s*s)/(c*(c-1)))))return D;for(o=0;o<h;o++)for(i=f[o],n=0;n<A(i);n++)(e=i[n])!==L&&(u+=I((e-t)/r,4));return N(c*(c+1)*u/((c-1)*(c-2)*(c-3))-3*(c-1)*(c-1)/((c-2)*(c-3)))}},1,V,pe,-1,-1),O("PERCENTRANK",Ot,2,3,Ae,0,0,{bk:2}),O("PERCENTRANK.INC",Ot,2,3,Ae,0,0,{bk:2}),O("PERCENTRANK.EXC",function(e,t,r){return Je(e,t,r,!1)},2,3,Ae,0,0,{bk:2}),O("QUARTILE",Bt,2,2,Te,0,0),O("QUARTILE.INC",Bt,2,2,Te,0,0),O("COUNT",function(){return n(arguments,2,2)},1,V,V,-1,-1,{gk:-1}),O("COUNTA",function(){return n(arguments,2,3)},1,V,V,-1,-1,{gk:-1}),O("COUNTBLANK",function(e){var t,r=0;for(t=0;t<A(e);t++)e[t]!==W&&""!==e[t]||r++;return r},1,1,be,-1,-1),O("COUNTIF",function(e,t){var r,n,o,i,a,s,l,u,c;if(t.isArray||t.isReference){for(n=r=void 0,o=0,i=[],a=t.rowCount,s=t.colCount,l=0;l<a;l++){for(u=[],c=0;c<s;c++,o++)n=jt(e,t[o]),F(n)?u.push(n):(r=J(n),k(r)?u.push(y):u.push(r));i.push(u)}return new U.CalcArray(i)}return jt(e,t[0])},2,2,[be,be],[0,1],[0,1]),O("COUNTIFS",function(e){var t,r,n,o,i,a=arguments,s=0,l=A(e),u=A(a),c=[];for(n=0;n<u;n+=2){if((t=0===n?e:X(a[n],0,!0,!1,!1)).isError)return t[0];l=t.length,c.push(t),o=b(a[n+1]),c.push(o)}for(r=0;r<l;r++){for(i=!0,n=0;n<u&&(i=(o=c[n+1])&&o(c[n][r]));n+=2);i&&s++}return N(s)},2,V,Se,"%= 0","%= 0"),O("AVEDEV",function(){return Rt(!1,arguments)},1,V,pe,-1,-1),O("STDEVA",function(){return kt(arguments,1,!0,!0)},1,V,ve,-1,-1),O("STDEVP",Ht,1,V,V,-1,-1),O("STDEV.P",Ht,1,V,V,-1,-1),O("STDEVPA",function(){return kt(arguments,0,!0,!1)},1,V,ve,-1,-1),O("VAR",Gt,1,V,V,-1,-1),O("VAR.S",Gt,1,V,V,-1,-1),O("VARA",function(){return kt(arguments,1,!1,!1)},1,V,ve,-1,-1),O("VARP",Ut,1,V,V,-1,-1),O("VAR.P",Ut,1,V,V,-1,-1),O("VARPA",function(){return kt(arguments,0,!1,!1)},1,V,ve,-1,-1),O("COVAR",Wt,2,2,Ne,-1,-1),O("COVARIANCE.P",Wt,2,2,Ne,-1,-1),O("DEVSQ",function(){return Rt(!0,arguments)},1,V,pe,-1,-1),O("CONFIDENCE",Vt,3,3,ke),O("CONFIDENCE.NORM",Vt,3,3,ke),O("CONFIDENCE.T",function(e,t,r){return 1===r?D:t*xt(e,r-1,2)/q(r)},3,3,ke),O("INTERCEPT",function(e,t){var r,n,o,i=0,a=0,s=0,l=0,u=0,c=A(e);if(c!==A(t))return Y;for(o=0;o<c;o++)r=e[o],(n=t[o])!==L&&r!==L&&(i+=r,a+=n,s+=n*n,l+=n*r,u++);return 0===u||u*s-a*a==0?D:N(i/u-a/u*((u*l-a*i)/(u*s-a*a)))},2,2,[pe,pe],-1,-1),O("LINEST",function(e,t,r,n){return Et(!1,e,t,r,n)},1,4,Ze,[0,1],[0,1],{bk:[1,2,3],fk:1}),O("SLOPE",function(e,t){var r,n,o,i,a,s=0,l=0,u=0,c=0,h=0,f=A(t);if(f!==A(e))return Y;for(r=0;r<f;r++)n=e[r],(o=t[r])===L||n===L||F(o)||F(n)||(s+=i=J(n),l+=a=J(o),u+=a*a,c+=a*i,h++);return h*u-l*l==0?D:N((h*c-l*s)/(h*u-l*l))},2,2,[pe,pe],-1,-1,{fk:1}),O("LOGEST",function(e,t,r,n){return Et(!0,e,t,r,n)},1,4,Ze,[0,1],[0,1],{bk:[1,2,3]}),O("STEYX",function(e,t){var r,n,o,i=0,a=0,s=0,l=0,u=0,c=0,h=A(e);if(h!==A(t))return Y;for(r=0;r<h;r++)n=e[r],o=t[r],n!==L&&o!==L&&(i+=n,a+=n*n,s+=o,l+=o*o,u+=o*n,c++);return c*(c-2)==0||c*l-s*s==0?D:q((c*a-i*i-(c*u-s*i)*(c*u-s*i)/(c*l-s*s))/(c*(c-2)))},2,2,Ne,-1,-1),O("BETADIST",qt,3,5,[re,ie,ie,ae,se],V,V,{bk:[3,4]}),O("BETA.DIST",function(e,t,r,n,o,i){if(e<o||i<e||o===i)return K;var a=(e-o)/(i-o);return n?dt(a,t,r):pt(a,t,r)/(i-o)},4,6,[re,ie,ie,H,ae,se],V,V,{bk:[5,6]}),O("BETAINV",Zt,3,5,Me,V,V,{bk:[3,4]}),O("BETA.INV",Zt,3,5,Me,V,V,{bk:[3,4]}),O("BINOMDIST",Yt,4,4,Ie),O("BINOM.DIST",Yt,4,4,Ie),O("NEGBINOMDIST",function(e,t,r){if(e+t-1<=0)return K;var n=c(e+t-1,t-1);return F(n)?n:N(J(n)*I(r,t)*I(1-r,e))},3,3,[Q,Q,ne]),O("NEGBINOM.DIST",function(e,t,r,n){if(e+t-1<=0)return K;if(n)return 1-dt(1-r,e+1,t);var o,i=I(r,t);for(o=0;o<e;o++)i*=(o+t)/(o+1)*(1-r);return i},4,4,[ee,$,ne,H]),O("CRITBINOM",Kt,3,3,Ee),O("BINOM.INV",Kt,3,3,Ee),O("CHIDIST",Xt,2,2,Re),O("CHISQ.DIST.RT",Xt,2,2,Re),O("CHISQ.DIST",function(e,t,r){return(r?wt:function(e,t){var r,n;if(e<=0)return 0;if(1391e3<t*e)r=z((.5*t-1)*Z(.5*e)-.5*e-Z(2)-yt(.5*t));else{for(n=t%2<.5?(r=.5,2):(r=1/q(2*e*g),1);n<t;)r*=e/n,n+=2;r=1425<=e?z(Z(r)-e/2):r*z(-e/2)}return r})(e,t)},3,3,[ue,te,H]),O("CHIINV",Jt,2,2,De),O("CHISQ.INV.RT",Jt,2,2,[le,$]),O("CHISQ.INV",function(e,t){var r,n,o={jl:!1},i=st((r=e,{ge:function(e){return r-wt(e,n)}}),.5*(n=t),t,o);return o.jl?Y:i},2,2,De),O("CHITEST",Qt,2,2,Ne,-1,-1),O("CHISQ.TEST",Qt,2,2,Ne,-1,-1),O("CORREL",function(e,t){var r,n,o,i,a,s,l,u,c=U.ExcelCompatibleCalcMode?5:1,h=X(e,c,!0,!1,!1,!0),f=X(t,c,!0,!1,!1,!0),d=0,p=0,g=0,m=0,b=0,y=A(f);if(y!==A(h))return Y;for(s=a=0;s<y;s++){if(l=h[s],u=f[s],F(l))return l;if(F(u))return u;l!==L&&u!==L&&(d+=l,p+=u,g+=l*l,m+=u*u,a++)}if(a<=1)return D;if(r=d/a,n=p/a,o=q((a*g-d*d)/(a*(a-1))),i=q((a*m-p*p)/(a*(a-1))),0===o||0===i)return D;for(s=0;s<y;s++)l=h[s],u=f[s],l!==L&&u!==L&&(b+=(l-r)*(u-n));return N(b/J((a-1)*o*i))},2,2,V,-1,-1),O("EXPONDIST",$t,3,3,Fe),O("EXPON.DIST",$t,3,3,Fe),O("FDIST",er,3,3,_e),O("F.DIST",function(e,t,r,n){return n?1-dt(r/(r+t*e),r/2,t/2):I(t/r,t/2)*I(e,t/2-1)/(I(1+e*t/r,(t+r)/2)*gt(!0,t/2,r/2))},4,4,[ue,ce,ce,H]),O("F.DIST.RT",er,3,3,_e),O("FINV",tr,3,3,Pe),O("F.INV.RT",tr,3,3,Pe),O("F.INV",function(e,t,r){var n=Zt(1-e,r/2,t/2,0,1);return F(n)?n:(1/J(n)-1)*(r/t)},3,3,[le,te,te]),O("FISHER",function(e){return Z((1+e)/(1-e))/2},1,1,{Hi:0,aj:["<= -1",">= 1"]}),O("FISHERINV",function(e){var t=z(2*e)-1,r=z(2*e)+1;return!M(t)&&0<t&&!M(r)&&0<r?1:t/r},1,1,re),O("FTEST",rr,2,2,Le,-1,-1),O("F.TEST",rr,2,2,Le,-1,-1),O("GAMMADIST",nr,4,4,Oe),O("GAMMA.DIST",nr,4,4,Oe),O("GAMMAINV",or,3,3,Be),O("GAMMA.INV",or,3,3,Be),O("GAMMALN",ir,1,1,ie),O("GAMMALN.PRECISE",ir,1,1,ie),O("HYPGEOMDIST",function(e,t,r,n){return e>v(t,r)||e<E(0,t-n+r)||n<t||n<r?K:vt(e,t,r,n)},4,4,[ee,ee,ee,ee]),O("HYPGEOM.DIST",function(e,t,r,n,o){var i,a;if(e>v(t,r)||e<E(0,t-n+r)||n<t||n<r)return K;if(o){for(a=i=0;a<=e;a++)i+=vt(a,t,r,n);return i}return vt(e,t,r,n)},5,5,[ee,ee,ee,ee,H]),O("LOGNORMDIST",function(e,t,r){return w((Z(e)-t)/r)},3,3,[ie,re,ie]),O("LOGNORM.DIST",function(e,t,r,n){if(n)return w((Z(e)-t)/r);var o=(Z(e)-t)/r;return.3989422804014327*z(-o*o/2)/r/e},4,4,[ie,re,ie,H]),O("LOGINV",ar,3,3,je),O("LOGNORM.INV",ar,3,3,je),O("NORMDIST",sr,4,4,He),O("NORM.DIST",sr,4,4,He),O("NORMINV",lr,3,3,je),O("NORM.INV",lr,3,3,je),O("NORMSDIST",w,1,1,re,V,V),O("NORMSINV",ur,1,1,le),O("NORM.S.INV",ur,1,1,le),O("NORM.S.DIST",function(e,t){return t?(r=J(.7071067811865475*-e),k(r)?y:(n=w(r*q(2)),F(n)?NaN:.5*(2-2*n))):z(-I(e,2)/2)/q(2*g);var r,n},2,2,[re,H]),O("PEARSON",function(e,t){var r,n,o,i,a=0,s=0,l=0,u=0,c=0,h=A(e);if(h!==A(t))return Y;for(n=r=0;n<h;n++)o=e[n],i=t[n],_(o)&&_(i)&&(a+=o,s+=i,l+=o*o,u+=i*i,c+=o*i,r++);return r*l-a*a==0||r*u-s*s==0?D:(r*c-a*s)/q((r*l-a*a)*(r*u-s*s))},2,2,Ge,-1,-1),O("RSQ",function(e,t){var r,n,o,i,a,s=0,l=0,u=0,c=0,h=0,f=0,d=A(t);if(d!==A(e))return Y;for(r=0;r<d;r++)n=t[r],o=e[r],_(n)&&_(o)&&(s+=n,l+=o,u+=n*n,c+=o*o,h+=n*o,f++);return 0===(i=q((f*u-s*s)*(f*c-l*l)))?D:N((a=(f*h-s*l)/i)*a)},2,2,Ge,[0,1],[0,1]),O("POISSON",cr,3,3,Ue),O("POISSON.DIST",cr,3,3,Ue),O("PROB",function(e,t,r,n){var o,i,a,s,l,u,c=r;if(n!==V&&(c=J(n),k(c)))return y;if(i=o=0,(a=A(e))!==A(t))return Y;for(s=0;s<a;s++)if(l=e[s],u=t[s],l!==L&&u!==L){if(u<=0||1<u)return K;r<=l&&l<=c&&(o+=u),i+=u}return 1!==i?K:o},3,4,[Ce,de,re],[0,1],[0,1],{bk:3}),O("SKEW",function(){var e,t,r,n,o,i,a=arguments,s=0,l=0,u=0,c=0,h=[];for(r=0;r<A(a);r++)for(i=a[r],h.push(i),n=0;n<A(i);n++)(o=i[n])!==L&&(s+=o,l+=o*o,c++);if(c<=2)return D;if(e=s/c,0===(t=q((c*l-s*s)/(c*(c-1)))))return D;for(r=0;r<A(h);r++)for(i=h[r],n=0;n<A(i);n++)(o=i[n])!==L&&(u+=I((o-e)/t,3));return N(c*u/((c-1)*(c-2)))},1,V,pe,-1,-1),O("STANDARDIZE",function(e,t,r){return(e-t)/r},3,3,[re,re,ie]),O("TDIST",hr,3,3,[ue,$,Q]),O("T.DIST",function(e,t,r){return St(e,t,r?4:3)},3,3,[ue,$,H]),O("T.DIST.RT",function(e,t){return hr(e,t,1)},2,2,We),O("T.DIST.2T",function(e,t){return hr(e,t,2)},2,2,We),O("TINV",fr,2,2,De),O("T.INV.2T",fr,2,2,De),O("T.INV",function(e,t){return e<.5?-xt(1-e,t,4):xt(e,t,4)},2,2,[{Hi:0,aj:["<= 0","> 1"]},te]),O("TTEST",dr,4,4,Ve,[0,1],[0,1]),O("T.TEST",dr,4,4,Ve,[0,1],[0,1]),O("WEIBULL",pr,4,4,ze),O("WEIBULL.DIST",pr,4,4,ze),O("ZTEST",gr,2,3,qe,0,0,{bk:2}),O("Z.TEST",gr,2,3,qe,0,0,{bk:2}),O("PERMUT",function(e,t){e=J(x(e)),t=J(x(t));var r,n=1;if(e<0||t<0||e<t)return K;for(r=e-t+1;r<=e;r++)n*=r;return N(n)},2,2),O("COVARIANCE.S",function(e,t){return Mt(!1,e,t)},2,2,Ne,-1,-1),O("MODE.MULT",function(){var e,t,r,n=0,o=[],i=function(e){var t,r=[];for(t=0;t<A(e);t++)ft(e[t],r);return r}(arguments),a=A(i);for(e=0;e<a;e++){for(t=0,r=e+1;r<a;r++)i[e]===i[r]&&t++;n<t?(n=t,(o=[]).push([i[e]])):t===n&&o.push([i[e]])}return 0===n?Y:new U.CalcArray(o)},1,V,ge,-1,-1),O("PERCENTILE.EXC",function(e,t){return h([e,t],18)},2,2,[fe,oe],0,0),O("QUARTILE.EXC",function(e,t){return h([e,t],19)},2,2,[we,Q],0,0),O("RANK.AVG",function(e,t,r){return 1<e.rowCount||1<e.colCount?y:At(!1,t,e[0],r)},2,3,[Ce,ye,ae],[0,1],1,{bk:2}),O("PERMUTATIONA",function(e,t){var r,n=t;return 0<=e&&e<2147483647&&0<=n&&n<2147483647&&(e=Math.pow(s(e),s(n)),(r=Math.abs(e))<=179769e303)?22250738585072014e-324<=r?e:0:K},2,2,[re,re]),O("PHI",function(e){var t,r;return""===e?y:!0===B(e,t={value:0})?(e=.3989422804014327*Math.exp(-t.value*t.value*.5),(r=Math.abs(e))<=179769e303?22250738585072014e-324<=r?e:0:K):y},1,1),O("BINOM.DIST.RANGE",function(e,t,r,n){var o,i,a,s,l,u,c,h,f=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8.841761993739702e30,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,1.0333147966386145e40,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,1.3868311854568984e80,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8.247650592082472e90,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,1.1978571669969892e100,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5.797126020747368e120,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,2.4227095383672734e130,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1.352001527678403e140,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142,942594775983836e145,9614466715035127e146,990290071648618e149,10299016745145628e150,1081396758240291e153,1.1462805637347084e170,1226520203196138e157,1324641819451829e159,14438595832024937e160,1588245541522743e163,1.7629525510902446e180,1974506857221074e167,22311927486598138e168,25435597334721877e170,2925093693493016e173,3.393108684451898e190,3969937160808721e177,4684525849754291e179,5574585761207606e181,6689502913449127e183,8.094298525273444e200,9875044200833601e187,1214630436702533e190,1506141741511141e192,1882677176888926e194,2372173242880047e196,30126600184576594e197,3856204823625804e200,4974504222477287e202,6466855489220474e204,847158069087882e207,11182486511960043e208,14872707060906857e210,19929427461615188e212,2.6904727073180504e230,3659042881952549e217,5012888748274992e219,6917786472619489e221,9615723196941089e223,13462012475717526e225,1898143759076171e228,2695364137888163e230,3854370717180073e232,55502938327393044e233,8047926057471992e236,11749972043909107e238,1727245890454639e241,25563239178728654e242,3.80892263763057e260,5713383956445855e247,862720977423324e250,13113358856834524e251,20063439050956823e253,30897696138473508e255,4789142901463394e258,7471062926282894e260,11729568794264145e262,1.853271869493735e280,29467022724950384e266,47147236359920616e268,7590705053947219e271,12296942187394494e273,20044015765453026e275,3287218585534296e278,5423910666131589e280,9003691705778438e282,1.503616514864999e300,25260757449731984e286,4269068009004705e289,7257415615307999e291];function d(e){return e<171?e<0?NaN:f[e]:1/0}if(e=j(e,o={value:0}),t=B(t,i={value:0}),r=j(r,a={value:0}),4===arguments.length&&n?n=j(n,s={value:0}):(n=r,s=a),!0!==e||!0!==t||!0!==r||!0!==n)return y;if(e=o.value,t=i.value,r=a.value,n=s.value,0<=e&&e<=2147483646&&0<=t&&t<=1&&0<=r&&r<=e&&r<=n&&n<=e){if(100<(l=e*t*(1-t)))return Xe((n-(t*=e)+.5)/(l=Math.sqrt(l)))-Xe((r-1-t+.5)/l);if(0==(u=function(e,t){var r,n,o,i;if(e<=t)return e===t&&0<=t?1:y;if(e<2*t&&(t=e-t),t<2)return 0<=t?0!==t?e:1:y;if(e<171)return d(e)/(d(t)*d(e-t));if(514<t)return y;if(8192<e){for(r=e,n=2;n<=t;n++)r*=--e/n;return r}for(o=e,e--,i=2;;)switch(t-i){case-1:return o;case 0:return e/i*o;case 1:return e*(e-1)/(i*(i+1))*o;case 2:return e*(e-1)*(e-2)/(i*(i+1)*(i+2))*o;default:o*=e*(e-1)*(e-2)*(e-3)/(i*(i+1)*(i+2)*(i+3)),i+=4,e-=4}}(e,r)*Math.pow(t,r)*Math.pow(1-t,e-r)))return 0;for(l=c=u,t/=1-t,h=r;h<n;h++)c+=l*=(e-h)/(h+1)*t;return c<=1?c:1}return K},3,4,[{_i:0},{_i:0},{_i:0}]),O("GAMMA",function(e){var t,r,n;if(0<e)e=Math.exp(ot(e));else{if(0===(r=e+(t=Math.abs(s(e)))))return K;e=Math.pow(-1,t-1)*Math.exp(ot(-r))*Math.exp(ot(1+r))/Math.exp(ot(t+1-r))}return(n=Math.abs(e))<=179769e303?22250738585072014e-324<=n?e:0:K},1,1,ie),O("GAUSS",function(e){e=Xe(e)-.5;var t=Math.abs(e);return t<=179769e303?22250738585072014e-324<=t?e:0:K},1,1,re),O("SKEW.P",function(){var e,t,r,n,o,i,a,s,l,u,c=arguments,h=0,f=0,d=[];for(r=0;r<A(c);r++){if(i=c[r],1===A(c)&&0===A(i))return m;for(n=0;n<A(i);n++)a={value:0},(o=i[n])!==L&&"boolean"!=typeof o&&B(o,a)&&(h+=a.value,f++,d.push(a.value))}if(f<=2)return D;for(e=h/f,r=u=l=s=0;r<d.length;r++)u=d[r]-e,l+=I(u,2),s+=I(u,3);return 0===(t=q(l/f))?D:N(s/f/t/t/t)},1,V,ve,-1,-1)},CalcEngine:function(e,t){e.exports=r("@grapecity/js-calc")},Common:function(e,t){e.exports=r("@grapecity/js-sheets-common")}},a.c=o,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){var r,n;if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(r=Object.create(null),a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(n in t)a.d(r,n,function(e){return t[e]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/assets/",a(a.s="./src/advancedFunctions.entry.ts")),e.exports=i.Spread.CalcEngine.AdvancedFunctions},"./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js":function(e,t,r){e.exports=r("./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js")},"./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js":function(e,t,r){var n,o,i="object"==typeof i?i:{};function a(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}i.Spread=i.Spread||{},i.Spread.CalcEngine=i.Spread.CalcEngine||{},i.Spread.CalcEngine.BasicFunctions=(o={},a.m=n={"./src/basicFunctions.entry.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("CalcEngine");t.Functions=n.Functions,r("./src/functions-basic.ts")},"./src/functions-basic.ts":function(e,t,r){"use strict";var f,C,a,d,n,p,g,i,T,o,s,A,l,k,m,b,h,u,c,y,w,v,S,x,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,Ee,Re,De,Ne,Fe;function _e(e,t){for(;0!==t;){var r=e%t;e=t,t=r}return e}function Pe(e,t,r,n){return 0===t||0===e?0:0!==r&&e<0?!0===n?ue(e/Math.abs(t))*Math.abs(t):le(e/Math.abs(t))*Math.abs(t):!0===n?le(e/Math.abs(t))*Math.abs(t):ue(e/Math.abs(t))*Math.abs(t)}function Le(e,t){var r,n,o,i,a,s,l=e[0],u=T(l),c=l.rowCount,h=l.colCount,f=[],d=[],p=[];for(i=1;i<T(e);i+=2){if((s=Z(e[i],0,!0,!1,!1)).rowCount!==c||s.colCount!==h)return N;a=se.xk(e[i+1]),f.push(s),d.push(a)}for(o=0;o<u;o++){for(n=!0,i=0;i<T(f)&&(a=d[i],r=f[i][o],n=a&&a(r));i++);n&&((r=l[o])!==B&&p.push(r))}return t(p)}function Oe(e,t){return t=t<0?v(t):Math.ceil(t),(e&&t%2==0||!e&&t%2!=0)&&(t+=t<0?-1:1),t}function Be(e,t,r){return 0<t&&r<0?O:t<0&&0<r?(r=-r,e?ue(t/r)*r:le(t/r)*r):e?le(t/r)*r:ue(t/r)*r}function je(e,t,r){var n,o,i,a=se.yk(u(r));return n=le(t=r<0?t/a:t*a),o=ue(t),e&&(i=n,n=o,o=i),t=t<0?n:o,Y(t=r<0?t*a:t/a)}function He(e,t,r,n){var o,i,a,s=t?-1:1,l=0;if(T(r)!==T(n))return L;for(a=0;a<T(r);a++)o=r[a],i=n[a],o!==B&&i!==B&&(l+=e?(o-i)*(o-i):o*o+s*i*i);return Y(l)}function Ge(e,t,r){var n=N;return 0<=s(e,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])?n=oe(r,t,e):0<=s(e,[7,107,8,108,10,110,11,111])&&(n=ae(r,t,e)),n}function Ue(e,t){return se.Ak(e,t)}function We(e,t){return je(!1,e,t)}function Ve(e,t){return le(e/u(t))*u(t)}function ze(e){return Y(Math.sin(e))}function qe(e){return Y(Math.cos(e))}function Ze(e){return Y(se.Dk(e,!0))}function Ye(e){return Y(se.Dk(e,!1))}function Ke(e){var t=S(e),r=S(-e);return Y(t-r)/(t+r)}function Xe(e){return Y(x((1+e)/(1-e))/2)}function Je(e,t){var r,n,o,i,a=!0;for(r=0;r<T(t);r++)for(o=t[r],n=0;n<T(o);n++){if(C.ExcelCompatibleCalcMode){if("string"==typeof o[n]||A(o[n]))continue;a=!1}if(i={value:l},o[n]=he(o[n],i)?i.value:B,e){if(!o[n])return!1}else if(o[n]&&o[n]!==B)return!0}return C.ExcelCompatibleCalcMode&&a?N:!!e}function Qe(e){var t,r=e.getFullYear(),n=e.getMonth(),o=e.getDate();for(t=0;t<n;t++)o+=re(r,t);return o}function $e(e){if(J(e)){if(7!==T(e)||m(h(e)))return N}else if(!m(e)){if(v(e)<1||17<v(e))return O;e=""+e}var t,r=["1","2","3","4","5","6","7"],n=[0,0,0,0,0,0,0];switch(T(e)){case 1:if(0<=s(e,r)){n[((t=h(e))+4)%7]=1,n[(t+5)%7]=1;break}return O;case 2:if("1"===e[0]&&0<=s(e[1],r)){n[((t=h(e[1]))+5)%7]=1;break}return O;case 7:for(t=0;t<7;t++)n[t]=h(e[t]);break;default:return N}return n}function et(e,t,r,n,o){var i,a=ot(t,3);if(j(a))return a;for(i=W(a);r<0;++r)t.setDate(t.getDate()-1),i=0===i?6:--i,(e&&(5===i||6===i)||!e&&o[i]||0<=n.indexOf(p(t)))&&r--;for(;0<r;--r)t.setDate(t.getDate()+1),i=6===i?0:++i,(e&&(5===i||6===i)||!e&&o[i]||0<=n.indexOf(p(t)))&&r++;return p(t)}function tt(e,t,r,n,o,i){var a,s,l,u=W(p(t)),c=W(p(r)),h=!1;return c<u&&(a=t,t=r,r=a,s=u,u=c,c=s,h=!0),l=i(t,r,l=c-u+1,n),e&&j(l)?l:l<=0?0:(l=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p;if(i&&(s=$e(e=e!==k?e:"0000011"),j(s)))return s;if(t!==k&&(a=Z(t,4,!0,!0,!1)),!a)return o;if(a.isError)return a[0];for(l=T(a),u=[],c=0;c<l;c++)h=a[c],d=(f=g(h)).getDay(),p=T(s)?s[ot(f,3)]:6===d||0===d,-1===u.indexOf(h)&&!p&&r<=h&&h<=n&&u.push(h);return o-T(u)}(n,o,u,c,l,e),l=h?-l:l)}function rt(e,t,r){var n,o;return t=C.Convert.Wh(t),(n=new Date(t.getFullYear(),t.getMonth(),1)).setMonth(n.getMonth()+r),o=re(n.getFullYear(),n.getMonth()),n.setDate(e?o:w(t.getDate(),o)),n}function nt(e){var t;return J(e)&&(t=i(e)),t?(60*(60*t.getHours()+t.getMinutes())+t.getSeconds())/86400:N}function ot(e,t){var r=e.getDay();switch(t){case 1:return r+1;case 2:return 0===r?7:r;case 3:return 0===r?6:r-1;default:return O}}function it(e,t,r,n){var o,i,a,s,l,u,c;if(o=$e(n=n!==k?n:"0000011"),a=i=0,j(o))return o;for(s=0;s<T(o);s++)1===o[s]&&i++;if(r<30){for(s=0;s<r;s++)o[(W(ot(e,3))+s)%7]&&a++;return r-a}for(l=r,s=c=u=0;s<l&&W(ot(e,3)+s)%7!=0;s++)u++;for(s=0;s<u;s++)o[(W(ot(e,3))+s)%7]&&a++;for(s=0;s<l&&(W(ot(t,3))+7-s)%7!=6;s++)c++;for(s=0;s<c;s++)o[(W(ot(t,3))+7-s)%7]&&a++;return(r-=W((l=l-u-c)/7)*i)-a}function at(e){var t,r,n,o=""+e,i="",a=[];if(e<0&&(o=o.substr(1),i="-"),r=o.split("."),(n=T(r))<1||2<n)return N;for(2===n&&(a.push(r[1]),a.push(".")),o=r[0],t=T(o)-3;0<=t;t-=3)a.push(o.substr(t,3)),0<t&&a.push(",");return a.push(o.substring(0,t+3)),a.reverse(),i+a.join("")}function st(e,t){var r,n,o,i,a=[],s=T(e);for(r=0;r<s;r++){if(o=e[r],0===(i=T(o))&&"concat"===t)return R;for(n=0;n<i;n++)A(o[n])||a.push(z(o[n]))}return a.join("")}function lt(e,t,r){var n,o=[],i=0;for(n=0;n<t.length;n++)if("fourByte"===$(t[n])){if(0===i){i++;continue}i=0,o.push(t[n-1]+t[n])}else o.push(t[n]);return r>=o.length?t:o.splice(e?0:o.length-r,r).join("")}function ut(e,t,r,n){var o,i,a=T(e);return t=w(t,a+1),r=w(r||0,a-t+1),o=e.substring(0,t-1),i=e.substr(t-1+r),o.concat(n).concat(i)}function ct(e,t,r){var n,o=T(t);if(0===o)return R;for(n=0;n<o;n++)A(t[n])||""===t[n]?r||e.push(""):e.push(z(t[n]))}function ht(e,t,r){var n,o,i,a,s,l,u,c;if(dt()||C.usedbcs){for(n=[],o=void 0,a=void(i=0),a=s=0;a<t.length;a++)if(o=t[a],"fourByte"===(l=$(t[a]))){if(i%2==0){i++;continue}i++,o=t[a-1]+t[a],n[n.length]=o}else"doubleByte"===l&&(s++,o=t[a]),n[a-(0<i?i/2:0)+s]=o;return e||(n=te(n)),(u=n.length)<=r?t:(c=void 0,e?0<(c=n.slice(0,r-1<0?0:r)).length&&A(c[c.length-1])&&(c[c.length-1]=""):0<(c=n.slice(u-r)).length&&A(c[0])&&(c[0]=""),c.join(""))}return lt(e,t,r)}function ft(e,t,r){t--;var n=T(e);return n<=t?"":n<t+r?e.substr(t):e.substr(t,r)}function dt(){return f.Common.CultureManager.q4().isJCKCulture}function pt(e,t,r){if(r<1||T(t)<r)return N;var n=t.indexOf(e,r-1);return-1===n?N:n+1}function gt(e,t,r){var n,o,i=-1;return-1===(i=(n=a.ub(e))?(o=a.sb(n).exec(t),A(o)?-1:o.index):t.toLowerCase().indexOf(e.toLowerCase(),--r))?N:i+1}function mt(e){for(var t=0;t<e.length;t++)A(e[t])&&e[t-1]&&2!==e[t-1].length&&(e[t]="");return e.join("")}function bt(e,t){return t}function yt(e,t){return j(e)?L:G(e)?Z(e,t,!0,!0,!1):Z(e,t,!0,!0,!0)}Object.defineProperty(t,"__esModule",{value:!0}),f=r("Common"),C=r("CalcEngine"),a=f.Common.q,d=f.Common.u,n=f.Common.l,p=n.Ra,g=n.Xb,i=n.Qa,T=f.Common.k.ac,o=f.Common.j,s=o.Ea,A=o.Fa,l=null,k=void 0,m=isNaN,b=parseFloat,h=parseInt,Math.round,u=Math.abs,c=Math.sqrt,y=Math.max,w=Math.min,v=Math.floor,S=Math.exp,x=Math.log,M=Math.PI,I=Math.random,E=Math.pow,R=C.Errors.Null,D=C.Errors.DivideByZero,N=C.Errors.Value,F=C.Errors.Reference,_=C.Errors.Name,P=C.Errors.Calc,L=C.Errors.NotAvailable,O=C.Errors.Number,B=C.Convert.CalcConvertedError,j=C.Convert.vf,H=C.Convert._isReference,G=C.Convert.Ca,U=C.Convert.Uh,W=C.Convert.Rh,V=C.Convert.Pa,z=C.Convert.bc,q=C.Convert.Na,Z=C.Convert.Ph,Y=C.Convert.Nh,K=C.Zh.tryExtractToSingleValue,X=C.Functions.ik,J=C.Functions.jk,Q=C.Functions.kk,$=C.Functions.UAb,ee=C.Functions.VAb,te=C.Functions.WAb,re=C.Functions.nk,ne=C.Functions.tk,oe=C.Functions.Hfc,ie=C.Functions.mja,ae=C.Functions.sk,se=C.Functions.MathHelper,le=se.zk,ue=se.wk,ce=C.Functions.ak,he=C.Convert.Th,fe=C.Convert.Uh,de=C.Convert.jja,ge={Hi:0,aj:"= 0",bj:D},me={Hi:0,aj:"= 0",bj:0},be={_i:1,Hi:0,aj:"= 0",bj:0},ye={Hi:2,aj:"< 0"},Ce={Hi:0,aj:["> 134217728","< -134217728"]},we={Hi:1},ve={Hi:2},Se={_i:1,Hi:2},xe={_i:1,Hi:2,aj:"< 0",bj:N},Te={Hi:5},Ae={Hi:6},ke={Hi:2,aj:"< 0",bj:N},Me={_i:[],Hi:4,Ii:4,Ji:!0,Ki:!0,Li:!0},Ie={Hi:4,Ii:1,Ji:!0,Ki:!0},Ee={Hi:4,Ii:1,Ki:!0,Li:!0},Re={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},De={Hi:4,Ii:3,Ji:!0,Ki:!0,Xi:!0},Ne={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},ce("ABS",function(e){return Y(u(e))},1,1,pe={Hi:0}),ce("ACOS",function(e){return Y(Math.acos(e))},1,1,{Hi:0,aj:["> 1","< -1"]}),ce("ACOT",function(e){return Y(e<0?Math.PI+Math.atan(1/e):Math.atan(1/e))},1,1,pe),ce("ASIN",function(e){return Y(Math.asin(e))},1,1,{Hi:0,aj:["> 1","< -1"]}),ce("ATAN",function(e){return Y(Math.atan(e))},1,1,pe),ce("ATAN2",function(e,t){return 0===e&&0===t?D:Y(Math.atan2(t,e))},2,2,[pe,pe]),ce("COS",qe,1,1,pe),ce("SEC",function(e){var t=qe(e);return 0===t?D:1/t},1,1,Ce),ce("CEILING",function(e,t){return Be(!0,e,t)},2,2,[me,me]),ce("ODD",function(e){return Oe(!0,e)},1,1,we),ce("EVEN",function(e){return Oe(!1,e)},1,1,we),ce("FLOOR",function(e,t){return Be(!1,e,t)},2,2,[me,me]),ce("LN",function(e){return Y(x(e))},1,1,{Hi:1,aj:"<= 0"}),ce("SQRT",function(e){return c(e)},1,1,{Hi:0,aj:"< 0"}),ce("SIN",ze,1,1,pe),ce("CSC",function(e){var t=ze(e);return 0===t?D:1/t},1,1,Ce),ce("TAN",function(e){return Y(Math.tan(e))},1,1,pe),ce("COT",function(e){return 0===e?D:Y(1/Math.tan(e))},1,1,Ce),ce("SIGN",function(e){return 0===e?0:-1},1,1,{Hi:1,aj:"> 0",bj:1}),ce("GCD",function(){var e,t,r,n,o=arguments,i=0;for(e=0;e<T(o);e++)for(r=o[e],t=0;t<T(r);t++)if((n=r[t])!==B){if(n<0)return O;i=_e(i,W(n))}return i},1,k,Re,-1,-1),ce("LCM",function(){var e,t,r,n,o=arguments,i=1,a=[];for(e=0;e<T(o);e++){for(r=o[e],t=0;t<T(r);t++)if((n=r[t])!==B){if(n<0)return O;if(0===n)return 0;a.push(W(n))}for(t=0;t<T(a);t++)i/=_e(i,n=a[t]),i*=n}return i},1,k,Re,-1,-1),ce("PRODUCT",function(){return oe(arguments,2,6)},1,k,k,-1,-1),ce("POWER",function(e,t){if(0===e&&t<0)return D;if(0===e&&0===t)return O;var r=C.Functions.MathHelper.YDc(e,t);return r===Number.POSITIVE_INFINITY||r===Number.NEGATIVE_INFINITY||isNaN(r)?O:r},2,2,[pe,pe]),ce("MOD",function(e,t){return e-t*v(e/t)},2,2,[pe,{Hi:0,aj:"= 0",bj:D}]),ce("QUOTIENT",function(e,t){return h(""+e/t)},2,2,[pe,ge],k,k),ce("SUBTOTAL",function(e){var t,r=arguments,n=[];for(t=1;t<T(r);t++)n[t-1]=r[t];return Ge(e,0,n)},2,k,ve,"!= 0"),ce("_SUBTOTALFORSTATUSBAR",function(e){var t,r=arguments,n=[];for(t=1;t<T(r);t++)n[t-1]=r[t];return Ge(e,1,n)},2,k,ve,"!= 0"),ce("INT",function(e,t){var r,n,o,i;if(H(t))if(r=t.getRow(0),n=t.getColumn(0),o=t.getRowCount(0),i=t.getColumnCount(0),1===o&&1===i)t=t.getValue(0,0,0);else if(1!==o&&1===i&&r<=e.row&&e.row<r+o)t=t.getValue(0,e.row-r,0);else{if(!(1===o&&1!==i&&n<=e.column&&e.column<n+i))return N;t=t.getValue(0,0,e.column-n)}return t=V(t),isNaN(t)?N:ue(t)},1,1,k,[0],k,{dk:!0}),ce("MROUND",function(e,t){return e<0&&0<t||t<0&&0<e?O:ue(e/t+.5)*t},2,2,[me,me]),ce("ROUND",Ue,2,2,[pe,ve]),ce("ROUNDDOWN",We,2,2,[pe,ve]),ce("ROUNDUP",function(e,t){return je(!0,e,t)},2,2,[pe,ve]),ce("TRUNC",We,1,2,[pe,{_i:0,Hi:2}],k,k,{bk:1}),ce("EXP",function(e){return Y(S(e))},1,1,pe),ce("LOG",function(e,t){return 1===t?D:Y(se.Ek(e,t))},1,2,[{Hi:0,aj:"<= 0"},{_i:10,Hi:0,aj:"<= 0"}],k,k,{bk:1}),ce("LOG10",function(e){return Y(se.Ek(e,10))},1,1,{Hi:0,aj:"<= 0"}),ce("SUM",function(){var e,t,r,n,o,i;if(!C.ExcelCompatibleCalcMode)return function(){var e,t,r,n,o=arguments,i=0;for(e=0;e<T(o);e++){if(n=r=void 0,j(t=o[e]))return t;if(H(t)||G(t)){if((r=Z(t,1,!0,!0,!1)).isError)return r[0]}else r=Z(t,1,!0,!0,!0);for(n=0;n<T(r);n++)r[n]!==B&&(i+=r[n])}return i}.apply(null,arguments);for(e=arguments,r=t=0;r<T(e);r++){if(i=o=void 0,j(n=e[r]))return n;if(H(n)||G(n)){if((o=Z(n,5,!0,!0,!1,!0)).isError)return o[0]}else o=Z(n,1,!0,!0,!1,!0);for(i=0;i<T(o);i++)o[i]!==B&&(t+=o[i])}return t},1,k,k,-1,-1),ce("SUMIF",function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x;if(n=n!==k?n:t,A(r)&&(r=0),o=0,i=se.xk(r),a=G(t),s=G(n),(a?1:t.getRangeCount())!==(s?1:n.getRangeCount()))return N;if((l=n)===t||s||(u=a?t.getRowCount():t.getRowCount(0),c=a?t.getColumnCount():t.getColumnCount(0),u===n.getRowCount(0)&&c===n.getColumnCount(0)||(h=n.getRow(0),f=n.getColumn(0),l=n.create([{row:h,col:f,rowCount:u,colCount:c}]),d=e.row,p=e.column,g=e.source.getCalcSourceModel().qg(d,p),m=n.getSource(),g&&m.getRangeKey&&(b={id:m.id,row:h,col:f,rowCount:u,colCount:c},y=m.getRangeKey(m,b),g.eOb||(g.eOb={}),g.eOb[y]=b))),C=t.toArray(0,!1,!1),w=l.toArray(1,!1,!1),C.isError)return C[0];if(w.isError)return w[0];for(v=0;v<T(C);v++)for(S=0;S<T(C[v]);S++)x=w[v]&&w[v][S],i&&i(C[v][S])&&x!==B&&x&&(o+=x);return Y(o)},2,3,k,[0,2],[0,2],{bk:2,dk:!0}),ce("SUMIFS",function(){return Le(arguments,function(e){var t,r,n=0;for(t=0;t<e.length;t++){if(r=e[t],j(r))return r;n+=r}return n})},3,k,{Hi:4,Ii:1,Ji:!0},[0,"%= 1"],[0,"%= 1"]),ce("SUMPRODUCT",function(){var e,t,r,n,o,i,a,s=arguments,l=0,u=[],c=0;for(e=0;e<T(s);e++){if((n=Z(s[e],1,!0,!0,!1,!0)).isError)return n[0];if(n.isConvertError)return N;if(0===e)t=n.rowCount,r=n.colCount,c=T(n);else if(n.rowCount!==t||n.colCount!==r)return N;u.push(n)}for(e=0;e<c;e++){for(o=1,i=0;i<T(s);i++){if((a=u[i][e])===B){if(1===c)return N;o=0;break}o*=a}l+=o}return Y(l)},1,k,k,-1,-1,{fk:1}),ce("SUMSQ",function(){var e,t,r,n,o=arguments,i=0;for(t=0;t<T(o);t++)for(n=o[t],r=0;r<T(n);r++)(e=n[r])!==B&&(i+=e*e);return Y(i)},1,k,Re,-1,-1),ce("SUMX2MY2",function(e,t){return He(!1,!0,e,t)},2,2,Re,-1,-1),ce("SUMX2PY2",function(e,t){return He(!1,!1,e,t)},2,2,Re,-1,-1),ce("SUMXMY2",function(e,t){return He(!0,!1,e,t)},2,2,Re,-1,-1),ce("SERIESSUM",function(e,t,r,n){var o,i,a=0;for(o=0;o<T(n);o++){if(i=V(n[o]),m(i))return N;a+=i*E(e,t+o*r)}return Y(a)},4,4,[pe,ve,ve,{Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0}],3,3),ce("PI",function(){return M},0,0),ce("SQRTPI",function(e){return Y(c(e*M))},1,1,{Hi:0,aj:"< 0"}),ce("DEGREES",function(e){return 180*e/M},1,1,we),ce("RADIANS",function(e){return M*e/180},1,1,pe),ce("COSH",Ye,1,1,pe),ce("SECH",function(e){if(709<e||e<-709)return 0;var t=Ye(e);return 0===t?D:1/t},1,1,pe),ce("ACOSH",function(e){return Y(x(e+c(e*e-1)))},1,1,{Hi:0,aj:"< 1"}),ce("SINH",Ze,1,1,pe),ce("CSCH",function(e){if(709<e||e<-709)return 0;var t=Ze(e);return 0===t?D:1/t},1,1,pe),ce("ASINH",function(e){return Y(x(e+c(e*e+1)))},1,1,pe),ce("TANH",Ke,1,1,pe),ce("COTH",function(e){return 0===e?D:10<e?1:e<-10?-1:1/Ke(e)},1,1,{Hi:0}),ce("ATANH",Xe,1,1,{Hi:0,aj:["<= -1",">= 1"]}),ce("ACOTH",function(e){return Xe(1/e)},1,1,{Hi:0}),ce("MDETERM",function(e){var t,r,n,o,i,a,s,l,u=e.rowCount,c=1;if(1<e.rangeCount||u!==e.colCount)return N;for(t=0;t<u-1;t++){if(0===e[t][t]){for(a=!1,r=t+1;!a&&r<u;r++)if(0!==e[r][t]){for(o=t;o<u;o++)s=e[t][o],e[t][o]=e[r][o],e[r][o]=s;c*=-1,a=!0}if(!a)return 0}for(n=t+1;n<u;n++)if(0!==e[n][t])for(l=e[n][t]/e[t][t],i=t;i<u;i++)e[n][i]-=l*e[t][i]}for(t=0;t<u;t++)c*=e[t][t];return c},1,1,Ee,-1,-1),ce("MINVERSE",function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b=e.rowCount,y=[];if(1<e.rangeCount||b!==e.colCount)return N;for(t=0;t<b;t++)for(y[t]=[b],o=0;o<b;o++)y[t][o]=t===o?1:0;for(r=0;r<b;r++){if(0===e[r][r]){for(m=!1,i=r+1;!m&&i<b;i++)if(0!==e[i][r]){for(s=r;s<b;s++)p=e[r][s],e[r][s]=e[i][s],e[i][s]=p;for(l=1;l<b;l++)g=y[r][l],y[r][l]=y[i][l],y[i][l]=g;m=!0}if(!m)return O}for(a=0;a<b;a++)if(a!==r&&0!==e[a][r]){for(f=e[a][r]/e[r][r],u=r;u<b;u++)e[a][u]-=f*e[r][u];for(c=0;c<b;c++)y[a][c]-=f*y[r][c]}}for(n=0;n<b;n++)for(d=e[n][n],h=0;h<b;h++)y[n][h]/=d;return new C.CalcArray(y)},1,1,Ee,-1,-1),ce("MMULT",function(e,t){var r,n,o,i,a,s,l=e.rowCount,u=e.colCount,c=t.rowCount,h=t.colCount,f=[];if(u!==c)return N;for(o=0;o<l;o++)for(f[o]=r=[],n=e[o],i=0;i<h;i++){for(a=s=0;a<c;a++)s+=n[a]*t[a][i];r[i]=s}return new C.CalcArray(f)},2,2,[Ee,Ee],-1,-1),ce("FACT",function(e){return ne(e)},1,1,{Hi:3,aj:["< 0","> 170"]}),ce("FACTDOUBLE",function(e){var t,r=1;for(t=e;1<t;t-=2)r*=t;return r},1,1,{Hi:3,aj:["< 0","> 300"]}),ce("MULTINOMIAL",function(){var e,t,r,n,o=arguments,i=0,a=1;for(t=0;t<T(o);t++)for(e=o[t],r=0;r<T(e);r++){if((n=W(e[r]))<0||170<n)return O;i+=n,a*=ne(n)}return i<0||170<i?O:ne(i)/a},1,k,{Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},-1,-1),ce("RAND",function(){return u(2*I()-1)},0,0,k,k,k,{ck:!0}),ce("RANDBETWEEN",function(e,t){return t<e?O:W(e+I()*(t-e+1))},2,2,[ve,ve],k,k,{ck:!0}),ce("COMBIN",function(e,t){var r,n=1;if(e<t)return O;for(t=w(e-t,t),r=1;r<=t;r++)n*=e-r+1,n/=r;return Y(n)},2,2,[ye,ye]),ce("COMBINA",function(e,t){var r,n=1;for(r=1;r<=t;r++)n*=e+r-1;for(r=2;r<=t;r++)n/=r;return Y(n)},2,2,[ye,ye]),ce("DECIMAL",function(e,t){var r,n,o,i,a,s,l;if(!e||255<e.length)return 0;if(0===(r=e.length))return 0;if("-"===e[0])return O;for(n=0;n<r&&" "===e[n];)n++;if(o=0,n===r)return 0;for(a=r-(i=1);n<=a;a--){if((l=0<=(s=e.charCodeAt(a)|" ".charCodeAt(0))-"a".charCodeAt(0)?s-87:s-48)<0||t<=l)return O;o+=l*i,i*=t}return o},2,2,[{_i:"0",Hi:5},{Hi:0,aj:["> 36","< 2"]}]),ce("CEILING.MATH",function(e,t,r){return Pe(e,t,r,!0)},1,3,[pe,{Hi:0,_i:1},{Hi:0,_i:0}]),ce("FLOOR.MATH",function(e,t,r){return Pe(e,t,r,!1)},1,3,[pe,{Hi:0,_i:1},{Hi:0,_i:0}]),ce("BASE",function(e,t,r){var n=""+e.toString(t);return r&&n.length<r?Array.apply(null,{length:r-n.length+1}).join(0)+n:n},2,3,[{Hi:0,aj:["< 0",">= 9007199254740992"]},{Hi:3,aj:["> 36","< 2"]},{Hi:3,_i:0,aj:["< 0",">= 256"]}]),ce("ROMAN",function(e,t){var r,n,o,i,a,s,l,u,c=["M","D","C","L","X","V","I"],h=[1e3,500,100,50,10,5,1],f=[];if(4<(r=X(t)?t?0:4:t)||r<0)return N;for(n=0;n<7;n+=2){if(2<=n&&h[n-2]-h[n]<=e){for(i=(o=n)-2,a=void 0,a=0;a<r&&o+1<7&&h[i]-h[o+1]<=e;a++)o++;f.push(c[o]),f.push(c[i]),e+=h[o],e-=h[i]}if(1<=n&&h[n-1]<=e&&(f.push(c[n-1]),e-=h[n-1]),1<=n&&h[n-1]-h[n]<=e){for(l=(s=n)-1,u=void 0,u=0;u<r&&s+1<7&&h[l]-h[s+1]<=e;u++)s++;f.push(c[s]),f.push(c[l]),e+=h[s],e-=h[l]}for(;h[n]<=e;)f.push(c[n]),e-=h[n]}return f.join("")},1,2,[{Hi:2,aj:["< 0","> 3999"],bj:N},{_i:0}],k,k,{bk:1}),ce("ARABIC",function(e){var t,r,n,o,i,a,s,l,u,c;if(!e.length)return 0;if(255<e.length)return N;for(t=0,r=(e=e.toLowerCase()).length-1,o=0,s=-1;0<=r&&" "===e[r];)r--;for(l=0;l<=r&&" "===e[l];)l++;u=!1,l<=r&&"-"===e[l]&&(u=!0,l++);do{for(c=e[n=r],--r;l<=r&&(e[r].charCodeAt(0)|" ".charCodeAt(0))===c.charCodeAt(0);)--r;switch(c){case"i":i=n-r,a=1;break;case"v":i=5*(n-r),a=5;break;case"x":i=10*(n-r),a=10;break;case"l":i=50*(n-r),a=50;break;case"c":i=100*(n-r),a=100;break;case"d":i=500*(n-r),a=500;break;case"m":i=1e3*(n-r),a=1e3;break;default:return N}s<=a?(t+=i-o,s=a,o=0):o+=i}while(l<=r);return 0!==o&&(t-=o),u&&(t=-t),t},1,1,Te),ce("CEILING.PRECISE",Ve,1,2,[me,be]),ce("ISO.CEILING",Ve,1,2,[me,be]),ce("FLOOR.PRECISE",function(e,t){return ue(e/u(t))*u(t)},1,2,[me,be]),ce("MAXIFS",function(){return Le(arguments,function(e){var t=null;return 0<e.length&&(t=Math.max.apply(null,e)),t})},3,k,Ie,[0,"%= 1"],[0,"%= 1"]),ce("MINIFS",function(){return Le(arguments,function(e){var t=null;return 0<e.length&&(t=Math.min.apply(null,e)),t})},3,k,Ie,[0,"%= 1"],[0,"%= 1"]),ce("MUNIT",function(e){for(var t=[],r=0,n=[];r<e;r++)n[r]=0;for(r=0;r<e;r++)t[r]=n.slice(0),t[r][r]=1;return new C.CalcArray(t)},1,1,{Hi:2,aj:"<= 0",bj:N}),ce("SEQUENCE",function(e,t,r,n){var o,i,a,s,l,u,c;if(void 0===e&&(e=1),void 0===t&&(t=1),void 0===r&&(r=1),void 0===n&&(n=1),0===e||0===t)return P;if(e<0||t<0)return N;if("string"==typeof(o=r)||r instanceof Date){if(i={},!C.Convert.Th(r,i))return N;o=i.value}for(a=[],s=0,l=o;s<e;s++)for(u=[],a.push(u),c=0;c<t;c++)u.push(l),l+=n;return new C.CalcArray(a)},1,4,[ve,ve,pe,pe],k,k,{bk:[0,1,2,3]},!0),ce("RANDARRAY",function(e,t,r,n,o){var i,a,s,l,u,c;if(void 0===e&&(e=1),void 0===t&&(t=1),void 0===r&&(r=0),void 0===n&&(n=1),void 0===o&&(o=!1),0===e||0===t)return P;if(e<0||t<0)return N;if(n<r)return N;if(o&&(r!==v(r)||n!==v(n)))return N;for(i=n-r,o&&i++,a=[],s=0;s<e;s++)for(l=[],a.push(l),u=0;u<t;u++)c=r+I()*i,o&&(c=h(c)),l.push(c);return new C.CalcArray(a)},0,5,[ve,ve,pe,pe],k,k,{ck:!0,bk:[0,1,2,3,4]},!0),ce("AGGREGATE",function(e,t,r){var n,o=arguments,i=[];for(n=3;n<T(o);n++)i[n-3]=o[n];return ie(i,r,t,e)},3,k,k,"> 1","> 1",{fk:1,dk:!0}),ce("AND",function(){return Je(!0,arguments)},1,k,Ne,-1,-1),ce("OR",function(){return Je(!1,arguments)},1,k,Ne,-1,-1),ce("NOT",function(e){var t;return C.ExcelCompatibleCalcMode&&"string"==typeof e?N:(t={},C.Convert.Uh(e,t)?!t.value:N)},1,1),ce("IF",function(e,t,r){var n,o,i=t,a=K(e);return j(e)?e:(n=r!==k?r:2!==T(arguments)&&null,o={},U(a.value,o),o.value?i:n)},2,3,k,[1,2],[1,2],{gk:[1,2],bk:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(e){if(C.Convert.vf(e))return-1;var t={value:!1};return U(e,t),t.value?1:2}}),ce("IFERROR",function(e,t){var r,n,o,i,a,s;if(!j(e)&&H(e)){if(1<e.getRangeCount())return N;if(n=r=0,o=this.y0a)if(r=o.row,n=o.col,(i=e._identities&&e._identities[0])&&1===i.rowCount&&1===i.colCount)n=r=0;else if(i&&(r+1>i.rowCount||n+1>i.colCount))return t;e=e.getValue(0,r,n)}return s=t,j(a=e)?A(s)?0:s:A(a)?0:a},2,2,k,0,k,{gk:-1}),ce("TRUE",function(){return!0},0,0),ce("FALSE",function(){return!1},0,0),ce("IFNA",function(e,t){return de(e)?t:e},2,2,k,0,k,{gk:-1}),ce("IFS",function(){var e,t,r;for(e=0,t=arguments.length;e<t;e++){if(r={value:!1},j(arguments[e]))return arguments[e];if(!U(arguments[e++],r))return N;if(r.value)return arguments[e]}return L},2,254,k,0,k,{gk:-1}),ce("SWITCH",function(){var e,t,r;if(arguments.length<3)return N;if(j(arguments[0]))return arguments[0];for(t=arguments.length-(e=1);e<t;e++){if(r=arguments[e++],j(r))return r;if("string"==typeof arguments[0]&&"string"==typeof r){if(arguments[0].toUpperCase()===r.toUpperCase())return arguments[e]}else if(arguments[0]===r)return arguments[e]}return arguments.length%2==0?arguments[arguments.length-1]:L},3,253,k,k,k,{gk:-1}),ce("XOR",function(){var e,t,r,n=0;for(e=0;e<T(arguments);e++)for(r=arguments[e],t=0;t<T(r);t++)r[t]&&n++;return!!(n%2)},1,k,De,-1,-1),ce("DATE",function(e,t,r){e<=1899&&(e+=1900);var n=new Date(e,t-1,r);return n<new Date(1899,11,30)?O:n},3,3,[{Hi:2,aj:["< 0","> 9999"]},ve,ve]),ce("TIME",function(e,t,r){var n=g(0);return n.setHours(e),n.setMinutes(t),n.setSeconds(r),n.setMilliseconds(0),n.getHours()<0&&n.getMinutes()<0&&n.getSeconds()<0?O:n},3,3,[ve,ve,ve]),ce("DATEVALUE",function(e){var t,r,n,o;if(J(e)&&((t=i(e))||((t=new Date(e))&&!m(t.valueOf())||(t=null))),!t)return N;if(n=t.getFullYear(),o=Qe(t),n<1900)return N;for(r=1900;r<n;r++)o+=365,Q(r)&&o++;return o},1,1,{Ni:!0}),ce("TIMEVALUE",nt,1,1,{Ni:!0}),ce("NOW",function(){return new Date},0,0,k,k,k,{ck:!0}),ce("TODAY",function(){var e=new Date;return e.setHours(0,0,0,0),e},0,0,k,k,k,{ck:!0}),ce("HOUR",function(e){return e.getHours()},1,1,Ae),ce("MINUTE",function(e){return e.getMinutes()},1,1,Ae),ce("SECOND",function(e){return e.getSeconds()},1,1,Ae),ce("DAY",function(e){return e.getDate()},1,1,Ae),ce("MONTH",function(e){return e.getMonth()+1},1,1,Ae),ce("YEAR",function(e){return e.getFullYear()},1,1,Ae),ce("WEEKNUM",function(e,t){var r,n,o;return 1===t||2===t?(r=Qe(e),n=new Date(e.getFullYear(),0,1).getDay(),2===t&&(--n<0&&(n=6)),(o=r-1-(6-n))<0&&(o=0),1+W(o/7)+(o%7!=0?1:0)):O},1,2,[Ae,Se],k,k,{bk:1}),ce("WEEKDAY",ot,1,2,[Ae,Se],k,k,{bk:1}),ce("EDATE",function(e,t){return rt(!1,e,t)},2,2,[Ae,ve]),ce("EOMONTH",function(e,t){return rt(!0,e,t)},2,2,[Ae,ve]),ce("WORKDAY",function(e,t,r){return et(!0,e,t,r)},2,3,[Ae,ve,Me],2,2,{bk:2}),ce("WORKDAY.INTL",function(e,t,r,n){var o=$e(r);return j(o)?o:"1111111"===o.join("")?N:et(!1,e,t,n,o)},2,4,[Ae,ve,{_i:"0000011"},Me],[2,3],[2,3],{bk:[2,3]}),ce("DAYS360",C.Functions.uk,2,3,[Ae,Ae,{_i:!1,Hi:7}],k,k,{bk:2}),ce("NETWORKDAYS",function(e,t,r){return tt(!1,e,t,k,r,function(e,t,r){var n=W(p(t)-p(e))%7,o=W(ot(e,2)+n),i=0===e.getDay()?1:2;return(r-=n=i<(n=5<o?o-5:0)?i:n)-2*v(r/7)})},2,3,[Ae,Ae],2,2,{bk:2}),ce("NETWORKDAYS.INTL",function(e,t,r,n){return tt(!0,e,t,r,n,it)},2,4,[Ae,Ae],[2,3],[2,3],{bk:[2,3]}),ce("YEARFRAC",C.Functions.vk,2,3,[Ae,Ae,{_i:0,Hi:2}],k,k,{bk:2}),ce("DATEDIF",function(e,t,r){var n,o,i;if(e.setHours(0,0,0,0),t.setHours(0,0,0,0),r=r.toLocaleUpperCase(),(i=[])[0]=function(e,t){return t.getFullYear()-e.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0)},i[1]=function(e,t){return 12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth())+(t.getDate()<e.getDate()?-1:0)},i[2]=function(e,t){return(t.getTime()-e.getTime())/864e5},i[3]=function(e,t){var r=new Date(t.getFullYear(),t.getMonth()+(t.getDate()<e.getDate()?-1:0),e.getDate());return(t.getTime()-r.getTime())/864e5},i[4]=function(e,t){return t.getMonth()-e.getMonth()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?12:0)+(t.getDate()<e.getDate()?-1:0)},i[5]=function(e,t){var r=t.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0),n=e.getMonth(),o=e.getDate(),i=Q(e.getFullYear());return 1!==n||29!==o||Q(r)||o--,!i&&1===n&&28===o&&Q(r)&&o++,(t-new Date(r,n,o))/864e5},n=i,o=s(r,["Y","M","D","MD","YM","YD"]),t<e)return O;if(o<0)throw C.sR().Exp_NotSupported;return(0,n[o])(e,t)},3,3,[Ae,Ae,Te]),ce("DAYS",function(e,t){var r,n={value:0};if(!he(e,n))return N;if(!he(t,r={value:0}))return N;function o(e){return 0<=e&&e<2958466}return o(n.value)&&o(r.value)?n.value-r.value:O},2,2),ce("ISOWEEKNUM",function(e){var t,r,n;if(isNaN(e))return O;function o(e){var t=new Date(e,0,4),r=t.getDay();return 0===r&&(r=7),t.setDate(t.getDate()+1-r),t}return t=new Date(1900,1,28),e.getTime()<=t.getTime()&&e.setDate(e.getDate()-1),1900===(r=e.getFullYear())?r+=400:9999===r&&(r-=400),e.setYear(r),e.getTime()<new Date(r,11,29).getTime()&&r--,n=o(r+1),e.getTime()<n.getTime()&&(n=o(r)),h(""+(e.getTime()-n.getTime())/864e5/7)+1},1,1,Ae),ce("CLEAN",function(e){var t,r,n=[];for(t=0;t<T(e);t++)0<=(r=e.charCodeAt(t))&&r<=31||127===r||128<=r&&r<=159||n.push(e[t]);return n.join("")},1,1,Te),ce("TRIM",function(e){var t,r,n,o,i;for(e=e.trim(),t=[],r=!0,n=0;n<T(e);n++)(i=" "===(o=e.charAt(n))||"\t"===o||"\n"===o)&&!r||t.push(o),r=!i;return t.join("")},1,1,Te),ce("DOLLAR",function(e,t){return e=V(Ue(e,t)),n=at(r=e),o=[],r<0&&(n=n.substr(1)),o.push("$"),o.push(n),r<0&&(o.push(")"),o.unshift("(")),o.join("");var r,n,o},1,2,[pe,{_i:2,Hi:2,aj:"> 99",bj:N}],k,k,{bk:1}),ce("FIXED",function(e,t,r){var n,o,i,a,s=0;if(t<0&&(e/=s=W(E(10,u(t)))),e=V(Ue(e,y(0,t))),t<0&&(e*=s),n=r?""+e:at(e),0<t)if(-1===(o=n.indexOf(".")))for(n+=".",i=0;i<t;i++)n+="0";else for(a=n.length-(o+1);a<t;a++)n+="0";return n},1,3,[pe,{_i:2,Hi:2},{_i:!1,Hi:7}],k,k,{bk:[1,2]}),ce("TEXT",function(e,t){var r;if(""===t)return z(e);A(e)&&(e=0),"string"==typeof e&&(e=e.trim());try{return(r=f.Formatter&&f.Formatter.GeneralFormatter)?new r(t).format(e):""+e}catch(e){return N}},2,2,[{},Te]),ce("VALUE",function(e){if(!e)return 0;var t,r=i(e);return A(r)?function(e){var t,r,n,o,i,a,s,l,u,c,h=f.Common.CultureManager.q4().NumberFormat;if("$"!==e[0]&&e[0]!==h.currencySymbol||(e=e.substring(1)),t=b(e),r=C.isDigit(e[0].charCodeAt(0)),n=45===e[0].charCodeAt(0)&&C.isDigit(e[1].charCodeAt(0)),o=!e||m(t)||!r&&"."!==e[0],i=!e||m(t)||!n&&"-"!==e[0]&&"."!==e[1],o&&i)return N;for(("."===e[0]||"-"===e[0]&&"."===e[1])&&(e="-"===e[0]?e.replace(e[1],"0."):"0"+e),a=e.length,c=u=s=0;s<a;s++){for(l=e[s];s<a&&C.isDigit(l.charCodeAt(0));)l=e[++s];if(s===a){if(u&&s-u<=3)return N;break}if(l===h.numberGroupSeparator){if(c||u&&s-u<=3)return N;u=s}else if(l===h.numberDecimalSeparator){if(c||u&&s-u<=3)return N;c=s}}return e=d.Gb(e,",",""),b(e)}(e):(t=p(r),j(t)?nt(r):t)},1,1,Te),ce("LOWER",function(e){return e.toLowerCase()},1,1,Te),ce("UPPER",function(e){return e.toUpperCase()},1,1,Te),ce("PROPER",function(e){var t,r,n,o=T(e),i=[];if(0<o)for(t=e.toUpperCase(),r=e.toLowerCase(),n=1,i[0]=t[0];n<o;)i[n]=C.ei(e[n-1])?r[n]:t[n],n++;return i.join("")},1,1,Te),ce("CHAR",function(e){return String.fromCharCode(e)},1,1,{Hi:2,aj:["> 255","< 1"],bj:N}),ce("CODE",function(e){return e[0].charCodeAt(0)},1,1,{Hi:5,Ni:!0}),ce("REPLACE",ut,4,4,[Te,{Hi:2,aj:"< 1",bj:N},ke,Te],k,k,{bk:2}),ce("SUBSTITUTE",function(e,t,r,n){var o,i,a,s,l,u,c=T(t);if(3<T(arguments)){if(s=void(a=0),(i=W(n))<1)return N;for(s=0;s<i;s++){if(-1===(a=e.indexOf(t,a)))return e;a+=c}l=e.substring(0,a-c),u=e.substr(a),o=l.concat(r).concat(u)}else o=d.yb(e,t,r);return o},3,4,[Te,{Hi:5,Ni:!0},Te],k,k,{bk:3}),ce("CONCATENATE",function(){return st(arguments,"concatenate")},1,k,{Hi:4,Ii:0,Ji:!0,Xi:!0},k,-1),ce("LEFT",function(e,t){return lt(!0,e,t)},1,2,[Te,xe],k,k,{bk:1}),ce("MID",ft,3,3,[Te,{Hi:2,aj:"<= 0",bj:N},ke]),ce("RIGHT",function(e,t){return lt(!1,e,t)},1,2,[Te,xe],k,k,{bk:1}),ce("REPT",function(e,t){var r,n=[];if(t<0||32767<t*T(e))return N;for(r=0;r<t;r++)n.push(e);return n.join("")},2,2,[Te,ve]),ce("LEN",function(e){return e?e.length:0},1,1,Te),ce("FIND",pt,2,3,[Te,Te,Se],k,k,{bk:2}),ce("SEARCH",gt,2,3,[Te,Te,xe],k,k,{bk:2}),ce("EXACT",function(e,t){return e===t},2,2,[Te,Te]),ce("T",function(e){return J(e)?e:""},1,1),ce("UNICHAR",function(e){if(e){var t=e;return t<=0||1114111<t?N:55296<=t&&t<=57343?L:t<1048576?String.fromCharCode(t):(t-=1048576,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}return N},1,1,[{Hi:2,bj:N}]),ce("UNICODE",function(e){var t,r,n=z(e);return""===n||null===n?N:55296<=(t=n.charCodeAt(0))&&t<=56319?1===n.length?N:56320<=(r=n.charCodeAt(1))&&r<=57343?t|r<<8:1:56320<=t&&t<=57343?t-53248+53248:t},1,1),ce("BAHTTEXT",function(e){var t,r;function n(e){var t,r,n,o,i=["","","","","","",""],a=["","","","","","","","","",""],s=["","","","","","",","," ",""],l="",u=e+"",c=u.length;for(t=c;0<t;--t){if(n=a[r=h(u[c-t])],1==(o=1<t?(t-1)%6:6)&&2===r&&(n=s[4]),1===r)switch(o){case 0:case 6:l+=t<c?s[5]:n;break;case 1:break;default:l+=n}else{if(0===r){0==o&&(l+=i[o]);continue}l+=n}l+=i[o]}return l}return e?(t=Math.abs(h(e)),r=parseFloat((Math.abs(e)-t).toFixed(2)),0!==t?0===r?(e<0?"":"")+n(t)+"":(e<0?"":"")+n(t)+""+n(100*r)+"":0!==r?(e<0?"":"")+n(100*r)+"":""):N},1,1,[{Hi:0,bj:N}]),ce("CONCAT",function(){return st(arguments,"concat")},1,k,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),ce("TEXTJOIN",function(e,t){var r,n,o,i,a,s,l;if(e.isReference&&0===e.length)return R;if(r={value:!1},n=!!A(t[0])||t[0],!fe(n,r))return N;for(n=r.value,i=[],a=[],s=T(o=arguments),l=2;l<s;l++)ct(i,o[l],n);return ct(a,o[0],!1),function(e,t){if(0===e.length)return"";if(1===t.length)return e.join(t[0]);for(var r=e[0],n=1,o=0;n<e.length;n++,o++)o===t.length&&(o=0),r+=t[o]+e[n];return r}(i,a)},3,k,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),ce("FINDB",function(e,t,r){var n,o,i,a,s,l;return dt()||C.usedbcs?(n=ee(t),o=ee(e),i=n.length,r<1||i<r?N:(a=mt(n),s=mt(o),-1===(l=a.indexOf(s,r-1))?N:l+1)):pt(e,t,r)},2,3,[Te,Te,Se],k,k,{bk:2}),ce("LEFTB",function(e,t){return ht(!0,e,t)},1,2,[Te,xe],k,k,{bk:1}),ce("RIGHTB",function(e,t){return ht(!1,e,t)},1,2,[Te,xe],k,k,{bk:1}),ce("MIDB",function(e,t,r){var n,o,i;return dt()||C.usedbcs?(o=(n=ee(e)).length,--t<0?N:o<=t?"":o<t+r?n.slice(t).join(""):(i=n.slice(t,t+r),"singleByte"!==$(i[i.length-1])&&(i[i.length-1]="",A(i[0])&&(i[i.length]="")),i.join(""))):ft(e,t,r)},3,3,[Te,ke,ke]),ce("LENB",function(e){var t,r,n,o;if(!e)return 0;if(dt()||C.usedbcs){for(r=t=0;r<e.length;r++)if(8203!==e[r].charCodeAt(0)&&(n=$(e[r]),o=f.Common.CultureManager.q4(),"doubleByte"===n&&9390!==e[r].charCodeAt(0))){if("ja-jp"===(o&&o.name().toLocaleLowerCase())&&(711===e[r].charCodeAt(0)||9356===e[r].charCodeAt(0)||8212===e[r].charCodeAt(0)))continue;t++}return e.length+t}return e.length},1,1,Te),ce("REPLACEB",function(e,t,r,n){var o,i,a,s,l,u,c;if(dt()||C.usedbcs){for(o=[],i=void 0,s=a=0;s<e.length;s++)i=e[s],"doubleByte"===$(e[s])&&(a++,i=e[s]),o[s+a]=i;return l=o.length,t=w(t,l+1),r=w(r||0,l-t+1),A(o[t-1])?(o[t-1]=" ",o[t]=" "):A(o[t-2])&&2<=t&&(o[t-2]=" ",o[t-1]=" "),u=o.slice(0,t-1).join(""),c=o.slice(t-1+r).join(""),u.concat(n).concat(c)}return ut(e,t,r,n)},4,4,[Te,{Hi:2,aj:"< 1",bj:N},ke,Te],k,k,{bk:2}),ce("SEARCHB",function(e,t,r){var n,o,i,a;return dt()||C.usedbcs?(n=ee(t),o=ee(e),i=n.length,r<1||i<r?N:(a=gt(mt(o),mt(n),r))===N?N:a):gt(e,t,r)},2,3,[Te,Te,xe],k,k,{bk:2}),ce("ENCODEURL",function(e){var t,r,n,o,i,a,s,l,u="";if((t=e.length-1)<0)return"";for(r=0;r<=t;r++)if((n=e.charCodeAt(r))>="A".charCodeAt(0)&&n<="Z".charCodeAt(0)||n>="0".charCodeAt(0)&&n<="9".charCodeAt(0)||n>="a".charCodeAt(0)&&n<="z".charCodeAt(0)||n==="-".charCodeAt(0)||n==="_".charCodeAt(0)||n===".".charCodeAt(0))u+=e[r];else{if(o=void 0,55296<=(l=n)&&l<=57343){if(t===r||(a=n,s=e.charCodeAt(r+1),!(!(a<55296||56319<a)&&56320<=s&&s<=57343)))return null;o=[n,e.charCodeAt(r+1)],r++}else o=[n];for(i=0;i<o.length;i++)u+="%",u+=o[i].toString(16).toUpperCase()}return u},0,1,Te),ce("ISERROR",function(e){return j(e)},1,1,k,k,k,{gk:-1}),ce("ISERR",function(e){return!!j(e)&&e._code!==L._code},1,1,k,k,k,{gk:-1}),ce("ISNA",function(e){return!!j(e)&&e._code===L._code},1,1,k,k,k,{gk:-1}),ce("ERROR.TYPE",function(e){if(!A(e)&&j(e)){var t=s(e._code,[R._code,D._code,N._code,F._code,_._code,O._code,L._code]);if(0<=t)return t+1}return L},1,1,k,k,k,{gk:-1}),ce("ISNUMBER",function(e){return q(e,C.ExcelCompatibleCalcMode)},1,1,k,k,k,{gk:-1}),ce("ISEVEN",function(e){return ue(u(e))%2==0},1,1,pe,k,k),ce("ISODD",function(e){return ue(u(e))%2!=0},1,1,pe,k,k),ce("N",function(e){return q(e)?V(e):X(e)?e?1:0:j(e)?e:0},1,1,k,k,k),ce("ISBLANK",function(e){return A(e)},1,1,k,k,k,{gk:-1}),ce("ISLOGICAL",function(e){return X(e)},1,1,k,k,k,{gk:-1}),ce("ISTEXT",function(e){return J(e)},1,1,k,k,k,{gk:-1}),ce("ISNONTEXT",function(e){return!J(e)},1,1,k,k,k,{gk:-1}),ce("ISREF",function(e){return H(e)},1,1,k,-1,k,{gk:-1}),ce("TYPE",function(e){return X(e)?4:q(e)?1:J(e)?2:j(e)?16:G(e)?64:N},1,1,k,k,-1,{gk:-1}),ce("NA",function(){return L},0,0),ce("SHEET",function(e,t){var r,n=0,o=e.source.kj;if(G(t))return L;if(t instanceof C.CalcReference||A(t))return r=t&&(t._source||t.references[0]._source)||e.source,o.parent.getSheetIndex(r.kj.name())+1;if(q(t)||J(t))for(;n<o.parent.sheets.length;n++)if(t.toUpperCase()===o.parent.sheets[n].name().toUpperCase())return n+1;return L},0,1,k,-1,k,{dk:!0}),ce("SHEETS",function(e,t){var r,n,o=e.source.kj;return A(t)?o.parent.sheets.length:G(t)||q(t)?L:J(t)?N:t instanceof C.CalcReference?(r=t.references)?r.length:(n=t._source||e.source,o.parent.getSheetIndex(n.kj.name())+1):L},0,1,k,-1,k,{dk:!0}),ce("LET",k,3,253,k,k,k,{argsValidator:function(e,t,r){if(r%2==0)throw C.sR().Exp_FormulaInvalid},subExpressionValidator:function(e,t){if(t%2==0&&1===e.type)throw C.sR().Exp_FormulaInvalid}}),ce("OBJECT",function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m=arguments,b=T(m);if(b<2||b%2!=0)return L;for(t=0;t<b;t+=2){if(o=m[t+1],i=yt(m[t],2),a=yt(o,0),j(i))return i;if(j(a))return a;if(i.isError||a.isError)return L;if(s=i.length,l=a.length,A(n))n=l;else if(n!==l)return L;if(l<s)return L;if(s<l){if(!1===r||1<s)return L;for(A(e)&&(e=[]),u=a.rowCount,c=a.colCount,h=i[0],f=0;f<u;f++){for(d=e[f],A(d)&&(d=e[f]=[]),p=0;p<c;p++)A(d[p])&&(d[p]={}),d[p][h]=a[p+f*c];e[f]=d}r=!0}else{if(!0===r)return L;for(A(e)&&(e={}),g=0;g<l;g++)e[i[g]]=a[g];r=!1}}return r?new C.CalcArray(e):e},2,k,k,-1,-1),ce("PROPERTY",function(){var e,t=arguments,r=t[0],n=t[1].split("."),o=n.length,i=r;if(A(r)||"object"!=typeof r)return L;for(e=0;e<o;e++)if(i=i[n[e]],A(i))return L;return i},2,2,k),(Fe=new C.Functions.AsyncFunction("REFRESH",1,3)).evaluate=bt,C.Functions.bi.REFRESH=Fe},CalcEngine:function(e,t){e.exports=r("@grapecity/js-calc")},Common:function(e,t){e.exports=r("@grapecity/js-sheets-common")}},a.c=o,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){var r,n;if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(r=Object.create(null),a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(n in t)a.d(r,n,function(e){return t[e]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/assets/",a(a.s="./src/basicFunctions.entry.ts")),e.exports=i.Spread.CalcEngine.BasicFunctions},"./node_modules_local/@grapecity/js-calc-basicfunctions/index.js":function(e,t,r){e.exports=r("./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js")},"./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js":function(e,t,r){var n,o,i="object"==typeof i?i:{};function a(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}i.Spread=i.Spread||{},i.Spread.CalcEngine=(o={},a.m=n={"./src/Parser.ts":function(e,R,t){"use strict";var n,D,S,r,o,N,x,i,a,s,l,f,c,F,_,P,L,u,O,B,h,d,p,g,m,b=this&&this.__extends||(g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function T(){throw D.sR()[l]}function j(e,t,r){throw x.Kb(D.sR()[r||s],[e,t])}function y(e){return e<=255}function C(e){return e<=127}function A(e){return e===D.getBoolean().boolean_true||e===r}function k(e){return e===D.getBoolean().boolean_false||e===o}function H(e){return 48<=e&&e<=57}function G(e,t,r,n,o,i){var a,s,l=e.length,u=r===n?0:1,c=[],h=0;for(a=t+1;a<l;a++)if((s=e[a])===o&&(c.push(s),h++,s=e[++a]),s===r&&u++,s===n)if(u--,r===n&&a+2<l&&e[a+1]===r)c.push(r),a++,h++;else{if(0===u)return{result:c,endIndex:a,skipCount:h};c.push(s)}else c.push(s);i&&j(n,r,f)}function U(e,t){return O.apply(e,t),e}function w(e){void 0===e&&(e=5e3),this.priority=e}function v(e,t,r,n,o){var i,a;this.oi=[],o=o||0,this.Qb=e,i=Array.isArray(e)?e.join(""):e,this.Nc=t,this.mi=r,this.li=n||r+e.length-1,0===t&&0===o&&e?(A(a=i.toUpperCase())||k(a))&&(o=5,i=a):1===t&&i!==N&&(i=i.toUpperCase()),this.ni=i,this.hi=o}function M(e,t,r,n){this.Eh=!1,this.ignoreError=!1;this.useR1C1=t,this.baseIdentity=r,this.option=n,this.source=e}function I(){}function E(e,t){if(t&&0!==t.length&&e.Eh){var r="'"===t[0]?1:0;return"["===t[r]&&t.indexOf("]")>r}}function W(){return null!==m&&m.apply(this,arguments)||this}Object.defineProperty(R,"__esModule",{value:!0}),n=t("Common"),D=t("./src/calc.common.ts"),S=void 0,r="TRUE",o="FALSE",N="ARRAY",x=n.Common.u,i=n.Common.j,a=i.Fa,s="Exp_FormulaInvalidChar",l="Exp_FormulaInvalid",f="Exp_NoSyntax",R.di=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," "],c={":":1,"^":2," ":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},F=".",P=";",L=_=",",u=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],R.isDigit=H,R.ei=function(e){var t=e.charCodeAt(0);return!y(t)||(C(t)?96<=(t|=32)&&t<=122:0===u[t]||1===u[t])},R.fi=function(e){var t=e.charCodeAt(0);return!y(t)||(C(t)?t<=57?48<=t:96<=(t|=32)&&t<=122:0===u[t]||1===u[t])},R.isNumber=function(e){var t=e.charCodeAt(0);return C(t)?48<=t&&t<=57:8===u[t]||10===u[t]},O=[].push,v.prototype.type=function(){return this.Nc},v.prototype.subType=function(){return this.hi},v.prototype.stringValue=function(){return this.ni},B=v,R.FormulaToken=B,w.prototype.resolveToken=function(e,t,r,n,o){return 0},w.prototype.unparse=function(e,t,r,n){return!0},h=w,R.TokenResolver=h,R.preOperaterTypesMap={"+":0,"-":1},R.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},I.prototype.setParserOption=function(e){var t,r;e!==S&&n.Common.CultureManager.q4()?(r="object"==typeof e&&e.NumberFormat?e.NumberFormat:n.Common.CultureManager.q4().NumberFormat,t=e?r:{}):r=t={},_=I.listSeparator=t.listSeparator||",",F=t.numberDecimalSeparator||".",!e&&I.numberDecimalSeparator||(I.numberGroupSeparator=r.numberGroupSeparator||",",I.numberDecimalSeparator=r.numberDecimalSeparator||"."),P=I.arrayGroupSeparator=t.arrayGroupSeparator||";",L=I.arrayListSeparator=t.arrayListSeparator||","},I.prototype.parse=function(e,t){var r,n;return this.setParserOption(e.culture),r=t.split(""),this.gi=r,n=this.parseToTokens(e,r,!e.ignoreError),this.buildExpressionTree(e,n,!e.ignoreError)},I.prototype.unparse=function(e,t,r){return void 0===r&&(r=[]),this.Cma(e,t,r),"@"===r[0]&&t&&t.arguments[0]&&1===t.arguments[0].type&&e&&e.source&&e.source._service&&!0!==e.source._service.allowDynamicArray&&r.splice(0,1),r.join("")},I.prototype.Cma=function(e,t,r){var n,o;if(t)for(this.setParserOption(e.culture),n=e.getResolvers(),o=0;o<n.length&&!n[o].unparse(e,this,t,r);o++);},I.prototype.parseToTokens=function(p,g,m){var b,y,C,w,v,S,x,T,A,e,k,M,I,t,E,r;for(void 0===m&&(m=!0),b=this,y=function(e,t,r){return 0<t.length&&e.push(new B(t,0,r)),[]},C=g.length,w=[],v=[],S=-1,e=0,I=!(x=[]);e<C&&" "===g[e];)e++;for("="===g[e]&&e++,t=function(t){var e,r,n,o,i,a,s,l,u,c,h=g[t],f=h.charCodeAt(0),d=void 0;if(64===f&&p.kj&&p.kj.Wu&&!0===p.kj.Wu.allowDynamicArray)T=new B(h,1,t,t,1),w.push(T),v[++S]=T,A=t+1,I=!0;else if(97<=f&&f<=122||65<=f&&f<=90)x.push(h);else if(34===f)(d=G(g,t,'"','"',"",m))?(e=new B(d.result,0,t,t+d.result.length+2,3),d.skipCount&&(e.HTa=g.slice(t,d.endIndex+1).join(""),e.li+=d.skipCount),w.push(e),t=d.endIndex,A=t+1):(U(x,g.slice(t,C)),t=C-1);else if(39===f)d=G(g,t,"'","'","",m),t=d?(n=[],1<(r=function(e){var t,r,n=[];if(-1<e.indexOf(":"))for(t=e.split(":"),r=0;r<t.length;r++)n.push("'"+t[r].replace(/'/g,"''")+"'");return n}(d.result.join(""))).length&&(o=r.join(":").split(""),n=b.parseToTokens(p,o,m)),n&&0<n.length?(n.forEach(function(e){e.mi+=t,e.li+=t}),U(w,n)):(x.push("'"),U(x,d.result),x.push("'")),d.endIndex):(x.push("'"),C-1);else if(91===f)if(d=G(g,t,"[","]","'",m))x.push("["),U(x,d.result),x.push("]"),t=d.endIndex;else{if(b.lda&&0===x.length&&("R"===x[0]||"r"===x[0]||"C"===x[0]||"c"===x[0]))return E=t,"continue";U(x,g.slice(t,C)),t=C-1}else{if(13===f||10===f)return E=t,"continue";if(35===f)(i=function(e,t,r){var n,o,i,a,s=e.length,l=s-t;for(n=0;n<D.ErrorList.length;n++)if(t+(i=(o=D.ErrorList[n]).length)<=s&&(a=e.slice(t,t+i),i<=l&&o===a.join("").toUpperCase()))return{result:a,endIndex:t+i-1};r&&j([e[t],t])}(g,t))?(w.push(new B(i.result,0,t,t+i.result.length-1,6)),A=t+1,t=i.endIndex):x.push(h);else if(33===f)x.length,0<(a=w.length)&&0===w[a-1].Nc?(s=w[a-1],O.apply(s.Qb,x),w[a-1]=new B(s.Qb,0,s.mi,t,12)):w.push(new B(x,0,A,t,12)),x=[],A=t+1;else if(43===f||45===f)l=0===w.length?null:w[w.length-1],0!==x.length?(w.push(new B(x,0,A)),w.push(new B(h,5,t)),x=[]):(l&&7===l.Nc&&w.pop(),!l||2!==l.hi&&6!==l.Nc&&0!==l.Nc?w.push(new B(h,4,t)):w.push(new B(h,5,t))),A=t+1;else if(h===F||H(f))!(0<x.length)&&(u=function(e,t,r){var n,o,i=e.length,a=0,s=[];for(n=t;n<i;n++)if(H((o=e[n]).charCodeAt(0)))0===a?a=2:3===a?a=4:1===a?a=2:5!==a&&6!==a||(a=7),s.push(o);else if(o===r){if(2===a)a=4;else{if(0!==a&&1!==a)return{};a=3}s.push(".")}else if("+"===o||"-"===o){if(0===a)a=1;else{if(5!==a)return{num:s,endIndex:n-1};a=6}s.push(o)}else if("E"===o||"e"===o){if(2!==a&&4!==a)return{};a=5,s.push(o)}else if(2===a||4===a||7===a)return{num:s,endIndex:n-1};return 2===a||4===a||7===a?{num:s,endIndex:i-1}:{}}(g,t,F)).num?(k=u.endIndex,c=u.num,A=k<=C-2&&"!"===g[k+1]?(U(x,c),k):(w.push(new B(c,0,t,k,4)),k+1),t=k):x.push(h);else if(123===f)0<x.length&&m&&j(h,t),T=new B(N,1,t,t,1),w.push(T),v[++S]=T,A=t+1;else if(h===P&&0<=S&&v[S].value===N)x=y(w,x,A),S<0&&m&&j(h,t),w.push(new B(P,3,t,t)),A=t+1;else if(125===f)x=y(w,x,A),k<0&&m&&j(h,t),M=v[S--],M=new B(h,M.Nc,t,t,2),w.push(M),A=t+1;else if(32===f)x=y(w,x,A),A=t+1;else if(h===_||h===L||h===P)x=y(w,x,A),I&&h===_&&(I=!1,M=new B(")",1,t,t,2),w.push(M)),S<0||1!==v[S].Nc?w.push(new B(_,5,t,t,10)):w.push(new B(h,3,t,t)),A=t+1;else if(37===f)x=y(w,x,A),w.push(new B(g[t],6,t,t)),A=t+1;else if(t+2<=C&&R.operaterTypesMap[h+g[t+1]])x=y(w,x,A),w.push(new B(g.slice(t,t+2),5,t,t+1,5)),A=++t+1;else if(R.operaterTypesMap[h])x=y(w,x,A),w.push(new B(h,5,t,t)),A=t+1;else if("("===h)0<x.length?(T=new B(x,1,A,t,1),x=[]):T=new B(h,2,t,t,1),w.push(T),v[++S]=T,A=t+1,I=!1;else if(")"===h){if(x=y(w,x,A),S<0)return m&&j(h,t),E=t,"continue";M=v[S--],M=new B(h,M.Nc,t,t,2),w.push(M),A=t+1}else if(":"===h)x=y(w,x,A),w.push(new B(h,5,t,t,11)),A=t+1;else if("\r"!==h&&"\n"!==h){if("\\"===h){if(C<=++t)return m&&j(h,t),E=t,"continue";x.push(h),h=g[t]}x.push(h)}}E=t},r=A=e;r<C;r++)t(r),r=E;return y(w,x,A),w},I.prototype.buildExpressionTree=function(e,t,r){var n,o=this.ii(e,t,r),i=this.ji(e,o,r);return r&&(i||T(),this.rSa(i)),(n=e.source)&&n.q$a||!i||(i.ehc=!0),i},I.prototype.rSa=function(e){for(var t,r,n,o,i;10===e.type;)e=e.value;if(9===e.type)e.value||T(),this.rSa(e.value),e.value2&&this.rSa(e.value2);else if(7===e.type)for(r=(t=e.arguments).length,(n=e.function)&&n.gEc(n.minArgs,n.maxArgs,r),o=0;o<r;o++)i=t[o],n?n.hEc(i,o):D.iEc(i,o),this.rSa(i)},I.prototype.ji=function(e,t,r){var n,o,i,a,s,l,u=this.ki(e,t,r);for(a=3;a<u.length;)if(s=u[a],9!==(l=u[a-2]).type&&r&&T(),s&&9===s.type){for(;3<=a&&c[s.value]>=c[l.value];)o=u[a-3],i=u[a-1],n=D.Kh(l.operatorType,o,i),u.splice(a-3,3,n),3<=(a-=2)&&(l=u[a-2]);a+=2}else a++;if(1===u.length)return u[0];for(a=u.length-2;0<a;a-=2)o=u[a-1],i=u[a+1],9!==u[a].type&&r&&T(),n=D.Kh(u[a].operatorType,o,i),u.splice(a-1,3,n);return n},I.prototype.ki=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m;for(n=[],o=(t=Array.isArray(t)?t:[t]).length,i=0;i<o;i++){if(9===(s=a=t[i]).type){if(0===a.operatorType||1===a.operatorType)if(i===o-1)r&&T();else{for(l=i;9===t[l].type&&t[l].operatorType<=1;)l++;for(u=this.ji(e,t[l]),c=l-1;i<=c;c--)u=s=D.Kh(t[c].operatorType,u);s=u,i=l}else if(2===a.operatorType){if(0!==i){s=D.Kh(a.operatorType,this.ji(e,n[n.length-1])),n[n.length-1]=s;continue}r&&T()}}else if(10===a.type)a.value=this.ji(e,a.value),s=a;else if(7===a.type){if(d=[],p=[],(h=0)<(f=a.arguments).length){for(g=0;g<=f.length;g++)m=f[g],g===f.length||0===m.type&&m.value===_?(h===g?d.push(new D.Expression(11)):d.push(this.ji(e,p)),h=g+1,p=[]):p.push(m);a.arguments=d}s=a}n.push(s)}return n},I.prototype.ii=function(e,t,r){var n,o,i=[];for(n=0,o=t.length;n<o;)n=this.resolveToken(e,t,i,n,r);return i},I.prototype.resolveToken=function(e,t,r,n,o){var i,a,s,l,u,c=t[n],h=e.getResolvers();for(i=0;i<h.length;i++)if(a=h[i].resolveToken(e,this,t,n,o)){l=n-1,(s=a.expr)&&a.index!==S?n=a.index-1:s=a,(u=0<r.length?r[r.length-1]:null)&&0!==s.type&&7!==s.type&&s.type<9&&0!==u.type&&7!==u.type&&u.type<9&&t[l].li<c.mi-1&&r.push(D.Kh(17," ")),r.push(s);break}return n+1},I.prototype.resolveSubTokens=function(e,t,r,n){for(var o=[];r<t.length&&2!==t[r].hi;)r=this.resolveToken(e,t,o,r,n);return{exprs:o,index:r+1}},d=I,R.Parser=d,M.prototype.getExternalSource=function(e,t){var r,n=this.source.getCalcService().getAllSourceModels();for(r=0;r<n.length;r++)if(x.Mb(n[r].getSource().getName(),t))return n[r].getSource();return null},M.prototype.getExternalSourceToken=function(e){return e.getName()},M.prototype.setSource=function(e){this.source=e},M.prototype.getResolvers=function(){var e=(this.source||this.kj).getCalcService();return e&&e.getResolvers()},M.prototype.addResolver=function(e){var t=(this.source||this.kj).getCalcService();t&&t.addResolver(e)},M.prototype.getFunction=function(e){var t,r=e,n=D.getMapping()&&D.getMapping().builtInFunctionsMapping;if(!a(n))for(t in n)n[t].alias===e&&(r=t);return this.source&&this.source.getCustomFunction(r)||D.Functions.findGlobalFunction(e)},p=M,R.ParserContext=p,D.CalcSource.prototype.getParserContext=function(e,t,r){return new p(this,e,t,r)},b(W,m=h),W.prototype.resolveToken=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m=r[n],b=m.ni,y=m.Qb,C=m.Nc,w=null,v=m.hi;if(0===C&&12===v){if(u=void 0,b&&"'"===(u=b).charAt(0)&&(u=u.substring(1,u.length-1)),n++,u&&(w=e.getExternalSource("",u)),!(m=r[n]))return(i=new D.Expression(8)).value=b,i;b=m.ni}if(0===C)0===m.hi?A(s=b.toUpperCase())||k(s)?(m.hi=5,m.ni=s,(i=new D.Expression(4)).value=A(s)):(i=new D.Expression(8)).value=b:4===m.hi?((i=new D.Expression(2)).value=parseFloat(b),i.originalValue=b):3===m.hi?(i=new D.Expression(3)).value=b:5===m.hi?(i=new D.Expression(4)).value=A(b):6===m.hi?(i=new D.Expression(5)).value=D.CalcError.parse(b):7===m.hi&&((i=new D.Expression(8)).value=b);else if(1===C){if(b===N){for(i=new D.Expression(6),n++,s=[[]],h=c=a=0;n<r.length&&2!==r[n].hi;){if(m=r[n],n<r.length-1&&4===m.Nc&&"-"===m.ni&&4===r[n+1].hi&&((m=r[++n]).Qb.unshift("-"),m.ni="-"+m.ni),3===m.Nc){if(m.ni===P){if(c!==h)throw x.Kb(D.sR().Exp_InvalidArrayColumns,[m.mi]);s.push([]),a++,h=0}}else{if(0!==m.Nc||4!==m.hi&&3!==m.hi&&5!==m.hi&&6!==m.hi)throw D.sR().Exp_InvalidArray;d=f=m.ni,4===m.hi?d=parseFloat(f):5===m.hi?d="TRUE"===f.toUpperCase():6===m.hi&&(d=D.CalcError.parse(f)),s[a].push(d),0===a&&c++,h++}n++}if(c!==h)throw x.Kb(D.sR().Exp_InvalidArrayColumns,[m.mi]);return n++,i.value=new D.CalcArray(s),{expr:i,index:n}}if(0<y.length)return p=e.source&&e.source._service&&e.source._service.allowDynamicArray,"@"!==y[0]||p||(m.ni=y.slice(1).join(""),b=m.ni),(i=new D.Expression(7)).functionName=b,g=e.getFunction(i.functionName)||D.Functions.findGlobalFunction(i.functionName),!1===p&&g&&!0===g.isDynamicArrayFunction&&(g=S),i.function=g,(l=t.resolveSubTokens(e,r,n+1))?(i.arguments=l.exprs,{expr:i,index:l.index}):(i.arguments=[],i)}else if(4===C||6===C||5===C)i=D.Kh(4===C?R.preOperaterTypesMap[b]:R.operaterTypesMap[b],b);else if(2===C){if(i=new D.Expression(10),l=t.resolveSubTokens(e,r,n+1))return i.value=l.exprs,{expr:i,index:l.index};o&&T()}else 3===C&&((i=new D.Expression(0)).value=b);return w&&i&&(i.source=w,i={expr:i,index:n+1}),i},W.prototype.unparse=function(e,t,r,n){var o,i,a,s,l;if(6===r.type||4===r.type||2===r.type||5===r.type||3===r.type)this.qi(e,r,n);else if(9===r.type)this.ri(e,t,r,n);else if(10===r.type)n.push("("),t.Cma(e,r.value,n),n.push(")");else{if(7!==r.type)return(1===r.type||8===r.type)&&(this.unparseRefenceExpressions(e,t,r,n),!0);for(o=r.function&&r.function.name||r.functionName,U(n,((a=(i=D.getMapping()&&D.getMapping().builtInFunctionsMapping)&&i[o])&&a.alias||o).split("")),s="@"===o?["",""]:["(",")"],n.push(s[0]),l=0;l<r.arguments.length;l++)0!==l&&n.push(_),t.Cma(e,r.arguments[l],n);n.push(s[1])}return!0},W.prototype.unparseSource=function(e,t,r,n){if(e.getExternalSourceToken){if(r!==D.BangSource){var o=function(e,t,r){var n,o;if(!t||0===t.length||E(e,t)||E(e,r))return[];if(n=t,r)for(n.push(":"),o=0;o<r.length;o++)n.push(r[o]);return n}(e,e.getExternalSourceToken(r).split(""),n&&e.getExternalSourceToken(n).split(""));if(!(0<o.length))return!1;O.apply(t,o)}return t.push("!"),!0}return!1},W.prototype.unparseRefenceExpressions=function(e,t,r,n){if(r.source===D.BangSource)n.push("!");else if(r.source&&!this.unparseSource(e,n,r.source,r.endSource))return void n.push("#","R","E","F","!");8===r.type&&n.push(r.value)},W.prototype.ri=function(e,t,r,n){var o=r.operatorType;2===o?(t.Cma(e,r.value,n),n.push("%")):0===o||1===o?(n.push(R.di[o]),t.Cma(e,r.value,n)):(t.Cma(e,r.value,n),n.push(R.di[o]),t.Cma(e,r.value2,n))},W.prototype.qi=function(e,t,r){var n,o,i,a,s,l,u,c,h=D.sR().Exp_InvalidArray;if(3===t.type)r.push('"'),r.push(x.Gb(t.value,'"','""')),r.push('"');else if(2===t.type)n=t.originalValue||""+t.value,"."!==F&&(n=n.replace(".",F)),r.push(n);else if(4===t.type)r.push(t.value?D.getBoolean().boolean_true:D.getBoolean().boolean_false);else if(6===t.type){if(r.push("{"),(o=t.value).getRowCount()<=0)throw h;for(i=0,a=o.getRowCount();i<a;i++)for(1<=i&&r.push(P),s=0,l=o.getColumnCount();s<l;s++){if(0!==s&&r.push(L),(u=o.getValue(i,s))===S||null===u)throw h;"string"==(c=typeof u)?(r.push('"'),r.push(x.Gb(u,'"','""')),r.push('"')):"boolean"==c?r.push(u?D.getBoolean().boolean_true:D.getBoolean().boolean_false):"number"==c&&"."!==F?r.push((""+u).replace(".",F)):r.push(""+u)}r.push("}")}else 5===t.type?r.push(""+t.value):t.type},R.DefaultTokenResolver=W,D.ParserWrapper.XAb=function(){d.numberDecimalSeparator===S&&(new d).setParserOption(!0);return d.numberDecimalSeparator},D.ParserWrapper.YAb=function(){d.numberGroupSeparator===S&&(new d).setParserOption(!0);return d.numberGroupSeparator}},"./src/calc.common.ts":function(e,R,t){"use strict";var d,r,m,p,b,n,u,h,D,C,N,g,w,c,y,v,a,i,o,S,x,s,l,f,T,A,k,M,I,F,E,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye=this&&this.__extends||(Q=function(e,t){return(Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}Q(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function Ce(e){return e&&e.toUpperCase()}function we(e){var t=we.nf(e);if(!t)throw R.sR().Exp_NotSupported;this._error=t.error,this._code=t.code}function ve(e){return isNaN(e)||!isFinite(e)}function Se(e,t){var r,n,o,i,a,s,l,u,c,h,f;if(!e)return!(t.value=0);n=typeof e;try{if(n===m)r=e;else if(n===p){if(/[\f\n\r\t\v]/.test(e))return!1;if(0===(e=(o=e).trim()).length)return!(t.value=0);if(i=U.XAb(),a=U.YAb(),"."!==i&&"."!==a&&0<=e.indexOf(".")||","!==i&&","!==a&&0<=e.indexOf(","))return!1;if(l=s=!1,u=e[0],c=e[e.length-1],"("===e[0]&&")"===c){if(l=!0,"+"===(u=(e=e.substring(1,e.length-1).trim())[0])||"-"===u)return!1;c=e[e.length-1]}if("%"===u?(s=!0,e=e.substring(1)):"%"===c?(s=!0,e=e.substring(0,e.length-1)):"$"===u&&(e=e.substring(1)),0<=e.indexOf(a)&&(g.qb("^\\ *[\\+|\\-]?\\ *\\d+(\\"+a+"\\d{3,})+(\\"+i+"\\d*)?([E|e][\\+|\\-]?\\d+)?\\ *$").test(e)&&(e=e.replace(g.qb("[ \\"+a+"]"),"")))," "===(e=e.trim())[1]&&("+"===e[0]?e=e.replace(/^\+ +/,"+"):"-"===e[0]&&(e=e.replace(/^\- +/,"-"))),"."!==i&&(e=e.replace(i,".")),e.indexOf(i)!==e.lastIndexOf(i))return!1;if(2<=e.length&&"0"===e[0]&&"x"===e[1])return!1;if(r=(+e).valueOf(),s&&(r/=100),l&&(r=-r),ve(r)){if(h=(e=o.trim()).charCodeAt(0),h|=32,4<e.length&&97<=h&&h<=122&&(f=(f=e[0]+e[1]+e[2]).toUpperCase(),!G[f]))return!1;if(u=e[0],c=e[e.length-1],"/"===u||"-"===u||":"===u||"/"===c||"-"===c)return!1;if(g.qb("[\\'\\$\\#\\*\\%\\!\\@\\&\\(\\)\\=\\;\\\"\\<\\>\\?\\,]").test(e))return!1;if(ve((r=new Date(e)).valueOf()))return!1;r=y.Ra(r)}}else if(n===b)r=e?1:0;else{if(!(e instanceof Date))return!1;r=y.Ra(e)}}catch(e){return!1}return t.value=r,!0}function xe(e){var t={value:0};if(Se(e,t))return t.value;throw R.sR().Exp_InvalidCast}function Te(e,t){return t&&(e===S||e===x||typeof e===p&&""===e.trim())}function Ae(e,t){try{if(e){if(typeof e!==b)if(e instanceof Date)e=0!==y.Ra(e);else{if(!Ie(e))return!1;e=0!==e}}else e=!1}catch(e){return!1}return t.value=e,!0}function ke(e,t,r,n,o){var i,a,s;if(Ee(e))return e;if(i={value:S},a=F,0!==t&&Te(e,n))return a;switch(t){case 1:case 5:if(r&&5!==t){if(typeof e===b&&o)return a;e=Se(e,i)?i.value:a}else typeof e===m||(e=e instanceof Date?y.Ra(e):a);break;case 11:e=Se(e,i)?i.value:a;break;case 4:typeof e===p?e=(s=d.Common.l.Qa(e))!==x&&s!==S?y.Ra(s):a:r?e=Se(e,i)?i.value:a:typeof e===m||e instanceof Date||(e=a);break;case 3:r?e=Se(e,i)?i.value:a:typeof e!==b&&(e=a);break;case 2:e=e===S||e===x?"":""+e}return e}function Me(e,t){this.array=e,this.referenceInTwoDimension=t}function Ie(e,t){return typeof e===m||e instanceof Date||!t&&(typeof e===b||!isNaN(e)&&!isNaN(parseFloat(e)))}function Ee(e){return e instanceof E}function Re(e){return e instanceof W}function De(e){return e instanceof Z}function Ne(e){this.id=Ne.sourceId++,this._service=e,this.Bf=null}function Fe(e,t){this._source=e,t?(this._identities=t,this.zf=t.length):this.zf=1}function _e(e){this.type=e}function Pe(){}function Le(e,t,r){var n=new q(5);return t&&(n.source=t),r&&(n.endSource=r),n.value=e,n}function Oe(){}function Be(e,t){return e.charAt(t)}function je(e,t){for(var r=e.length,n=!1;t<r&&!isNaN(+Be(e,t));)t++,n=!0;for(t<r&&"."===Be(e,t)&&t++;t<r&&!isNaN(+Be(e,t));)t++,n=!0;if(t<r&&("E"===Be(e,t)||"e"===Be(e,t)))for(n=!1,++t<r&&("+"===Be(e,t)||"-"===Be(e,t))&&t++;t<r&&!isNaN(+Be(e,t));)t++,n=!0;return{Vi:n,mi:t}}function He(e){return"string"==typeof e}function Ge(e){this.Di=e}function Ue(e,t){if(!e||8===e.type&&0<=e.value.indexOf("'"))throw R.sR().Exp_FormulaInvalid}function We(e,t,r,n){return ge.call(this,e,t,r,n)||this}function Ve(e,t,r,n){void 0===t&&(t=0),void 0===r&&(r=0),this.name=e,this.minArgs=t,this.maxArgs=r;this.$h=n,this.typeName=""}function ze(){var e,t,r=ee.bi,n=ee.ci,o=[];for(e in r)o.push(r[e]);for(t in n)o.push(n[t]);return o}function qe(e,t,r){this.Ri=e,this.Si=t,this.kja=r||"i"}function Ze(e){return e%400==0||e%4==0&&e%100!=0||1900===e}function Ye(e,t){switch(t){case 0:case 2:case 4:return 360;case 1:return fe(e.getFullYear())?366:365;case 3:return 365;default:return-1}}function Ke(e,t){return e-t}function Xe(e,t){return 0<=C(t,[0,2,4,6,7,9,11])?31:0<=C(t,[3,5,8,10])?30:1===t?fe(e)?29:28:void 0}function Je(e,t,r,n){var o,i,a=r.getFullYear(),s=r.getMonth(),l=r.getDate(),u=n.getFullYear(),c=n.getMonth(),h=n.getDate();return e?(o=2===s&&de(a,s)===l,i=2===c&&de(u,c)===h,t?(o&&(l=30),i&&(h=30)):o&&i&&(h=l=30),31===h&&30<=l&&(h=30)):31===h&&(h=1,t&&c++),31===l&&(l=30),360*(u-a)+30*(c-s)+h-l}function Qe(e,t,r){var n,o=1;return 0<e-t&&(n=e,e=t,t=n,o=-1),0<=C(r,[1,2,3])?o*ie(v(t)-v(e)):0<=C(r,[4,5])?o*Je(!1,5===r,e,t):o*Je(!0,6===r,e,t)}function $e(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C=r<100,w=2===r||102===r,v=w||3===r||103===r,S=5===r||105===r,x=4===r||104===r||S,T=9===r||109===r,A=1===r||101===r||T||n,k=6===r||106===r,M=k?1:0,I=!1,E=0;for(i=0;i<N(e);i++){if(p=e[i],g=void 0,(g=v?le(p,0,!1,!1,!1,w):(m=1,R.ExcelCompatibleCalcMode&&!Re(p)&&!De(p)||(m=5),le(p,m,!1,!1,!1,!0))).isError)return g[0];if(g.isConvertError)return P;for(b=g.rangeCount,y=g.isReference,a=0;a<b;a++)for(s=1<b?g[a]:g,y&&(l=p.getRow(a),u=p.getColumn(a)),c=0;c<N(s);c++)if(2===t||!y||!p.isHiddenRow(a,c,C))for(f=s[c],h=0;h<N(f);h++)if(!(1!==t&&2!==t&&y&&p.isSubtotal(a,c+l,h+u)||(null===(d=f[h])||d===F))){if(d&&d._error&&!v)return o&&(o.sumx=0,o.sumx2=0,o.n=0),d;v&&!D(d)&&(!w||""!==d&&z.Na(d,!0))?M++:x&&(!I||S&&d<M||!S&&M<d)?M=d:A?n?(o.sumx+=d,o.sumx2+=d*d,o.n++,o.values.push(d),o.values[0]!==d&&(o.allSame=!1)):(M+=d,E++):k&&(M*=d,E++),I=!0}}return A?T?M:n?void 0:0===E?B:ue(M/E):k?ue(0<E?M:0):M}function et(e,t,r){var n,o,i=r%100,a=7==i||8==i,s=7==i||10==i?1:0,l={sumx:0,sumx2:0,n:0,values:[],allSame:!1},u=$e(e,t,r,!0,l);if(u&&u._error)return u;if(l.n<=s)return B;if(l.allSame)u=0;else if(he(l.n*l.sumx2,l.sumx*l.sumx))for(n=l.sumx/l.n,o=u=0;o<l.n;o++)u+=T(l.values[o]-n,2);else u=l.sumx2-l.sumx*l.sumx/l.n;return u/=l.n-s,ue(a?Math.sqrt(u):u)}function tt(e){var t=e.charCodeAt(0);return 0<=t&&t<129||63728===t||65377<=t&&t<65440||63729<=t&&t<63732?"singleByte":55296<=t&&t<=57343?"fourByte":"doubleByte"}function rt(e){var t,r=[];for(t=0;t<e.length;t++)D(e[t])?(r[t]=e[t+1],t++):r[t]=e[t];return r.length===e.length-1&&(r[r.length]=x),r}function nt(e,t){var r,n;for(void 0===t&&(t=!0),r=[],n=0;n<N(e);n++)it(e[n],r,t);return r}function ot(e){e.sort(function(e,t){return e-t})}function it(e,t,r){var n,o;for(void 0===r&&(r=!0),n=0;n<N(e);n++)(o=e[n])!==F&&t.push(o);r&&ot(t)}function at(e,t,r){var n,o=[];return it(t,o),n=N(o),r<1||n<r?O:(r=(e?k:A)(r),e?o[n-r]:o[r-1])}function st(e,t){var r,n,o;return e=le(e,1,!0,!0,!1,!0),t=ae(t),e.isError?e[0]:e.isConvertError||c(t)?P:(it(e,r=[]),!N(r)||t<0||1<t?O:(o=(n=t*(N(r)-1))%1,n=w(""+n),0==o?r[n]:ae(r[n])+o*(ae(r[n+1])-ae(r[n]))))}function lt(e,t){var r,n,o,i,a,s,l=N(e),u=[];for(r=0;r<l;r++)se(e[r],!0)&&u.push(e[r]);return u.length?(n=u.length,ot(u),i=(o=t*(n+1)-1)%1,o<0||n-1<o?O:(s=u[a=A(o)],0==i?s:s+i*(u[a+1]-s))):O}function ut(e,t){var r,n,o,i,a,s,l,u,c,h,f=13===t,d=14===t,p=15===t,g=16===t,m=17===t,b=18===t,y=19===t;return 12===t?function(e){var t,r,n,o=[];for(t=0;t<arguments.length;t++)o[t]=arguments[t];return r=nt(e),0===(n=N(r))?O:n%2==0?(ae(r[n/2-1])+ae(r[n/2]))/2:r[w(""+n/2)]}(e):f?function(e){var t,r,n,o,i,a,s,l,u=[];for(t=0;t<arguments.length;t++)u[t]=arguments[t];for(r=S,n=0,o=nt(e,!1),i=N(o),a=0;a<i;a++){for(s=l=0;s<i;s++)s!==a&&o[s]===o[a]&&l++;n<l&&(n=l,r=o[a])}return 0===n?j:r}(e):d?(c=e[0],h=e[1],at(!0,c,h)):p?(l=e[0],u=e[1],at(!1,l,u)):g?st(e[0],e[1]):m?(i=e[0],a=e[1],(s=C(a,[0,1,2,3,4]))<0?O:st(i,.25*s)):b?lt(e[0],e[1]):y?(r=e[0],n=e[1],(o=C(n,[1,2,3]))<0?O:lt(r,.25*(o+1))):H}function ct(e,t,r){var n;return 0===e?n=t<=r:1===e?n=r<=t:2===e?n=t!==r:3===e?n=t<r:4===e?n=t===r:5===e&&(n=r<t),n}function ht(o,i){var a,s=-1,l=!0,e={value:0},u=g.zb(i);return 4===o&&u&&(a=function(e){if(""===e)return!1;var t=g.sb(u);return t.lastIndex=0,t.test(e)}),D(i)?s=0:u?l=!1:0===(""+i).trim().length||c(parseFloat(i))||!oe(i,e)?l=!1:s=e.value,function(e,t){var r,n;return(""!==i||4===o||2===o)&&!(!t&&e instanceof E)&&(D(e)&&(e=""),r={value:0},l&&oe(e,r)?""===e?2===o:ct(o,r.value,s):(!u||!se(e,!0))&&(n=D(i)?"":(""+i).toUpperCase(),u&&a?a(""+e):ct(o,(""+e).toUpperCase(),n)))}}function ft(){}function dt(e){var t=be.call(this,S)||this;return t.u4=e,t}Object.defineProperty(R,"__esModule",{value:!0}),d=t("Common"),r=t("./src/calcEngine.res.en.ts"),R.ExcelCompatibleCalcMode=!1,R.SR={en:r.resource},R.ErrorCodeList=[0,7,15,23,29,42,36,99,100],m="number",p="string",b="boolean",n=["#NULL!","#DIV/0!","#VALUE!","#REF!","#NAME?","#N/A","#NUM!","#SPILL!","#CALC!"],R.ErrorList=n,R.BAND_INDEX_CONST=-2147483648,R.MAX_ROW_COUNT=1048576,R.MAX_COLUMN_COUNT=16384,u=d.Common.j,h=u.Ca,D=u.Fa,C=u.Ea,N=d.Common.k.ac,g=d.Common.q,w=parseInt,c=isNaN,y=d.Common.l,v=y.Ra,a=d.Common.u,i=d.Common.o,o=new d.Common.ResourceManager(R.SR),R.sR=o.getResource.bind(o),R.getMapping=function(){return J&&J.resourceMapping},R.getBoolean=function(){var e=R.getMapping()&&R.getMapping().booleanMapping;return{boolean_true:e&&e.boolean_true||"TRUE",boolean_false:e&&e.boolean_false||"FALSE"}},S=null,x=void 0,s=Math.abs,l=Math.exp,f=Math.log,T=Math.pow,A=Math.floor,k=Math.ceil,M={},R.BangSource=M,I={},R.RefErrorSource=I,R.missingArgument=void 0,F={},we.prototype.toString=function(){var e=R.getMapping()&&R.getMapping().clacErrorMapping;return e&&e[this._error]||this._error},we.prototype.clone=function(){return new we(this._error)},we.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},we.parse=function(e){try{return new we(e)}catch(e){return x}},we.nf=function(e){var t,r;if(e)for(t=0;t<n.length;t++)if((r=n[t])===e||r===Ce(e))return{error:r,code:R.ErrorCodeList[t]};return x},E=we,R.CalcError=E,_={Name:new E("#NAME?"),Null:new E("#NULL!"),DivideByZero:new E("#DIV/0!"),NotAvailable:new E("#N/A"),Value:new E("#VALUE!"),Reference:new E("#REF!"),Number:new E("#NUM!"),Spill:new E("#SPILL!"),Calc:new E("#CALC!")},R.Errors=_,P=_.Value,L=_.Reference,O=_.Number,B=_.DivideByZero,j=_.NotAvailable,H=_.Null,G={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},U=function(){},R.ParserWrapper=U,Me.prototype.getRowCount=function(){return this.array.length},Me.prototype.getColumnCount=function(){var e=this.array[0];return e&&e.length||0},Me.prototype.getValue=function(e,t){var r=this.array,n=e;return"number"!=typeof t&&(n=e.row,t=e.column),n<0||t<0||n>=r.length||t>=r[0].length?P:this.array[n][t]},Me.prototype.getValueByIndex=function(e){var t=this.getColumnCount(),r=A(e/t),n=e%t;return this.getValue(r,n)},Me.prototype.toArray=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p;if(void 0===t&&(t=!0),l=0,u=[],f=F,s=this.getRowCount())for(l=this.getColumnCount(),d=0;d<s;d++)for(t||(h=[],u.push(h)),p=0;p<l;p++){if(c=this.getValue(d,p),this.referenceInTwoDimension&&De(c)&&(c=c.getValueByIndex(0)),r&&Ee(c))return(u=[c]).isError=!0,u;if(c=ke(c,e,!1,i),n&&c===f)return(u=[c]).isConvertError=!0,u;t?u.push(c):h.push(c)}return u.rowCount=s,u.colCount=l,u.rangeCount=1,u},Me.prototype.slice=function(e,t,r,n){var o,i,a,s=this.array,l=[];for(t=t<0?0:t,r=(e=e<0?0:e)+r>this.getRowCount()?this.getRowCount()-e:r,n=t+n>this.getColumnCount()?this.getColumnCount()-t:n,i=0;i<r;i++)for(o=[],l.push(o),a=0;a<n;a++)o.push(s[i+e][a+t]);return new Me(l)},W=Me,R.CalcArray=W,V=["o","n","s","b","d"],Pe.jja=function(e){return Ee(e)&&e._code===R.ErrorCodeList[5]},Pe.Nh=function(e){return isNaN(e)||!isFinite(e)?O:e},Pe.Ph=function(e,t,r,n,o,i,a,s){var l,u,c;if(e&&e.length&&e.rowCount&&e.colCount)return e;if(Re(e))(l=e.toArray(t,r,n,o,i)).isArray=!0;else if(De(e))(l=e.toArray(t,r,n,o,i,a,s)).isReference=!0;else if(h(e)){if(l=[],0===e.length)return l;if(h(e[0]))return Pe.Oh(e,t,!0);for(u=0;u<e.length;u++)(c=ke(e[u],t,!1))===Pe.CalcConvertedError&&(l.isConvertError=!0),l.push(c);l.rowCount=1,l.colCount=e.length,l.rangeCount=1}else e=ke(e,t,!0,i),n&&Pe.vf(e)?(l=[P]).isError=!0:e===Pe.CalcConvertedError?(l=[Pe.CalcConvertedError]).isConvertError=!0:r?(l=[]).push(e):(l=[[]])[0].push(e),l.rowCount=1,l.colCount=1,l.rangeCount=1;return l},Pe.Oh=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g;if(!e||!e.length||!e[0].length)return(n=[]).isError=!0,[[P]];if(0===t)return e;if(o=V[t],i=e.length,a=e[0].length,f=h=!(c={value:S}),d=Pe.CalcConvertedError,!(n=e[o]))for(n=[],e[o]=n,p=0;p<i;p++)for(s=e[p],l=n[p]=[],g=0;g<a;g++)if(Ee(u=s[g]))h=h||(n.isError=!0),l.push(u);else{switch(t){case 1:case 5:r&&5!==t?u=Se(u,c)?c.value:(f||(f=!0,n.isConvertError=!0),0):typeof u===m||u instanceof Date||(f||(f=!0,n.isConvertError=!0),u=d);break;case 3:r?u=Ae(u,c)?c.value:(f||(f=!0,n.isConvertError=!0),!1):typeof u!==b&&(f||(f=!0,n.isConvertError=!0),u=d);break;case 2:u=u===S||u===x?"":""+u}l.push(u)}return n},Pe.Rh=function(e){var t=xe(e);if(s(t)<1e21)return parseInt(""+t,10);throw R.sR().Exp_InvalidCast},Pe.Sh=function(e,t){return""!==e&&!!Se(e,t)&&s(t.value)<1e21&&(t.value=parseInt(""+t.value,10),!0)},Pe.Vh=function(e){if(!e)return!1;if(typeof e===b)return e;if(e instanceof Date)return 0!==y.Ra(e);if(Pe.Na(e))return 0!==e;if(Pe.vf(e))return!1;throw R.sR().Exp_InvalidCast},Pe.bc=function(e){try{if(e===x||e===S)return"";if(typeof e===b)return e?"TRUE":"FALSE";if(typeof e===p)return e;if(e instanceof Date)return""+y.Ra(e);if(Re(e))throw R.sR().Exp_InvalidCast;return""+e}catch(e){throw R.sR().Exp_InvalidCast}},Pe.Wh=function(e){var t={value:S};if(Pe.Xh(e,t))return t.value;throw R.sR().Exp_InvalidCast},Pe.Xh=function(e,t){var r,n,o,i;if(e)if(e instanceof Date)t.value=new Date(e.valueOf());else if(typeof e===p){if(!(r=d.Common.l.Qa(e)))if(isNaN(e)){if(r=new Date(e),isNaN(r.valueOf()))return!1;try{if(n=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,o=a.ib(a.Db(e.replace(/ |\n/g,"")," ")," "),(i=n.exec(o))&&4===i.length&&(-1===i.indexOf(""+r.getFullYear())||-1===i.indexOf(""+r.getMonth())||-1===i.indexOf(""+r.getDate())))return!1}catch(e){return!1}}else if(!(r=d.Common.l.Xb(parseFloat(e))))return!1;t.value=r}else{if(typeof e!==m)return!1;t.value=d.Common.l.Xb(e)}else t.value=d.Common.l.Xb(0);return!0},Pe.CalcConvertedError=F,Pe.Ca=Re,Pe.Na=Ie,Pe.vf=Ee,Pe._isReference=De,Pe.wf=ke,Pe.j$a=Te,Pe.Qh=ve,Pe.Pa=xe,Pe.Th=Se,Pe.Uh=Ae,z=Pe,R.Convert=z,($=R.ExpressionType||(R.ExpressionType={}))[$.unknow=0]="unknow",$[$.reference=1]="reference",$[$.number=2]="number",$[$.string=3]="string",$[$.boolean=4]="boolean",$[$.error=5]="error",$[$.array=6]="array",$[$.function=7]="function",$[$.name=8]="name",$[$.operator=9]="operator",$[$.parentheses=10]="parentheses",$[$.missingArgument=11]="missingArgument",$[$.expand=12]="expand",$[$.structReference=13]="structReference",$[$.spillReference=33]="spillReference",$[$.letLocalName=100]="letLocalName",_e.prototype.sf=function(){return S},_e.prototype.offset=function(e,t,r,n,o){return S},_e.prototype.offsetWhenCopy=function(e,t,r,n,o,i,a,s,l,u){return S},_e.prototype.getRange=function(e,t){var r,n=[];for(r=2;r<arguments.length;r++)n[r-2]=arguments[r];return S},q=_e,R.Expression=q,Fe.prototype.getRangeCount=function(){return this.zf},Fe.prototype.getSource=function(){return this._source},Fe.prototype.create=function(e){return new Fe(this._source,e)},Fe.prototype.toArray=function(e,t,r,n,o,i,a){var s=this._source,l=s.referenceToArray;return l&&l.call(s,this,e,t,r,n,o,i,a)},Fe.prototype.getRow=function(e){return this._identities?this._identities[e||0].row:0},Fe.prototype.getColumn=function(e){return this._identities?this._identities[e||0].col:0},Fe.prototype.getRowCount=function(e){return this._identities?this._identities[e||0].rowCount:this._source.getRowCount()},Fe.prototype.getColumnCount=function(e){return this._identities?this._identities[e||0].colCount:this._source.getColumnCount()},Fe.prototype.getValue=function(e,t,r){var n,o,i;if(typeof e===m?(n=arguments[1],o=r,t=arguments[0]):(n=(e=e).row,o=e.col),t=t||0,0<=n||0<=o){if(!(i=this._identities))return this._source.getValue(n,o);if(t<i.length)return this._source.getValue(n+i[t].row,o+i[t].col)}return L},Fe.prototype.getValueByIndex=function(e){var t=this.getColumnCount(),r=A(e/t),n=e%t;return this.getValue(0,r,n)},Fe.prototype.isHiddenRow=function(e,t,r){return this._source.isHiddenRow(t+this.getRow(e),r)},Fe.prototype.isSubtotal=function(e,t,r){var n=this._source;return 0===e&&t<n.getRowCount()&&r<n.getColumnCount()&&function e(t){var r,n;if(t){if(7===t.type&&("SUBTOTAL"===t.functionName||"AGGREGATE"===t.functionName))return!0;for(r=t.arguments&&t.arguments.length,n=0;n<r;n++)if(e(t.arguments[n]))return!0;if(e(t.value)||e(t.value2))return!0}return!1}(n.getCalcSourceModel()._getExpressionWithRowColumn(t,r))},Z=Fe,R.CalcReference=Z,Ne.prototype.getCalcService=function(){return this._service},Ne.prototype.Cf=function(){return this._service},Ne.prototype.setCalcService=function(e){this._service=e},Ne.prototype.getCalcSourceModel=function(){return this.Bf},Ne.prototype.setCalcSourceModel=function(e){this.Bf=e},Ne.prototype.getValue=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e];return S},Ne.prototype.getName=function(){return""},Ne.prototype.getField=function(e){return S},Ne.prototype.setValue=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e]},Ne.prototype.getReference=function(e){return new Z(this,e&&[e])},Ne.prototype.getSources=function(e){return[this]},Ne.prototype.referenceToArray=function(e,t,r,n,o,i,a,s){return e.toArray(t,r,n,o,i,a,s)},Ne.prototype.setFormula=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e]},Ne.prototype.setArrayFormula=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e]},Ne.prototype.getRowCount=function(){return 1e3},Ne.prototype.getColumnCount=function(){return 100},Ne.prototype.isHiddenRow=function(e,t){return!1},Ne.prototype.startCalculation=function(){},Ne.prototype.endCalculation=function(){},Ne.prototype.getCustomFunction=function(e){return S},Ne.prototype.getCustomName=function(e){return S},Ne.prototype.refresh=function(){},Ne.prototype.toJSON=function(e,t){var r,n=[];for(r=2;r<arguments.length;r++)n[r-2]=arguments[r]},Ne.sourceId=1,Y=Ne,R.CalcSource=Y,R.Hh=Le,R.Ih=Le(L),R.Jh=function(e,t){var r=new q(7);return r.arguments=t,e instanceof q?(r.function=e.function,r.functionName=e.functionName):(r.function=e.name&&e,r.functionName=e.name||e),r},R.createExpandExpression=function(e,t){var r=new q(12);return r.value=e,r.needExpendIndexs=t,r},R.Kh=function(e,t,r){var n=new q(9);return n.operatorType=e,n.value=t,n.value2=r,n},R.Lh=function(e){var t=new q(10);return t.value=e,t},R.createStringExpression=function(e){var t=new q(3);return t.value=e,t},R.createNumberExpression=function(e){var t=new q(2);return t.value=e,t},R.createBooleanExpression=function(e){var t=new q(4);return t.value=e,t},Oe.Yh=function(e,t){var r=16777216;return!!(e===t||s(e-t)<s(e)/(r*r))||(e=i.Lma(e,15),t=i.Lma(t,15),s(e-t)<s(e)/(r*r))},Oe.getArrayValue=function(e,t,r){return e?t<e.getRowCount()&&r<e.getColumnCount()?e.getValue(t,r):r>=e.getColumnCount()&&1===e.getColumnCount()&&t<e.getRowCount()?e.getValue(t,0):t>=e.getRowCount()&&1===e.getColumnCount()&&r<e.getColumnCount()?e.getValue(0,r):P:P},Oe.tryExtractToSingleValue=function(e){var t,r=!0;return(De(e)||Re(e))&&((t=z.Ph(e,0,!1,!0)).isError?e=t[0]:1===t.rowCount&&1===t.colCount?e=t[0][0]:(e=t,r=!1)),{value:e,success:r}},K=Oe,R.Zh=K,R.charAtFunc=Be,Ge.prototype.$j=function(e){var t,r,n,o,i=this.Di;if(u.Ca(i)||(i=[i]),-1===i[0])return!0;for(t=0;t<i.length;t++)if(o=n=void 0,He(r=i[t])){if(n=(r=r.split(" "))[0],o=w(r[1]),"!="===n&&e!==o||">"===n&&o<e||">="===n&&o<=e||"%="===n&&e%2===o)return!0}else if(e===r)return!0;return!1},Ge.prototype._j=function(){return this.Di},X=Ge,R.iEc=Ue,ee=J=J||{},(me=ee.ArrayArgumentEvaluateMode||(ee.ArrayArgumentEvaluateMode={}))[me.normal=0]="normal",me[me.allwaysExpand=1]="allwaysExpand",me[me.neverExpand=2]="neverExpand",Ve.prototype.description=function(){var e=R.sR()._h;return this.$h?this.$h:e&&e[this.name]},Ve.prototype.acceptsArray=function(e){return!1},Ve.prototype.acceptsReference=function(e){return!1},Ve.prototype.acceptsError=function(e){return!1},Ve.prototype.acceptsMissingArgument=function(e){return!1},Ve.prototype.isVolatile=function(){return!1},Ve.prototype.isContextSensitive=function(){return!1},Ve.prototype.isBranch=function(){return!1},Ve.prototype.findTestArgument=function(){return-1},Ve.prototype.findBranchArgument=function(e){return-1},Ve.prototype.expandRows=function(){return!0},Ve.prototype.expandColumns=function(){return!0},Ve.prototype.precedentReference=function(){return!0},Ve.prototype.returnReference=function(){return!1},Ve.prototype.evaluate=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e]},Ve.prototype.evaluateWithContext=function(e,t){var r=t;return this.isContextSensitive()&&(r=[e].concat(r)),this.evaluate.apply(this,r)},Ve.prototype.toJSON=function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},Ve.prototype.fromJSON=function(e){if(e)for(var t in e)e[t]!==x&&(this[t]=e[t])},Ve.prototype.gEc=function(e,t,r){if(r<e||t<r)throw R.sR().Exp_FormulaInvalid},Ve.prototype.hEc=function(e,t){Ue(e)},Ve.ai=function(e,t,r){var n,o=new Ve(e,0,255);if(t&&"function"==typeof t&&(o.evaluate=t),r)for(n in r)r.hasOwnProperty(n)&&"override"!==n&&(o[n]=r[n]);return o},te=Ve,ee.Function=te,ye(We,ge=te),We.prototype.isContextSensitive=function(){return!0},We.prototype.evaluate=function(e,t){return this.evaluateAsync.apply(this,arguments)},We.prototype.evaluateAsync=function(e,t){this.evaluate.apply(this,arguments)},We.prototype.defaultValue=function(){return 0},We.prototype.evaluateMode=function(){return 0},We.prototype.evaluateWhenArgumentsIsSame=function(){return!0},We.prototype.interval=function(){return 1e4},ee.AsyncFunction=We,ee.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},ee.bi={},ee.ci={},ee.defineGlobalCustomFunction=function(e,t){return ee.ci[Ce(e)]=t},ee.findGlobalFunction=function(e){var t,r,n;return e?(e=Ce(e),t=ee.bi,r=ee.ci,n=R.getMapping()&&R.getMapping().builtInFunctionsMapping,t&&(function(e,t){var r,n=ee.bi;if(!D(e))for(r in e)if(e[r].alias===t)return n[r];return x}(n,e)||t[e])||r&&r[e]):ze()},ee.findGlobalFunctions=function(){return ze()},ee.removeGlobalFunction=function(e){if(!e)return ee.bi={},void(ee.ci={});e=Ce(e);var t=ee.bi,r=ee.ci;t[e]?delete t[e]:r[e]&&delete r[e]},re=R.sR().Exp_Format,qe.prototype.Pi=function(){return this.Ri},qe.prototype.Qi=function(){return this.Si},qe.prototype.lja=function(){return this.kja},qe.prototype.bc=function(e){e=e||"i";var t=this.Ri,r=this.Si,n="",o=ee.CALC_PRECISION;return o&&(t=i.Lma(t,o),r=i.Lma(r,o)),0===t&&0!==r||(n+=""+t),-1===r?n+="-":0!==t&&0<r&&(n+="+"),-1!==r&&0!==r&&1!==r&&(n+=""+r),0!==r&&(n+=e),n},ne=qe,ee.Ui=ne,ee.Wi=function(e){try{return e?"number"==typeof e?new ne(e,0):"string"==typeof e?function(e){var t,r,n,o,i=0,a=0,s=!1,l=0,u=0,c=0,h=e.length;if(!e)throw R.sR().Exp_ArgumentNull;if(0===h)throw re;if(c<h&&("+"===Be(e,c)||"-"===Be(e,c))&&c++,c=(o=je(e,c)).mi,t=o.Vi,c<h&&("+"===Be(e,c)||"-"===Be(e,c))?(l=c,c=(o=je(e,++c)).mi,r=o.Vi,c<h&&("i"===Be(e,c)||"j"===Be(e,c))&&(n=Be(e,c),c++,s=!0),u=c-l):c<h&&("i"===Be(e,c)||"j"===Be(e,c))?(n=Be(e,c),u=++c,r=t,t=!(s=!0)):l=c,c<h)throw re;if(0<l){if(!t)throw re;i=parseInt(e.substr(0,l),10)}if(0<u){if(!s)throw re;if(1===u||2===u&&"+"===Be(e,l))a=1;else if(2===u&&"-"===Be(e,l))a=-1;else{if(!r)throw re;a=parseInt(e.substr(l,u-1),10)}}return new ne(i,a,n)}(e):null:new ne(0,0)}catch(e){return null}},oe=z.Th,ie=z.Rh,ae=z.Pa,se=z.Na,le=z.Ph,ue=z.Nh,ce=z.vf,he=K.Yh,ee.ak=function(e,t,r,n,o,i,a,s,l){return s=s||{},r!==x&&(s.minArgs=r),n!==x&&(s.maxArgs=n),i!==x&&(s.acceptsReference=i),a!==x&&(s.acceptsArray=a),o!==x&&(s.Ci=o),s.bk!==x&&(s.acceptsMissingArgument=s.bk),s.ck!==x&&(s.isVolatile=s.ck),s.dk!==x&&(s.isContextSensitive=s.dk),s.ek!==x&&(s.precedentReference=s.ek),s.fk!==x&&(s.arrayArgumentEvaluateMode=s.fk),s.gk!==x&&(s.acceptsError=s.gk),l!==x&&(s.isDynamicArrayFunction=l),function(e,t,n){var o,i,r;if(D(e))throw R.sR().Exp_InvalidFunctionName;if(e=e.toUpperCase(),ee.bi[e])throw R.sR().Exp_InvalidOverrideFunction;if(o=ee.bi[e]){if(!n||!n.override)throw R.sR().Exp_OverrideNotAllowed}else ee.bi[e]=o=new te(e,0,255);return t&&"function"==typeof t&&(o.evaluate=t),"function"==typeof n.argsValidator&&(i=o.gEc,o.gEc=function(e,t,r){i(e,t,r),n.argsValidator(e,t,r)}),"function"==typeof n.subExpressionValidator&&(r=o.hEc,o.hEc=function(e,t){r(e,t),n.subExpressionValidator(e,t)}),u.H(n,function(e,t){var r;0<=C(e,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","precedentReference"])?(r=new X(t),o[e]=function(e){return r.$j(e)}):0<=C(e,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive","expandColumns","expandRows"])?(r=new X(t),o[e]=function(){return r._j()}):n.hasOwnProperty(e)&&(o[e]=t)}),o}(e,t,s)},ee.hk=179769e303,ee.ik=function(e){return"boolean"==typeof e},ee.jk=He,ee.Na=function(e){return"number"==typeof e},ee.kk=Ze,fe=Ze,ee.lk=Ye,ee.mk=Ke,ee.nk=Xe,de=Xe,ee.pk=Qe,ee.qk=function(e){var t,r,n;return r=0===e?0:3<=(n=.5*s(e))?1:n<1?((((((((.000124818987*(t=n*n)-.001075204047)*t+.005198775019)*t-.019198292004)*t+.059054035642)*t-.151968751364)*t+.319152932694)*t-.5319230073)*t+.797884560593)*n*2:(((((((((((((-45255659e-12*(n-=2)+.00015252929)*n-19538132e-12)*n-.000676904986)*n+.001390604284)*n-.00079462082)*n-.002034254874)*n+.006549791214)*n-.010557625006)*n+.011630447319)*n-.009279453341)*n+.005353579108)*n-.002141268741)*n+.000535310849)*n+.999936657524,0<e?.5*(r+1):.5*(1-r)},ee.Hfc=$e,ee.sk=et,ee.mja=function(e,t,d,a){var p,g,m,b,y,r,n,o,i,s,l,u,c;if(null===d)return P;if((d=parseInt(d,10))<=0||19<d)return P;function h(e){var t,r,n,o,i,a,s,l,u,c,h,f=[];if((t=le(e,y?0:5,!1,!1,!1,!1)).isConvertError)return P;for(c=t.rangeCount,h=t.isReference,r=0;r<c;r++)for(n=1<c?t[r]:t,h&&(o=e.getRow(r),i=e.getColumn(r)),a=0;a<N(n);a++)if(!(h&&e.isHiddenRow(r,a,!1)&&p))for(l=n[a],s=0;s<N(l);s++)if(!(h&&g&&e.isSubtotal(r,a+o,s+i)||(null===(u=l[s])||m&&ce(u)||ce(u)&&b))){if(!m&&ce(u)&&3!==d)return u;"object"==typeof u&&0===Object.keys(u).length||f.push(u)}return f}if(p=1===(t=t||0)||3===t||5===t||7===t,g=1===t||2===t||3===t||0===t,m=2===t||3===t||6===t||7===t,y=(b=2===d)||3===d,r=12===d,n=13===d,o=14===d||15===d||16===d||17===d||18===d||19===d,i=[],s=N(e),o){if(2!==s)return P;if((i=h(e[0]))._error)return i;if(l=void 0,e[1]===S)return O;if(e[1]instanceof Z)l=function(e){var t,r=e.getRow(0),n=e.getColumn(0),o=e.getRowCount(0),i=e.getColumnCount(0);if(1===o&&1===i)t=e.getValue(0,0,0);else if(1!==o&&1===i&&r<=a.row&&a.row<r+o)t=e.getValue(0,a.row-r,0);else{if(!(1===o&&1!==i&&n<=a.column&&a.column<n+i))return P;t=e.getValue(0,0,a.column-n)}return t===S||""===t?O:isNaN(parseInt(t,10))?P:parseFloat(t)}(e[1]);else if(e[1]instanceof W)l=e[1].array[0][0];else{if(isNaN(parseInt(e[1],10)))return P;l=ae(e[1])}return l._error?l:(17!==d&&19!==d||(l=ie(l)),ut([i,l],d))}for(u=0;u<s;u++)if(!(e[u]instanceof Z))return P;for(u=0;u<s;u++){if(!((c=h(e[u]))instanceof Array))return c;i.push.apply(i,c)}return r||n?ut([i],d):7===d||8===d||10===d||11===d?et(i,g?1:0,d):$e(i,1,d)},ee.UAb=tt,ee.WAb=rt,ee.VAb=function(e){var t,r,n,o=[],i=0,a=0;for(r=0;r<e.length;r++){if(t=e[r],"doubleByte"===(n=tt(e[r]))||"fourByte"===n)if("fourByte"===n){if(i%2==0){i++;continue}a++,i++,t=e[r-1]+e[r]}else a++,t=e[r];o[r-(0<i?i/2:0)+a]=t}return rt(o)},ee.sja=ut,ee.tk=function(e){var t,r=1;for(t=e;1<t;t--)r*=t;return r},ee.uk=function(e,t,r){var n=e.getDate(),o=t.getDate(),i=e.getMonth(),a=t.getMonth(),s=e.getFullYear(),l=t.getFullYear();return n=31===n?30:n,r?o=31===o?30:o:31===o&&(n<30?(o=1,12<++a&&(a=1,l++)):o=30),30*(12*(l-s)+a-i)+o-n},ee.vk=function(e,t,r){return r<0||4<r?O:((d=Qe(n=e,o=t,i=r))<0&&(d=-d,a=n,n=o,o=a),d/(1===i?(s=n.getFullYear(),l=o.getFullYear(),f=h=c=u=void 0,(u=new Date(n.valueOf())).setFullYear(u.getFullYear()+1),h=0<o-u?(f=l+1-s,u=new Date(s,0,1),c=new Date(l+1,0,1),ie(v(c)-v(u))-365*(l+1-s)):(f=1,fe(s)&&n.getMonth()<3||fe(l)&&541<=256*o.getMonth()+o.getDate()?1:0),365+ae(h)/ae(f)):Ye(new Date,i)));var n,o,i,a,s,l,u,c,h,f,d},pe={},ft.wk=function(e){var t=A(e);return he(e,t+1)?t+1:t},ft.xk=function(e){var t,r,n,o,i,a=e,s=pe;if(s||(pe=s={}),t=s[a])return t;if(se(e))return s[a]=ht(4,e);for(r=D(e)?"":(""+e).toUpperCase(),n="\0",o=0;o<2&&o<N(r);o++){if(i=r[o],-1==="=><".indexOf(i)){if("<"===n)return s[a]=t=ht(3,r.substring(1)),t;if(">"===n)return s[a]=t=ht(5,r.substring(1)),t;break}if("="===i)return t="<"===n?ht(0,r.substring(2)):">"===n?ht(1,r.substring(2)):ht(4,"\0"===n?r.substring(1):e),s[a]=t;if("\0"===n)n=i;else{if("<"===n)return t=">"===i?ht(2,r.substring(2)):ht(3,r.substring(1)),s[a]=t;if(">"===n)return s[a]=t=ht(5,r.substring(1)),t}}return s[a]=t=ht(4,e),t},ft.yk=function(e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][e];return D(t)?T(10,parseFloat(e)):t},ft.zk=function(e){var t=k(e);return he(e,t-1)?t-1:t},ft.Ak=function(e,t){var r,n,o=ft.yk(s(t)),i=k,a=A;return r=(e=t<0?e/o:e*o).toExponential(),(n=w(r.split("e")[1])+1)<=15&&-85<=n&&(e=parseFloat(e.toFixed(15-n))),e=e<0?i(e-.5):a(e+.5),ue(e=t<0?e*o:e/o)},ft.Bk=function(e,t){var r,n;if(e<0||t<0||e<t)return O;for(r=1,t=Math.min(e-t,t),n=1;n<=t;n++)r*=e-n+1,r/=n;return ue(r)},ft.YDc=function(e,t){if(e<0&&s(t)<1){var r=(1/t).toPrecision(15);if(parseFloat(r)===parseInt(r,10)&&parseInt(r,10)%2!=0)return-T(-e,t)}return T(e,t)},ft.Ck=function(e,t){var r=.5<s(e)?T(1+e,t):l(t*f(1+e));return isFinite(r)?c(r)&&(r=5e-324):r===Number.POSITIVE_INFINITY?r=ee.hk:r===Number.NEGATIVE_INFINITY&&(r=-ee.hk),r},ft.Dk=function(e,t){return(l(e)+(t?-1:1)*l(-e))/2},ft.Ek=function(e,t){return c(e)?e:c(t)?t:1!==t&&1===e||0!==t&&t!==Number.POSITIVE_INFINITY?f(e)/f(t):NaN},ee.MathHelper=ft,R.Functions=J,R.gOb=function(r,n,o){var e,t,i,a,s,l,u,c,h,f;if(void 0===o&&(o=!0),Ee(r))return r;if(Ee(n))return n;if(i=typeof n===b,(t=typeof r===b)||i)e=t&&i?r===n?0:n<r?1:-1:t?1:-1;else{if(s=typeof n===p,u=(l=(a=typeof r===p)||s)?"":0,r=r===S||r===x?u:r,n=n===S||n===x?u:n,c=function(){var t,e;if(r===n)return 0;if(a&&s){t=void 0;try{t=(e=d.Common.CultureManager.getCultureInfo()).localeCompare?o?e.localeCompare(r,n):e.localeCompare(r.toUpperCase(),n.toUpperCase()):o?r.localeCompare(n):r.toUpperCase().localeCompare(n.toUpperCase())}catch(e){t=o?r.localeCompare(n):r.toUpperCase().localeCompare(n.toUpperCase())}return t}return a?1:s?-1:K.Yh(r,n)?0:r-n},!l){if(f={value:0},!Se(r,h={value:0})||!Se(n,f))return P;r=h.value,n=f.value}e=c()}return e},ye(dt,be=Y),dt.prototype.startCalculation=function(){},dt.prototype.endCalculation=function(){},dt.prototype.getValue=function(){return _.Reference},dt.prototype.getReference=function(){var e=new Z(this,[{row:0,col:0}]);return e.getValue=function(){return _.Reference},e},dt.prototype.referenceToArray=function(){var e=[_.Reference];return e.isError=!0,e},dt.prototype.getName=function(){return this.u4},dt.prototype.setValue=function(){},R.ErrorSource=dt},"./src/calc.entry.ts":function(e,r,t){"use strict";var n,o;function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(t("./src/calc.common.ts")),i(t("./src/Parser.ts")),i(t("./src/evaluator.ts")),i(t("./src/calc.ts")),i(t("./src/referenceExpression.ts")),n=t("./src/calc.ts"),Object.defineProperty(r,"supportRowColumnFormula",{set:function(e){n.supportRowColumnFormula=e},get:function(){return n.supportRowColumnFormula}}),Object.defineProperty(r,"approximatelyEqual",{set:function(e){n.approximatelyEqual=e},get:function(){return n.approximatelyEqual}}),o=t("./src/calc.common.ts"),Object.defineProperty(r,"ExcelCompatibleCalcMode",{set:function(e){o.ExcelCompatibleCalcMode=e},get:function(){return o.ExcelCompatibleCalcMode}})},"./src/calc.ts":function(e,g,t){"use strict";var r,ue,ce,he,fe,a,s,i,k,de,pe,n,ge,me,be,ye,M,o,l,H,u,I,h,c,Ce,we,ve,f,d,p,G,m,b,y,C,w,v,S,x,T,A,E,R,D=this&&this.__extends||(w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function N(){this.autoCalculation=!0,this.jh={},this.useR1C1=!1,this.allowDynamicArray=!1,this.iterativeCalculation=!0,this.iterativeCalculationMaximumIterations=1e3,this.iterativeCalculationMaximumChange=.01,this.mh=0,this.Bka=0,this.hmb=[];this.kh=new he.Parser,this.lh=new fe.Evaluator(this),this.nh=this.uzb&&this.uzb(),this.addResolver(new he.DefaultTokenResolver)}function F(e,t,r){var n=v.call(this,e)||this;return n.id=t,n.name=r,n.delay=0,n}function _(e,t){var r=S.call(this,e)||this;return r.name=t,r.delay=0,r}function P(e){this.Ze=[],this.ah=e}function L(e,t){var r,n,o,i,a,s;if(e)for(r in e)if(n=+r,o=e[r])for(i in o)a=+i,(s=o[i])&&t.setValue(n,a,s.value,s.oldValue,!0!==s.isAnchorCell)}function O(e,b,y){if(e){var C=y.anchors,w={};e.forEach(function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p=e.row,g=e.col,m=[p,g].join(",");for(b.Ag(p,g,1,1),w[m]=!0,t=e.rowCount,r=e.colCount,n=1,o=0;o<t;o++){for(;n<r;n++)if(i=y.getAnchorItem(o+p,n+g))for(s in a=i.anchorRefs)m!==s&&a[s]&&(u=C,0,c=s.split(",").map(function(e){return+e}),h=c[0],f=c[1],(l=(d=u[h])&&d[f])&&!w[s]&&(b.Ag(l.row,l.col,1,1),w[s]=!0));n=0}})}}function B(){}function j(e,t,r,n,o){var i,a,s,l,u;for(i in t)t.hasOwnProperty(i)&&(s=((a=t[i]).source||e).getCalcSourceModel(),u=(l=e.getCalcSourceModel())&&l.qg(r,n),s&&u&&a&&s.Ig(u,r,n,a,a,o))}function U(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g;for(o in r)if(r.hasOwnProperty(o))if(i=r[o],a=e.jh[i.id],s=i.row,l=i.col,h=s+(u=i.rowCount)-1,f=l+(c=i.colCount)-1,Q(s,l,u,c))a.ug(!0).Jg(s,l,u,c,t,n);else for(d=s;d<=h;d++)for(p=l;p<=f;p++)(g=a.qg(d,p,!0))&&g.gmb(0,t,n)}function W(e,t,r){var n=x.call(this,e)||this;return n.row=t,n.column=r,n.delay=0,n}function V(e,t){this.Ef=0,this.Ff=0,this.Gf=[],this.qhc=[],this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.B5=0;this._source=t,this._service=e}function z(e){return T.call(this,e)||this}function q(e,t){var r=A.call(this,e)||this;return r.name=t,r}function Z(e,t){var r=E.call(this,e)||this;return r.column=t,r}function Y(e,t){var r=R.call(this,e)||this;return r.row=t,r}function K(e,t){var r,n,o;for(r in e)(n=e[r])&&(t?K(n):(o=n.calc)&&o.ng())}function Se(e){var t,r;for(t=0;t<e.length;t++)if((r=e[t].expr)&&7===r.type&&"LET"===r.functionName)return!0;return!1}function X(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne=e.row,oe=e.column,ie=[],ae=0,se=e.arrayIdentity?e.arrayIdentity.row:ne,le=e.arrayIdentity?e.arrayIdentity.col:oe;for(l=s=0,h=n,f=o,d=u=!(ie[ae]={expr:t,acceptsArray:i||!1,acceptsRef:a||!1,index:-1});0<=ae;){if(p=ie[ae],ae--,g=p.acceptsArray,m=p.acceptsRef,t=p.expr,b=de,t)if(7===t.type){if(I=(M=(k=t).arguments).length,!k.function){if(!e){b=ue.Hh(ge);continue}if("ANCHORARRAY"===(E=k.functionName)){1===I&&(D=(R=M[0]).source,N=e.source,1===R.type&&R.sf()?b=ce.BLb(N,D,pe,R.row,R.column,R.rowRelative,R.columnRelative):5===R.type&&(b=ce.lOb(N,D))),b?e.iOb=2:b=ue.Hh(ge),k.ensureSingle&&(b.ensureSingle=!0),y=b;continue}k.function=e.getFunction(E)}if(F=k.function,_=p.index,A=p.neeedExpendindexs,_<0?(p.arrayArgumentEvaluateMode=d,p.arrayFormulaCatchValue=r,F&&F.arrayArgumentEvaluateMode&&(d=F.arrayArgumentEvaluateMode),p.args=[]):(F&&F.acceptsArray&&F.acceptsArray(_)?s--:u&&(A||(A=[],p.neeedExpendindexs=A),k.arguments[_],A.push(_)),p.args.push(y)),_===I-1){if(d=p.arrayArgumentEvaluateMode,r=p.arrayFormulaCatchValue,L=!1,(P=p.args)&&0<P.length)for(O=0;O<P.length;O++)if(P[O]!==k.arguments[O]){L=!0;break}b=L?ue.Jh(k,P):t,A&&0<A.length&&(b=ue.createExpandExpression(b,A),u=!0)}else 0===_&&F&&3===F.arrayArgumentEvaluateMode&&3===d&&(d=0),u=!1,_++,p.index=_,F&&F.acceptsArray&&F.acceptsArray(_)&&s++,ie[++ae]=p,ie[++ae]={expr:k.arguments[_],acceptsArray:!!F&&F.acceptsArray&&F.acceptsArray(_),acceptsRef:!!F&&F.acceptsReference&&F.acceptsReference(_),index:-1}}else if(1===t.type&&t.sf())l&&(v=(w=t.source!==ue.BangSource&&t.source||e.source).getRowCount(),S=w.getColumnCount(),x=(x=t.rowRelative?(t.row+se)%ue.MAX_ROW_COUNT%v:t.row)<0?x+v:x,T=(T=t.columnRelative?(t.column+le)%ue.MAX_COLUMN_COUNT%S:t.column)<0?T+S:T,t=ce.rf(t.source&&w,de,x,T,!1,!1));else if(1===t.type||13===t.type){if(13===t.type){if(C=(B=t).getRange(ne,oe),B.tzb(ne,oe,e.source.id),!C){B._error?(delete B._error,b=y=me,e.iOb=1):y=b=t;continue}t=ce.uf(B.source===e.source?de:B.source,de,C.row,C.col,C.row+C.rowCount-1,C.col+C.colCount-1)}j=t.source!==ue.BangSource&&t.source,G=(H=t).ensureSingle,l&&(w=j||e.source,v=ue.MAX_ROW_COUNT,S=ue.MAX_COLUMN_COUNT,U=H.rowRelative?(H.row+se)%v:H.row,W=H.columnRelative?(H.column+le)%S:H.column,q=void 0,(V=(V=H.endRowRelative?(H.endRow+se)%v:H.endRow)<0?V+v:V)<(U=U<0?U+v:U)&&(q=U,U=V,V=q),(z=(z=H.endColumnRelative?(H.endColumn+le)%S:H.endColumn)<0?z+S:z)<(W=W<0?W+S:W)&&(q=W,W=z,z=q),(v=w.getRowCount())<=U?(U%=v,V%=v):v<=V&&(V=v-1),(S=w.getColumnCount())<=W?(W%=S,z%=S):S<=z&&(z=S-1),t.row===ue.BAND_INDEX_CONST&&(U=V=ue.BAND_INDEX_CONST),t.column===ue.BAND_INDEX_CONST&&(W=z=ue.BAND_INDEX_CONST),t=ce.uf(j,t.endSource,U,W,V,z,!1,!1,!1,!1),G&&(t.ensureSingle=!0)),a||m&&(g||!r&&1!==d&&3!==d)||ne<0||oe<0||(0<s&&!r&&1!==d&&3!==d||0===s||2===d?(C=H.getRange(ne,oe),b=r||(m||g)&&1===d?!H.isFullColumn&&1!==C.rowCount&&h>=C.rowCount||!H.isFullRow&&1!==C.colCount&&f>=C.colCount?ue.Hh(ye):(x=(H.isFullColumn?0:C.row)+(1===C.rowCount?0:h),T=(H.isFullRow?0:C.col)+(1===C.colCount?0:f),ce.rf(j,t.endSource,x,T,!1,!1)):1<C.rowCount&&1<C.colCount||1<C.rowCount&&!H.isFullColumn&&(ne<C.row||ne>=C.row+C.rowCount)||1<C.colCount&&!H.isFullRow&&(oe<C.col||oe>=C.col+C.colCount)?ue.Hh(be):(x=H.isFullColumn||1<C.rowCount?ne:C.row,T=H.isFullRow||1<C.colCount?oe:C.col,ce.rf(j,t.endSource,x,T,!1,!1))):u=!0)}else if(9===t.type)Z=15<=t.operatorType,Y=m&&e.source&&e.source._service&&e.source._service.allowDynamicArray,-1===p.index?(p.index=t.value2?0:1,ie[++ae]=p,ie[++ae]=xe(t.value,Z||g,Z||Y,-1)):0===p.index?(y!==t.value&&(b=ue.Kh(t.operatorType,y,t.value2),p.expr=b),u&&((A=[]).push(0),p.neeedExpendindexs=A,u=!1),p.index=1,ie[++ae]=p,ie[++ae]=xe(t.value2,Z||g,Z||Y,-1)):(b=t.value2&&y!==t.value2?ue.Kh(t.operatorType,t.value,y):t,A=p.neeedExpendindexs,u&&(A?A.push(1):A=[t.value2&&t.value2===c?1:0]),A&&(b=ue.createExpandExpression(b,A),u=!0));else if(10===t.type)-1===p.index?(p.index=0,ie[++ae]=p,ie[++ae]=xe(t.value,g,m,-1)):t.value!==y&&(b=ue.Lh(y));else if(8===t.type)1===p.index?(l--,b=y,p.context&&(e=p.context)):(l++,ie[++ae]=xe(t,g,m,1,e),X=e,J=K=void 0,Se(ie)?(K=new ue.Expression(100)).value=t.value:(t.source?(J=t.source===ue.BangSource?e.source:t.source,(X=new fe.EvaluateContext(J)).cloneFrom(e),K=J.getCustomName(t.value)):(K=e.getName(t.value),e.source.getCustomName(t.value)||(X=new fe.GloableEvaluateContext(e.source)).cloneFrom(e)),K=K||ue.Hh(ge)),e=X||e,ie[++ae]=xe(K,g,m,-1,e));else if(6===t.type)if($=(Q=t).value,!g&&(0<s||r||1===d||3===d))u=!0,c=t;else if(!g&&0===s)if(ee=$.getRowCount(),te=$.getColumnCount(),ee<=h&&1<ee||te<=f&&1<te)b=ue.Hh(ye);else if(r||!(e.source&&e.source._service&&e.source._service.allowDynamicArray))try{1===ee&&(h=0),1===te&&(f=0),b=typeof(re=Q.value.getValue(h,f))===we?ue.createStringExpression(re):typeof re===Ce?ue.createNumberExpression(re):typeof re===ve?ue.createBooleanExpression(re):re._error?ue.Hh(re):(new he.Parser).parse(e.source.getParserContext(e.useR1C1,Te(0,0)),""+re)}catch(e){b=ue.Hh(ye)}b===de&&(b=t),y=b}return b}function xe(e,t,r,n,o){return{expr:e,acceptsArray:t,acceptsRef:r,index:n,context:o}}function Te(e,t){return{row:e,col:t}}function J(e,t,r,n){return{row:e,col:t,rowCount:r,colCount:n}}function Q(e,t,r,n){return-1===e&&127<n||-1===t&&127<r||127<r*n}Object.defineProperty(g,"__esModule",{value:!0}),r=t("Common"),ue=t("./src/calc.common.ts"),ce=t("./src/referenceExpression.ts"),he=t("./src/Parser.ts"),fe=t("./src/evaluator.ts"),a=r.Common.A,s=r.Common.B,i=r.Common.u,k=r.Common.l,de=null,pe=void 0,n=Math.abs,ge=ue.Errors.Name,me=ue.Errors.Reference,be=ue.Errors.Value,ye=ue.Errors.NotAvailable,M=ue.Errors.Calc,o=ue.Convert.Ca,l=ue.Convert._isReference,H=i.Nb,u=r.Common.j,I=u.Fa,h=Math.min,c="rowSliceListeners",Ce="number",we="string",ve="boolean",g.approximatelyEqual=function(e,t,r){return void 0===e&&(e=0),void 0===t&&(t=0),e===t||e instanceof ue.CalcError&&t instanceof ue.CalcError&&e._code===t._code||n(t-e)<r},g.supportRowColumnFormula=!1,P.prototype.getKey=function(){return""},P.prototype.hasListeners=function(){var e,t,r,n;for(e=0,t=this.Ze;e<t.length;e++)if(r=this[t[e]])for(n in r)if(r[n])return!0;return!1},P.prototype.gmb=function(e,t,r){var n,o=this[e],i=t.getKey();t.LDc&&1<=t.LDc.length&&((n=t.LDc)[n.length-1].push(this),i="?"+i),o||(this.Ze.push(e),o=this[e]={}),r?o[i]=t:delete o[i]},P.prototype.Yg=function(){var e,t,r,n,o,i,a=[];for(e=0;e<arguments.length;e++)a[e]=arguments[e];for(t=this.Ze,n=0;n<t.length;n++)if(o=this[t[n]])for(i in o)(r=o[i])&&r.bh()},P.prototype.Bg=function(){var e,t,r,n,o,i,a=[];for(e=0;e<arguments.length;e++)a[e]=arguments[e];for(t=this.Ze,n=0;n<t.length;n++)if(o=this[t[n]])for(i in o)!(r=o[i])||r.dh||r.eh||r.fh()},P.prototype.gh=function(){var e,t,r,n,o,i,a,s,l=[];for(e=0;e<arguments.length;e++)l[e]=arguments[e];for(t=l[0],r=this.Ze,n=t?1:-1,o=0;o<r.length;o++)if(i=this[r[o]])for(a in i)if(s=i[a],"?"===a[0]){if(t||!this.MDc)continue;for(;0<=this.MDc.indexOf(s);)this.MDc.splice(this.MDc.indexOf(s),1),s.delay--}else s&&(s.delay+=n,t&&s.y$a&&s.y$a())},P.prototype.bh=function(){},P.prototype.fh=function(){},P.prototype.ng=function(){},P.prototype.og=function(){},P.prototype.ZAb=function(){return this.ah.Cf()},f=P,g.BaseCalc=f,D(_,S=f),_.prototype.getKey=function(){var e=this.ah;return(null===e?"":e._source.id+",")+this.name},_.prototype.og=function(){this.ah.Og(this.name,!0)},_.prototype.ng=function(){this.ah.Og(this.name,!1)},_.prototype.bh=function(){this.ZAb().onAddAdjust(this,3)},_.prototype.fh=function(){this.$l=!0,this.ZAb().pg(this,3)},d=_,g.NameIDCalc=d,D(F,v=f),F.prototype.getKey=function(){return this.ah.getName()+","+this.id+"#"+this.name},F.prototype.og=function(){this.ah.Ig(this.id,this.name,!0)},F.prototype.ng=function(){this.ah.Ig(this.id,this.name,!1)},F.prototype.ZAb=function(){return this.ah._service},F.prototype.bh=function(){this.ZAb().onAddAdjust(this,6)},F.prototype.fh=function(){this.$l=!0,this.ZAb().pg(this,6)},g.PathCalc=F,N.prototype.getResolvers=function(){return this.hmb},N.prototype.addResolver=function(e){var t,r=this.hmb;for(t=0;;t++)if(!r[t]||e.priority>r[t].priority){r.splice(t,0,e);break}},N.prototype.dispose=function(){this.jh={},this.oh=de},N.prototype.cloneFrom=function(e){this.useR1C1=e.useR1C1,this.mh=e.mh,this.qh=e.qh,this.calcOnDemand=e.calcOnDemand},N.prototype.ih=function(){return this.nh},N.prototype.getExternalSource=function(e,t){var r,n,o=this.getAllSourceModels();for(r=0,n=o.length;r<n;r++)if(i.Mb(o[r].getSource().getName(),t))return o[r].getSource();return de},N.prototype.getSourceModel=function(e){var t=this.jh[e.id];return t||(t=e.createSourceModel?e.createSourceModel(this):this.createSourceModel(this,e),this.jh[e.id]=t,e.setCalcSourceModel(t),e.setCalcService(this)),t},N.prototype.getGlobalSourceModel=function(e){return this.oh||((e=e||new ue.CalcSource).createSourceModel?this.oh=e.createSourceModel(this):this.oh=this.createSourceModel(this,e),e.setCalcSourceModel(this.oh)),this.oh},N.prototype.setSourceModel=function(e,t){(this.jh[e.id]=t).setCalcService(this)},N.prototype.getAllSourceModels=function(){var e,t=[],r=this.jh;for(e in r)t.push(r[e]);return t},N.prototype.removeSource=function(e){var t,r,n,o;for(r in this.suspend(),this.jh[e.id]&&(this.onRemoveSource(e),delete this.jh[e.id]),this.clearDirties(),t=this.jh)t[r].addDirtyNodesForCalc(!0);n=this._parserContext&&this._parserContext.kj,o=e&&e.kj,n&&o&&o===n&&(this._parserContext=null),this.resume(!1)},N.prototype.clearSource=function(){this.jh={},this._parserContext=null,this.clearDirties()},N.prototype.ignoreDirty=function(){return this.qh},N.prototype.suspend=function(e){this.mh++,this.qh=!!e},N.prototype.resume=function(e){this.mh--,this.mh<0&&(this.mh=0),this.IsSuspended()||(this.rh=de,this.qh=!1,this.recalculateAll(e))},N.prototype.suspendAdjust=function(){this.Bka++},N.prototype.resumeAdjust=function(){this.Bka--,this.Bka<0&&(this.Bka=0)},N.prototype.isAdjustSuspended=function(){return 0<this.Bka},N.prototype.clearDirties=function(){var e,t,r,n=this.imb;if(n)for(e in n)if(n.hasOwnProperty(e))for(t=n[e];t;)t=(r=t.eh)?(t.$l=!1,t.eh=r.dh=pe,r):de;this.imb=this.jmb=de},N.prototype.resumeWithoutCalc=function(){this.mh=0,this.clearDirties(),this.qh=!1},N.prototype.IsSuspended=function(){return 0<this.mh},N.prototype.recalculateAll=function(e,t){var r,n,o;if(!this.IsSuspended()){for(o in this.CIb=Date.now(),t||this.lh.startCache(),n=this.jh)(r=n[o]).getSource().startCalculation(),r.addDirtyNodesForCalc(e,t);for(o in this.Gg(),n)(r=n[o]).getSource().endCalculation();t||this.lh.endCache(),delete this.CIb}},N.prototype.Gg=function(e){var t,r,n,o,i,a;if(void 0===e&&(e=!0),t=this.imb){if(e){for(r in o=t[1]||t[2],t)t.hasOwnProperty(r)&&(i=parseInt(r),o&&1!==i&&2!==i||(n=t[r])&&(n.ah.addListenersToDirty(this,i),n.processed=!0));for(r in t)t.hasOwnProperty(r)&&(n=t[r])&&(n.processed?delete n.processed:n.ah.addListenersToDirty(this,parseInt(r)))}for(r in t)t.hasOwnProperty(r)&&t[r].ah.initDelay(this,parseInt(r));for(r in t)t.hasOwnProperty(r)&&t[r].ah.adjustDelayOfListeners(this,parseInt(r),!0);do{for(r in a=!1,t)t.hasOwnProperty(r)&&t[r].ah.calculateDirtyNodes(this,parseInt(r))&&(a=!0)}while(a);for(r in t)t.hasOwnProperty(r)&&t[r].ah.calculateIterations(this,parseInt(r));this.imb=this.jmb=pe}},N.prototype.initParserContext=function(e){this._parserContext||(this._parserContext=e.getParserContext(this.useR1C1))},N.prototype.getParserContext=function(e){var t=this._parserContext;return t||(e?this._parserContext=t=e.getParserContext(this.useR1C1):t=new he.ParserContext(de,this.useR1C1)),t.setSource(e),t},N.prototype.parseWithContext=function(e,t){return this.kh.parse(e,t)},N.prototype.unparseWithContext=function(e,t){return this.kh.unparse(e,t)},N.prototype.pg=function(e,t){var r,n,o,i;isNaN(t)||(o=this.imb,i=this.jmb,o||(o=this.imb={},i=this.jmb={}),r=o[t],n=i[t],e&&!e.dh&&e!==r&&(r?n.eh=e:o[t]=e,e.dh=n,e.eh=de,i[t]=e))},N.prototype.Bh=function(e,t){var r,n,o,i,a;isNaN(t)||(n=this.imb,o=this.jmb,n&&(r=this.imb[t]),e&&(e.dh||e===r)&&(i=e.dh,a=e.eh,i?i.eh=a:n&&(a?n[t]=a:delete n[t]),a?a.dh=i:o&&(i?o[t]=i:delete o[t]),e.dh=de,e.eh=de))},N.prototype.evaluateExpression=function(e,t,r){return this.lh.evaluateExpression(t,e.getEvaluatorContext(r,!1),!1)},N.prototype.onClearExpr=function(e,t){this.lh&&this.lh.asyncManager.clearCell(e,t)},N.prototype.parse=function(e,t,r,n,o,i,a){var s,l,u=this.rh,c=this.getParserContext(e);return c.useR1C1=!a&&this.useR1C1,c.ignoreError=i,c.row=r,c.column=n,c.culture=o,u?(s=u[t])?s:(l=this.kh.parse(c,t),u[t]=l):this.kh.parse(c,t)},N.prototype.unparse=function(e,t,r,n,o,i,a){var s,l=this.getParserContext(e);return l.useR1C1=this.useR1C1,l.row=r,l.column=n,l.culture=o,l.addSheetName=a,i&&(l.Eh=!0,l.useR1C1=!1),s=this.kh.unparse(l,t),l.Eh=!1,s},N.prototype.recalculate=function(e,t,r,n){var o=this.getSourceModel(e);-1===r?o.Ag(t,0,1,o.cC()):-1===t?o.Ag(0,r,o.rC(),1):o.Ag(t,r,1,1),this.IsSuspended()||this.recalculateAll(!1,n)},N.prototype.recalculateByName=function(e,t){var r,n;t&&(n=e,r=this.getSourceModel(n).mg(H(t),!0),this.pg(r,3),this.IsSuspended()||this.recalculateAll(!1))},N.prototype.recalcRange=function(e,t,r,n,o){var i=this.getSourceModel(e);-1===r?i.Ag(t,0,n,i.cC()):-1===t?i.Ag(0,r,i.rC(),o):i.Ag(t,r,n,o),this.IsSuspended()||this.recalculateAll(!1)},N.prototype.evaluate=function(e,t,r,n,o){var i=t instanceof ue.Expression?t:this.parse(e,t,r,n);return this.lh.evaluateExpression(i,e.getEvaluatorContext(Te(r,n),!1),!1,o,o)},N.prototype._evaluateParsedFormula=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C=r.row||0,w=r.col||0,v=i?i.row:C,S=i?i.col:w,x=e.getEvaluatorContext(r,n,i);if(x.NDc=s,u=4===arguments.length&&n||a,this.allowDynamicArray&&!n&&(x.Exb=!0),(l=this.lh.evaluateExpression(t,x,o,u,u))&&l.pause)return l;if(e.ODc){for(c=0;c<e.ODc.length;c++)delete e.ODc[c].PDc;delete e.ODc}if(n&&arguments.length<=5)return l;if(!n&&a&&(ue.Convert._isReference(l)||ue.Convert.Ca(l)))return l;if(ue.Convert._isReference(l)){if(h=l.getRowCount(0),f=l.getColumnCount(0),1!==l.getRangeCount())return be;try{if(d=n?C-v:C-l.getRow(0),p=n?w-S:w-l.getColumn(0),g=Te(0,0),1!==h||1!==f)if(1===h&&1<f&&0<=p&&p<f)g.col=p;else if(1<h&&1===f&&0<=d&&d<h)g.row=d;else{if(!(n&&d<h&&p<f))return n?ye:be;g.row=d,g.col=p}l=l.getValue(g,0)}catch(e){return be}}else if(ue.Convert.Ca(l))if(n){if(b=(m=l).getRowCount(),y=m.getColumnCount(),1!==b&&b<=C-v||1!==y&&y<=w-S)return ye;l=l.getValue(1===b?0:C-v,1===y?0:w-S)}else l=l.getValueByIndex(0);return l!==pe&&l!==de||!1===o?l:0},N.prototype.onAddAdjust=function(e,t){this.nh.hh(e,t)},N.prototype.onRemoveSource=function(e){this.nh.ph(e)},N.prototype.createSourceModel=function(e,t){return new p(e,t)},N.prototype.NHb=function(){var e,t,r=this.jh;for(e in r)(t=r[e])instanceof p&&t.getAllNodes().forEach(function(e){var t=e.calc;t&&(t.$l=!1,(t.eh||t.dh)&&(t.dh=t.eh=de))})},g.CalcService=N,g.setSpillValues=L,g.markAnchorCellDirty=O,B.getLength=function(e,t){return o(e)?e.getRowCount()*e.getColumnCount():l(e)?(t=t||0,e.getRowCount(t)*e.getColumnCount(t)):void 0},B.getRowCount=function(e,t){return o(e)?e.getRowCount():l(e)?(t=t||0,e.getRowCount(t)):void 0},B.getColumnCount=function(e,t){return o(e)?e.getColumnCount():l(e)?(t=t||0,e.getColumnCount(t)):void 0},B.getValueByIndex=function(e,t,r){if(o(e))return e.getValueByIndex(t);if(l(e)){r=r||0;var n=e.getColumnCount(r);return e.getValue(r,parseInt(""+t/n,10),t%n)}},B.getValue=function(e,t,r,n){return o(e)?e.getValue(t,r):l(e)?(n=n||0,e.getValue(n,t,r)):void 0},g.CalcArrayHelper=B,V.prototype.getNode=function(e,t,r){var n,o=this,i=de;return 0<=e&&0<=t?(n=o.dataTable[e],r&&!n&&(n=o.dataTable[e]={},e>o.Ef&&(o.Ef=e)),n&&(i=n[t],r&&!i&&(i=n[t]={},t>o.Ff&&(o.Ff=t)))):-1===e&&0<=t?(i=o.If[t],r&&!i&&(i=o.If[t]={},t>o.Ff&&(o.Ff=t))):0<=e&&-1===t?(i=o.Hf[e],r&&!i&&(i=o.Hf[e]={},t>o.Ff&&(o.Ff=t))):-1===e&&-1===t&&(i=o.Jf,r&&!i&&(i=o.Jf={})),i},V.prototype.getNodeByName=function(e,t){var r=this.dataTableByName[e];return t&&!r&&(r=this.dataTableByName[e]={}),r},V.prototype.Kf=function(e,t){var r=this.getNode(e,t);return r&&r.Lf},V.prototype.Mf=function(e,t){var r=this.getNode(e,t);return r&&r.Nf},V.prototype.Qf=function(e,t){return this.getWorkingNodeInfo(e,t,2)},V.prototype._getWorkingExpressionWithRowColumn=function(e,t){return this.getWorkingNodeInfo(e,t,1)},V.prototype._getExpressionWithRowColumn=function(e,t){return this.getWorkingNodeInfo(e,t,0)},V.prototype.CTa=function(e){var t=this.getNodeByName(e);return t&&t.Nf},V.prototype.DTa=function(e){var t=this.getNodeByName(e);return t&&t.Lf},V.prototype.clearAll=function(){this.clear(-1,-1,-1,-1),this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.Jf=de},V.prototype.clear=function(e,t,r,n,o){this.$b(e,t,r,n,o)},V.prototype.rzb=function(){K(this.Hf),K(this.If),K(this.dataTable,!0),K(this.dataTableByName),this.eHb()},V.prototype.eHb=function(){this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.Jf=de,this.Gf=[],this.vg=de,this.xg=de},V.prototype.addRows=function(e,t){var r,n=this.rC();if(!(e<0||n<e||t<0))for(a(this.dataTable,n,e,t),a(this.Hf,n,e,t),r=0;r<t;r++)this.dataTable[e+r]&&(this.dataTable[e+r]={rs:"n"})},V.prototype.deleteRows=function(e,t){var r=this.rC();e<0||r<=e||t<=0||(r<e+t&&(t=r-e),s(this.dataTable,r,e,t),s(this.Hf,r,e,t))},V.prototype.addColumns=function(e,t){var r,n,o=this.rC(),i=this.cC();if(!(e<0||i<e||t<0)){for(r=0;r<o;r++)(n=this.dataTable[r])&&e<i&&a(n,i,e,t);a(this.If,i,e,t)}},V.prototype.deleteColumns=function(e,t){var r,n,o=this.rC(),i=this.cC();if(!(e<0||i<=e||t<0)){for(r=0;r<o;r++)(n=this.dataTable[r])&&s(n,i,e,t);s(this.If,i,e,t)}},V.prototype.ETa=function(e,t){var r=[e,t],n=this.getNode(e,t);return n&&r.push(n.Lf,n.Nf,n.Pf),r},V.prototype.FTa=function(e,t,r){e&&e.push(this.ETa(t,r))},V.prototype.dUa=function(){var e=this.getSource(),t=e&&e.getSheet(),r=t&&t._modelManager;return r&&r.dUa()},V.prototype.$Va=function(e,t,r,n,o){-1===e?this.kg(t,r,n):-1===t?this.jg(e,r,n):this.ig(e,t,r,n,o)},V.prototype.Rf=function(e,t,r,n){var o=this.getNode(e,t,!!r);o&&(n&&n.push([e,t,o.Lf]),o.Lf=r)},V.prototype.GTa=function(e,t,r,n,o,i,a){var s=this.getNode(e,t,!!r);s&&(this.FTa(a,e,t),s.Lf=r,(s.Nf||n)&&(s.Nf=n),(s.Pf||o)&&(s.Pf=o),s.isVolatile&&!r?this.Tf(s):(i||s.isVolatile)&&(s.isVolatile=i))},V.prototype.Sf=function(e,t,r){this.GTa(e,t,pe,pe,pe,!1,r)},V.prototype.Uf=function(e,t,r,n,o,i){var a=this.getNode(t,r);a&&a.Lf&&e.GTa(n,o,a.Lf,a.Nf,a.Pf,a.isVolatile,i)},V.prototype.ega=function(e,t){var r=this.dataTable[e];return r&&r[t]},V.prototype.Wf=function(e,t,r){var n=this.getNode(e,t,!!r);n&&(n.Nf=r)},V.prototype.Xf=function(e,t,r){var n=this.getNode(e,t,!!r);n&&(n.Pf=r)},V.prototype.Yf=function(e,t){var r=this.getNode(e,t);return r&&r.calc},V.prototype.Zf=function(e,t,r){var n=this.getNode(e,t,!0);n&&(n.calc&&n.calc.isVolatile&&this.Tf(n),(n.calc=r)&&(r.node=n))},V.prototype.Q3=function(e,t,r){var n=this.getNode(e,t,!0);n&&n.calc&&(n.calc.isVolatile&&this.Tf(n),this._service.Bh(n.calc,r),n.calc=pe)},V.prototype.$f=function(e,t,r,n,o){0<=r&&0<=n?((this.dataTable[r]||(this.dataTable[r]={}))[n]=o)&&o.calc&&delete o.calc:0<=r&&-1===n&&0<=e&&-1===t?this.Hf[r]=o:0<=n&&-1===r&&0<=t&&-1===e&&(this.If[n]=o)},V.prototype._f=function(e,t,r,n){var o=this.getNode(e,t),i=this.getNode(r,n);o&&o.Lf?this.$f(e,t,r,n,o):i&&i.Lf&&this.$f(e,t,r,n,de),i&&i.Lf?this.$f(r,n,e,t,i):o&&o.Lf&&this.$f(r,n,e,t,de)},V.prototype.rhc=function(e,t,r){var n,o,i,a,s,l;e.isIterativeCalc||(e.isIterativeCalc=!0,this.qhc.push(e),t||(o=r,(l=(n=e).ah&&n.ah.getSource())&&(i=n.row,a=n.column,s=l.getValue(i,a),l.setValue(i,a,o,s))))},V.prototype.shc=function(e){delete e.isIterativeCalc},V.prototype.thc=function(){var e,t=[],r=this.qhc,n=this.qhc.length;for(e=0;e<n;e++)r[e].isIterativeCalc&&t.push(r[e]);return this.qhc=t,this.qhc},V.prototype.lmb=function(){return this.Gf},V.prototype.bg=function(e){e.isVolatile||(e.isVolatile=!0,this.Gf.push(e))},V.prototype.Tf=function(e){var t,r,n,o;if(e.isVolatile=pe,this.B5++,100<this.B5){for(this.B5=0,t=[],r=this.Gf,n=this.Gf.length,o=0;o<n;o++)r[o].isVolatile&&t.push(r[o]);this.Gf=t}},V.prototype.getCalcService=function(){return this._service},V.prototype.setCalcService=function(e){this._service=e},V.prototype.Cf=function(){return this._service},V.prototype.getSource=function(){return this._source},V.prototype.hasFormula=function(e,t){return e=e!==pe?e:-1,t=t!==pe?t:-1,!!this._getExpressionWithRowColumn(e,t)},V.prototype.setFormula=function(e,t,r,n,o,i,a,s){var l,u,c,h,f;if(r&&0===r.length&&(r=de),!o&&this.dg(e,t,1,1)&&this.eg(),l=this.getFormula(e,t),i||l!==r&&(""!==l||r)&&(l||""!==r)||l===r&&this.Qf(e,t)){if(u=this.Cf(),c=de,u)try{h=0<=e?e:0,f=0<=t?t:0,c=n||(r?u.parse(this._source,r,h,f,!1,o):de),this.fg(e,t,c,pe,!1,a,s)}catch(e){if(!o)throw e}0<=e&&0<=t&&this._source.setFormula(e,t,r)}},V.prototype.getFormula=function(e,t,r){var n,o,i=this.Cf();return i&&(n=this._getExpressionWithRowColumn(e,t))?(e=(o=this.Qf(e,t))&&!0!==o.isDynamicArray?o.row:e,t=o&&!0!==o.isDynamicArray?o.col:t,i.unparse(this._source,n,e,t,r)):de},V.prototype.setFormulaByName=function(e,t,r,n,o){var i,a,s,l;if(e&&(e=H(e),i=this,t&&0===t.length&&(t=de),(a=i.getFormulaByName(e))!==t&&(""!==a||t)&&(a||""!==t))){if(s=i.Cf(),l=de,s)try{l=t?s.parse(i._source,t,0,0,!1,r):de,i.gg(e,l,pe,!1,n,o)}catch(e){if(!r)throw e}i._source.setFormula({name:e},t)}},V.prototype.getFormulaByName=function(e){var t,r=this.Cf();return r&&e&&(t=this.DTa(H(e)))?r.unparse(this._source,t,0,0):de},V.prototype.eg=function(){throw ue.sR().Exp_ArrayFromulaPart},V.prototype.rC=function(){return h(this._source.getRowCount())},V.prototype.cC=function(){return h(this._source.getColumnCount())},V.prototype.setArrayFormula=function(e,t,r,n,o,i,a,s){var l,u,c,h;if(o&&0===o.length&&(o=de),this.dg(e,t,r,n)&&this.eg(),e=e<0?0:e,t=t<0?0:t,(u=this.Cf())&&(this.$b(e,t,r,n,a),o)){try{l=o?u.parse(this._source,o,e,t,!1,i,i):de}catch(e){if(!i)throw e;return}for(c=e;c<e+r;c++)for(h=t;h<t+n;h++)this.fg(c,h,l,J(e,t,r,n),!1,a,s);0<=e&&0<=t&&this._source.setArrayFormula(e,t,r,n,u.unparse(this._source,l,e,t))}},V.prototype.getWorkingNodeInfo=function(e,t,r){var n,o=this._source;return e>=o.getRowCount()||t>=o.getColumnCount()?n:(0<=e&&0<=t?((!(n=this.getNode(e,t))||0===r&&!n.Lf||1===r&&!n.Nf||2===r&&!n.Pf)&&(n=this.getNode(e,-1)),(!n||0===r&&!n.Lf||1===r&&!n.Nf||2===r&&!n.Pf)&&(n=this.getNode(-1,t))):n=0<=e&&-1===t?this.getNode(e,-1):-1===e&&0<=t?this.getNode(-1,t):this.getNode(-1,-1),n&&(0===r&&n.Lf||1===r&&n.Nf||2===r&&n.Pf))},V.prototype.fg=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w=this.Cf();w.nia&&w.lh.asyncManager.endCalcCell(),l=(s=n!==pe&&null!==n)?n.row:e,u=s?n.col:t,c=this._source,h=new fe.EvaluateContext(c,Te(l,u),s),f=w.allowDynamicArray,d=X(h,r,s,s?e-n.row:0,s?t-n.col:0,f,f),(p=h.iOb)&&(delete h.iOb,2===p?r=d:1===p&&(g=w.unparse(c,r,l,u),r=w.parse(c,g,l,u))),d=d===r?pe:d,n!==pe&&(m=n),0<=e&&0<=t?(o!==pe&&!o||(b=0<=e?e:0,y=0<=t?t:0,C=r?w.unparse(c,r,b,y):pe,this._source.setFormula(e,t,C)),this.ig(e,t,r,d,m,i,a)):0<=e&&-1===t?this.jg(e,r,d,i,a):-1===e&&0<=t&&this.kg(t,r,d,i,a),w.autoCalculation&&!w.IsSuspended()&&w.recalculateAll(!1)},V.prototype.gg=function(e,t,r,n,o,i){var a,s=this.Cf(),l=X(new fe.EvaluateContext(this._source,Te(0,0),!1),t,!1,0,0);l=l===t?pe:l,n!==pe&&!n||o||(a=t?s.unparse(this._source,t,0,0):pe,this._source.setFormulaByName&&this._source.setFormulaByName(e,a)),this.lg(e,t,l,null,i),s.autoCalculation&&!s.IsSuspended()&&(o||s.recalculateAll(!1))},V.prototype.getRowExpression=function(e){return this.Kf(e,-1)},V.prototype.getColumnExpression=function(e){return this.Kf(-1,e)},V.prototype.lg=function(e,t,r,n,o){var i,a=this.mg(e,!0);a&&(o||a.ng(),(i=this.getNodeByName(e,!0)).Lf=t,n&&(n[0].push("dataTable",e),n[1]=i.Lf),r=t&&r?r:pe,i.Nf=r,o||a.og(),a.fh())},V.prototype.ig=function(e,t,r,n,o,i,a){var s=this,l=s.qg(e,t,!0);l&&(s.FTa(i,e,t),s._service.onClearExpr(s._source,Te(e,t)),l.ng(),s.Rf(e,t,r),r?((n||s.Mf(e,t))&&s.Wf(e,t,n),o&&!0===o.isDynamicArray||s.Xf(e,t,o)):(s.Wf(e,t,pe),s.Xf(e,t,pe)),l.og(),l.fh())},V.prototype.jg=function(e,t,r,n,o){var i=this.rg(e,!0);i&&(this.FTa(n,e,-1),o||i.ng(),this.Rf(e,-1,t),(r||this.Mf(e,-1))&&this.Wf(e,-1,r),o||i.og(),i.fh())},V.prototype.kg=function(e,t,r,n,o){var i=this.sg(e,!0);i&&(this.FTa(n,-1,e),o||i.ng(),this.Rf(-1,e,t),(r||this.Mf(-1,e))&&this.Wf(-1,e,r),o||i.og(),i.fh())},V.prototype.$b=function(e,t,r,n,o){function i(e,t){if(a=h.Mf(e,t),s=h.Kf(e,t),a||s){var r=(l=h.Qf(e,t))&&!0!==l.isDynamicArray?J(l.row,l.col,l.rowCount,l.colCount):pe;h.fg(e,t,de,r,!0,o)}}var a,s,l,u,c,h=this,f=e<0?0:e,d=t<0?0:t,p=f+(e<0?h.rC():r)-1,g=d+(t<0?h.cC():n)-1;for(u=f;u<=p&&0<=u;u++)for(t<0&&i(u,-1),c=d;c<=g&&0<=c;c++)u===f&&e<0&&i(-1,c),i(u,c);e<0&&t<0&&i(e,t)},V.prototype.dg=function(e,t,r,n){return this.tg(e,t,r,n,!0,!0)},V.prototype.tg=function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p=e<0?0:e,g=t<0?0:t,m=e<0?this.rC():r,b=t<0?this.cC():n,y=p+(0===m?1:m)-1,C=g+(0===b?1:b)-1,w=!1,v=[],S=[],x=this.dataTable;for(l=p;l<=y&&0<=l&&!(l>this.Ef);l++)if(s=x[l])for(u=g;u<=C&&0<=u&&!(u>this.Ff);u++)if(a=s[u])if(h=void 0,(c=a.Pf)&&!c.isDynamicArray){if(c.row<p||c.row+c.rowCount-1>y||c.col<g||c.col+c.colCount-1>C){if(o)return f=c.row===e&&0===r,d=c.col===t&&0===n,!f&&!d;w=!0}if(l!==c.row&&l!==p)continue;v.push(J(c.row,c.col,c.rowCount,c.colCount)),h=a.Lf,S.push(h),u=c.col+c.colCount-1}else i||(h=a.Lf)&&(v.push({row:l,col:u}),S.push(h));return!o&&{hasPart:w,ranges:v,formulas:S}},V.prototype.getCalcObj=function(){var e,t,r,n,o,i,a,s,l,u,c=[];for(e=0;e<arguments.length;e++)c[e]=arguments[e];if(t=c[0],r=c[1],n=t.row,o=t.column,i=null,isNaN(n)||isNaN(o))t.name&&(i=this.mg(t.name,r));else if(0<=n&&0<=o)if(t.sf())i=this.qg(n,o,r);else for(a=t.endRow,s=t.endColumn,i=[],l=n;l<=a;l++)for(u=o;u<=s;u++)i.push(this.qg(l,u,r));else 0<=n?i=this.rg(n,r):0<=o&&(i=this.sg(o,r));return i},V.prototype.mg=function(e,t){var r=de,n=this.getNodeByName(e,t);return n&&!(r=n.calc)&&t&&(r=new d(this,e),(n.calc=r).node=n),r},V.prototype.qg=function(e,t,r){var n,o,i,a=this,s=de;if(0<=e&&0<=t){if(!(o=(n=a.dataTable)[e])){if(!r)return s;o=n[e]={},e>a.Ef&&(a.Ef=e)}if(!(i=o[t]))return r&&(i=o[t]={},s=new G(a,e,t),(i.calc=s).node=i,t>a.Ff&&(a.Ff=t)),s;!(s=i.calc)&&r&&(s=new G(a,e,t),(i.calc=s).node=i,e>a.Ef&&(a.Ef=e),t>a.Ff&&(a.Ff=t))}return s},V.prototype.rg=function(e,t){var r=de;return 0<=e&&!(r=this.Yf(e,-1))&&t&&(r=new m(this,e),this.Zf(e,-1,r),e>this.Ef&&(this.Ef=e)),r},V.prototype.sg=function(e,t){var r=de;return 0<=e&&!(r=this.Yf(-1,e))&&t&&(r=new b(this,e),this.Zf(-1,e,r),e>this.Ff&&(this.Ff=e)),r},V.prototype.ug=function(e){return!this.vg&&e&&(this.vg=new C(this)),this.vg},V.prototype.wg=function(e,t){var r;return e=H(e),this.xg||(this.xg={}),!(r=this.xg[e])&&t&&(r=this.xg[e]=new y(this,e)),r},V.prototype.updateNameCalc=function(e,t){var r=this.wg(H(e));r&&(r.updateListening(!0,t),r.fh())},V.prototype.yg=function(e,t){var r,n,o=h(this.Ff,e+t-1);for(r=e;-1!==r&&r<=o;r++)this.isDirty(-1,r)&&(n=this.sg(r,!0),this._service.pg(n,2))},V.prototype.zg=function(e,t){var r,n,o=h(this.Ef,e+t-1);for(r=e;-1!==r&&r<=o;r++)this.isDirty(r,-1)&&(n=this.rg(r,!0),this._service.pg(n,1))},V.prototype.Ag=function(e,t,r,n){var o,i,a,s=this,l=null,u=h(s.Ef,e+r-1),c=h(s.Ff,t+n-1);for(o=e;o<=u;o++)for(i=t;i<=c;i++)s.ega(o,i)&&(s._service.calcOnDemand?(l=s.qg(o,i,!1))&&(l.Bg(),l.$l=!0):(l=s.qg(o,i,!0),s._service.pg(l,0)));s.zg(e,r),s.yg(t,n),(a=s.ug(!1))&&a.Bg(e,t,r,n)},V.prototype.uhc=function(){var e,t,r,n,o,i=this,a=i.lmb().concat(i.thc());for(r=0;r<a.length;r++)n=a[r],i._service.calcOnDemand&&n&&(n.isVolatile||n.isIterativeCalc)&&(n.$l=!0,n.Bg()),n&&(n.isVolatile||n.isIterativeCalc)&&n instanceof G&&!i.Dg(n)&&(o=i.qg(n.row,n.column,!0),i._service.pg(o,0),(e=i.rg(n.row,!1))&&!i.Eg(e)&&i.zg(n.row,1),(t=i.sg(n.column,!1))&&!i.Eg(t)&&i.yg(n.column,1))},V.prototype.Dg=function(e){var t=this.getCalcService().imb;return!!e.dh||e===(t&&t[0])},V.prototype.Eg=function(e){var t=this.getCalcService().imb;return e.dh||e===(t&&t[1])},V.prototype.isDirtyColumn=function(e){var t=this.getCalcService().imb;return e.dh||e===(t&&t[2])},V.prototype.isDirty=function(e,t){return!(!this.Yf(e,t)&&!this.Kf(e,t))},V.prototype.recalculateForContext=function(e,t,r){var n=this._service,o=n.getSourceModel(e),i=t.row,a=t.col;-1===a?o.Ag(i,0,1,o.cC()):-1===i?o.Ag(0,a,o.rC(),1):o.Ag(i,a,1,1),n.IsSuspended()||n.recalculateAll(!1,r)},V.prototype.recalculateCell=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=this,v=w._source,S=w._getWorkingExpressionWithRowColumn(e,t)||w._getExpressionWithRowColumn(e,t),x=v,T=x.q$a,A=x&&x.kj&&x.kj._modelManager;if(A&&(A.SIb=!0),o=!1,S){if(i=Te(e,t),a=v.getValue(e,t),s=!1,h=c=u=l=void 0,(f=w.Qf(e,t))&&!0!==f.isDynamicArray&&(s=!0,l=f.row,u=f.col,c=f.rowCount,h=f.colCount),(d=w._service).nia&&d.lh.asyncManager.startCalcCell(w._source,i),(p=d._evaluateParsedFormula(w._source,S,i,s,!0,f&&!0!==f.isDynamicArray&&J(l,u,c,h),d.allowDynamicArray,r))&&p.pause)return p;if((g=w._source.getCalcSourceModel().qg(e,t)).jOb&&(j(v,g.jOb,e,t,!1),delete g.jOb),g.fOb&&(j(v,g.fOb,e,t,!0),g.jOb=g.fOb,delete g.fOb),g.kOb&&(U(d,g,g.kOb,!1),delete g.kOb),g.eOb&&(U(d,g,g.eOb,!0),g.kOb=g.eOb,delete g.eOb),(ue.Convert._isReference(p)||ue.Convert.Ca(p))&&!0!==S.ensureSingle&&(f={row:e,col:t,rowCount:c=p.getRowCount(),colCount:h=p.getColumnCount(),isDynamicArray:!0},w.Xf(e,t,f)),o=!0,b=void 0,(m=ue.Convert._isReference(p)||ue.Convert.Ca(p))&&((b=ue.Convert.Ph(p,0,!1,!1,!1)).isError||b.isConvertError?(p=be,m=!1):(c=b.rowCount,h=b.colCount,0===c||0===h?(p=M,m=!1):1!==c||1!==h||S instanceof ce.SpillReferenceExpression||(p=b[0][0],I(p)&&(p=0),m=!1),S.ensureSingle&&m&&(y=w.getNode(e,t),delete S.ensureSingle,S=y.Lf=ue.Jh(ue.Functions.findGlobalFunction("@"),[S]),y.Nf=pe,p=S.function.evaluate({row:e,column:t},p),m=!1))),m)(C=x.setArray(e,t,c,h,b))&&L(C[1],x);else if((C=x.updateItem&&x.updateItem(e,t,p))&&(L(C[0],x),n=C[1]),a!==p||"string"==typeof p&&p.hyperlink){if(a instanceof Date){if(p instanceof Date&&a.valueOf()===p.valueOf())return!1;if(typeof p===Ce){if(k.Ra(a)===p)return!1;p=k.Xb(p)}}v.setValue(e,t,p,a)}else o=!1;d.nia&&d.lh.asyncManager.endCalcCell(w._source,i),x.Ppb&&x.Ppb(e,t)}else T||(C=x.updateItem&&x.updateItem(e,t,de))&&(L(C[0],x),n=C[1]);return A&&(n&&O(n,w,A.ZHb),A.SIb=!1),o},V.prototype.recalculateNameID=function(e){var t,r,n=this._source,o=this.CTa(e)||this.DTa(e);if(o){if((t=n.getValueByName?n.getValueByName(e):n.getValue({name:e}))===(r=this._service._evaluateParsedFormula(this._source,o,{name:e},!1,!0)))return;if(t instanceof Date&&r instanceof Date&&t.valueOf()===r.valueOf())return;n.setValueByName?n.setValueByName(e,r):n.setValue({name:e},r)}},V.prototype.addDirtyNodesForCalc=function(e,t){var r,n;!1!==e?(r=this.cC(),n=this.rC(),this.yg(0,r),this.zg(0,n),this.Ag(0,0,n,r)):t||this.uhc()},V.prototype.addListenersToDirtyForRow=function(e){for(var t,r,n,o;e.imb[1];){for(n=(r=(t=e.imb[1]).ah).cC(),o=0;o<n;o++)e.pg(r.qg(t.row,o,!0),0);e.Bh(t,1)}},V.prototype.addListenersToDirtyForCol=function(e){for(var t,r,n,o;e.imb[2];){if(0<(n=(r=(t=e.imb[2]).ah).rC()))for(o=0;o<n;o++)e.pg(r.qg(o,t.column,!0),0);else t.Bg();e.Bh(t,2)}},V.prototype.Ah=function(e,t){for(var r=e.length,n=t;n;)e[r]=n,r++,n=n.eh},V.prototype.addListenersToDirty=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g;if(1===t)this.addListenersToDirtyForRow(e);else if(2===t)this.addListenersToDirtyForCol(e);else if(0===t)for(r=[],e.imb[2]&&this.Ah(r,e.imb[2]),n=e.imb[0];n;n=n.eh)for(o=n.ah,i=n.row,a=n.column,s=o.rg(i,!1),l=o.sg(a,!1),u=o.ug(!1),n.Bg(),s&&s.Bg(),l&&l.Bg(),u&&u.Bg(i,a,1,1),this.addListenersToDirtyForRow(e);e.imb[2];){for(c=e.imb[2],h=!1,f=0;f<r.length;f++)if(r[f]===c){h=!0;break}if(h)e.Bh(c,2);else{for(d=(o=(r[r.length]=c).ah).rC(),p=0;p<d;p++)e.pg(o.qg(p,c.column,!0),0);e.Bh(c,2)}}else if(3===t)for(g=e.imb[3];g;g=g.eh)g.Bg()},V.prototype.initDelay=function(e,t){var r,n,o,i,a,s,l;if(0===t)for(r=null,n=e.imb[0];n;n=r)r=n.eh,i=(o=n.ah).rC(),a=o.cC(),n.row<i&&n.column<a?(g.supportRowColumnFormula&&(s=o.sg(n.column,!1))&&(s.delay=0),n.delay=0,delete n.MDc):e.Bh(n,0);else if(3===t)for(l=e.imb[3];l;l=l.eh)l.delay=0},V.prototype.adjustDelayOfListeners=function(e,t,r){var n,o,i,a,s,l,u,c;if(0===t)for(n=e.imb[t];n;n=n.eh)o=n.ah,i=n.row,a=n.column,s=o.rg(i,!1),l=o.sg(a,!1),u=o.ug(!1),n.gh(r),s&&s.gh(r),l&&l.gh(r),u&&u.gh(i,a,r);else if(3===t)for(c=e.imb[3];c;c=c.eh)c.gh(r)},V.prototype.calculateDirtyNodes=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g;if(e.calcOnDemand)return!1;if(r=!1,n=null,0===t){for(i=e.imb[t];i;i=o)if(o=i.eh,0===i.delay){if(this.shc(i),n=i.ah,a=i.row,s=i.column,l=n.rg(a,!1),(u=n.sg(s,!1))&&u.delay)continue;if(c=n.ug(!1),(h=n.recalculateCell(a,s,!0))&&"Branch"===h.pause){if(o=i,h.branch)for(f=0;f<h.branch.length;f++)(h.branch[f].dh||h.branch[f].eh||h.branch[f]===i)&&(i.delay++,(d=h.branch[f]).MDc=d.MDc||[],d.MDc.push(i))}else e.Bh(i,0),i.gh(!1),l&&l.gh(!1),u&&u.gh(!1),c&&c.gh(a,s,!1),(p=i.node&&i.node.Lf)&&p.ehc&&delete p.ehc;r=!0}}else if(3===t)for(g=e.imb[t];g;g=o)o=g.eh,0===g.delay&&((n=g.ah).recalculateNameID(g.name),e.Bh(g,3),g.gh(!1),r=!0);return r},V.prototype.calculateIterations=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p;if(!e.calcOnDemand&&0===t&&(r=e.imb[t])){for(i in o=!(n=null),e.jh)e.jh.hasOwnProperty(i)&&(a=e.jh[i].getSource()).clearValueCache&&a.clearValueCache();if(e.iterativeCalculation)for(l=0;o&&l<e.iterativeCalculationMaximumIterations;l++)for(o=!1,n=r;n;n=n.eh)s=n.node&&n.node.Lf&&n.node.Lf.ehc,this.rhc(n,!s,de),s&&(n.node.Lf.ehc=pe),u=n.ah,c=n.row,h=n.column,f=u.getSource().getValue(c,h),u.recalculateCell(c,h),o||(d=u.getSource().getValue(c,h),g.approximatelyEqual(f,d,e.iterativeCalculationMaximumChange)||(o=!0));else for(n=r;n;n=n.eh)s=n.node&&n.node.Lf&&n.node.Lf.ehc,this.rhc(n,!s,0),s&&(n.node.Lf.ehc=pe);for(p=null,n=r;n;n=p)p=n.eh,n.eh=pe,p&&(p.dh=pe)}},V.prototype.Ig=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j=this;for(i&&j.shc(e);12===n.type;)n=n.value;for(;10===n.type;)n=n.value;for(;12===n.type;)n=n.value;if(o){for(;12===o.type;)o=o.value;for(;10===o.type;)o=o.value;for(;12===o.type;)o=o.value}if(13===n.type){if((f=n.getRange(t,r,!0))===de)return;n=1===f.rowCount&&1===f.colCount?ce.rf(de,de,f.row,f.col,!1,!1):ce.uf(de,de,f.row,f.col,f.row+f.rowCount-1,f.col+f.colCount-1,!1,!1,!1,!1)}if(o&&o!==n&&8===o.type){if(o.source instanceof ue.ErrorSource)return;l=o.value,(u=(T=n.source||o.source||a||j._source).getCustomName(l))?A=T.getCalcSourceModel():(u=(A=j._service.getGlobalSourceModel()||T.getCalcSourceModel()).getSource().getCustomName(l))||T.getCalcSourceModel().wg(l,!0).gmb(0,e,i),(c=A.wg(l,!0)).gmb(0,e,i),o=null,u&&j.Ig(e,t,r,u,de,i,A.getSource())}if(1===n.type&&n.endSource)for(M=(k=n).source.getSources(k.endSource),s=0;s<M.length;s++)(I=ce.uf(M[s],de,k.row,k.column,k.endRow,k.endColumn,k.rowRelative,k.columnRelative,k.endRowRelative,k.endColumnRelative,t,r)).isFullRow=k.isFullRow,I.isFullColumn=k.isFullColumn,j.Ig(e,t,r,I,de,i);else if(1===n.type){if(!(A=(T=n.source!==ue.BangSource&&n.source||j._source).getCalcSourceModel()))return;if(E=n,R=e.row===pe||e.column===pe,D=E.tf(),d=(N=ce.getRangeForReference(E,t,r)).row,g=N.col,p=d+(b=N.rowCount)-1,m=g+(y=N.colCount)-1,0===D){if(0<=t&&0<=r)if(Q(void 0,void 0,b,y))h=A.ug(!0),R?h.Xoa(d,g,b,y,e,i):h.Jg(d,g,b,y,e,i);else for(S=d;S<=p;S++)for(x=g;x<=m;x++)C=A.qg(S,x,!0),R?C&&C.gmb(3,e,i):C&&C.gmb(0,e,i);else if(0<=t&&-1===r)for(S=d;S<=p;S++)for(x=g;x<=m;x++)E.columnRelative||E.endColumnRelative?(w=A.rg(S,!0))&&w.Kg(e.row,-x,i):(C=A.qg(S,x,!0))&&C.gmb(1,e,i);else if(0<=r&&-1===t)for(S=d;S<=p;S++)for(x=g;x<=m;x++)E.rowRelative||E.endRowRelative?(v=A.sg(x,!0))&&v.Mg(e,-S,i):(C=A.qg(S,x,!0))&&C.gmb(2,e,i)}else if(1===D){if(0<=t&&0<=r)h=A.ug(!0),R?h.Xoa(d,g,b,y,e,i):h.Jg(d,g,b,y,e,i);else if(!(0<=t&&-1===r)&&-1===t&&0<=r&&!E.rowRelative&&!E.endRowRelative)for(d=E.row,p=E.endRow,S=d;S<=p;S++)(w=A.rg(S,!0))&&w.gmb(2,e,i)}else if(2===D)if(0<=t&&0<=r)h=A.ug(!0),R?h.Xoa(d,g,b,y,e,i):h.Jg(d,g,b,y,e,i);else if(!(0<=t&&-1===r)&&-1===t&&0<=r)for(x=g;x<=m;x++)(v=A.sg(x,!0))&&v.gmb(2,e,i)}else if(9===n.type)j.Ig(e,t,r,n.value,o&&9===o.type&&o.value,i),n.value2&&j.Ig(e,t,r,n.value2,o&&9===o.type&&o.value2,i);else if(8===n.type){if(T=n.source||a||j._source,l=H(n.value),(u=T.getCustomName(l))?A=T.getCalcSourceModel():(u=(A=j._service.getGlobalSourceModel()||T.getCalcSourceModel()).getSource().getCustomName(l))||T.getCalcSourceModel().wg(l,!0).gmb(0,e,i),!(c=A.wg(l,!0)))return;c.gmb(0,e,i),u&&j.Ig(e,t,r,u,de,i,A.getSource())}else if(7===n.type){if(F=n.function){if(F.isVolatile()&&(i?j.bg(e):j.Tf(e)),!F.precedentReference())return;F instanceof ue.Functions.AsyncFunction&&(j._service.nia=!0)}for(_=n.arguments.length,s=0;s<_;s++)P=!1,F&&F.isBranch()&&F.findTestArgument()!==s&&e instanceof G&&(n.QDc=!0,n.RDc=n.RDc||[],n.RDc[s]=[],P=!0,e.LDc=e.LDc||[],e.LDc.push(n.RDc[s])),j.Ig(e,t,r,n.arguments[s],o&&7===o.type&&o.arguments[s],i),P&&e.LDc.pop()}else if(25===n.type||26===n.type){if(!(O=(A=(T=(L=n).source||j._source).getCalcSourceModel()).mg(L.value,!0)))return;O.gmb(0,e,i)}else 33===n.type&&((B=n).isReferenceError||(A=(T=B.source||B.contextSource||j._source).getCalcSourceModel(),N=ce.getRangeForReference(B,t,r),(C=A.qg(N.row,N.col,!0))&&C.gmb(0,e,i)))},V.prototype.Og=function(e,t){var r=this.getNodeByName(e);r&&(r.Nf||r.Lf)&&this.Ig(this.mg(e),0,0,r.Nf||r.Lf,r.Lf,t)},V.prototype.Pg=function(e,t,r,n,o){var i,a,s,l,u,c=e+r,h=t+n;for(l=e;l<c;l++)for(u=t;u<h;u++)i=this.Mf(l,u),a=this.Kf(l,u),(i||a)&&((s=this.Qf(l,u))&&!0!==s.isDynamicArray?this.Ig(this.qg(l,u),s.row,s.col,i||a,a,o):this.Ig(this.qg(l,u),l,u,i||a,a,o))},V.prototype.Qg=function(e,t,r){var n,o,i=e+t;for(n=e;-1!==n&&n<i;n++)(o=this.getColumnExpression(n))&&this.Ig(this.sg(n,!1),-1,n,o,o,r)},V.prototype.Rg=function(e,t,r,n){this.Pg(e,t,r,n,!0)},V.prototype.Sg=function(e,t,r,n){this.Pg(e,t,r,n,!1)},V.prototype.Tg=function(e,t){},V.prototype.Ug=function(e,t){},V.prototype.Vg=function(e,t){this.Qg(e,t,!0)},V.prototype.Wg=function(e,t){this.Qg(e,t,!1)},V.prototype.Xg=function(e,t,r,n,o,i,a){var s,l,u,c=e+r,h=t+n;for(s=e;s<c;s++)for(l=t;l<h;l++)(u=this.qg(s,l,!1))&&(this.FTa(a,s,l),o&&u.Yg(),i&&u.Bg())},V.prototype.Zg=function(e,t,r,n,o){var i,a,s,l,u=this.Hf;if(-1!==e&&u)for(i=h(e+t,u.length),a=e;a<i;a++)(s=u[a])&&s.calc&&(this.FTa(o,a,-1),l=s.calc,r&&l.Yg(),n&&l.Bg())},V.prototype.$g=function(e,t,r,n,o){var i,a,s,l,u=this.If;if(-1!==e&&u)for(i=h(e+t,u.length),a=e;a<i;a++)(s=u[a])&&s.calc&&(this.FTa(o,-1,a),l=s.calc,r&&l.Yg(),n&&l.Bg())},V.prototype._g=function(e,t,r,n,o,i,a){var s,l,u,c;(o||i)&&(s=this,l=void 0,a&&(l=s.dUa()),0<=e&&0<=t?(s.Xg(e,t,r,n,o,i,l),s.Zg(e,r,o,i,l),s.$g(t,n,o,i,l),s.vg&&(o&&s.vg.Yg(e,t,r,n),i&&s.vg.Bg(e,t,r,n))):0<=e&&-1===t?(s.Xg(e,0,r,s.cC(),o,i,l),s.Zg(e,r,o,i,l),s.vg&&(o&&s.vg.Yg(e,t,r,n),i&&s.vg.Bg(e,t,r,n))):-1===e&&0<=t?(s.Xg(0,t,s.rC(),n,o,i,l),s.$g(t,n,o,i,l),s.vg&&(o&&s.vg.Yg(e,t,r,n),i&&s.vg.Bg(e,t,r,n))):-1===e&&-1===t&&(u=s.rC(),c=s.cC(),s.Xg(0,0,u,c,o,i,l),s.Zg(0,u,o,i,l),s.$g(0,c,o,i,l),s.vg&&(o&&s.vg.Yg(e,t,r,n),i&&s.vg.Bg(e,t,r,n))))},V.prototype.getAllNodes=function(){var e,t,r,n,o=[],i=this.dataTable,a=this.Hf,s=this.If,l=this.Jf;for(t in l&&o.push(l),a)a.hasOwnProperty(t)&&(e=a[t])&&o.push(e);for(t in s)s.hasOwnProperty(t)&&(e=s[t])&&o.push(e);for(r in i)if(i.hasOwnProperty(r)&&(n=i[r]))for(t in n)n.hasOwnProperty(t)&&(e=n[t])&&o.push(e);return o},V.prototype.toJSON=function(e){g.supportRowColumnFormula?this._source.toJSON(e,this.dataTable,this.Ef,this.Ff,this.If):this._source.toJSON(e,this.dataTable,this.Ef,this.Ff)},p=V,g.CalcSourceModel=p,D(W,x=f),W.prototype.getKey=function(){var e=this.ah;return(null===e?"":e._source.id+",")+this.row+","+this.column},W.prototype.og=function(){this.ah.Rg(this.row,this.column,1,1)},W.prototype.ng=function(){this.ah.Sg(this.row,this.column,1,1)},W.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,0)},W.prototype.fh=function(){this.$l=!0,this.ah.Cf().pg(this,0)},W.prototype.Bg=function(){var e,t,r,n,o,i,a,s,l=this.ah.Cf(),u=this.Ze;for(t=0;t<u.length;t++)if(r=this[u[t]])for(n in r)r.hasOwnProperty(n)&&(!(e=r[n])||e.dh||e.eh||e.fh(),l.calcOnDemand&&e&&!e.$l&&(e.$l=!0,e.Bg()));if((o=this.node&&this.node.Pf)&&o.isDynamicArray)for(i=0;i<o.rowCount;i++)for(a=i;a<o.colCount;a++)0===i&&0===a||(s=this.ah.getNode(i+o.row,a+o.col))&&s.calc&&s.calc.Bg()},W.prototype.y$a=function(){var e,t,r,n,o,i,a,s=this.ah,l=s.getCalcService();l&&l.nia&&((t=(e=this.nia)&&this.z$a)||!I(e)||(r=s.getSource())&&(n=r.getName(),(o=l.lh.asyncManager.y5[n])&&(!(i=o[this.row])||(a=i[this.column])&&((t=a[0])?(this.nia=!0,(this.z$a=t).h_a=this):this.nia=!1))),t&&0===t.evaluateMode&&(t.v5=!1))},G=W,g.CellCalc=G,D(Y,R=f),Y.prototype.getKey=function(){var e=this.ah;return(null===e?"":e._source.id+",")+this.row+",-1"},Y.prototype.og=function(){this.ah.Tg(this.row,1)},Y.prototype.ng=function(){this.ah.Ug(this.row,1)},Y.prototype.Kg=function(e,t,r){var n,o,i;r?(i={row:e,columnOffset:t,columnCount:1},(n=this)[o=c]||(n[o]=[]),n[o].push(i)):function(e,t,r){var n,o=e[t];if(o)for(n=0;n<o.length;n++)if(o[n]===r)return o.splice(n,1)}(this,c,{row:e,columnOffset:t,columnCount:1})},Y.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,1)},Y.prototype.fh=function(){this.$l=!0,this.ah.Cf().pg(this,1)},m=Y,g.RowCalc=m,D(Z,E=f),Z.prototype.getKey=function(){var e=this.ah;return(null===e?"":e._source.id+",")+"-1,"+this.column},Z.prototype.og=function(){this.ah.Vg(this.column,1)},Z.prototype.ng=function(){this.ah.Wg(this.column,1)},Z.prototype.Mg=function(e,t,r){this.gmb(2,e,r)},Z.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,2)},Z.prototype.fh=function(){this.$l=!0,this.ah.Cf().pg(this,2)},b=Z,g.ColumnCalc=b,D(q,A=f),q.prototype.getKey=function(){var e=this.ah;return(null===e?"":e._source.id+",")+this.name},q.prototype.updateListening=function(e,t){var r,n,o,i,a,s,l,u,c=this.Ze;for(o=0;o<c.length;o++)if(i=this[c[o]]){for(s in a=[],i)i.hasOwnProperty(s)&&(r=i[s])&&a.push(r);for(l=a.length,u=0;u<l;u++)n=(r=a[u]).node,r.ng(),n&&(!n.Pf||n.Pf.row===r.row&&n.Pf.col===r.column)&&r.ah.fg(r.row,r.column,n.Lf,n.Pf,!0)}},q.prototype.updateListeningOnRemoved=function(){var e,t,r,n,o,i,a,s,l,u,c=this.Ze,h=this.ah,f=h.Cf();for(i=0;i<c.length;i++)if(a=this[c[i]])for(s in a)a.hasOwnProperty(s)&&(e=a[s])&&(t=e.ah,r=e.row,n=e.col,r=r===pe?-1:r,n=n===pe?-1:n,o=t.Kf(r,n),l=t.Qf(r,n),o&&(u=f.ih().adjustFormulaOnRemoveName(h,o,this.name))!==o&&t.fg(r,n,u,l,!0))},q.prototype.fh=function(){var e,t,r,n,o=this.Ze;for(t=0;t<o.length;t++)if(r=this[o[t]])for(n in r)r.hasOwnProperty(n)&&(e=r[n])&&e.fh()},y=q,g.NameCalc=y,D(z,T=f),z.prototype.processListener=function(e,t,r,n,o,i,a){var s,l,u,c=this[e],h=t+","+r+","+n+","+o;if(3!==e||i instanceof d){if(i.LDc&&1<=i.LDc.length&&((u=i.LDc)[u.length-1].push(this),h="?"+h),c||(this.Ze.push(e),this[e]=c={}),!(s=c[h])){if(!a)return;(s=c[h]=[]).row=t,s.col=r,s.rowCount=n,s.colCount=o}if(a){for(l=0;l<s.length;l++)if(s[l]===i)return;s.push(i)}else{for(l=0;l<s.length;l++)s[l]===i&&s.splice(l,1);s.length<1&&delete c[h]}this.clearListenersCache()}},z.prototype.Jg=function(e,t,r,n,o,i){this.processListener(0,e,t,r,n,o,i)},z.prototype.Xoa=function(e,t,r,n,o,i){this.processListener(3,e,t,r,n,o,i)},z.prototype.Yg=function(e,t,r,n){this.visit(0,e,t,r,n)},z.prototype.clearListenersCache=function(){var e,t=this.Ze;for(e=0;e<t.length;e++)delete this[t[e]+"cached"]},z.prototype.getListeners=function(e,t){var r,n,o,i,a=e[t],s=this[a];if(s&&!(r=this[n=a+"cached"]))for(o in r=this[n]=[],s)s.hasOwnProperty(o)&&(i=s[o])&&r.push(i);return r},z.prototype.visit=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y=this.Ze;for(a=0;a<y.length;a++)if(this[y[a]])for(s=this.getListeners(y,a),l=0;l<s.length;l++)if(c=(u=s[l]).row,h=u.col,f=u.rowCount,d=u.colCount,(-1===c||-1===t||c<t+n&&t<c+f)&&(-1===h||-1===r||h<r+o&&r<h+d))for(p=u.length,g=0;g<p;g++)if(i=u[g],0===e){if(b=(m=this.ah.getSource()).getRangeKey&&m.getRangeKey(m,u),i._indirectRanges&&i._indirectRanges[b]){i.fh();continue}i.bh()}else i.fh()},z.prototype.Bg=function(e,t,r,n){this.visit(1,e,t,r,n)},z.prototype.gh=function(e,t,r){var n,o,i,a,s,l,u=this.Ze,c=r?1:-1;for(n=0;n<u.length;n++)if(this[u[n]])for(o=this.getListeners(u,n),i=0;i<o.length;i++)if((a=o[i])&&(-1===a.row||a.row<=e&&e<a.row+a.rowCount)&&(-1===a.col||a.col<=t&&t<a.col+a.colCount))for(s=a.length,l=0;l<s;l++)a[l].delay+=c},z.prototype.og=function(){},z.prototype.ng=function(){},C=z,g.RangeCalc=C,g.Mh=X,g._createCellIdentity=Te,g.qf=J},"./src/calcEngine.res.en.ts":function(e,t,r){"use strict";function n(e,t){return{description:e,parameters:t}}function o(e,t){return{name:e,repeatable:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFromulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",_h:{ABS:n("This function calculates the absolute value of the specified value.",[o("value")]),ACCRINT:n("This function calculates the accrued interest for a security that pays periodic interest.",[o("issue"),o("first"),o("settle"),o("rate"),o("par"),o("frequency"),o("basis")]),ACCRINTM:n("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[o("issue"),o("maturity"),o("rate"),o("par"),o("basis")]),ACOS:n("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[o("value")]),ACOSH:n("This function calculates the inverse hyperbolic cosine of the specified value.",[o("value")]),ADDRESS:n("This function uses the row and column numbers to create a cell address in text.",[o("row"),o("column"),o("absnum"),o("a1style"),o("sheettext")]),AGGREGATE:n("This function aggregate a list of numbers using a specified built-in function.",[o("functioncode"),o("option"),o("value1"),o("value2",!0)]),AMORDEGRC:n("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[o("cost"),o("datepurchased"),o("firstperiod"),o("salvage"),o("period"),o("drate"),o("basis")]),AMORLINC:n("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[o("cost"),o("datepurchased"),o("firstperiod"),o("salvage"),o("period"),o("drate"),o("basis")]),AND:n("Check whether all arguments are True, and returns True if all arguments are True.",[o("logical1"),o("logical2")]),ASIN:n("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[o("value")]),ASINH:n("This function calculates the inverse hyperbolic sine of a number.",[o("value")]),ATAN:n("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[o("value")]),ATAN2:n("This function calculates the arctangent of the specified x- and y-coordinates.",[o("x"),o("y")]),ATANH:n("This function calculates the inverse hyperbolic tangent of a number.",[o("value")]),AVEDEV:n("This function calculates the average of the absolute deviations of the specified values from their mean.",[o("value1"),o("value2",!0)]),AVERAGE:n("This function calculates the average of the specified numeric values.",[o("value1"),o("value2",!0)]),AVERAGEA:n("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[o("value1"),o("value2",!0)]),AVERAGEIF:n("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[o("value1"),o("value2",!0),o("condition")]),AVERAGEIFS:n("This function calculates the average of all cells that meet multiple specified criteria.",[o("value1"),o("condition1"),o("value2",!0),o("condition2",!0)]),BESSELI:n("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[o("value"),o("order")]),BESSELJ:n("This function calculates the Bessel function of the first kind.",[o("value"),o("order")]),BESSELK:n("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[o("value"),o("order")]),BESSELY:n("This function calculates the Bessel function of the second kind.",[o("value"),o("order")]),BETADIST:n("This function calculates the cumulative beta distribution function.",[o("x"),o("alpha"),o("beta"),o("lower"),o("upper")]),BETAINV:n("This function calculates the inverse of the cumulative beta distribution function.",[o("prob"),o("alpha"),o("beta"),o("lower"),o("upper")]),BIN2DEC:n("This function converts a binary number to a decimal number",[o("number")]),BIN2HEX:n("This function converts a binary number to a hexadecimal number.",[o("number"),o("places")]),BIN2OCT:n("This function converts a binary number to an octal number.",[o("number"),o("places")]),BINOMDIST:n("This function calculates the individual term binomial distribution probability.",[o("x"),o("n"),o("p"),o("cumulative")]),CEILING:n("This function rounds a number up to the nearest multiple of a specified value.",[o("value"),o("signif")]),CHAR:n("This function returns the character specified by a number.",[o("value")]),CHIDIST:n("This function calculates the one-tailed probability of the chi-squared distribution.",[o("value"),o("deg")]),CHIINV:n("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[o("prob"),o("deg")]),CHITEST:n("This function calculates the test for independence from the chi-squared distribution.",[o("obs_array"),o("exp_array")]),CHOOSE:n("This function returns a value from a list of values.",[o("index"),o("value1"),o("value2",!0)]),CLEAN:n("This function removes all non-printable characters from text.",[o("text")]),CODE:n("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[o("text")]),COLUMN:n("This function returns the column number of a reference.",[o("reference")]),COLUMNS:n("This function returns the number of columns in an array.",[o("array")]),COMBIN:n("This function calculates the number of possible combinations for a specified number of items.",[o("k"),o("n")]),COMPLEX:n("This function converts real and imaginary coefficients into a complex number.",[o("realcoeff"),o("imagcoeff"),o("suffix")]),CONCATENATE:n("This function combines multiple text strings or numbers into one text string.",[o("text1"),o("text2",!0)]),CONFIDENCE:n("This function returns confidence interval for a population mean.",[o("alpha"),o("stdev"),o("size")]),CONVERT:n("This function converts a number from one measurement system to its equivalent in another measurement system.",[o("number"),o("from-unit"),o("to-unit")]),CORREL:n("This function returns the correlation coefficient of the two sets of data.",[o("array1"),o("array2")]),COS:n("This function returns the cosine of the specified angle.",[o("angle")]),COSH:n("This function returns the hyperbolic cosine of the specified value.",[o("value")]),COUNT:n("This function returns the number of cells that contain numbers.",[o("value1"),o("value2",!0)]),COUNTA:n("This function returns the number of number of cells that contain numbers, text, or logical values.",[o("value1"),o("value2",!0)]),COUNTBLANK:n("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[o("cellrange")]),COUNTIF:n("This function returns the number of cells that meet a certain condition",[o("cellrange"),o("condition")]),COUNTIFS:n("This function returns the number of cells that meet multiple conditions.",[o("cellrange"),o("condition")]),COUPDAYBS:n("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[o("settlement"),o("maturity"),o("frequency"),o("basis")]),COUPDAYS:n("This function returns the number of days in the coupon period that contains the settlement date.",[o("settlement"),o("maturity"),o("frequency"),o("basis")]),COUPDAYSNC:n("This function calculates the number of days from the settlement date to the next coupon date.",[o("settlement"),o("maturity"),o("frequency"),o("basis")]),COUPNCD:n("This function returns a date number of the next coupon date after the settlement date.",[o("settlement"),o("maturity"),o("frequency"),o("basi")]),COUPNUM:n("This function returns the number of coupons due between the settlement date and maturity date.",[o("settlement"),o("maturity"),o("frequency"),o("basis")]),COUPPCD:n("This function returns a date number of the previous coupon date before the settlement date.",[o("settlement"),o("maturity"),o("frequency"),o("basis")]),COVAR:n("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[o("array1"),o("array2")]),CRITBINOM:n("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[o("n"),o("p"),o("alpha")]),CUMIPMT:n("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[o("rate"),o("nper"),o("pval"),o("startperiod"),o("endperiod"),o("paytype")]),CUMPRINC:n("This function returns the cumulative principal paid on a loan between the start and end periods.",[o("rate"),o("nper"),o("pval"),o("startperiod"),o("endperiod"),o("paytype")]),DATE:n("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[o("year"),o("month"),o("day")]),DATEDIF:n("This function returns the number of days, months, or years between two dates.",[o("date1"),o("date2"),o("outputcode")]),DATEVALUE:n("This function returns a DateTime object of the specified date.",[o("date_string")]),DAVERAGE:n("This function calculates the average of values in a column of a list or database that match the specified conditions.",[o("database"),o("field"),o("criteria")]),DAY:n("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[o("date")]),DAYS360:n("This function returns the number of days between two dates based on a 360-day year.",[o("startdate"),o("enddate"),o("method")]),DB:n("This function calculates the depreciation of an asset for a specified period using the fixeddeclining balance method",[o("cost"),o("salvage"),o("life"),o("period"),o("month")]),DCOUNT:n("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[o("database"),o("field"),o("criteria")]),DCOUNTA:n("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[o("database"),o("field"),o("criteria")]),DDB:n("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[o("cost"),o("salvage"),o("life"),o("period"),o("factor")]),DEC2BIN:n("This function converts a decimal number to a binary number.",[o("number"),o("places")]),DEC2HEX:n("This function converts a decimal number to a hexadecimal number",[o("number"),o("places")]),DEC2OCT:n("This function converts a decimal number to an octal number",[o("number"),o("places")]),DEGREES:n("This function converts the specified value from radians to degrees",[o("angle")]),DELTA:n("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[o("value1"),o("value2")]),DEVSQ:n("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[o("value1"),o("value2",!0)]),DGET:n("This function extracts a single value from a column of a list or database that matches the specified conditions.",[o("database"),o("field"),o("criteria")]),DISC:n("This function calculates the discount rate for a security.",[o("settle"),o("mature"),o("pricep"),o("redeem"),o("basis")]),DMAX:n("This function returns the largest number in a column of a list or database that matches the specified conditions.",[o("database"),o("field"),o("criteria")]),DMIN:n("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[o("database"),o("field"),o("criteria")]),DOLLAR:n("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[o("value"),o("digits")]),DOLLARDE:n("This function converts a fraction dollar price to a decimal dollar price.",[o("fractionaldollar"),o("fraction")]),DOLLARFR:n("This function converts a decimal number dollar price to a fraction dollar price.",[o("decimaldollar"),o("fraction")]),DPRODUCT:n("This function multiplies the values in a column of a list or database that match the specified conditions.",[o("database"),o("field"),o("criteria")]),DSTDEV:n("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[o("database"),o("field"),o("criteria")]),DSTDEVP:n("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[o("database"),o("field"),o("criteria")]),DSUM:n("This function adds the numbers in a column of a list or database that match the specified conditions.",[o("database"),o("field"),o("criteria")]),DURATION:n("This function returns the Macaulay duration for an assumed par value of $100.",[o("settlement"),o("maturity"),o("coupon"),o("yield"),o("frequency"),o("basis")]),DVAR:n("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[o("database"),o("field"),o("criteria")]),DVARP:n("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[o("database"),o("field"),o("criteria")]),EDATE:n("This function calculates the date that is the indicated number of months before or after a specified date.",[o("startdate"),o("months")]),EFFECT:n("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[o("nomrate"),o("comper")]),EOMONTH:n("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[o("startdate"),o("months")]),ERF:n("This function calculates the error function integrated between a lower and an upper limit.",[o("limit"),o("upperlimit")]),ERFC:n("This function calculates the complementary error function integrated between a lower limit and infinity.",[o("lowerlimit")]),"ERROR.TYPE":n("This function returns a number corresponding to one of the error values.",[o("errorvalue")]),EURO:n("This function returns the equivalent of one Euro based on the ISO currency code.",[o("code")]),EUROCONVERT:n("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[o("currency"),o("source"),o("target"),o("fullprecision"),o("triangulation")]),EVEN:n("This function rounds the specified value up to the nearest even integer.",[o("value")]),EXACT:n("This function returns true if two strings are the same; otherwise, false.",[o("text1"),o("text2")]),EXP:n("This function returns e raised to the power of the specified value.",[o("value")]),EXPONDIST:n("This function returns the exponential distribution or the probability density.",[o("value"),o("lambda"),o("cumulative")]),FACT:n("This function calculates the factorial of the specified number.",[o("number")]),FACTDOUBLE:n("This function calculates the double factorial of the specified number.",[o("number")]),FALSE:n("This function returns the value for logical FALSE.",[]),FDIST:n("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[o("value"),o("degnum"),o("degden")]),FIND:n("This function finds one text value within another and returns the text values position in the text you searched.",[o("findtext"),o("intext"),o("start")]),FINV:n("This function returns the inverse of the F probability distribution.",[o("p"),o("degnum"),o("degden")]),FISHER:n("This function returns the Fisher transformation for a specified value.",[o("value")]),FISHERINV:n("This function returns the inverse of the Fisher transformation for a specified value.",[o("value")]),FIXED:n("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[o("num"),o("digits"),o("notcomma")]),FLOOR:n("This function rounds a number down to the nearest multiple of a specified value.",[o("value"),o("signif")]),FORECAST:n("This function calculates a future value using existing values.",[o("value"),o("Yarray"),o("Xarray")]),FREQUENCY:n("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[o("dataarray"),o("binarray")]),FTEST:n("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[o("array1"),o("array2")]),FV:n("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[o("rate"),o("numper"),o("paymt"),o("pval"),o("type")]),FVSCHEDULE:n("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[o("principal"),o("schedule")]),GAMMADIST:n("This function returns the gamma distribution.",[o("x"),o("alpha"),o("beta"),o("cumulative")]),GAMMAINV:n("This function returns the inverse of the gamma cumulative distribution.",[o("p"),o("alpha"),o("beta")]),GAMMALN:n("This function returns the natural logarithm of the Gamma function, G(x).",[o("value")]),GCD:n("This function returns the greatest common divisor of two numbers.",[o("number1"),o("number2")]),GEOMEAN:n("This function returns the geometric mean of a set of positive data.",[o("value1"),o("value2",!0)]),GESTEP:n("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[o("number"),o("step")]),GROWTH:n("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[o("y"),o("x"),o("newx"),o("constant")]),HARMEAN:n("This function returns the harmonic mean of a data set.",[o("value1"),o("value2",!0)]),HEX2BIN:n("This function converts a hexadecimal number to a binary number.",[o("number"),o("places")]),HEX2DEC:n("This function converts a hexadecimal number to a decimal number.",[o("number")]),HEX2OCT:n("This function converts a hexadecimal number to an octal number.",[o("number"),o("places")]),HLOOKUP:n("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[o("value"),o("array"),o("row"),o("approx")]),HOUR:n("This function returns the hour that corresponds to a specified time.",[o("time")]),HYPGEOMDIST:n("This function returns the hypergeometric distribution.",[o("x"),o("n"),o("M"),o("N")]),IF:n("This function performs a comparison and returns one of two provided values based on that comparison.",[o("valueTest"),o("valueTrue"),o("valueFalse")]),IFERROR:n("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[o("value"),o("error")]),IMABS:n("This function returns the absolute value or modulus of a complex number.",[o("complexnum")]),IMAGINARY:n("This function returns the imaginary coefficient of a complex number.",[o("complexnum")]),IMARGUMENT:n("This function returns the argument theta, which is an angle expressed in radians.",[o("complexnum")]),IMCONJUGATE:n("This function returns the complex conjugate of a complex number.",[o("complexnum")]),IMCOS:n("This function returns the cosine of a complex number.",[o("complexnum")]),IMDIV:n("This function returns the quotient of two complex numbers.",[o("complexnum"),o("complexdenom")]),IMEXP:n("This function returns the exponential of a complex number.",[o("complexnum")]),IMLN:n("This function returns the natural logarithm of a complex number.",[o("complexnum")]),IMLOG2:n("This function returns the base-2 logarithm of a complex number.",[o("complexnum")]),IMLOG10:n("This function returns the common logarithm of a complex number.",[o("complexnum")]),IMPOWER:n("This function returns a complex number raised to a power.",[o("complexnum"),o("powernum")]),IMPRODUCT:n("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[o("complexnum1"),o("complexnum2",!0)]),IMREAL:n("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[o("complexnum")]),IMSIN:n("This function returns the sine of a complex number in the x+yi or x+yj text format.",[o("complexnum")]),IMSQRT:n("This function returns the square root of a complex number in the x+yi or x+yj text format.",[o("complexnum")]),IMSUB:n("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[o("complexnum1"),o("complexnum2")]),IMSUM:n("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[o("complexnum1"),o("complexnum2",!0)]),INDEX:n("This function returns a value or the reference to a value from within an array or range.",[o("return"),o("row"),o("col"),o("area")]),INDIRECT:n("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[o("ref_text"),o("a1_style")]),INT:n("This function rounds a specified number down to the nearest integer.",[o("value")]),INTERCEPT:n("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[o("dependent"),o("independent")]),INTRATE:n("This function calculates the interest rate for a fully invested security.",[o("settle"),o("mature"),o("invest"),o("redeem"),o("basis")]),IPMT:n("This function calculates the payment of interest on a loan.",[o("rate"),o("per"),o("nper"),o("pval"),o("fval"),o("type")]),IRR:n("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[o("arrayvals"),o("estimate")]),ISBLANK:n("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[o("cellreference")]),ISERR:n("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[o("cellreference")]),ISERROR:n("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[o("cellreference")]),ISEVEN:n("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[o("cellreference")]),ISLOGICAL:n("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[o("cellreference")]),ISNA:n("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[o("cellreference")]),ISNONTEXT:n("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[o("cellreference")]),ISNUMBER:n("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[o("cellreference")]),ISODD:n("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[o("cellreference")]),ISPMT:n("This function calculates the interest paid during a specific period of an investment.",[o("rate"),o("per"),o("nper"),o("pv")]),ISREF:n("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[o("cellreference")]),ISTEXT:n("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[o("cellreference")]),KURT:n("This function returns the kurtosis of a data set.",[o("value1"),o("value2"),o("value3"),o("value4",!0)]),LARGE:n("This function returns the nth largest value in a data set, where n is specified.",[o("array"),o("n")]),LCM:n("This function returns the least common multiple of two numbers.",[o("number1"),o("number2")]),LEFT:n("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[o("mytext"),o("num_chars")]),LEN:n("This function returns the length of the number of characters in a text string.",[o("value")]),LINEST:n("This function calculates the statistics for a line.",[o("y"),o("x"),o("constant"),o("stats")]),LN:n("This function returns the natural logarithm of the specified number.",[o("value")]),LOG:n("This function returns the logarithm base Y of a number X.",[o("number"),o("base")]),LOG10:n("This function returns the logarithm base 10 of the number given.",[o("value")]),LOGEST:n("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[o("y"),o("x"),o("constant"),o("stats")]),LOGINV:n("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[o("prob"),o("mean"),o("stdev")]),LOGNORMDIST:n("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[o("x"),o("mean"),o("stdev")]),LOOKUP:n("This function searches for a value and returns a value from the same location in a second area.",[o("lookupvalue"),o("lookupvector"),o("resultvector")]),LOWER:n("This function converts text to lower case letters.",[o("string")]),MATCH:n("This function returns the relative position of a specified item in a range.",[o("value1"),o("array"),o("type")]),XMATCH:n("This function returns the relative position of an item in an array. By default, an exact match is required.",[o("lookup_value"),o("lookup_array"),o("[match_mode]"),o("[search_mode]")]),XLOOKUP:n("This function searches a range or an array for a match and returns the corresponding item from a second range or array. By default, an exact match is used.",[o("lookup_value"),o("lookup_array"),o("return_array"),o("[if_not_found]"),o("[match_mode]"),o("[search_mode]")]),MAX:n("This function returns the maximum value, the greatest value, of all the values in the arguments.",[o("value1"),o("value2",!0)]),MAXA:n("This function returns the largest value in a list of arguments, including text and logical values.",[o("value1"),o("value2",!0)]),MDETERM:n("This function returns the matrix determinant of an array.",[o("array")]),MDURATION:n("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[o("settlement"),o("maturity"),o("coupon"),o("yield"),o("frequency"),o("basis")]),MEDIAN:n("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[o("value1"),o("value2",!0)]),MID:n("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[o("text"),o("start_num"),o("num_chars")]),MIN:n("This function returns the minimum value, the least value, of all the values in the arguments.",[o("value1"),o("value2",!0)]),MINA:n("This function returns the minimum value in a list of arguments, including text and logical values.",[o("value1"),o("value2",!0)]),MINUTE:n("This function returns the minute corresponding to a specified time.",[o("time")]),MINVERSE:n("This function returns the inverse matrix for the matrix stored in an array.",[o("array")]),MIRR:n("This function returns the modified internal rate of return for a series of periodic cash flows.",[o("arrayvals"),o("payment_int"),o("income_int")]),MMULT:n("This function returns the matrix product for two arrays.",[o("array1"),o("array2")]),MOD:n("This function returns the remainder of a division operation.",[o("dividend"),o("divisor")]),MODE:n("This function returns the most frequently occurring value in a set of data.",[o("value1"),o("value2",!0)]),MONTH:n("This function returns the month corresponding to the specified date value.",[o("date")]),MROUND:n("This function returns a number rounded to the desired multiple.",[o("number"),o("multiple")]),MULTINOMIAL:n("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[o("value1"),o("value2",!0)]),MUNIT:n("The function returns the unit matrix for the specified dimension.",[o("dimension")]),N:n("This function returns a value converted to a number.",[o("value")]),NA:n("This function returns the error value #N/A that means not available.",[]),NEGBINOMDIST:n("This function returns the negative binomial distribution.",[o("x"),o("r"),o("p")]),NETWORKDAYS:n("This function returns the total number of complete working days between the start and end dates.",[o("startdate"),o("enddate"),o("holidays")]),NOMINAL:n("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[o("effrate"),o("comper")]),NORMDIST:n("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[o("x"),o("mean"),o("stdev"),o("cumulative")]),NORMINV:n("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[o("prob"),o("mean"),o("stdev")]),NORMSDIST:n("This function returns the standard normal cumulative distribution function.",[o("value")]),NORMSINV:n("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[o("prob")]),NOT:n("This function reverses the logical value of its argument.",[o("value")]),NOW:n("This function returns the current date and time.",[]),NPER:n("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[o("rate"),o("paymt"),o("pval"),o("fval"),o("type")]),NPV:n("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[o("discount"),o("value1"),o("value2",!0)]),OBJECT:n("This function converts the property/expression sequence to an object.",[o("property1|properties_range1"),o("expression1|expressions_range1"),o("property2|properties_range2"),o("expression2|expressions_range2"),o("...")]),OCT2BIN:n("This function converts an octal number to a binary number.",[o("number"),o("places")]),OCT2DEC:n("This function converts an octal number to a decimal number.",[o("number")]),OCT2HEX:n("This function converts an octal number to a hexadecimal number.",[o("number"),o("places")]),ODD:n("This function rounds the specified value up to the nearest odd integer.",[o("value")]),ODDFPRICE:n("This function calculates the price per $100 face value of a security with an odd first period.",[o("settle"),o("maturity"),o("issue"),o("first"),o("rate"),o("yield"),o("redeem"),o("freq"),o("basis")]),ODDFYIELD:n("This function calculates the yield of a security with an odd first period.",[o("settle"),o("maturity"),o("issue"),o("first"),o("rate"),o("price"),o("redeem"),o("freq"),o("basis")]),ODDLPRICE:n("This function calculates the price per $100 face value of a security with an odd last coupon period.",[o("settle"),o("maturity"),o("last"),o("rate"),o("yield"),o("redeem"),o("freq"),o("basis")]),ODDLYIELD:n("This function calculates the yield of a security with an odd last period.",[o("settle"),o("maturity"),o("last"),o("rate"),o("price"),o("redeem"),o("freq"),o("basis")]),OFFSET:n("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[o("reference"),o("rows"),o("cols"),o("height"),o("width")]),OR:n("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[o("argument1"),o("argument2",!0)]),PEARSON:n("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[o("array_ind"),o("array_dep")]),PERCENTILE:n("This function returns the nth percentile of values in a range.",[o("array"),o("n")]),PERCENTRANK:n("This function returns the rank of a value in a data set as a percentage of the data set.",[o("array"),o("n"),o("sigdig")]),PERMUT:n("This function returns the number of possible permutations for a specified number of items.",[o("k"),o("n")]),PI:n("This function returns PI as 3.1415926536.",[]),PMT:n("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[o("rate"),o("nper"),o("pval"),o("fval"),o("type")]),POISSON:n("This function returns the Poisson distribution.",[o("nevents"),o("mean"),o("cumulative")]),POWER:n("This function raises the specified number to the specified power.",[o("number"),o("power")]),PPMT:n("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[o("rate"),o("per"),o("nper"),o("pval"),o("fval"),o("type")]),PRICE:n("This function calculates the price per $100 face value of a periodic interest security",[o("settlement"),o("maturity"),o("rate"),o("yield"),o("redeem"),o("frequency"),o("basis")]),PRICEDISC:n("This function returns the price per $100 face value of a discounted security.",[o("settle"),o("mature"),o("discount"),o("redeem"),o("basis")]),PRICEMAT:n("This function returns the price at maturity per $100 face value of a security that pays interest.",[o("settle"),o("mature"),o("issue"),o("rate"),o("yield"),o("basis")]),PROB:n("This function returns the probability that values in a range are between two limits.",[o("array"),o("probs"),o("lower"),o("upper")]),PRODUCT:n("This function multiplies all the arguments and returns the product.",[o("value1"),o("value2",!0)]),PROPER:n("This function capitalizes the first letter in each word of a text string.",[o("text")]),PROPERTY:n("This function returns the value of property path in object.",[o("data_expression"),o("property_path")]),PV:n("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[o("rate"),o("numper"),o("paymt"),o("fval"),o("type")]),QUARTILE:n("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[o("array"),o("quart")]),QUOTIENT:n("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[o("numerator"),o("denominator")]),RADIANS:n("This function converts the specified number from degrees to radians.",[o("value")]),RAND:n("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:n("This function returns a random number between the numbers you specify.",[o("lower"),o("upper")]),RANGEBLOCKSPARKLINE:n("This function returns a rangetemplate.",[o("template_range"),o("data_expression")]),RANK:n("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[o("number"),o("array"),o("order")]),RATE:n("This function returns the interest rate per period of an annuity.",[o("nper"),o("pmt"),o("pval"),o("fval"),o("type"),o("guess")]),RECEIVED:n("This function returns the amount received at maturity for a fully invested security.",[o("settle"),o("mature"),o("invest"),o("discount"),o("basis")]),REPLACE:n("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[o("old_text"),o("start_char"),o("num_chars"),o("new_text")]),REPT:n("This function repeats text a specified number of times.",[o("text"),o("number")]),RIGHT:n("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[o("text"),o("num_chars")]),ROMAN:n("This function converts an Arabic numeral to a Roman numeral text equivalent.",[o("number"),o("style")]),ROUND:n("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[o("value"),o("places")]),ROUNDDOWN:n("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[o("value"),o("places")]),ROUNDUP:n("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[o("value"),o("places")]),ROW:n("This function returns the number of a row from a reference.",[o("reference")]),ROWS:n("This function returns the number of rows in an array.",[o("array")]),RSQ:n("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[o("array_dep"),o("array_ind")]),SEARCH:n("This function finds one text string in another text string and returns the index of the starting position of the found text.",[o("string1"),o("string2")]),SECOND:n("This function returns the seconds (0 to 59) value for a specified time.",[o("time")]),SERIESSUM:n("This function returns the sum of a power series.",[o("x"),o("n"),o("m"),o("coeff")]),SIGN:n("This function returns the sign of a number or expression.",[o("cellreference")]),SIN:n("This function returns the sine of the specified angle.",[o("angle")]),SINH:n("This function returns the hyperbolic sine of the specified number.",[o("value")]),SKEW:n("This function returns the skewness of a distribution.",[o("number1"),o("number2",!0)]),SLN:n("This function returns the straight-line depreciation of an asset for one period.",[o("cost"),o("salvage"),o("life")]),SLOPE:n("This function calculates the slope of a linear regression.",[o("array_dep"),o("array_ind")]),SMALL:n("This function returns the nth smallest value in a data set, where n is specified.",[o("array"),o("n")]),SQRT:n("This function returns the positive square root of the specified number.",[o("value")]),SQRTPI:n("This function returns the positive square root of a multiple of pi (p).",[o("multiple")]),STANDARDIZE:n("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[o("x"),o("mean"),o("stdev")]),STDEVA:n("This function returns the standard deviation for a set of numbers, text, or logical values.",[o("value1"),o("value2",!0)]),STDEVP:n("This function returns the standard deviation for an entire specified population (of numeric values).",[o("value1"),o("value2",!0)]),STDEVPA:n("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[o("value1"),o("value2",!0)]),STEYX:n("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[o("array_dep"),o("array_ind")]),SUBSTITUTE:n("This function substitutes a new string for specified characters in an existing string.",[o("text"),o("old_piece"),o("new_piece"),o("instance")]),SUBTOTAL:n("This function calculates a subtotal of a list of numbers using a specified built-in function.",[o("functioncode"),o("value1"),o("value2",!0)]),SUM:n("This function returns the sum of cells or range of cells.",[o("value1"),o("value2",!0)]),SUMIF:n("This function adds the cells using a given criteria.",[o("array"),o("condition"),o("sumrange")]),SUMIFS:n("This function adds the cells in a range using multiple criteria.",[o("array"),o("conditionarray"),o("condition",!0)]),SUMPRODUCT:n("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[o("array1"),o("array2",!0)]),SUMSQ:n("This function returns the sum of the squares of the arguments.",[o("value1"),o("value2",!0)]),SUMX2MY2:n("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[o("array_x"),o("array_y")]),SUMX2PY2:n("This function returns the sum of the sum of squares of corresponding values in two arrays.",[o("array_x"),o("array_y")]),SUMXMY2:n("This function returns the sum of the square of the differences of corresponding values in two arrays.",[o("array_x"),o("array_y")]),SYD:n("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[o("cost"),o("salvage"),o("life"),o("period")]),T:n("This function returns the text in a specified cell.",[o("value")]),TAN:n("This function returns the tangent of the specified angle.",[o("angle")]),TANH:n("This function returns the hyperbolic tangent of the specified number.",[o("value")]),TBILLEQ:n("This function returns the equivalent yield for a Treasury bill (or T-bill)",[o("settle"),o("mature"),o("discount")]),TBILLPRICE:n("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[o("settle"),o("mature"),o("discount")]),TBILLYIELD:n("This function returns the yield for a Treasury bill (or T-bill).",[o("settle"),o("mature"),o("priceper")]),TDIST:n("This function returns the probability for the t-distribution.",[o("x"),o("deg"),o("tails")]),TEXT:n("This function formats a number and converts it to text.",[o("value"),o("text")]),TIME:n("This function returns the TimeSpan object for a specified time.",[o("hour"),o("minutes"),o("seconds")]),TIMEVALUE:n("This function returns the TimeSpan object of the time represented by a text string.",[o("time_string")]),TINV:n("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[o("prog"),o("deg")]),TODAY:n("This function returns the date and time of the current date.",[]),TRANSPOSE:n("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[o("array")]),TREND:n("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[o("y"),o("x"),o("newx"),o("constant")]),TRIM:n("This function removes extra spaces from a string and leaves single spaces between words.",[o("text")]),TRIMMEAN:n("This function returns the mean of a subset of data excluding the top and bottom data.",[o("array"),o("percent")]),TRUE:n("This function returns the value for logical TRUE.",[]),TRUNC:n("This function removes the specified fractional part of the specified number.",[o("value"),o("precision")]),TTEST:n("This function returns the probability associated with a t-test.",[o("array1"),o("array2"),o("tails"),o("type")]),TYPE:n("This function returns the type of value.",[o("value")]),UPPER:n("This function converts text to uppercase letters.",[o("string")]),VALUE:n("This function converts a text string that is a number to a numeric value.",[o("text")]),VAR:n("This function returns the variance based on a sample of a population, which uses only numeric values.",[o("value1"),o("value2",!0)]),VARA:n("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[o("value1"),o("value2",!0)]),VARP:n("This function returns variance based on the entire population, which uses only numeric values.",[o("value1"),o("value2",!0)]),VARPA:n("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[o("value1"),o("value2",!0)]),VDB:n("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[o("cost"),o("salvage"),o("life"),o("start"),o("end"),o("factor"),o("switchnot")]),VLOOKUP:n("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[o("value"),o("array"),o("colindex"),o("approx")]),WEEKDAY:n("This function returns the number corresponding to the day of the week for a specified date.",[o("date"),o("type")]),WEEKNUM:n("This function returns a number that indicates the week of the year numerically.",[o("date"),o("weektype")]),WEIBULL:n("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[o("x"),o("alpha"),o("beta"),o("cumulative")]),WORKDAY:n("This function returns the number of working days before or after the starting date.",[o("startdate"),o("numdays"),o("holidays")]),XIRR:n("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[o("values"),o("dates"),o("guess")]),XNPV:n("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[o("rate"),o("values"),o("dates")]),YEAR:n("This function returns the year as an integer for a specified date.",[o("date")]),YEARFRAC:n("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[o("startdate"),o("enddate"),o("basis")]),YIELD:n("This function calculates the yield on a security that pays periodic interest.",[o("settle"),o("maturity"),o("rate"),o("price"),o("redeem"),o("frequency"),o("basis")]),YIELDDISC:n("This function calculates the annual yield for a discounted security.",[o("settle"),o("maturity"),o("price"),o("redeem"),o("basis")]),YIELDMAT:n("This function calculates the annual yield of a security that pays interest at maturity.",[o("settle"),o("maturity"),o("issue"),o("issrate"),o("price"),o("basis")]),ZTEST:n("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[o("array"),o("x"),o("sigma")]),HBARSPARKLINE:n("This function returns a data set used for representing a Hbar sparkline",[o("value"),o("colorScheme"),o("axisVisible"),o("barHeight")]),VBARSPARKLINE:n("This function returns a data set used for representing a Vbar sparkline",[o("value"),o("colorScheme"),o("axisVisible"),o("barWidth")]),VARISPARKLINE:n("This function returns a data set used for representing a variance sparkline",[o("variance"),o("reference"),o("mini"),o("maxi"),o("mark"),o("tickunit"),o("legend"),o("colorPositive"),o("colorNegative"),o("vertical")]),PIESPARKLINE:n("This function returns a data set used for representing a pie sparkline",[o("range|percentage"),o("color",!0)]),AREASPARKLINE:n("This function returns a data set used for representing a area sparkline",[o("points"),o("mini"),o("maxi"),o("line1"),o("line2"),o("colorPositive"),o("colorNegative")]),SCATTERSPARKLINE:n("This function returns a data set used for representing a scatter sparkline",[o("points1"),o("points2"),o("minX"),o("maxX"),o("minY"),o("maxY"),o("hLine"),o("vLine"),o("xMinZone"),o("xMaxZone"),o("yMinZone"),o("yMaxZone"),o("tags"),o("drawSymbol"),o("drawLines"),o("color1"),o("color2"),o("dash")]),LINESPARKLINE:n("This function returns a data set used for representing a line sparkline",[o("data"),o("dataOrientation"),o("dateAxisData"),o("dateAxisOrientation"),o("setting")]),COLUMNSPARKLINE:n("This function returns a data set used for representing a column sparkline",[o("data"),o("dataOrientation"),o("dateAxisData"),o("dateAxisOrientation"),o("setting")]),WINLOSSSPARKLINE:n("This function returns a data set used for representing a win/loss sparkline",[o("data"),o("dataOrientation"),o("dateAxisData"),o("dateAxisOrientation"),o("setting")]),BULLETSPARKLINE:n("This function returns a data set used for representing a bullet sparkline",[o("measure"),o("target"),o("maxi"),o("good"),o("bad"),o("forecast"),o("tickunit"),o("colorScheme"),o("vertical"),o("measureColor"),o("targetColor"),o("maxiColor"),o("goodColor"),o("badColor"),o("forecastColor"),o("allowMeasureOverMaxi"),o("barSize")]),SPREADSPARKLINE:n("This function returns a data set used for representing a spread sparkline",[o("points"),o("showAverage"),o("scaleStart"),o("scaleEnd"),o("style"),o("colorScheme"),o("vertical")]),STACKEDSPARKLINE:n("This function returns a data set used for representing a stacked sparkline",[o("points"),o("colorRange"),o("labelRange"),o("maximum"),o("targetRed"),o("targetGreen"),o("targetBlue"),o("tragetYellow"),o("color"),o("highlightPosition"),o("vertical"),o("textOrientation"),o("textSize")]),BOXPLOTSPARKLINE:n("This function returns a data set used for representing a boxplot sparkline",[o("points"),o("boxPlotClass"),o("showAverage"),o("scaleStart"),o("scaleEnd"),o("acceptableStart"),o("acceptableEnd"),o("colorScheme"),o("style"),o("vertical")]),CASCADESPARKLINE:n("This function returns a data set used for representing a cascade sparkline",[o("pointsRange"),o("pointIndex"),o("labelsRange"),o("minimum"),o("maximum"),o("colorPositive"),o("colorNegative"),o("vertical"),o("itemTypeRange"),o("colorTotal")]),PARETOSPARKLINE:n("This function returns a data set used for representing a pareto sparkline",[o("points"),o("pointIndex"),o("colorRange"),o("target"),o("target2"),o("highlightPosition"),o("label"),o("vertical"),o("targetColor"),o("target2Color"),o("labelColor"),o("barSize")]),MONTHSPARKLINE:n("This function returns a data set used for representing a month sparkline",[o("year"),o("month"),o("dataRange"),o("emptyColor"),o("startColor"),o("middleColor"),o("endColor")]),YEARSPARKLINE:n("This function returns a data set used for representing a year sparkline",[o("year"),o("dataRange"),o("emptyColor"),o("startColor"),o("middleColor"),o("endColor")]),"CEILING.PRECISE":n("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[o("number"),o("signif")]),"COVARIANCE.S":n("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[o("array1"),o("array2")]),"FLOOR.PRECISE":n("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[o("number"),o("signif")]),"PERCENTILE.EXC":n("This function returns the nth percentile of values in a range.",[o("array"),o("n")]),"QUARTILE.EXC":n("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[o("array"),o("quart")]),"RANK.AVG":n("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[o("number"),o("array"),o("order")]),"MODE.MULT":n("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[o("number1"),o("number2",!0)]),"STDEV.P":n("This function returns the standard deviation for an entire specified population (of numeric values).",[o("value1"),o("value2",!0)]),"VAR.P":n("This function returns variance based on the entire population, which uses only numeric values.",[o("value1"),o("value2",!0)]),"COVARIANCE.P":n("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[o("array1"),o("array2")]),"MODE.SNGL":n("This function returns the most frequently occurring value in a set of data.",[o("value1"),o("value2",!0)]),"PERCENTILE.INC":n("This function returns the nth percentile of values in a range.",[o("array"),o("n")]),"QUARTILE.INC":n("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[o("array"),o("quart")]),"RANK.EQ":n("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[o("number"),o("array"),o("order")]),STDEV:n("This function returns standard deviation is estimated based on a sample.",[o("number1"),o("number2",!0)]),"STDEV.S":n("This function returns standard deviation is estimated based on a sample.",[o("number1"),o("number2",!0)]),"VAR.S":n("This function returns the variance based on a sample of a population, which uses only numeric values.",[o("value1"),o("value2",!0)]),"BETA.INV":n("This function calculates the inverse of the cumulative beta distribution function.",[o("prob"),o("alpha"),o("beta"),o("lower"),o("upper")]),"BINOM.DIST":n("This function calculates the individual term binomial distribution probability.",[o("x"),o("n"),o("p"),o("cumulative")]),"BINOM.INV":n("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[o("n"),o("p"),o("alpha")]),"CHISQ.DIST.RT":n("This function calculates the one-tailed probability of the chi-squared distribution.",[o("value"),o("deg")]),"CHISQ.INV.RT":n("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[o("prob"),o("deg")]),"CHISQ.TEST":n("This function calculates the test for independence from the chi-squared distribution.",[o("obs_array"),o("exp_array")]),"CONFIDENCE.NORM":n("This function returns confidence interval for a population mean.",[o("alpha"),o("stdev"),o("size")]),"EXPON.DIST":n("This function returns the exponential distribution or the probability density.",[o("value"),o("lambda"),o("cumulative")]),"F.DIST.RT":n("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[o("value"),o("degnum"),o("degden")]),"F.INV.RT":n("This function returns the inverse of the F probability distribution.",[o("p"),o("degnum"),o("degden")]),"F.TEST":n("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[o("array1"),o("array2")]),"GAMMA.DIST":n("This function returns the gamma distribution.",[o("x"),o("alpha"),o("beta"),o("cumulative")]),"GAMMA.INV":n("This function returns the inverse of the gamma cumulative distribution.",[o("p"),o("alpha"),o("beta")]),"LOGNORM.INV":n("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[o("prob"),o("mean"),o("stdev")]),"NORM.DIST":n("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[o("x"),o("mean"),o("stdev"),o("cumulative")]),"NORM.INV":n("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[o("prob"),o("mean"),o("stdev")]),"NORM.S.INV":n("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[o("prob")]),"PERCENTRANK.INC":n("This function returns the rank of a value in a data set as a percentage of the data set.",[o("array"),o("n"),o("signif")]),"POISSON.DIST":n("This function returns the Poisson distribution.",[o("nevents"),o("mean"),o("cumulative")]),"T.INV.2T":n("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[o("prog"),o("deg")]),"T.TEST":n("This function returns the probability associated with a t-test.",[o("array1"),o("array2"),o("tails"),o("type")]),"WEIBULL.DIST":n("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[o("x"),o("alpha"),o("beta"),o("cumulative")]),"Z.TEST":n("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[o("array"),o("x"),o("sigma")]),"T.DIST.RT":n("This function returns the right-tailed t-distribution.",[o("x"),o("deg")]),"T.DIST.2T":n("This function returns the two-tailed t-distribution.",[o("x"),o("deg")]),"ISO.CEILING":n("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[o("number"),o("signif")]),"BETA.DIST":n("This function returns the beta distribution.",[o("x"),o("alpha"),o("beta"),o("cumulative"),o("lower"),o("upper")]),"GAMMALN.PRECISE":n("This function returns the natural logarithm of the gamma function.",[o("value")]),"ERF.PRECISE":n("This function returns the error function.",[o("lowerlimit")]),"ERFC.PRECISE":n("This function returns the complementary ERF function.",[o("lowerlimit")]),"PERCENTRANK.EXC":n("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[o("array"),o("n"),o("signif")]),"HYPGEOM.DIST":n("This function returns the hypergeometric distribution.",[o("x"),o("n"),o("M"),o("N"),o("cumulative")]),"LOGNORM.DIST":n("This function returns the log normal distribution of x.",[o("x"),o("mean"),o("stdev"),o("cumulative")]),"NEGBINOM.DIST":n("This function returns the negative binomial distribution.",[o("x"),o("r"),o("p"),o("cumulative")]),"NORM.S.DIST":n("This function returns the standard normal distribution.",[o("z"),o("cumulative")]),"T.DIST":n("This function returns the t-distribution.",[o("x"),o("deg"),o("cumulative")]),"F.DIST":n("This function returns the F probability distribution.",[o("x"),o("degnum"),o("degden"),o("cumulative")]),"CHISQ.DIST":n("This function returns the chi-squared distribution.",[o("x"),o("deg"),o("cumulative")]),"F.INV":n("This function returns the inverse of the F probability distribution.",[o("probability"),o("degnum"),o("degden")]),"T.INV":n("This function returns the left-tailed inverse of the t-distribution.",[o("probability"),o("deg")]),"CHISQ.INV":n("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[o("probability"),o("deg")]),"CONFIDENCE.T":n("This function returns the confidence interval for a Student's t distribution.",[o("alpha"),o("stdev"),o("size")]),"NETWORKDAYS.INTL":n("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[o("startdate"),o("enddate"),o("weekend"),o("holidays")]),"WORKDAY.INTL":n("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[o("startdate"),o("numdays"),o("weekend"),o("holidays")]),REFRESH:n("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[o("formula"),o("evaluateMode"),o("interval")]),DAYS:n("This function returns the number of days between two dates.",[o("startdate"),o("enddate")]),ISOWEEKNUM:n("This function returns the number of the ISO week number of the year for a given date.",[o("date")]),BITAND:n('This function returns a bitwise "AND" of two numbers.',[o("number1"),o("number2")]),BITLSHIFT:n('This function returns a bitwise "OR" of two numbers.',[o("number1"),o("number2")]),BITOR:n('This function returns a bitwise "OR" of two numbers.',[o("number1"),o("number2")]),BITRSHIFT:n('This function returns a bitwise "OR" of two numbers.',[o("number1"),o("number2")]),BITXOR:n('This function returns a bitwise "XOR" of two numbers.',[o("number1"),o("number2")]),IMCOSH:n("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[o("complexnum")]),IMCOT:n("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[o("complexnum")]),IMCSC:n("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[o("complexnum")]),IMCSCH:n("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[o("complexnum")]),IMSEC:n("This function returns the secant of a complex number in x+yi of x+yj text format.",[o("complexnum")]),IMSECH:n("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[o("complexnum")]),IMSINH:n("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[o("complexnum")]),IMTAN:n("This function returns the tangent of a complex number in x+yi or x+yj text format.",[o("complexnum")]),PDURATION:n("This function returns the number of periods required by an investment to reach a specified value.",[o("rate"),o("pval"),o("fval")]),RRI:n("This function returns an equivalent interest rate for the growth of an investment.",[o("nper"),o("pval"),o("fval")]),ISFORMULA:n("This function tests whether contains a formula of a referenced cell.",[o("cellreference")]),IFNA:n("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[o("value"),o("value_if_na")]),IFS:n("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[o("valueTest1"),o("valueTrue1",!0)]),SWITCH:n("This function evaluates one value for a list of values, and returns the result corresponding to the first matching value, otherwise returns the default value",[o("convertvalue"),o("matchvalue"),o("matchtrue"),o("matchfalse")]),XOR:n("This function returns a logical exclusive or of all arguments.",[o("logical",!0)]),AREAS:n("This function returns the number of areas in a reference.",[o("reference")]),FORMULATEXT:n("This function returns a formula as a string.",[o("reference")]),HYPERLINK:n("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[o("link_location"),o("friendly_name")]),ACOT:n("This function calculates the inverse arccotangent of a number.",[o("value")]),ACOTH:n("This function calculates the inverse hyperbolic arccotangent of a number.",[o("value")]),ARABIC:n("This function converts a Roman numeral text to an Arabic numeral equivalent.",[o("text")]),BASE:n("This function converts a number into a text representation with the given radix (base).",[o("number"),o("radix"),o("minLength")]),"CEILING.MATH":n("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[o("value"),o("signif"),o("mode")]),COMBINA:n("This function calculates the number of possible combinations with repetitions for a specified number of items.",[o("number"),o("number_choosen")]),COT:n("This function returns the cotangent of the specified angle.",[o("angle")]),COTH:n("This function returns the hyperbolic cotangent of the specified number.",[o("value")]),CSC:n("This function returns the cosecant of the specified angle.",[o("angle")]),CSCH:n("This function returns the hyperbolic cosecant of the specified number.",[o("value")]),DECIMAL:n("This function converts a text representation of a number in a given base into a decimal number.",[o("text"),o("radix")]),"FLOOR.MATH":n("This function round a number down to the nearest integer or to the nearest multiple of significance.",[o("value"),o("signif"),o("mode")]),SEC:n("This function returns the secant of the specified angle.",[o("angle")]),SECH:n("This function returns the hyperbolic secant of the specified value.",[o("value")]),"BINOM.DIST.RANGE":n("This function calculates the probability of a trial result using a binomial distribution.",[o("x"),o("n"),o("p"),o("cumulative")]),GAMMA:n("This function returns the gamma function value.",[o("number")]),MAXIFS:n("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[o("array"),o("conditionarray"),o("condition",!0)]),GAUSS:n("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[o("number")]),MINIFS:n("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[o("array"),o("conditionarray"),o("condition",!0)]),PERMUTATIONA:n("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[o("k"),o("n")]),PHI:n("This function returns the value of the density function for a standard normal distribution.",[o("value")]),"SKEW.P":n("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[o("number1"),o("number2",!0)]),BAHTTEXT:n('This function converts a number to Thai text and adds a suffix of "Baht"',[o("number")]),CONCAT:n('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[o("text1"),o("text2",!0)]),FINDB:n("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[o("findtext"),o("intext"),o("start")]),LEFTB:n("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[o("mytext"),o("num_bytes")]),LENB:n("This function returns the length of the number of bytes in a text string.",[o("value")]),MIDB:n("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[o("text"),o("start_num"),o("num_bytes")]),REPLACEB:n("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[o("old_text"),o("start_byte"),o("num_bytes"),o("new_text")]),RIGHTB:n("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[o("text"),o("num_bytes")]),SEARCHB:n("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[o("string1"),o("string2")]),TEXTJOIN:n("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[o("delimiter"),o("ignore_empty"),o("text1"),o("text2",!0)]),UNICHAR:n("This function returns the Unicode character of a given numeric reference.",[o("number")]),UNICODE:n("This function returns the number corresponding to the first character of the text.",[o("text")]),ENCODEURL:n("This function returns a URL-encoded string.",[o("text")]),BC_QRCODE:n("This function returns a data set for representing a QRCode",[o("value"),o("color"),o("backgroundColor"),o("errorCorrectionLevel"),o("model"),o("version"),o("mask"),o("connection"),o("connectionNo"),o("charCode"),o("charset"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),BC_EAN13:n("This function returns a data set for representing a EAN13.",[o("value"),o("color"),o("backgroundColor"),o("showLabel"),o("labelPosition"),o("addOn"),o("addOnLabelPosition"),o("fontFamily"),o("fontStyle"),o("fontWeight"),o("textDecoration"),o("textAlign"),o("fontSize"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),BC_EAN8:n("This function returns a data set for representing a EAN8.",[o("value"),o("color"),o("backgroundColor"),o("showLabel"),o("labelPosition"),o("fontFamily"),o("fontStyle"),o("fontWeight"),o("textDecoration"),o("textAlign"),o("fontSize"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),BC_CODABAR:n("This function returns a data set for representing a CODABAR.",[o("value"),o("color"),o("backgroundColor"),o("showLabel"),o("labelPosition"),o("checkDigit"),o("nwRatio"),o("fontFamily"),o("fontStyle"),o("fontWeight"),o("textDecoration"),o("textAlign"),o("fontSize"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),BC_CODE39:n("This function returns a data set for representing a CODE39.",[o("value"),o("color"),o("backgroundColor"),o("showLabel"),o("labelPosition"),o("labelWithStartAndStopCharacter"),o("checkDigit"),o("nwRatio"),o("fullASCII"),o("fontFamily"),o("fontStyle"),o("fontWeight"),o("textDecoration"),o("textAlign"),o("fontSize"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),BC_CODE93:n("This function returns a data set for representing a CODE93.",[o("value"),o("color"),o("backgroundColor"),o("showLabel"),o("labelPosition"),o("checkDigit"),o("fullASCII"),o("fontFamily"),o("fontStyle"),o("fontWeight"),o("textDecoration"),o("textAlign"),o("fontSize"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),BC_CODE128:n("This function returns a data set for representing a CODE128.",[o("value"),o("color"),o("backgroundColor"),o("showLabel"),o("labelPosition"),o("codeSet"),o("fontFamily"),o("fontStyle"),o("fontWeight"),o("textDecoration"),o("textAlign"),o("fontSize"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),BC_GS1_128:n("This function returns a data set for representing a GS1_128.",[o("value"),o("color"),o("backgroundColor"),o("showLabel"),o("labelPosition"),o("fontFamily"),o("fontStyle"),o("fontWeight"),o("textDecoration"),o("textAlign"),o("fontSize"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),BC_CODE49:n("This function returns a data set for representing a CODE49.",[o("value"),o("color"),o("backgroundColor"),o("showLabel"),o("labelPosition"),o("grouping"),o("groupNo"),o("fontFamily"),o("fontStyle"),o("fontWeight"),o("textDecoration"),o("textAlign"),o("fontSize"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),BC_PDF417:n("This function returns a data set for representing a PDF417.",[o("value"),o("color"),o("backgroundColor"),o("errorCorrectionLevel"),o("rows"),o("columns"),o("compact"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),BC_DATAMATRIX:n("This function returns a data set for representing a DATAMATRIX.",[o("value"),o("color"),o("backgroundColor"),o("eccMode"),o("ecc200SymbolSize"),o("ecc200EncodingMode"),o("ecc00_140SymbolSize"),o("structuredAppend"),o("structureNumber"),o("fileIdentifier"),o("quietZoneLeft"),o("quietZoneRight"),o("quietZoneTop"),o("quietZoneBottom")]),FILTER:n("This function filter a range or array.",[o("array"),o("include"),o("if_empty")]),RANDARRAY:n("This function returns an array of random numbers.",[o("rows"),o("columns"),o("min"),o("max"),o("whole_number")]),SEQUENCE:n("This function returns a sequence of numbers.",[o("rows"),o("columns"),o("start"),o("step")]),SINGLE:n("This function returns a single value when given a value, range or array.",[o("value")]),SORT:n("This function sorts a range or array.",[o("array"),o("sort_index"),o("sort_order"),o("by_col")]),SORTBY:n("This function sorts a range or array based on the values in a corresponding range or array.",[o("array"),o("by_array1"),o("sort_order1"),o("by_array2"),o("sort_order2"),o("...")]),UNIQUE:n("This function returns the unique values from a range or array.",[o("array"),o("by_col"),o("occurs_once")]),LET:n("This function assigns calculation results to names. Useful for storing intermediate calculations and values by defining names inside a formula. These names only apply within the scope of the LET function.",[o("name1"),o("name_value1"),o("calculation_or_name2"),o("[name_value2, ...")])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_CustomName_Description:"Custom name for ",B2:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(e,t,r){"use strict";var _,N,o,a,f,P,L,m,b,l,i,s,O,B,w,x,F,j,u,c,n,h,d,p,g,y,C,v,S,T,A,k=this&&this.__extends||(T=function(e,t){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function H(e,t,r,n){return{row:e,col:t,rowCount:r,colCount:n}}function M(e,t,r,n,o,i,a,s){var l=A.call(this,e,isNaN(s)?P:{row:a,col:s},t,isNaN(i)?P:{row:r,col:n,rowCount:o,colCount:i})||this,u=e.Cf().getGlobalSourceModel(e);return l.yi=u&&u.getSource(),l}function I(e,t){this.id=e.si++,this.ctx=e,this.row=e.row+(e.arrayFormulaMode&&e.rowOffset||0),this.col=e.column+(e.arrayFormulaMode&&e.columnOffset||0),this.node=t}function E(e,t,r,n){var o,i,a=[];for(o=4;o<arguments.length;o++)a[o-4]=arguments[o];this.si=0,this.ti=0,this.ui=0,(i=this).source=e,i.arrayFormulaMode=!!r,i.identity=t||i.$Ab(0,0),i.arrayIdentity=n,i.row=n?n.row:i.identity.row||0,i.column=n?n.col:i.identity.col||0,i.rowOffset=n?i.identity.row-n.row:i.row,i.columnOffset=n?i.identity.col-n.col:i.column}function R(e){this.w5=[],this.x5=-1,this.y5={},this.z5=-1,this.lh=e,this.vQa=0}function D(e,t){this.id=e,this.Fi=L,this.v5=!1,this.oi=[],t!==L&&(this.evaluateMode=t)}function G(e){this.service=e,this.asyncManager=new p(this)}function U(e){var t,r;for(r=0;r<e.oi.length;r++)(t=e.oi[r]).v5=!1,0<t.oi.length&&U(t)}function W(e){var t,r=!0,n=e;return e&&e.getValue&&((t=s(e,0,!1,!1)).isError?n=t[0]:1===t.rowCount&&1===t.colCount?n=t[0][0]:(n=t,r=!1)),{value:n,success:r}}function V(e,t,r){return i(t)?t:i(r)?r:(e<=2?function(e,t,r){var n,o,i,a,s,l,u,c;if(!t)return 0;if((n=W(t)).success)return z(e,n.value);if(r){for(o=[],i=n.value,a=i.rowCount,s=i.colCount,l=0;l<a;l++)for(u=o[l]=[],c=0;c<s;c++)u[c]=z(e,i[l][c]);return new N.CalcArray(o)}}:e<=14?function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y;if(n=e<=7?z:8===e?q:Z,o=W(t),i=W(r),o.success&&i.success)return n(e,o.value,i.value);if(t=o.value,r=i.value,a=o.success?-1:t.rowCount,s=o.success?-1:t.colCount,l=i.success?-1:r.rowCount,u=i.success?-1:r.colCount,h=c=-1,o.success||i.success)h=o.success?(c=l,u):(c=a,s);else{if(1!==a&&1!==l&&a!==l||1!==s&&1!==u&&s!==u)return j;c=1===a?l:a,h=1===s?u:s}for(f=[],d=0;d<c;d++)for(f[d]=[],p=0;p<h;p++)!o.success&&(1!==a&&a<c||1!==s&&s<h)||!i.success&&(1!==l&&l<c||1!==u&&u<h)?f[d][p]=j:(g=1===a?0:d,m=1===s?0:p,b=1===l?0:d,y=1===u?0:p,f[d][p]=n(e,o.success?t:t[g][m],i.success?r:r[b][y]));return new N.CalcArray(f)}:function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g;if(!t||!r||(1!==t.getRangeCount()||1!==r.getRangeCount())&&16!==e||t.endSource||r.endSource)return x;if(!(n=t.getSource())||n!==r.getSource())return x;if(16===e)o=t._identities.concat(r._identities);else{if(i=15===e?m:b,a=15===e?b:m,s=t.getRow(0),l=t.getColumn(0),u=r.getRow(0),c=r.getColumn(0),h=i(s,u),f=i(l,c),d=a(s+t.getRowCount(0),u+r.getRowCount(0))-h,p=a(l+t.getColumnCount(0),c+r.getColumnCount(0))-f,d<1||p<1)return N.Errors.Null;o=[H(h,f,d,p)]}return(g=new N.CalcReference(n,o)).ck=t.ck||r.ck,g})(e,t,r)}function z(e,t,r){var n,o,i,a;function s(e){return"string"==typeof e&&0===e.trim().length}if(s(t)||s(r))return x;if(!l(t,n={value:0}))return 0===e&&"string"==typeof t||t instanceof N.CalcError?t:x;if(o=n.value,r!==L){if(!l(r,n))return r instanceof N.CalcError?r:x;i=n.value}else i=0;return 0===e?o:1===e?-o:2===e?o/100:3===e?N.Zh.Yh(o,-i)?0:o+i:4===e?N.Zh.Yh(o,i)?0:o-i:5===e?_.Common.o.Lma(o*i,N.Functions.CALC_PRECISION||15):6===e?i?o/i:u:7===e?!o&&i<0?u:0===o&&0===i?c:(a=N.Functions.MathHelper.YDc(o,i))===Number.POSITIVE_INFINITY||a===Number.NEGATIVE_INFINITY||isNaN(a)?c:a:void 0}function q(e,t,r){if(8===e)return i(t)?t:i(r)?r:N.Convert.bc(t)+N.Convert.bc(r)}function Z(e,t,r){var n=o.gOb(t,r,!1);return i(n)?n:9===e&&0===n||10===e&&0!==n||11===e&&n<0||12===e&&n<=0||13===e&&0<n||14===e&&0<=n}function Y(e,t){var r,n,o,i=!0;switch(t.Hi){case 0:r=g(e),n=!0;break;case 1:r=parseFloat(e),n=!0;break;case 2:r=y(e),n=!0;break;case 3:r=parseInt(e,10),n=!0;break;case 4:(r=s(e,t.Ii,t.Ji||!1,t.Ki||!1,t.Li||!1,t.Mi,t.xTa,t.hOb)).isError&&(r=r[0],i=!1),r.isConvertError&&(r=x,i=!1);break;case 5:r=C(e),t.Ni&&""===r&&(r=x,i=!1);break;case 6:v(e,o={value:P})?r=o.value:(r=x,i=!1);break;case 7:r=S(e);break;case 8:!(r=N.Functions.Wi(e))||t.Oi&&0===r.Pi()&&0===r.Qi()?(r=N.Errors.Number,i=!1):r={Ri:r.Pi(),Si:r.Qi()};break;default:r=e}return n&&isNaN(r)&&(r=x,i=!1),{Ti:r,Ei:i}}function K(e,t,r){var n,o,i,a,s;for(Array.isArray(t)||(t=[t]),n=e.Ti,o=0;o<t.length;o++)if(a=(i=t[o].split(" "))[0],s=parseInt(i[1],10),"<"===a&&n<s||">"===a&&s<n||"<="===a&&n<=s||">="===a&&s<=n||"="===a&&n===s||"!="===a&&n!==s||"checkLength"===a&&n.length>s)return e.Ti=r===L?N.Errors.Number:r,e.Ei=!1}Object.defineProperty(t,"__esModule",{value:!0}),_=r("Common"),N=r("./src/calc.common.ts"),o=r("./src/calc.common.ts"),a=r("./src/calc.ts"),f=_.Common.j.Fa,P=null,L=void 0,Math.pow,m=Math.min,b=Math.max,l=N.Convert.Th,i=N.Convert.vf,s=N.Convert.Ph,O=N.Convert.Ca,B=N.Convert._isReference,w=N.Errors.Reference,x=N.Errors.Value,F=N.Errors.Name,j=N.Errors.NotAvailable,u=N.Errors.DivideByZero,c=N.Errors.Number,E.prototype.$Ab=function(e,t){return{row:e,col:t}},E.prototype.fga=function(e){return e===N.BangSource?this.source:e},E.prototype.getValue=function(e,t){return e?this.fga(e).getValue(t):w},E.prototype.getReference=function(e,t){return e?this.fga(e).getReference(t):w},E.prototype.getSheetRangeReference=function(e){return e&&e.source&&e.endSource?this.fga(e.source).getSheetRangeReference(e):w},E.prototype.getFunction=function(e){return this.source?this.source.getCustomFunction(e):P},E.prototype.getName=function(e){var t,r=this.source?this.source.getCustomName(e):P;return!r&&this.source&&(r=(t=this.source.Cf().getGlobalSourceModel())&&t.getSource().getCustomName(e)),r},E.prototype.getField=function(e){return this.source?this.source.getField(e):P},E.prototype.vi=function(){return 0<this.ui},E.prototype.wi=function(){this.ui++},E.prototype.xi=function(){this.ui--},E.prototype.SetAsyncResult=function(e,t){this.source.Cf().lh.SetAsyncResult(e,t)},E.prototype.cloneFrom=function(e){this.acceptsReference=e.acceptsReference,this.arrayFormulaMode=e.arrayFormulaMode},n=E,t.EvaluateContext=n,N.CalcSource.prototype.getEvaluatorContext=function(e,t,r){return new n(this,e,t,r)},I.prototype.setAsyncResult=function(e){this.node.Fi=e,this.node.v5=!0,this.ctx.SetAsyncResult(this,e),this.ctx.source.refresh()},I.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},h=I,t.AsyncEvaluateContext=h,k(M,A=n),M.prototype.getName=function(e){return this.yi?this.yi.getCustomName(e):P},t.GloableEvaluateContext=M,G.prototype.evaluateExpression=function(e,t,r,n,o){var i,a,s=void 0===e.type&&e.Lf?e.Lf:e,l=this.evaluate(s,t,!!n,!!o);return l&&l.pause?l:l===L||l===P?!1===r?l:0:((O(l)&&!n||B(l)&&!o)&&(l=this.getOneValue(t,l)),i=15,"number"==typeof l&&-10<l&&l<10&&(1<(a=""+l).indexOf("000000000000")||1<a.indexOf("999999999999"))&&(i=14),_.Common.o.Lma(l,N.Functions.CALC_PRECISION||i))},G.prototype.evaluate=function(e,t,r,n){var o,i,a;if(!e)throw N.sR().Exp_ExprIsNull;if(void 0===e.type){if(e._error)return e;e.Lf&&(e=e.Lf)}for(;10===e.type;)e=e.value;if(i=P,12===e.type?(i=e.needExpendIndexs,e=e.value):t.Exb&&(r=!0,i=[]),2<=(a=e.type)&&a<=6)o=this.evaluateConst(e,t,r);else if(1===a||13===a||33===a)o=this.evaluateReference(e,t,n,r);else if(8===a)o=this.evaluateName(e,t,r,n);else if(e&&100===e.type)o=this.evaluateLocalName(e,t,r,n);else if(9!==a||e.value2){if(9===a)o=this.evaluateBinaryOperation(e,t,r,n,i);else if(7===a){if(e.QDc&&t.NDc&&(o=this.evaluateBranchFunction(e,t,r,n,i))&&o.pause)return o;o=this.evaluateFunction(e,t,r,n,i)}else if(11===a)o=L;else if(14===a)o=this.evaluateField(e,t);else if(t.evaluate)return t.evaluate(e,r,n)}else o=this.evaluateUnaryOperation(e,t,r,n,i);return o},G.prototype.evaluateLocalName=function(e,t,r,n){var o,i,a,s;if(t.letContext)for(o=e.value,i=t.letContext.length-1;0<=i;i--)if((a=t.letContext[i])[o]!==L)return e.bhc=!0,a[o];return(s=new N.Expression(8)).value=e.value,this.evaluate(s,t,r,n)},G.prototype.evaluateConst=function(e,t,r){var n=e.value;return!O(n)||r||t&&(t.arrayFormulaMode||t.vi())?n:n.getValue(0,0)},G.prototype.evaluateReference=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C;if(!t)return x;if(o=e.source||t.source,i=isNaN(t.row)?0:t.row,a=isNaN(t.column)?0:t.column,s=e.getRange&&e.getRange(i,a),l=e.type,!s)return 13===l?x:w;if(33===l&&s.isSpillError)return N.Errors.Spill;if(u=s.row<0?0:s.row,c=s.col<0?0:s.col,h=s.rowCount,f=s.colCount,n&&(d=o.getRowCount(),p=o.getColumnCount(),(-1===h||d<h)&&(h=d),(-1===f||p<f)&&(f=p)),r||t.arrayFormulaMode)return e.endSource?t.getSheetRangeReference({source:e.source,endSource:e.endSource,row:u,col:c,rowCount:h,colCount:f}):t.getReference(o,s);if(n&&(1<h||1<f)){for(g=[],m=0;m<h;m++)for(g[m]=[],b=0;b<f;b++)g[m][b]=o.getValue(m+u,b+c);return new N.CalcArray(g)}if(1<h||1<f)if(y=i>=s.row&&i<s.row+h,C=a>=s.col&&a<s.col+f,y&&C)u=i,c=a;else{if(!y&&!C)return x;if(y&&1===f)u=i;else{if(!C||1!==h)return x;c=a}}else if(-1===s.row&&-1===h){if(1!==f)return x;u=i}else if(-1===s.col&&-1===f){if(1!==h)return x;c=a}return o.getValue(u,c)},G.prototype.evaluateName=function(e,t,r,n){var o,i;return t?(e.source&&(t=e.source.getEvaluatorContext(t.identity,t.arrayFormulaMode,t.arrayIdentity)),(o=t.getName(e.value))?(i=a.Mh(t,o,!1,0,0,r,n),this.evaluate(i,t,r,n)):F):F},G.prototype.evaluateUnaryOperation=function(t,r,e,n,o){var i,a=!1;return o&&0<o.length&&(a=e=!0),(i=this.evaluate(t.value,r,e,a))&&i.pause||N.Convert.vf(i)?i:i===N.missingArgument?j:this.evaluateWithArgs(t,function(e){return V(t.operatorType,e[0],r.Exb)},r,o,[i],e,n)},G.prototype.evaluateBinaryOperation=function(t,e,r,n,o){var i,a,s,l,u,c,h,f,d;if(e.Exb&&(r=!0),i=[r,r],s=[a=15<=t.operatorType,a],o&&0<o.length)for(l=0;l<o.length;l++)i[o[l]]=!0,s[o[l]]=!0;for(u=function(e,t){if(0===t){for(;10===e.type;)e=e.value;if(7===e.type&&e.function&&e.function.TAb)return null}return t},c=[t.value,t.value2],h=[],l=0;l<2;l++){if((f=this.evaluate(c[l],e,i[l],s[l]))&&f.pause)return f;if(d=u(c[l],f),N.Convert.vf(d))return d;if(d===N.missingArgument)return j;h[l]=d}return this.evaluateWithArgs(t,function(e){return V(t.operatorType,e[0],e[1])},e,o,h,r,n)},G.prototype.evaluateField=function(e,t){return t?(e.source&&(t=e.source.getEvaluatorContext(t.identity,t.arrayFormulaMode,t.arrayIdentity)),t.getField(e.value)||j):F},G.prototype.startCache=function(){this.Bi={},this.service.nia&&this.asyncManager.startCalc()},G.prototype.endCache=function(){this.Bi=P},G.prototype.evaluateBranchFunction=function(e,t,r,n,o){var i,a,s,l,u,c,h;if(f(e.PDc))return i=e.function,a=e.arguments.length,s=i.findTestArgument(),u=(l=this.preprocessFunction(t,i,a,o)).acceptsArrays,c=l.keepArrayValuesFlagSet,(h=this.testArgGetBranch(t,i,e,u[s],!1,s))&&h.pause?h:(c&&delete t.Exb,0<=h.branchArgument&&"number"==typeof h.branchArgument?(e.PDc=!0,t.source.ODc=t.source.ODc||[],t.source.ODc.push(e),{pause:"Branch",branch:e.RDc[h.branchArgument]}):void delete e.QDc)},G.prototype.evaluateLetFunction=function(e,t,r,n){var o,i,a,s,l,u,c,h,f=e.arguments.length;for(t.letContext=t.letContext||[],i={},a=1;a<f-1;a+=2){if(s=e.arguments[a-1],l=e.arguments[a],u=s.value,(c=t).letContext.push(i),(o=this.evaluate(l,c,r,n))&&o.pause)return o;t.letContext.pop(),i[u]=o,s.bhc=!0}return t.letContext.push(i),(h=this.evaluate(e.arguments[f-1],t,r,n))&&h.pause||(t.letContext.pop(),0===t.letContext.length&&delete t.letContext),h},G.prototype.preprocessFunction=function(e,t,r,n){var o,i,a,s,l=[],u=[],c=e.Exb,h=!1,f=P;for(c||1!==t.arrayArgumentEvaluateMode||(c=e.Exb=!0,h=!0),o=0;o<r;o++)l[o]=t.acceptsArray(o),u[o]=t.acceptsReference(o);if(n&&0<n.length||c){for(f=[],o=0;o<r;o++)f[o]=!0;for(i=c?r:n.length,o=0;o<i;o++)l[a=c?o:n[o]]=!0,u[a]=!0,(s=!(t.acceptsReference(a)&&!t.acceptsArray(a)))&&c&&t.acceptsReference(a)&&(s=!1),f[a]=s}return t.isBranch()&&(e.arrayFormulaMode||e.vi())&&(l[t.findTestArgument()]=!0,u[t.findTestArgument()]=!0),{acceptsArrays:l,acceptsReferences:u,getReferenceValues:f,keepArrayValuesFlagSet:h}},G.prototype.testArgGetBranch=function(e,t,r,n,o,i){var a,s=-1,l=e.Exb;return e.arrayFormulaMode&&(e.Exb=!0),t.acceptsArray(i)&&e.wi(),(a=this.evaluate(r.arguments[i],e,n,o))&&a.pause?a:(t.acceptsArray(i)&&e.xi(),e.Exb=l,B(a)||O(a)||(s=t.findBranchArgument(a)),{testArgValue:a,branchArgument:s})},G.prototype.evaluateFunction=function(e,u,t,c,r){var n,h,f,d,o,i,a,s,l,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D;if(!e||!e.function||"string"==typeof e.function)return F;if(n=e.arguments.length,h=this,f=u.ti,"LET"===e.functionName)return h.evaluateLetFunction(e,u,t,c);if(d=e.function,o=[],a=P,d instanceof N.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(d,e.arguments,u),0!==n){if(p=(l=h.preprocessFunction(u,d,n,r)).acceptsArrays,g=l.acceptsReferences,a=l.getReferenceValues,s=l.keepArrayValuesFlagSet,y=b=m=void 0,d.isBranch()){if(b=d.findTestArgument(),(C=h.testArgGetBranch(u,d,e,p[b],g[b],b))&&C.pause)return C;m=C.testArgValue,y=C.branchArgument}for(w=0;w<n;w++){if(b===w)i=m;else{if(0<=y&&w!==y){o[w]=null;continue}if(d.acceptsArray(w)&&u.wi(),(i=h.evaluate(e.arguments[w],u,p[w],g[w]))&&i.pause)return i;d.acceptsArray(w)&&u.xi()}if(!d.acceptsArray(w)&&O(i)||!d.acceptsReference(w)&&B(i))if(v=O(i)?i:P,S=B(i)?i:P,v&&1===v.getRowCount()&&1===v.getColumnCount())i=v.getValue(0,0);else if(S&&1===S.getRowCount(0)&&1===S.getColumnCount(0))i=S.getValue(0,0,0);else{if(T=!(x=[]),r)for(A=0;A<r.length;A++)x.push(r[A]),r[A]===w&&(T=!0);T||(x.push(w),r=x)}if(N.Convert.vf(i)&&!d.acceptsError(w))return d instanceof N.Functions.AsyncFunction&&this.asyncManager.endCalcFunction(),i;if(i!==N.missingArgument||d.acceptsMissingArgument(w)||(i=P),(o[w]=i)&&"INDIRECT"!==e.functionName&&i.ck&&i._source)for(k=i.getRangeCount(),M=i._source,I=u.source.getCalcSourceModel().qg(u.row,u.column,!0),E=0;E<k;E++)(R=i._identities[E]).id=M.id,M.getRangeKey&&(D=M.getRangeKey(M,R),I.eOb||(I.eOb={}),I.eOb[D]=R)}}return s&&delete u.Exb,h.evaluateWithArgs(e,function(e,t,r){var n,o,i,a,s,l=function(e,t){var r,n,o,i,a,s=[];if(!t)return{Di:e,Ei:!0};if(t.Xi)for(o=0;o<e.length;o++)s.push(t);else s=Array.isArray(t)?t:[t];for(n=0;n<s.length;n++){if((i=s[n]).Yi&&!e[n])throw N.sR().Exp_ArgumentNull;if(a=e[n]!==L){if(r=Y(e[n],i),i.aj&&K(r,i.aj,i.bj),!r.Ei)break;e[n]=i.Zi?{$i:a,Qb:r.Ti}:r.Ti}else e[n]=i.Zi?{$i:a,Qb:i._i}:i._i}return r?{Di:e,Ei:r.Ei,Fi:r.Ti}:void 0}(e,d.Ci);return e=l.Di,d.isContextSensitive()?(u.acceptsReference=c||u.vi(),d instanceof N.Functions.AsyncFunction?(h.T4=h.T4||{},d.evaluateWhenArgumentsIsSame()?h.evaluateAsyncFunction(u,t,d,f,e,r):h.evaluateWithCache(d,e,function(){return h.evaluateAsyncFunction(u,t,d,f,e,r)},h.T4)):d.evaluateWithContext(u,e)):((o=u.arrayFormulaMode)&&(d.y0a={row:u.rowOffset,col:u.columnOffset}),i=N.getMapping()&&N.getMapping().builtInFunctionsMapping,a=i&&i[d.name]&&i[d.name].specialFun,s=function(){return l.Ei?a&&a.apply(d,e)||d.evaluate.apply(d,e):l.Fi},n=o?h.evaluateWithCache(d,e,s,h.Bi):s(),delete d.y0a,n)},u,r,o,t,c,a)},G.prototype.evaluateAsyncFunction=function(e,t,r,n,o,i){var a,s,l=this.asyncManager.getNode();if(l.v5)a=l.Fi;else if(l.canEvaluate()){if(s=new h(e,l),a=r.evaluateWithContext(s,o),s.notAsync)return a;a===L?a=l.Fi!==L?l.Fi:r.defaultValue():1===l.evaluateMode&&(l.v5=!0)}else a=l.Fi!==L?l.Fi:r.defaultValue();return l.Fi=a,i||this.asyncManager.endCalcFunction(),a},G.prototype.evaluateWithCache=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b;if(n)if(i=!1,o=n[e.name+t.length])for(a=0;a<o.length;a++){if(i=!1,(s=o[a]).args.length===t.length){for(i=!0,l=0;l<t.length;l++)if((u=s.args[l])!==(c=t[l])){if(!(u instanceof N.CalcReference&&c instanceof N.CalcReference)){i=!1;break}if(h=u.zf,u._source!==c._source||h!==c.zf){i=!1;break}for(f=0;f<h;f++)if(u.getRow(f)!==c.getRow(f)||u.getColumn(f)!==c.getColumn(f)||u.getRowCount(f)!==c.getRowCount(f)||u.getColumnCount(f)!==c.getColumnCount(f)){i=!1;break}}i&&(m=s.y0a,b=e.y0a,m&&b?m.row!==b.row||m.col!==b.col:m!==b)&&(i=!1)}if(i)return s.flag++,s.value}else o=n[e.name+t.length]=[];if(d=r(),n&&d!==L){if(100<=(p=o.length)){for(g=[],a=0;a<p;a++)0<o[a].flag&&g.push(o[a]);g.sort(function(e,t){return t.flag-e.flag}),p=Math.min(50,g.length),o=g.slice(0,p),n[e.name+t.length]=o}o.push({args:t,value:d,flag:0,y0a:e.y0a})}return d},G.prototype.SetAsyncResult=function(e){var t,r,n=[];for(t=1;t<arguments.length;t++)n[t-1]=arguments[t];(r=e.ctx).source.Cf().recalculate(r.source,e.row,e.col,!0)},G.prototype.evaluateWithArgs=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S=r.Exb;if(!S||n&&0<n.length||(n=[],(l=7===e.type&&e.function)&&o.forEach(function(e,t){(!l.acceptsArray(t)&&O(e)||!l.acceptsReference(t)&&B(e))&&n.push(t)})),n&&0<n.length){if(!(c=this.Gi(r,e,o,n,s)))return j;for(h=[],f=c[0].length,d=c[0][0].length,p=0;p<f;p++)for(h[p]=[],g=0;g<d;g++)try{for(m=[],b=0;b<o.length;b++)m[b]=c[b][p][g];if(u=t(m,e,p+1!==f||g+1!==d),B(u)&&!S){if(7===e.type&&(l=e.function).returnReference&&l.returnReference())return u;u=this.getOneValue(r,u)}h[p][g]=u}catch(e){h[p][g]=x}return new N.CalcArray(h,S)}try{if(u=t(o,e),r.arrayFormulaMode&&r.vi())return u;if(O(u)&&!i)return this.getOneValue(r,u);if(!B(u)||a)return u;if(y=u,i&&1===y.getRangeCount()){for(C=[],w=0;w<y.getRowCount(0);w++)for(C[w]=[],v=0;v<y.getColumnCount(0);v++)C[w][v]=y.getValue(0,w,v);return new N.CalcArray(C)}return this.getOneValue(r,u)}catch(e){return x}},G.prototype.getOneValue=function(e,t){var r,n,o,i,a,s;return B(t)?(i=(o=t).getRowCount(0),a=o.getColumnCount(0),t=1<o.getRangeCount()||!e.arrayFormulaMode&&1<i&&1<a?x:(n=-1!==e.rowOffset||-1!==e.columnOffset?(r=1===i?0:e.arrayFormulaMode?e.rowOffset:e.rowOffset-o.getRow(0),1===a?0:e.arrayFormulaMode?e.columnOffset:e.columnOffset-o.getColumn(0)):(r=1===i?0:e.row-o.getRow(0),1===a?0:e.column-o.getColumn(0)),i<=r||a<=n?j:o.getValue(0,r,n))):O(t)&&(s=t,t=!e.arrayFormulaMode||-1===e.rowOffset&&-1===e.columnOffset?s.getValue(0,0):(r=1===s.getRowCount()?0:e.rowOffset,n=1===s.getColumnCount()?0:e.columnOffset,r>=s.getRowCount()||n>=s.getColumnCount()?j:s.getValue(r,n))),B(t)||O(t)?this.getOneValue(e,t):t},G.prototype.Gi=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=1,A=1,k=-1,M=!0,I=!0,E=1,R=1,D=7===t.type?t:P,N=D&&D.function,F=e.arrayFormulaMode||e.source&&e.source._service&&e.source._service.allowDynamicArray;if(N&&!N.expandRows()&&(M=!1),N&&!N.expandColumns()&&(I=!1),N&&N.isBranch()&&(F||e.vi())){if(k=N.findTestArgument(),l=!(s=[]),n)for(u=0;u<n.length;u++)s.push(n[u]),n[u]===k&&(l=!0);if(l||O(r[k])||B(r[k])){for(c=0;c<D.arguments.length;c++)c!==k&&_.Common.k.Cb(s,c)<0&&(O(r[c])||B(r[c]))&&s.push(c);n=s}}for(h=[],d=n[f=0],p=r.length,b=[],g=0;g<p;g++)m=r[g],a=i=P,E=R=1,g===d?(i=O(m)?m:P,a=B(m)?m:P,(i||a)&&(E=i&&i.getRowCount()||(M?a.getRowCount(0):1),R=i&&i.getColumnCount()||(I?a.getColumnCount(0):1)),d=++f<n.length?n[f]:-1):o===L&&(i=O(m)?m:P,a=B(m)?m:P,(i||a)&&(E=i&&i.getRowCount()||(M?a.getRowCount(0):1),R=i&&i.getColumnCount()||(I?a.getColumnCount(0):1))),b[g]=[i,a,m,E,R],T=T<E?E:T,A=A<R?R:A;for(g=0;g<p;g++){if(y=h[g]=[],i=(C=b[g])[0],a=C[1],m=C[2],E=C[3],R=C[4],(i||a)&&(1!==E&&E!==T||1!==R&&R!==A)&&(-1===k||g===k)&&!F)return;for(w=0;w<T;w++)for(v=y[w]=[],S=0;S<A;S++)1!==E&&E<=w||1!==R&&R<=S?v[S]=j:i?(x=i.getValue(1===E?0:w,1===R?0:S),O(x)&&(x=x.getValue(0,0)),v[S]=x):a?!o||o[g]?v[S]=a.getValue(0,1===E?0:w,1===R?0:S):v[S]=a.create([H(a.getRow(0)+(1===E?0:w),a.getColumn(0)+(1===R?0:S),1,1)]):v[S]=m}return h},t.Evaluator=G,D.prototype.canEvaluate=function(){var e,t=this.oi;for(e=0;e<t.length;e++)if(!t[e].v5)return!1;return!0},d=D,t.AsyncFunctionNode=d,R.prototype.startCalc=function(){var e,t,r,n,o,i,a,s,l;if(this.vQa)for(t in this.y5)if(r=this.y5[t])for(n in r)if(o=r[n])for(i in o)if((a=o[i])&&0<(e=a.length))for(s=0;s<e;s++)0===(l=a[s]).evaluateMode&&(l.v5=!1)},R.prototype.startCalcCell=function(e,t){var r,n,o,i,a=this,s=e.getName(),l=t.row,u=t.col;return a.z5=-1,a.source=e,(o=(n=(n=(r=(r=a.y5[s])||(a.y5[s]={}))[l])||(r[l]={}))[u])?void(a.cellNodes=o):(i=new d(-1),o=n[u]=[],a.vQa++,a.x5=-1,a.cellNodes=o,a.row=l,a.col=u,o.root=i,a.w5[++a.x5]=i,void(a.evaluateMode=-1))},R.prototype.startCalcFunction=function(e,t,r){var n,o,i,a,s,l,u,c,h,f=this;if(f.z5++,f.isNewNode=!1,n=f.cellNodes[f.z5])return f.currentNode=n;if(f.isNewNode=!0,o=f.evaluateMode,i=e.evaluateMode(),"REFRESH"===e.name?(i=t[1]?f.lh.evaluate(t[1],r,!1,!1):0,f.evaluateMode=i):-1!==o&&(i=o),n=new d(f.z5,i),f.cellNodes[f.z5]=n,f.w5[f.x5].oi.push(n),n.parent=f.w5[f.x5],f.w5.push(n),f.x5++,f.currentNode=n,2===i&&-1===o){for(a=f.intervals,s=e.interval()||6e4,"REFRESH"===e.name&&(n.isRefresh=!0,s=t[2]?f.lh.evaluate(t[2],r,!1,!1):6e4),a||(f.intervals=a={}),(l=a[s])||"object"!=typeof window||((l=a[s]=[]).intervalObj=window.setInterval(function(){var e,t,r=f.intervals[s];for(u=0;u<r.length;u++)(t=(e=r[u]).node).v5=!1,t.isRefresh&&U(t),f.lh.service.recalculate(e.source,e.row,e.col,!0),f.source.refresh()},s)),c=!1,u=0;u<l.length;u++)if((h=l[u]).source===f.source&&h.node===n&&h.row===f.row&&h.col===f.col){c=!0;break}c||l.push({source:f.source,node:n,row:f.row,col:f.col})}return n},R.prototype.getNode=function(){return this.currentNode},R.prototype.endCalcFunction=function(){this.isNewNode&&(this.w5.pop(),this.x5--),this.currentNode=this.currentNode.parent},R.prototype.endCalcCell=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e]},R.prototype.clearCell=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g;if(this.vQa&&(r=e.getName(),n=t.row,o=t.col,this.z5=-1,this.source=e,(i=this.y5[r])&&(a=i[n])&&(s=a[o])&&((u=(l=s[0])&&l.h_a)&&(delete u.nia,delete u.z$a),a[o]=L,this.vQa--),"object"==typeof window))for(h in c=this.intervals)if(f=c[h]){for(d=[],p=0;p<f.length;p++)(g=f[p]).source===e&&g.row===t.row&&g.col===t.col||d.push(g);d.length?d.length!==f.length&&(d.intervalObj=f.intervalObj,c[h]=d):(c[h]=L,window.clearInterval(f.intervalObj))}},R.prototype.setAsyncResult=function(e,t){e.Fi=t},R.prototype.addRows=function(e,t,r){this.GQa(e,t,r,!0)},R.prototype.deleteRows=function(e,t,r){this.GQa(e,t,r,!1)},R.prototype.GQa=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g;if(this.vQa){if(o=e.getName(),i=this.y5[o]){for(s in a={},i)(l=i[s])&&(u=parseInt(s,10),n?a[t<=u?u+r:u]=l:u<t?a[u]=l:t+r<=u&&(a[u-r]=l));this.y5[o]=a}for(h in c=this.intervals)if(f=c[h]){for(d=[],p=0;p<f.length;p++)(g=f[p]).source===e&&n&&g.row>=t?g.row+=r:g.source===e&&!n&&(g.row<t||g.row>=t+r)&&(g.row=g.row<t?g.row:g.row-r,d.push(g));n||d.length===f.length||(d.intervalObj=f.intervalObj,c[h]=d)}}},R.prototype.addColumns=function(e,t,r){this.HQa(e,t,r,!0)},R.prototype.deleteColumns=function(e,t,r){this.HQa(e,t,r,!1)},R.prototype.HQa=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b;if(this.vQa){if(o=e.getName(),i=this.y5[o])for(a in i)if(s=i[a]){for(u in l={},s)(c=s[u])&&c.length&&(h=parseInt(u,10),n?l[t<=h?h+r:h]=c:h<t?l[h]=c:t+r<=h&&(l[h-r]=c));i[a]=l}for(d in f=this.intervals)if(p=f[d]){for(g=[],m=0;m<p.length;m++)(b=p[m]).source===e&&n&&b.col>=t?b.col+=r:b.source===e&&!n&&(b.col<t||b.col>=t+r)&&(b.col=b.col<t?b.col:b.col-r,g.push(b));n||g.length===p.length||(g.intervalObj=p.intervalObj,f[d]=g)}}},R.prototype.changeSourceName=function(e,t){var r;!this.vQa||(r=this.y5[e])&&(this.y5[t]=r,delete this.y5[e])},p=R,t.evaluateOperator=V,g=N.Convert.Pa,y=N.Convert.Rh,C=N.Convert.bc,v=N.Convert.Xh,S=N.Convert.Vh},"./src/referenceExpression.ts":function(e,t,r){"use strict";var C,n,l,w,u,o,i,a,s=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function c(e){return i.call(this,e)||this}function h(e,t,r,n,o,i){var a=new w(1);return a.row=r,a.column=n,a.rowRelative=o,a.columnRelative=i,e&&(a.source=e),t&&(a.endSource=t),a}function f(e,t,r,n,o,i,a,s,l,u,c,h,f){var d,p,g,m,b,y=new w(1);return y.isFullRow=n===C.BAND_INDEX_CONST,c=c||0,h=h||0,p=r-(a?0:c),g=n-(s?0:h),m=o-(l?0:c),b=i-(u?0:h),y.isFullRow&&0===r&&o===C.MAX_ROW_COUNT-1&&(r=o=C.BAND_INDEX_CONST),y.isFullColumn=r===C.BAND_INDEX_CONST,m<p&&(d=r,r=o,o=d,d=a,a=l,l=d),b<g&&(d=n,n=i,i=d,d=s,s=u,u=d),y.row=r,y.column=n,y.endRow=o,y.endColumn=i,y.rowRelative=a,y.columnRelative=s,y.endRowRelative=l,y.endColumnRelative=u,y.isArrayReference=f,e&&(y.source=e),t&&(y.endSource=t),y}function d(e,t,r){var n,o,i,a,s={row:-1,col:-1,rowCount:-1,colCount:-1};return e.isFullRow?(s.col=-1,s.colCount=-1):(i=e.columnRelative?(i=e.column+r)>=C.MAX_COLUMN_COUNT?i%C.MAX_COLUMN_COUNT:i:e.column,e.sf()?(s.col=i,s.colCount=1):(a=e.endColumnRelative?(a=e.endColumn+r)>=C.MAX_COLUMN_COUNT?a%C.MAX_COLUMN_COUNT:a:e.endColumn,s.col=i<=a?i:a,s.colCount=l(a-i)+1)),e.isFullColumn?(s.row=-1,s.rowCount=-1):(n=e.rowRelative?(n=e.row+t)>=C.MAX_ROW_COUNT?n%C.MAX_ROW_COUNT:n:e.row,e.sf()?(s.row=n,s.rowCount=1):(o=e.endRowRelative?(o=e.endRow+t)>=C.MAX_ROW_COUNT?o%C.MAX_ROW_COUNT:o:e.endRow,s.row=n<=o?n:o,s.rowCount=l(o-n)+1)),s}function p(e,t,r,n,o){var i=a.call(this,33)||this;return i.row=e,i.column=t,i.rowRelative=r,i.columnRelative=n,i.isReferenceError=o,i.sf=function(){return!this.isReferenceError},i.getRange=function(e,t){var r,n,o,i,a,s=this.source||this.contextSource;if(!this.isReferenceError&&s&&(n=(r=d(this,e,t)).row,o=r.col,i=s.getReference({row:n,col:o,spillRef:!0})))return a={spillRef:!0,row:n,col:o,rowCount:i.getRowCount(),colCount:i.getColumnCount()},i.isSpillError&&(a.isSpillError=!0),a},i.offset=function(e,t,r){var n=this.contextSource,o=this.source,i=this.endSource;return this.isReferenceError?m(n,o):g(n,o,i,this.row+(this.rowRelative||r?e:0),this.column+(this.columnRelative||r?t:0),this.rowRelative,this.columnRelative)},i}function g(e,t,r,n,o,i,a,s){var l=new u(n,o,i,a,s);return l.contextSource=e,l.source=t,l.endSource=r,l}function m(e,t){return g(e,t,n,0,0,!1,!1,!0)}Object.defineProperty(t,"__esModule",{value:!0}),C=r("./src/calc.common.ts"),n=void 0,l=Math.abs,i=C.Expression,s(c,i),c.prototype.sf=function(){return this.endRow===n||this.endColumn===n},c.prototype.tf=function(){return this.isFullRow&&this.isFullColumn?3:this.isFullRow?1:this.isFullColumn?2:0},c.prototype.getRange=function(e,t){return d(this,e,t)},c.prototype.offset=function(e,t,r,n,o){var i,a=this,s=a.source,l=a.endSource;return a.sf()?h(s,l,a.row+(a.rowRelative||r?e:0),a.column+(a.columnRelative||r?t:0),a.rowRelative,a.columnRelative):((i=f(s,l,a.row+(a.rowRelative||r?e:0),a.column+(a.columnRelative||r?t:0),a.endRow+(a.isFullColumn||!a.endRowRelative&&!r?0:e),a.endColumn+(a.isFullRow||!a.endColumnRelative&&!r?0:t),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,n,o)).isFullRow=a.isFullRow,i.isFullColumn=a.isFullColumn,i)},c.prototype.offset2=function(e,t,r,n,o,i){var a=this,s=f(a.source,a.endSource,a.row+(a.isFullColumn?0:e),a.column+(a.isFullRow?0:t),a.endRow+(a.isFullColumn?0:r),a.endColumn+(a.isFullRow?0:n),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,o,i);return s.isFullRow=a.isFullRow,s.isFullColumn=a.isFullColumn,s},w=c,t.ReferenceExpression=w,t.rf=h,t.uf=f,t.getRangeForReference=d,a=C.Expression,s(p,a),u=p,t.SpillReferenceExpression=u,t.BLb=g,t.lOb=m},Common:function(e,t){e.exports=r("@grapecity/js-sheets-common")}},a.c=o,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){var r,n;if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(r=Object.create(null),a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(n in t)a.d(r,n,function(e){return t[e]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/assets/",a(a.s="./src/calc.entry.ts")),e.exports=i.Spread.CalcEngine},"./node_modules_local/@grapecity/js-calc/index.js":function(e,t,r){e.exports=r("./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js")},"./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js":function(e,t){var r,n,o="object"==typeof o?o:{};function i(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}o.Spread=(n={},i.m=r={"./node_modules/webpack/buildin/global.js":function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},"./src/all.entry.ts":function(e,t,r){"use strict";var n,o,i,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/common/common.entry.ts"),t.Common=n,o=r("./src/plugins/commands/commands.entry.ts"),t.Commands=o,i=r("./src/plugins/formatter/formatter.entry.ts"),t.Formatter=i,a=r("./src/plugins/sparkline/sparkline.entry.ts"),t.Sparklines=a,s=r("./src/plugins/slicer/slicer.entry.ts"),t.Slicers=s},"./src/common/common.entry.ts":function(e,r,t){"use strict";var n,o,i,a,s,l,u,c;function h(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),n=t("./src/common/util/colorhelper.ts"),r.pc=n.pc,o=t("./src/common/util/types.ts"),r.j=o.j,i=t("./src/common/util/arrayhelper.ts"),r.k=i.k,a=t("./src/common/util/datetimehelper.ts"),r.l=a.l,s=t("./src/common/util/numberhelper.ts"),r.o=s.o,l=t("./src/common/util/regexhelper.ts"),r.q=l.q,u=t("./src/common/util/stringhelper.ts"),r.u=u.u,h(t("./src/common/util/common.ts")),c=t("./src/common/culture/cultureInfo.ts"),r.CultureInfo=c.CultureInfo,r.CultureManager=c.CultureManager,h(t("./src/common/util/functionhelper.ts"))},"./src/common/culture/cultureInfo.ts":function(e,O,B){"use strict";(function(e){var t,s,i,n,a,o,l,r,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A=this&&this.__extends||(w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function k(e){return e.split("").join(" ").toUpperCase()}function M(e){var t,r,n=[];for(t=0,r=e.length;t<r;t++)n[t]=k(e[t]);return n}function I(e,t,r){var n=k(e),o=t.indexOf(n);return-1===o&&(o=r.indexOf(n)),o}function E(){var e,t,r=v.call(this)||this;return P.call(r,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"",!1,{1:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},2:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},3:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},4:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]}},{Hundreds:"",Thousands:"",Millions:"",Billions:"10",Trillions:""}]),P.call(r,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["","","","","","",""],e=["1","2","3","4","5","6","7","8","9","10","11","12",""],e,"",!(t=["1","2","3","4","5","6","7","8","9","10","11","12",""]),["","","","","","",""],1,"yyyy'' M'' d'' dddd h:mm:ss","yyyy'' M'' d'' dddd","h:mm:ss","M'' d''",t,t,"","","yyyy-MM-dd",["","","","","","",""],"tt h:mm","yyyy'' M''","yyyy/mmmm/d"]),r.DateTimeFormat.defaultDatePattern=r.DateTimeFormat.shortDatePattern+" "+r.DateTimeFormat.longTimePattern,r.name=function(){return"ko-kr"},r.id=1042,r.isJCKCulture=!0,r}function R(){var e,t,r=S.call(this)||this;return P.call(r,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"",!1,"","",1,1,"",{1:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},2:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},3:{letters:null,numbers:["","","","","","","","","",""]}},{Hundreds:"",Thousands:"",Millions:"",Billions:"",Trillions:""}]),P.call(r,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["","","","","","",""],e=["1","2","3","4","5","6","7","8","9","10","11","12",""],e,"",!(t=["","","","","","","","","","","","",""]),["","","","","","",""],1,"yyyy''M''d'' H:mm:ss","yyyy''M''d''","H:mm:ss","M''d''",t,t,"","","yyyy/M/d",["","","","","","",""],"H:mm","yyyy''M''","yyyy/mmmm/d"]),r.DateTimeFormat.defaultDatePattern=r.DateTimeFormat.shortDatePattern+" "+r.DateTimeFormat.longTimePattern,r.name=function(){return"zh-cn"},r.id=2052,r.isJCKCulture=!0,r.localeCompare=function(e,t){return e.localeCompare(t,"en")},r}function D(){var e,t,r,n=x.call(this)||this;return P.call(n,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"",!1,"NaN ()","-",1,1,"+",{1:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},2:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},3:{letters:null,numbers:["","","","","","","","","",""]}},{Hundreds:"",Thousands:"",Millions:"",Billions:"",Trillions:""}]),P.call(n,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["","","","","","",""],e=["1","2","3","4","5","6","7","8","9","10","11","12",""],e,"",!(r=["yyyyMd","yyyyMdd","yyyyMMd","yyyyMMdd"]),["","","","","","",""],"yyyy''M''d'' H:mm:ss","yyyy''M''d''","H:mm:ss","M''d''",t=["1","2","3","4","5","6","7","8","9","10","11","12",""],t," ()","","yyyy/MM/dd",["","","","","","",""],"H:mm","yyyy''M''","yyyy/mmmm/d",r,"ggge/mmmm/d"]),n.DateTimeFormat.eras=!0,n.DateTimeFormat.defaultDatePattern=n.DateTimeFormat.shortDatePattern+" "+n.DateTimeFormat.longTimePattern,n._Ab=['gggee""MM""dd"','gggee""M""d"','ge""M""d"','ggge""M""d"','ggee""M""d"','gge""M""d"'],n.name=function(){return"ja-JP"},n.id=1041,n.isJCKCulture=!0,n}function N(){var e,t=T.call(this)||this;return P.call(t,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),P.call(t,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!(e=["MMM yyyy","MMMM yyyy"]),e]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" H:mm:ss",t.name=function(){return"en-US"},t.id=1033,t}function F(){}function _(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1}function P(e,t,r){var n,o,i;for(o=0,i=t.length;o<i;o++)n=t[o],this[e][n]=r[o]}function L(){this.bBb=1}Object.defineProperty(O,"__esModule",{value:!0}),t=B("./src/common/util/types.ts"),s=B("./src/common/util/common.ts"),i=B("./src/common/util/arrayhelper.ts"),n="undefined"!=typeof window?window:e,a=void 0,o=t.j.H,l=t.j.Ia,c=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],h=(r=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"]).concat(u=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"]),o(r,function(e,r){o(u,function(e,t){e<u.length-4&&h.push(r+" "+t)})}),h=h.concat(c),o(c,function(e,r){o(u,function(e,t){e<u.length-4&&h.push(r+" "+t)})}),_.prototype.ma=function(){var e,t,r,n;return this.na||(r=(r=[t=(e=this.DateTimeFormat).shortDatePattern.replace(/m/g,"M"),t+" h:mm",t+" h:mm:ss",t+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"]).concat(h),1041===this.id&&(n=e.eraFormatter,r=(r=r.concat(this._Ab)).concat(n)),r=r.concat(e.preselectedFormatters),this.na=r),this.na},_.prototype.oa=function(e){return this.pa||(this.pa=M(this.DateTimeFormat.monthNames),this.qa=M(this.DateTimeFormat.monthGenitiveNames)),I(e,this.pa,this.qa)},_.prototype.ra=function(e){return this.sa||(this.sa=M(this.DateTimeFormat.abbreviatedMonthNames),this.ta=M(this.DateTimeFormat.abbreviatedMonthGenitiveNames)),I(e,this.sa,this.ta)},_.prototype.ua=function(e){return this.va||(this.va=M(this.DateTimeFormat.dayNames)),this.va.indexOf(k(e))},_.prototype.wa=function(e){return this.xa||(this.xa=M(this.DateTimeFormat.abbreviatedDayNames)),this.xa.indexOf(k(e))},f=_,O.CultureInfo=f,F.I=function(e){return e>=F.J()&&e<=F.K()},F.L=function(){var e,t,r=f.eras;if(r===a)return this.O;for(e=[],t=0;t<r.length;t++)e[t]=new Date(r[t].startDate.replace(/-/g,"/"));return e},F.P=function(e){var t,r,n,o,i;switch(e){case"g":t="symbol",r=F.R;break;case"gg":t="abbreviation",r=F.S;break;case"ggg":t="name",r=F.U;break;default:return[]}if(o=[],(n=f.eras)===a)return r;for(i=0;i<n.length;i++)o[i]=n[i][t];return o},F.K=function(){var e,t=f.eras;return t!==a&&0<t.length?((e=new Date(t[t.length-1].startDate.replace(/-/g,"/"))).setFullYear(e.getFullYear()+99),e):this.W},F.J=function(){var e=f.eras;return e!==a&&0<e.length?new Date(e[0].startDate.replace(/-/g,"/")):this.Z},F.$=function(){var e=f.eras;return e!==a?e.length:this._},F.aa=function(){var e,t,r,n,o=f.eras;if(o===a)return this.ba;for(e=[],t=1;t<o.length;t++)r=new Date(o[t-1].startDate.replace(/-/g,"/")),n=new Date(o[t].startDate.replace(/-/g,"/")),e[t-1]=n.getFullYear()-r.getFullYear()+1;return e[t-1]=99,e},F.ca=function(e){var t,r={da:-1,ea:-1};if(!F.I(e))return r;for(t=0;t<F.$();t++)if(e<(t+1!==F.$()?F.L()[t+1]:F.fa(F.K(),1))){r.da=t,r.ea=e.getFullYear()-F.L()[t].getFullYear()+1;break}return r},F.fa=function(e,t){var r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());return r.setMilliseconds(r.getMilliseconds()+t),new Date(r.valueOf())},F.ga=function(e,t){return F.L()[e].getFullYear()+t-1},F.ha=function(e,t){var r,n;for(t=t.toUpperCase(),r=F.P(e),n=0;n<r.length;n++)if(r[n]===t)return n;return-1},F.ia=function(e,t,r){var n,o,i,a=F,s=a.ca(t),l=s.da;if(0<=l&&0<(n=a.P(e)).length)return n[l];if(0<=(o=s.ea)){if("1"==(i=""+o)&&r)return"";if("ee"===e)return 1===i.length&&(i="0"+i),i;if("e"===e)return i}return""},F.O=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],F._=5,F.ba=[45,15,64,31,99],F.W=new Date(2117,11,31,23,59,59),F.Z=new Date(1868,8,8),F.ja=["1,m","2,t","3,s","4,h","5,r"],F.ka=[0,1,2,3,0,1,2,3],F.U=["","","","",""],F.R=["M","T","S","H","R"],F.S=["","","","",""],F.la=99,F.eraExcelFormatter="[$-ja-JP-x-gannen]",F.eraInternalFormatter="[$-411]",O.aBb=F,A(N,T=f),d=N,A(D,x=f),p=D,A(R,S=f),g=R,A(E,v=f),m=E,b={invariant:new f,"en-us":new d,"ja-jp":new p,"zh-cn":new g,"ko-kr":new m},y={},C=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6"],L.instance=function(){return this.cBb||(this.cBb=new this)},L.prototype.culture=function(e){return 0===arguments.length?L.dBb:void(e&&L.dBb!==e&&(L.dBb=e.toLowerCase(),this.bBb++,t=L.dBb,"object"==typeof document&&("function"!=typeof CustomEvent?(r=document.createEvent("CustomEvent")).initCustomEvent("cultureChanged",!1,!1,void 0):r=new CustomEvent("cultureChanged",{}),r.cultureInfo=t,n.gcCultureInfo=t,document.dispatchEvent(r))));var t,r},L.prototype.addCultureInfo=function(e,t,r){var n,o,i,a;if(t&&t instanceof f){if(n=t.NumberFormat&&t.NumberFormat.numberDecimalSeparator,o=t.NumberFormat.arrayListSeparator,i=t.NumberFormat.arrayGroupSeparator,n===t.NumberFormat.listSeparator||i===o)throw new s.ResourceManager(s.SR).getResource().Exp_Separator;b[e.toLowerCase()]=t}r&&"object"==typeof r&&(a=e.toLowerCase(),y[a]=l(!0,{},r),this.bBb++)},L.prototype.getCultureInfo=function(e){var t,r,n;if(0===arguments.length)return b[L.dBb];for(n in"string"==typeof e&&(e=e.toLowerCase()),r=null,t=b)if(n===e||t[n].id!==a&&t[n].id===e){r=t[n];break}return r},L.prototype.getLanguage=function(e){if("string"!=typeof e)return null;var t=e.toLowerCase();return y[t]},L.prototype.eBb=function(e,t){var r,n,o=y[e.toLowerCase()];for(r in t)i.k.Bb(C,r)||null!==(n=this.fBb(o,r))&&"string"==typeof n&&"string"==typeof t[r]&&(t[r]=n);t._h&&o.Functions&&this.gBb(o.Functions,t._h),t.B2&&o.TableFunctions&&l(!0,t.B2,o.TableFunctions)},L.prototype.fBb=function(e,t){var r,n;if(e.hasOwnProperty(t))return e[t];for(r in e)if("object"==typeof(n=e[r])&&n.hasOwnProperty(t))return n[t];return null},L.prototype.gBb=function(e,t){var r,n,o,i,a,s,l;for(r in t)if(e.hasOwnProperty(r))for(s in n=t[r],o=e[r],i=n.parameters,a=o.parameters,n.description=o.description,i)a.hasOwnProperty(s)&&"string"==typeof(l=a[s])&&(i[s].name=l);return{}},L.prototype.q4=function(e){var t=this.getCultureInfo(e);return t=t||((t=b[L.dBb])||new f)},L.prototype.LZa=function(e,t){var r=(this.getCultureInfo(e)||this.getCultureInfo("en-US")).DateTimeFormat,n=r.filterDialogDateFormatter;return(0<=t.indexOf("g")||0<=t.indexOf("e"))&&(n=r.EraFilterDialogDateFormatter||n),n},L.dBb="en-us",O.CultureManager=L.instance()}).call(this,B("./node_modules/webpack/buildin/global.js"))},"./src/common/util/arrayhelper.ts":function(e,t,r){"use strict";var i;function n(){}Object.defineProperty(t,"__esModule",{value:!0}),i=null,n.Eb=function(e,t,r){e.splice(t,0,r)},n.Sb=function(e,t){e.push(t)},n.Bb=function(e,t){return-1<e.indexOf(t)},n.Fb=function(e,t){var r=e.indexOf(t);-1<r&&e.splice(r,1)},n.Zb=function(e,t){return e.slice(0,t).concat(e.slice(t+1))},n.Cb=function(e,t,r){return e.indexOf(t,r)},n.$b=function(e,t,r){if(!(t<0))for(var n=0;n<r&&t+n<e.length;n++)e[t+n]=i},n._b=function(e,t){var r;for(t<0&&(t=-1),r=t+1;r<e.length;r++)if(void 0!==e[r]&&e[r]!==i)return r;return-1},n.ac=function(e){return e&&e.length},n.Uo=function(e){var t=[];return function e(t,r){var n,o;for(n in r)r.hasOwnProperty(n)&&(o=r[n],Array.isArray(o)?(t[n]=[],e(t[n],r[n])):o!==i&&"object"==typeof o?(t[n]={},e(t[n],r[n])):t[n]=r[n])}(t,e),t},t.k=n},"./src/common/util/colorhelper.ts":function(e,t,r){"use strict";var n,i,f,d,a,p,o,u;function s(e,t,r){return r<0&&(r+=240),240<r&&(r-=240),r<40?e+((t-e)*r+20)/40:r<120?t:r<160?e+((t-e)*(160-r)+20)/40:e}function l(e,t,r){var n,o,i,a,s;return 0===r?n=o=i=p(255*t/240+"",10):(0,n=c(a=2*t-(s=t<=120?p((t*(240+r)+120)/240+""):t+r-p((t*r+120)/240+"")),s,e+80),o=c(a,s,e),i=c(a,s,e-80)),{a:255,r:n,g:o,b:i}}function c(e,t,r){return f(p((255*s(e,t,r)+120)/240+""),255)}function h(e){var t,r,n,o,i=this,a=e.r,s=e.g,l=e.b,u=d(d(a,s),l),c=f(f(a,s),l),h=u+c;i.kc=p((240*h+255)/510+"",10),0==(t=u-c)?(i.mc=0,i.lc=160):(i.kc<=120?i.mc=p((240*t+h/2)/h+"",10):i.mc=p((240*t+(510-h)/2)/(510-h)+"",10),r=(40*(u-a)+t/2)/t,n=(40*(u-s)+t/2)/t,o=(40*(u-l)+t/2)/t,i.lc=p(a===u?o-n+"":s===u?80+r-o+"":160+n-r+"",10),i.lc<0&&(i.lc+=240),240<i.lc&&(i.lc-=240))}function g(){}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/common/util/numberhelper.ts"),i=n.o.pb,f=Math.min,d=Math.max,a=Math.abs,p=parseInt,h.prototype.nc=function(e){var t=this.kc,r=this.oc(this.kc,500,!0);return l(this.lc,t+(r-t)*e,this.mc)},h.prototype.oc=function(e,t,r){return 0===t?e:r?0<t?(e*(1e3-t)+241*t)/1e3:e*(t+1e3)/1e3:((e+=240*t/1e3)<0&&(e=0),240<e&&(e=240),e)},o=h,u=/rgb[a]?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*(\d{0,1}))?\)/,g.bc=function(e){var t=e.a,r=e.r,n=e.g,o=e.b;return 3===arguments.length&&(t=255,r=e,n=arguments[1],o=arguments[2]),4===arguments.length&&(t=e,r=arguments[1],n=arguments[2],o=arguments[3]),255===t?"#"+i(r,!0,2)+i(n,!0,2)+i(o,!0,2):"rgba("+r+","+n+","+o+","+t+")"},g.Pka=function(e,t){return e.stops||e.type?JSON.stringify(e)===JSON.stringify(t):e.a===t.a&&e.r===t.r&&e.g===t.g&&e.b===t.b},g.dc=function(e){return(299*e.r+587*e.g+114*e.b)/1e3},g.hc=function(e,t){var r=255-a(e.r-t.r),n=255-a(e.g-t.g),o=255-a(e.b-t.b),i=a(e.a-t.a);return!!(.9<=((r/=255)+(n/=255)+(o/=255))/3&&i<=.05)},g.ic=function(e){var t=255^e.r,r=255^e.g,n=255^e.b;return g.bc(e.a,t,r,n)},g.hBb=function(e){var t,r,n,o,i,a,s,l;return"object"!=typeof document?/^#[A-Fa-f0-9]+$/.test(o=e)?(i=o.replace(/^#/,""),a=i.length,(s=(s=i.split(3===a?/(.)/:/(..)/)).filter(Boolean).map(function(e){return 3===a?parseInt(e+e,16):parseInt(e,16)}))[0]||(s[0]=0),s[1]||(s[1]=0),s[2]||(s[2]=0),[s[0],s[1],s[2],1]):null!==(l=u.exec(o))?[l[1],l[2],l[3],1]:null:((t=g.Yn)||(r=document.createElement("canvas"))&&r.getContext&&(t=g.Yn=r.getContext("2d")),t?(t.clearRect(1,1,1,1),t.fillStyle=e,t.fillRect(1,1,1,1),(n=t.getImageData(1,1,1,1))?n.data:null):e)},g.ec=function(e){var t,r,n,o,i;return e instanceof g||"object"==typeof e?e:(o=n=r=t=0,e&&(i=g.hBb(e))&&(r=i[0],n=i[1],o=i[2],t=i[3]),{a:t,r:r,g:n,b:o})},g.jc=function(e,t){var r,n;return 0===t?e:(r=new o(e),n=p((0<t?(240-r.kc)*t:r.kc*t)+"",10),g.gc(r.lc,r.kc+n,r.mc))},g.nc=function(e,t){var r=g.ec(e),n=new o(r).nc(t);return g.bc(n)},g.fc=s,g.gc=l,t.pc=g},"./src/common/util/common.ts":function(e,t,r){"use strict";var a,n,o,s;function i(e){this.res=e,this.cachedResource=this.iBb(e,!0),this.bBb=0}Object.defineProperty(t,"__esModule",{value:!0}),a=r("./src/common/culture/cultureInfo.ts"),n=r("./src/common/util/util.res.en.ts"),o=r("./src/common/util/types.ts"),t.SR={en:n},s=o.j.Ia,i.prototype.getResource=function(){var e=this.iBb(this.res,!this.cachedResource);return e&&(this.cachedResource=e),this.cachedResource},i.prototype.iBb=function(e,t){var r,n,o,i=a.CultureManager.culture();if(e&&i){if(r=a.CultureManager.bBb,this.bBb===r&&!t)return;return this.bBb=r,a.CultureManager.getLanguage(i)?(n=s(!0,{},e.en),a.CultureManager.eBb(i,n),n):(o=i.substr(0,2).toLowerCase(),e.hasOwnProperty(o)?e[o]:e.en)}return{}},t.ResourceManager=i,t.A=function(e,t,r,n){var o,i,a,s,l;if(e&&0<=r&&r<t){for(o=[],a=void 0,a=r;a<t;a++)void 0!==e[a]&&o.push(a);for(i=o.length,a=0;a<i;a++)l=e[s=o[i-a-1]],e[s]=null,e[Math.floor(s)+n]=l}},t.B=function(e,t,r,n){var o,i,a,s,l,u;if(e&&0<=r&&r<t){for(o=[],a=r+n,s=void 0,s=r;s<t;s++)void 0!==e[s]&&(r<=s&&s<a?e[s]=null:a<=s&&o.push(s));for(i=o.length,s=0;s<i;s++)u=e[l=o[s]],e[l]=null,e[Math.floor(l)-n]=u}},t.D=function(e,t){return e.hasOwnProperty(t)},t.F=function(e,t){return e instanceof t}},"./src/common/util/datetimehelper.ts":function(e,t,r){"use strict";var n,L,O,B,o,i,D,j,H,G,N,F,_,a,U,s;function P(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M=r.DateTimeFormat,I=M.Calendar.convert;if(!t||!t.length)return r&&r.name.length?I?P(e,M.fullDateTimePattern,r):e.toLocaleString():""+e;function E(){return s||l||(s=u.test(t),l=N),s}function R(e,t){if(f)return f[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:return}}for(o=M.eras,i="",u=/([^d]|^)(d|dd)([^d]|$)/g,c=0,h=V(),!("s"===t)&&I&&(f=I.fromGregorian(e)),p=d=-2,g={Qb:""},m=0;b=h.lastIndex,y=h.exec(t),C=t.slice(b,y?y.index:t.length),g.Qb="",c+=W(C,g),i+=g.Qb,y;m++)if(c%2!=1)switch(w=e.getFullYear(),v=e.getDay(),S=e.getHours(),x=e.getMinutes(),T=e.getSeconds(),A=e.getMilliseconds(),k=e.getTimezoneOffset(),y[0]){case"dddd":i+=M.dayNames[v];break;case"ddd":i+=M.abbreviatedDayNames[v];break;case"dd":s=N,i+=D(R(e,2),2);break;case"d":s=N,i+=R(e,2);break;case"MMMM":i+=M.monthGenitiveNames&&E()?M.monthGenitiveNames[R(e,1)]:M.monthNames[R(e,1)];break;case"MMM":i+=M.abbreviatedMonthGenitiveNames&&E()?M.abbreviatedMonthGenitiveNames[R(e,1)]:M.abbreviatedMonthNames[R(e,1)];break;case"MM":i+=D(R(e,1)+1,2);break;case"M":i+=R(e,1)+1;break;case"yyyy":case"yyy":i+=0<=d?B.aBb.ia("ee",e,n):D(f?f[0]:w,4);break;case"yy":i+=0<=d?B.aBb.ia("ee",e,n):D((f?f[0]:w)%100,2);break;case"y":i+=0<=d?B.aBb.ia("e",e,n):""+(f?f[0]:w)%100;break;case"hh":0===(a=S%12)&&(a=12),i+=D(a,2);break;case"h":0===(a=S%12)&&(a=12),i+=a;break;case"HH":i+=D(S,2);break;case"H":i+=""+S;break;case"mm":i+=D(x,2);break;case"m":i+=""+x;break;case"ss":i+=D(T,2);break;case"s":i+=""+T;break;case"tt":i+=S<12?M.amDesignator:M.pmDesignator;break;case"t":i+=(S<12?M.amDesignator:M.pmDesignator).charAt(0);break;case"f":case"0":i+=D(A,3).charAt(0);break;case"ff":case"00":i+=D(A,3).substr(0,2);break;case"fff":case"000":i+=D(A,3);break;case"z":i+=((a=k/60)<=0?"+":"-")+F(_(a));break;case"zz":i+=((a=k/60)<=0?"+":"-")+D(F(_(a)),2);break;case"zzz":i+=((a=k/60)<=0?"+":"-")+D(F(_(a)),2)+":"+D(_(k%60),2);break;case"g":case"gg":case"ggg":if(!o)break;if(d===m-1){d=m;break}i+=B.aBb.ia(y[0],e,n),d=m;break;case"e":case"ee":if(!o){i+=D(f?f[0]:w,4);break}if(p===m-1){p=m;break}i+=B.aBb.ia(y[0],e,n),p=m;break;case"/":i+=M.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[m]":case"[ss]":case"[s]":i+=y[0];break;default:throw Error(U().Exp_InvalidDateFormat)}else i+=y[0];return""+i}function W(e,t){var r,n,o,i=0,a=G;for(r=0,n=e.length;r<n;r++)switch(o=e.charAt(r)){case'"':a?t.Qb+="'":i++,a=G;break;case"\\":a&&(t.Qb+="\\"),a=!a;break;default:t.Qb+=o,a=G}return i}function V(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g}function u(e){var t=e.getTimezoneOffset();return-485===t&&(t=-485-43/60),-321===t&&(t=-321-10/60),-507===t&&(t=-507-52/60),t}function c(){}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/common/util/common.ts"),L=r("./src/common/util/stringhelper.ts"),O=r("./src/common/util/arrayhelper.ts"),B=r("./src/common/culture/cultureInfo.ts"),o=r("./src/common/util/types.ts"),i=o.j.Fa,D=L.u.Sa,j=null,H=parseInt,N=!(G=!1),F=Math.floor,_=Math.abs,a=new n.ResourceManager(n.SR),U=a.getResource.bind(a),s={},c.mb=function(e,t,r,n){return P(e,t,r=r||B.CultureManager.q4(),n)},c.Vb=function(e,t,r){return P(e,t,r||B.CultureManager.q4())},c.gBa=function(e,t,r){var n,o,i,a,s,l=G;for((s=r).slice(1).forEach(function(e){e&&(l=!0)}),l||(s=s.concat(t.ma())),n=1,o=s.length;n<o;n++)if((a=s[n])&&(l=N,i=c.Wb(e,a,t)))return i;return j},c.Qa=function(e,t,r){var n,o;return(t||r||void 0===(o=s[e]))&&(n=t?[e,t]:[e],o=c.gBa(e,r||B.CultureManager.q4(),n),t||r||(s[e]=o)),o?new Date(o):o},c.lb=function(e,t){return c.gBa(e,B.CultureManager.q4("invariant"),[e,t])},c.Wb=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P;if(e=e.trim(),(a=(i=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d;if(e.Rb){if(e.Rb[t])return e.Rb[t]}else e.Rb={};for(n=(n=(n=t).replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),o="^",i={Qb:""},a=[],l=s=0,u=V();(c=u.exec(n))!==j;)if(i.Qb="",h=n.slice(s,c.index),s=u.lastIndex,l+=W(h,i),o+=i.Qb,l%2!=1){switch(c[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":o+="(\\D+)";break;case"tt":case"t":o+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":o+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":o+=r?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":o+="(\\d{2}|\\d{4})";break;case"fff":case"000":o+="(\\d{3})";break;case"ff":case"00":o+="(\\d{2})";break;case"f":case"0":o+="(\\d)";break;case"zzz":o+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":o+="([+-]?\\d\\d?)";break;case"/":o+="/"===e.dateSeparator?"(\\/)":"([\\/\\"+e.dateSeparator+"])";break;default:throw Error(U().Exp_InvalidDateFormat)}O.k.Sb(a,c[0])}else o+=c[0];return i.Qb="",W(n.slice(s),i),o+=i.Qb,d={Tb:f=(o+="$").replace(/\s+/g,"\\s+"),Ub:a,_a:RegExp(f)},e.Rb[t]=d}(n=r.DateTimeFormat,t,o=1041===r.id))._a.exec(e))===j)return j;for(s=i.Ub,y=f=h=c=u=l=j,w=C=G,v=b=m=g=d=0,S=s.length;v<S;v++)if(x=a[v+1])switch(s[v]){case"dd":case"d":if((h=H(x,10))<1||31<h)return j;break;case"MMMM":if((c=r.oa(x))<0||11<c)return j;break;case"MMM":if((c=r.ra(x))<0||11<c)return j;break;case"M":case"MM":case"%M":if((c=H(x,10)-1)<0||11<c)return j;break;case"e":case"ee":if((u=o&&""===x?1:(N=r,F=H(x,10),_=void 0,P=new Date,N.DateTimeFormat.eras&&F<100&&(F+=(_=B.aBb.ca(P).ea)-_%100)>N.DateTimeFormat.Calendar.TwoDigitYearMax&&(F-=100),F))<0||9999<u)return j;break;case"y":case"yy":case"yyy":case"yyyy":if((u=H(x,10))<0||9999<u)return j;break;case"h":case"hh":case"H":case"HH":if((d=H(x,10))<0)return j;break;case"m":case"mm":if((g=H(x,10))<0||59<g)return j;break;case"s":case"ss":if((m=H(x,10))<0||59<m)return j;break;case"tt":case"t":if(C=(T=x.toUpperCase())===n.pmDesignator.toUpperCase(),w=T===n.amDesignator.toUpperCase(),!C&&!w)return j;break;case"f":case"0":if((b=100*H(x,10))<0||999<b)return j;break;case"ff":case"00":if((b=10*H(x,10))<0||999<b)return j;break;case"fff":case"000":if((b=H(x,10))<0||999<b)return j;break;case"dddd":if((f=r.ua(x))<0||6<f)return j;break;case"ddd":if((f=r.wa(x))<0||6<f)return j;break;case"zzz":if(2!==(A=x.split(/:/)).length)return j;if((p=H(A[0],10))<-12||13<p)return j;if((k=H(A[1],10))<0||59<k)return j;y=60*p+(L.u.kb(x,"-")?-k:k);break;case"z":case"zz":if((p=H(x,10))<-12||13<p)return j;y=60*p;break;case"g":case"gg":case"ggg":if(!x||!n.eras)return j;if((l=B.aBb.ha(s[v],x))<0)return j}if(I=(M=/^(\d|\d\d|\d\d\d):/.test(e))?new Date(1899,11,30):new Date,(R=n.Calendar.convert)&&(E=R.fromGregorian(I)),R||(E=[I.getFullYear(),I.getMonth(),I.getDate()]),u===j?u=E[0]:u<100&&(n.eras&&l!==j?u=B.aBb.ga(l||0,u):u+=30<=u?1900:2e3),c===j&&(c=E[1]),h===j&&(h=M?E[2]:1),R){if((I=R.toGregorian(u,c,h))===j)return j}else{if(I.setFullYear(u,c,h),I.getDate()!==h)return j;if(f!==j&&I.getDay()!==f)return j}return C&&d<12?d+=12:w&&12===d&&(d=0),I.setHours(d,g,m,b),y!==j&&(D=I.getMinutes()-(y+I.getTimezoneOffset()),I.setHours(I.getHours()+D/60,D%60)),I},c.Xb=function(e){var t,r=e-25569,n=0<=r?1:-1,o=u(new Date(864e5*r)),i=(864e5*e*1440+n-3181192704e6+864e5*o)/1440,a=new Date(i),s=0<=o?1:-1,l=u(new Date(i+36e5*s));if(o!==l)if(t=new Date(i+60*(l-o)*1e3),l<o){if(-1==s||l===u(a))return 999===t.getMilliseconds()?new Date(t.valueOf()+1):t}else if(o<l&&(1==s||l===u(a)))return 999===t.getMilliseconds()?new Date(t.valueOf()+1):t;return 999===a.getMilliseconds()?new Date(a.valueOf()+1):a},c.Rka=function(e){if("/OADate("===e.substr(0,8)){var t=parseFloat(e.substr(8,e.length-10));return c.Xb(t)}},c.Daa=function(e){return"/OADate("+c.Ra(e)+")/"},c.Ra=function(e){if(i(e))return 0;"number"==typeof e&&(e=new Date(e));var t=u(e);return(1440*e.getTime()+3181192704e6-864e5*t)/124416e6},c.Yb=function(e){var t,r,n=j,o=N;if(i(e)?n=c.Xb(0):e instanceof Date?n=new Date(e.valueOf()):"string"==typeof e?((t=c.Qa(e))||(isNaN(e)?c.fvb(e)?o=G:(t=new Date(e),isNaN(t.valueOf())&&(o=G),(r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/.exec(e.replace(/ |\n/g,"").trim()))&&4===r.length&&(-1!==r.indexOf(""+t.getFullYear())&&-1!==r.indexOf(""+(t.getMonth()+1))&&-1!==r.indexOf(""+t.getDate())||(o=G))):(t=c.Xb(parseFloat(e)))||(o=G)),n=t):"number"==typeof e?n=c.Xb(e):o=G,o)return n;throw U().Exp_InvalidCast},c.fvb=function(e){function t(t,e){var r=0;return e.forEach(function(e){e&&-1<t.indexOf(e)&&r++}),1<r}var r=B.CultureManager.q4().DateTimeFormat;return t(e,r.monthNames)||t(e,r.abbreviatedMonthNames)||t(e,r.dayNames)||t(e,r.abbreviatedDayNames)||function(e,t){if(e&&-1<e.indexOf(" ")){var r=e.split(" "),n=r.length;return 2<=n&&t.indexOf(r[n-2])<=-1&&!isNaN(r[n-1])}return!1}(e,r.monthNames.concat(r.abbreviatedMonthNames))},c.Ska=function(e){return e&&(e.constructor===Date||e.getUTCDate&&e.setFullYear)},t.l=c},"./src/common/util/functionhelper.ts":function(e,t,r){"use strict";var U,W,V;function u(e){return e}function c(e,t,r,n,o,i,a,s,l,u,c){var h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_=r[W],P=r[V],L=t[W],O=t[V],B=n[W],j=n[V],H=1===P,G=1===O;if(L===_&&O===P){for(b=_*P,h=R=E=I=M=0;h<_;h++)for(f=0;f<P;f++){if(p=i(r[h][f]),g=i(t[h][f]),e&&(U(p)||U(g)))return l;M+=p,I+=p*p,E+=g=u(g),R+=p*g}for(D=b*R-M*E,m=o?D/(b*I-M*M):R/I,y=o?(E*I-M*R)/(b*I-M*M):0,C=[],h=0;h<B;h++)for(C[h]=[],f=0;f<j;f++){if(p=i(n[h][f]),e&&U(p))return l;C[h][f]=0==D?t[0][0]:c(m*p+y)}return a?new a(C):C}if(G&&L===_||1===L&&O===P){for(p=[],g=[],A=P+1,k=P+2,h=0;h<_;h++){if(y=i(v=G?t[h][0]:t[0][h]),e&&U(y))return l;g[h]=H?u(y):y}for(h=0;h<_;h++)for(p[h]=[],f=0;f<P;f++){if(y=i(r[h][f]),e&&U(y))return l;p[h][f]=y}for(N=[],m=0;m<A;m++)for(N[m]=[],b=0;b<k;b++)N[m][b]=0;for(d=0;d<_;d++)for(N[0][A]+=g[d],h=0;h<P;h++)for(v=h+1,N[0][v]+=p[d][h],N[v][0]=N[0][v],N[v][A]+=p[d][h]*g[d],f=h;f<P;f++)N[x=f+1][v]+=p[d][h]*p[d][f],N[v][x]=N[x][v];for(N[0][0]=_,w=F=o?0:1;w<A;w++){if(e){if(0===N[w][w]){for(T=!1,f=w+1;!T&&f<A;f++)if(0!==N[f][w]){for(d=0;d<k;d++)x=N[w][d],N[w][d]=N[f][d],N[f][d]=x;T=!0}if(!T)return s}}else{for(h=w;h<A&&0===N[h][w];)h++;if(A<=h)return s;for(S=F;S<k;S++)v=N[w][S],N[w][S]=N[h][S],N[h][S]=v}for(v=1/N[w][w],S=F;S<k;S++)N[w][S]*=v;for(h=F;h<A;h++)if(h!==w)for(v=-N[h][w],S=0;S<k;S++)N[h][S]+=v*N[w][S];o||(N[0][A]=0)}for(C=[],G||(C[0]=[]),h=0;h<B;h++){for(G&&(C[h]=[]),v=N[0][A],f=0;f<P;f++){if(y=i(G?n[h][f]:n[f][h]),e&&U(y))return l;v+=N[f+1][A]*y}G?C[h][0]=c(v):C[0][h]=c(v)}return a?new a(C):C}return s}Object.defineProperty(t,"__esModule",{value:!0}),U=isNaN,W="rowCount",V="colCount",t.qc=function(e,t,r,n,o,i,a,s){return c(!0,e,t,r,n,o,i,s,a,u,u)},t.sc=function(e,t,r,n,o,i,a){var s,l;for(s=0;s<e[W];s++)for(l=0;l<e[V];l++)if(e[s][l]<=0)return i;return c(!1,e,t,r,n,u,o,a,null,Math.log,Math.exp)}},"./src/common/util/numberhelper.ts":function(e,t,r){"use strict";var n,o,i,y,a,C,k,g,w,m,v,S,M,I,h,A,E,R,s,l,D,u,c,N,F,_,P,b,L;function f(e,t,r,n){return t&&0!==t.length&&"i"!==t?(o=e,i=t,a=r.NumberFormat,s=n,l=d(i),p(o,l,a,s)):r&&0<r.name.length?e.toLocaleString():""+e;var o,i,a,s,l}function O(e,t){for(var r,n,o,i,a,s,l,u=h(A(e)),c={Xa:1,Ya:0};10<=u;)u/=10,c.Xa++;return n=(r=""+e).search(/e/gi),o=r.indexOf(t),-1!==n?(a=D(r,0,n),s=D(r,n+1),l=0,-1!==o&&(l=D(a,o+1).length),(i=l-S(s))<0&&(i=0)):(i=0,-1!==o&&(i=D(r,o+1).length)),c.Ya=i,c}function x(e){var t,r={Za:e.charAt(0),$a:0,_a:0},n="";for(t=1;t<e.length;t++)if("+"===(n=e.charAt(t)))r.$a=1;else{if("-"!==n){if("0"!==n)throw Error(N().Exp_InvalidExponentFormat);r._a=e.length-t;break}r.$a=-1}return r}function d(e){var t,r,n,o,i,a,s={ab:w,bb:w,cb:M,eb:0,fb:0,Rja:0,hb:w},l="",u=M,c=M,h=M,f=M,d=M,p=M,g=w,m=[];for(r=0;r<e.length;r++){if(t=e.charAt(r),u)l+=t,'"'===t&&(m.push(l),l="",u=M);else if(c){if("E"===g||"e"===g){if(!(0<=["+","-","0"].indexOf(t))){c=M,r--;continue}l+=t}else if("+"===g||"-"===g){if("0"!==t){c=M,r--;continue}l+=t}else if("0"===g){if("0"!==t){c=M,d||(d=I,s.hb=x(l)),r--;continue}l+=t}}else if("*"!==g&&"_"!==g&&"\\"!==g||""===l)if("*"===t||"_"===t||"\\"===t)p=M,""!==l&&(m.push(l),l=""),l+=t;else if("'"===t)p=M,""!==l&&(m.push(l),l=""),m.push(t);else if('"'===t)p=M,u=I,""!==l&&(m.push(l),l=""),l+=t;else if(0<=b.indexOf(t))p=I,b.indexOf(g)<0&&""!==l&&(m.push(l),l=""),l+=t;else if("."!==t||h)if("%"===t)p=M,s.fb++,""!==l&&(m.push(l),l=""),m.push(t);else if(""===t)p=M,s.Rja++,""!==l&&(m.push(l),l=""),m.push(t);else if(","===t)if(p){for(n=void 0,""!==l&&(m.push(l),l=""),o=I,i="",a=r+1;a<e.length;a++)if(n=e.charAt(a),""===i)if('"'===n)i=n;else{if(0<=b.indexOf(n)){o=M;break}if("."===n||";"===n)break}else'"'===n&&(i="");o?s.eb++:h||(n=e.charAt(r+1))&&0<=b.indexOf(n)&&(f=I)}else l+=t;else"E"===t||"e"===t?(p=M,c=I,""!==l&&(m.push(l),l="")):(p=M,0<=b.indexOf(g)&&""!==l&&(m.push(l),l="")),l+=t;else""!==l&&(m.push(l),l=""),s.ab=m,m=[],h=I,p=M;else l+=t,m.push(l),l="";g=t}return""!==l&&(c&&!d&&(s.hb=x(l)),m.push(l)),f&&(s.cb=I),h?s.bb=m:s.ab=m,s}function B(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p=(c=+(c=e),h=+(h=-t),isNaN(c)||h%1!=0?NaN:(c=(f=c<0)?-c:c,typeof h===m||0===h?(c=Math.round(c),f?-c:c):(d=(""+c).split("e"),c=Math.round(+(d[0]+"e"+(d[1]?d[1]-h:-h))),+((d=(""+(c=f?-c:c)).split("e"))[0]+"e"+(d[1]?+d[1]+h:h)))));return isFinite(p)||(p=e),a=(u=(a=""+(e=p)).split(/e/i))[0],l=1<u.length?v(u[1],10):0,a=(u=a.split("."))[0],s=1<u.length?u[1]:"",0<l?(a+=(s=g(s,l)).slice(0,l),s=D(s,l)):l<0&&(l=-l,s=(a=e<0?i+k(a.replace(i,""),l+1):k(a,l+1)).slice(-l,a.length)+s,a=a.slice(0,-l)),a+(s=0<t?o+(s=s.length>t?s.slice(0,t):g(s,t)):"")}function j(e){var t,r,n=w;if(e)for(n="",t=0;t<e.length;t++)r=e[t],/^(0|#|\?)+/g.test(r)&&(n+=r);return n}function H(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C=s.numberGroupSizes,w=s.numberGroupSeparator,v=s.negativeSign,S=s.percentSymbol,x=s.perMilleSymbol,T=n.hb,A=D(t,0,1);for(A===v&&(t=D(t,1)),t=0===(l=1===t.length&&"0"===t?0:t.length)?"":t,u=0,c="",h=e.length-1;0<=h;h--)if(f="",d=e[h],/^(0|#|\?)+/g.test(d)){if(c!==r){for(p=d.length,g=l-u-1;0<=g&&0<p;g--)f=t.charAt(g)+f,p--,u++;for(m=p-1;0<=m;m--)u++,"0"===(b=d[m])?f=b+f:"?"===b&&(""!==f&&(i.push({type:"number",value:f}),f=""),i.push({type:"numberPlaceholder",value:b}));(c=d+c)===r&&u<l&&(f=t.substr(0,l-u)+f),""!==f&&i.push({type:"number",value:f})}}else n.hb&&!a.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(d)?(a.replaceExponent=I,y="",y+=T.Za,y+=P[T.$a],y+=k(""+o,T._a),i.push({type:"exponent",value:y})):"_"===d[0]?i.push({type:"placeholder",value:d[1]}):"*"===d[0]?a.hasInfilling||(i.push({type:"fillingChar",value:d[1]}),a.hasInfilling=!0,a.infillIndex=i.length-1):"\\"===d[0]?2===d.length&&i.push({type:"text",value:d[1]}):'"'===d[0]&&'"'===d[d.length-1]?2<d.length&&i.push({type:"text",value:d.substr(1,d.length-2)}):d===S?i.push({type:"percent",value:d}):d===x?i.push({type:"permille",value:d}):L[d]?i.push({type:"currency",value:d}):i.push({type:"text",value:d});A===v&&r&&i.push({type:"text",value:A}),n.cb===I&&function(e,t,r,n){var o,i,a,s,l,u=t[0],c=1,h=0,f=M,d=e.length;for(o=0;o<d;o++)if("number"===(i=e[o].type)){for(a="",l=(s=e[o].value).length-1;0<=l;){if(!(1<=u&&u<=9||0===u&&c===t.length))throw Error(N().Exp_InvalidNumberGroupSize);/\d/gi.test(s[l])?(f&&(a&&e.push({type:"number",value:a}),e.push({type:"groupSeparator",value:r}),a="",f=M),h++):h=0,a=s[l]+a,h===u&&0<u&&(f=I,h=0,c<t.length&&(u=t[c],c++)),l--}a&&e.push({type:i,value:a})}else"fillingChar"===i&&(n.infillIndex=e.length-d),e.push({type:i,value:e[o].value});e.splice(0,d)}(i,C,w,a),i.reverse(),a.infillIndex=i.length-1-a.infillIndex}function p(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=[];return C=e,w=t.fb,v=t.Rja,S=t.eb,x=C,0<w&&(x=W(C*E(100,w),15)),0<v&&(x=W(C*E(1e3,v),15)),0<S&&(x=W(C/E(1e3,S),15)),e=x,o=t.ab,i=t.bb,(o||i)&&(a=j(o),s=(s=j(i))||"",t.hb&&(e=(u=function(e,t,r){var n,o={value:e,exponentValue:0},i=O(e,".").Xa,a=A(e),s=r?r.length:1;if(1<=a)s<i?(i-=s,o.value=e/E(10,i),o.exponentValue=i):o.exponentValue=0,-1===t.$a&&(t.$a=0);else if(a<1&&0<a){for(t.$a=-1,n=E(10,s);10*a<n;)a*=10,o.exponentValue++;o.value*=E(10,o.exponentValue)}return o}(e,t.hb,a)).value,l=u.exponentValue),c=O(e,"."),r.numberGroupSizes,r.numberGroupSeparator,h=r.numberDecimalSeparator,f=r.negativeSign,d=B(e,R(c.Ya,s.length),0,0,h,f),n||(b=h,-1!==(y=m=d).indexOf(b)&&(y=m.replace(/0+$/,"")),d=y),""===d?T.push({type:"text",value:(o?o.join(""):"")+(i?i.join(""):"")}):(p={hasInfilling:M,infillIndex:-1,replaceExponent:M},"10"!==(g=d.split(h)[0])||isNaN(l)||(g="1",l+=t&&t.hb&&-1===t.hb.$a?-1:1),o&&H(o,g,a,t,l,T,p,r),"0"!==g&&""===a&&i&&T.push({type:"number",value:g}),i&&function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b,y,C,w,v=l.numberDecimalSeparator,S=l.percentSymbol,x=l.perMilleSymbol,T=t.indexOf(v),A=o.hb;for((0<T||n!==F||r!==_)&&a.push({type:"decimalSeparator",value:v}),u=-1!==T?t.substring(T+1):"",h="",f=c=0;f<e.length;f++)if(d=e[f],/^(0|#|\?)+/g.test(d)){if(p="",h!==r){for(g=d.length,m=0,b=c;0<g&&0<u.length-c;)p+=u.charAt(b),g--,c++,m++,b++;for(y=m;0<g;)C=d[y],y++,c++,g--,"0"===C?p+=C:"?"===C&&(""!==p&&(a.push({type:"number",value:p}),p=""),a.push({type:"numberPlaceholder",value:C}));""!==p&&a.push({type:"number",value:p}),h+=d}}else A&&!s.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(d)?(s.replaceExponent=I,w="",w+=A.Za,w+=P[A.$a],w+=k(""+i,A._a),a.push({type:"exponent",value:w})):"_"===d[0]?a.push({type:"placeholder",value:d[1]}):"*"===d[0]?(a.push({type:"fillingChar",value:d[1]}),s.hasInfilling&&a.splice(s.infillIndex,1),s.hasInfilling=!0,s.infillIndex=a.length-1):"\\"===d[0]?2===d.length&&a.push({type:"text",value:d[1]}):'"'===d[0]&&'"'===d[d.length-1]?2<d.length&&a.push({type:"text",value:d.substr(1,d.length-2)}):d===S?a.push({type:"percent",value:d}):d===x?a.push({type:"permille",value:d}):L[d]?a.push({type:"currency",value:d}):a.push({type:"text",value:d})}(i,d,s,a,t,l,T,p,r))),T}function T(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b;return(e=C(e)?"":y.u.ib(e,"")).match(/^[+-]?infinity$/i)?S(e):e.match(/^0x[a-f0-9]+$/i)?v(e,10):(i=(o=G(e,r=t.NumberFormat,n=r.numberNegativePattern))[0],a=o[1],""===i&&1!==n&&(i=(o=G(e,r,1))[0],a=o[1]),""===i&&(i="+"),a[0]===r.currencySymbol&&(a=D(a,1)),(u=a.indexOf("e"))<0&&(u=a.indexOf("E")),s=u<0?(l=a,w):(l=D(a,0,u),D(a,u+1)),h=(f=l.indexOf("."))<0?(c=l,w):(c=D(l,0,f),D(l,f+1)),c=c.split(",").join(""),","!==(d=",".replace(/\u00A0/g," "))&&(c=c.split(d).join("")),p=i+c,h!==w&&(p+="."+h),p[p.length-1]===r.percentSymbol&&(p=D(p,0,p.length-1),-1===(g=(p=y.u.ib(p,"")).indexOf("."))&&(g=p.length),m="",m+=D(p,0,g-2),m+=".",m+=D(p,g-2,2),p=m+=D(p,g+1)),s!==w&&(""===(b=G(s,r,1))[0]&&(b[0]="+"),p+="e"+b[0]+b[1]),p.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?S(p):NaN)}function G(e,t,r){var n=t.negativeSign,o=t.positiveSign;if(4!==r&&2!==r||(n=" "+n,o=" "+o),4===r||3===r){if(y.u.jb(e,n))return["-",D(e,0,e.length-n.length)];if(y.u.jb(e,o))return["+",D(e,0,e.length-o.length)]}else if(2===r||1===r){if(y.u.kb(e,n))return["-",D(e,n.length)];if(y.u.kb(e,o))return["+",D(e,o.length)]}else{if(0!==r)throw Error("");if(y.u.kb(e,"(")&&y.u.jb(e,")"))return["-",D(e,1,e.length-2)]}return["",e]}function U(e){var t=a.CultureManager.q4().NumberFormat;return"string"==typeof e&&(t=a.CultureManager.q4(e).NumberFormat),t}function W(e,t){return"number"==typeof e&&t<=(""+e).length&&(e=+e.toPrecision(t)),e}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/common/util/common.ts"),o=r("./src/common/util/types.ts"),i=r("./src/common/util/regexhelper.ts"),y=r("./src/common/util/stringhelper.ts"),a=r("./src/common/culture/cultureInfo.ts"),C=o.j.Fa,k=y.u.Sa,g=y.u.Ta,w=null,m=void 0,v=parseInt,S=parseFloat,I=!(M=!1),h=Math.floor,A=Math.abs,E=Math.pow,R=Math.min,s="#dot#",l="#group#",D=function(e,t,r){return e.substr(t,r)},u=function(e){return i.q.qb(e)},c=new n.ResourceManager(n.SR),N=c.getResource.bind(c),F="##################0",_="################",P={1:"+",0:"","-1":"-"},b=["0","#","?"],L={"":"",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH":"GH","":"","..":"..",XDR:"XDR","..":"..","..":"..","..":"..","..":"..","":"","..":"..","..":"..","...":"...","..":"..","..":"..","..":"..","..":"..","..":"..","..":"..","..":"..","..":"..",S:"S","":"","..":"..","..":"..","..":"..","":"",TSh:"TSh","":"","":"","":"",K:"K",".":".","":"",CFA:"CFA","":"","":"",KM:"KM","":"",USh:"USh","K":"K","kr.":"kr.",Ksh:"Ksh",CHF:"CHF",".":".","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","":"",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","":"",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","":"","Bs.":"Bs.","":"",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","":"",ISK:"ISK","":"","":"","":"","":"","":"","":"",Kz:"Kz","":"",MTn:"MTn","":"","":"","":"","Afl.":"Afl.",".":".",".":".","z":"z","":"",R$:"R$",Db:"Db",RON:"RON","":"",MAD:"MAD",".":".","Lek":"Lek",den:"den",RSD:"RSD",".":".","..":"..","Rs.":"Rs.","":"","":"","m.":"m.","":"","":"","som":"som","":"","":"",HK$:"HK$",MOP:"MOP",NT$:"NT$"},t.o={Qa:function(e){return T(e,a.CultureManager.q4())},lb:function(e){return T(e,a.CultureManager.q4("invariant"))},mb:function(e,t,r,n){return f(e,t,r=r||a.CultureManager.q4(),n)},nb:function(e,t){var r,n,o;return"string"!=typeof e||(n=(r=U(t)).numberDecimalSeparator,o=r.numberGroupSeparator,"."!==n&&(e=e.replace(u("[.]"),s)),","!==o&&(e=e.replace(u("[,]"),l)),"."!==n&&(e=e.replace(u(s),n)),","!==o&&(e=e.replace(u(l),o))),e},Oa:function(e,t){var r,n,o;return"string"!=typeof e||(n=(r=U(t)).numberDecimalSeparator,o=r.numberGroupSeparator,"."!==n&&(e=e.replace(u("["+n+"]"),s)),","!==o&&(e=e.replace(u("["+o+"]"),l)),"."!==n&&(e=e.replace(u(s),".")),","!==o&&(e=e.replace(u(l),","))),e},Xia:function(e,t){var r,n,o;return!("string"==typeof e&&(n=(r=U(t)).numberDecimalSeparator,o=r.numberGroupSeparator,"."!==n&&"."!==o&&0<=e.indexOf(".")||","!==n&&","!==o&&0<=e.indexOf(",")))},ob:function(e,t){return S(this.Oa(e,t))},pb:function(e,t,r){if(0!==A(h(e)-e))throw Error(N().Exp_BadFormatSpecifier);var n=0<=e?e.toString(16):(4294967295+e+1).toString(16);return n=t?n.toLowerCase():n.toUpperCase(),!C(r)&&n.length<r?k(n,r):n},Hja:d,Ija:p,Jja:function(e){var t,r,n,o="";if(Array.isArray(e)&&0<e.length)for(t=0;t<e.length;t++)if(r=e[t].type,n=e[t].value,"placeholder"===r)o+=" ";else{if("fillingChar"===r)continue;o+="numberPlaceholder"===r?" ":n}return o},eka:F,fka:_,Lma:W}},"./src/common/util/regexhelper.ts":function(e,t,r){"use strict";var o;function l(){}Object.defineProperty(t,"__esModule",{value:!0}),o=r("./src/common/util/stringhelper.ts"),l.qb=function(e){var t=l.rb[e];return(t=t||(l.rb[e]=RegExp(e,"g"))).lastIndex=0,t},l.sb=function(e){var t=l.tb[e];return(t=t||(l.tb[e]=RegExp(e,"gi"))).lastIndex=0,t},l.ub=function(e,t,r){var n,o,i,a,s;if(l.vb[e])return l.wb[e];if(l.qb("[~?*]+").test(e)){for(n=[],o=e.split(""),a={".":!(i=void 0),"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0},s=0;s<o.length;s++)"~"===(i=o[s])&&s<o.length-1?("*"===(i=o[++s])||"?"===i?n.push("\\"):t&&n.push("~"),n.push(i)):"?"===i?n.push("."):"*"===i?(n.push("[\\s\\S]"),r?n.push("+"):n.push("*")):(a[i]&&n.push("\\"),n.push(i));return n.join("")}return null},l.zb=function(e,t,r){var n=l.ub(e,t,r);return n=n&&"^"+n+"$"},l.xb=function(e,t){for(var r="#"+e+"0#",n=1;0<t.indexOf(r);)r=o.u.yb(r,"#"+e+(n-1)+"#","#"+e+n+"#"),n++;return r},l.Ab=function(e){return e.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},l.rb={},l.tb={},l.vb={},l.wb={},t.q=l},"./src/common/util/stringhelper.ts":function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=t("./src/common/util/regexhelper.ts");function n(e,t,r){return e.substr(t,r)}function a(e){return null==e}function s(e,t,r,n){var o,i;if(a(t))throw Error();return""===t||!(t.length>e.length)&&(o=e,i=t,r&&(o=o.toLowerCase(),i=i.toLowerCase()),n(o,i))}o.u={Bb:function(e,t,r){return r&&(e=e.toLowerCase(),t=t.toLowerCase()),""===t||0<=e.indexOf(t)},Cb:function(e,t,r){var n,o;return r?(n=e.toLowerCase(),o=t.toLowerCase(),n.indexOf(o)):e.indexOf(t)},Db:function(e,t){if(!t)return e;for(var r=e;n(r,0,t.length)===t;)r=n(r,t.length);return r},ib:function(e,t){if(!t)return e;for(var r=e;n(r,r.length-t.length,t.length)===t;)r=n(r,0,r.length-t.length);return r},Eb:function(e,t,r){if(t<0||t>e.length||a(r))throw Error();return n(e,0,t)+r+n(e,t,e.length-t)},Fb:function(e,t,r){if(a(r)&&(r=e.length-t),t<0||r<0||t+r>e.length)throw Error();return n(e,0,t)+n(e,t+r,e.length-t-r)},kb:function(e,t,r){return void 0===r&&(r=!1),s(e,t,r,function(e,t){return e.slice(0,t.length)===t})},jb:function(e,t,r){return void 0===r&&(r=!1),s(e,t,r,function(e,t){return e.slice(-t.length)===t})},Gb:function(e,t,r,n){if(!t)throw Error();return r=(""+r).replace(/\$/g,"$$$$"),e.replace(RegExp(t,"g"+(n?"i":"")),r)},Hb:function(e,t,r,n){return t=i.q.Ab(t),o.u.Gb(e,t,r,n)},Ib:function(e,t){var r=e.indexOf(t);return r<0||r>=e.length?e:n(e,0,r)},Jb:function(e,t){for(var r=0,n=e.indexOf(t);0<=n;)r+=1,n=e.indexOf(t,n+1);return r},yb:function(e,t,r){return e.split(t).join(r)},Kb:function(e,t){var r,n,o=e;for(r=0;r<t.length;r++)n=RegExp("\\{"+r+"\\}","g"),o=o.replace(n,t[r]);return o},Lb:function(e,t,r){var n,o=""+e;for(n=o.length;n<t;n++)o=r?"0"+o:o+"0";return o},Sa:function(e,t){return o.u.Lb(e,t,!0)},Ta:function(e,t){return o.u.Lb(e,t,!1)},Mb:function(e,t){return e===t||!e&&!t||e&&t&&e.toLowerCase()===t.toLowerCase()},Nb:function(e){return e.toUpperCase()},Ob:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r=i.q.qb("(?:&|<|>|\"|'|`)");return r.test(e)?e.replace(r,function(e){return t[e]}):e},Pb:function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},r=i.q.qb("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return r.test(e)?e.replace(r,function(e){return t[e]}):e},BIc:function(e){return e.replace(/javascript:/gi,"")}}},"./src/common/util/types.ts":function(e,f,t){"use strict";Object.defineProperty(f,"__esModule",{value:!0}),f.j={r4:null,H:function(e,t){var r,n,o;if(f.j.ya(e))for(r=0,n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(o in e)if(e.hasOwnProperty(o)&&!1===t.call(e[o],o,e[o]))break;return e},za:function(e){return!e||"object"==typeof e&&0===Object.keys(e).length},Aa:function(e){return"function"===f.j.Ba(e)},Ca:function(e){return Array.isArray?Array.isArray(e):"array"===f.j.Ba(e)},Da:function(e){return f.j.jk(e)&&(e=parseFloat(e)),!isNaN(e)&&isFinite(e)},jk:function(e){return"string"==typeof e},Ba:function(e){var t,r,n,o,i,a;if(null===e)return"null";if(!(t=f.j.r4))for(t=f.j.r4={},n=0,o=(r=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"]).length;n<o;n++)t["[object "+r[n]+"]"]=r[n].toLowerCase();return i=t.toString,"object"==(a=typeof e)||"function"==a?t[i.call(e)]||"object":a},Ea:function(e,t,r){var n,o;if(t){if(o=[].indexOf)return o.call(t,e,r);for(n=t.length,f.j.Fa(r)&&(r=0),r=r<0?Math.max(0,n+r):r;r<n;r++)if(r in t&&t[r]===e)return r}return-1},Ga:function(e,t){var r=t.length,n=e.length,o=0;if("number"==typeof r)for(;o<r;o++)e[n++]=t[o];else for(;void 0!==t[o];)e[n++]=t[o++];return e.length=n,e},Ha:function(e,t,r){var n,o,i,a,s=[];if(f.j.ya(e))for(o=0,i=e.length;o<i;o++)null!==(n=t(e[o],o,r))&&(s[s.length]=n);else for(a in a=void 0,e)e.hasOwnProperty(a)&&(null!==(n=t(e[a],a,r))&&(s[s.length]=n));return s.concat([])},Ia:function(){var e,t,r,n,o,i,a,s,l,u,c,h=[];for(e=0;e<arguments.length;e++)h[e]=arguments[e];for(s=h[0]||{},l=1,u=h.length,c=!1,"boolean"==typeof s&&(c=s,s=h[1]||{},l=2),"object"==typeof s||f.j.Aa(s)||(s={}),u===l&&(s=this,--l);l<u;l++)if(i=h[l],!f.j.Fa(i))for(o in i)t=s[o],s!==(n=i[o])&&(r=f.j.Ca(n),c&&n&&(f.j.Ja(n)||r)?(a=r?t&&f.j.Ca(t)?t:[]:t&&f.j.Ja(t)?t:{},s[o]=f.j.Ia(c,a,n)):void 0!==n&&(s[o]=n));return s},G:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},Ka:function(e){return null!==e&&e===e.window},Ja:function(e){var t,r;if(!e||"object"!==f.j.Ba(e)||e.nodeType||f.j.Ka(e))return!1;t={}.hasOwnProperty;try{if(e.constructor&&!t.call(e,"constructor")&&!t.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(r in e);return void 0===r||t.call(e,r)},ya:function(e){if(f.j.Fa(e))return!1;var t=e.length,r=f.j.Ba(e);return!f.j.Ka(e)&&(!(1!==e.nodeType||!t)||"array"===r||"function"!==r&&(0===t||"number"==typeof t&&0<t&&t-1 in e))},La:function(e,t){var r=t||[];return null!==e&&(f.j.ya(Object(e))?f.j.Ga(r,"string"==typeof e?[e]:e):[].push.call(r,e)),r},Ma:null,Fa:function(e){return null==e},Na:null,Pa:null,C4:function(e){if(!e)return e;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||f.j.Fa(e))return e;if(e.clone)return e.clone();if(e instanceof Date)return new Date(e.valueOf());var t,r,n;for(r in t=e instanceof Object?new e.constructor:new e.constructor(e.valueOf()),e)e.hasOwnProperty(r)&&(n=e[r],e.hasOwnProperty(r)&&t[r]!==n&&(t[r]="object"==typeof n?f.j.C4(n):n));return t.toString=e.toString,t.valueOf=e.valueOf,t}}},"./src/common/util/util.res.en.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_InvalidDateFormat="Invalid date format pattern",t.Exp_InvalidExponentFormat="invalid exponent format",t.Exp_InvalidSemicolons="invalid format : too many semicolons",t.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",t.Exp_BadFormatSpecifier="Bad Format Specifier",t.Exp_InvalidNumberFormat="Invalid number format pattern",t.Exp_InvalidCast="InvalidCastException",t.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info."},"./src/plugins/commands/commands.entry.ts":function(e,t,r){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/plugins/commands/commands.ts"),t.Key=n.Key,t.CommandManager=n.CommandManager,o=r("./src/plugins/commands/undomanager.ts"),t.UndoManager=o.UndoManager},"./src/plugins/commands/commands.ts":function(e,t,r){"use strict";var a,l,n;function o(e){this.xc=e,this.Ze={},this.wc={}}function i(e,t,r){var o,i;this.tc=e,this.j4=t,this.Cj=r,o=this,Object.defineProperty(o,"shortcutKey",{get:function(){return o.vc},set:function(e){var t,r,n=o.vc;n!==e&&(!(t=(i=o.tc.wc)[n])||0<=(r=t.indexOf(o))&&t.splice(r,1),(o.vc=e)&&((t=i[e])||(i[e]=t=[]),t.splice(0,0,o)))}})}Object.defineProperty(t,"__esModule",{value:!0}),(n=a=t.Key||(t.Key={}))[n.left=37]="left",n[n.right=39]="right",n[n.up=38]="up",n[n.down=40]="down",n[n.tab=9]="tab",n[n.enter=13]="enter",n[n.shift=16]="shift",n[n.ctrl=17]="ctrl",n[n.space=32]="space",n[n.altkey=18]="altkey",n[n.home=36]="home",n[n.end=35]="end",n[n.pup=33]="pup",n[n.pdn=34]="pdn",n[n.backspace=8]="backspace",n[n.del=46]="del",n[n.esc=27]="esc",n[n.a=65]="a",n[n.c=67]="c",n[n.v=86]="v",n[n.x=88]="x",n[n.z=90]="z",n[n.y=89]="y",i.prototype.canUndo=function(){return this.j4.canUndo},i.prototype.execute=function(e,t,r){var n,o=!0;try{o=!1!==(n=(this.j4.execute||this.j4)(e,t,1===r))}catch(e){o=!1}return t&&o&&this.tc.g4({command:t,result:n,s4:r}),n},l=i,o.prototype.register=function(e,t,r,n,o,i,a){var s=new l(this,t,e);this[e]=s,r&&(s.shortcutKey=this.getShortcutKey(r,n,o,i,a))},o.prototype.getCommand=function(e){return this[e]},o.prototype.execute=function(e){var t=this[e.cmd];if(t)return t.execute(this.xc,e,0)},o.prototype.setShortcutKey=function(e,t,r,n,o,i){var a,s,l,u;if(e)(a=this[e])&&(a.shortcutKey=this.getShortcutKey(t,r,n,o,i));else if(s=this.getShortcutKey(t,r,n,o,i),l=this.getCommands(s))for(u=l.length-1;0<=u;u--)l[u].shortcutKey=void 0},o.prototype.getShortcutKey=function(e,t,r,n,o){if(e){var i="A".charCodeAt(0)<=e&&e<="Z".charCodeAt(0)?String.fromCharCode(e):a[e];return(i=i||e)+(t?"+ctrl":"")+(r?"+shift":"")+(n?"+alt":"")+(o?"+window":"")}},o.prototype.getCommands=function(e){return this.wc[e]},o.prototype.addListener=function(e,t){this.Ze[e]=t},o.prototype.removeListener=function(e){delete this.Ze[e]},o.prototype.g4=function(e){var t,r=this.Ze;for(t in r)r.hasOwnProperty(t)&&r[t](e)},o.prototype.no=function(){this.xc=null},t.CommandManager=o},"./src/plugins/commands/undomanager.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.Cc=function(e,t){var r,n,o;if(e)if(1===t)this.Bc.push(e);else{if(r=this.yc,n=this.Ac.length,0<r&&r<=n)for(o=0;o<n-r+1;o++)this.Ac.shift();this.Ac.push(e),0===t&&(this.Bc=[])}},o.prototype.canUndo=function(){return 0<this.Ac.length},o.prototype.undo=function(){var e,t,r=this.Ac,n=!0;if(this.zc&&this.canUndo()){e=r[r.length-1];try{(t=this.xc.commandManager()[e.cmd])&&(e.yTa=!0,n=t.execute(this.xc,e,1))}catch(e){n=!1}delete e.yTa,!1!==n&&(r.pop(),this.Bc.push(e))}return n},o.prototype.canRedo=function(){return 0<this.Bc.length},o.prototype.redo=function(){var e,t,r=this.Bc,n=!0;if(this.zc&&this.canRedo()){e=r[r.length-1];try{(t=this.xc.commandManager()[e.cmd])&&(e.yTa=!0,n=t.execute(this.xc,e,2))}catch(e){n=!1}delete e.yTa,!1!==n&&(r.pop(),this.Ac.push(e))}return n},o.prototype.clear=function(){this.Ac=[],this.Bc=[]},o.prototype.PY=function(e){this.Ac=this.Ac.filter(e),this.Bc=this.Bc.filter(e)},o.prototype.no=function(){this.xc=null},o);function o(e,t,r){this.xc=e,t<0&&(t=2147483647),this.yc=t,this.zc=r,this.Ac=[],this.Bc=[]}t.UndoManager=n},"./src/plugins/formatter/formatter.entry.ts":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(t("./src/plugins/formatter/formatter.ts"))},"./src/plugins/formatter/formatter.res.en.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_TokenIsNull="token is null",t.Exp_InvalidBackslash="the '\\' cannot be evaluated",t.Exp_FormatIllegal="format is illegal.",t.Exp_ValueIsNull="value is null",t.Exp_DuplicatedDescriptor="The type of descriptor was added.",t.Exp_TokenIllegal="token is illegal.",t.Exp_ValueIllegal="value is illegal.",t.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(e,t,r){"use strict";var k,M,I,n,x,o,i,a,c,E,T,C,b,s,y,w,h,l,u,R,f,d,p,S,A,g,D,N,F,m,_,v,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee=this&&this.__extends||(Q=function(e,t){return(Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}Q(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function te(e,t,r,n){var o;Se.call(this,t,r,n),o=we(e,!1),t&&(o=be(o,this.Ic.Kc,this.Ic.currencySymbol())),o=ye(o=ge(o)),this.Yc=o,this._c=3}function re(e,t,r,n){Se.call(this,t,r,n),0<arguments.length?(re.kBb(e)||L(),this.Bd=e):this.Bd="General",this._c=0}function ne(e,t,r,n){var o,i,a,s,l;Se.call(this,t,r,n),(o=this).Ad=!1,o._c=1,o.Bd=ge(e),i=we(e),t&&(i=be(i,o.Ic.Kc,o.Ic.currencySymbol())),-1<(i=ge(i)).indexOf("/")&&((a=function(e,t){var r,n,o,i,a,s=[];if(e===E||""===e)return s;for(r=!1,o=!(n=[]),i=0;i<e.length;i++)'"'!==(a=e[i])||r||(o=!o),r||o||a!==t?n.push(a):(s.push(n.join("")),n=[]),r="\\"===a&&!r;return s.push(n.join("")),s}(i,"/"))&&2===a.length&&(o.Cd=a[1],(s=a[0])&&(-1<(l=s.lastIndexOf(" "))?(o.Dd=he(s,0,l),o.Ed=he(s,l+1,s.length-l-1)):o.Ed=s))),o.Fd=i}function oe(e,t){xe.call(this,t),this.foreColor=e}function ie(e,t){var r,n;if(xe.call(this,t),"h"===(r=v(e)[0]))n=3600;else if("m"===r)n=60;else{if("s"!==r)throw Error(c().Exp_TokenIllegal);n=1}this.Tc=function(e){var t=e/1e3/n;return Math.abs(t-Math.round(t))<1e-6?Math.round(t):Math.floor(t)}}function ae(e,t,r,n,o,i){Se.call(this,t,r,n,i);this.Yc=this.Zc(we(e)),this.$c=o,this._c=2,this.ad()}function se(e,t){xe.call(this,t);if(this.token=e,this.type=parseInt(k.u.Fb(e,0,5),10),this.type<0||4<this.type)throw Error(c().Exp_TokenIllegal)}function le(e,t){var n,r,o,i,a,s,l,u;for(xe.call(this,t),n=this,s=0,l=(a=["<=","<>",">=",">","<","="]).length;s<l;s++)if(r=a[s],k.u.kb(e,r,!0)){o=k.u.Fb(e,0,r.length),u=parseFloat(o),N(u)||(i=u);break}if(i===E&&i===T)throw Error(c().Exp_TokenIllegal);n.value=i,n.Sc=r,n.isMeetCondition=function(e){var t=n.Sc,r=n.value;switch(t){case"<=":return e<=r;case"<>":return e!==r;case">=":return r<=e;case">":return r<e;case"<":return e<r;case"=":return e===r}}}function ue(e,t){this.formatCached=e,this.cultureName=t,this.typeName=""}function ce(e,t){var r,n,o;if(xe.call(this,t),this.Uc=e,n=Ce((r=this.Uc)[0],"$",!1),o=r.indexOf("-"),!(n&&-1<o))throw Error(c().Exp_TokenIllegal);this.Vc=he(r,1,o-1),0<(r=k.u.Fb(r,0,o+1)).length&&(this.Wc=parseInt(r,16))}function he(e,t,r){return e.substr(t,r)}function fe(e){return I.j.Fa(e)?"":"boolean"==typeof e?e?"TRUE":"FALSE":"string"==typeof e?e:""+e}function de(e,t){if("\\"===e[t])throw Error(c().Exp_InvalidBackslash);if(0<t-1&&t-1<e.length&&"\\"===e[t-1]){if(t-2<0)return 1;if(0<t-2&&t-2<e.length)return"\\"!==e[t-2]}}function pe(e){if(!e)throw Error(c().Exp_TokenIsNull);return"["+e+"]"}function ge(e){var t,r,n,o,i;if(e===T||e===E||""===e)return e;for(t="",n=!1,o=r=0;o<e.length;o++)'"'===(i=e[o])?(n=!n,t+=i):n?t+=i:"["===i?r++:"]"===i?--r<0&&(r=0):0===r&&(t+=i);return""+t}function me(e){return e=be(e,"[",""),be(e,"]","")}function be(e,t,r){return!e||e===B.Dc||Ce(t,r,!0)?e:(t=t.replace(l,"\\$1"),e.replace(RegExp(t,"g"),r))}function ye(e){var t,r,n=e.length,o=!1,i="";for(t=0;t<n;t++)"\\"===(r=e.charAt(t))?(o=!o)||(i+=r):(o=!1,i+=r);return i}function Ce(e,t,r){return r?v(e)===v(t):e===t}function we(e,t){var r,n,o,i;for(1===arguments.length&&(t=!0),r=!1,n="",o=0;o<e.length;o++){if('"'===(i=e[o]))r=!r;else if(!r&&!t&&"/"===i&&!de(e,o))continue;n+=i}return n}function ve(e,t){var r,n,o;if(!e||e===B.Dc)return!1;for(r=function(e){var t,r,n,o="",i=!1;for(t=0,r=e.length;t<r;t++)'"'===(n=e[t])&&(i=!i),"E"===n||i||(o+=v(n));return o}(we(e)),n=0;n<t.length;n++){if(0===(o=r.indexOf(t[n])))return!0;if(0<o&&"_"!==r[o-1]&&"*"!==r[o-1])return!0}return!1}function Se(e,t,r,n){this.Ic=e,this.Jc=t,this.cultureName=r,this.nOb=n}function xe(e){this.Kc=e}function Te(e){var t,r,n=me(e);return n&&n!==B.Dc&&(r=n[0],-1<["<",">","="].indexOf(r)?(t=U).Name="ConditionalFormatPart":k.u.kb(n,"DBNum",!0)?(t=W).Name="DBNumberFormatPart":Ce(n[0],"$",!1)&&-1<n.indexOf("-")?(t=H).Name="LocaleIDFormatPart":function(e){var t,r=v(e),n=r[0];if("h"!==n&&"m"!==n&&"s"!==n)return;for(t=1;t<r.length;t++)if(n!==r[t])return;return 1}(n)?(t=z).Name="ABSTimeFormatPart":n.indexOf("$")<0&&3<=n.length&&((t=q).Name="ColorFormatPart")),t}function Ae(e,t,r){var n,o;return n=e?e.cultureInfo():F(r),(t<4||4===t&&("ko-kr"===r||"ko-kr"===n.name()))&&(o=n.NumberFormat.dbNumber)?o[t]:E}function ke(e,t){var r=$.call(this,e,t)||this,n=r;return n.Sd=!0,n.PropertyChanged=[],B.Ec(e)&&(e="General"),n.formatCached=e,n.cultureName=t,n.init(),r}function Me(e,t){0===arguments.length?(this.formatCached="General",this.Rd=new Y):this.ad(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),k=r("./src/common/util/stringhelper.ts"),M=r("./src/common/util/datetimehelper.ts"),I=r("./src/common/util/types.ts"),n=r("./src/common/util/numberhelper.ts"),x=r("./src/common/culture/cultureInfo.ts"),o=r("./src/common/util/common.ts"),i=r("./src/plugins/formatter/formatter.res.en.ts"),I.j.Ia(o.SR.en,i),a=new o.ResourceManager(o.SR),c=a.getResource.bind(a),I.j.Ma=function(e,t){if(I.j.Fa(e))return"null"===t;if(!t)return!1;if(t instanceof Function&&e instanceof t)return!0;if(typeof e===t)return!0;if("function"===t&&/^\s*\bfunction\b/.test(""+e))return!0;if(Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===t.toLowerCase())return!0;if("DateTime"===t)return e instanceof Date;if("TimeSpan"!==t)return"string"==typeof t&&"undefined number boolean string".indexOf(t),!1;if(e instanceof Date){var r=M.l.Ra(e);return 0<=r&&r<1}return!1},I.j.Na=function(e,t){return!!n.o.Xia(e,t)&&(e=n.o.Oa(e,t),I.j.Ma(e,"number")||I.j.Ma(e,"DateTime")||I.j.Ma(e,"TimeSpan")||e&&!I.j.Ma(e,"boolean")&&!isNaN(e)&&!isNaN(parseFloat(e))&&!(2<=e.length&&"0"===e[0]&&"x"===e[1]))},I.j.Pa=function(e){return I.j.Fa(e)||""===e?0:I.j.Ma(e,"number")?e:I.j.Ma(e,"string")&&!isNaN(e)?n.o.Qa(e):I.j.Ma(e,"boolean")?e?1:0:I.j.Ma(e,"DateTime")?M.l.Ra(e):I.j.Ma(e,"TimeSpan")?Math.floor(M.l.Ra(e)):parseFloat(e)},E=null,T=void 0,C=Math.abs,b={Rc:"yy",vd:"y",Qc:"yyyy",jd:"m",hd:"mm",gd:"mmm",fd:"mmmm",dd:"mmmmm",ud:"d",wd:"dd",kd:"aaa",ld:"aaaa",md:"h",nd:"hh",xd:"m",yd:"mm",td:"s",zd:"ss",ea:"e",rd:"AM/PM",sd:"A/P",ed:"@mmmmm",qd:new Date(1899,11,30,0,0,0,0)},s=[b.vd,b.Rc,b.Qc,b.jd,b.hd,b.gd,b.fd,b.dd,b.ud,b.wd,b.kd,b.ld,b.md,b.nd,b.xd,b.yd,b.td,b.zd,"ggg","gg","g","ee","e"],y="",w="",h={Hc:0,Va:1,Ua:2,_text:3},l=RegExp("([.+?*$^\\[\\](){}|/])","g"),u=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],R=I.j.Ma,f=I.j.Ca,d=n.o,p=d.eka+"."+d.fka,S=d.Jja,A=d.mb,g=d.Lma,D=I.j.Fa,N=isNaN,F=function(e){return x.CultureManager.q4(e)},m=function(e){return F(e).DateTimeFormat},_=function(e){return F(e).NumberFormat},v=function(e){return e&&e.toLowerCase()},P=function(e){return e&&e.toUpperCase()},L=function(){throw Error(c().Exp_FormatIllegal)},O=function(){return x.CultureManager.booleanMapping},B={Dc:"",Kb:function(){var e,t,r,n,o,i,a=[];for(e=0;e<arguments.length;e++)a[e]=arguments[e];for(t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(0===arguments.length)return E;for(n=t[0],o=1;o<arguments.length;o++)i=RegExp("\\{"+(o-1)+"\\}","gm"),n=n.replace(i,arguments[o]);return n},Ec:function(e){return!e||e===B.Dc}},j={Fc:function(e){var t=e.charCodeAt(0);return 48<=t&&t<=57},Gc:function(e){var t=e.charCodeAt(0);return 9<=t&&t<=13||32===t||133===t||160===t}},ce.prototype.cultureInfo=function(){return this.Xc||(this.Xc=F(this.Wc),this.Vc&&this.Vc!==B.Dc&&!this.Xc.NumberFormat.isReadOnly&&(this.Xc.NumberFormat.currencySymbol=this.Vc)),this.Xc},ce.prototype.currencySymbol=function(){return this.Vc?k.u.Gb(this.Vc,"\\.",'"."'):B.Dc},ce.prototype.allowScience=function(){if(this.Xc)return!this.Xc.isJCKCulture},ce.prototype.toString=function(){return this.Uc?pe(this.Uc):B.Dc},ce.Name="LocaleIDFormatPart",H=ce,ue.prototype.format=function(e){return E},ue.prototype.parse=function(e){return E},ue.prototype.formatString=function(e){return this.formatCached},ue.prototype.toJSON=function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},ue.prototype.fromJSON=function(e){if(e)for(var t in e)e[t]!==T&&(this[t]=e[t])},G=ue,t.FormatterBase=G,le.prototype.toString=function(){return pe(this.Sc+(""+this.value))},U=le,se.prototype.Pc=function(e,t,r){var n,o,i,a,s,l,u,c,h,f;if(!e||e===B.Dc)return e;for(s=!(a=i=-1),h=(o=n=e).length-1;0<=h;h--)f=o[h],!N(f)&&!Ce(f," ",!1)||Ce(f,".",!1)&&!s?(Ce(f,".",!1)&&(s=!0),-1===i&&(i=h),a=h):-1<a&&-1<i&&(l=he(o,a,i-a+1),u=parseFloat(l),N(u)||(c=se.numberString(l,t,r),n=k.u.Fb(n,a,i-a+1),n=k.u.Eb(n,a,c)),s=!(a=i=-1));return-1<a&&-1<i&&(l=he(o,a,i-a+1),u=parseFloat(l),N(u)||(c=se.numberString(l,t,r),n=k.u.Fb(n,a,i-a+1),n=k.u.Eb(n,a,c))),n},se.prototype.toString=function(){if(-1<this.type)return pe("DBNum"+this.type);throw Error()},se.numberString=function(e,t,r){var n=se.formatNumberString,o=e.split(".");if(o){if(1===o.length)return n(o[0],t.numbers,r?t.letters:E);if(2===o.length)return n(o[0],t.numbers,r?t.letters:E)+"."+n(o[1],t.numbers)}throw Error(c().Exp_ValueIllegal)},se.formatNumberString=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m=e,b=0,y=0;if(2===arguments.length){for(o="",b=0;b<m.length;b++)n=he(m,b,1),o+=t[y=parseInt(n,10)];return o}if(3===arguments.length){if(!r)return se.formatNumberString(e,t);for(i=0,a="",s=m.length,l=!1,u=[],b=0;b<s;b++)-1<(c=r.length-1-b)?u.push(""+r[c]):u.push(B.Dc);for(h=[],f=u.length-1;0<=f;f--)h[u.length-f-1]=u[f];for(u=h,d=!1,f=0;f<s;f++)n=he(m,f,1),y=parseInt(n,10),p=void 0,g=B.Dc,0<s-f-16?(p=t[y],d=!(g="")):f!==s-1&&f!==s-5&&f!==s-9&&f!==s-13?"0"===n?(g=p="",i+=1):(p="0"!==n&&0!==i?t[0]+t[y]:t[y],g=u[f],i=0):"0"!==n&&0!==i?(p=t[0]+t[y],g=u[f],i=0):"0"!==n&&0===i||d?(p=t[y],g=u[f],i=0,d=!1):("0"===n&&3<=i?g=p="":11<=s?p="":(p="",g=u[f]),i+=1),p+g===B.Dc||(l=!1),f!==s-13||l||(g=u[f],l=!0),f!==s-9||l||(g=u[f],l=!0),f===s-1&&(g=u[f],l=!0),a=a+p+g;return 0===parseInt(e,10)?t[0]:a}},W=se,ae.prototype.ad=function(){var e,t,r,n=this,o={Qb:n.Yc};if(ae.Lc(o.Qb)){if(e=n.bd(o),n.hasJD=n.Gb(o.Qb,b.dd,'"'+b.ed+'"',!0,!1,o,!1),n.Gb(o.Qb,b.fd,"MMMM",!0,!1,o,!1),n.Gb(o.Qb,b.gd,"MMM",!0,!1,o,!1),n.Gb(o.Qb,b.hd,"MM",!0,!1,o,!1),n.Gb(o.Qb,b.jd,"M",!0,!1,o,!1),n.Gb(o.Qb,b.kd,"ddd",!0,!0,o,!0),n.Gb(o.Qb,b.ld,"dddd",!0,!0,o,!0),e||(n.Gb(o.Qb,b.md,"H",!0,!0,o,!1),n.Gb(o.Qb,b.nd,"HH",!0,!0,o,!1)),n.Jc&&n.Ic&&(n.od=n.od||n.Gb(o.Qb,b.Qc,'"@'+b.Qc+'"',!0,!1,o,!0),n.od=n.od||n.Gb(o.Qb,b.Rc,'"@'+b.Rc+'"',!0,!1,o,!0)),n.$c)for(t=0;t<n.$c.length;t++)r=n.$c[t],n.Gb(o.Qb,r.Kc,"@"+r.Kc,!0,!0,o,!0);n.pd=o.Qb}else L()},ae.prototype.formatString=function(){return this.Yc},ae.prototype.format=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p=this,g=B.Dc,m=E;try{if((m=M.l.Yb(e))&&N(m.valueOf())&&(m=E),m?e=m:g=""+e,m&&(g=M.l.mb(m,p.pd,p.Ic&&p.Ic.cultureInfo()||F(p.cultureName),p.nOb),p.hasJD&&(t=F(p.cultureName).DateTimeFormat.monthNames[m.getMonth()],g=k.u.Gb(g,b.ed,he(t,0,1))),p.$c))for(r=24*(M.l.Ra(m)-M.l.Ra(b.qd))*60*60*1e3,n=0;n<p.$c.length;n++)i=(o=p.$c[n]).Tc(r),D(i)||(a=o.Kc.replace("[","\\[").replace("]","\\]"),g=k.u.Gb(g,"@"+a,i))}catch(t){g=fe(e)}return s=g,l=e,u=p.Ic,c=p.Jc,h=p.cultureName,d=s,!D(c)&&l instanceof Date&&(f=Ae(u,c.type,h),d=c.Pc(d,f,!0),1===c.type&&(d=d.replace(RegExp(y,"g"),w)),d=(d=d.replace("@"+b.Qc,M.l.Vb(l,b.Qc))).replace("@"+b.Rc,M.l.Vb(l,b.Rc)),d=c.Pc(d,f,!1)),d},ae.prototype.parse=function(e){var t,r,n,o;if(!e||e===B.Dc)return E;if("true"===(r=v(t=e)))return!0;if("false"===r)return!1;if(this.pd&&(n=M.l.Wb(t,this.pd,F(this.cultureName))))return n;try{return(o=M.l.Yb(t))&&!N(o)?o:(o=new Date(t),N(o.valueOf())?t:o)}catch(e){return t}},ae.prototype.Zc=function(e){var t,r,n,o=e,i="",a=!1;for(t=0;t<o.length;t++)'"'===(r=o[t])?a=!a:a||("Y"===r||"D"===r||"S"===r||"E"===r||"G"===r?r=v(r):"M"===r&&(Ce("A",n=o[t-1],!0)||Ce("P",n,!0)||(r=v(r)))),i+=r;return i},ae.prototype.bd=function(e){var t,r=[b.rd,m(this.cultureName).amDesignator+"/"+m(this.cultureName).pmDesignator,b.sd],n=["tt","tt","t"],o=e.Qb;for(t=0;t<3;t++){if(k.u.Bb(o,n[t]))return!0;if(k.u.Bb(o,r[t],!0))return e.Qb=k.u.Gb(o,r[t],n[t],!0),!0}return!1},ae.prototype.Gb=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b;if(n||o){for(s=[],l=!0,!ae.hasDate(e)&&ae.hasTime(e)&&(l=!1),u=!1,c=0;c<e.length;c++){if(h=e[c],ae.hasTime(h)&&!u?l=!1:ae.hasDate(h)&&!u&&(l=!0),n&&Ce(h,t[0],a)&&l||o&&Ce(h,t[0],a)&&!l){for(f=!0,d=0;d<t.length;d++)if(d+c>=e.length||!Ce(t[d],e[d+c],a)){f=!1;break}if(p=c+t.length-1,f&&1+p<e.length){for(g=e[p],m=-1,m=1+p;m<e.length&&Ce(g,e[m],a);m++);1+p<m&&(c=m,f=!1)}f&&!u&&s.splice(0,0,c)}'"'===h&&(u=!u)}if(i.Qb=e,0<s.length){for(c=0;c<s.length;c++)b=s[c],i.Qb=k.u.Fb(i.Qb,b,t.length),i.Qb=k.u.Eb(i.Qb,b,r);return!0}return!1}return!1},ae.hasTime=function(e){return-1<k.u.Cb(e,b.md[0],!0)||-1<k.u.Cb(e,b.td[0],!0)},ae.hasDate=function(e){return-1<k.u.Cb(e,b.Rc[0],!0)||-1<k.u.Cb(e,b.ud[0],!0)},ae.Lc=function(e,t){return ve(e,t||s)},V=ae,t.lxb=V,ie.Name="ABSTimeFormatPart",z=ie,oe.prototype.toString=function(){return pe(this.foreColor)},oe.Name="ColorFormatPart",q=oe,ne.prototype.formatString=function(){return this.Bd},ne.prototype.format=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v;return R(e,"boolean")?(""+e).toUpperCase():(t=this,r=I.j.Pa(e),N(r)||!isFinite(r)||N(e)?"string"==typeof e?e:E:(n=F(t.cultureName),t.Ed&&t.Cd?(u={value:0},c={value:0},h={value:0},f=t.bPa(),ne.getFraction(r,f,u,c,h)?(1<(d=ne.getGCD(c.value,h.value))&&(c.value/=d,h.value/=d),t.Dd?(l="",1===h.value&&(u.value+=c.value,c.value=0,h.value=0),(p=S(A(u.value,t.Dd,n)))&&"0"!==p&&(l+=p,l+=" "),0===u.value&&r<0&&(l+=n.NumberFormat.negativeSign),0===r&&(l+="0"),o=t.Cd,i=parseFloat(o),!N(i)&&0<i&&(0!==c.value&&0!==h.value&&(c.value*=i/h.value),h.value=i,o=o.replace(/^\d+/,ne.toNumberPlaceholder(i)),s=(a=Math.ceil(c.value))-c.value,c.value=s<=.5&&0<=s?parseFloat(""+a):parseFloat(""+(a-1))),g=t.Ed,m=parseFloat(g),N(m)||0!==m||(b=g.length,(C=(y=""+c.value).length)<b?g=g.substr(0,b-(b-C)):b<C&&(y=y.substr(0,C-(C-b)),c.value=parseInt(y,10))),w=t.Mja(c.value,h.value,g,o,n),0===c.value&&(w=w.replace(/./g," "),""===p)?"0 "+w:""===(l+=w)?"0":l):(l="",v=u.value*h.value+c.value,o=t.Cd,0<(i=parseFloat(o))?(v*=i/h.value,h.value=i,l+=(v=(s=(a=Math.ceil(v))-v)<=.5&&0<=s?parseFloat(""+a):parseFloat(""+(a-1)))+"/"+h.value):l+=t.Mja(v,h.value,t.Ed,t.Cd,n),0===v?"0":l)):""+r):function(e,t,r,n,o){var i,a,s,l,u,c,h;if(D(n)||(i=Ae(r,n.type,o),D(i)))return e;for(a=!1,s=void 0,l=F(o),u=void 0,c=0,h=e.length;c<h;c++)"decimalSeparator"===e[c].type&&(a=!0,e[c].value=n.Pc(e[c].value,i,t),s=e[c].value),"number"===e[c].type&&(e[c].value=a?n.Pc(s+e[c].value,i,t).slice(1):n.Pc(e[c].value,i,t),"ja-JP"===l.name()&&1<e[c].value.length&&(""===(u=e[c].value.substr(0,2))||""===u||""===u)&&(e[c].value=e[c].value.substr(1)));return e}(A(r,t.Fd,n),t.Ad,t.Ic,t.Jc,t.cultureName)))},ne.prototype.parse=function(e){var t,r,n,o,i,a,s,l,u,c,h=this;return e&&e!==B.Dc?!!("TRUE"===(t=P(e))||t===O()&&O().boolean_true)||!("FALSE"===t||t===O()&&O().boolean_false)&&(r=h.Ed&&h.Cd,n=h.Jd(h.Fd).Kd,(r||n)&&0<(o=e.indexOf("/"))&&o<e.length-1&&(i=parseInt(e.substr(0,o),10),a=parseInt(e.substr(o+1),10),!isNaN(i)&&!isNaN(a)&&0!==a)?i/a:(e=h.Hd(e),e=h.Id(e),l=(s=h.Jd(e)).Kd,u=s.Ld,h.jBb(u)&&(u=k.u.Hb(u,_(h.cultureName).numberGroupSeparator,"",!1),c=d.ob(u,h.cultureName),!N(c)&&isFinite(c))?(l&&(c=g(c/100,15)),c):E)):E},ne.prototype.bPa=function(){var e,t,r=this.Cd,n=0;if(r)for(e=r.length,t=0;t<e&&r[t].match(/[#?0\d]/);t++)n++;return n},ne.prototype.jBb=function(e){var t,r="",n=0,o=0,i=0,a=E,s=_(this.cultureName);for(t=e.length-1;-1<t;t--){if(e[t]===s.numberDecimalSeparator)n++,0<i&&(a=!1),r="";else if("e"===v(e[t])){if(o++,r="",t===e.length-1)return!1}else if(e[t]===s.numberGroupSeparator)a=3===r.length,i++,r="";else if("-"===e[t]||"+"===e[t]){if(0<t&&"e"!==v(e[t-1]))return!1}else{if(!j.Fc(e[t]))return!1;if(r+=e[t],0===t&&0===parseInt(r,10)&&a)return!1}if(1<n||1<o||!1===a)return!1}return!0},ne.prototype.Hd=function(e){var t,r,n,o,i,a,s=e,l=[];for(t=0;t<s.length;t++)j.Fc(s[t])&&l.push(t);for(n=[(r=_(this.cultureName)).currencyDecimalSeparator,r.currencyGroupSeparator,r.currencySymbol,r.nanSymbol,r.negativeInfinitySymbol,r.negativeSign,r.numberDecimalSeparator,r.numberGroupSeparator,r.percentDecimalSeparator,r.percentGroupSeparator,r.percentSymbol,r.perMilleSymbol,r.positiveInfinitySymbol,r.positiveSign],o=s.length-1;-1<o;o--)if(i=s[o],!j.Gc(i)||-1<n.indexOf(""+i)){if(("-"===i||"+"===i)&&(a=0<o?""+s[o-1]:E,["e","E","(",_(this.cultureName).currencySymbol].indexOf(a)<0))break}else(o<l[0]||l[l.length-1]<o)&&(s=k.u.Fb(s,o,1));return s},ne.prototype.Id=function(e){var t=_(this.cultureName).currencySymbol,r=k.u.kb(e,t)?k.u.Fb(e,0,t.length):e;return r.indexOf(t)<0?r:e},ne.prototype.Jd=function(e){var t=_(this.cultureName).percentSymbol,r=!0,n=e;return k.u.kb(e,t)?n=k.u.Fb(e,0,t.length):k.u.jb(e,t)?n=k.u.Fb(e,e.length-t.length,t.length):r=!1,k.u.Bb(n,t)&&(r=!1),{Ld:n,Kd:r}},ne.prototype.Mja=function(e,t,r,n,o){var i=S(A(e,r,o)),a=S(A("0."+t,"#."+n,o,!0)),s=i+"/"+a.substr(a.indexOf(".")+1);return""===r&&(s=e+s),""===n&&(s+=t),s},ne.getGCD=function(e,t){var r,n;if(0===e)return C(t);if(0===t)return C(e);for(n=Math.max(e,t)%(r=Math.min(e,t));0!==n;)n=r%(r=n);return C(r)},ne.getFraction=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p=0,g=0,m=0,b=0,y=Math.ceil;for(0<e?p=1==(b=e-y(e)+1)?(b=0,e):y(e)-1:e<0&&(p=y(e),b=y(e)-e),(i=Math.pow(10,t-1))<2&&(i=2),(a=Math.pow(10,t)-1)<2&&(a=2),s=!1,l=0,u=i;u<=a&&(c=u*b,h=Math.round(c),d=C((f=h/u)-b),!((!s||d<C(l-b))&&(s=!0,l=f,g=h,m=u,d<1e-5)));u++);return r.value=p,n.value=g,o.value=m,s},ne.toNumberPlaceholder=function(e){return(""+e).replace(/\d/g,"?")},Z=ne,re.kBb=function(e){var t,r,n="",o=!1,i=-1,a=e.length;for(t=0;t<a;t++)'"'===(r=e[t])?i=(o=!o)?t:-1:o||(n+=r);return 0<i&&(n+=e.substring(i,a)),!(0<=n.indexOf("0")||0<=n.indexOf("#")||0<=n.indexOf(".")||0<=n.indexOf("@"))},re.prototype.Nd=function(){var e;return this.Od||(e=be(e=this.Bd,"General",p),this.Od=new Z(e,this.Ic,this.Jc,this.cultureName),this.Od.Ad=!0),this.Od},re.prototype.Pd=function(){return this.Qd||(this.Qd=new Z("0.#####E+00",this.Ic,this.Jc,this.cultureName),this.Qd.Ad=!0),this.Qd},re.prototype.formatString=function(){return k.u.Gb(this.Bd,"@NumberFormat","General")},re.prototype.format=function(e){var t,r;if(I.j.Na(e,this.cultureName)){if(t=!this.Ic||this.Ic.allowScience(),(r=I.j.Pa(e))!==T&&r!==E)return 99999999999<C(r)&&t||C(r)<1e-11&&0!==r?this.Pd().format(e):this.Nd().format(e)}else{if(R(e,"string"))return ye(k.u.Gb(this.formatString(),'"',"")),e;if(R(e,"boolean"))return(""+e).toUpperCase()}return""},re.prototype.parse=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p;return B.Ec(e)?E:"number"==typeof e?e:(t=!1,r=e.trim(),0<(n=k.u.Cb(r,"-",!1))&&!Ce(r.charAt(n-1),"E",!0)&&(t=!0),a=(i=(o=F(this.cultureName)).DateTimeFormat).dateSeparator,s=i.timeSeparator,l=i.monthNames,u=i.abbreviatedMonthNames,c=function(e,t){var r,n,o;if(!t||0===t.length)return!1;for(r=!1,n=0,o=t.length;n<o;n++)if(k.u.Bb(e,t[n],!0)){r=!0;break}return r},(t||k.u.Bb(r,a,!1)||k.u.Bb(r,s,!1)||k.u.Bb(r,"/",!1)||k.u.Bb(r,":",!1)||k.u.Bb(r,"-",!1)||k.u.Bb(r,"",!1)||k.u.Bb(r,"",!1)||k.u.Bb(r,"",!1)||c(r,l)||c(r,u)||"ja-JP"===o.name()&&0<=x.aBb.R.indexOf(r[0].toUpperCase())&&k.u.Bb(r,".",!1))&&(h=M.l.Qa(r))?h:((p="("===(r=(d="-"===r.charAt(0))?k.u.Fb(r,0,1):r).charAt(0)&&")"===r.charAt(r.length-1))&&(r=r.substring(1,r.length-1)),(f=this.Nd().parse(r))!==E&&f!==T?(p||d)&&R(f,"number")?-1*C(f):f:e))},Y=re,te.prototype.format=function(e){var t,r;try{return t=e instanceof Date?""+M.l.Ra(e):fe(e),r=this.Kja(this.Yc),this.Lja(t,r)}catch(e){return""}},te.prototype.parse=function(e){return e||""},te.prototype.formatString=function(){return this.Yc},te.prototype.Kja=function(e){var t,r,n="",o=!1,i=E,a=[];for(r=0;r<e.length;r++)t=e.charAt(r),o?('"'!==t?n+=t:(n+=t,a.push(n),n="",o=!1),i=t):"*"!==i&&"_"!==i&&"\\"!==i||""===n?"*"!==t&&"_"!==t&&"\\"!==t?"@"!==t?'"'!==t?(n+=t,i=t):(i=t,""!==n&&a.push(n),n=t,o=!0):(i=t,""!==n&&(a.push(n),n=""),a.push(t)):(i=t,""!==n&&(a.push(n),n=""),n+=t):(n+=t,a.push(n),n="");return""!==n&&a.push(n),a},te.prototype.Lja=function(e,t){var r,n,o=[],i=!1;for(r=t.length-1;0<=r;r--)"*"===(n=t[r])[0]?i||(i=!0,o.push({type:"fillingChar",value:n[1]})):"_"===n[0]?o.push({type:"placeholder",value:n[1]}):'"'===n[0]&&'"'===n[n.length-1]?2<n.length&&o.push({type:"text",value:n.substr(1,n.length-2)}):"@"===n[0]?o.push({type:"text",value:e}):o.push({type:"text",value:n});return o.reverse()},K=te,X=function(){return{pattern:u,formatter:["d-mmm","mmm-yy",m().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",m().shortDatePattern+" h:mm",m().shortDatePattern+" h:mm:ss",m().shortDatePattern+" h:mm:ss.0"]}},Me.prototype.ad=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S;for(e!==E&&e!==T||L(),r=e,(n=this).formatCached=e,i=o="",l=s=a=!1,u=[],c=0;c<e.length;c++)'"'===(h=e[c])?(s=!s,i+=h):s?i+=h:"["===h?(a&&L(),i&&(o=o||"",o+=i),i=""+h,a=!0):"]"===h?(a||L(),i?((d=Te(f=""+(i+=h)))?"ABSTimeFormatPart"===d.Name?(u.push(new d(Me.preProcessPart(f),f)),o+=i):f===x.aBb.eraExcelFormatter?(n.addPart(d,x.aBb.eraInternalFormatter),l=!0):n.addPart(d,f):(o+=p=Me.partToNormalStr(f),r=be(e,f,p)),i=""):L(),a=!1):i+=h;i?a?L():o+=i:o=o||n.o$a(),n.localeIDFormatPart&&(t=n.localeIDFormatPart.cultureInfo().name()),g=n.conditionalFormatPart,w=g,S=!1,v=ve(C=(C=o)?""+C:B.Dc,["general"])?Y:V.Lc(C)?V:ve(C,["E+","E-","#",".",",","%","0","/","?"])||w?(S=!0,Z):(S=!0,K),y=(m={Mc:S,Nc:v}).Mc?r:o,(b=m.Nc)?n.Rd=new b(y,n.localeIDFormatPart,n.dbNumberFormatPart,t,0<u.length?u:E,l):L()},Me.prototype.o$a=function(){var t=this,e="";return t.dbNumberFormatPart&&(Me.proNames.some(function(e){return"dbNumberFormatPart"!==e&&t[e]})||(e="General")),e},Me.prototype.formatString=function(){var e,t,r,n="";for(e=0,t=Me.proNames.length;e<t;e++)this[r=Me.proNames[e]]&&(n+=""+this[r]);return n+this.Rd.formatString()},Me.prototype.addPart=function(e,t){var r,n,o,i=Me.proNames,a=Me.preProcessPart(t);for(r=0,n=i.length;r<n;r++)if(Ce(o=i[r],e.Name,!0)){if(this[o])throw Error(c().Exp_DuplicatedDescriptor);this[o]=new e(a,t)}},Me.prototype.format=function(e){return this.Rd.format(e)},Me.prototype.parse=function(e){return this.Rd.parse(e)},Me.checkFormatter=function(e){if(!e||e===B.Dc)throw Error(c().Exp_TokenIllegal)},Me.preProcessPart=function(e){Me.checkFormatter(e);var t=me(e);return Me.checkFormatter(t),t},Me.partToNormalStr=function(e){var t=Me.preProcessPart(e);return"$"===t[0]&&(t=t.slice(1)),'"'+t+'"'},Me.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],J=Me,ee(ke,$=G),ke.prototype.toJSON=function(){var e={formatCached:this.formatCached};return this.cultureName&&(e.customerCultureName=this.cultureName),"general"===v(this.formatCached)&&delete e.formatCached,e},ke.prototype.hasFormatedColor=function(){var e,t;for(e in h)if(h.hasOwnProperty(e)&&(t=this.getFormatter(h[e]))&&t.colorFormatPart)return!0;return!1},ke.prototype.formatString=function(e){var t,r,n;if(0===arguments.length){for(t=B.Dc,r=0,n=this.formatters.length;r<n;r++)t+=this.formatters[r].formatString(),r!==n-1&&(t+=";");return t}if(!e)throw Error(c().Exp_ValueIsNull);return this.formatters=E,this.formatCached=e,this.init(),this.Td("formatString"),this},ke.prototype.getFormatter=function(e){return this.formatters&&this.formatters[e]},ke.prototype.getPreferredEditingFormatter=function(e){var t,r,n=m(this.cultureName),o=ke.defFormatter;return R(e,"TimeSpan")?o(n.longTimePattern):R(e,"DateTime")?(t=0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?"":" h:mm:ss",o(n.shortDatePattern+t)):I.j.Na(e,this.cultureName)?o(1e20<=(r=I.j.Pa(e))||r<=1e-17&&0<r||r<=-1e20||r<0&&-1e-17<=r?"0.##E+00":p):o("General")},ke.prototype.getPreferredDisplayFormatter=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A=ke.defFormatter;if((t=t||{value:E}).value=E,B.Ec(e))return new ke;if(r=e,n=t.value=this.parse(r),R(n,"DateTime")||R(n,"TimeSpan")){for(i=(o=X()).pattern,a=o.formatter,0<(u=(l=(s=F(this.cultureName)).DateTimeFormat).preselectedFormatters).length&&(i=i.concat([u]),a=a.concat([u[0]])),"ja-JP"===s.name()&&(i=i.concat([l.eraFormatter]),a=a.concat(["ge.M.d"]),c=s._Ab.filter(function(e){return"ggge"===e.substr(0,4)}),i=i.concat([c]),a=a.concat(['ggge""M""d"']),h=s._Ab.filter(function(e){return"gge"===e.substr(0,3)}),i=i.concat([h]),a=a.concat(['gge""M""d"']),f=s._Ab.filter(function(e){return"ge"===e.substr(0,2)}),i=i.concat([f]),a=a.concat(['ge""M""d"'])),d=0;d<i.length;d++)for(p=i[d],g=0;g<p.length;g++)if(m=p[g],(b=M.l.Qa(e,m))&&b-n==0)return new ke(a[d])}else if(I.j.Na(n,this.cultureName)){if(C=(y=_(this.cultureName)).currencySymbol,w=y.numberDecimalSeparator,v=y.percentSymbol,S=y.numberGroupSeparator,T=(x=k.u.Bb)(r,w)?".00":"",r[0]===C)return A(B.Kb("{0}#,##0{1};[Red]({0}#,##0{1})",C,T));if(x(r,"E",!0))return A("0.00E+00");if(""+r[0]===v||""+r[r.length-1]===v)return A(B.Kb("0{0}%",T));if(x(r,S))return A(B.Kb("#,##0{0}",T))}return A("General")},ke.prototype.format=function(e,t){var r,n,o,i,a;if(R(e,"boolean"))return O()&&(e=e?O().boolean_true:O().boolean_false),(""+e).toUpperCase();if(n=0,o=this.Ud(e)){i=o.colorFormatPart,t&&i&&(t.conditionalForeColor=t.value=i.foreColor),(r=I.j.Na(e,this.cultureName))&&(n=I.j.Pa(e)),a=B.Dc;try{r&&o===this.getFormatter(h.Va)?a=o.format(o.considerNegSymbol?n:C(n)):(a=o.value)===T&&(a=o.format(e)),t&&(t.content=f(a)?a:[{type:"text",value:a}]),f(a)&&(a=d.Jja(a))}catch(t){R(e,"string")&&(a=""+e)}return a}return r&&n<0?"-":R(e,"string")||e!==T&&e!==E?""+e:B.Dc},ke.prototype.parse=function(e){return this.formatters&&0<this.formatters.length?this.formatters[0].parse(e):E},ke.prototype.init=function(){var e,t,r,n=this.formatCached;for(B.Ec(n)&&L(),this.formatters=[],e=n.split(";"),this.Sd=1===e.length,(!e||e.length<1||4<e.length)&&L(),t=0;t<e.length;t++)r=new J(e[t],this.cultureName),this.formatters.push(r);this.getFormatter(h.Hc)||L()},ke.prototype.Ud=function(e){var t,r,n,o,i,a,s,l=this.getFormatter(h.Hc),u=l&&l.conditionalFormatPart,c=this.getFormatter(h._text);if("string"==typeof e&&N(e))return c||(u?e:l);if(I.j.Na(e,this.cultureName)||R(e,"boolean")){if(t=this.getFormatter(h.Va),r=this.getFormatter(h.Ua),n=I.j.Pa(e),o=u&&l.conditionalFormatPart.isMeetCondition(n),a=(i=t&&t.conditionalFormatPart)&&t.conditionalFormatPart.isMeetCondition(n),s=void 0,this.Sd||(u?o:0<n||0===n&&!r))s=l;else if(i?a:n<0)s=t;else if(r)s=r;else if(t){if(u&&i)return{value:n+""};s=t}return s&&(!u||i||s!==t||r||(s.considerNegSymbol=!0),u&&i&&s===t&&t.conditionalFormatPart&&t.conditionalFormatPart.isMeetCondition(1e-10)&&(s.considerNegSymbol=!0)),s}return E},ke.prototype.Td=function(e){var t,r;if(this.PropertyChanged)for(t=0;t<this.PropertyChanged.length;t++)"function"==typeof(r=this.PropertyChanged[t])&&r(this,e)},ke.defFormatter=function(e){var t=ke[e];return t||(t=new ke(e),ke[e]=t),t},t.GeneralFormatter=ke},"./src/plugins/slicer/slicer.entry.ts":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(t("./src/plugins/slicer/slicer.ts"))},"./src/plugins/slicer/slicer.ts":function(e,t,r){"use strict";var n,I,E,i,a,s,o,R,l,u;function y(e){return e&&e.text!==I}function c(){}function h(e,t){var r,n,o;if(e!==E&&e!==I){if(v(e)===i)t.value=e;else if(v(e)===s)t.value=e?1:0;else if(e instanceof Date)t.value=R.Ra(e);else{if(v(e)!==a)return;if(0===D(e=e.trim()))return;if(r=!1,"%"===e.charAt(D(e)-1)&&(r=!0,e=e.substr(0,D(e)-1)),2<=D(e)&&"0"===e[0]&&"x"===e[1])return;if(n=(+e).valueOf(),isNaN(n)||!isFinite(n)){if(o=new Date(e),isNaN(o))return;n=R.Ra(o)}r&&(n/=100),t.value=n}return 1}}function C(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p=e.Ce;for(p||(e.Ee=[],e.Ie=[]),t=p?e.De:e.Ee,r=e.Fe,n=e.Ge,o=p?e.He:e.Ie,i=e.Je,a=e.Ke,s=e.Le,l=D(e.data),c=0;c<l;c++){for(h=!1,f=void 0,d=0;d<D(i)&&(f=i[d],p&&f===e.Me||(n[f]?(u=e.getExclusiveRowIndex(e.columnNames[f],c),h=!n[f][u]):r[f]&&(h=!r[f][c]),!h));d++);!h&&p&&(a?h=!a[u=e.getExclusiveRowIndex(e.columnNames[f],c)]:s&&(h=!s[c])),h||(t[c]=!0)}for(d=0;d<D(t);d++)t[d]&&o.push(d)}function m(e){return"string"==typeof e?e.toLowerCase():e instanceof Date?R.Ra(e):e}function w(e,t){var r,n,o,i,a,s,l,u=e.Oe,c=e.Pe,h=e.Se,f=e.Qe,d=e.Re,p=e.data,g=d[t]=[];for(e._e=[],u[t]=[],c[t]=[],h[t]={},f[t]=[],r={},n=0;n<D(p);n++)i=y(o=p[n][t])?o.text.trim():o,u[t].push(i),(a=r[m(i)])?(a.list.push(n),g[n]=a.index):(s=[n],c[t].push(i),f[t].push(s),l=D(f[t])-1,h[t][i]=l,g[n]=l,r[m(i)]={list:s,index:l})}function f(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g=e.Te,m=e.getColumnIndex(t),b=[];if(!m)return b;if(n=e.Ce?e.Ue:e.Ve[m],o=e.Ee,!n)return b;for(g[m]||e.We(m),i=[],a=g[m],s=0;s<D(a);s++)u=y(l=e.data[s][m])?l.value:l,i[a[s]]=u;for(c=e.af[m],s=0;s<D(n);s++){for(h=n[s],f=!1,p=(d=e.Xe(i,h)).start;p<=d.end;p++)if(o[c[p]]){f=!0;break}f!==r&&b.push(h)}return b}function p(e,t){var r,n,o,i,a,s,l,u=[],c={},h=e.getColumnIndex(t);if(0<=h)for(r=e.Ke||e.Le,n=e.Ge[h]||e.Fe[h],o=e.Ce&&h===e.Me?r:n,a=D((i=!!e.Fe[h])?e.getData(t):e.getExclusiveData(t)),s=0;s<a;s++)o&&!o[s]&&(c[l=i?e.getExclusiveRowIndex(t,s):s]||(c[l]=!0,u.push(l)));return u}function d(e,t){e.Ce=!1,e.Ke=[],e.He=[],e.De=[],e.Le=[],t&&e.onFiltered()}function g(e,t){var r,n=this;for(n.Ne={},n.Oe=[],n.Pe=[],n.Se=[],n.Qe=[],n.Re=[],n.Ge=[],n.Ye=[],n.Fe=[],n.Ve=[],n.Ee=[],n.Ie=[],n.Je=[],n.He=[],n.De=[],n.Ce=!1,n.Ze=[],n.$e=0,n._e=[],n.af=[],n.Te=[],n.bf(e,t),r=0;r<D(n.data);r++)n.Ee[r]=!0,n.Ie.push(r)}function b(e){return e===E||e===I}function v(e){return typeof e}function D(e){return e?e.length:0}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/common/util/datetimehelper.ts"),I=void 0,E=null,i="number",a="string",s="boolean",o=n.l.Ra,(u=t.FilteredOutDataType||(t.FilteredOutDataType={}))[u.all=0]="all",u[u.byCurrentColumn=1]="byCurrentColumn",u[u.byOtherColumns=2]="byOtherColumns",(l=t.SlicerAggregateType||(t.SlicerAggregateType={}))[l.average=1]="average",l[l.count=2]="count",l[l.counta=3]="counta",l[l.max=4]="max",l[l.min=5]="min",l[l.product=6]="product",l[l.stdev=7]="stdev",l[l.stdevp=8]="stdevp",l[l.sum=9]="sum",l[l.vars=10]="vars",l[l.varp=11]="varp",c.Ra=function(e){return o(e)},c.quickSort=function(e){var t,r=D(e),n=[];for(t=0;t<r;t++)n[t]={index:t,value:e[t]};return c.quickSortImp(n)},c.quickSortImp=function(e){var t,r,n,o,i,a,s;if(D(e)<=1)return e;for(t=c,r=e[Math.floor(D(e)/2)],n=[],o=[],i=[],a=0;a<D(e);a++)(s=t.sortCompare(e[a].value,r.value))<0?n.push(e[a]):0<s?o.push(e[a]):i.push(e[a]);return t.quickSortImp(n).concat(i,t.quickSortImp(o))},c.isEquals=function(e,t){return!(!b(e)&&""!==e||!b(t)&&""!==t)||(e instanceof Date&&t instanceof Date?e.valueOf()===t.valueOf():v(e)===a&&v(t)===a?e.toLowerCase()===t.toLowerCase():e===t)},c.isGreaterThan=function(e,t){var r=v(e),n=v(t);return r===s?e=e?1:0:e instanceof Date&&(e=c.Ra(e)),n===s?t=t?1:0:t instanceof Date&&(t=c.Ra(t)),r===n||r!==i&&n!==i?r===a&&n===a?e.toLowerCase()>t.toLowerCase():t<e:v(t)===i},c.sortCompare=function(e,t){var r=c,n=b(e)||""===e||v(e)===i&&isNaN(e),o=b(t)||""===t||v(t)===i&&isNaN(t);return n&&o?0:n?1:o?-1:r.isEquals(e,t)?0:r.isGreaterThan(e,t)?1:-1},R=c,t.jf=R,g.prototype.inPreview=function(){return this.Ce},g.prototype.bf=function(e,t){this.data=e,this.columnNames=t,function(e){var t,r,n=e.Ne={};for(e.Oe=[],e.Pe=[],e.Qe=[],e.Re=[],t=e.columnNames,r=0;r<D(t);r++)n[(t[r]+"").toUpperCase()]=r}(this)},g.prototype.onDataChanged=function(e){var t,r,n,o,i,a,s,l,u,c,h=this,f=Array(D(h.columnNames)),d=h.Ye,p=h.Pe,g=h.Ge,m=h.Oe;for(t=0;t<D(e);t++)n=(r=e[t]).data,o=r.row,i=h.getColumnIndex(r.columnName),a=y(h.data[o][i]=n)?n.text:n,m[i]&&(m[i][o]=a),f[i]=!0;for(s=0;s<D(f);s++)if(f[s]){for(l=d[s],d[s]=l?[]:void 0,g[s]=l?[]:void 0,u=[],t=0;l&&t<D(l);t++)u.push(p[s][l[t]]);for(w(h,s),t=0;t<D(u);t++)c=h.Se[s][u[t]],d[s].push(c),g[s][c]=!0}C(h),h.cf("onDataChanged",e)},g.prototype.cf=function(e){var t,r,n,o,i=[];for(t=1;t<arguments.length;t++)i[t-1]=arguments[t];for(r=this.Ze||[],n=0;n<D(r);n++)(o=r[n])[e]&&o[e].apply(o,i)},g.prototype.onColumnNameChanged=function(e,t){var r=this.Ne,n=this.getColumnIndex(e);n<0||(this.columnNames[n]=t,delete r[e.toUpperCase()],r[t.toUpperCase()]=n,this.cf("onColumnNameChanged",e,t))},g.prototype.onRowsAdded=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m=this,b=D(m.columnNames),y=m.data,C=m.Oe,w=m.Pe,v=m.Qe,S=m.Re,x=m.Ge,T=m.Ye,A=m.Ee,k=m.Ie,M=m.Je;for(m._e=[],n=0;n<t;n++)y.splice(e,0,Array(b));for(o=0;o<b;o++){for(n=0;n<t;n++)C[o]&&C[o].splice(e,0,I);if(s=void 0,a=w[o]){for(l=E,u=0;u<D(a);u++){for(c=v[o][u],h=0;h<D(c);h++)c[h]>=e&&(c[h]+=t);R.isEquals(a[u],E)&&(l=c,s=u)}for(l||(l=[],a.push(E),s=D(a)-1,m.Se[o][E]=s,v[o].push(l),x[o]&&-1===M.indexOf(o)&&(x[o][s]=!0,T[o].push(s))),f=e;f<e+t;f++)l.push(f);for(i=e;i<e+t;i++)S[o].splice(i,0,s)}}for(d=!0,n=0;n<D(M);n++)p=S[o=M[n]][e],!0!==x[o][p]&&(d=!1);for(n=0;n<D(k);n++)k[n]>=e&&(k[n]+=t);for(i=D(y)-1;e+t<=i;i--)A[i]=A[i-t];for(g=0<D(M),i=e;i<e+t;i++)d&&k.push(i),A[i]=!g;r||m.cf("onRowsChanged",e,t,!0)},g.prototype.onRowsRemoved=function(e,t){this.df(e,t,!0)},g.prototype.df=function(e,t,r){var n,o,i,a,s,l,u,c,h=this,f=h.Ye,d=h.Pe,p=h.Ge,g=h.data,m=D(h.columnNames),b=h.Oe;for(g.splice(e,t),o=0;o<m;o++){if(b[o]&&b[o].splice(e,t),a=[],(i=f[o])&&r){for(n=0;n<D(i);n++){for(s=h.getRowIndexes(h.columnNames[o],i[n]),l=!0,u=0;u<D(s);u++)if(s[u]<e||s[u]>=e+t){l=!1;break}l||a.push(d[o][i[n]])}f[o]=[],p[o]=[]}if(w(h,o),i&&r)for(n=0;n<D(a);n++)c=h.Se[o][a[n]],f[o].push(c),p[o][c]=!0}r&&C(h),h.cf("onRowsChanged",e,t,!1)},g.prototype.onColumnsRemoved=function(e,t){var r,n,o,i,a,s,l,u,c=this,h=c.data,f=[],d=c.Je,p=e+t;for(r=e;r<p;r++)n=c.columnNames[r],o=r,f.push(n),-1!==d.indexOf(o)&&c.doUnfilter(n);for(i=c.Ge||c.Fe,a=c.Ye||c.Ve,s=c.Ne,r=0;r<D(h);r++)h[r].splice(e,t);for(l in c._e=[],c.columnNames.splice(e,t),c.Oe.splice(e,t),c.Pe.splice(e,t),c.Se.splice(e,t),c.Qe.splice(e,t),c.Re.splice(e,t),i.splice(e,t),a.splice(e,t),s)s[l]>=e+t&&(s[l]-=t);for(r=0;r<D(f);r++)delete s[(n=f[r]).toUpperCase()],e=c.getColumnIndex(n),-1!==(u=d.indexOf(e))&&d.splice(u,1),c.cf("onColumnRemoved",f[r])},g.prototype.ef=function(){return this._e},g.prototype.ff=function(){return this.af},g.prototype.We=function(e){var t,r,n,o,i,a,s,l,u,c,h,f=this.data;for(this.Oe[e]||w(this,e),t=D(f),r=[],n=0;n<t;n++)i=y(o=f[n][e])?o.value:o,r.push(i);for(a=R.quickSort(r),s=this._e[e]=[],l=this.af[e]=[],u=this.Te[e]=[],c=0;c<D(a);c++)h=a[c],s.push(h.value),l.push(h.index),u[h.index]=c},g.prototype.getColumnIndex=function(e){var t=this.Ne[e.toUpperCase()];return void 0===t?-1:t},g.prototype.getFilteredRowIndexes=function(){return this.Ce?this.He:this.Ie},g.prototype.getFilteredOutRowIndexes=function(){var e,t=D(this.data),r=this.Ce?this.De:this.Ee,n=[];for(e=0;e<t;e++)r[e]||n.push(e);return n},g.prototype.getData=function(e,t){var r,n,o,i,a,s,l,u=this.Oe,c=this.getColumnIndex(e);if(0<=c){if(t){for(this._e[c]||this.We(c),r=u[c],n=this._e[c],i=(o=this.Xe(n,t)).start,a=o.end,s=[],l=i;l<=a;l++)s.push(r[this.af[c][l]]);return s}return u[c]||w(this,c),u[c]}return[]},g.prototype.aggregateData=function(e,t,r){var n,o,i,a,s,l,u,c,h,f=this.getColumnIndex(e);return f<0?I:(this._e[f]||this.We(f),a=D(i=this._e[f]),n=(s=this.Xe(i,r)).start,o=s.end,5===t?a<=n?I:i[n]:4===t?o<0?I:i[o]:3===t?o<n?0:o-n+1:(u=(l=this.Qka(i,t,n,o)).data1,c=l.data2,h=l.data3,1===t?u/=c:7===t||10===t?(u=(h*c-u*u)/(h*(h-1)),u=7===t?Math.sqrt(u):u):8!==t&&11!==t||(u=(h*c-u*u)/(h*h),u=8===t?Math.sqrt(u):u),u))},g.prototype.Qka=function(e,t,r,n){var o,i,a,s=6===t?1:0,l=0,u=0;for(o=r;o<=n;o++)(i=e[o])===E&&i===I||h(i,a={value:E})&&(i=a.value,1===t?(s+=i,l++):2===t?s++:9===t?s+=i:6===t?s*=i:7!==t&&8!==t&&10!==t&&11!==t||(s+=i,l+=i*i,u++));return{data1:s,data2:l,data3:u}},g.prototype.Xe=function(e,t){var r,n,o,i,a=D(e);if(t){if(t.min===-1/0)r=0;else for(o=0;o<a;o++)if(i=e[o],R.isEquals(t.min,i)||R.isGreaterThan(i,t.min)){r=o;break}if(r===I&&(r=a),n===1/0)n=a-1;else{for(o=a-1;0<=o;o--)if(i=e[o],R.isEquals(i,t.max)||R.isGreaterThan(t.max,i)){n=o;break}n===I&&(n=-1)}}else r=0,n=a-1;return{start:r,end:n}},g.prototype.getExclusiveData=function(e){var t=this.Pe,r=this.getColumnIndex(e);return 0<=r?(t[r]||w(this,r),t[r]):[]},g.prototype.getRowIndexes=function(e,t){var r=this.getColumnIndex(e);return 0<=r?(this.Re[r]||w(this,r),this.Qe[r][t]):[]},g.prototype.getExclusiveRowIndex=function(e,t){var r=this.Re,n=this.getColumnIndex(e);return 0<=n?(r[n]||w(this,n),r[n][t]):-1},g.prototype.getFilteredIndexes=function(e){var t=[];return this.gf(e,t,{}),t},g.prototype.gf=function(e,t,r){var n,o,i,a=this.Ce?this.He:this.Ie;for(n=0;n<D(a);n++)o=a[n],r[i=this.getExclusiveRowIndex(e,o)]?r[i]++:(r[i]=1,t.push(i))},g.prototype.getFilteredRanges=function(e){return f(this,e,!1)},g.prototype.getFilteredOutRanges=function(e){return f(this,e,!0)},g.prototype.getFilteredOutIndexes=function(e,t){return(0===t?function(e,t){var r,n,o,i,a=[];if(0<=e.getColumnIndex(t)){for(r=D(e.getData(t)),n=e.Ce?e.De:e.Ee,o=0;o<r;o++)n[o]||(i=e.getExclusiveRowIndex(t,o),-1===a.indexOf(i)&&a.push(i));return a}}:1===t?p:function(e,t){var r,n,o,i,a,s,l,u,c,h,f={},d=e.columnNames;for(r=0,n=D(d);r<n;r++)if(d[r]!==t)for(o=p(e,d[r]),i=0;i<D(o);i++)for(a=e.getRowIndexes(d[r],o[i]),s=0;s<D(a);s++)f[a[s]]||(f[a[s]]=!0);for(l={},r=0,n=D(e.data);r<n;r++)u=e.getExclusiveRowIndex(t,r),f[r]||(l[u]=!0);for(c=D(e.getExclusiveData(t)),h=[],r=0;r<c;r++)l[r]||h.push(r);return h})(this,e)},g.prototype.attachListener=function(e){this.Ze.push(e)},g.prototype.detachListener=function(e){var t,r=this.Ze||[];for(t=0;t<D(r);t++)if(r[t]===e){r.splice(t,1);break}},g.prototype.suspendFilteredEvents=function(){this.$e++},g.prototype.resumeFilteredEvents=function(){this.$e--,0===this.$e&&this.onFiltered()},g.prototype.doFilter=function(e,t,r){this.hf(e,t,r),this.onFiltered()},g.prototype.hf=function(e,t,r){var n=this.Je,o=this.getColumnIndex(e);o<0||(r?(this.Ce=!0,this.Me=o):this.Ce&&d(this,!1),n.indexOf(o)<0&&n.push(o),t.ranges?function(e,t,r,n){var o,i,a,s,l,u,c,h,f=e.getColumnIndex(t),d=e.Te;for(d[f]||e.We(f),o=[],i=d[f],a=0;a<D(i);a++)l=y(s=e.data[a][f])?s.value:s,o[i[a]]=l;for(u=[],a=0;a<D(r);a++)for(c=e.Xe(o,r[a]),h=0;h<D(i);h++)i[h]>=c.start&&i[h]<=c.end&&(u[h]=!0);n?(e.Le=u,e.Ue=r):(e.Ve[f]=r,e.Fe[f]=u,delete e.Ge[f],delete e.Ye[f]),C(e)}(this,e,t.ranges,r):function(e,t,r,n){var o,i=e.getColumnIndex(t),a=[];for(o=0;o<D(r);o++)a[r[o]]=!0;n?e.Ke=a:(e.Ge[i]=a,e.Ye[i]=r,delete e.Ve[i],delete e.Fe[i]),C(e)}(this,e,t.exclusiveRowIndexes,r))},g.prototype.clearPreview=function(){d(this,!0)},g.prototype.doUnfilter=function(e){this.if(e),this.onFiltered()},g.prototype.if=function(e){var t,r,n=this;n.Ce&&d(n,!1),(t=n.getColumnIndex(e))<0||(delete n.Ve[t],delete n.Fe[t],delete n.Ge[t],delete n.Ye[t],C(n),0<=(r=n.Je.indexOf(t))&&n.Je.splice(r,1))},g.prototype.onFiltered=function(){0===this.$e&&this.cf("onFiltered",{rowIndexes:this.getFilteredRowIndexes(),isPreview:this.Ce})},g.prototype.getListener=function(){return this.Ze},t.GeneralSlicerData=g},"./src/plugins/sparkline/sparkline.entry.ts":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(t("./src/plugins/sparkline/sparkline.ts"))},"./src/plugins/sparkline/sparkline.ts":function(e,f,t){"use strict";var r,w,d,ye,ie,v,p,Ce,H,j,se,S,x,we,ve,le,T,z,Se,q,U,xe,Te,Ae,ue,n,ke,Me,Ie,ce,A,ae,W,Z,Y,K,X,J,Q,$,ee,te,he,fe,de,I,G,V,Ee,Re,De,Ne,Fe,b,o,i,a=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function E(e,t){return{x:e,y:t}}function re(e,t,r,n){return{x:e,y:t,width:r,height:n}}function _e(e,t){var r,n,o,i=e[0],a=i&&i.value?i.value:i;for(n=1,o=e.length;n<o;n++)r=(i=e[n])&&i.value?i.value:i,(t&&r<a||!t&&a<r)&&(a=r);return a}function ne(e,t,r,n,o,i,a){i&&(e.strokeStyle=i),a&&(e.lineWidth=a),e.beginPath(),e.moveTo(t,r),e.lineTo(n,o),e.stroke()}function Pe(e,t,r,n,o,i,a,s,l,u,c,h){t?ne(e,r,n,o,i,c,h):ne(e,a,s,l,u,c,h)}function oe(e){return w.pc.dc(v(e))<127.5?A:ae}function Le(e,t,r,n,o,i,a,s){var l,u,c,h,f=s;return ye(s)&&(f=o),h=a?(l=t+f+i,c=n-2*f,u=e+o,r-2*o):(l=e+f,c=r-2*f,u=t+o,n-2*o),{left:l,top:u,width:c,height:h}}function Oe(e,t){var r,n,o=0;for(r=0,n=e.length;r<n;r++)o+=t&&!t(e[r])?0:e[r];return o}function Be(e,t,r,n){var o,i,a,s,l=[];for(a=i=0,s=e.length;i<s;i++)t?t(e[i])?l[a++]=r?r(e[i]):e[i]:l[a++]=0:(o=Ae(e[i]),!Te(o)&&isFinite(o)&&(l[a++]=o));return n&&n(l),l}function je(e,t,r,n,o,i){var a=le(t+n),s=le(r+o);t=le(t),r=le(r),n=le(a-t),o=le(s-r),e.beginPath(),e.fillStyle=i,e.fillRect(t,r,n,o),e.fill()}function pe(e,t,r){return e=we(e,t),ve(e,r)}function He(e,t,r,n,o){e.save(),e.rect(t,r,n,o),e.clip()}function s(e){var t=i.call(this,E(e.x,e.y))||this;return t.value=e.value,t}function ge(e,t,r){return{x:e,y:t,value:r}}function me(e,t){var r,n,o=t?1:-1,i=t?we:ve,a=new I(E(o*ue,o*ue)),s=e.length;for(n=0;n<s;n++)r=e[n],a.x=i(a.x,r.x),a.y=i(a.y,r.y);return a}function be(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v;if(a){for(s=z(T(n-t,2)+T(o-r,2)),d=f=h=c=void(l=0),d=t<=n?(h=n,f=c=t,r):(h=t,f=c=n,o),g=r-(p=(o-r)/(n-t))*t,(u=[]).push(new I(E(f,d))),m=[6,4,2,4];l<s;)for(b=0,y=m.length;b<y;b++)(l+=m[b])<=s&&(d=p*(f=l/s*(h-(v=c))+v)+g,u.push(new I(E(f,d))));for(C=0,w=u.length;C<w-1;C+=2)ne(e,u[C].x,u[C].y,u[C+1].x,u[C+1].y,i)}else ne(e,t,r,n,o,i)}function Ge(e){var t,r,n,o=[],i=e.length;if(0<i)if(i<(t=e[0].length)){if(2<=i)for(r=0;r<t;r++)o.push(new I(E(e[0][r],e[1][r])))}else if(2<=t)for(n=0;n<i;n++)o.push(new I(E(e[n][0],e[n][1])));return o}function F(e,t,r,n){for(var o,i=[],a=ve(100,10*e),s=0,l=[],u=0;i.length<e;)o=j(n[u++]*t),(a<s||c(o,l))&&(i.push(o),l.push([o-r,o+r])),s++;return i}function c(e,t){var r,n,o;for(r=0,n=t.length;r<n;r++)if((o=t[r])[0]<=e&&e<=o[1])return;return 1}function Ue(e,t,r,n,o,i){ne(e,h(t),h(r),h(n),h(o),ye(i)?ae:i,1)}function We(r,n,o,e,t){var i,a,s,l,u,c=.4*e;switch(n=h(n),o=h(o),r.beginPath(),r.moveTo(n,o),i=c/2,a=z(3)*c/2,s=c/z(3),t){case 0:l=[-i,0,i],u=[a,s,a];break;case 2:l=[-i,0,i],u=[-a,-s,-a];break;case 3:l=[a,s,a],u=[-i,0,i];break;case 1:l=[-a,-s,-a],u=[-i,0,i];break;default:l=[],u=[]}l.forEach(function(e,t){r.lineTo(h(n+e),h(o+u[t]))}),r.lineTo(n,o),r.closePath(),r.fillStyle=A,r.fill()}function l(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v=r.value,S=r.colorScheme,x=r.axisVisible,T=r.barHeight,A=r.barWidth,k=!1,M=Ae(v);if(!Te(M)){if(ye(d=0===e?T:A))p=.7;else{if(Te(d)||d<=0)return;p=Math.min(1,d)}1<M?(M=1,k=!0):M<-1&&(M=-1,k=!0),S=ye(S)?"grey":S,x=!!ye(x)||x,t.save(),0===e?(g=i-10,m=a*p,h=0<=M?(k&&(s=new I(E(n+5+g-5,o+a/2))),l=new G(re(n+5,o+a*(1-p)/2,g*M,m)),u=new I(E(n+5,o+1)),c=new I(E(n+5,o+a)),1):(b=Se(g*M),k&&(s=new I(E(n+5+5,o+a/2))),l=new G(re(n+i-5-b,o+a*(1-p)/2,b,m)),u=new I(E(n+i-5,o+1)),c=new I(E(n+i-5,o+a)),3),f=ye(d)?a:a*p):1===e&&(y=a-10,C=i*p,c=0<=M?(l=new G(re(n+(1-p)/2*i,o+a-5-(w=y*M),C,w)),k&&(s=new I(E(n+i/2,o+a-5-w+5)),h=0),u=new I(E(n+1,o+a-5)),new I(E(n+i,o+a-5))):(M=Se(M),l=new G(re(n+(1-p)/2*i,o+5,C,y*M)),k&&(s=new I(E(n+i/2,o+5+y-5)),h=2),u=new I(E(n+1,o+5)),new I(E(n+i,o+5))),f=ye(d)?i:i*p),t.beginPath(),l&&(je(t,l.x,l.y,l.width,l.height,S),He(t,l.x,l.y,l.width,l.height)),s&&We(t,s.x,s.y,f,h),t.restore(),x&&u&&Ue(t,u.x,u.y,c.x,c.y),t.restore()}}function h(e){return le(e)-.5}function g(e,t,r,n,o){t=le(t),r=le(r),t===(n=le(n))&&(t=n-=.5),r===(o=le(o))&&(r=o-=.5),e.moveTo(t,r),e.lineTo(n,o)}function Ve(e,t,r,n,o,i,a,s,l,u,c){e.beginPath(),e.strokeStyle=r,t?g(e,n,o,i,a):g(e,s,l,u,c),e.stroke()}function y(e,t,r,n,o){e.rect(t,r,n,o),e.clip()}function ze(e,t,r,n,o,i){var a,s,l,u,c,h=i.labelText,f=i.fontSize,d=i.startBox,p=i.endBox,g=i.boxColor,m=i.isInRightOrTopOfBox,b=i.fillStyle;e.save(),e.beginPath(),e.font=f+te,b=ye(b)?ae:b,i.vertical?(l=J,m?0<f+p-(d-r)&&d-p-r<p?(u=Q,b=oe(g),s=d-p+1,y(e,t,d-p,n,p)):(u=$,s=d-p-1):s=0<f-(r+o-d)&&r+o-d<p?(y(e,t,d-p,n,p),u=$,b=oe(g),d-1):(u=Q,d+1),e.textAlign=l,e.textBaseline=u,e.fillStyle=b,e.fillText(h,t+n/2,s)):(u=ee,c=e.measureText(h),m?a=0<c.width+p-(t+n-d)&&t+n-(d+p)<p?(y(e,d,r,p,o),l=X,b=oe(g),d+p-1):(l=K,d+p+1):0<c.width-(d-t)&&d-t<p?(y(e,d,r,p,o),a=d+1,l=K,b=oe(g)):(l=X,a=d-1),e.textAlign=l,e.textBaseline=u,e.fillStyle=b,e.fillText(h,a,r+o/2)),e.restore()}function qe(e,t){switch(t){case 2:return e%4==0&&e%100!=0||e%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function m(e,t,r){var n,o,i,a,s,l;return e<0&&(e=0),1<e&&(e=1),n=v(t),o=v(r),i=n.a*(1-e)+o.a*e,a=n.r*(1-e)+o.r*e+"",s=n.g*(1-e)+o.g*e+"",l=n.b*(1-e)+o.b*e+"","rgba("+parseInt(a,10)+","+parseInt(s,10)+","+parseInt(l,10)+","+Ae(i/255+"")+")"}function C(e,t,r){return e===t&&e===r?1:e<=t?0:r<=e?1:(e-t)/(r-t)}function Ze(e,u,c,r,h,f,d){var t,p,g,n,o;r?e.forEach(function(e,t){0!==e&&e!==Ce&&e!==H&&(u[c+t]=r[t]||u[c+t])}):(o=-(n=ue),e.forEach(function(e){e!==Ce&&e!==H&&(e<n&&(n=e),o<e&&(o=e))}),p=(t={min:n,max:o}).min,g=t.max,e.forEach(function(e,t){var r,n,o,i,a,s,l;0!==e&&e!==Ce&&e!==H&&(u[c+t]=(r=h,n=f,o=d,l=((s=g)+(a=p))/2,a<=(i=e)&&i<=l?m(C(i,a,l),r,n):m(C(i,l,s),n,o)))}))}function Ye(e){var t,r=e.getFullYear(),n=e.getMonth(),o=e.getDate();for(t=1;t<n+1;t++)o+=qe(r,t);return o}function u(){this.Wd=2,this.Xd=n,this.Yd=n,this.Zd=ue,this.$d=-ue}Object.defineProperty(f,"__esModule",{value:!0}),r=t("./src/common/util/types.ts"),w=t("./src/common/util/colorhelper.ts"),d=t("./src/common/util/arrayhelper.ts"),ye=r.j.Fa,ie=w.pc.nc,v=w.pc.ec,p=d.k.Cb,f.Vd={},Ce=null,H=void 0,j=Math.floor,se=Math.PI,S=Math.sin,x=Math.cos,we=Math.min,ve=Math.max,le=Math.round,T=Math.pow,z=Math.sqrt,Se=Math.abs,q=Math.ceil,U="undefined",xe="string",Te=isNaN,Ae=parseFloat,ue=Number.MAX_VALUE,n=new Date(""),ke="#969696",Me="#CB0000",Ie="#646464",ce="#DCDCDC",A="white",ae="black",W="blue",Z="green",Y="red",K="left",X="right",J="center",Q="top",$="bottom",ee="middle",te="px Arial",he="-",fe="+",de="=",G=function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},a(s,i=I=function(e){this.x=e.x,this.y=e.y}),V=s,Ee="7ns",Re="5ns",De="tukey",Ne="bowley",Fe="sigma3",b=function(e,t,r,n){this.X=e,this.Y=t,this.Width=r,this.Height=n,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height},u.prototype.paint=function(e,t,r,n,o,i){var a,s,l;this.options=t,this.setting=t.settings,a=t.values,s=t.dateValues,l=t.zoomFactor,e.save(),e.rect(r,n,o,i),e.clip(),e.beginPath(),0===t.sparklineType&&this._d(e,r,n,o,i,a,s,l),this.ae(e,r,n,o,i,a,s,l),this.be(e,r,n,o,i,a,s,l),e.restore()},u.prototype.ce=function(e){return 0===this.options.sparklineType?3+this.de(e)+1:3},u.prototype.ee=function(e,t){var r,n,o,i,a,s,l,u,c,h=this.fe;if(h)return h;if(h=this.fe=[],r=e.length,this.options.displayDateAxis){for(i=t.length,s=[],0<(a=we(r,i))&&(s=t.slice(0,a)),s.sort(function(e,t){return e===t?0:(e===f.Vd&&(e=0),t===f.Vd&&(t=0),e-t)}),l=s.length,c=u=void 0,n=0;n<l;n++)if(typeof(u=s[n])!==U&&u!==Ce){for(c=p(t,u);d.k.Bb(h,c);)c=p(t,u,c+1);isNaN(u)||(o=e[c])!==H&&o!==Ce&&isNaN(o)&&o!==f.Vd||h.push(c)}}else for(n=0;n<r;n++)typeof(o=e[n])!==U&&o!==Ce&&isNaN(o)&&o!==f.Vd||h.push(n);return h},u.prototype.ge=function(e,t){var r=t[e];return typeof r===U||r===Ce?1===this.setting.options.displayEmptyCellsAs&&(r=0):r===f.Vd&&(r=0),r},u.prototype._d=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x=this.ee(i,a),T=x.length-1;for(T<0&&(T=0),h=this.setting.options,f=this.linePos=[],y=h.displayEmptyCellsAs,l=0;l<T;l++)if(typeof(d=this.ge(x[l],i))!==U&&d!==Ce){if(g=l+1,typeof(p=this.ge(x[g],i))===U||p===Ce)if(1===y)p=0;else if(2===y)for(g=l+2;g<=T;g++)if(typeof(C=i[x[g]])!==U&&C!==Ce){p=C;break}typeof p!==U&&p!==Ce?(m=this.he(x[l],{Width:n,Height:o},i,a,s),b=this.he(x[g],{Width:n,Height:o},i,a,s),w=m.Width/2,u={X:m.X+w,Y:m.Y+w},c={X:b.X+w,Y:b.Y+w},f[l]={P1:u,P2:c}):l++}if(0<(v=f.length))for(e.strokeStyle=this.options.getColor(h.seriesColor),e.lineCap="round",e.lineWidth=this.de(s),l=0;l<v;l++)(S=f[l])&&(e.beginPath(),u=S.P1,c=S.P2,e.moveTo(t+u.X,r+u.Y),e.lineTo(t+c.X,r+c.Y),e.stroke(),e.closePath())},u.prototype.ie=function(e,t,r){var n,o=this,i=o.options,a=o.setting.options,s=Ce,l=o.ge(e,t),u=o.ee(t,r),c=u.length,h=i.getColor.bind(o);return typeof l!==U&&l!==Ce&&(o.Zd!==ue&&o.$d!==-ue||o.je(t),l===o.Zd&&a.showLow&&(s=h(a.lowMarkerColor)),l!==o.$d||!a.showHigh||typeof s!==U&&s!==Ce||(s=h(a.highMarkerColor)),typeof s!==U&&s!==Ce||(i.displayDateAxis?0===p(u,e)&&a.showFirst&&(s=h(a.firstMarkerColor)):0===e&&a.showFirst&&(s=h(a.firstMarkerColor))),typeof s!==U&&s!==Ce||(i.displayDateAxis?p(u,e)===c-1&&a.showLast&&(s=h(a.lastMarkerColor)):e===c-1&&a.showLast&&(s=h(a.lastMarkerColor))),l<0&&a.showNegative&&(typeof s===U||s===Ce)&&(s=h(a.negativeColor)),typeof s!==U&&s!==Ce||(0===(n=i.sparklineType)?a.showMarkers&&(s=h(a.markersColor)):1!==n&&2!==n||(s=h(a.seriesColor)))),s===H||s===Ce?"Transparent":s},u.prototype.ae=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b,y={Width:n,Height:o},C=this.ee(i,a),w=C.length,v=this.options.sparklineType;for(b=0;b<w;b++)l=C[b],u=this.ie(l,i,a),c=this.he(l,y,i,a,s),e.fillStyle!==u&&(e.fillStyle=u),0===v?(e.save(),h=t+c.X+c.Width/2,f=r+c.Y+c.Height/2,e.translate(h,f),e.rotate(45*se/180),e.fillRect(0-c.Width/2,0-c.Height/2,c.Width,c.Height),e.restore()):(d=t+c.X+c.Width/4,d=j(d),p=r+c.Y,g=c.Width/2,m=c.Height,e.fillRect(d,p,g,m))},u.prototype.be=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g=this.setting&&this.setting.options;g&&g.displayXAxis&&this.ke(i,a)&&(l={Width:n,Height:o},u=this.ce(s),c=l.Width-this.ce(s),f=h=j(this.le(l,i,s))+.5,d=this.options.getColor(g.axisColor),(p=s)<1&&(p=1),e.strokeStyle!==d&&(e.strokeStyle=d),e.lineWidth!==p&&(e.lineWidth=p),e.beginPath(),e.moveTo(t+u,r+h),e.lineTo(t+c,r+f),e.stroke())},u.prototype.me=function(e){var t,r=this.ne(e);return r===-ue||(t=this.oe(e))===ue||r===t||r*t<=0},u.prototype.ke=function(e,t){var r,n,o,i,a=this.me(e);if(2!==this.options.sparklineType)return a;if(n=(r=this.ee(e,t)).length,!a&&0<n)for(i=0;i<n;i++)if(typeof(o=e[r[i]])!==U&&o!==Ce)return!0;return a},u.prototype.pe=function(e,t){var r=this.Xd;return isNaN(r&&r.valueOf())&&this.qe(e,t),this.Xd},u.prototype.re=function(e,t){var r=this.Yd;return isNaN(r&&r.valueOf())&&this.qe(e,t),this.Yd},u.prototype.qe=function(e,t){var r,n,o,i,a=new Date(0,0,0),s=ue,l=this.ee(e,t),u=l.length;for(i=0;i<u;i++)n=t[r=l[i]],isNaN(n)||(o=this.ge(r,e))!==Ce&&typeof o===U||isNaN(o)||typeof n!==U&&n!==Ce&&(a<n&&(a=n),n<s&&(s=n));this.Yd=a,this.Xd=s},u.prototype.se=function(e,t,r,n){var o,i,a,s,l,u,c=this.pe(t,r),h=this.re(t,r),f=[],d=this.ee(t,r),p=d.length;for(o=0;o<p;o++)(i=r[d[o]])&&!isNaN(i)&&f.push(i);if(f.sort(function(e,t){return e-t}),1<(a=f.length)&&c!==h){for(s=ue,l=0,o=1;o<a;o++)(i=f[o]-f[o-1])<s&&0<i&&(s=i),l+=i;return(u=(e.Width-this.ce(n)-this.ce(n))*s/l/2)<2&&(u=2),u}return(e.Width-this.ce(n)-this.ce(n))/2},u.prototype.te=function(e,t,r,n){var o;return this.options.displayDateAxis?this.se(e,t,r,n):(o=this.ee(t,r).length,(e.Width-this.ce(n)-this.ce(n))/o)},u.prototype.ue=function(e,t,r,n,o){var i,a,s,l,u,c,h,f=this.ce(o);return this.options.displayDateAxis?(i=this.te(e,r,n,o),(a=this.re(r,n))===(s=this.pe(r,n))?f+i/2:(l=n[t])?(u=e.Width-f-this.ce(o),u-=i,c=a.valueOf()-s.valueOf(),f+j((l.valueOf()-s.valueOf())/c*u)):0):(i=this.te(e,r,n,o),h=p(this.ee(r,n),t),j(f+i*h))},u.prototype.ve=function(e,t){var r,n=e.Width-this.ce(t)-this.ce(t);return n=ve(n,0),r=e.Height-this.ce(t)-this.ce(t),{Width:n,Height:r=ve(r,0)}},u.prototype.je=function(e){var t,r,n=e.length;for(r=0;r<n;r++)typeof(t=e[r])!==U&&t!==Ce&&("number"!=typeof t&&(t=0),t<this.Zd&&(this.Zd=t),t>this.$d&&(this.$d=t))},u.prototype.ne=function(e){var t,r;return this.$d!==-ue&&this.$d||this.je(e),0===(r=(t=this.setting.options).maxAxisType)?this.$d:1===r?t.groupMaxValue:2===r?t.manualMax:this.$d},u.prototype.oe=function(e){var t,r;return this.Zd!==ue&&this.Zd||this.je(e),0===(r=(t=this.setting.options).minAxisType)?this.Zd:1===r?t.groupMinValue:2===r?t.manualMin:void 0},u.prototype.we=function(e,t,r,n){var o=this.ve(e,n),i=this.ne(r),a=this.oe(r),s=i-a;if(i===a){if(0===i)return 0;s=Se(i)}return(r[t]||0)*(o.Height/s)},u.prototype.xe=function(e,t,r,n){var o,i,a,s=this.options.sparklineType;if(0===s)return this.we(e,t,r,n);if(1!==s)return 2===s?typeof(o=r[t])===U||o===Ce||0===o||isNaN(o)?0:(a=this.ve(e,n),0<=o?a.Height/2:-a.Height/2):void 0;if(o=r[t],1===this.setting.options.displayEmptyCellsAs&&(typeof o===U||o===Ce))return 0;if((i=this.we(e,t,r,n))>-this.Wd&&i<this.Wd){if(0<o)return i+this.Wd;if(o<0)return i-this.Wd}return i},u.prototype.ye=function(e,t,r){var n,o,i=this.ve(e,r),a=this.ne(t),s=this.oe(t);if(a===-ue||s===ue)return e.Height/2;if(n=a-s,a===s){if(0===a)return e.Height/2;(n=a)<0&&(a=0)}return o=i.Height/n,this.ce(r)+a*o},u.prototype.le=function(e,t,r){return 2===this.options.sparklineType?e.Height/2:this.ye(e,t,r)},u.prototype.ze=function(e,t,r,n){var o,i,a=this.ve(e,n),s=this.ne(r),l=this.oe(r),u=s-l;if(s===l){if(0===s)return 0;u=s}return o=a.Height/u,typeof(i=this.ge(t,r))!==U&&i!==Ce||(i=0),s!==l&&0<s*l?0<=i?(i-l)*o:(i-s)*o:i*o},u.prototype.Ae=function(e,t,r,n){var o,i,a,s=this.options.sparklineType;return 0===s?this.ze(e,t,r,n):1===s?(o=this.ze(e,t,r,n),-(i=this.Wd)<o&&o<i&&(typeof(a=this.ge(t,r))!==U&&a!==Ce||(a=0),0!==a)?0<a?o+i:o-i:o):2===s?this.xe(e,t,r,n):void 0},u.prototype.Be=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p=this,g=p.te(t,r,n,o),m=p.ue(t,e,r,n,o);return g<0&&(g=0),(g=j(g))%2==1&&(g+=1),i=p.xe(t,e,r,o),a=p.le(t,r,o),s=p.ne(r),l=p.oe(r),s<(u=0)&&l<0?u=ve(p.ce(o),a):(u=a,0<=i&&(u=a-i)),c=p.Ae(t,e,r,o),h=new b(m,u,g,Se(c)),0!==i&&(f=p.ce(o),h.Y<f&&h.Bottom<f+1?h.Height=j(h.Height+1):(d=t.Height-p.ce(o),h.Bottom>d&&h.Y>d-1&&(h.Y=d-c,h.Height=c))),h},u.prototype.de=function(e){var t=this.setting.options.lineWeight*e;return t<1&&(t=1),t},u.prototype.he=function(e,t,r,n,o){var i,a,s,l,u=this.de(o);return++u<2&&(u=2),i=this.Be(e,t,r,n,o),0===this.options.sparklineType&&(i.X=i.X+(i.Width-u)/2,typeof(a=this.ge(e,r))!==U&&a!==Ce?(0<=a?i.Y-=u/2:i.Y=i.Bottom-u/2,i.Width=u,i.Height=u):(i.Width=0,i.Height=0)),this.setting.options.rightToLeft&&(s=i.X,l=t.Width-s-i.Width,i=new b(l,i.Y,i.Width,i.Height)),i},f.SparklineRender=u,f.SparklineExRenders={PIESPARKLINE:function(e,t,r,n,o,i){var a,s,l,u,c,h,f=r+o/2,d=n+i/2,p=we(o,i)/2-5,g=-.5*se,m=f+p*x(g),b=d+p*S(g),y=[],C=[];if(!(p<=0)){for(u=function(e,t){var r,n,o,i,a,s,l=[],u=t.length;if(e<=u)l=t.slice(0,e);else{for(0===u?(l.push("darkgray"),u=1):l=t.slice(0),r=[],o=e-u+1,i=n=void 0,i=0;i<u;i++)r[i]=v(l[i]);for(i=u;i<e;i++){for(a in n=r[i%u])n.hasOwnProperty(a)&&(s=n[a],n[a]=j(s-s/o*(i/u)));n.a=255,l[i]=w.pc.bc(n)}}return l}(l=(s=Be(t.values,function(e){return!ye(e)&&!Te(e)&&isFinite(e)},function(e){return Se(e)},function(e){1===e.length&&(e[1]=1-e[0])})).length,t.colors),c=Oe(s),e.save(),h=0;h<l;h++)a=g+s[h]/c*2*se,e.beginPath(),e.moveTo(f,d),e.lineTo(m,b),e.arc(f,d,p,g,a,!1),e.lineTo(f,d),e.fillStyle=u[h],e.fill(),y.push(m),C.push(b),m=f+p*x(g=a),b=d+p*S(g);for(h=0;h<l;h++)ne(e,f,d,y[h],C[h],A);e.restore()}},AREASPARKLINE:function(n,e,t,r,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H;for(n.save(),a=e.points,s=e.mini,l=e.maxi,u=e.line1,c=e.line2,h=e.colorPositive,f=e.colorNegative,a=Be(a,function(e){return!ye(e)&&!Te(e)&&isFinite(e)}),h=ye(h)?"#787878":h,f=ye(f)?Me:f,x=_e(a,!1),l=ye(l)?x:l,p=ve(l,x),T=_e(a,!0),s=ye(s)?T:s,d=we(s,T),g=(g=(p=p<0?0:p)<(g=0)?p:g)<(d=0<d?0:d)?d-1:g,m=a.length,A=Le(t,r,o,i,5),b=A.left,y=A.top,C=A.width,w=A.height,v=C/(m-1),k=[],D=y+(p-g)/(S=(p-d)/w),_=0;_<m;_++)M=a[_],N=b+v*_,F=y+(p-M)/S,0===_&&k.push(new V(ge(N,D,g))),0<_&&M*a[_-1]<0&&((E=k[k.length-1])&&(O=E.x,R=(((B=E.y)-(H=D))*N+(H-(j=F))*O)/(B-j),k.push(new V(ge(R,D,g))))),k.push(new V(ge(N,F,M))),_===m-1&&k.push(new V(ge(N,D,g)));for(n.beginPath(),P=0,L=k.length;P<L;P++)(I=k[P])&&(0===P?n.moveTo(I.x,I.y):n.lineTo(I.x,I.y),E=k[P-1],I.value===g&&E&&(n.fillStyle=E.value>g?h:f,n.fill(),P!==L-1&&(n.beginPath(),n.moveTo(I.x,I.y))));function G(e){var t,r;e===Ce&&typeof e!==U||(t=pe(e,p,d),r=le(y+(0!=S?(p-t)/S:w/2))-.5,ne(n,b,r,b+C,r,W))}G(u),G(c),n.restore()},SCATTERSPARKLINE:function(o,e,t,r,n,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N=e.points1,F=e.points2,_=e.minX,P=e.maxX,L=e.minY,O=e.maxY,B=e.hLine,j=e.vLine,H=e.xMinZone,G=e.xMaxZone,U=e.yMinZone,W=e.yMaxZone,V=e.tags,z=e.drawSymbol,q=e.drawLines,Z=e.color1,Y=e.color2,K=e.dash,X=4,J=Le(t,r,n,i,5),Q=J.left,$=J.top,ee=J.width,te=J.height;function re(e,t,r,n){d=e[t],g=d.x,m=d.y,d=e[t+1],b=d.x,y=d.y,C=Q+(g-c)*ee/(h-c),v=Q+(b-c)*ee/(h-c),w=$+(u-m)*te/(u-l),S=$+(u-y)*te/(u-l),q&&be(o,C,w,v,S,r,K),z&&(0===t&&n(C,w),n(v,S))}function ne(e,t,r,n,o){var i=me(e,!0),a=me(e,!1);l=ye(L)?i.y:t,u=ye(O)?a.y:r,c=ye(_)?i.x:n,h=(h=ye(P)?a.x:o)<=c?c+1:h,u=u<=l?l+1:u}function oe(e,t,r){o.beginPath(),o.arc(e-X/2,t-X/2,X/2,0,2*se,!1),o.fillStyle=r,o.fill()}function ie(e,t){o.beginPath(),o.strokeStyle=Z,o.arc(e-X/2,t-X/2,X/2,0,2*se,!1),o.stroke()}function ae(e,t){o.beginPath(),o.strokeStyle=Y,o.strokeRect(e-X/2,t-X/2,X,X)}if(N&&!(N.length<=0)&&!((a=Ge(N)).length<=0||F&&0<F.length&&(s=Ge(F)).length<=0)){for(He(o,t,r,n,i),o.beginPath(),z=!!ye(z)||z,Z=ye(Z)?ke:Z,Y=ye(Y)?Me:Y,ne(a,L,O,_,P),!ye(H)&&!ye(G)&&!ye(U)&&!ye(W)&&c<=H&&H<=h&&c<=G&&G<=h&&l<=U&&U<=u&&l<=W&&W<=u&&(I=ve(c,H),E=we(h,G),R=ve(l,U),E<=I&&(E=I+1),(D=we(u,W))<=R&&(D=R+1),je(o,Q+(I-c)*ee/(h-c),$+(u-D)*te/(u-l),(E-I)*ee/(h-c),(D-R)*te/(u-l),ce)),T=x=-ue,k=A=ue,f=0,p=a.length;f<p-1;f++)re(a,f,Z,ie),V&&(0===f&&(T<w&&(x=C,T=w),w<k&&(A=C,k=w)),T<S&&(x=v,T=S),S<k&&(A=v,k=S));if(s&&0<s.length)for(ne(s,l,u,c,h),f=0,p=s.length;f<p-1;f++)re(s,f,Y,ae);V&&(oe(x,T,Me),oe(A,k,"#0000FF")),!ye(B)&&l<=B&&B<=u&&(M=le($+(u-B)*te/(u-l))-.5,be(o,Q,M,Q+ee,M,Me)),!ye(j)&&c<=j&&j<=h&&(M=le(Q+(j-c)*ee/(h-c))-.5,be(o,M,$,M,$+te,Me)),o.restore()}},BULLETSPARKLINE:function(s,e,l,u,c,h){var t,r,f,d,n,o,i,a,p,g,m,b,y,C,w,v=e.measure,S=e.target,x=e.maxi,T=e.good,A=e.bad,k=e.forecast,M=e.tickUnit,I=e.colorScheme,E=e.vertical,R=e.measureColor,D=e.targetColor,N=e.maxiColor,F=e.goodColor,_=e.badColor,P=e.forecastColor,L=e.allowMeasureOverMaxi,O=e.barSize;function B(e,t,r,n,o){var i,a;s.fillStyle=e,d<(i=d*(t/r))&&!L&&(i=d),a=new G(E?re(l+c*n,f-i,c*o,i):re(f,u+h*n,i,h*o)),s.fillRect(a.x,a.y,a.width,a.height)}if(!(ye(x)||x<0)&&(ye(O)||!(Te(O)||O<=0))){if(1<O&&(O=1),v=ye(v)||v<0?0:v,T=ye(T)||T<0?0:T,A=ye(A)||A<0?0:A,S=ye(S)?0:S,k=ye(k)?0:k,M=ye(M)?0:M,I=ye(I)?"#A0A0A0":I,t=ye(R)?"#252525":R,x<v&&!L&&(v=x,t=Me),x<T&&(T=x,t=Me),x<A&&(A=x,t=Me),x<S&&(S=0,t=Me),x<k&&(k=x,t=Me),r=Le(l,u,c,h,5,h-10,E),f=r.left,d=r.width,s.save(),n=ye(O)?.2:(1-O)/2,o=ye(O)?.6:O,i=L?Math.max(x,v):x,B(ye(N)?ie(I,1.66):N,x,i,n,o),B(ye(F)?ie(I,1.33):F,T,i,n,o),B(ye(_)?I:_,A,i,n,o),a=.25*O/.6,B(t,v,i,ye(O)?.375:(1-a)/2,ye(O)?.25:a),0<k&&(p=f,d<(g=d*(k/i))&&(g=d),m=ye(O)?3:3*O/.6,Pe(s,E,l+.5*c,p,l+.5*c,p-g,p,u+.5*h,p+g,u+.5*h,ye(P)?"#3690BF":P,m)),0<S&&(b=le(f-(E?1:-1)*d*(S/i))-.5,Pe(s,E,l+c*n,b,l+c*(1-n),b,b,u+h*n,b,u+h*(1-n),ye(D)?Me:D,1)),0<M)for(y=j(i/M),C=void 0,w=0;w<=y;w++)C=le(f-d/i*M*(E?1:-1)*w)-.5,Pe(s,E,l,C,l+.05*c,C,C,u+h,C,u+.95*h,Ie,1);s.restore()}},SPREADSPARKLINE:function(e,t,r,n,o,i){var a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A=t.spreadData,k=t.showAverage,M=t.scaleStart,I=t.scaleEnd,E=t.style,R=t.colorScheme,D=t.vertical,N=A.length;if(!(N<=0)){for(a=A[0].key,s=A[N-1].key,M=ye(M)?a:M,I=ye(I)?s:I,E=ye(E)?4:E,R=ye(R)?Ie:R,u=(l=Le(r,n,o,i,5,i-10,D)).left,c=l.width,h=l.top,f=l.height,He(e,r,n,o,i),e.beginPath(),e.strokeStyle=R,e.fillStyle=R,g=_e(A,!(e.lineWidth=2)),b=0,y=A.length;b<y;b++)if(w=(C=A[b]).key,v=C.value,d=u+(D?-1:1)*c*(w-M)/(I-M),d=D?(d=we(d,u),ve(d,u-c)):(d=ve(d,u),we(d,u+c)),d=le(d),1===E)Pe(e,D,S=h+f/2-(m=(m=v/2*f/g)<.5?.5:m),d,x=h+f/2+m,d,d,S,d,x);else if(4===E)Pe(e,D,h,d,h+(m=(m=v*f/g)<1?1:m),d,d,h+f,d,h+f-m);else if(6===E)Pe(e,D,h,d,h+f,d,d,h,d,h+f);else for(T=1;T<=v;T++){switch(E){case 2:p=h+f/2-5-(v/2-T)*f/g;break;case 3:p=h+f-5-F(v,f,3,C.randomNumbers)[T-1];break;case 5:default:p=h+f-T*f/g}p=le(p),e.beginPath(),e.fillRect(D?p:d,D?d:p,2,2)}k&&Pe(e,D,h-5,d=u-(D?1:-1)*c*(function(e){var t,r,n,o=0,i=0;for(t=0,r=e.length;t<r;t++)n=e[t],i+=n.value,o+=n.key*n.value;return 0===i?0:o/i}(A)-M)/(I-M),h+f+5,d,d,h-5,d,h+f+5,Me),e.restore()}},STACKEDSPARKLINE:function(i,e,t,r,n,o,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k=e.points,M=e.colorRange,I=e.labelRange,E=e.maximum,R=e.targetRed,D=e.targetGreen,N=e.targetBlue,F=e.targetYellow,_=e.color,P=e.highlightPosition,L=e.vertical,O=e.textOrientation,B=e.textSize;function j(e,t,r){var n,o;t!==Ce&&t!==H&&(t=E<t?E:t,r&&!r(t)||(o=(t=t<0?0:t)/E*f,L?(n=le(h-o)-.5,ne(i,d,n,d+p,n,e)):(n=le(h+o)-.5,ne(i,n,d,n,d+p,e))))}if(!(ye(k)||(s=k.length)<=0)){if(_=ye(_)?Ie:_,ye(M)||M.length!==s||function(e){for(var t=0,r=e.length;t<r;t++)if(ye(e[t]))return 1;return}(M))for(M=[],l=0;l<s;l++)M.push(ie(_,1+l/s));for(u=Oe(k,function(e){return 0<e}),E=ye(E)||E<u?u:E,O=ye(O)?0:O,B=ye(B)||B<=0?10:B,B=Te(B)?B:B*a.zoomFactor,c=Le(t,r,n,o,5,o-10,L),h=c.left,f=c.width,d=c.top,p=c.height,i.save(),g=h,S=0,x=s;S<x;S++)(v=k[S])<=0||(m=v/E*f,w=L?(b=t+.15*n,C=.7*n,y=g-m,m):(b=g,C=m,y=r+.15*o,.7*o),T=S+1===P?Me:M[S],i.save(),i.fillStyle=T,i.fillRect(b,y,C,w),(A=I&&I[S])&&(i.save(),i.fillStyle=oe(T),i.textBaseline=ee,i.textAlign=J,i.font=B+te,i.rect(b,y,C,w),i.clip(),1===O?(i.translate(b+C/2,y),i.rotate(Math.PI/2),i.fillText(A,w/2,0)):i.fillText(A,b+C/2,y+w/2),i.restore()),g+=(L?-1:1)*m,i.restore());j(Y,R,function(e){return 0<e}),j(Z,D),j(W,N),j("yellow",F),i.restore()}},HBARSPARKLINE:function(e,t,r,n,o,i){l(0,e,t,r,n,o,i)},VBARSPARKLINE:function(e,t,r,n,o,i){l(1,e,t,r,n,o,i)},VARISPARKLINE:function(C,e,w,v,S,x,t){var T,r,n,o,A,k,i,M,a,s,l,u,c,I,E,h,f,d,p,g,m,b=e.variance,y=e.reference,R=e.mini,D=e.maxi,N=e.mark,F=e.tickUnit,_=e.legend,P=e.colorPositive,L=e.colorNegative,O=e.vertical,B=Me,j=ke,H=13*t.zoomFactor,G=Ae(b);function U(e,t,r,n,o,i,a,s,l,u,c,h,f,d){var p,g,m,b,y;b=O?(p=w+.25*S,g=0===t?I-E:I,m=.5*S,E):(p=0===t?I:I-E,g=v+.25*x,m=E,.5*x),je(C,p,g,m,b,e),M&&(He(C,p,g,m,b),O?We(C,w+S/2,T+r,k,o):We(C,T+n,v+x/2,k,i),C.restore()),_&&(y=0,M&&(y=.4*k*z(3)/2+5+2),C.save(),C.beginPath(),C.font=H+te,C.fillStyle=ae,O?(C.textAlign=J,W(H+E+a,d,e,s,l,p,g,m,b,O),C.fillText(A,w+S/2,I+f*(E-y))):(C.textBaseline=ee,W(C.measureText(A).width+E+u,d,e,c,h,p,g,m,b,O),C.fillText(A,I+f*(y-E),v+x/2)),C.restore())}function W(e,t,r,n,o,i,a,s,l,u){u?C.textBaseline=n:C.textAlign=n,0<e&&t<E&&(C.rect(i,a,s,l),C.clip(),u?C.textBaseline=o:C.textAlign=o,C.fillStyle=oe(r))}function V(e,t,r,n,o,i,a,s,l,u){O?Ue(C,e,t,r,n,l):Ue(C,o,i,a,s,u)}if(!(Te(G)||(L=ye(L)?Y:L,P=ye(P)?Z:P,F=ye(F)?0:F,D=ye(D)?1:D,R=ye(R)?-1:R,(i=!ye(y))||(y=0),o=O?(T=v+x-5,r=x-10,n=S-20,-1):(T=w+5,r=S-10,n=x-20,1),_&&(a=Ae(e.variance),Te(a)||(l=(s=""+a).substr(s.indexOf(".")+1).length,A=2<=l?(100*a).toFixed(l-2)+"%":(100*a).toFixed(0)+"%")),D<G&&(G=D,M=!0),G<R&&(G=R,M=!0),y=pe(y,D,R),M&&(k=pe(n,60,15)),c=r/(u=Se(D-R)),I=T+o*Se(R-y)*c,(E=Se(G-y)*c)>Se(u)*c&&(E=Se(u+R)*c),h=T+o*r,O&&I<h||!O&&h<I))){if(He(C,w,v,S,x),y<G?U(P,0,5-r,r-5,0,1,v-I,$,Q,I-w-S,K,X,-1,Se(D-G)*c):(E>Se(u)*c&&(E=Se(u+R)*c,I=T),U(L,1,-5,5,2,3,I-v-x,Q,$,w-I,X,K,1,Se(R-G)*c)),i&&(f=T+o*(Math.abs(R-y)*c),V(w,f,w+S,f,f,v,f,v+x)),0<F)for(C.beginPath(),d=u/F,p=0;p<=d;p++)V(w,g=T+r/d*p*o,w+.1*S,g,g,v+.9*x,g,v+x,j,j);!ye(N)&&R<=N&&N<=D&&(C.beginPath(),m=T-(O?1:-1)*Se(R-N)*c,V(w,m,w+.33*S,m,m,v+.66*x,m,v+x,B,B),C.fill()),C.restore()}},BOXPLOTSPARKLINE:function(u,e,t,r,n,o){var i,a,s,l,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe=e.points,ie=e.boxPlotClass,ae=e.showAverage,se=e.scaleStart,le=e.scaleEnd,ue=e.acceptableStart,ce=e.acceptableEnd,he=e.style,fe=e.colorScheme,de=e.vertical,pe=_e(oe,!1),ge=_e(oe,!0);function me(e,t,r,n,o,i,a,s,l){de?je(u,t,r,n,o,e):je(u,i,a,s,l,e)}function be(e,t,r,n){Pe(u,de,_+P*e,r,_+P*t,r,r,_+P*e,r,_+P*t,n)}if(!(ye(oe)||(oe=Be(oe)).length<=0)){for((ie=ie===Ce||typeof ie!==xe?Re:ie.toLocaleLowerCase())!==Re&&ie!==Ee&&ie!==De&&ie!==Ne&&ie!==Fe&&(ie=Re),i=Ae(se),i=Te(i)?ge:i,a=Ae(le),a=Te(a)?pe:a,s=Ae(ue),l=Ae(ce),fe!==Ce&&typeof fe===xe||(fe="#D2D2D2"),(he===Ce||0!==he&&1!==he)&&(he=0),c=Me,ge<i&&(fe=c,i=ge),a<pe&&(fe=c,a=pe),He(u,t,r,n,o),u.lineWidth=2,f=(h=Le(t,r,n,o,5,o-10,de)).left,d=h.width,p=h.top,g=h.height,m=de?-1:1,b=e.perc02,y=e.perc09,C=e.perc10,w=e.perc90,v=e.perc91,S=e.perc98,x=e.q1,k=ge,M=pe,E=I=1.5*(A=(T=e.q3)-x),R=e.stDev,D=Oe(oe)/ve(1,oe.length),F=N=0,_=p+.1*g,P=.7*g,L=Se(a-i),O=0,B=oe.length;O<B;O++)(j=oe[O])<x&&x-1.5*A<=j&&j-(x-1.5*A)<I&&(I=j-(x-1.5*A),k=j),T<j&&j<=T+1.5*A&&T+1.5*A-j<E&&(E=T+1.5*A-j,M=j),H=!1,N=f+d*((j-i)/L)*m,ie===De&&(j<=x-1.5*A||T+1.5*A<=j)&&(H=!0,F=j<=x-3*A||T+3*A<=j?0:1),ie===Ee&&(j<=b||S<=j)&&(H=!0,F=1),ie===Fe&&(j<=D-2*R||D+2*R<=j)&&(H=!0,F=j<=D-3*R||D+3*R<=j?0:1),G=ke,H&&(1===he?1===F?be(.2,.8,N,G):be(.3,.7,N,G):((U=.1*g)<2&&(U=2),u.beginPath(),u.strokeStyle=G,W=p+.45*g,u.arc(de?W:N,de?N:W,U/2,0,2*Math.PI),u.stroke()));switch((s<i||a<l)&&(fe="#C0FF00"),s=ve(i,s),(l=we(a,l))<s?fe=c:s<l&&Pe(u,de,q=p+.9*g,V=f+d*((s-i)/L)*m,q,z=f+d*((l-i)/L)*m,V,q,z,q,Ie),Y=Se(f+d*((T-i)/L)*m-(Z=f+d*((x-i)/L)*m)),K=f+d*((e.median-i)/L)*m,ie){case Ee:Q=b,$=S;break;case De:Q=k,$=M;break;case Fe:Y=Se(f+d*((D+R-i)/L)*m-(Z=f+d*((D-R-i)/L)*m)),K=f+d*((D-i)/L)*m,Q=i<(ee=D-2*R)?ee:ge,$=(ee=D+2*R)<a?ee:pe,ae=!1;break;case Re:case Ne:default:Q=ge,$=pe}X=f+d*((Q-i)/L)*m,J=f+d*(($-i)/L)*m,te=ke,1===he?me("#F2F2F2",_,J,P,X-J,X,_,J-X,P):Pe(u,de,re=p+.45*g,X,re,J,X,re,J,re,te),me(fe,_,Z-Y,P,Y,Z,_,Y,P),Pe(u,de,_,K,_+P,K,K,_,K,_+P,te),0===he&&(Pe(u,de,_+.3*P,J,_+.7*P,J,J,_+.3*P,J,_+.7*P,te),Pe(u,de,_+.3*P,X,_+.7*P,X,X,_+.3*P,X,_+.7*P,te)),ie!==Ee&&ie!==Ne||(0,$=ie===Ee?(Q=y,v):(Q=C,w),ne=f+d*((Q-i)/L)*m,be(.3,.7,f+d*(($-i)/L)*m,te),be(.3,.7,ne,te)),ae&&be(.2,.8,N=f+d*((D-i)/L)*m,c),u.restore()}},CASCADESPARKLINE:function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y=t.points,K=t.labels,X=t.pointIndex,J=t.minimum,Q=t.maximum,$=t.colorPositive,ee=t.colorNegative,te=t.vertical,re=t.itemTypeRange,ne=t.colorTotal,oe=13*a.zoomFactor;if(!(ye(Y)||((s=Y.length)<=0||(l=parseInt(X,10),Te(l)||l<=0||s<l)))){for(K=ye(K)?[]:K,$!==Ce&&typeof $===xe||($="#8CBF64"),ee!==Ce&&typeof ee===xe||(ee="#D6604D"),typeof ne!==xe&&(ne=Ce),c=ie(u=$,1.3),f=ie(h=ee,1.3),d=1,y=[],S=w=C=b=m=g=p=0,x=s;S<x;S++)w=Y[S],v=re[S],T=!1,ye(v)||(v===fe?w=Se(w):v===he?w=-Se(w):v===de&&(T=!0,w=p)),y[d]=[],A=y[d],Te(w)?(A[0]=0,A[1]=p,A[2]=0):(A[0]=Se(w),p=T?p:w+p,A[1]=0<w?g:p,A[2]=w),A[3]=d,m=we(g,m),b=ve(g,b),(ye(v)&&d===s||T)&&(C=m<0?-m:0,A[1]=0<w?0:w),!ye(v)&&T||(g=w+g),d++;ye(v)&&(p-=w),I=Ae(J),Te(I)||0<I||m<I?I=k=m:C=-(k=I),E=Ae(Q),Te(E)||E<0||E<b?M=b:(M=E,C=-I),D=(R=Le(r,n,o,i,5,i-10,te)).left,N=R.width,F=R.top,_=R.height,P=te?-1:1,L=N/(M-k),He(e,r,n,o,i),e.beginPath(),e.lineWidth=1,B=(O=y[l])[2],j=re[l-1],H=D+P*(O[1]+C)*L,G=O[0]*L,W=j===de,V=ye(j)&&l===s||W,U=ne&&V?ne:1===l||V?0<=B?u:h:0<=B?c:f,te?je(e,F,H-G,_,G,U):je(e,H,F,G,_,U),te?(1!==l&&(l!==s?Ve(e,0<B,ce,r,H,F+_,H,r,H-G,F+_,H-G):Ve(e,!0,ce,r,z=D-(p+C)*L,F+_,z)),l!==s&&Ve(e,0<B,ce,F,H-G,r+o,H-G,F,H,r+o,H)):(1!==l&&(l!==s?Ve(e,0<B,ce,H,n,H,F+_,H+G,n,H+G,F+_):Ve(e,!0,ce,q=D+(p+C)*L,n,q,F+_)),l!==s&&Ve(e,0<B,ce,H+G,F,H+G,n+i,H,F,H,n+i)),Z=K[l-1],0<K.length&&!ye(Z)&&""!==Z&&ze(e,r,n,o,i,{labelText:Z,vertical:te,isInRightOrTopOfBox:0<B,fontSize:oe,startBox:H,endBox:G,boxColor:U}),Ve(e,te,ae,r,D-C*L,r+o,D-C*L,D+C*L,n,D+C*L,n+i),e.restore()}},PARETOSPARKLINE:function(i,e,a,s,l,u,t){var r,n,o,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F=e.points,_=e.pointIndex,P=e.colorRange,L=e.target,O=e.target2,B=e.highlightPosition,j=e.label,H=e.vertical,G=13*t.zoomFactor,U=e.targetColor,W=e.target2Color,V=e.labelColor,z=e.barSize;if(!ye(F)&&(ye(z)||!(Te(z)||z<=0))&&(1<z&&(z=1),!((r=F.length)<=0||(n=parseInt(_,10),Te(n)||n<=0||r<n)))){for(P=ye(P)?[]:P,o=parseInt(j,10),o=Te(o)?0:o,c=1,f=[],d=h=0,p=F.length;d<p;d++)g=F[d],f[c]=[],m=f[c],g<0||Te(g)||ye(g)?(m[0]=1===c?0:h,m[1]=0):(h+=g,m[0]=1===c?0:h-g,m[1]=g),c++;b=ye(z)?5:H?l*(1-z)/2:u*(1-z)/2,y=Le(a,s,l,u,b,u-10,H,5),C=y.left,w=y.width,v=y.top,S=y.height,x=H?-1:1,T=w/h,He(i,a,s,l,u),i.beginPath(),i.lineWidth=1,k=(A=f[n])[1],M=C+x*A[0]*T,I=A[1]*T,E=n===B?Me:0===P.length||typeof P[n-1]!==xe?ke:P[n-1],H?je(i,v,M-I,S,I,E):je(i,M,v,I,S,E),1===o?R=(A[0]+k)/h*1e3:2===o&&(R=k/h*1e3),D=le(R)/10+"%",1!==o&&2!==o||!D||ze(i,a,s,l,u,{labelText:D,vertical:H,isInRightOrTopOfBox:(A[0]+A[1])*T<w/2,fontSize:G,startBox:M,endBox:I,boxColor:E,fillStyle:V}),N=[ye(U)?"#8CBF64":U,ye(W)?"#EE5D5D":W],[L,O].forEach(function(e,t){var r,n=(r=Ae(e),1<(r=(r=Te(r)?0:r)<0?0:r)?1:r),o=q(C+x*w*n);Ve(i,H,N[t],a,o,a+l,o,o,s,o,s+u)}),i.restore()}},MONTHSPARKLINE:function(e,t,r,n,o,i){var a,s,l,u,c=t.year,h=t.month,f=t.values,d=t.emptyColor||"lightgray",p=t.startColor,g=t.middleColor,m=t.endColor,b=(o-14)/6,y=(i-16)/7,C=[],w=new Date(c,h-1,1).getDay();for(a=0;a<42;a++)!(a<w)&&a<w+qe(c,h)?C[a]=d:C[a]="white";for(Ze(f,C,w,t.colors,p,g,m),e.save(),e.rect(r,n,o,i),e.clip(),e.beginPath(),l=s=0;l<6;l++)for(u=0;u<7;u++)e.fillStyle=C[s++],e.fillRect(r+l*b+2*(l+1),n+u*y+2*(u+1),b,y);e.restore()},YEARSPARKLINE:function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E=t.year,R=t.values,D=t.emptyColor||"lightgray",N=t.startColor,F=t.middleColor,_=t.endColor,P=parseInt(366/7+"",10)+2,L=[],O=new Date(E,0,1).getDay(),B=Ye(new Date(E,11,31));for(s=0;s<7*P;s++)L[s]=!(s<O)&&s<O+B?D:"white";for(Ze(R,L,O,t.colors,N,F,_),e.save(),e.rect(r,n,o,i),e.clip(),c=r+(u=15*(l=a.zoomFactor)),h=n,f=o-u,d=i,e.save(),e.translate(r+u/2,h+d),e.rotate(-Math.PI/2),e.font=13*l+te,e.fillStyle="black",e.textBaseline="middle",e.textAlign="center",e.fillText(E+"",d/2,0),e.restore(),p=(f-2*(P+1))/P,g=(d-16)/7,w=[],y=m=0;y<P;y++)for(b=0;b<7;b++)C={x:c+y*p+2*(y+1),y:h+b*g+2*(b+1),w:p,h:g},w[m]=C,e.fillStyle=L[m++],e.fillRect(C.x,C.y,C.w,C.h);for(v=[],S={},x=0;x<12;x++)S[x]=Ye(new Date(E,x,1))-1+O;for(T=S[11]+qe(E,12)-1,y=m=0;y<P;y++)for(b=0;b<7;b++)O<=m&&m<O+B&&(k=S[(A=new Date(E,0,m-O+1)).getMonth()],C=w[m],k<=m&&m<7+k&&v.push({x1:C.x,y1:C.y-1,x2:C.x,y2:C.y+C.h+1}),m!==k&&0!==A.getDay()||v.push({x1:C.x-1,y1:C.y,x2:C.x+C.w+1+(m===k?2:0),y2:C.y}),T-7<m&&m<=T&&v.push({x1:C.x+C.w,y1:C.y-1,x2:C.x+C.w,y2:C.y+C.h+1}),m!==T&&6!==A.getDay()||v.push({x1:C.x-1-(m===T?2:0),y1:C.y+C.h,x2:C.x+C.w+1,y2:C.y+C.h})),m++;for(e.strokeStyle="black",e.lineWidth=2,M=0;M<v.length;M++)I=v[M],e.beginPath(),e.moveTo(I.x1,I.y1),e.lineTo(I.x2,I.y2),e.stroke();e.restore()}}}},i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){var r,n;if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(r=Object.create(null),i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/assets/",i(i.s="./src/all.entry.ts")),e.exports=o.Spread},"./node_modules_local/@grapecity/js-sheets-common/index.js":function(e,t,r){e.exports=r("./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js")},"@grapecity/js-calc":function(e,t){e.exports=qe.Spread.CalcEngine},"@grapecity/js-sheets-common":function(e,t){e.exports=qe.Spread},Bindings:function(e,t){e.exports=qe.Spread.Sheets.Bindings},CellTypes:function(e,t){e.exports=qe.Spread.Sheets.CellTypes},ConditionalFormatting:function(e,t){e.exports=qe.Spread.Sheets.ConditionalFormatting},Core:function(e,t){e.exports=qe.Spread.Sheets},Filters:function(e,t){e.exports=qe.Spread.Sheets.Filter},SheetsCalc:function(e,t){e.exports=qe.Spread.Sheets.CalcEngine},Sparkline:function(e,t){e.exports=qe.Spread.Sheets.Sparklines}},s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(t,e){var r,n;if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(r=Object.create(null),s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(n in t)s.d(r,n,function(e){return t[e]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s="./all.entry.js")),o=qe||{},"object"==typeof e.exports?e.exports=o:void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)},2027:function(e,t,r){e.exports=r(2028)},2028:function(t,e,r){(function(G,h,i){var e;window,e=function(){return n={},o.m=r={"./src/common/builtIn-resource.ts":function(e,t,r){"use strict";var n,o;function i(e,t,r,n,o,i,a,s,l,u,c,h,f){return'<a:clrScheme name="'+e+'"><a:dk1><a:sysClr val="windowText" lastClr="'+n+'"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="'+t+'"/></a:lt1><a:dk2><a:srgbClr val="'+o+'"/></a:dk2><a:lt2><a:srgbClr val="'+r+'"/></a:lt2><a:accent1><a:srgbClr val="'+i+'"/></a:accent1><a:accent2><a:srgbClr val="'+a+'"/></a:accent2><a:accent3><a:srgbClr val="'+s+'"/></a:accent3><a:accent4><a:srgbClr val="'+l+'"/></a:accent4><a:accent5><a:srgbClr val="'+u+'"/></a:accent5><a:accent6><a:srgbClr val="'+c+'"/></a:accent6><a:hlink><a:srgbClr val="'+h+'"/></a:hlink><a:folHlink><a:srgbClr val="'+f+'"/></a:folHlink></a:clrScheme>'}function a(e,t,r){return'<a:fontScheme name="'+e+'"><a:majorFont><a:latin typeface="'+t+'" panose="020F0302020204030204"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface=" "/><a:font script="Hang" typeface=" "/><a:font script="Hans" typeface=""/><a:font script="Hant" typeface=""/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:majorFont><a:minorFont><a:latin typeface="'+r+'" panose="020F0502020204030204"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface=" "/><a:font script="Hang" typeface=" "/><a:font script="Hans" typeface=""/><a:font script="Hant" typeface=""/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:minorFont></a:fontScheme>'}Object.defineProperty(t,"__esModule",{value:!0}),t.BuiltInStylesResource='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><numFmts count="4"><numFmt numFmtId="42" formatCode="_(&quot;$&quot;* #,##0_);_(&quot;$&quot;* (#,##0);_(&quot;$&quot;* &quot;-&quot;_);_(@_)"/><numFmt numFmtId="41" formatCode="_(* #,##0_);_(* (#,##0);_(* &quot;-&quot;_);_(@_)"/><numFmt numFmtId="44" formatCode="_(&quot;$&quot;* #,##0.00_);_(&quot;$&quot;* (#,##0.00);_(&quot;$&quot;* &quot;-&quot;??_);_(@_)"/><numFmt numFmtId="43" formatCode="_(* #,##0.00_);_(* (#,##0.00);_(* &quot;-&quot;??_);_(@_)"/></numFmts><fonts count="18"><font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><b/><sz val="18"/><color theme="3"/><name val="Cambria"/><family val="2"/><scheme val="major"/></font><font><b/><sz val="15"/><color theme="3"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><b/><sz val="13"/><color theme="3"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><b/><sz val="11"/><color theme="3"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><sz val="11"/><color rgb="FF006100"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><sz val="11"/><color rgb="FF9C0006"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><sz val="11"/><color rgb="FF9C6500"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><sz val="11"/><color rgb="FF3F3F76"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><b/><sz val="11"/><color rgb="FF3F3F3F"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><b/><sz val="11"/><color rgb="FFFA7D00"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><sz val="11"/><color rgb="FFFA7D00"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><b/><sz val="11"/><color theme="0"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><sz val="11"/><color rgb="FFFF0000"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><i/><sz val="11"/><color rgb="FF7F7F7F"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><b/><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><sz val="11"/><color theme="0"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts><fills count="33"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill><fill><patternFill patternType="solid"><fgColor rgb="FFC6EFCE"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFFFC7CE"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFFFEB9C"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFFFCC99"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFF2F2F2"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFA5A5A5"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFFFFFCC"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="4"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="4" tint="0.79998168889431442"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="4" tint="0.59999389629810485"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="4" tint="0.39997558519241921"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="5"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="5" tint="0.79998168889431442"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="5" tint="0.59999389629810485"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="5" tint="0.39997558519241921"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="6"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="6" tint="0.79998168889431442"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="6" tint="0.59999389629810485"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="6" tint="0.39997558519241921"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="7"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="7" tint="0.79998168889431442"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="7" tint="0.59999389629810485"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="7" tint="0.39997558519241921"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="8"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="8" tint="0.79998168889431442"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="8" tint="0.59999389629810485"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="8" tint="0.39997558519241921"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="9"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="9" tint="0.79998168889431442"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="9" tint="0.59999389629810485"/><bgColor indexed="65"/></patternFill></fill><fill><patternFill patternType="solid"><fgColor theme="9" tint="0.39997558519241921"/><bgColor indexed="65"/></patternFill></fill></fills><borders count="10"><border><left/><right/><top/><bottom/><diagonal/></border><border><left/><right/><top/><bottom style="thick"><color theme="4"/></bottom><diagonal/></border><border><left/><right/><top/><bottom style="thick"><color theme="4" tint="0.499984740745262"/></bottom><diagonal/></border><border><left/><right/><top/><bottom style="medium"><color theme="4" tint="0.39997558519241921"/></bottom><diagonal/></border><border><left style="thin"><color rgb="FF7F7F7F"/></left><right style="thin"><color rgb="FF7F7F7F"/></right><top style="thin"><color rgb="FF7F7F7F"/></top><bottom style="thin"><color rgb="FF7F7F7F"/></bottom><diagonal/></border><border><left style="thin"><color rgb="FF3F3F3F"/></left><right style="thin"><color rgb="FF3F3F3F"/></right><top style="thin"><color rgb="FF3F3F3F"/></top><bottom style="thin"><color rgb="FF3F3F3F"/></bottom><diagonal/></border><border><left/><right/><top/><bottom style="double"><color rgb="FFFF8001"/></bottom><diagonal/></border><border><left style="double"><color rgb="FF3F3F3F"/></left><right style="double"><color rgb="FF3F3F3F"/></right><top style="double"><color rgb="FF3F3F3F"/></top><bottom style="double"><color rgb="FF3F3F3F"/></bottom><diagonal/></border><border><left style="thin"><color rgb="FFB2B2B2"/></left><right style="thin"><color rgb="FFB2B2B2"/></right><top style="thin"><color rgb="FFB2B2B2"/></top><bottom style="thin"><color rgb="FFB2B2B2"/></bottom><diagonal/></border><border><left/><right/><top style="thin"><color theme="4"/></top><bottom style="double"><color theme="4"/></bottom><diagonal/></border></borders><cellStyleXfs count="47"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/><xf numFmtId="43" fontId="1" fillId="0" borderId="0" applyFont="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="41" fontId="1" fillId="0" borderId="0" applyFont="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="44" fontId="1" fillId="0" borderId="0" applyFont="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="42" fontId="1" fillId="0" borderId="0" applyFont="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="9" fontId="1" fillId="0" borderId="0" applyFont="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyNumberFormat="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyNumberFormat="0" applyFill="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="4" fillId="0" borderId="2" applyNumberFormat="0" applyFill="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="5" fillId="0" borderId="3" applyNumberFormat="0" applyFill="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="5" fillId="0" borderId="0" applyNumberFormat="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="6" fillId="2" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="7" fillId="3" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="8" fillId="4" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="9" fillId="5" borderId="4" applyNumberFormat="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="10" fillId="6" borderId="5" applyNumberFormat="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="11" fillId="6" borderId="4" applyNumberFormat="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="12" fillId="0" borderId="6" applyNumberFormat="0" applyFill="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="13" fillId="7" borderId="7" applyNumberFormat="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="14" fillId="0" borderId="0" applyNumberFormat="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="8" borderId="8" applyNumberFormat="0" applyFont="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="15" fillId="0" borderId="0" applyNumberFormat="0" applyFill="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="16" fillId="0" borderId="9" applyNumberFormat="0" applyFill="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="9" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="10" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="11" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="12" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="13" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="14" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="15" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="16" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="17" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="18" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="19" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="20" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="21" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="22" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="23" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="24" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="25" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="26" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="27" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="28" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="29" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="30" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="1" fillId="31" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/><xf numFmtId="0" fontId="17" fillId="32" borderId="0" applyNumberFormat="0" applyBorder="0" applyAlignment="0" applyProtection="0"/></cellStyleXfs><cellXfs count="47"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/><xf numFmtId="0" fontId="6" fillId="2" borderId="0" xfId="11"/><xf numFmtId="0" fontId="7" fillId="3" borderId="0" xfId="12"/><xf numFmtId="0" fontId="8" fillId="4" borderId="0" xfId="13"/><xf numFmtId="0" fontId="13" fillId="7" borderId="7" xfId="18"/><xf numFmtId="0" fontId="11" fillId="6" borderId="4" xfId="16"/><xf numFmtId="0" fontId="15" fillId="0" borderId="0" xfId="21"/><xf numFmtId="0" fontId="9" fillId="5" borderId="4" xfId="14"/><xf numFmtId="0" fontId="12" fillId="0" borderId="6" xfId="17"/><xf numFmtId="0" fontId="0" fillId="8" borderId="8" xfId="20" applyFont="1"/><xf numFmtId="0" fontId="14" fillId="0" borderId="0" xfId="19"/><xf numFmtId="0" fontId="10" fillId="6" borderId="5" xfId="15"/><xf numFmtId="0" fontId="1" fillId="14" borderId="0" xfId="28"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" xfId="7"/><xf numFmtId="0" fontId="4" fillId="0" borderId="2" xfId="8"/><xf numFmtId="0" fontId="5" fillId="0" borderId="3" xfId="9"/><xf numFmtId="0" fontId="5" fillId="0" borderId="0" xfId="10"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" xfId="6"/><xf numFmtId="0" fontId="16" fillId="0" borderId="9" xfId="22"/><xf numFmtId="0" fontId="1" fillId="10" borderId="0" xfId="24"/><xf numFmtId="0" fontId="1" fillId="18" borderId="0" xfId="32"/><xf numFmtId="0" fontId="1" fillId="22" borderId="0" xfId="36"/><xf numFmtId="0" fontId="1" fillId="26" borderId="0" xfId="40"/><xf numFmtId="0" fontId="1" fillId="30" borderId="0" xfId="44"/><xf numFmtId="0" fontId="1" fillId="11" borderId="0" xfId="25"/><xf numFmtId="0" fontId="1" fillId="15" borderId="0" xfId="29"/><xf numFmtId="0" fontId="17" fillId="12" borderId="0" xfId="26"/><xf numFmtId="0" fontId="17" fillId="9" borderId="0" xfId="23"/><xf numFmtId="43" fontId="0" fillId="0" borderId="0" xfId="1" applyFont="1"/><xf numFmtId="0" fontId="1" fillId="19" borderId="0" xfId="33"/><xf numFmtId="0" fontId="17" fillId="16" borderId="0" xfId="30"/><xf numFmtId="0" fontId="17" fillId="13" borderId="0" xfId="27"/><xf numFmtId="0" fontId="17" fillId="20" borderId="0" xfId="34"/><xf numFmtId="0" fontId="17" fillId="17" borderId="0" xfId="31"/><xf numFmtId="0" fontId="1" fillId="23" borderId="0" xfId="37"/><xf numFmtId="0" fontId="17" fillId="24" borderId="0" xfId="38"/><xf numFmtId="0" fontId="17" fillId="21" borderId="0" xfId="35"/><xf numFmtId="0" fontId="17" fillId="28" borderId="0" xfId="42"/><xf numFmtId="0" fontId="1" fillId="27" borderId="0" xfId="41"/><xf numFmtId="0" fontId="17" fillId="25" borderId="0" xfId="39"/><xf numFmtId="0" fontId="1" fillId="31" borderId="0" xfId="45"/><xf numFmtId="0" fontId="17" fillId="32" borderId="0" xfId="46"/><xf numFmtId="0" fontId="17" fillId="29" borderId="0" xfId="43"/><xf numFmtId="9" fontId="0" fillId="0" borderId="0" xfId="5" applyFont="1"/><xf numFmtId="42" fontId="0" fillId="0" borderId="0" xfId="4" applyFont="1"/><xf numFmtId="44" fontId="0" fillId="0" borderId="0" xfId="3" applyFont="1"/><xf numFmtId="41" fontId="0" fillId="0" borderId="0" xfId="2" applyFont="1"/></cellXfs><cellStyles count="47"><cellStyle name="20% - Accent1" xfId="24" builtinId="30"/><cellStyle name="20% - Accent2" xfId="28" builtinId="34"/><cellStyle name="20% - Accent3" xfId="32" builtinId="38"/><cellStyle name="20% - Accent4" xfId="36" builtinId="42"/><cellStyle name="20% - Accent5" xfId="40" builtinId="46"/><cellStyle name="20% - Accent6" xfId="44" builtinId="50"/><cellStyle name="40% - Accent1" xfId="25" builtinId="31"/><cellStyle name="40% - Accent2" xfId="29" builtinId="35"/><cellStyle name="40% - Accent3" xfId="33" builtinId="39"/><cellStyle name="40% - Accent4" xfId="37" builtinId="43"/><cellStyle name="40% - Accent5" xfId="41" builtinId="47"/><cellStyle name="40% - Accent6" xfId="45" builtinId="51"/><cellStyle name="60% - Accent1" xfId="26" builtinId="32"/><cellStyle name="60% - Accent2" xfId="30" builtinId="36"/><cellStyle name="60% - Accent3" xfId="34" builtinId="40"/><cellStyle name="60% - Accent4" xfId="38" builtinId="44"/><cellStyle name="60% - Accent5" xfId="42" builtinId="48"/><cellStyle name="60% - Accent6" xfId="46" builtinId="52"/><cellStyle name="Accent1" xfId="23" builtinId="29"/><cellStyle name="Accent2" xfId="27" builtinId="33"/><cellStyle name="Accent3" xfId="31" builtinId="37"/><cellStyle name="Accent4" xfId="35" builtinId="41"/><cellStyle name="Accent5" xfId="39" builtinId="45"/><cellStyle name="Accent6" xfId="43" builtinId="49"/><cellStyle name="Bad" xfId="12" builtinId="27"/><cellStyle name="Calculation" xfId="16" builtinId="22"/><cellStyle name="Check Cell" xfId="18" builtinId="23"/><cellStyle name="Comma" xfId="1" builtinId="3"/><cellStyle name="Comma [0]" xfId="2" builtinId="6"/><cellStyle name="Currency" xfId="3" builtinId="4"/><cellStyle name="Currency [0]" xfId="4" builtinId="7"/><cellStyle name="Explanatory Text" xfId="21" builtinId="53"/><cellStyle name="Good" xfId="11" builtinId="26"/><cellStyle name="Heading 1" xfId="7" builtinId="16"/><cellStyle name="Heading 2" xfId="8" builtinId="17"/><cellStyle name="Heading 3" xfId="9" builtinId="18"/><cellStyle name="Heading 4" xfId="10" builtinId="19"/><cellStyle name="Input" xfId="14" builtinId="20"/><cellStyle name="Linked Cell" xfId="17" builtinId="24"/><cellStyle name="Neutral" xfId="13" builtinId="28"/><cellStyle name="Normal" xfId="0" builtinId="0"/><cellStyle name="Note" xfId="20" builtinId="10"/><cellStyle name="Output" xfId="15" builtinId="21"/><cellStyle name="Percent" xfId="5" builtinId="5"/><cellStyle name="Title" xfId="6" builtinId="15"/><cellStyle name="Total" xfId="22" builtinId="25"/><cellStyle name="Warning Text" xfId="19" builtinId="11"/></cellStyles><dxfs count="0"/><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleLight16"/></styleSheet>',n="000000",o="FFFFFF",t.ThemeClrSchemes={Default:i("Default",o,"EEECE1",n,"1F497D","4F81BD","C0504D","9BBB59","8064A2","4BACC6","F79646","0000FF","800080"),Office2007:i("Office2007",o,"EEECE1",n,"1F497D","4F81BD","C0504D","9BBB59","8064A2","4BACC6","F79646","0000FF","800080"),Office:i("Office",o,"E7E6E6",n,"44546A","5B9BD5","ED7D31","A5A5A5","FFC000","4472C4","70AD47","0563C1","954F72"),Apex:i("Apex",o,"C9C2D1",n,"69676D","CEB966","9CB084","6BB1C9","6585CF","7E6BC9","A379BB","410082","932968"),Aspect:i("Aspect",o,"E3DED1",n,"323232","F07F09","9F2936","1B587C","4E8542","604878","C19859","6B9F25","B26B02"),Concourse:i("Concourse",o,"DEF5FA",n,"464646","2DA2BF","DA1F28","EB641B","39639D","474B78","7D3C4A","FF8119","44B9E8"),Civic:i("Civic",o,"C5D1D7",n,"646B86","D16349","CCB400","8CADAE","8C7B70","8FB08C","D19049","00A3D6","694F07"),Oriel:i("Oriel",o,"FFF39D",n,"575F6D","FE8637","7598D9","B32C16","F5CD2D","AEBAD5","777C84","D2611C","3B435B"),Origin:i("Origin",o,"DDE9EC",n,"464653","727CA3","9FB8CD","D2DA7A","FADA7A","B88472","8E736A","B292CA","6B5680"),Paper:i("Paper",o,"FEFAC9",n,"444D26","A5B592","F3A447","E7BC29","D092A7","9C85C0","809EC2","8E58B6","7F6F6F"),Solstice:i("Solstice",o,"E7DEC9",n,"4F271C","3891A7","FEB80A","C32D2E","84AA33","964305","475A8D","8DC765","AA8A14"),Technic:i("Technic",o,"D4D2D0",n,"3B3B3B","6EA0B0","CCAF0A","8D89A4","748560","9E9273","7E848D","00C8C3","A116E0"),Trek:i("Trek",o,"FBEEC9",n,"4E3B30","F0A22E","A5644E","B58B80","C3986D","A19574","C17529","AD1F1F","FFC42F"),Urban:i("Urban",o,"DEDEDE",n,"424456","53548A","438086","A04DA3","C4652D","8B5D3D","5C92B5","67AFBD","C2A874"),Verve:i("Verve",o,"D2D2D2",n,"666666","FF388C","E40059","9C007F","68007F","005BD3","00349E","17BBFD","FF79C2"),Equity:i("Equity",o,"E9E5DC",n,"696464","D34817","9B2D1F","A28E6A","956251","918485","855D5D","CC9900","96A9A9"),Flow:i("Flow",o,"DBF5F9",n,"04617B","0F6FC6","009DD9","0BD0D9","10CF9B","7CCA62","A5C249","E2D700","85DFD0"),Foundry:i("Foundry",o,"EAEBDE",n,"676A55","72A376","B0CCB0","A8CDD7","C0BEAF","CEC597","E8B7B7","DB5353","903638"),Median:i("Median",o,"EBDDC3",n,"775F55","94B6D2","DD8047","A5AB81","D8B25C","7BA79D","968C8C","F7B615","704404"),Metro:i("Metro",o,"D6ECFF",n,"4E5B6F","7FD13B","EA157A","FEB80A","00ADDC","738AC8","1AB39F","EB8803","5F7791"),Module:i("Module",o,"D4D4D6",n,"5A6378","F0AD00","60B5CC","E66C7D","6BB76D","E88651","C64847","168BBA","680000"),Opulent:i("Opulent",o,"F4E7ED",n,"B13F9A","B83D68","AC66BB","DE6C36","F9B639","CF6DA4","FA8D3D","FFDE66","D490C5")},t.ThemeFontSchemes={Default:a("Default","Cambria","Calibri"),Office:a("Office","Calibri Light","Calibri"),Office2007:a("Office2007","Cambria","Calibri"),Apex:a("Apex","Lucida Sans","Book Antiqua"),Aspect:a("Aspect","Verdana","Verdana"),Concourse:a("Concourse","Lucida Sans Unicode","Lucida Sans Unicode"),Civic:a("Civic","Georgia","Georgia"),Oriel:a("Oriel","Century Schoolbook","Century Schoolbook"),Origin:a("Origin","Bookman Old Style","Gill Sans MT"),Paper:a("Paper","Constantia","Constantia"),Solstice:a("Solstice","Gill Sans MT","Gill Sans MT"),Technic:a("Technic","Franklin Gothic Book","Arial"),Trek:a("Trek","Franklin Gothic Medium","Franklin Gothic Book"),Urban:a("Urban","Trebuchet MS","Georgia"),Verve:a("Verve","Century Gothic","Century Gothic"),Equity:a("Equity","Franklin Gothic Book","Perpetua"),Flow:a("Flow","Calibri","Constantia"),Foundry:a("Foundry","Rockwell","Rockwell"),Median:a("Median","Tw Cen MT","Tw Cen MT"),Metro:a("Metro","Consolas","Corbel"),Module:a("Module","Corbel","Corbel"),Opulent:a("Opulent","Trebuchet MS","Trebuchet MS")},t.ThemeFmtSchemes={},["Default","Office","Office2007","Apex","Aspect","Concourse","Civic","Oriel","Origin","Paper","Solstice","Technic","Trek","Urban","Verve","Equity","Flow","Foundry","Median","Metro","Module","Opulent"].forEach(function(e){t.ThemeFmtSchemes[e]='<a:fmtScheme name="'+e+'"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:shade val="93000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme>'}),t.RelationsFile='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>'},"./src/common/common.ts":function(e,t,r){"use strict";var n,s,i,o,a,l,u,c,h,f,d,C,w,v,p,g,m,b,y,S,x,T,A,k,M;function I(e){return null==e}function E(){}function R(e,t){var r,n=t.toUpperCase(),o=h[n];return o?(r=d,o.reg&&(r=o.prefix),r+e):e}function D(){}function N(){}function F(e){var t={};return I(e.color)||(t.color=e.color),I(e.style)||(t.style=e.style),I(e.level)||(t.level=e.level),t}function _(){}function P(){}function L(r){return function(e,t){return String.fromCharCode(parseInt(t,r))}}function O(e){return e<10?"0"+e:e+""}function B(){}function j(){var e,t,r,n;try{t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},r="object"===(void 0===G?"undefined":t(G))&&G&&G.Object===Object&&G,n="object"===("undefined"==typeof self?"undefined":t(self))&&self&&self.Object===Object&&self,e=r||n||Function("return this")()}catch(e){}return e}function H(e){return Math.random().toString(16).slice(-e)}Object.defineProperty(t,"__esModule",{value:!0}),n=void 0,s="object",i="string",t.isNullOrUndefined=I,t.k=I,t.isEmptyObject=function(e){var t,r=!0;for(t in e)if(e.hasOwnProperty(t)){r=!1;break}return r},E.q=function(e){return!e||""===e},E.C=function(e){return!e||" "===e},o=E,t.StringEx=o,a=function(e,t,r,n){this.row=e,this.col=t,this.rowCount=r,this.colCount=n},t.Range=a,t.isRangeWholeRow=function(e){return-1===e.col||-1===e.colCount},t.isRangeWholeColumn=function(e){return-1===e.row||-1===e.rowCount},u=/&#(\d+);/g,c=/&#x([0-9A-F]+);/gi,h={AVERAGEIF:/\bAVERAGEIF\b\(/gi,AVERAGEIFS:/\bAVERAGEIFS\b\(/gi,CUBEKPIMEMBER:/\bCUBEKPIMEMBER\b\(/gi,CUBEMEMBER:/\bCUBEMEMBER\b\(/gi,CUBEMEMBERPROPERTY:/\bCUBEMEMBERPROPERTY\b\(/gi,CUBERANKEDMEMBER:/\bCUBERANKEDMEMBER\b\(/gi,CUBESET:/\bCUBESET\b\(/gi,CUBESETCOUNT:/\bCUBESETCOUNT\b\(/gi,CUBEVALUE:/\bCUBEVALUE\b\(/gi,COUNTIFS:/\bCOUNTIFS\b\(/gi,IFERROR:/\bIFERROR\b\(/gi,SUMIFS:/\bSUMIFS\b\(/gi,ACOT:/\bACOT\b\(/gi,ACOTH:/\bACOTH\b\(/gi,AGGREGATE:/\bAGGREGATE\b\(/gi,ARABIC:/\bARABIC\b\(/gi,BASE:/\bBASE\b\(/gi,"BETA.DIST":/\bBETA\.DIST\b\(/gi,"BETA.INV":/\bBETA\.INV\b\(/gi,"BINOM.DIST":/\bBINOM\.DIST\b\(/gi,"BINOM.DIST.RANGE":/\bBINOM\.DIST\.RANGE\b\(/gi,"BINOM.INV":/\bBINOM\.INV\b\(/gi,BITAND:/\bBITAND\b\(/gi,BITLSHIFT:/\bBITLSHIFT\b\(/gi,BITOR:/\bBITOR\b\(/gi,BITRSHIFT:/\bBITRSHIFT\b\(/gi,BITXOR:/\bBITXOR\b\(/gi,"CEILING.MATH":/\bCEILING\.MATH\b\(/gi,"CEILING.PRECISE":/\bCEILING\.PRECISE\b\(/gi,"CHISQ.DIST":/\bCHISQ\.DIST\b\(/gi,"CHISQ.DIST.RT":/\bCHISQ\.DIST\.RT\b\(/gi,"CHISQ.INV":/\bCHISQ\.INV\b\(/gi,"CHISQ.INV.RT":/\bCHISQ\.INV\.RT\b\(/gi,"CHISQ.TEST":/\bCHISQ\.TEST\b\(/gi,COMBINA:/\bCOMBINA\b\(/gi,CONCAT:/\bCONCAT\b\(/gi,"CONFIDENCE.T":/\bCONFIDENCE\.T\b\(/gi,COT:/\bCOT\b\(/gi,"COVARIANCE.P":/\bCOVARIANCE\.P\b\(/gi,"COVARIANCE.S":/\bCOVARIANCE\.S\b\(/gi,CSC:/\bCSC\b\(/gi,CSCH:/\bCSCH\b\(/gi,DAYS:/\bDAYS\b\(/gi,DECIMAL:/\bDECIMAL\b\(/gi,ENCODEURL:/\bENCODEURL\b\(/gi,"ERF.PRECISE":/\bERF\.PRECISE\b\(/gi,"ERFC.PRECISE":/\bERFC\.PRECISE\b\(/gi,"EXPON.DIST":/\bEXPON\.DIST\b\(/gi,"F.DIST":/\bF\.DIST\b\(/gi,"F.DIST.RT":/\bF\.DIST\.RT\b\(/gi,"F.INV":/\bF\.INV\b\(/gi,"F.INV.RT":/\bF\.INV\.RT\b\(/gi,FILTERXML:/\bFILTERXML\b\(/gi,"FLOOR.MATH":/\bFLOOR\.MATH\b\(/gi,"FLOOR.PRECISE":/\bFLOOR\.PRECISE\b\(/gi,FORMULATEXT:/\bFORMULATEXT\b\(/gi,GAMMA:/\bGAMMA\b\(/gi,"GAMMA.DIST":/\bGAMMA\.DIST\b\(/gi,"GAMMA.INV":/\bGAMMA\.INV\b\(/gi,"GAMMALN.PRECISE":/\bGAMMALN\.PRECISE\b\(/gi,"HYPGEOM.DIST":/\bHYPGEOM\.DIST\b\(/gi,IFNA:/\bIFNA\b\(/gi,IFS:/\bIFS\b\(/gi,IMCOSH:/\bIMCOSH\b\(/gi,IMCOT:/\bIMCOT\b\(/gi,IMCSCH:/\bIMCSCH\b\(/gi,IMSEC:/\bIMSEC\b\(/gi,IMSECH:/\bIMSECH\b\(/gi,IMSINH:/\bIMSINH\b\(/gi,IMTAN:/\bIMTAN\b\(/gi,ISFORMULA:/\bISFORMULA\b\(/gi,ISOWEEKNUM:/\bISOWEEKNUM\b\(/gi,"LOGNORM.DIST":/\bLOGNORM\.DIST\b\(/gi,"LOGNORM.INV":/\bLOGNORM\.INV\b\(/gi,MAXIFS:/\bMAXIFS\b\(/gi,MINIFS:/\bMINIFS\b\(/gi,"MODE.MULT":/\bMODE\.MULT\b\(/gi,"MODE.SNGL":/\bMODE\.SNGL\b\(/gi,MUNIT:/\bMUNIT\b\(/gi,"NEGBINOM.DIST":/\bNEGBINOM\.DIST\b\(/gi,"NORM.DIST":/\bNORM\.DIST\b\(/gi,"NORM.INV":/\bNORM\.INV\b\(/gi,"NORM.S.DIST":/\bNORM\.S\.DIST\b\(/gi,"NORM.S.INV":/\bNORM\.S\.INV\b\(/gi,NUMBERVALUE:/\bNUMBERVALUE\b\(/gi,PDURATION:/\bPDURATION\b\(/gi,"PERCENTILE.EXC":/\bPERCENTILE\.EXC\b\(/gi,"PERCENTILE.INC":/\bPERCENTILE\.INC\b\(/gi,"PERCENTRANK.EXC":/\bPERCENTRANK\.EXC\b\(/gi,"PERCENTRANK.INC":/\bPERCENTRANK\.INC\b\(/gi,PERMUTATIONA:/\bPERMUTATIONA\b\(/gi,PHI:/\bPHI\b\(/gi,"POISSON.DIST":/\bPOISSON\.DIST\b\(/gi,"QUARTILE.EXC":/\bQUARTILE\.EXC\b\(/gi,"QUARTILE.INC":/\bQUARTILE\.INC\b\(/gi,"RANK.AVG":/\bRANK\.AVG\b\(/gi,"RANK.EQ":/\bRANK\.EQ\b\(/gi,RRI:/\bRRI\b\(/gi,SECH:/\bSECH\b\(/gi,SHEET:/\bSHEET\b\(/gi,SHEETS:/\bSHEETS\b\(/gi,"STDEV.P":/\bSTDEV\.P\b\(/gi,"STDEV.S":/\bSTDEV\.S\b\(/gi,SWITCH:/\bSWITCH\b\(/gi,"T.DIST":/\bT\.DIST\b\(/gi,"T.DIST.2T":/\bT\.DIST\.2T\b\(/gi,"T.DIST.RT":/\bT\.DIST\.RT\b\(/gi,"T.INV":/\bT\.INV\b\(/gi,"T.INV.2T":/\bT\.INV\.2T\b\(/gi,TEXTJOIN:/\bTEXTJOIN\b\(/gi,UNICHAR:/\bUNICHAR\b\(/gi,UNICODE:/\bUNICODE\b\(/gi,"VAR.P":/\bVAR\.P\b\(/gi,"VAR.S":/\bVAR\.S\b\(/gi,WEBSERVICE:/\bWEBSERVICE\b\(/gi,"WEIBULL.DIST":/\bWEIBULL\.DIST\b\(/gi,XOR:/\bXOR\b\(/gi,"Z.TEST":/\bZ\.TEST\b\(/gi,XMATCH:/\bXLOOKUP\b\(/gi,XLOOKUP:/\bXLOOKUP\b\(/gi,RANDARRAY:/RANDARRAY\(/gi,SEQUENCE:/SEQUENCE\(/gi,SORTBY:/SORTBY\(/gi,UNIQUE:/UNIQUE\(/gi,ANCHORARRAY:/ANCHORARRAY\(/gi,SINGLE:/SINGLE\(/gi,LET:/\bLET\b\(/gi,FILTER:{reg:/FILTER\(/gi,prefix:l="_xlfn._xlws."},SORT:{reg:/SORT\(/gi,prefix:l}},f=/([A-Z][A-Z.]+)\(/gi,d="_xlfn.",t.addXLFNPrefix=function(e){var t,r,n;for(0===e.indexOf("@")&&(e=e.slice(1,e.length)),t=e.split('"'),r=0;r<t.length;r+=2)n=(n=t[r]).replace(/\@(.*)\,/gi,"SINGLE($1),").replace(/\@(.*)\)/gi,"SINGLE($1))"),t[r]=n.replace(f,R);return t.join('"')},t.processFunction=function(e){return e&&0<=e.toLowerCase().indexOf("_xlfn.")?e.replace(/_xlfn\.|_xlws\.|_xlpm\./gi,""):e},C=function(e){var t=e.charCodeAt(0);return 96<=(t|=32)&&t<=122},N.F=function(e){if(o.q(e))return 0;for(var t=0,r=0;r<e.length&&isNaN(parseInt(e[r],10));)r++;return r<e.length&&(t=parseInt(e.substring(r),10)),t-1},N.G=function(e){var t,r,n,o=0,i=e.length;for(t=0;t<i&&!(25<(n=(r=e[t].charCodeAt())-97))&&(n<0&&(n=r-65),!(n<0));t++)o=26*o+n+1;return--o},N.I=function(e){var t,r,n,o,i,a;if(e<0)return"";if(t=N.J[e])return t;for(r=e,o=(n="").length,e+=1;0<e;e=Math.floor((e-1)/26))i=n.substring(0,o),a=n.substring(o),n=i+String.fromCharCode(65+(e-1)%26)+a;return t=""+n,N.J[r]=t},N.K=function(e){var t;return"'"===e[0]&&"'"===e.substr(-1)||!(/^\d+$/.test(t=e)||-1<t.indexOf(" ")||-1<t.indexOf("'")||-1<t.indexOf("%")||-1<t.indexOf('"')||-1<t.indexOf("(")||-1<t.indexOf(")")||-1<t.indexOf("")||-1<t.indexOf(""))?e:"'"+e+"'"},N.J=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],w=N,t.IndexHelper=w,v=function(){var e=this;e.sharedFormulaType=0,e.index=0,e.length=0,e.column1=0,e.column2=0,e.row1=0,e.row2=0,e.firstSign=null,e.secondSign=null,e.formatString=null},D.L=function(e,t,r,n,o){var i,a,s=e.length,l=r===n?0:1,u="";for(i=t+1;i<s;i++)if((a=e.charAt(i))===r&&l++,a===n)if(l--,r===n&&i+2<s&&e.charAt(i+1)===r)u+=r,i++;else{if(0===l)return{result:u,endIndex:i};u+=a}else u+=a;if(o)throw Error()},D.O=function(e,t,r,n,o,i){var a,s,l=e.length,u=0,c="";for(a=t;a<l;a++)if((s=e.charAt(a))===o&&(c+=s,a++,s=e.charAt(a)),s===r)c+=s,u++;else if(s===n){if(0==--u)return{result:c,endIndex:a};c+=s}else c+=s;if(i)throw Error()},D.P=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d;if(e.parsedSharedFormulaStructs||D.R(e,t,r,0),e.parsedSharedFormulaStructs){if(n="",o=e.baseFormula,e.parsedSharedFormulaStructs&&0!==e.parsedSharedFormulaStructs.length)for(i=0,a=e.parsedSharedFormulaStructs.length;i<a;i++)0===(s=e.parsedSharedFormulaStructs[i]).sharedFormulaType?(l=s.column1+t,D.T<=l&&(l=s.column1),u=s.row1+r,D.U<=u&&(u=s.row1),c=(c=s.formatString.replace("{0}",w.I(l))).replace("{1}",""+u),n=n.concat(c)):1===s.sharedFormulaType?(h=s.column1+t,D.T<=h&&(h=s.column1),f=s.column2+t,D.T<=f&&(f=s.column2),c=(c=s.formatString.replace("{0}",w.I(h))).replace("{1}",w.I(f)),n=n.concat(c)):2===s.sharedFormulaType&&(u=s.row1+r,D.U<=u&&(u=s.row1),d=s.row2+r,D.U<=d&&(d=s.row2),c=(c=s.formatString.replace("{0}",""+u)).replace("{1}",""+d),n=n.concat(c));else n=o;return n}return""},D.R=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y;if(!(n>=e.baseFormula.length)){for(o=n;n<e.baseFormula.length;){if(i=!1,null!==(a=e.baseFormula.substring(n).match(D.V))?(s=!0,(l=a.index+a[0].length+n)<e.baseFormula.length&&(u=e.baseFormula[l],!C(u)&&"_"!==u&&"\\"!==u&&"?"!==u&&"."!==u&&'"'!==u&&"("!==u||(s=!1)),s&&(i=!0,e.parsedSharedFormulaStructs||(e.parsedSharedFormulaStructs=[]),c="",h=a[2],f=a[4],(d=new v).sharedFormulaType=0,d.index=a.index,d.length=a[0].length,d.column1=w.G(h),d.row1=parseInt(f,10),d.firstSign=a[1],d.secondSign=a[3],c=c.concat(e.baseFormula.substring(o,a.index+n)),p=a[0],0<d.index&&"_"===e.baseFormula[d.index+n-1]||(d.firstSign===d.secondSign&&""===d.firstSign?p=(p=p.replace(h,"{0}")).replace(f,"{1}"):"$"===d.firstSign&&""===d.secondSign?p=p.replace(f,"{1}"):"$"===d.secondSign&&""===d.firstSign&&(p=p.replace(h,"{0}"))),c=c.concat(p),d.formatString=c,e.parsedSharedFormulaStructs.push(d))):0===t?null!==(a=e.baseFormula.substring(n).match(D.W))&&(i=!0,e.parsedSharedFormulaStructs||(e.parsedSharedFormulaStructs=[]),c="",g=a[2],m=a[4],(d=new v).sharedFormulaType=2,d.index=a.index,d.length=a[0].length,d.row1=parseInt(g,10),d.row2=parseInt(m,10),d.firstSign=a[1],d.secondSign=a[3],c=c.concat(e.baseFormula.substring(o,a.index+n)),p=e.baseFormula.substring(a.index+n,a.index+n+a[0].length),c=0<d.index&&"_"===e.baseFormula[d.index+n-1]||d.firstSign!==d.secondSign||""!==d.firstSign?c.concat(p):c.concat("{0}:{1}"),d.formatString=c,e.parsedSharedFormulaStructs.push(d)):0===r&&null!==(a=e.baseFormula.substring(n).match(D.Z))&&(i=!0,e.parsedSharedFormulaStructs||(e.parsedSharedFormulaStructs=[]),c="",b=a[2],y=a[4],(d=new v).sharedFormulaType=1,d.index=a.indexOf(a[0]),d.length=a[0].length,d.column1=w.G(b),d.column2=w.G(y),d.firstSign=a[1],d.secondSign=a[3],c=c.concat(e.baseFormula.substring(o,a.index+n)),p=e.baseFormula.substring(a.index+n,a.index+n+a[0].length),c=0<d.index&&"_"===e.baseFormula[d.index+n-1]||d.firstSign!==d.secondSign||""!==d.firstSign?c.concat(p):c.concat("{0}:{1}"),d.formatString=c,e.parsedSharedFormulaStructs.push(d)),!a){(d=new v).formatString=e.baseFormula.substring(o),e.parsedSharedFormulaStructs||(e.parsedSharedFormulaStructs=[]),e.parsedSharedFormulaStructs.push(d);break}n=n+a.index+a[0].length,i&&(o=n)}return I(e.parsedSharedFormulaStructs)&&(e.parsedSharedFormulaStructs=[]),i}},D.$=function(e,t,r){return(-1===e.row||e.row<=t&&t<e.row+e.rowCount)&&(-1===e.col||e.col<=r&&r<e.col+e.colCount)},D.V=/(\$?)([A-Z]+)(\$?)(\d+)/,D.W=/(\$?)(\d+):(\$?)(\d+)/,D.Z=/(\$?)([A-Z]+):(\$?)([A-Z]+)/,D.U=1048576,D.T=16384,D._={UppercaseLetter:0,LowercaseLetter:1,DecimalDigitNumber:8,OtherNumber:10,SpaceSeparator:11,Control:14,ConnectorPunctuation:18,DashPunctuation:19,OpenPunctuation:20,ClosePunctuation:21,InitialQuotePunctuation:22,FinalQuotePunctuation:23,OtherPunctuation:24,MathSymbol:25,currencySymbol:26,ModifierSymbol:27,OtherSymbol:28},D.aa=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],t.ba=D,P.ca=function(e,t){return e&&e[t]},P.da=function(e,t){var r,n,o;if(!e)return null;for(r=0,n=e.length;r<n;r++)if((o=e[r])&&o.name===t)return e[r];return null},P.fa=function(e,t,r){var n,o;r&&(n=r.name,I(o=P.ca(t,r.name))?(e.push(r),t[n]=e.length-1):e[o]=r)},P.ga=function(e){var t;return!e||void 0===e.name&&void 0===e.parentName&&void 0===e.locked&&void 0===e.tabStop&&void 0===e.themeFont&&void 0===e.font&&void 0===e.hAlign&&void 0===e.vAlign&&void 0===e.textIndent&&void 0===e.wordWrap&&void 0===e.shrinkToFit&&void 0===e.borderLeft&&void 0===e.borderTop&&void 0===e.borderRight&&void 0===e.borderBottom&&void 0===e.diagonalUp&&void 0===e.diagonalDown&&void 0===e.backColor&&void 0===e.foreColor&&void 0===e.textDecoration&&void 0===e.isVerticalText&&void 0===e.quotePrefix&&void 0===e.textOrientation&&(typeof(t=e.formatter)!=i||"GENERAL"===t.toUpperCase())},P.ha=function(e,t,r){t&&!P.ga(t)&&(r&&e.parentName===n&&t.parentName&&(e.parentName=t.parentName),e.backColor===n&&t.backColor!==n&&(e.backColor=t.backColor),e.foreColor===n&&t.foreColor!==n&&(e.foreColor=t.foreColor),e.hAlign===n&&t.hAlign!==n&&(e.hAlign=t.hAlign),e.vAlign===n&&t.vAlign!==n&&(e.vAlign=t.vAlign),e.themeFont===n&&e.font===n?(e.themeFont=t.themeFont,e.font=t.font):e.themeFont!==n&&e.font===n&&(e.font=t.font),e.formatter===n&&t.formatter!==n&&(e.formatter=t.formatter),e.borderLeft===n&&t.borderLeft&&(e.borderLeft=F(t.borderLeft)),e.borderTop===n&&t.borderTop&&(e.borderTop=F(t.borderTop)),e.borderRight===n&&t.borderRight&&(e.borderRight=F(t.borderRight)),e.borderBottom===n&&t.borderBottom&&(e.borderBottom=F(t.borderBottom)),e.diagonalUp===n&&t.diagonalUp&&(e.diagonalUp=F(t.diagonalUp)),e.diagonalDown===n&&t.diagonalDown&&(e.diagonalDown=F(t.diagonalDown)),e.locked===n&&(e.locked=t.locked),e.textIndent===n&&t.textIndent!==n&&(e.textIndent=t.textIndent),e.wordWrap===n&&t.wordWrap!==n&&(e.wordWrap=t.wordWrap),e.shrinkToFit===n&&t.shrinkToFit!==n&&(e.shrinkToFit=t.shrinkToFit),e.textDecoration===n&&t.textDecoration!==n&&(e.textDecoration=t.textDecoration),e.textOrientation===n&&t.textOrientation!==n&&(e.textOrientation=t.textOrientation),e.quotePrefix===n&&t.quotePrefix!==n&&(e.quotePrefix=t.quotePrefix),e.isVerticalText===n&&t.isVerticalText!==n&&(e.isVerticalText=t.isVerticalText))},P.ia=function(e,t){if(!t||e.length<=0)return null;for(var r=t;r.parentName&&(r=P.da(e,r.parentName));)P.ha(t,r)},P.ka=function(e,t){if(!e&&!t)return!0;function r(e,t){return!e&&!t||!(!e||!t)&&e.color===t.color&&e.style===t.style}function n(e,t){return!e&&!t||("string"==typeof e&&"string"==typeof t?e===t:!("object"!=typeof e||!e||"object"!=typeof t||!t)&&e.formatCached===t.formatCached&&e.customerCultureName===t.customerCultureName)}return!(!e||!t)&&e.name===t.name&&e.parentName===t.parentName&&e.backColor===t.backColor&&e.foreColor===t.foreColor&&e.hAlign===t.hAlign&&e.vAlign===t.vAlign&&e.themeFont===t.themeFont&&e.font===t.font&&e.locked===t.locked&&e.textIndent===t.textIndent&&e.wordWrap===t.wordWrap&&e.shrinkToFit===t.shrinkToFit&&e.textDecoration===t.textDecoration&&e.textOrientation===t.textOrientation&&e.quotePrefix===t.quotePrefix&&n(e.formatter,t.formatter)&&n(e.autoFormatter,t.autoFormatter)&&e.isVerticalText===t.isVerticalText&&r(e.borderLeft,t.borderLeft)&&r(e.borderTop,t.borderTop)&&r(e.borderRight,t.borderRight)&&r(e.borderBottom,t.borderBottom)&&r(e.diagonalDown,t.diagonalDown)&&r(e.diagonalUp,t.diagonalUp)},t.la=P,_.ma=function(e,t){var r=0|e||0;return r<0?Math.max(r+t,0):Math.min(r,t)},_.na=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d;if(e.slice)return e.slice(t,r);if(n=e.byteLength,i=(o=_.ma)(t,n),a=n,void 0!==r&&(a=o(r,n)),s=e.constructor,a<i)return new s(0);if(l=a-i,e instanceof ArrayBuffer)return u=new ArrayBuffer(l),c=new Uint8Array(u),h=new Uint8Array(e,i,l),c.set(h),u;for(f=new s(l),d=0;d<l;d++)f[d]=e[i+d];return f},t.BufferHelper=_,p=/&/g,g=/</g,m=/>/g,b=/"/g,y=/'/g,S=/&amp;/g,x=/&gt;/g,T=/&lt;/g,A=/&quot;/g,k=/&apos;/g,M=/_x00[0-1][0-9A-Fa-f]_/,B.oa=function(e,t,r){if(!e||0===e.length)return r;if(!t)return e[0];for(var n=0,o=e.length;n<o;n++)if(t(e[n]))return e[n];return r},B.pa=function(e,t){var r,n,o;if(!e)return-1;for(r=0,n=e.length;r<n;r++)if((o=e[r]).equals&&o.equals(t)||o===t)return r;return-1},B.qa=function(e,t){var r,n,o;if(!e)return-1;for(r=0,n=e.length;r<n;r++)if(o=e[r],B.ra(o,t)||o===t)return r;return-1},B.ra=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},B.sa=function(e){return typeof e==i?e.replace(p,"&amp;").replace(g,"&lt;").replace(m,"&gt;").replace(b,"&quot;").replace(y,"&apos;"):I(e)?e:""+e},B.ta=function(e){return typeof e==i?(-1!==e.indexOf("&#")&&(e=e.replace(u,L(10)).replace(c,L(16))),e.replace(S,"&").replace(x,">").replace(T,"<").replace(A,'"').replace(k,"'")):I(e)?e:""+e},B.ua=function(e,t){var r,n=e.split("/"),o=t.split("/");for(n.pop();0<o.length;)if(".."===(r=o[0]))o.shift(),n.pop();else{if("."!==r)break;o.shift()}return n.concat(o).join("/")},B.va=function(e){var t,r,n;return o.q(e)||(r=(n=e.split("/")).pop(),t=n.join("/")),{dir:t||"",fileName:r||""}},B.wa=function(e,t,r){var n,o,i;function a(e,t){if(!e&&!t)return 1;if(e&&t&&e.length===t.length){for(var r=0;r<e.length;r++)if(typeof e[r]==s){if(typeof t[r]!=s)return;if(!B.wa(e[r],t[r]))return}else if(Array.isArray(e[r])){if(!Array.isArray(t[r]))return;if(!a(e[r],t[r]))return}else if(e[r]!==t[r])return;return 1}}if(!e&&!t)return!0;if(!e||!t)return!1;if(r=r||B.wa,Object.getOwnPropertyNames(e).length!==Object.getOwnPropertyNames(t).length)return!1;for(o in n={},e)if(e.hasOwnProperty(o)){if(i=e[o],Array.isArray(i)){if(!a(i,t[o]))return!1}else if(typeof i==s){if(!r(i,t[o]))return!1}else if(i!==t[o])return!1;n[o]=!0}for(o in t)if(t.hasOwnProperty(o)&&!n[o])return!1;return!0},B.xa=function(e,t,r){var n,o;if(e&&typeof e==i)for(n=0;n<r.length;n++)if((o=r[n])!==t&&(-1<e.indexOf(o+"!")||-1<e.indexOf("'"+o+"'!")))return!0;return!1},B.ya=function(e,t,r){return e.split(t).join(r)},B.za=function(){return"{xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx}".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},B.Aa=function(e){return I(e)||null===e.match(M)?e:e.replace(/(_x005[fF])?_x00([0-1][0-9A-Fa-f])_/g,function(e,t,r){var n=0;return r&&(n=parseInt(r,16)),t?"_x00"+r+"_":String.fromCharCode(n)}).replace(/(\r)+\n/g,"\r\n")},B.Ba=function(e,t){var r,n,o,i,a,s;if(I(e)||""===e)return e;for(null!==e.match(M)&&(r=/(_x00[0-1][0-9A-Fa-f]_)/g,e=e.replace(r,function(e){return"_x005F"+e})),n=["_x0000_","_x0001_","_x0002_","_x0003_","_x0004_","_x0005_","_x0006_","_x0007_","_x0008_","_x0009_","_x000A_","_x000B_","_x000C_","_x000D_","_x000E_","_x000F_","_x0010_","_x0011_","_x0012_","_x0013_","_x0014_","_x0015_","_x0016_","_x0017_","_x0018_","_x0019_","_x001A_","_x001B_","_x001C_","_x001D_","_x001E_","_x001F_"],o=[],i=0;i<e.length;i++)a=e.charCodeAt(i),s=e[i],31<a||10===a&&t?o.push(s):o.push(n[a]);return o.join("")},B.Ca=function(e){var t=e&&e.Choice,r=t&&t.GraphicalObjectFrame,n=r&&r.graphic,o=n&&n.graphicData;return!(!o||!o.chart)},B.Da=function(e){var t=e.chartSpace,r=t&&t.chart.plotArea,n=r&&r.plotAreaRegion;return n&&n.series[0]},B.Ea=function(e){return 16===e||17===e||18===e||19===e||20===e||21===e||22===e||23===e},B.Fa=function(e){return e.getUTCFullYear()+"-"+O(e.getUTCMonth()+1)+"-"+O(e.getUTCDate())+"T"+O(e.getUTCHours())+":"+O(e.getUTCMinutes())+":"+O(e.getUTCSeconds())},t.Util=B,t.Ga=function(){return{colHeaderRowHeight:20,rowHeaderColWidth:40,rowHeight:20,colWidth:62}},t.Ha=j,t.Ia=function(){var e=j();return e&&e.gcCultureInfo},t.Ja=function(){return("{"+H(8)+"-"+H(4)+"-"+H(4)+"-"+H(4)+"-"+H(12)+"}").toUpperCase()},t.Ka=function e(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||I(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var r,n,o;for(n in r=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(n)&&(o=t[n],t.hasOwnProperty(n)&&r[n]!==o&&(r[n]="object"==typeof o?e(o):o));return r.toString=t.toString,r.valueOf=t.valueOf,r}},"./src/common/excel-types.ts":function(e,r,t){"use strict";var s,l,n,o,i,a,u,c,h,f,d,p,g,m,b,y,C;function w(e,t){this.fileName=e,this.fileType=t,this.relationFiles={count:0}}Object.defineProperty(r,"__esModule",{value:!0}),s=t("./src/common/common.ts"),l=t("./src/xml-io/xml-parser.ts"),(C=r.PaneType||(r.PaneType={}))[C.bottomRight=0]="bottomRight",C[C.topRight=1]="topRight",C[C.bottomLeft=2]="bottomLeft",C[C.topLeft=3]="topLeft",r.RelationshipConstants={La:"rId",Ma:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Na:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Oa:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",Pa:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Qa:"http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument",Ra:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Sa:"http://purl.oclc.org/ooxml/officeDocument/relationships/styles",Ta:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Ua:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Va:"http://purl.oclc.org/ooxml/officeDocument/relationships/sharedStrings",Wa:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Xa:"http://purl.oclc.org/ooxml/officeDocument/relationships/theme",Ya:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition",Za:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords",$a:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable",_a:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",ab:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",bb:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",cb:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",eb:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",fb:"http://purl.oclc.org/ooxml/officeDocument/relationships/drawing",gb:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",hb:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",ib:"http://purl.oclc.org/ooxml/officeDocument/relationships/image",jb:"http://schemas.microsoft.com/office/2007/relationships/slicer",kb:"http://schemas.microsoft.com/office/2007/relationships/slicerCache",lb:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",mb:"http://schemas.microsoft.com/office/2014/relationships/chartEx",nb:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes",ob:"http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",pb:"http://schemas.microsoft.com/office/2011/relationships/chartStyle",qb:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata"},r.ExcelConstants={rb:16384,sb:1048576},r.DefaultSize={tb:20,ub:40,vb:62,wb:20},r.MaxDigitWidthMap={8:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":6,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:4,"Arabic Typesetting":4,Arial:6,"Arial Black":7,"Arial Narrow":5,"Arial Nova":6,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":6,"Arial Rounded MT Bold":7,"Baskerville Old Face":5,Batang:6,BatangChe:6,"Bauhaus 93":6,"Bell MT":6,Bembo:5,"Berlin Sans FB":7,"Berlin Sans FB Demi":7,"Bernard MT Condensed":5,"Blackadder ITC":4,"Bodoni MT":5,"Bodoni MT Black":7,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":8,"Bradley Hand ITC":7,"Britannic Bold":7,Broadway:7,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":5,"Calisto MT":6,Cambria:6,"Cambria Math":6,Candara:6,Castellar:8,Centaur:5,Century:6,"Century Gothic":6,"Century Schoolbook":6,Chiller:5,"Colonna MT":6,"Comic Sans MS":7,Consolas:6,Constantia:6,"Cooper Black":7,"Copperplate Gothic Bold":8,"Copperplate Gothic Light":8,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:3,DokChampa:6,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":5,Elephant:8,"Engravers MT":7,"Eras Bold ITC":7,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":6,EucrosiaUPC:4,Euphemia:6,"Expo M":10,FangSong:6,"Felix Titling":6,"Footlight MT Light":6,Forte:6,"Franklin Gothic Book":6,"Franklin Gothic Demi":6,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":6,"Franklin Gothic Medium":6,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":4,"French Script MT":4,Gabriola:4,Gadugi:6,Garamond:5,Gautami:7,Georgia:8,"Georgia Pro":6,"Georgia Pro Black":8,"Georgia Pro Cond":6,"Georgia Pro Cond Black":7,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":6,"Georgia Pro Light":6,"Georgia Pro Semibold":7,Gigi:5,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":3,"Gill Sans Nova Cond Ultra Bold":6,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":9,"Gill Sans Ultra Bold":9,"Gill Sans Ultra Bold Condensed":6,Gisha:6,"Gloucester MT Extra Condensed":4,"Goudy Old Style":6,"Goudy Stout":9,Grotesque:5,"Grotesque Light":5,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":6,Haettenschweiler:5,"Harlow Solid Italic":5,Harrington:6,"Headline R":8,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:8,HGMinchoB:7,HGMinchoE:7,HGPGothicE:7,HGPGothicM:7,HGPGyoshotai:6,HGPKyokashotai:6,HGPMinchoB:6,HGPMinchoE:7,HGPSoeiKakugothicUB:8,HGPSoeiKakupoptai:8,HGPSoeiPresenceEB:7,HGSeikaishotaiPRO:7,HGSGothicE:6,HGSGothicM:6,HGSGyoshotai:5,HGSKyokashotai:5,HGSMinchoB:6,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:7,HGSSoeiKakupoptai:7,HGSSoeiPresenceEB:6,"High Tower Text":5,"HYGothic-Extra":7,"HYGothic-Medium":6,"HYGraphic-Medium":6,"HYGungSo-Bold":6,"HYHeadLine-Medium":6,"HYMyeongJo-Extra":7,"HYPMokGak-Bold":8,"HYPost-Light":7,"HYPost-Medium":8,"HYShortSamul-Medium":4,"HYSinMyeongJo-Medium":7,Impact:6,"Imprint MT Shadow":6,"Informal Roman":6,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":6,Jokerman:8,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":6,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":7,"Lucida Console":8,"Lucida Fax":7,"Lucida Handwriting":8,"Lucida Sans":7,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":8,"Magic R":7,Magneto:8,"Maiandra GD":7,"Malgun Gothic":6,"Malgun Gothic Semilight":7,Mangal:7,Marlett:12,"Matura MT Script Capitals":8,Meiryo:7,"Meiryo UI":7,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":7,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":7,"Microsoft New Tai Lue":6,"Microsoft PhagsPa":6,"Microsoft Sans Serif":7,"Microsoft Tai Le":6,"Microsoft Uighur":4,"Microsoft YaHei Light":7,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":7,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":7,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":7,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":8,"MS Reference Specialty":14,"MS UI Gothic":7,"MT Extra":12,"MV Boli":9,"Myanmar Text":6,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":7,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":6,"Nirmala UI Semilight":7,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":4,"Palatino Linotype":6,Papyrus:7,Parchment:3,Perpetua:5,"Perpetua Titling MT":7,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:6,"PMingLiU-ExtB":6,"Poor Richard":7,Pristina:6,"Pyunji R":6,Raavi:7,"Rage Italic":7,Ravie:11,Rockwell:6,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":4,"Segoe Print":8,"Segoe Script":8,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":6,"Segoe UI Semilight":6,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":6,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":6,"Sitka Small":8,"Sitka Subheading":6,"Sitka Text":7,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:6,Sylfaen:6,Symbol:6,Tahoma:6,"Tempus Sans ITC":7,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":6,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":5,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:7,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":7,Vivaldi:5,"Vladimir Script":5,Vrinda:6,Webdings:11,"Wide Latin":14,Wingdings:15,"Wingdings 2":12,"Wingdings 3":10,"Yet R":6,"Yu Gothic":6,"Yu Gothic Light":6,"Yu Gothic Medium":6,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":6,"Yu Gothic UI Semilight":6,"Yu Mincho":6,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"":6,"":7,"":5,"":5,"":6,"":6,"":5,"":6,"":6,"":6,"":5,"":6,"":6,"":6," Light":6,"":6,"":6,"":6,"":6,"":6," Light":6,"":6,"":6,"":6," ":6," ":6,"":7,"HGE":6,"HGB":6,"HGM":6},9:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":8,"Arial Narrow":5,"Arial Nova":7,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":7,"Arial Rounded MT Bold":7,"Baskerville Old Face":6,Batang:6,BatangChe:6,"Bauhaus 93":7,"Bell MT":6,Bembo:6,"Berlin Sans FB":7,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":8,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":9,"Bradley Hand ITC":8,"Britannic Bold":7,Broadway:8,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":7,"Calisto MT":6,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":6,"Comic Sans MS":7,Consolas:7,Constantia:7,"Cooper Black":7,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":6,Elephant:9,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:7,"Expo M":10,FangSong:6,"Felix Titling":7,"Footlight MT Light":7,Forte:6,"Franklin Gothic Book":7,"Franklin Gothic Demi":7,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":7,"Franklin Gothic Medium":7,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":5,"French Script MT":4,Gabriola:5,Gadugi:6,Garamond:6,Gautami:7,Georgia:8,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":6,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":7,Gigi:7,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":7,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":10,"Gill Sans Ultra Bold":10,"Gill Sans Ultra Bold Condensed":7,Gisha:6,"Gloucester MT Extra Condensed":5,"Goudy Old Style":6,"Goudy Stout":10,Grotesque:6,"Grotesque Light":6,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":7,Haettenschweiler:5,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:9,HGMinchoB:7,HGMinchoE:7,HGPGothicE:8,HGPGothicM:8,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:7,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:7,HGSGothicE:7,HGSGothicM:7,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":7,"HYGraphic-Medium":7,"HYGungSo-Bold":7,"HYHeadLine-Medium":7,"HYMyeongJo-Extra":8,"HYPMokGak-Bold":9,"HYPost-Light":8,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":6,"Informal Roman":7,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":7,Jokerman:9,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":7,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":9,"Lucida Console":8,"Lucida Fax":8,"Lucida Handwriting":9,"Lucida Sans":8,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":9,"Magic R":8,Magneto:9,"Maiandra GD":8,"Malgun Gothic":7,"Malgun Gothic Semilight":8,Mangal:7,Marlett:13,"Matura MT Script Capitals":9,Meiryo:8,"Meiryo UI":8,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":8,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":7,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":9,"MS Reference Specialty":15,"MS UI Gothic":7,"MT Extra":13,"MV Boli":9,"Myanmar Text":7,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":8,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":5,"Palatino Linotype":6,Papyrus:8,Parchment:4,Perpetua:6,"Perpetua Titling MT":8,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:6,"Pyunji R":7,Raavi:7,"Rage Italic":7,Ravie:12,Rockwell:7,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":5,"Segoe Print":9,"Segoe Script":9,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":8,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":7,"Sitka Small":8,"Sitka Subheading":7,"Sitka Text":8,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:7,Sylfaen:6,Symbol:6,Tahoma:7,"Tempus Sans ITC":8,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":7,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:8,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":8,Vivaldi:5,"Vladimir Script":6,Vrinda:6,Webdings:12,"Wide Latin":15,Wingdings:16,"Wingdings 2":14,"Wingdings 3":11,"Yet R":6,"Yu Gothic":7,"Yu Gothic Light":6,"Yu Gothic Medium":7,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"":6,"":7,"":6,"":6,"":7,"":7,"":6,"":7,"":7,"":6,"":5,"":6,"":6,"":7," Light":7,"":6,"":6,"":7,"":6,"":6," Light":6,"":6,"":6,"":7," ":6," ":6,"":7,"HGE":6,"HGB":6,"HGM":6},10:{"Gill Sans MT":7,Abadi:8,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:8,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":9,"Arial Narrow":6,"Arial Nova":7,"Arial Nova Cond":7,"Arial Nova Cond Light":6,"Arial Nova Light":7,"Arial Rounded MT Bold":8,"Baskerville Old Face":6,Batang:7,BatangChe:7,"Bauhaus 93":7,"Bell MT":7,Bembo:6,"Berlin Sans FB":8,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":9,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":5,"Book Antiqua":7,"Bookman Old Style":8,"Bookshelf Symbol 7":10,"Bradley Hand ITC":8,"Britannic Bold":8,Broadway:8,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":7,Calibri:7,"Calibri Light":7,"Californian FB":7,"Calisto MT":7,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":7,"Comic Sans MS":8,Consolas:7,Constantia:7,"Cooper Black":8,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:7,"Cordia New":5,CordiaUPC:5,"Courier New":8,"Curlz MT":7,Dante:6,DaunPenh:4,David:6,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:7,Dubai:7,"Dubai Light":7,"Dubai Medium":7,Ebrima:7,"Edwardian Script ITC":6,Elephant:10,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":8,"Eras Light ITC":7,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:8,"Expo M":11,FangSong:7,"Felix Titling":8,"Footlight MT Light":7,Forte:7,"Franklin Gothic Book":8,"Franklin Gothic Demi":8,"Franklin Gothic Demi Cond":7,"Franklin Gothic Heavy":8,"Franklin Gothic Medium":8,"Franklin Gothic Medium Cond":7,FrankRuehl:5,FreesiaUPC:6,"Freestyle Script":5,"French Script MT":5,Gabriola:5,Gadugi:7,Garamond:6,Gautami:8,Georgia:9,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":7,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":7,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":8,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":7,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":8,"Gill Sans Nova Cond XBd":7,"Gill Sans Nova Light":7,"Gill Sans Nova Ultra Bold":11,"Gill Sans Ultra Bold":11,"Gill Sans Ultra Bold Condensed":8,Gisha:7,"Gloucester MT Extra Condensed":5,"Goudy Old Style":7,"Goudy Stout":11,Grotesque:6,"Grotesque Light":6,Gulim:7,GulimChe:7,Gungsuh:6,GungsuhChe:7,"Hadassah Friedlaender":7,Haettenschweiler:6,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:7,HGGothicM:7,HGGyoshotai:7,HGKyokashotai:7,HGMaruGothicMPRO:10,HGMinchoB:8,HGMinchoE:8,HGPGothicE:8,HGPGothicM:9,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:8,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:8,HGSGothicE:7,HGSGothicM:8,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:8,HGSoeiKakugothicUB:8,HGSoeiKakupoptai:8,HGSoeiPresenceEB:8,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":8,"HYGraphic-Medium":8,"HYGungSo-Bold":8,"HYHeadLine-Medium":8,"HYMyeongJo-Extra":9,"HYPMokGak-Bold":9,"HYPost-Light":9,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":7,"Informal Roman":7,"Ink Free":7,IrisUPC:7,"Iskoola Pota":7,JasmineUPC:7,"Javanese Text":8,Jokerman:9,"Juice ITC":5,KaiTi:7,Kalinga:7,Kartika:7,"Khmer UI":7,KodchiangUPC:4,Kokila:7,"Kristen ITC":8,"Kunstler Script":5,"Lao UI":7,Latha:7,Leelawadee:7,"Leelawadee UI":7,"Leelawadee UI Semilight":7,"Levenim MT":7,LilyUPC:7,"Lucida Bright":8,"Lucida Calligraphy":10,"Lucida Console":9,"Lucida Fax":9,"Lucida Handwriting":10,"Lucida Sans":9,"Lucida Sans Typewriter":8,"Lucida Sans Unicode":9,"Magic R":8,Magneto:10,"Maiandra GD":9,"Malgun Gothic":8,"Malgun Gothic Semilight":8,Mangal:8,Marlett:14,"Matura MT Script Capitals":10,Meiryo:9,"Meiryo UI":9,"Microsoft GothicNeo":8,"Microsoft Himalaya":5,"Microsoft JhengHei":8,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":8,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":8,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":8,MingLiU:8,MingLiU_HKSCS:8,"MingLiU_HKSCS-ExtB":8,"MingLiU-ExtB":8,Miriam:8,"Miriam Fixed":8,Mistral:7,"Modern No. 20":7,"MoeumT R":8,"Mongolian Baiti":8,"Monotype Corsiva":7,MoolBoran:8,"MS Gothic":8,"MS Mincho":8,"MS Outlook":8,"MS PGothic":8,"MS PMincho":8,"MS Reference Sans Serif":9,"MS Reference Specialty":17,"MS UI Gothic":8,"MT Extra":14,"MV Boli":10,"Myanmar Text":7,Narkisim:8,"Neue Haas Grotesk Text Pro":8,"New Gulim":8,"News Gothic MT":8,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:8,"OCR A Extended":9,OCRB:9,"Old English Text MT":8,Onyx:6,"Palace Script MT":5,"Palatino Linotype":7,Papyrus:9,Parchment:4,Perpetua:6,"Perpetua Titling MT":9,"Plantagenet Cherokee":8,Playbill:6,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:8,"Pyunji R":7,Raavi:8,"Rage Italic":8,Ravie:13,Rockwell:7,"Rockwell Condensed":6,"Rockwell Extra Bold":9,"Rockwell Light":8,"Rockwell Nova":8,"Rockwell Nova Cond":8,"Rockwell Nova Cond Light":8,"Rockwell Nova Extra Bold":8,"Rockwell Nova Light":8,Rod:8,"Sakkal Majalla":8,"Sanskrit Text":8,"Script MT Bold":7,"Segoe MDL2 Assets":5,"Segoe Print":10,"Segoe Script":10,"Segoe UI":7,"Segoe UI Black":8,"Segoe UI Emoji":7,"Segoe UI Historic":7,"Segoe UI Light":7,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":7,Selawik:7,"Selawik Light":7,"Selawik Semibold":7,"Shonar Bangla":7,"Showcard Gothic":8,Shruti:7,"Simplified Arabic":7,"Simplified Arabic Fixed":7,"SimSun-ExtB":7,"Sitka Banner":7,"Sitka Display":7,"Sitka Heading":7,"Sitka Small":9,"Sitka Subheading":8,"Sitka Text":8,"Snap ITC":11,"Source Sans Pro":7,"Source Sans Pro Black":7,"Source Sans Pro ExtraLight":7,"Source Sans Pro Light":7,"Source Sans Pro SemiBold":7,Stencil:7,Sylfaen:7,Symbol:7,Tahoma:7,"Tempus Sans ITC":9,"TH SarabunPSK":7,"Times New Roman":7,"Traditional Arabic":7,"Trebuchet MS":7,Tunga:7,"Tw Cen MT":7,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":7,"UD Digi Kyokasho NK-B":7,"UD Digi Kyokasho NK-R":7,"UD Digi Kyokasho NP-B":7,"UD Digi Kyokasho NP-R":7,"UD Digi Kyokasho N-R":7,Univers:7,"Univers Condensed":7,"Univers Condensed Light":7,"Univers Light":7,"Urdu Typesetting":7,Utsaah:7,Vani:7,Verdana:8,"Verdana Pro":8,"Verdana Pro Black":7,"Verdana Pro Cond":7,"Verdana Pro Cond Black":7,"Verdana Pro Cond Light":7,"Verdana Pro Cond SemiBold":7,"Verdana Pro Light":7,"Verdana Pro SemiBold":7,Vijaya:7,"Viner Hand ITC":9,Vivaldi:6,"Vladimir Script":6,Vrinda:7,Webdings:13,"Wide Latin":16,Wingdings:17,"Wingdings 2":15,"Wingdings 3":12,"Yet R":7,"Yu Gothic":7,"Yu Gothic Light":7,"Yu Gothic Medium":7,"Yu Gothic UI":7,"Yu Gothic UI Light":7,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":7,"Yu Mincho Light":7,"":7,"":8,"":6,"":6,"":7,"":8,"":6,"":7,"":7,"":7,"":6,"":7,"":7,"":8," Light":7,"":7,"":7,"":7,"":7,"":7," Light":7,"":7,"":7,"":7," ":7," ":7,"":8,"HGE":7,"HGB":7,"HGM":7},11:{"Gill Sans MT":8,Abadi:9,"Abadi Extra Light":8,"Agency FB":6,Aharoni:6,Aldhabi:5,Algerian:9,"Ami R":6,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:8,"Arial Black":10,"Arial Narrow":7,"Arial Nova":8,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":8,"Arial Rounded MT Bold":9,"Baskerville Old Face":7,Batang:8,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:7,"Berlin Sans FB":9,"Berlin Sans FB Demi":9,"Bernard MT Condensed":7,"Blackadder ITC":6,"Bodoni MT":7,"Bodoni MT Black":10,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":5,"Book Antiqua":8,"Bookman Old Style":9,"Bookshelf Symbol 7":11,"Bradley Hand ITC":10,"Britannic Bold":9,Broadway:10,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":8,Calibri:7,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:8,"Cambria Math":8,Candara:8,Castellar:11,Centaur:7,Century:8,"Century Gothic":8,"Century Schoolbook":8,Chiller:7,"Colonna MT":8,"Comic Sans MS":9,Consolas:8,Constantia:8,"Cooper Black":9,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":11,Corbel:8,"Cordia New":5,CordiaUPC:5,"Courier New":9,"Curlz MT":8,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:8,Dotum:9,DotumChe:8,Dubai:8,"Dubai Light":8,"Dubai Medium":8,Ebrima:8,"Edwardian Script ITC":7,Elephant:11,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":9,"Eras Light ITC":8,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":13,FangSong:8,"Felix Titling":9,"Footlight MT Light":8,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:6,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":5,Gabriola:6,Gadugi:8,Garamond:7,Gautami:9,Georgia:9,"Georgia Pro":8,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":8,"Georgia Pro Light":8,"Georgia Pro Semibold":9,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":5,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":13,"Gill Sans Ultra Bold":13,"Gill Sans Ultra Bold Condensed":9,Gisha:8,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":12,Grotesque:7,"Grotesque Light":7,Gulim:8,GulimChe:8,Gungsuh:7,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:8,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:11,HGMinchoB:9,HGMinchoE:9,HGPGothicE:9,HGPGothicM:10,HGPGyoshotai:8,HGPKyokashotai:8,HGPMinchoB:8,HGPMinchoE:9,HGPSoeiKakugothicUB:10,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:9,HGSeikaishotaiPRO:9,HGSGothicE:8,HGSGothicM:9,HGSGyoshotai:7,HGSKyokashotai:7,HGSMinchoB:8,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:9,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:8,"High Tower Text":7,"HYGothic-Extra":9,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":10,"HYPMokGak-Bold":11,"HYPost-Light":10,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":9,Impact:8,"Imprint MT Shadow":8,"Informal Roman":8,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:8,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":9,"Kunstler Script":5,"Lao UI":8,Latha:8,Leelawadee:8,"Leelawadee UI":8,"Leelawadee UI Semilight":8,"Levenim MT":9,LilyUPC:8,"Lucida Bright":9,"Lucida Calligraphy":11,"Lucida Console":10,"Lucida Fax":10,"Lucida Handwriting":11,"Lucida Sans":10,"Lucida Sans Typewriter":9,"Lucida Sans Unicode":10,"Magic R":9,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":9,Mangal:9,Marlett:16,"Matura MT Script Capitals":11,Meiryo:10,"Meiryo UI":10,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":9,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":9,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":9,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":9,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":10,Mistral:8,"Modern No. 20":8,"MoeumT R":9,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:9,"MS Gothic":9,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":19,"MS UI Gothic":9,"MT Extra":16,"MV Boli":12,"Myanmar Text":9,Narkisim:7,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":5,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":9,Nyala:9,"OCR A Extended":10,OCRB:10,"Old English Text MT":9,Onyx:6,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":10,"Plantagenet Cherokee":9,Playbill:6,PMingLiU:8,"PMingLiU-ExtB":8,"Poor Richard":9,Pristina:9,"Pyunji R":8,Raavi:9,"Rage Italic":9,Ravie:15,Rockwell:8,"Rockwell Condensed":6,"Rockwell Extra Bold":10,"Rockwell Light":9,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":6,"Segoe Print":11,"Segoe Script":11,"Segoe UI":8,"Segoe UI Black":9,"Segoe UI Emoji":8,"Segoe UI Historic":8,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":8,"Segoe UI Symbol":8,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":8,"Sitka Small":10,"Sitka Subheading":9,"Sitka Text":9,"Snap ITC":13,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:8,"Tempus Sans ITC":10,"TH SarabunPSK":8,"Times New Roman":8,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":8,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":7,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:8,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":10,Vivaldi:6,"Vladimir Script":7,Vrinda:9,Webdings:15,"Wide Latin":19,Wingdings:20,"Wingdings 2":17,"Wingdings 3":13,"Yet R":8,"Yu Gothic":8,"Yu Gothic Light":8,"Yu Gothic Medium":8,"Yu Gothic UI":8,"Yu Gothic UI Light":8,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":8,"Yu Mincho":8,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"":8,"":9,"":7,"":7,"":9,"":9,"":7,"":9,"":8,"":8,"":7,"":8,"":8,"":9," Light":9,"":8,"":8,"":8,"":8,"":8," Light":8,"":8,"":8,"":8," ":8," ":8,"":9,"HGE":8,"HGB":8,"HGM":8},12:{"Gill Sans MT":8,Abadi:10,"Abadi Extra Light":9,"Agency FB":6,Aharoni:7,Aldhabi:5,Algerian:10,"Ami R":7,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:9,"Arial Black":11,"Arial Narrow":7,"Arial Nova":9,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":9,"Arial Rounded MT Bold":10,"Baskerville Old Face":8,Batang:9,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:8,"Berlin Sans FB":10,"Berlin Sans FB Demi":10,"Bernard MT Condensed":8,"Blackadder ITC":6,"Bodoni MT":8,"Bodoni MT Black":11,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":6,"Book Antiqua":8,"Bookman Old Style":10,"Bookshelf Symbol 7":12,"Bradley Hand ITC":10,"Britannic Bold":10,Broadway:10,"Browallia New":6,BrowalliaUPC:6,"Brush Script MT":8,Calibri:8,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:9,"Cambria Math":9,Candara:9,Castellar:12,Centaur:8,Century:9,"Century Gothic":9,"Century Schoolbook":9,Chiller:8,"Colonna MT":8,"Comic Sans MS":10,Consolas:9,Constantia:9,"Cooper Black":10,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":12,Corbel:8,"Cordia New":6,CordiaUPC:6,"Courier New":10,"Curlz MT":9,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:9,Dotum:8,DotumChe:8,Dubai:9,"Dubai Light":9,"Dubai Medium":9,Ebrima:9,"Edwardian Script ITC":8,Elephant:12,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":10,"Eras Light ITC":9,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":14,FangSong:8,"Felix Titling":9,"Footlight MT Light":9,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:7,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":6,Gabriola:6,Gadugi:9,Garamond:8,Gautami:10,Georgia:10,"Georgia Pro":9,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":9,"Georgia Pro Light":9,"Georgia Pro Semibold":10,Gigi:7,"Gill Sans MT Condensed":6,"Gill Sans MT Ext Condensed Bold":6,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":14,"Gill Sans Ultra Bold":14,"Gill Sans Ultra Bold Condensed":9,Gisha:9,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":13,Grotesque:8,"Grotesque Light":8,Gulim:9,GulimChe:8,Gungsuh:9,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:9,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:12,HGMinchoB:9,HGMinchoE:9,HGPGothicE:10,HGPGothicM:10,HGPGyoshotai:9,HGPKyokashotai:8,HGPMinchoB:9,HGPMinchoE:9,HGPSoeiKakugothicUB:11,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:10,HGSeikaishotaiPRO:10,HGSGothicE:9,HGSGothicM:9,HGSGyoshotai:8,HGSKyokashotai:7,HGSMinchoB:9,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:10,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:9,"High Tower Text":8,"HYGothic-Extra":10,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":11,"HYPMokGak-Bold":11,"HYPost-Light":11,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":10,Impact:9,"Imprint MT Shadow":8,"Informal Roman":9,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:9,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":10,"Kunstler Script":6,"Lao UI":8,Latha:8,Leelawadee:9,"Leelawadee UI":9,"Leelawadee UI Semilight":9,"Levenim MT":9,LilyUPC:7,"Lucida Bright":10,"Lucida Calligraphy":12,"Lucida Console":11,"Lucida Fax":11,"Lucida Handwriting":12,"Lucida Sans":11,"Lucida Sans Typewriter":10,"Lucida Sans Unicode":11,"Magic R":10,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":10,Mangal:9,Marlett:17,"Matura MT Script Capitals":12,Meiryo:11,"Meiryo UI":11,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":10,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":10,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":10,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":10,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":11,Mistral:8,"Modern No. 20":8,"MoeumT R":10,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:7,"MS Gothic":9,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":20,"MS UI Gothic":9,"MT Extra":17,"MV Boli":12,"Myanmar Text":9,Narkisim:8,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":6,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":10,Nyala:9,"OCR A Extended":11,OCRB:11,"Old English Text MT":9,Onyx:7,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":11,"Plantagenet Cherokee":9,Playbill:7,PMingLiU:9,"PMingLiU-ExtB":9,"Poor Richard":10,Pristina:9,"Pyunji R":9,Raavi:8,"Rage Italic":9,Ravie:16,Rockwell:9,"Rockwell Condensed":7,"Rockwell Extra Bold":11,"Rockwell Light":10,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":7,"Segoe Print":12,"Segoe Script":12,"Segoe UI":9,"Segoe UI Black":10,"Segoe UI Emoji":9,"Segoe UI Historic":9,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":9,"Segoe UI Symbol":9,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":9,"Sitka Small":11,"Sitka Subheading":9,"Sitka Text":10,"Snap ITC":14,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:9,"Tempus Sans ITC":11,"TH SarabunPSK":8,"Times New Roman":8,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":9,"Tw Cen MT Condensed":6,"Tw Cen MT Condensed Extra Bold":8,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:6,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":11,Vivaldi:7,"Vladimir Script":7,Vrinda:9,Webdings:16,"Wide Latin":20,Wingdings:22,"Wingdings 2":18,"Wingdings 3":14,"Yet R":9,"Yu Gothic":9,"Yu Gothic Light":9,"Yu Gothic Medium":9,"Yu Gothic UI":9,"Yu Gothic UI Light":9,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":9,"Yu Mincho":9,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"":8,"":10,"":8,"":8,"":9,"":9,"":8,"":9,"":9,"":8,"":7,"":8,"":8,"":9," Light":9,"":8,"":8,"":9,"":8,"":8," Light":8,"":8,"":8,"":9," ":8," ":8,"":10,"HGE":8,"HGB":8,"HGM":8},14:{"Gill Sans MT":10,Abadi:11,"Abadi Extra Light":11,"Agency FB":8,Aharoni:8,Aldhabi:6,Algerian:11,"Ami R":8,"Angsana New":6,AngsanaUPC:6,Aparajita:8,"Arabic Typesetting":6,Arial:11,"Arial Black":13,"Arial Narrow":9,"Arial Nova":11,"Arial Nova Cond":10,"Arial Nova Cond Light":9,"Arial Nova Light":11,"Arial Rounded MT Bold":11,"Baskerville Old Face":9,Batang:10,BatangChe:10,"Bauhaus 93":11,"Bell MT":10,Bembo:9,"Berlin Sans FB":11,"Berlin Sans FB Demi":12,"Bernard MT Condensed":9,"Blackadder ITC":8,"Bodoni MT":9,"Bodoni MT Black":12,"Bodoni MT Condensed":6,"Bodoni MT Poster Compressed":6,"Book Antiqua":10,"Bookman Old Style":12,"Bookshelf Symbol 7":14,"Bradley Hand ITC":12,"Britannic Bold":12,Broadway:12,"Browallia New":7,BrowalliaUPC:7,"Brush Script MT":10,Calibri:10,"Calibri Light":10,"Californian FB":11,"Calisto MT":10,Cambria:11,"Cambria Math":11,Candara:10,Castellar:14,Centaur:9,Century:11,"Century Gothic":11,"Century Schoolbook":11,Chiller:9,"Colonna MT":10,"Comic Sans MS":12,Consolas:10,Constantia:10,"Cooper Black":11,"Copperplate Gothic Bold":14,"Copperplate Gothic Light":14,Corbel:10,"Cordia New":7,CordiaUPC:7,"Courier New":11,"Curlz MT":10,Dante:9,DaunPenh:6,David:8,DilleniaUPC:6,DokChampa:11,Dotum:10,DotumChe:10,Dubai:10,"Dubai Light":10,"Dubai Medium":10,Ebrima:10,"Edwardian Script ITC":9,Elephant:14,"Engravers MT":12,"Eras Bold ITC":12,"Eras Demi ITC":12,"Eras Light ITC":10,"Eras Medium ITC":11,EucrosiaUPC:8,Euphemia:11,"Expo M":16,FangSong:10,"Felix Titling":11,"Footlight MT Light":11,Forte:10,"Franklin Gothic Book":11,"Franklin Gothic Demi":11,"Franklin Gothic Demi Cond":10,"Franklin Gothic Heavy":11,"Franklin Gothic Medium":11,"Franklin Gothic Medium Cond":10,FrankRuehl:8,FreesiaUPC:8,"Freestyle Script":7,"French Script MT":7,Gabriola:8,Gadugi:10,Garamond:9,Gautami:11,Georgia:12,"Georgia Pro":11,"Georgia Pro Black":13,"Georgia Pro Cond":10,"Georgia Pro Cond Black":12,"Georgia Pro Cond Light":10,"Georgia Pro Cond Semibold":11,"Georgia Pro Light":10,"Georgia Pro Semibold":12,Gigi:10,"Gill Sans MT Condensed":7,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":10,"Gill Sans Nova Cond":6,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":11,"Gill Sans Nova Cond XBd":10,"Gill Sans Nova Light":10,"Gill Sans Nova Ultra Bold":16,"Gill Sans Ultra Bold":16,"Gill Sans Ultra Bold Condensed":11,Gisha:10,"Gloucester MT Extra Condensed":7,"Goudy Old Style":10,"Goudy Stout":16,Grotesque:9,"Grotesque Light":9,Gulim:10,GulimChe:10,Gungsuh:10,GungsuhChe:10,"Hadassah Friedlaender":11,Haettenschweiler:8,"Harlow Solid Italic":9,Harrington:11,"Headline R":14,HGGothicE:10,HGGothicM:10,HGGyoshotai:10,HGKyokashotai:10,HGMaruGothicMPRO:14,HGMinchoB:11,HGMinchoE:11,HGPGothicE:11,HGPGothicM:12,HGPGyoshotai:10,HGPKyokashotai:10,HGPMinchoB:10,HGPMinchoE:11,HGPSoeiKakugothicUB:13,HGPSoeiKakupoptai:13,HGPSoeiPresenceEB:12,HGSeikaishotaiPRO:11,HGSGothicE:10,HGSGothicM:11,HGSGyoshotai:9,HGSKyokashotai:9,HGSMinchoB:10,HGSMinchoE:11,HGSoeiKakugothicUB:11,HGSoeiKakupoptai:11,HGSoeiPresenceEB:11,HGSSoeiKakugothicUB:12,HGSSoeiKakupoptai:12,HGSSoeiPresenceEB:11,"High Tower Text":9,"HYGothic-Extra":12,"HYGothic-Medium":11,"HYGraphic-Medium":11,"HYGungSo-Bold":11,"HYHeadLine-Medium":11,"HYMyeongJo-Extra":13,"HYPMokGak-Bold":13,"HYPost-Light":13,"HYPost-Medium":13,"HYShortSamul-Medium":7,"HYSinMyeongJo-Medium":12,Impact:10,"Imprint MT Shadow":10,"Informal Roman":10,"Ink Free":10,IrisUPC:10,"Iskoola Pota":10,JasmineUPC:10,"Javanese Text":11,Jokerman:14,"Juice ITC":7,KaiTi:10,Kalinga:11,Kartika:11,"Khmer UI":10,KodchiangUPC:7,Kokila:10,"Kristen ITC":11,"Kunstler Script":7,"Lao UI":10,Latha:10,Leelawadee:10,"Leelawadee UI":10,"Leelawadee UI Semilight":10,"Levenim MT":11,LilyUPC:8,"Lucida Bright":12,"Lucida Calligraphy":14,"Lucida Console":12,"Lucida Fax":13,"Lucida Handwriting":14,"Lucida Sans":13,"Lucida Sans Typewriter":11,"Lucida Sans Unicode":13,"Magic R":12,Magneto:15,"Maiandra GD":12,"Malgun Gothic":11,"Malgun Gothic Semilight":12,Mangal:11,Marlett:20,"Matura MT Script Capitals":13,Meiryo:13,"Meiryo UI":13,"Microsoft GothicNeo":11,"Microsoft Himalaya":7,"Microsoft JhengHei":11,"Microsoft JhengHei Light":12,"Microsoft JhengHei UI":11,"Microsoft JhengHei UI Light":12,"Microsoft New Tai Lue":11,"Microsoft PhagsPa":11,"Microsoft Sans Serif":11,"Microsoft Tai Le":11,"Microsoft Uighur":7,"Microsoft YaHei Light":12,"Microsoft YaHei UI":12,"Microsoft YaHei UI Light":12,"Microsoft Yi Baiti":11,MingLiU:11,MingLiU_HKSCS:11,"MingLiU_HKSCS-ExtB":11,"MingLiU-ExtB":11,Miriam:10,"Miriam Fixed":12,Mistral:10,"Modern No. 20":10,"MoeumT R":11,"Mongolian Baiti":11,"Monotype Corsiva":9,MoolBoran:8,"MS Gothic":11,"MS Mincho":11,"MS Outlook":11,"MS PGothic":11,"MS PMincho":11,"MS Reference Sans Serif":13,"MS Reference Specialty":24,"MS UI Gothic":11,"MT Extra":20,"MV Boli":14,"Myanmar Text":11,Narkisim:9,"Neue Haas Grotesk Text Pro":11,"New Gulim":12,"News Gothic MT":12,"Niagara Engraved":7,"Niagara Solid":7,"Nirmala UI":11,"Nirmala UI Semilight":11,Nyala:11,"OCR A Extended":12,OCRB:12,"Old English Text MT":11,Onyx:7,"Palace Script MT":7,"Palatino Linotype":10,Papyrus:12,Parchment:5,Perpetua:9,"Perpetua Titling MT":13,"Plantagenet Cherokee":11,Playbill:8,PMingLiU:10,"PMingLiU-ExtB":10,"Poor Richard":11,Pristina:10,"Pyunji R":10,Raavi:10,"Rage Italic":11,Ravie:19,Rockwell:10,"Rockwell Condensed":8,"Rockwell Extra Bold":13,"Rockwell Light":11,"Rockwell Nova":11,"Rockwell Nova Cond":11,"Rockwell Nova Cond Light":11,"Rockwell Nova Extra Bold":11,"Rockwell Nova Light":11,Rod:11,"Sakkal Majalla":11,"Sanskrit Text":12,"Script MT Bold":10,"Segoe MDL2 Assets":8,"Segoe Print":14,"Segoe Script":14,"Segoe UI":10,"Segoe UI Black":12,"Segoe UI Emoji":10,"Segoe UI Historic":10,"Segoe UI Light":10,"Segoe UI Semibold":11,"Segoe UI Semilight":10,"Segoe UI Symbol":10,Selawik:10,"Selawik Light":10,"Selawik Semibold":10,"Shonar Bangla":10,"Showcard Gothic":11,Shruti:11,"Simplified Arabic":10,"Simplified Arabic Fixed":11,"SimSun-ExtB":10,"Sitka Banner":10,"Sitka Display":10,"Sitka Heading":11,"Sitka Small":13,"Sitka Subheading":11,"Sitka Text":12,"Snap ITC":16,"Source Sans Pro":9,"Source Sans Pro Black":10,"Source Sans Pro ExtraLight":9,"Source Sans Pro Light":10,"Source Sans Pro SemiBold":10,Stencil:11,Sylfaen:10,Symbol:10,Tahoma:10,"Tempus Sans ITC":13,"TH SarabunPSK":7,"Times New Roman":10,"Traditional Arabic":10,"Trebuchet MS":10,Tunga:10,"Tw Cen MT":10,"Tw Cen MT Condensed":7,"Tw Cen MT Condensed Extra Bold":9,"UD Digi Kyokasho N-B":10,"UD Digi Kyokasho NK-B":10,"UD Digi Kyokasho NK-R":10,"UD Digi Kyokasho NP-B":10,"UD Digi Kyokasho NP-R":10,"UD Digi Kyokasho N-R":10,Univers:10,"Univers Condensed":10,"Univers Condensed Light":8,"Univers Light":10,"Urdu Typesetting":10,Utsaah:8,Vani:11,Verdana:12,"Verdana Pro":12,"Verdana Pro Black":10,"Verdana Pro Cond":10,"Verdana Pro Cond Black":10,"Verdana Pro Cond Light":10,"Verdana Pro Cond SemiBold":10,"Verdana Pro Light":10,"Verdana Pro SemiBold":10,Vijaya:10,"Viner Hand ITC":13,Vivaldi:8,"Vladimir Script":9,Vrinda:11,Webdings:19,"Wide Latin":24,Wingdings:26,"Wingdings 2":22,"Wingdings 3":17,"Yet R":10,"Yu Gothic":11,"Yu Gothic Light":10,"Yu Gothic Medium":11,"Yu Gothic UI":10,"Yu Gothic UI Light":10,"Yu Gothic UI Semibold":11,"Yu Gothic UI Semilight":10,"Yu Mincho":10,"Yu Mincho Demibold":10,"Yu Mincho Light":10,"":10,"":12,"":9,"":9,"":11,"":11,"":9,"":11,"":11,"":10,"":8,"":10,"":10,"":11," Light":11,"":10,"":10,"":10,"":10,"":10," Light":10,"":10,"":10,"":11," ":10," ":10,"":12,"HGE":10,"HGB":10,"HGM":10},16:{"Gill Sans MT":11,Abadi:13,"Abadi Extra Light":12,"Agency FB":9,Aharoni:9,Aldhabi:7,Algerian:13,"Ami R":9,"Angsana New":7,AngsanaUPC:7,Aparajita:8,"Arabic Typesetting":7,Arial:12,"Arial Black":14,"Arial Narrow":10,"Arial Nova":12,"Arial Nova Cond":11,"Arial Nova Cond Light":9,"Arial Nova Light":12,"Arial Rounded MT Bold":12,"Baskerville Old Face":10,Batang:10,BatangChe:11,"Bauhaus 93":12,"Bell MT":11,Bembo:10,"Berlin Sans FB":13,"Berlin Sans FB Demi":13,"Bernard MT Condensed":10,"Blackadder ITC":8,"Bodoni MT":10,"Bodoni MT Black":14,"Bodoni MT Condensed":7,"Bodoni MT Poster Compressed":7,"Book Antiqua":11,"Bookman Old Style":13,"Bookshelf Symbol 7":16,"Bradley Hand ITC":14,"Britannic Bold":13,Broadway:14,"Browallia New":8,BrowalliaUPC:8,"Brush Script MT":11,Calibri:11,"Calibri Light":11,"Californian FB":12,"Calisto MT":11,Cambria:12,"Cambria Math":12,Candara:12,Castellar:15,Centaur:10,Century:12,"Century Gothic":12,"Century Schoolbook":12,Chiller:10,"Colonna MT":11,"Comic Sans MS":13,Consolas:12,Constantia:11,"Cooper Black":13,"Copperplate Gothic Bold":15,"Copperplate Gothic Light":15,Corbel:11,"Cordia New":8,CordiaUPC:8,"Courier New":13,"Curlz MT":11,Dante:9,DaunPenh:7,David:9,DilleniaUPC:7,DokChampa:12,Dotum:11,DotumChe:11,Dubai:11,"Dubai Light":11,"Dubai Medium":11,Ebrima:11,"Edwardian Script ITC":10,Elephant:16,"Engravers MT":14,"Eras Bold ITC":14,"Eras Demi ITC":13,"Eras Light ITC":11,"Eras Medium ITC":12,EucrosiaUPC:9,Euphemia:12,"Expo M":18,FangSong:11,"Felix Titling":12,"Footlight MT Light":12,Forte:11,"Franklin Gothic Book":12,"Franklin Gothic Demi":12,"Franklin Gothic Demi Cond":11,"Franklin Gothic Heavy":12,"Franklin Gothic Medium":12,"Franklin Gothic Medium Cond":11,FrankRuehl:9,FreesiaUPC:9,"Freestyle Script":8,"French Script MT":8,Gabriola:8,Gadugi:11,Garamond:10,Gautami:13,Georgia:13,"Georgia Pro":12,"Georgia Pro Black":15,"Georgia Pro Cond":11,"Georgia Pro Cond Black":13,"Georgia Pro Cond Light":11,"Georgia Pro Cond Semibold":12,"Georgia Pro Light":12,"Georgia Pro Semibold":13,Gigi:12,"Gill Sans MT Condensed":8,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":11,"Gill Sans Nova Cond":7,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":12,"Gill Sans Nova Cond XBd":11,"Gill Sans Nova Light":11,"Gill Sans Nova Ultra Bold":18,"Gill Sans Ultra Bold":18,"Gill Sans Ultra Bold Condensed":12,Gisha:11,"Gloucester MT Extra Condensed":8,"Goudy Old Style":11,"Goudy Stout":17,Grotesque:10,"Grotesque Light":10,Gulim:11,GulimChe:11,Gungsuh:11,GungsuhChe:11,"Hadassah Friedlaender":12,Haettenschweiler:9,"Harlow Solid Italic":10,Harrington:12,"Headline R":15,HGGothicE:11,HGGothicM:11,HGGyoshotai:11,HGKyokashotai:11,HGMaruGothicMPRO:16,HGMinchoB:12,HGMinchoE:12,HGPGothicE:12,HGPGothicM:13,HGPGyoshotai:11,HGPKyokashotai:11,HGPMinchoB:11,HGPMinchoE:12,HGPSoeiKakugothicUB:14,HGPSoeiKakupoptai:15,HGPSoeiPresenceEB:13,HGSeikaishotaiPRO:12,HGSGothicE:11,HGSGothicM:12,HGSGyoshotai:10,HGSKyokashotai:10,HGSMinchoB:11,HGSMinchoE:12,HGSoeiKakugothicUB:12,HGSoeiKakupoptai:12,HGSoeiPresenceEB:12,HGSSoeiKakugothicUB:13,HGSSoeiKakupoptai:14,HGSSoeiPresenceEB:12,"High Tower Text":10,"HYGothic-Extra":13,"HYGothic-Medium":12,"HYGraphic-Medium":12,"HYGungSo-Bold":12,"HYHeadLine-Medium":12,"HYMyeongJo-Extra":14,"HYPMokGak-Bold":15,"HYPost-Light":14,"HYPost-Medium":15,"HYShortSamul-Medium":8,"HYSinMyeongJo-Medium":13,Impact:11,"Imprint MT Shadow":11,"Informal Roman":11,"Ink Free":11,IrisUPC:11,"Iskoola Pota":11,JasmineUPC:10,"Javanese Text":12,Jokerman:15,"Juice ITC":8,KaiTi:11,Kalinga:12,Kartika:12,"Khmer UI":11,KodchiangUPC:7,Kokila:8,"Kristen ITC":13,"Kunstler Script":7,"Lao UI":11,Latha:11,Leelawadee:11,"Leelawadee UI":11,"Leelawadee UI Semilight":12,"Levenim MT":12,LilyUPC:9,"Lucida Bright":13,"Lucida Calligraphy":15,"Lucida Console":14,"Lucida Fax":14,"Lucida Handwriting":15,"Lucida Sans":14,"Lucida Sans Typewriter":13,"Lucida Sans Unicode":14,"Magic R":13,Magneto:16,"Maiandra GD":13,"Malgun Gothic":12,"Malgun Gothic Semilight":13,Mangal:12,Marlett:22,"Matura MT Script Capitals":15,Meiryo:14,"Meiryo UI":14,"Microsoft GothicNeo":12,"Microsoft Himalaya":8,"Microsoft JhengHei":13,"Microsoft JhengHei Light":13,"Microsoft JhengHei UI":13,"Microsoft JhengHei UI Light":13,"Microsoft New Tai Lue":12,"Microsoft PhagsPa":12,"Microsoft Sans Serif":13,"Microsoft Tai Le":12,"Microsoft Uighur":8,"Microsoft YaHei Light":13,"Microsoft YaHei UI":13,"Microsoft YaHei UI Light":13,"Microsoft Yi Baiti":12,MingLiU:12,MingLiU_HKSCS:12,"MingLiU_HKSCS-ExtB":12,"MingLiU-ExtB":12,Miriam:11,"Miriam Fixed":14,Mistral:10,"Modern No. 20":11,"MoeumT R":13,"Mongolian Baiti":12,"Monotype Corsiva":10,MoolBoran:8,"MS Gothic":12,"MS Mincho":12,"MS Outlook":12,"MS PGothic":12,"MS PMincho":12,"MS Reference Sans Serif":14,"MS Reference Specialty":26,"MS UI Gothic":12,"MT Extra":22,"MV Boli":16,"Myanmar Text":12,Narkisim:10,"Neue Haas Grotesk Text Pro":12,"New Gulim":13,"News Gothic MT":14,"Niagara Engraved":8,"Niagara Solid":8,"Nirmala UI":12,"Nirmala UI Semilight":13,Nyala:12,"OCR A Extended":14,OCRB:14,"Old English Text MT":12,Onyx:8,"Palace Script MT":8,"Palatino Linotype":11,Papyrus:14,Parchment:5,Perpetua:10,"Perpetua Titling MT":14,"Plantagenet Cherokee":12,Playbill:8,PMingLiU:11,"PMingLiU-ExtB":11,"Poor Richard":13,Pristina:11,"Pyunji R":11,Raavi:11,"Rage Italic":12,Ravie:21,Rockwell:11,"Rockwell Condensed":9,"Rockwell Extra Bold":14,"Rockwell Light":12,"Rockwell Nova":12,"Rockwell Nova Cond":12,"Rockwell Nova Cond Light":12,"Rockwell Nova Extra Bold":12,"Rockwell Nova Light":12,Rod:12,"Sakkal Majalla":12,"Sanskrit Text":13,"Script MT Bold":11,"Segoe MDL2 Assets":8,"Segoe Print":15,"Segoe Script":15,"Segoe UI":11,"Segoe UI Black":13,"Segoe UI Emoji":11,"Segoe UI Historic":11,"Segoe UI Light":11,"Segoe UI Semibold":12,"Segoe UI Semilight":11,"Segoe UI Symbol":11,Selawik:11,"Selawik Light":11,"Selawik Semibold":12,"Shonar Bangla":11,"Showcard Gothic":12,Shruti:13,"Simplified Arabic":11,"Simplified Arabic Fixed":13,"SimSun-ExtB":11,"Sitka Banner":11,"Sitka Display":11,"Sitka Heading":12,"Sitka Small":14,"Sitka Subheading":12,"Sitka Text":13,"Snap ITC":18,"Source Sans Pro":10,"Source Sans Pro Black":11,"Source Sans Pro ExtraLight":10,"Source Sans Pro Light":11,"Source Sans Pro SemiBold":11,Stencil:12,Sylfaen:11,Symbol:11,Tahoma:11,"Tempus Sans ITC":14,"TH SarabunPSK":8,"Times New Roman":11,"Traditional Arabic":10,"Trebuchet MS":11,Tunga:11,"Tw Cen MT":12,"Tw Cen MT Condensed":8,"Tw Cen MT Condensed Extra Bold":10,"UD Digi Kyokasho N-B":11,"UD Digi Kyokasho NK-B":11,"UD Digi Kyokasho NK-R":11,"UD Digi Kyokasho NP-B":11,"UD Digi Kyokasho NP-R":11,"UD Digi Kyokasho N-R":11,Univers:11,"Univers Condensed":11,"Univers Condensed Light":9,"Univers Light":11,"Urdu Typesetting":11,Utsaah:8,Vani:13,Verdana:13,"Verdana Pro":13,"Verdana Pro Black":11,"Verdana Pro Cond":11,"Verdana Pro Cond Black":11,"Verdana Pro Cond Light":11,"Verdana Pro Cond SemiBold":11,"Verdana Pro Light":11,"Verdana Pro SemiBold":11,Vijaya:11,"Viner Hand ITC":14,Vivaldi:9,"Vladimir Script":10,Vrinda:12,Webdings:21,"Wide Latin":26,Wingdings:28,"Wingdings 2":24,"Wingdings 3":19,"Yet R":11,"Yu Gothic":12,"Yu Gothic Light":11,"Yu Gothic Medium":12,"Yu Gothic UI":11,"Yu Gothic UI Light":11,"Yu Gothic UI Semibold":12,"Yu Gothic UI Semilight":12,"Yu Mincho":11,"Yu Mincho Demibold":11,"Yu Mincho Light":11,"":11,"":13,"":10,"":10,"":12,"":12,"":10,"":12,"":12,"":11,"":9,"":11,"":11,"":12," Light":12,"":11,"":11,"":11,"":11,"":11," Light":11,"":11,"":11,"":12," ":11," ":11,"":13,"HGE":11,"HGB":11,"HGM":11},18:{"Gill Sans MT":12,Abadi:15,"Abadi Extra Light":13,"Agency FB":10,Aharoni:10,Aldhabi:8,Algerian:14,"Ami R":10,"Angsana New":8,AngsanaUPC:8,Aparajita:10,"Arabic Typesetting":8,Arial:13,"Arial Black":16,"Arial Narrow":11,"Arial Nova":13,"Arial Nova Cond":12,"Arial Nova Cond Light":11,"Arial Nova Light":13,"Arial Rounded MT Bold":14,"Baskerville Old Face":12,Batang:12,BatangChe:12,"Bauhaus 93":14,"Bell MT":12,Bembo:12,"Berlin Sans FB":14,"Berlin Sans FB Demi":15,"Bernard MT Condensed":12,"Blackadder ITC":9,"Bodoni MT":12,"Bodoni MT Black":16,"Bodoni MT Condensed":8,"Bodoni MT Poster Compressed":8,"Book Antiqua":12,"Bookman Old Style":15,"Bookshelf Symbol 7":18,"Bradley Hand ITC":15,"Britannic Bold":15,Broadway:16,"Browallia New":9,BrowalliaUPC:9,"Brush Script MT":12,Calibri:12,"Calibri Light":12,"Californian FB":13,"Calisto MT":12,Cambria:13,"Cambria Math":13,Candara:13,Castellar:17,Centaur:12,Century:13,"Century Gothic":13,"Century Schoolbook":13,Chiller:11,"Colonna MT":12,"Comic Sans MS":15,Consolas:13,Constantia:13,"Cooper Black":14,"Copperplate Gothic Bold":17,"Copperplate Gothic Light":17,Corbel:13,"Cordia New":9,CordiaUPC:9,"Courier New":14,"Curlz MT":13,Dante:11,DaunPenh:8,David:11,DilleniaUPC:7,DokChampa:13,Dotum:13,DotumChe:12,Dubai:13,"Dubai Light":13,"Dubai Medium":13,Ebrima:13,"Edwardian Script ITC":11,Elephant:18,"Engravers MT":16,"Eras Bold ITC":16,"Eras Demi ITC":15,"Eras Light ITC":13,"Eras Medium ITC":14,EucrosiaUPC:10,Euphemia:14,"Expo M":21,FangSong:12,"Felix Titling":14,"Footlight MT Light":13,Forte:13,"Franklin Gothic Book":14,"Franklin Gothic Demi":14,"Franklin Gothic Demi Cond":12,"Franklin Gothic Heavy":14,"Franklin Gothic Medium":14,"Franklin Gothic Medium Cond":12,FrankRuehl:10,FreesiaUPC:11,"Freestyle Script":9,"French Script MT":9,Gabriola:10,Gadugi:13,Garamond:11,Gautami:14,Georgia:15,"Georgia Pro":14,"Georgia Pro Black":17,"Georgia Pro Cond":13,"Georgia Pro Cond Black":15,"Georgia Pro Cond Light":12,"Georgia Pro Cond Semibold":13,"Georgia Pro Light":13,"Georgia Pro Semibold":15,Gigi:12,"Gill Sans MT Condensed":9,"Gill Sans MT Ext Condensed Bold":8,"Gill Sans Nova":12,"Gill Sans Nova Cond":8,"Gill Sans Nova Cond Lt":7,"Gill Sans Nova Cond Ultra Bold":14,"Gill Sans Nova Cond XBd":13,"Gill Sans Nova Light":12,"Gill Sans Nova Ultra Bold":20,"Gill Sans Ultra Bold":21,"Gill Sans Ultra Bold Condensed":14,Gisha:13,"Gloucester MT Extra Condensed":9,"Goudy Old Style":12,"Goudy Stout":20,Grotesque:12,"Grotesque Light":12,Gulim:13,GulimChe:12,Gungsuh:13,GungsuhChe:12,"Hadassah Friedlaender":14,Haettenschweiler:11,"Harlow Solid Italic":11,Harrington:13,"Headline R":17,HGGothicE:12,HGGothicM:12,HGGyoshotai:12,HGKyokashotai:12,HGMaruGothicMPRO:18,HGMinchoB:13,HGMinchoE:13,HGPGothicE:14,HGPGothicM:15,HGPGyoshotai:12,HGPKyokashotai:12,HGPMinchoB:12,HGPMinchoE:13,HGPSoeiKakugothicUB:16,HGPSoeiKakupoptai:17,HGPSoeiPresenceEB:14,HGSeikaishotaiPRO:14,HGSGothicE:13,HGSGothicM:14,HGSGyoshotai:11,HGSKyokashotai:11,HGSMinchoB:12,HGSMinchoE:13,HGSoeiKakugothicUB:13,HGSoeiKakupoptai:13,HGSoeiPresenceEB:13,HGSSoeiKakugothicUB:15,HGSSoeiKakupoptai:16,HGSSoeiPresenceEB:13,"High Tower Text":12,"HYGothic-Extra":15,"HYGothic-Medium":14,"HYGraphic-Medium":14,"HYGungSo-Bold":14,"HYHeadLine-Medium":14,"HYMyeongJo-Extra":16,"HYPMokGak-Bold":17,"HYPost-Light":16,"HYPost-Medium":17,"HYShortSamul-Medium":9,"HYSinMyeongJo-Medium":15,Impact:13,"Imprint MT Shadow":12,"Informal Roman":13,"Ink Free":12,IrisUPC:12,"Iskoola Pota":12,JasmineUPC:11,"Javanese Text":14,Jokerman:17,"Juice ITC":8,KaiTi:12,Kalinga:13,Kartika:14,"Khmer UI":13,KodchiangUPC:8,Kokila:9,"Kristen ITC":14,"Kunstler Script":8,"Lao UI":13,Latha:12,Leelawadee:13,"Leelawadee UI":13,"Leelawadee UI Semilight":13,"Levenim MT":14,LilyUPC:11,"Lucida Bright":15,"Lucida Calligraphy":17,"Lucida Console":15,"Lucida Fax":16,"Lucida Handwriting":17,"Lucida Sans":16,"Lucida Sans Typewriter":14,"Lucida Sans Unicode":16,"Magic R":14,Magneto:19,"Maiandra GD":15,"Malgun Gothic":14,"Malgun Gothic Semilight":14,Mangal:14,Marlett:25,"Matura MT Script Capitals":17,Meiryo:16,"Meiryo UI":16,"Microsoft GothicNeo":13,"Microsoft Himalaya":9,"Microsoft JhengHei":14,"Microsoft JhengHei Light":15,"Microsoft JhengHei UI":14,"Microsoft JhengHei UI Light":15,"Microsoft New Tai Lue":14,"Microsoft PhagsPa":14,"Microsoft Sans Serif":14,"Microsoft Tai Le":14,"Microsoft Uighur":9,"Microsoft YaHei Light":15,"Microsoft YaHei UI":15,"Microsoft YaHei UI Light":15,"Microsoft Yi Baiti":13,MingLiU:13,MingLiU_HKSCS:13,"MingLiU_HKSCS-ExtB":13,"MingLiU-ExtB":13,Miriam:12,"Miriam Fixed":15,Mistral:12,"Modern No. 20":12,"MoeumT R":14,"Mongolian Baiti":13,"Monotype Corsiva":12,MoolBoran:9,"MS Gothic":13,"MS Mincho":13,"MS Outlook":13,"MS PGothic":13,"MS PMincho":13,"MS Reference Sans Serif":16,"MS Reference Specialty":30,"MS UI Gothic":13,"MT Extra":25,"MV Boli":18,"Myanmar Text":14,Narkisim:11,"Neue Haas Grotesk Text Pro":13,"New Gulim":15,"News Gothic MT":16,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":14,"Nirmala UI Semilight":14,Nyala:13,"OCR A Extended":15,OCRB:15,"Old English Text MT":13,Onyx:9,"Palace Script MT":9,"Palatino Linotype":12,Papyrus:15,Parchment:6,Perpetua:11,"Perpetua Titling MT":16,"Plantagenet Cherokee":13,Playbill:10,PMingLiU:12,"PMingLiU-ExtB":12,"Poor Richard":14,Pristina:13,"Pyunji R":13,Raavi:12,"Rage Italic":13,Ravie:24,Rockwell:13,"Rockwell Condensed":10,"Rockwell Extra Bold":17,"Rockwell Light":14,"Rockwell Nova":13,"Rockwell Nova Cond":13,"Rockwell Nova Cond Light":13,"Rockwell Nova Extra Bold":13,"Rockwell Nova Light":13,Rod:15,"Sakkal Majalla":10,"Sanskrit Text":15,"Script MT Bold":13,"Segoe MDL2 Assets":10,"Segoe Print":18,"Segoe Script":18,"Segoe UI":13,"Segoe UI Black":15,"Segoe UI Emoji":13,"Segoe UI Historic":13,"Segoe UI Light":12,"Segoe UI Semibold":14,"Segoe UI Semilight":13,"Segoe UI Symbol":13,Selawik:12,"Selawik Light":13,"Selawik Semibold":14,"Shonar Bangla":12,"Showcard Gothic":14,Shruti:14,"Simplified Arabic":13,"Simplified Arabic Fixed":14,"SimSun-ExtB":12,"Sitka Banner":12,"Sitka Display":13,"Sitka Heading":13,"Sitka Small":16,"Sitka Subheading":14,"Sitka Text":15,"Snap ITC":21,"Source Sans Pro":12,"Source Sans Pro Black":12,"Source Sans Pro ExtraLight":11,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":12,Stencil:14,Sylfaen:12,Symbol:12,Tahoma:13,"Tempus Sans ITC":16,"TH SarabunPSK":9,"Times New Roman":12,"Traditional Arabic":12,"Trebuchet MS":13,Tunga:13,"Tw Cen MT":13,"Tw Cen MT Condensed":9,"Tw Cen MT Condensed Extra Bold":12,"UD Digi Kyokasho N-B":12,"UD Digi Kyokasho NK-B":12,"UD Digi Kyokasho NK-R":12,"UD Digi Kyokasho NP-B":17,"UD Digi Kyokasho NP-R":12,"UD Digi Kyokasho N-R":12,Univers:12,"Univers Condensed":12,"Univers Condensed Light":11,"Univers Light":12,"Urdu Typesetting":12,Utsaah:10,Vani:15,Verdana:15,"Verdana Pro":15,"Verdana Pro Black":12,"Verdana Pro Cond":12,"Verdana Pro Cond Black":12,"Verdana Pro Cond Light":12,"Verdana Pro Cond SemiBold":12,"Verdana Pro Light":12,"Verdana Pro SemiBold":12,Vijaya:12,"Viner Hand ITC":16,Vivaldi:10,"Vladimir Script":11,Vrinda:14,Webdings:24,"Wide Latin":30,Wingdings:32,"Wingdings 2":27,"Wingdings 3":21,"Yet R":13,"Yu Gothic":13,"Yu Gothic Light":13,"Yu Gothic Medium":13,"Yu Gothic UI":13,"Yu Gothic UI Light":13,"Yu Gothic UI Semibold":14,"Yu Gothic UI Semilight":13,"Yu Mincho":13,"Yu Mincho Demibold":13,"Yu Mincho Light":12,"":12,"":15,"":11,"":11,"":14,"":14,"":11,"":14,"":13,"":12,"":11,"":12,"":12,"":14," Light":14,"":12,"":12,"":13,"":12,"":13," Light":12,"":12,"":12,"":13," ":12," ":12,"":15,"HGE":12,"HGB":12,"HGM":12},20:{"Gill Sans MT":14,Abadi:16,"Abadi Extra Light":15,"Agency FB":11,Aharoni:11,Aldhabi:9,Algerian:16,"Ami R":11,"Angsana New":9,AngsanaUPC:9,Aparajita:11,"Arabic Typesetting":9,Arial:15,"Arial Black":18,"Arial Narrow":12,"Arial Nova":15,"Arial Nova Cond":14,"Arial Nova Cond Light":12,"Arial Nova Light":15,"Arial Rounded MT Bold":16,"Baskerville Old Face":13,Batang:16,BatangChe:14,"Bauhaus 93":15,"Bell MT":14,Bembo:13,"Berlin Sans FB":16,"Berlin Sans FB Demi":17,"Bernard MT Condensed":13,"Blackadder ITC":11,"Bodoni MT":13,"Bodoni MT Black":18,"Bodoni MT Condensed":9,"Bodoni MT Poster Compressed":8,"Book Antiqua":14,"Bookman Old Style":17,"Bookshelf Symbol 7":20,"Bradley Hand ITC":17,"Britannic Bold":17,Broadway:17,"Browallia New":10,BrowalliaUPC:10,"Brush Script MT":14,Calibri:14,"Calibri Light":14,"Californian FB":14,"Calisto MT":14,Cambria:15,"Cambria Math":15,Candara:15,Castellar:19,Centaur:13,Century:15,"Century Gothic":15,"Century Schoolbook":15,Chiller:13,"Colonna MT":14,"Comic Sans MS":16,Consolas:15,Constantia:15,"Cooper Black":16,"Copperplate Gothic Bold":19,"Copperplate Gothic Light":19,Corbel:14,"Cordia New":10,CordiaUPC:10,"Courier New":16,"Curlz MT":15,Dante:12,DaunPenh:9,David:12,DilleniaUPC:8,DokChampa:15,Dotum:16,DotumChe:14,Dubai:15,"Dubai Light":15,"Dubai Medium":15,Ebrima:15,"Edwardian Script ITC":13,Elephant:20,"Engravers MT":17,"Eras Bold ITC":18,"Eras Demi ITC":16,"Eras Light ITC":14,"Eras Medium ITC":15,EucrosiaUPC:11,Euphemia:16,"Expo M":23,FangSong:14,"Felix Titling":16,"Footlight MT Light":15,Forte:14,"Franklin Gothic Book":16,"Franklin Gothic Demi":16,"Franklin Gothic Demi Cond":14,"Franklin Gothic Heavy":16,"Franklin Gothic Medium":16,"Franklin Gothic Medium Cond":14,FrankRuehl:11,FreesiaUPC:12,"Freestyle Script":10,"French Script MT":10,Gabriola:11,Gadugi:15,Garamond:13,Gautami:16,Georgia:17,"Georgia Pro":15,"Georgia Pro Black":19,"Georgia Pro Cond":14,"Georgia Pro Cond Black":17,"Georgia Pro Cond Light":14,"Georgia Pro Cond Semibold":15,"Georgia Pro Light":15,"Georgia Pro Semibold":17,Gigi:14,"Gill Sans MT Condensed":10,"Gill Sans MT Ext Condensed Bold":9,"Gill Sans Nova":14,"Gill Sans Nova Cond":9,"Gill Sans Nova Cond Lt":8,"Gill Sans Nova Cond Ultra Bold":16,"Gill Sans Nova Cond XBd":14,"Gill Sans Nova Light":14,"Gill Sans Nova Ultra Bold":23,"Gill Sans Ultra Bold":23,"Gill Sans Ultra Bold Condensed":16,Gisha:15,"Gloucester MT Extra Condensed":10,"Goudy Old Style":14,"Goudy Stout":22,Grotesque:13,"Grotesque Light":13,Gulim:16,GulimChe:14,Gungsuh:16,GungsuhChe:14,"Hadassah Friedlaender":15,Haettenschweiler:12,"Harlow Solid Italic":13,Harrington:15,"Headline R":19,HGGothicE:14,HGGothicM:14,HGGyoshotai:14,HGKyokashotai:14,HGMaruGothicMPRO:20,HGMinchoB:15,HGMinchoE:15,HGPGothicE:16,HGPGothicM:17,HGPGyoshotai:14,HGPKyokashotai:14,HGPMinchoB:14,HGPMinchoE:15,HGPSoeiKakugothicUB:18,HGPSoeiKakupoptai:19,HGPSoeiPresenceEB:16,HGSeikaishotaiPRO:16,HGSGothicE:15,HGSGothicM:16,HGSGyoshotai:13,HGSKyokashotai:13,HGSMinchoB:14,HGSMinchoE:15,HGSoeiKakugothicUB:15,HGSoeiKakupoptai:15,HGSoeiPresenceEB:15,HGSSoeiKakugothicUB:17,HGSSoeiKakupoptai:18,HGSSoeiPresenceEB:15,"High Tower Text":13,"HYGothic-Extra":17,"HYGothic-Medium":16,"HYGraphic-Medium":16,"HYGungSo-Bold":16,"HYHeadLine-Medium":16,"HYMyeongJo-Extra":18,"HYPMokGak-Bold":19,"HYPost-Light":18,"HYPost-Medium":19,"HYShortSamul-Medium":10,"HYSinMyeongJo-Medium":17,Impact:15,"Imprint MT Shadow":14,"Informal Roman":15,"Ink Free":14,IrisUPC:14,"Iskoola Pota":14,JasmineUPC:12,"Javanese Text":16,Jokerman:19,"Juice ITC":10,KaiTi:14,Kalinga:15,Kartika:16,"Khmer UI":15,KodchiangUPC:9,Kokila:10,"Kristen ITC":16,"Kunstler Script":10,"Lao UI":15,Latha:14,Leelawadee:15,"Leelawadee UI":15,"Leelawadee UI Semilight":15,"Levenim MT":15,LilyUPC:12,"Lucida Bright":16,"Lucida Calligraphy":19,"Lucida Console":17,"Lucida Fax":18,"Lucida Handwriting":19,"Lucida Sans":18,"Lucida Sans Typewriter":16,"Lucida Sans Unicode":18,"Magic R":16,Magneto:21,"Maiandra GD":17,"Malgun Gothic":16,"Malgun Gothic Semilight":16,Mangal:16,Marlett:28,"Matura MT Script Capitals":19,Meiryo:18,"Meiryo UI":18,"Microsoft GothicNeo":15,"Microsoft Himalaya":10,"Microsoft JhengHei":16,"Microsoft JhengHei Light":17,"Microsoft JhengHei UI":16,"Microsoft JhengHei UI Light":17,"Microsoft New Tai Lue":16,"Microsoft PhagsPa":16,"Microsoft Sans Serif":16,"Microsoft Tai Le":16,"Microsoft Uighur":10,"Microsoft YaHei Light":16,"Microsoft YaHei UI":17,"Microsoft YaHei UI Light":16,"Microsoft Yi Baiti":15,MingLiU:15,MingLiU_HKSCS:15,"MingLiU_HKSCS-ExtB":15,"MingLiU-ExtB":15,Miriam:14,"Miriam Fixed":17,Mistral:13,"Modern No. 20":13,"MoeumT R":16,"Mongolian Baiti":15,"Monotype Corsiva":13,MoolBoran:10,"MS Gothic":15,"MS Mincho":15,"MS Outlook":15,"MS PGothic":15,"MS PMincho":15,"MS Reference Sans Serif":18,"MS Reference Specialty":33,"MS UI Gothic":15,"MT Extra":29,"MV Boli":20,"Myanmar Text":16,Narkisim:12,"Neue Haas Grotesk Text Pro":15,"New Gulim":17,"News Gothic MT":18,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":16,"Nirmala UI Semilight":16,Nyala:15,"OCR A Extended":17,OCRB:17,"Old English Text MT":15,Onyx:9,"Palace Script MT":9,"Palatino Linotype":14,Papyrus:16,Parchment:7,Perpetua:12,"Perpetua Titling MT":18,"Plantagenet Cherokee":15,Playbill:11,PMingLiU:14,"PMingLiU-ExtB":14,"Poor Richard":16,Pristina:14,"Pyunji R":14,Raavi:14,"Rage Italic":15,Ravie:27,Rockwell:15,"Rockwell Condensed":12,"Rockwell Extra Bold":19,"Rockwell Light":15,"Rockwell Nova":15,"Rockwell Nova Cond":15,"Rockwell Nova Cond Light":15,"Rockwell Nova Extra Bold":15,"Rockwell Nova Light":15,Rod:17,"Sakkal Majalla":11,"Sanskrit Text":17,"Script MT Bold":14,"Segoe MDL2 Assets":11,"Segoe Print":20,"Segoe Script":20,"Segoe UI":15,"Segoe UI Black":17,"Segoe UI Emoji":15,"Segoe UI Historic":15,"Segoe UI Light":14,"Segoe UI Semibold":15,"Segoe UI Semilight":15,"Segoe UI Symbol":15,Selawik:14,"Selawik Light":14,"Selawik Semibold":15,"Shonar Bangla":14,"Showcard Gothic":16,Shruti:16,"Simplified Arabic":14,"Simplified Arabic Fixed":16,"SimSun-ExtB":14,"Sitka Banner":14,"Sitka Display":14,"Sitka Heading":15,"Sitka Small":18,"Sitka Subheading":16,"Sitka Text":17,"Snap ITC":23,"Source Sans Pro":13,"Source Sans Pro Black":14,"Source Sans Pro ExtraLight":12,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":14,Stencil:16,Sylfaen:14,Symbol:14,Tahoma:15,"Tempus Sans ITC":18,"TH SarabunPSK":10,"Times New Roman":14,"Traditional Arabic":13,"Trebuchet MS":14,Tunga:14,"Tw Cen MT":15,"Tw Cen MT Condensed":10,"Tw Cen MT Condensed Extra Bold":13,"UD Digi Kyokasho N-B":14,"UD Digi Kyokasho NK-B":14,"UD Digi Kyokasho NK-R":14,"UD Digi Kyokasho NP-B":19,"UD Digi Kyokasho NP-R":14,"UD Digi Kyokasho N-R":14,Univers:14,"Univers Condensed":14,"Univers Condensed Light":12,"Univers Light":14,"Urdu Typesetting":14,Utsaah:11,Vani:17,Verdana:17,"Verdana Pro":17,"Verdana Pro Black":14,"Verdana Pro Cond":14,"Verdana Pro Cond Black":14,"Verdana Pro Cond Light":14,"Verdana Pro Cond SemiBold":14,"Verdana Pro Light":14,"Verdana Pro SemiBold":14,Vijaya:14,"Viner Hand ITC":18,Vivaldi:12,"Vladimir Script":13,Vrinda:16,Webdings:27,"Wide Latin":33,Wingdings:36,"Wingdings 2":31,"Wingdings 3":24,"Yet R":14,"Yu Gothic":15,"Yu Gothic Light":14,"Yu Gothic Medium":15,"Yu Gothic UI":15,"Yu Gothic UI Light":14,"Yu Gothic UI Semibold":16,"Yu Gothic UI Semilight":15,"Yu Mincho":15,"Yu Mincho Demibold":14,"Yu Mincho Light":14,"":14,"":17,"":13,"":13,"":15,"":16,"":13,"":15,"":15,"":14,"":12,"":14,"":14,"":16," Light":15,"":14,"":14,"":15,"":14,"":14," Light":14,"":14,"":14,"":15," ":14," ":14,"":17,"HGE":14,"HGB":14,"HGM":14},22:{"Gill Sans MT":15,Abadi:18,"Abadi Extra Light":16,"Agency FB":11,Aharoni:12,Aldhabi:9,Algerian:17,"Ami R":12,"Angsana New":10,AngsanaUPC:10,Aparajita:12,"Arabic Typesetting":10,Arial:16,"Arial Black":19,"Arial Narrow":13,"Arial Nova":16,"Arial Nova Cond":15,"Arial Nova Cond Light":13,"Arial Nova Light":16,"Arial Rounded MT Bold":17,"Baskerville Old Face":14,Batang:17,BatangChe:15,"Bauhaus 93":16,"Bell MT":15,Bembo:14,"Berlin Sans FB":17,"Berlin Sans FB Demi":18,"Bernard MT Condensed":14,"Blackadder ITC":11,"Bodoni MT":14,"Bodoni MT Black":19,"Bodoni MT Condensed":10,"Bodoni MT Poster Compressed":9,"Book Antiqua":15,"Bookman Old Style":18,"Bookshelf Symbol 7":21,"Bradley Hand ITC":19,"Britannic Bold":18,Broadway:19,"Browallia New":11,BrowalliaUPC:11,"Brush Script MT":15,Calibri:15,"Calibri Light":15,"Californian FB":15,"Calisto MT":15,Cambria:16,"Cambria Math":16,Candara:16,Castellar:21,Centaur:14,Century:16,"Century Gothic":16,"Century Schoolbook":16,Chiller:14,"Colonna MT":15,"Comic Sans MS":18,Consolas:16,Constantia:16,"Cooper Black":17,"Copperplate Gothic Bold":21,"Copperplate Gothic Light":21,Corbel:15,"Cordia New":11,CordiaUPC:11,"Courier New":17,"Curlz MT":16,Dante:13,DaunPenh:10,David:13,DilleniaUPC:9,DokChampa:16,Dotum:17,DotumChe:15,Dubai:16,"Dubai Light":16,"Dubai Medium":16,Ebrima:16,"Edwardian Script ITC":14,Elephant:22,"Engravers MT":19,"Eras Bold ITC":19,"Eras Demi ITC":18,"Eras Light ITC":16,"Eras Medium ITC":17,EucrosiaUPC:12,Euphemia:17,"Expo M":25,FangSong:15,"Felix Titling":17,"Footlight MT Light":16,Forte:15,"Franklin Gothic Book":17,"Franklin Gothic Demi":17,"Franklin Gothic Demi Cond":15,"Franklin Gothic Heavy":17,"Franklin Gothic Medium":17,"Franklin Gothic Medium Cond":15,FrankRuehl:12,FreesiaUPC:13,"Freestyle Script":10,"French Script MT":11,Gabriola:12,Gadugi:16,Garamond:14,Gautami:17,Georgia:18,"Georgia Pro":16,"Georgia Pro Black":21,"Georgia Pro Cond":15,"Georgia Pro Cond Black":18,"Georgia Pro Cond Light":15,"Georgia Pro Cond Semibold":16,"Georgia Pro Light":16,"Georgia Pro Semibold":18,Gigi:14,"Gill Sans MT Condensed":11,"Gill Sans MT Ext Condensed Bold":10,"Gill Sans Nova":15,"Gill Sans Nova Cond":10,"Gill Sans Nova Cond Lt":9,"Gill Sans Nova Cond Ultra Bold":17,"Gill Sans Nova Cond XBd":15,"Gill Sans Nova Light":15,"Gill Sans Nova Ultra Bold":25,"Gill Sans Ultra Bold":25,"Gill Sans Ultra Bold Condensed":17,Gisha:16,"Gloucester MT Extra Condensed":11,"Goudy Old Style":15,"Goudy Stout":24,Grotesque:14,"Grotesque Light":14,Gulim:17,GulimChe:15,Gungsuh:17,GungsuhChe:15,"Hadassah Friedlaender":17,Haettenschweiler:13,"Harlow Solid Italic":14,Harrington:16,"Headline R":21,HGGothicE:15,HGGothicM:15,HGGyoshotai:15,HGKyokashotai:15,HGMaruGothicMPRO:22,HGMinchoB:16,HGMinchoE:16,HGPGothicE:17,HGPGothicM:18,HGPGyoshotai:15,HGPKyokashotai:14,HGPMinchoB:15,HGPMinchoE:16,HGPSoeiKakugothicUB:19,HGPSoeiKakupoptai:20,HGPSoeiPresenceEB:17,HGSeikaishotaiPRO:17,HGSGothicE:16,HGSGothicM:17,HGSGyoshotai:14,HGSKyokashotai:13,HGSMinchoB:15,HGSMinchoE:16,HGSoeiKakugothicUB:16,HGSoeiKakupoptai:16,HGSoeiPresenceEB:16,HGSSoeiKakugothicUB:18,HGSSoeiKakupoptai:19,HGSSoeiPresenceEB:16,"High Tower Text":14,"HYGothic-Extra":18,"HYGothic-Medium":17,"HYGraphic-Medium":17,"HYGungSo-Bold":17,"HYHeadLine-Medium":17,"HYMyeongJo-Extra":19,"HYPMokGak-Bold":21,"HYPost-Light":19,"HYPost-Medium":21,"HYShortSamul-Medium":11,"HYSinMyeongJo-Medium":18,Impact:16,"Imprint MT Shadow":15,"Informal Roman":16,"Ink Free":15,IrisUPC:15,"Iskoola Pota":15,JasmineUPC:13,"Javanese Text":17,Jokerman:21,"Juice ITC":11,KaiTi:15,Kalinga:16,Kartika:17,"Khmer UI":16,KodchiangUPC:10,Kokila:11,"Kristen ITC":17,"Kunstler Script":10,"Lao UI":16,Latha:15,Leelawadee:16,"Leelawadee UI":16,"Leelawadee UI Semilight":16,"Levenim MT":17,LilyUPC:13,"Lucida Bright":18,"Lucida Calligraphy":20,"Lucida Console":18,"Lucida Fax":19,"Lucida Handwriting":21,"Lucida Sans":19,"Lucida Sans Typewriter":17,"Lucida Sans Unicode":19,"Magic R":17,Magneto:22,"Maiandra GD":18,"Malgun Gothic":17,"Malgun Gothic Semilight":17,Mangal:17,Marlett:30,"Matura MT Script Capitals":20,Meiryo:20,"Meiryo UI":20,"Microsoft GothicNeo":16,"Microsoft Himalaya":11,"Microsoft JhengHei":17,"Microsoft JhengHei Light":18,"Microsoft JhengHei UI":17,"Microsoft JhengHei UI Light":18,"Microsoft New Tai Lue":17,"Microsoft PhagsPa":17,"Microsoft Sans Serif":17,"Microsoft Tai Le":17,"Microsoft Uighur":11,"Microsoft YaHei Light":18,"Microsoft YaHei UI":18,"Microsoft YaHei UI Light":18,"Microsoft Yi Baiti":16,MingLiU:16,MingLiU_HKSCS:16,"MingLiU_HKSCS-ExtB":16,"MingLiU-ExtB":16,Miriam:15,"Miriam Fixed":18,Mistral:14,"Modern No. 20":14,"MoeumT R":17,"Mongolian Baiti":16,"Monotype Corsiva":14,MoolBoran:11,"MS Gothic":16,"MS Mincho":16,"MS Outlook":16,"MS PGothic":16,"MS PMincho":16,"MS Reference Sans Serif":19,"MS Reference Specialty":36,"MS UI Gothic":16,"MT Extra":31,"MV Boli":21,"Myanmar Text":17,Narkisim:13,"Neue Haas Grotesk Text Pro":16,"New Gulim":18,"News Gothic MT":19,"Niagara Engraved":10,"Niagara Solid":10,"Nirmala UI":17,"Nirmala UI Semilight":17,Nyala:16,"OCR A Extended":19,OCRB:18,"Old English Text MT":16,Onyx:10,"Palace Script MT":10,"Palatino Linotype":15,Papyrus:18,Parchment:7,Perpetua:13,"Perpetua Titling MT":20,"Plantagenet Cherokee":16,Playbill:11,PMingLiU:15,"PMingLiU-ExtB":15,"Poor Richard":17,Pristina:15,"Pyunji R":15,Raavi:15,"Rage Italic":16,Ravie:29,Rockwell:16,"Rockwell Condensed":12,"Rockwell Extra Bold":20,"Rockwell Light":16,"Rockwell Nova":16,"Rockwell Nova Cond":16,"Rockwell Nova Cond Light":16,"Rockwell Nova Extra Bold":16,"Rockwell Nova Light":16,Rod:18,"Sakkal Majalla":12,"Sanskrit Text":18,"Script MT Bold":15,"Segoe MDL2 Assets":12,"Segoe Print":21,"Segoe Script":21,"Segoe UI":16,"Segoe UI Black":18,"Segoe UI Emoji":16,"Segoe UI Historic":16,"Segoe UI Light":15,"Segoe UI Semibold":17,"Segoe UI Semilight":16,"Segoe UI Symbol":16,Selawik:15,"Selawik Light":15,"Selawik Semibold":16,"Shonar Bangla":15,"Showcard Gothic":17,Shruti:17,"Simplified Arabic":15,"Simplified Arabic Fixed":17,"SimSun-ExtB":15,"Sitka Banner":15,"Sitka Display":15,"Sitka Heading":16,"Sitka Small":20,"Sitka Subheading":17,"Sitka Text":18,"Snap ITC":25,"Source Sans Pro":14,"Source Sans Pro Black":15,"Source Sans Pro ExtraLight":13,"Source Sans Pro Light":13,"Source Sans Pro SemiBold":14,Stencil:17,Sylfaen:15,Symbol:15,Tahoma:16,"Tempus Sans ITC":19,"TH SarabunPSK":11,"Times New Roman":15,"Traditional Arabic":14,"Trebuchet MS":15,Tunga:15,"Tw Cen MT":16,"Tw Cen MT Condensed":11,"Tw Cen MT Condensed Extra Bold":14,"UD Digi Kyokasho N-B":15,"UD Digi Kyokasho NK-B":15,"UD Digi Kyokasho NK-R":15,"UD Digi Kyokasho NP-B":21,"UD Digi Kyokasho NP-R":15,"UD Digi Kyokasho N-R":15,Univers:15,"Univers Condensed":15,"Univers Condensed Light":13,"Univers Light":15,"Urdu Typesetting":15,Utsaah:12,Vani:18,Verdana:18,"Verdana Pro":18,"Verdana Pro Black":15,"Verdana Pro Cond":15,"Verdana Pro Cond Black":15,"Verdana Pro Cond Light":15,"Verdana Pro Cond SemiBold":15,"Verdana Pro Light":15,"Verdana Pro SemiBold":15,Vijaya:12,"Viner Hand ITC":20,Vivaldi:12,"Vladimir Script":13,Vrinda:17,Webdings:29,"Wide Latin":36,Wingdings:39,"Wingdings 2":33,"Wingdings 3":26,"Yet R":16,"Yu Gothic":16,"Yu Gothic Light":16,"Yu Gothic Medium":16,"Yu Gothic UI":16,"Yu Gothic UI Light":15,"Yu Gothic UI Semibold":17,"Yu Gothic UI Semilight":16,"Yu Mincho":16,"Yu Mincho Demibold":15,"Yu Mincho Light":15,"":15,"":18,"":14,"":14,"":16,"":17,"":14,"":16,"":16,"":15,"":13,"":15,"":15,"":17," Light":17,"":15,"":15,"":16,"":15,"":15," Light":15,"":15,"":15,"":16," ":15," ":15,"":18,"HGE":15,"HGB":15,"HGM":15},24:{"Gill Sans MT":16,Abadi:19,"Abadi Extra Light":18,"Agency FB":14,Aharoni:13,Aldhabi:10,Algerian:19,"Ami R":13,"Angsana New":11,AngsanaUPC:11,Aparajita:13,"Arabic Typesetting":11,Arial:18,"Arial Black":21,"Arial Narrow":15,"Arial Nova":18,"Arial Nova Cond":16,"Arial Nova Cond Light":14,"Arial Nova Light":18,"Arial Rounded MT Bold":19,"Baskerville Old Face":16,Batang:19,BatangChe:16,"Bauhaus 93":18,"Bell MT":16,Bembo:16,"Berlin Sans FB":19,"Berlin Sans FB Demi":20,"Bernard MT Condensed":16,"Blackadder ITC":13,"Bodoni MT":16,"Bodoni MT Black":21,"Bodoni MT Condensed":11,"Bodoni MT Poster Compressed":9,"Book Antiqua":16,"Bookman Old Style":20,"Bookshelf Symbol 7":24,"Bradley Hand ITC":21,"Britannic Bold":20,Broadway:21,"Browallia New":12,BrowalliaUPC:12,"Brush Script MT":16,Calibri:16,"Calibri Light":16,"Californian FB":17,"Calisto MT":16,Cambria:18,"Cambria Math":18,Candara:18,Castellar:23,Centaur:16,Century:18,"Century Gothic":18,"Century Schoolbook":18,Chiller:15,"Colonna MT":16,"Comic Sans MS":20,Consolas:18,Constantia:17,"Cooper Black":19,"Copperplate Gothic Bold":23,"Copperplate Gothic Light":23,Corbel:17,"Cordia New":12,CordiaUPC:12,"Courier New":19,"Curlz MT":17,Dante:14,DaunPenh:11,David:14,DilleniaUPC:10,DokChampa:18,Dotum:19,DotumChe:16,Dubai:17,"Dubai Light":17,"Dubai Medium":17,Ebrima:17,"Edwardian Script ITC":15,Elephant:24,"Engravers MT":21,"Eras Bold ITC":21,"Eras Demi ITC":20,"Eras Light ITC":17,"Eras Medium ITC":18,EucrosiaUPC:13,Euphemia:19,"Expo M":28,FangSong:16,"Felix Titling":19,"Footlight MT Light":18,Forte:17,"Franklin Gothic Book":19,"Franklin Gothic Demi":19,"Franklin Gothic Demi Cond":16,"Franklin Gothic Heavy":19,"Franklin Gothic Medium":19,"Franklin Gothic Medium Cond":16,FrankRuehl:13,FreesiaUPC:14,"Freestyle Script":12,"French Script MT":12,Gabriola:13,Gadugi:17,Garamond:15,Gautami:19,Georgia:20,"Georgia Pro":18,"Georgia Pro Black":23,"Georgia Pro Cond":17,"Georgia Pro Cond Black":20,"Georgia Pro Cond Light":16,"Georgia Pro Cond Semibold":18,"Georgia Pro Light":18,"Georgia Pro Semibold":20,Gigi:17,"Gill Sans MT Condensed":12,"Gill Sans MT Ext Condensed Bold":11,"Gill Sans Nova":16,"Gill Sans Nova Cond":11,"Gill Sans Nova Cond Lt":10,"Gill Sans Nova Cond Ultra Bold":19,"Gill Sans Nova Cond XBd":17,"Gill Sans Nova Light":16,"Gill Sans Nova Ultra Bold":27,"Gill Sans Ultra Bold":27,"Gill Sans Ultra Bold Condensed":19,Gisha:17,"Gloucester MT Extra Condensed":12,"Goudy Old Style":16,"Goudy Stout":26,Grotesque:15,"Grotesque Light":15,Gulim:18,GulimChe:16,Gungsuh:19,GungsuhChe:16,"Hadassah Friedlaender":18,Haettenschweiler:14,"Harlow Solid Italic":15,Harrington:18,"Headline R":23,HGGothicE:16,HGGothicM:16,HGGyoshotai:16,HGKyokashotai:16,HGMaruGothicMPRO:24,HGMinchoB:17,HGMinchoE:17,HGPGothicE:18,HGPGothicM:20,HGPGyoshotai:16,HGPKyokashotai:16,HGPMinchoB:16,HGPMinchoE:18,HGPSoeiKakugothicUB:21,HGPSoeiKakupoptai:22,HGPSoeiPresenceEB:19,HGSeikaishotaiPRO:19,HGSGothicE:17,HGSGothicM:19,HGSGyoshotai:15,HGSKyokashotai:15,HGSMinchoB:16,HGSMinchoE:18,HGSoeiKakugothicUB:17,HGSoeiKakupoptai:17,HGSoeiPresenceEB:17,HGSSoeiKakugothicUB:20,HGSSoeiKakupoptai:21,HGSSoeiPresenceEB:18,"High Tower Text":15,"HYGothic-Extra":20,"HYGothic-Medium":19,"HYGraphic-Medium":19,"HYGungSo-Bold":19,"HYHeadLine-Medium":19,"HYMyeongJo-Extra":21,"HYPMokGak-Bold":23,"HYPost-Light":21,"HYPost-Medium":23,"HYShortSamul-Medium":12,"HYSinMyeongJo-Medium":20,Impact:17,"Imprint MT Shadow":16,"Informal Roman":17,"Ink Free":16,IrisUPC:16,"Iskoola Pota":16,JasmineUPC:15,"Javanese Text":19,Jokerman:23,"Juice ITC":11,KaiTi:16,Kalinga:18,Kartika:18,"Khmer UI":17,KodchiangUPC:11,Kokila:12,"Kristen ITC":19,"Kunstler Script":11,"Lao UI":17,Latha:16,Leelawadee:17,"Leelawadee UI":17,"Leelawadee UI Semilight":18,"Levenim MT":18,LilyUPC:14,"Lucida Bright":19,"Lucida Calligraphy":22,"Lucida Console":20,"Lucida Fax":21,"Lucida Handwriting":23,"Lucida Sans":21,"Lucida Sans Typewriter":19,"Lucida Sans Unicode":21,"Magic R":19,Magneto:25,"Maiandra GD":20,"Malgun Gothic":19,"Malgun Gothic Semilight":19,Mangal:18,Marlett:33,"Matura MT Script Capitals":22,Meiryo:22,"Meiryo UI":22,"Microsoft GothicNeo":17,"Microsoft Himalaya":12,"Microsoft JhengHei":19,"Microsoft JhengHei Light":19,"Microsoft JhengHei UI":19,"Microsoft JhengHei UI Light":19,"Microsoft New Tai Lue":18,"Microsoft PhagsPa":18,"Microsoft Sans Serif":19,"Microsoft Tai Le":18,"Microsoft Uighur":12,"Microsoft YaHei Light":19,"Microsoft YaHei UI":20,"Microsoft YaHei UI Light":19,"Microsoft Yi Baiti":17,MingLiU:17,MingLiU_HKSCS:17,"MingLiU_HKSCS-ExtB":17,"MingLiU-ExtB":17,Miriam:16,"Miriam Fixed":20,Mistral:15,"Modern No. 20":16,"MoeumT R":19,"Mongolian Baiti":17,"Monotype Corsiva":15,MoolBoran:12,"MS Gothic":17,"MS Mincho":17,"MS Outlook":17,"MS PGothic":17,"MS PMincho":17,"MS Reference Sans Serif":21,"MS Reference Specialty":39,"MS UI Gothic":17,"MT Extra":34,"MV Boli":23,"Myanmar Text":18,Narkisim:14,"Neue Haas Grotesk Text Pro":17,"New Gulim":19,"News Gothic MT":21,"Niagara Engraved":11,"Niagara Solid":11,"Nirmala UI":18,"Nirmala UI Semilight":19,Nyala:17,"OCR A Extended":20,OCRB:20,"Old English Text MT":17,Onyx:10,"Palace Script MT":11,"Palatino Linotype":16,Papyrus:20,Parchment:8,Perpetua:15,"Perpetua Titling MT":22,"Plantagenet Cherokee":18,Playbill:12,PMingLiU:16,"PMingLiU-ExtB":16,"Poor Richard":19,Pristina:16,"Pyunji R":17,Raavi:16,"Rage Italic":18,Ravie:31,Rockwell:17,"Rockwell Condensed":14,"Rockwell Extra Bold":22,"Rockwell Light":18,"Rockwell Nova":17,"Rockwell Nova Cond":17,"Rockwell Nova Cond Light":17,"Rockwell Nova Extra Bold":17,"Rockwell Nova Light":17,Rod:20,"Sakkal Majalla":13,"Sanskrit Text":19,"Script MT Bold":17,"Segoe MDL2 Assets":13,"Segoe Print":23,"Segoe Script":23,"Segoe UI":17,"Segoe UI Black":20,"Segoe UI Emoji":17,"Segoe UI Historic":17,"Segoe UI Light":16,"Segoe UI Semibold":18,"Segoe UI Semilight":17,"Segoe UI Symbol":17,Selawik:17,"Selawik Light":17,"Selawik Semibold":18,"Shonar Bangla":13,"Showcard Gothic":19,Shruti:19,"Simplified Arabic":17,"Simplified Arabic Fixed":19,"SimSun-ExtB":16,"Sitka Banner":16,"Sitka Display":17,"Sitka Heading":18,"Sitka Small":22,"Sitka Subheading":19,"Sitka Text":20,"Snap ITC":28,"Source Sans Pro":15,"Source Sans Pro Black":17,"Source Sans Pro ExtraLight":15,"Source Sans Pro Light":15,"Source Sans Pro SemiBold":16,Stencil:18,Sylfaen:16,Symbol:16,Tahoma:17,"Tempus Sans ITC":21,"TH SarabunPSK":12,"Times New Roman":16,"Traditional Arabic":16,"Trebuchet MS":17,Tunga:17,"Tw Cen MT":18,"Tw Cen MT Condensed":12,"Tw Cen MT Condensed Extra Bold":16,"UD Digi Kyokasho N-B":16,"UD Digi Kyokasho NK-B":16,"UD Digi Kyokasho NK-R":16,"UD Digi Kyokasho NP-B":23,"UD Digi Kyokasho NP-R":16,"UD Digi Kyokasho N-R":16,Univers:16,"Univers Condensed":16,"Univers Condensed Light":14,"Univers Light":16,"Urdu Typesetting":16,Utsaah:13,Vani:20,Verdana:20,"Verdana Pro":20,"Verdana Pro Black":16,"Verdana Pro Cond":16,"Verdana Pro Cond Black":16,"Verdana Pro Cond Light":16,"Verdana Pro Cond SemiBold":16,"Verdana Pro Light":16,"Verdana Pro SemiBold":16,Vijaya:13,"Viner Hand ITC":22,Vivaldi:14,"Vladimir Script":15,Vrinda:18,Webdings:32,"Wide Latin":40,Wingdings:43,"Wingdings 2":36,"Wingdings 3":29,"Yet R":17,"Yu Gothic":18,"Yu Gothic Light":17,"Yu Gothic Medium":18,"Yu Gothic UI":17,"Yu Gothic UI Light":17,"Yu Gothic UI Semibold":18,"Yu Gothic UI Semilight":18,"Yu Mincho":17,"Yu Mincho Demibold":17,"Yu Mincho Light":16,"":16,"":20,"":15,"":15,"":18,"":19,"":15,"":18,"":18,"":16,"":14,"":16,"":16,"":19," Light":18,"":16,"":16,"":18,"":16,"":17," Light":16,"":16,"":16,"":18," ":16," ":16,"":20,"HGE":16,"HGB":16,"HGM":16}},r.XFileConstants={xb:"_rels",yb:"/xl",zb:"[Content_Types].xml",Ab:"bin",Bb:"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings",Cb:"rels",Db:"application/vnd.openxmlformats-package.relationships+xml",Eb:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",Fb:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",Gb:"application/vnd.openxmlformats-officedocument.theme+xml",Hb:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",Ib:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",Jb:"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml",Kb:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",Lb:"application/vnd.openxmlformats-officedocument.drawing+xml",Mb:"application/vnd.openxmlformats-officedocument.drawingml.chart+xml",Ob:"application/vnd.ms-office.chartex+xml",Pb:"application/vnd.ms-office.chartstyle+xml",Qb:"application/vnd.ms-office.chartcolorstyle+xml",Rb:"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml",Sb:"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml",Tb:"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",Ub:"application/vnd.ms-office.drawingml.diagramDrawing+xml",Vb:"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml",Wb:"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml",Xb:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",Yb:"application/vnd.ms-excel.threadedcomments+xml",Zb:"application/vnd.ms-excel.person+xml",$b:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml",_b:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml",ac:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml",bc:"application/vnd.ms-excel.slicer+xml",cc:"application/vnd.ms-excel.slicerCache+xml",dc:"application/vnd.ms-office.vbaProject",ec:"application/vnd.openxmlformats-officedocument.vmlDrawing",fc:"application/vnd.ms-excel.controlproperties+xml",gc:"xml",hc:"vml",ic:"application/xml",jc:"jpg",kc:"image/jpg",lc:"jpeg",nc:"image/jpeg",oc:"svg",pc:"image/svg+xml",qc:"png",sc:"image/png",tc:"bmp",uc:"image/bmp",vc:"gif",wc:"image/gif",xc:"emf",yc:"image/x-emf",zc:"wmf",Ac:"image/x-wmf",Bc:"drawings",Cc:"vmlDrawing",Dc:"/xl/charts",Ec:"/xl/drawings",Fc:"/xl/persons",Gc:"/xl/media",Hc:"/xl/threadedComments",Ic:"/xl/worksheets",Jc:"/xl/tables",Kc:"/xl/slicers",Lc:"/xl/slicerCaches",Mc:"/xl/pivotCache",Nc:"/xl/pivotTables",Oc:"sheet",Pc:"comments",Qc:"chart",Rc:"chartEx",Sc:"style",Tc:"person",Uc:"colors",Vc:"drawing",Wc:"threadedComment",Xc:"image",Yc:"table",Zc:"slicer",$c:"slicerCache",_c:"pivotCacheDefinition",ad:"pivotCacheRecords",bd:"pivotTable",dd:"/xl/sharedStrings.xml",ed:"/xl/theme/theme1.xml",fd:"/xl/worksheets",hd:"/xl/workbook.xml",jd:"/docProps/core.xml",kd:"/docProps/app.xml",ld:"/docProps/custom.xml",md:"/xl/styles.xml",nd:"/xl/theme/theme1.xml",od:"metadata.xml",pd:"/xl/_rels/workbook.xml.rels",qd:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",rd:"http://schemas.openxmlformats.org/markup-compatibility/2006",sd:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",td:"http://schemas.openxmlformats.org/drawingml/2006/main",ud:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",vd:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",wd:"x14ac",xd:"x14ac xr xr2 xr3",yd:"xr",zd:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",Ad:"http://schemas.microsoft.com/office/spreadsheetml/2015/revision2",Bd:"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3",Cd:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",Dd:"http://schemas.openxmlformats.org/package/2006/content-types",Ed:"http://schemas.openxmlformats.org/package/2006/relationships",Fd:"http://schemas.openxmlformats.org/drawingml/2006/main",Gd:"http://schemas.microsoft.com/office/drawing/2010/main",Hd:"http://schemas.microsoft.com/office/drawing/2016/SVG/main",Jd:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",Kd:"http://schemas.microsoft.com/office/excel/2006/main",Ld:"http://schemas.openxmlformats.org/markup-compatibility/2006",Md:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Nd:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",Od:"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main",Pd:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",Qd:"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray",Rd:"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata",Sd:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Td:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Ud:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Vd:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Wd:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",Xd:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Yd:"http://purl.org/dc/elements/1.1/",Zd:"http://purl.org/dc/terms/",$d:"http://purl.org/dc/dcmitype/",_d:"http://www.w3.org/2001/XMLSchema-instance",ae:"application/vnd.openxmlformats-package.core-properties+xml",be:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",ce:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",de:"application/vnd.openxmlformats-officedocument.extended-properties+xml",ee:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",fe:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",ge:"application/vnd.openxmlformats-officedocument.custom-properties+xml"},(y=r.FontLanguage||(r.FontLanguage={}))[y.latin=0]="latin",y[y.cs=1]="cs",y[y.ea=2]="ea",y[y.sym=3]="sym",n=function(e,t){this.row=e,this.col=t},r.ExcelCell=n,o=function(e){this.index=e},r.ExcelColumn=o,i=function(e){this.index=e},r.ExcelRow=i,a=function(e,t,r){this.name=e,this.colorScheme=t,this.fontScheme=r},r.ExcelTheme=a,u=function(e,t){this.name=e,this.schemeColors=t},r.ColorScheme=u,c=function(e,t,r){this.name=e,this.majorFont=t,this.minorFont=r},r.FontScheme=c,h=function(e,t){this.script=e,this.typeface=t},r.ThemeFont=h,f=function(e,t){this.runFormattings=e,this.themesFonts=t},r.ThemeFonts=f,d=function(e,t){this.fontLanguage=e,this.typeface=t},r.RunFormatting=d,p=function(){},r.SheetInfo=p,g=function(){},r.DefaultContentType=g,m=function(){},r.OverrideContentType=m,b=function(){},w.prototype.he=function(e){if(!e)return"";var t=r.RelationshipConstants.La+ ++this.relationFiles.count;return this.relationFiles[t]=e,t},w.prototype.ie=function(e){var t,r,n,o,i,a;if(e&&(t=this.je(this.fileName,e)))for(r=0,n=t.length;r<n;r++)i=(o=t[r]).target,"hyperlink"===o.type.substring(o.type.length-"hyperlink".length,o.type.length)||(i="/"!==i[0]?s.Util.ua(this.fileName,i):i.substr(1)),(a=new w(i,o.type)).ie(e),this.relationFiles[o.id]||this.relationFiles.count++,this.relationFiles[o.id]=a},w.prototype.je=function(e,t){if(null===e||!t)return null;var r=this.ke(e);return r?this.le(t[r.toLowerCase()]):null},w.prototype.ke=function(e){return null==e?"":0===e.length?r.XFileConstants.xb+"/."+r.XFileConstants.Cb:e.substring("/"===e.charAt(0)?1:0,e.lastIndexOf("/"))+"/"+r.XFileConstants.xb+"/"+e.substring(e.lastIndexOf("/")+1)+"."+r.XFileConstants.Cb},w.prototype.me=function(e){var t,r;if(!this.relationFiles||0===this.relationFiles.count)return null;if(s.StringEx.q(e))return null;for(t in this.relationFiles)if("count"!==t&&(r=this.relationFiles[t]).fileType===e)return r;return null},w.prototype.ne=function(e){var t,r,n;if(!this.relationFiles||0===this.relationFiles.count)return null;if(s.StringEx.q(e))return null;for(r in t=[],this.relationFiles)"count"!==r&&(n=this.relationFiles[r]).fileType===e&&t.push({id:r,file:n});return t},w.prototype.oe=function(e){return!this.relationFiles||0===this.relationFiles.count||s.StringEx.C(e)?null:this.relationFiles[e]},w.prototype.le=function(e){var t,r,n,o,i,a,s;if(e){if(t=[],r=l.parseXmlToObject(e).Relationships)for(n=r.Relationship,Array.isArray(n)||(n=[n]),o=0,i=n.length;o<i;o++)(a=n[o])&&(s=new b,a.pe.Id&&(s.id=a.pe.Id),a.pe.Target&&(s.target=a.pe.Target),a.pe.Type&&(s.type=a.pe.Type),t.push(s));return t}},r.XFile=w,r.PivotSharedItemType={B:"b",D:"d",E:"e",M:"m",N:"n",S:"s",X:"x"}},"./src/common/range-parser.ts":function(e,t,r){"use strict";var h,f;Object.defineProperty(t,"__esModule",{value:!0}),h=r("./src/common/common.ts"),f=r("./src/common/excel-types.ts"),t.getRangesFromString=function(e,r){var n=[];return null===e||e.replace(/('.+')/g,"").split(" ").forEach(function(e){var t=function(e,t){var r,n,o,i,a,s,l,u={},c=e.indexOf("!");if(-1<c&&(e=e.substr(c+1)),1===(r=(r=e.split("$").join("")).split(":")).length){if(s=r[0],n=h.IndexHelper.F(s),o=h.IndexHelper.G(s),-1===n&&-1===o)return null;u.row=n,u.col=o,u.rowCount=1,u.colCount=1}else 2===r.length&&(s=r[0],l=r[1],n=h.IndexHelper.F(s),o=h.IndexHelper.G(s),i=h.IndexHelper.F(l),a=h.IndexHelper.G(l),u.row=n,u.col=o,u.rowCount=i-n+1,u.colCount=a-o+1,t||0!==n||u.rowCount!==f.ExcelConstants.sb||(u.row=-1,u.rowCount=-1),t||0!==o||u.colCount!==f.ExcelConstants.rb||(u.col=-1,u.colCount=-1));return u}(e,r);!t||t.row>f.ExcelConstants.sb||t.col>f.ExcelConstants.rb||t.rowCount>f.ExcelConstants.sb||t.col>f.ExcelConstants.rb||n.push(t)}),n},t.getRangeString=function(e){var t,r,n,o,i,a,s,l=[];for(t=0;t<e.length;t++)r=e[t],h.isRangeWholeRow(r)&&(r.col=0,r.colCount=f.ExcelConstants.rb),h.isRangeWholeColumn(r)&&(r.row=0,r.rowCount=f.ExcelConstants.sb),n=r.row,o=r.row+r.rowCount-1,i=r.col,a=r.col+r.colCount-1,s=h.IndexHelper.I(i)+(n+1),(1<r.rowCount||1<r.colCount)&&(s+=":"+h.IndexHelper.I(a)+(1+o)),l.push(s);return l.join(" ")}},"./src/common/tuple.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(){var e,t,r,n=[];for(e=0;e<arguments.length;e++)n[e]=arguments[e];for(this.equals=function(e){var t,r,n,o;for(t=1,r=this.count;t<=r;t++)if(n=this["item"+t],o=e["item"+t],!(n.equals&&n.equals(o)||n===o))return!1;return!0},t=n.length,r=1;r<=t;r++)this["item"+r]=n[r-1];this.count=t}t.Tuple=n},"./src/datamodel/chart-model.ts":function(e,t,r){"use strict";var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,Ee,Re,De,Ne,Fe,_e,Pe,Le,Oe,Be,je,He;function Ge(e){for(var t in e)void 0!==e[t]&&(e[e[t]]=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Charts={},Ge(n={major:0,minor:1,none:2}),t.Charts.ST_FontCollectionIndex=n,Ge(o={dk1:0,lt1:1,dk2:2,lt2:3,accent1:4,accent2:5,accent3:6,accent4:7,accent5:8,accent6:9,hlink:10,folHlink:11}),t.Charts.ST_ColorSchemeIndex=o,Ge(i={scrollBar:0,background:1,activeCaption:2,inactiveCaption:3,menu:4,window:5,windowFrame:6,menuText:7,windowText:8,captionText:9,activeBorder:10,inactiveBorder:11,appWorkspace:12,highlight:13,highlightText:14,btnFace:15,btnShadow:16,grayText:17,btnText:18,inactiveCaptionText:19,btnHighlight:20,Item3dDkShadow:21,Item3dLight:22,infoText:23,infoBk:24,hotLight:25,gradientActiveCaption:26,gradientInactiveCaption:27,menuHighlight:28,menuBar:29}),t.Charts.ST_SystemColorVal=i,Ge(a={bg1:0,tx1:1,bg2:2,tx2:3,accent1:4,accent2:5,accent3:6,accent4:7,accent5:8,accent6:9,hlink:10,folHlink:11,phClr:12,dk1:13,lt1:14,dk2:15,lt2:16}),t.Charts.ST_SchemeColorVal=a,Ge(s={aliceBlue:0,antiqueWhite:1,aqua:2,aquamarine:3,azure:4,beige:5,bisque:6,black:7,blanchedAlmond:8,blue:9,blueViolet:10,brown:11,burlyWood:12,cadetBlue:13,chartreuse:14,chocolate:15,coral:16,cornflowerBlue:17,cornsilk:18,crimson:19,cyan:20,darkBlue:21,darkCyan:22,darkGoldenrod:23,darkGray:24,darkGreen:25,darkGrey:26,darkKhaki:27,darkMagenta:28,darkOliveGreen:29,darkOrange:30,darkOrchid:31,darkRed:32,darkSalmon:33,darkSeaGreen:34,darkSlateBlue:35,darkSlateGray:36,darkSlateGrey:37,darkTurquoise:38,darkViolet:39,deepPink:40,deepSkyBlue:41,dimGray:42,dimGrey:43,dkBlue:44,dkCyan:45,dkGoldenrod:46,dkGray:47,dkGreen:48,dkGrey:49,dkKhaki:50,dkMagenta:51,dkOliveGreen:52,dkOrange:53,dkOrchid:54,dkRed:55,dkSalmon:56,dkSeaGreen:57,dkSlateBlue:58,dkSlateGray:59,dkSlateGrey:60,dkTurquoise:61,dkViolet:62,dodgerBlue:63,firebrick:64,floralWhite:65,forestGreen:66,fuchsia:67,gainsboro:68,ghostWhite:69,gold:70,goldenrod:71,gray:72,green:73,greenYellow:74,grey:75,honeydew:76,hotPink:77,indianRed:78,indigo:79,ivory:80,khaki:81,lavender:82,lavenderBlush:83,lawnGreen:84,lemonChiffon:85,lightBlue:86,lightCoral:87,lightCyan:88,lightGoldenrodYellow:89,lightGray:90,lightGreen:91,lightGrey:92,lightPink:93,lightSalmon:94,lightSeaGreen:95,lightSkyBlue:96,lightSlateGray:97,lightSlateGrey:98,lightSteelBlue:99,lightYellow:100,lime:101,limeGreen:102,linen:103,ltBlue:104,ltCoral:105,ltCyan:106,ltGoldenrodYellow:107,ltGray:108,ltGreen:109,ltGrey:110,ltPink:111,ltSalmon:112,ltSeaGreen:113,ltSkyBlue:114,ltSlateGray:115,ltSlateGrey:116,ltSteelBlue:117,ltYellow:118,magenta:119,maroon:120,medAquamarine:121,medBlue:122,mediumAquamarine:123,mediumBlue:124,mediumOrchid:125,mediumPurple:126,mediumSeaGreen:127,mediumSlateBlue:128,mediumSpringGreen:129,mediumTurquoise:130,mediumVioletRed:131,medOrchid:132,medPurple:133,medSeaGreen:134,medSlateBlue:135,medSpringGreen:136,medTurquoise:137,medVioletRed:138,midnightBlue:139,mintCream:140,mistyRose:141,moccasin:142,navajoWhite:143,navy:144,oldLace:145,olive:146,oliveDrab:147,orange:148,orangeRed:149,orchid:150,paleGoldenrod:151,paleGreen:152,paleTurquoise:153,paleVioletRed:154,papayaWhip:155,peachPuff:156,peru:157,pink:158,plum:159,powderBlue:160,purple:161,red:162,rosyBrown:163,royalBlue:164,saddleBrown:165,salmon:166,sandyBrown:167,seaGreen:168,seaShell:169,sienna:170,silver:171,skyBlue:172,slateBlue:173,slateGray:174,slateGrey:175,snow:176,springGreen:177,steelBlue:178,tan:179,teal:180,thistle:181,tomato:182,turquoise:183,violet:184,wheat:185,white:186,whiteSmoke:187,yellow:188,yellowGreen:189}),t.Charts.ST_PresetColorVal=s,Ge(l={tl:0,t:1,tr:2,l:3,ctr:4,r:5,bl:6,b:7,br:8}),t.Charts.ST_RectAlignment=l,Ge(u={clr:0,auto:1,gray:2,ltGray:3,invGray:4,grayWhite:5,blackGray:6,blackWhite:7,black:8,white:9,hidden:10}),t.Charts.ST_BlackWhiteMode=u,Ge(c={inner:0,outer:1}),t.Charts.ST_LayoutTarget=c,Ge(h={edge:0,factor:1}),t.Charts.ST_LayoutMode=h,Ge(f={area:0,w:1}),t.Charts.ST_SizeRepresents=f,Ge(d={auto:0,cust:1,percent:2,pos:3,val:4}),t.Charts.ST_SplitType=d,Ge(p={ctr:0,l:1,r:2}),t.Charts.ST_LblAlgn=p,Ge(g={bestFit:0,b:1,ctr:2,inBase:3,inEnd:4,l:5,outEnd:6,r:7,t:8}),t.Charts.ST_DLblPos=g,Ge(m={circle:0,dash:1,diamond:2,dot:3,none:4,picture:5,plus:6,square:7,star:8,triangle:9,x:10}),t.Charts.ST_MarkerStyle=m,Ge(b={exp:0,linear:1,log:2,movingAvg:3,poly:4,power:5}),t.Charts.ST_TrendlineType=b,Ge(y={x:0,y:1}),t.Charts.ST_ErrDir=y,Ge(C={both:0,minus:1,plus:2}),t.Charts.ST_ErrBarType=C,Ge(w={cust:0,fixedVal:1,percentage:2,stdDev:3,stdErr:4}),t.Charts.ST_ErrValType=w,Ge(v={percentStacked:0,standard:1,stacked:2}),t.Charts.ST_Grouping=v,Ge(S={none:0,line:1,lineMarker:2,marker:3,smooth:4,smoothMarker:5}),t.Charts.ST_ScatterStyle=S,Ge(x={standard:0,marker:1,filled:2}),t.Charts.ST_RadarStyle=x,Ge(T={percentStacked:0,clustered:1,standard:2,stacked:3}),t.Charts.ST_BarGrouping=T,Ge(A={bar:0,col:1}),t.Charts.ST_BarDir=A,Ge(k={cone:0,coneToMax:1,box:2,cylinder:3,pyramid:4,pyramidToMax:5}),t.Charts.ST_Shape=k,Ge(M={pie:0,bar:1}),t.Charts.ST_OfPieType=M,Ge(I={b:0,l:1,r:2,t:3}),t.Charts.ST_AxPos=I,Ge(E={autoZero:0,max:1,min:2}),t.Charts.ST_Crosses=E,Ge(R={between:0,midCat:1}),t.Charts.ST_CrossBetween=R,Ge(D={cross:0,in:1,none:2,out:3}),t.Charts.ST_TickMark=D,Ge(N={high:0,low:1,nextTo:2,none:3}),t.Charts.ST_TickLblPos=N,Ge(F={days:0,months:1,years:2}),t.Charts.ST_TimeUnit=F,Ge(_={hundreds:0,thousands:1,tenThousands:2,hundredThousands:3,millions:4,tenMillions:5,hundredMillions:6,billions:7,trillions:8}),t.Charts.ST_BuiltInUnit=_,Ge(P={stretch:0,stack:1,stackScale:2}),t.Charts.ST_PictureFormat=P,Ge(L={maxMin:0,minMax:1}),t.Charts.ST_Orientation=L,Ge(O={b:0,tr:1,l:2,r:3,t:4}),t.Charts.ST_LegendPos=O,Ge(B={span:0,gap:1,zero:2}),t.Charts.ST_DispBlanksAs=B,Ge(j={default:0,portrait:1,landscape:2}),t.Charts.ST_PageSetupOrientation=j,Ge(H={legacyObliqueTopLeft:0,legacyObliqueTop:1,legacyObliqueTopRight:2,legacyObliqueLeft:3,legacyObliqueFront:4,legacyObliqueRight:5,legacyObliqueBottomLeft:6,legacyObliqueBottom:7,legacyObliqueBottomRight:8,legacyPerspectiveTopLeft:9,legacyPerspectiveTop:10,legacyPerspectiveTopRight:11,legacyPerspectiveLeft:12,legacyPerspectiveFront:13,legacyPerspectiveRight:14,legacyPerspectiveBottomLeft:15,legacyPerspectiveBottom:16,legacyPerspectiveBottomRight:17,orthographicFront:18,isometricTopUp:19,isometricTopDown:20,isometricBottomUp:21,isometricBottomDown:22,isometricLeftUp:23,isometricLeftDown:24,isometricRightUp:25,isometricRightDown:26,isometricOffAxis1Left:27,isometricOffAxis1Right:28,isometricOffAxis1Top:29,isometricOffAxis2Left:30,isometricOffAxis2Right:31,isometricOffAxis2Top:32,isometricOffAxis3Left:33,isometricOffAxis3Right:34,isometricOffAxis3Bottom:35,isometricOffAxis4Left:36,isometricOffAxis4Right:37,isometricOffAxis4Bottom:38,obliqueTopLeft:39,obliqueTop:40,obliqueTopRight:41,obliqueLeft:42,obliqueRight:43,obliqueBottomLeft:44,obliqueBottom:45,obliqueBottomRight:46,perspectiveFront:47,perspectiveLeft:48,perspectiveRight:49,perspectiveAbove:50,perspectiveBelow:51,perspectiveAboveLeftFacing:52,perspectiveAboveRightFacing:53,perspectiveContrastingLeftFacing:54,perspectiveContrastingRightFacing:55,perspectiveHeroicLeftFacing:56,perspectiveHeroicRightFacing:57,perspectiveHeroicExtremeLeftFacing:58,perspectiveHeroicExtremeRightFacing:59,perspectiveRelaxed:60,perspectiveRelaxedModerately:61}),t.Charts.ST_PresetCameraType=H,Ge(G={tl:0,t:1,tr:2,l:3,r:4,bl:5,b:6,br:7}),t.Charts.ST_LightRigDirection=G,Ge(U={legacyFlat1:0,legacyFlat2:1,legacyFlat3:2,legacyFlat4:3,legacyNormal1:4,legacyNormal2:5,legacyNormal3:6,legacyNormal4:7,legacyHarsh1:8,legacyHarsh2:9,legacyHarsh3:10,legacyHarsh4:11,threePt:12,balanced:13,soft:14,harsh:15,flood:16,contrasting:17,morning:18,sunrise:19,sunset:20,chilly:21,freezing:22,flat:23,twoPt:24,glow:25,brightRoom:26}),t.Charts.ST_LightRigType=U,Ge(W={relaxedInset:0,circle:1,slope:2,cross:3,angle:4,softRound:5,convex:6,coolSlant:7,divot:8,riblet:9,hardEdge:10,artDeco:11}),t.Charts.ST_BevelPresetType=W,Ge(V={legacyMatte:0,legacyPlastic:1,legacyMetal:2,legacyWireframe:3,matte:4,plastic:5,metal:6,warmMatte:7,translucentPowder:8,powder:9,dkEdge:10,softEdge:11,clear:12,flat:13,softmetal:14}),t.Charts.ST_PresetMaterialType=V,Ge(z={shdw1:0,shdw2:1,shdw3:2,shdw4:3,shdw5:4,shdw6:5,shdw7:6,shdw8:7,shdw9:8,shdw10:9,shdw11:10,shdw12:11,shdw13:12,shdw14:13,shdw15:14,shdw16:15,shdw17:16,shdw18:17,shdw19:18,shdw20:19}),t.Charts.ST_PresetShadowVal=z,Ge(q={shape:0,circle:1,rect:2}),t.Charts.ST_PathShadeType=q,Ge(Z={none:0,x:1,y:2,xy:3}),t.Charts.ST_TileFlipMode=Z,Ge(Y={email:0,screen:1,print:2,hqprint:3,none:4}),t.Charts.ST_BlipCompression=Y,Ge(K={pct5:0,pct10:1,pct20:2,pct25:3,pct30:4,pct40:5,pct50:6,pct60:7,pct70:8,pct75:9,pct80:10,pct90:11,horz:12,vert:13,ltHorz:14,ltVert:15,dkHorz:16,dkVert:17,narHorz:18,narVert:19,dashHorz:20,dashVert:21,cross:22,dnDiag:23,upDiag:24,ltDnDiag:25,ltUpDiag:26,dkDnDiag:27,dkUpDiag:28,wdDnDiag:29,wdUpDiag:30,dashDnDiag:31,dashUpDiag:32,diagCross:33,smCheck:34,lgCheck:35,smGrid:36,lgGrid:37,dotGrid:38,smConfetti:39,lgConfetti:40,horzBrick:41,diagBrick:42,solidDmnd:43,openDmnd:44,dotDmnd:45,plaid:46,sphere:47,weave:48,divot:49,shingle:50,wave:51,trellis:52,zigZag:53}),t.Charts.ST_PresetPatternVal=K,Ge(X={png:0,jpg:1,jpeg:2,emf:3}),t.Charts.ST_BobType=X,Ge(J={over:0,mult:1,screen:2,darken:3,lighten:4}),t.Charts.ST_BlendMode=J,Ge(Q={sib:0,tree:1}),t.Charts.ST_EffectContainerType=Q,t.Charts.ST_PathToType={PathLine:0,PathMove:1,PathQuadBez:2,PathCubicBez:3},Ge($={line:0,lineInv:1,triangle:2,rtTriangle:3,rect:4,diamond:5,parallelogram:6,trapezoid:7,nonIsoscelesTrapezoid:8,pentagon:9,hexagon:10,heptagon:11,octagon:12,decagon:13,dodecagon:14,star4:15,star5:16,star6:17,star7:18,star8:19,star10:20,star12:21,star16:22,star24:23,star32:24,roundRect:25,round1Rect:26,round2SameRect:27,round2DiagRect:28,snipRoundRect:29,snip1Rect:30,snip2SameRect:31,snip2DiagRect:32,plaque:33,ellipse:34,teardrop:35,homePlate:36,chevron:37,pieWedge:38,pie:39,blockArc:40,donut:41,noSmoking:42,rightArrow:43,leftArrow:44,upArrow:45,downArrow:46,stripedRightArrow:47,notchedRightArrow:48,bentUpArrow:49,leftRightArrow:50,upDownArrow:51,leftUpArrow:52,leftRightUpArrow:53,quadArrow:54,leftArrowCallout:55,rightArrowCallout:56,upArrowCallout:57,downArrowCallout:58,leftRightArrowCallout:59,upDownArrowCallout:60,quadArrowCallout:61,bentArrow:62,uturnArrow:63,circularArrow:64,leftCircularArrow:65,leftRightCircularArrow:66,curvedRightArrow:67,curvedLeftArrow:68,curvedUpArrow:69,curvedDownArrow:70,swooshArrow:71,cube:72,can:73,lightningBolt:74,heart:75,sun:76,moon:77,smileyFace:78,irregularSeal1:79,irregularSeal2:80,foldedCorner:81,bevel:82,frame:83,halfFrame:84,corner:85,diagStripe:86,chord:87,arc:88,leftBracket:89,rightBracket:90,leftBrace:91,rightBrace:92,bracketPair:93,bracePair:94,straightConnector1:95,bentConnector2:96,bentConnector3:97,bentConnector4:98,bentConnector5:99,curvedConnector2:100,curvedConnector3:101,curvedConnector4:102,curvedConnector5:103,callout1:104,callout2:105,callout3:106,accentCallout1:107,accentCallout2:108,accentCallout3:109,borderCallout1:110,borderCallout2:111,borderCallout3:112,accentBorderCallout1:113,accentBorderCallout2:114,accentBorderCallout3:115,wedgeRectCallout:116,wedgeRoundRectCallout:117,wedgeEllipseCallout:118,cloudCallout:119,cloud:120,ribbon:121,ribbon2:122,ellipseRibbon:123,ellipseRibbon2:124,leftRightRibbon:125,verticalScroll:126,horizontalScroll:127,wave:128,doubleWave:129,plus:130,flowChartProcess:131,flowChartDecision:132,flowChartInputOutput:133,flowChartPredefinedProcess:134,flowChartInternalStorage:135,flowChartDocument:136,flowChartMultidocument:137,flowChartTerminator:138,flowChartPreparation:139,flowChartManualInput:140,flowChartManualOperation:141,flowChartConnector:142,flowChartPunchedCard:143,flowChartPunchedTape:144,flowChartSummingJunction:145,flowChartOr:146,flowChartCollate:147,flowChartSort:148,flowChartExtract:149,flowChartMerge:150,flowChartOfflineStorage:151,flowChartOnlineStorage:152,flowChartMagneticTape:153,flowChartMagneticDisk:154,flowChartMagneticDrum:155,flowChartDisplay:156,flowChartDelay:157,flowChartAlternateProcess:158,flowChartOffpageConnector:159,actionButtonBlank:160,actionButtonHome:161,actionButtonHelp:162,actionButtonInformation:163,actionButtonForwardNext:164,actionButtonBackPrevious:165,actionButtonEnd:166,actionButtonBeginning:167,actionButtonReturn:168,actionButtonDocument:169,actionButtonSound:170,actionButtonMovie:171,gear6:172,gear9:173,funnel:174,mathPlus:175,mathMinus:176,mathMultiply:177,mathDivide:178,mathEqual:179,mathNotEqual:180,cornerTabs:181,squareTabs:182,plaqueTabs:183,chartX:184,chartStar:185,chartPlus:186}),t.Charts.ST_ShapeType=$,Ge(ee={textNoShape:0,textPlain:1,textStop:2,textTriangle:3,textTriangleInverted:4,textChevron:5,textChevronInverted:6,textRingInside:7,textRingOutside:8,textArchUp:9,textArchDown:10,textCircle:11,textButton:12,textArchUpPour:13,textArchDownPour:14,textCirclePour:15,textButtonPour:16,textCurveUp:17,textCurveDown:18,textCanUp:19,textCanDown:20,textWave1:21,textWave2:22,textDoubleWave1:23,textWave4:24,textInflate:25,textDeflate:26,textInflateBottom:27,textDeflateBottom:28,textInflateTop:29,textDeflateTop:30,textDeflateInflate:31,textDeflateInflateDeflate:32,textFadeRight:33,textFadeLeft:34,textFadeUp:35,textFadeDown:36,textSlantUp:37,textSlantDown:38,textCascadeUp:39,textCascadeDown:40}),t.Charts.ST_TextShapeType=ee,Ge(te={none:0,norm:1,lighten:2,lightenLess:3,darken:4,darkenLess:5}),t.Charts.ST_PathFillMode=te,Ge(re={none:0,triangle:1,stealth:2,diamond:3,oval:4,arrow:5}),t.Charts.ST_LineEndType=re,Ge(ne={sm:0,med:1,lg:2}),t.Charts.ST_LineEndWidth=ne,Ge(oe={sm:0,med:1,lg:2}),t.Charts.ST_LineEndLength=oe,Ge(ie={solid:0,dot:1,dash:2,lgDash:3,dashDot:4,lgDashDot:5,lgDashDotDot:6,sysDash:7,sysDot:8,sysDashDot:9,sysDashDotDot:10}),t.Charts.ST_PresetLineDashVal=ie,Ge(ae={rnd:0,sq:1,flat:2}),t.Charts.ST_LineCap=ae,Ge(se={ctr:0,in:1}),t.Charts.ST_PenAlignment=se,Ge(le={sng:0,dbl:1,thickThin:2,thinThick:3,tri:4}),t.Charts.ST_CompoundLine=le,Ge(ue={twoCell:0,oneCell:1,absolute:2}),t.Charts.ST_EditAs=ue,Ge(ce={t:0,ctr:1,b:2,just:3,dist:4}),t.Charts.ST_TextAnchoringType=ce,Ge(he={overflow:0,ellipsis:1,clip:2}),t.Charts.ST_TextVertOverflowType=he,Ge(fe={overflow:0,clip:1}),t.Charts.ST_TextHorzOverflowType=fe,Ge(de={horz:0,vert:1,vert270:2,wordArtVert:3,eaVert:4,mongolianVert:5,wordArtVertRtl:6}),t.Charts.ST_TextVerticalType=de,Ge(pe={none:0,square:1}),t.Charts.ST_TextWrappingType=pe,Ge(ge={alphaLcParenBoth:0,alphaUcParenBoth:1,alphaLcParenR:2,alphaUcParenR:3,alphaLcPeriod:4,alphaUcPeriod:5,arabicParenBoth:6,arabicParenR:7,arabicPeriod:8,arabicPlain:9,romanLcParenBoth:10,romanUcParenBoth:11,romanLcParenR:12,romanUcParenR:13,romanLcPeriod:14,romanUcPeriod:15,circleNumDbPlain:16,circleNumWdBlackPlain:17,circleNumWdWhitePlain:18,arabicDbPeriod:19,arabicDbPlain:20,ea1ChsPeriod:21,ea1ChsPlain:22,ea1ChtPeriod:23,ea1ChtPlain:24,ea1JpnChsDbPeriod:25,ea1JpnKorPlain:26,ea1JpnKorPeriod:27,arabic1Minus:28,arabic2Minus:29,hebrew2Minus:30,thaiAlphaPeriod:31,thaiAlphaParenR:32,thaiAlphaParenBoth:33,thaiNumPeriod:34,thaiNumParenR:35,thaiNumParenBoth:36,hindiAlphaPeriod:37,hindiNumPeriod:38,hindiNumParenR:39,hindiAlpha1Period:40}),t.Charts.ST_TextAutonumberScheme=ge,Ge(me={none:0,words:1,sng:2,dbl:3,heavy:4,dotted:5,dottedHeavy:6,dash:7,dashHeavy:8,dashLong:9,dashLongHeavy:10,dotDash:11,dotDashHeavy:12,dotDotDash:13,dotDotDashHeavy:14,wavy:15,wavyHeavy:16,wavyDbl:17}),t.Charts.ST_TextUnderlineType=me,Ge(be={noStrike:0,sngStrike:1,dblStrike:2}),t.Charts.ST_TextStrikeType=be,Ge(ye={none:0,small:1,all:2}),t.Charts.ST_TextCapsType=ye,Ge(Ce={l:0,ctr:1,r:2,dec:3}),t.Charts.ST_TextTabAlignType=Ce,Ge(we={l:0,ctr:1,r:2,just:3,justLow:4,dist:5,thaiDist:6}),t.Charts.ST_TextAlignType=we,Ge(ve={auto:0,t:1,ctr:2,base:3,b:4}),t.Charts.ST_TextFontAlignType=ve,Ge(Se={auto:0}),t.Charts.ST_StyleColorVal=Se,t.Charts.CT_PathType={CT_PathToList:0,CT_Path2DArcTo:1,CT_Path2DClose:2},Ge(xe={col:0,row:1}),t.Charts.ST_FormulaDirection=xe,Ge(Te={cat:0,colorStr:1}),t.Charts.ST_StringDimensionType=Te,Ge(Ae={val:0,x:1,y:2,size:3,colorVal:4}),t.Charts.ST_NumericDimensionType=Ae,Ge(ke={l:0,t:1,r:2,b:3}),t.Charts.ST_SidePos=ke,Ge(Me={t:1,r:2,l:3,b:4}),t.Charts.ST_2016ChartPosLegend=Me,Ge(Ie={min:0,ctr:1,max:2}),t.Charts.ST_PosAlign=Ie,Ge(Ee={hundreds:0,thousands:1,tenThousands:2,hundredThousands:3,millions:4,tenMillions:5,hundredMillions:6,billions:7,trillions:8,percentage:9}),t.Charts.ST_AxisUnit=Ee,Ge(Re={in:1,out:3,cross:0,none:2}),t.Charts.ST_TickMarksType=Re,Ge(De={boxWhisker:0,funnel:1,paretoLine:2,regionMap:3,sunburst:4,treemap:5,waterfall:6,clusteredColumn:7}),t.Charts.ST_SeriesLayout=De,Ge(Ne={none:0,banner:1,overlapping:2}),t.Charts.ST_ParentLabelLayout=Ne,Ge(Fe={none:0,bestFitOnly:1,showAll:2}),t.Charts.ST_RegionLabelLayout=Fe,Ge(_e={l:0,r:1}),t.Charts.ST_IntervalClosedSide=_e,Ge(Pe={Address:0,AdminDistrict:1,AdminDistrict2:2,AdminDistrict3:3,Continent:4,CountryRegion:5,Locality:6,Ocean:7,Planet:8,PostalCode:9,Region:10,Unsupported:11}),t.Charts.ST_EntityType=Pe,Ge(Le={mercator:0,miller:1,robinson:2,albers:3}),t.Charts.ST_GeoProjectionType=Le,Ge(Oe={dataOnly:0,postalCode:1,county:2,state:3,countryRegion:4,countryRegionList:5,world:6}),t.Charts.ST_GeoMappingLevel=Oe,Ge(Be={inclusive:0,exclusive:1}),t.Charts.ST_QuartileMethod=Be,Ge(je={bestFit:0,b:1,ctr:2,inBase:3,inEnd:4,l:5,outEnd:6,r:7,t:8}),t.Charts.ST_DataLabelPos=je,Ge(He={default:0,portrait:1,landscape:2}),t.Charts.ST_PageOrientation=He},"./src/datamodel/datamodel-reader.ts":function(e,t,r){"use strict";var x,l,T,c,p,a,n,h,o,w,A,k,f,i;function v(e,t,r,n,o,i){var a,s,l,u,c=e.itemsData;c&&(a=c[c.length-1],s=c[c.length-2],l=a&&a.info,u=s&&s.info,l&&(n&&o&&1===a.count?u&&s.index===a.index-1&&u.level===l.level-1?u.collapsed=!0:0<t?c.splice(c.length-2,0,{index:a.index-1,count:1,info:{level:l.level-1,collapsed:!0}}):e.head={collapsed:!0,level:r-1}:!n&&i&&(u&&a.index===s.index+1&&l.level===u.level-1?a.collapsed=!0:t>=a.index+a.count&&c.push({index:a.index+a.count,count:1,info:{level:l.level-1,collapsed:!0}}))))}function M(e,t,r,n,o,i,a,s,l,u){var c={};return c.conType=e,x.k(t)||(c.compareType=t),x.k(r)||(c.expected=r),x.k(n)||(c.ignoreBlank=n),x.k(o)||(c.type=o),x.k(i)||(c.isPercent=i),x.k(a)||(c.item1=a),x.k(s)||(c.item2=s),x.k(l)||(c.ranges=l),x.k(u)||(c.expectTypeId=u),2===e&&(c.ignoreCase=!0),c}function I(e,a){var t;function r(e){var t,r="notEqual"===e.operator,n=e.value,o=n.indexOf("*"),i=n.lastIndexOf("*");return-1!==o?o===n.length-1&&0!==o?M(2,r?3:2,n.substring(0,n.length-1)):0===o&&o===i?M(2,r?5:4,n.substring(1)):(t=r?7:6,-1!==o&&-1!==i&&(n=n.substr(1,n.length-2)),M(2,t,n)):function(e,t,r){var n,o,i={none:0,equal:0,lessThan:4,lessThanOrEqual:5,notEqual:1,greaterThan:2,greaterThanOrEqual:3};switch(e){case"string":n=2;break;case"number":n=1,r=parseFloat(r);break;case"date":n=5,r="string"==typeof r&&0===r.indexOf("/OADate(")?(o=parseInt(r.replace("/OADate(",""),10),p.DateTimeHelper.se(o)):p.DateTimeHelper.se(parseInt(r,10)),i={none:0,equal:0,lessThan:2,lessThanOrEqual:3,notEqual:1,greaterThan:4,greaterThanOrEqual:5};break;case"boolean":default:n=11}return M(n,i[t||!0],r)}(function(e){if(0<e.length){var t=e[0];if("number"==typeof t)return"number";if("string"==typeof t&&0===t.indexOf("/OADate(")&&t.indexOf(")")===t.length-2)return"date";if("boolean"==typeof t)return"boolean"}return""}(a),e.operator,n)}return e.filter1&&(t=r(e.filter1)),e.filter2&&(t=M(0,e.and?1:0,A,A,A,A,t,r(e.filter2))),t}function d(e){return h(e)?e:"="+e}function u(e){var t,r=e.row,n=e.col,o=e.rowCount,i=e.colCount,a=n+i-1,s=r+o-1;return x.isRangeWholeRow(e)&&x.isRangeWholeColumn(e)?t="$1:$"+l.ExcelConstants.sb:x.isRangeWholeRow(e)?t=r+1+":"+(1+s):x.isRangeWholeColumn(e)?t=x.IndexHelper.I(n)+":"+x.IndexHelper.I(a):(t=x.IndexHelper.I(n)+(r+1),(1<o||1<i)&&(t+=":"+x.IndexHelper.I(a)+(1+s))),t}function g(e,t){var r,n;e&&(r=e,n=t,i.forEach(function(e){void 0===n[e]&&void 0!==r[e]&&(n[e]=r[e])}))}function m(e,t,r,n,o,i){var a,s,l,u=e.te;if(r[n]&&r[n][o]){if(!(a=r[n][o].style))return;(s=x.la.da(t.namedStyles,a))&&((l=c.processTableCellStyle(s,u)).name="__builtInTableStyle"+e.ue+s.name,x.la.fa(t.namedStyles,e.ve,l),e.ue++,r[n][o].style=l.name,i[a]=l.name)}}function S(e,t){return w(e.bk)[t]}function s(){var e=this;e.we={version:"13.1.1"},e.te=A,e.xe=A,e.ye=[],e.ze=[],e.Ae=[],e.Be=[],e.ue=0,e.Ce=0,e.De=0,e.Ee=[],e.Fe=[],e.Ge={},e.He={},e.Ie=!0,e.Je=A,e.Ke=[],e.Le=!1,e.Me=3,e.Ne=[],e.Oe=[],e.Pe="Calibri Light",e.Qe="Calibri",e.Re=[],e.Se=[],e.Te=[],e.ve={}}Object.defineProperty(t,"__esModule",{value:!0}),x=r("./src/common/common.ts"),l=r("./src/common/excel-types.ts"),T=r("./src/datamodel/excel-style.ts"),c=r("./src/datamodel/excel-helper.ts"),p=r("./src/datamodel/datetime-helper.ts"),a=r("./src/common/range-parser.ts"),n=r("./src/xml-io/node-helper.ts"),h=x.StringEx.C,o=T.ConverterHelper.convertDxfToStyle,w=n.XmlNodeHelper.qe,A=null,k=void 0,f=["fillStyleLst","lnStyleLst","effectStyleLst","bgFillStyleLst"],i=["w","cap","cmpd","algn","prstDash","custDash","round","bevel","miter","headEnd","tailEnd"],s.prototype.Ue=function(e){this.Ve=e,this.We={}},s.prototype.Xe=function(e,t){var r,n,o,i,a,s=this.We,l=e+","+t,u=s[l];return u||((o=(r=this.Ve)&&r.themeElements&&r.themeElements.fmtScheme)&&(n=a=(i=f[e])&&o[i])&&(1===e?a=a.ln:0===e&&(a=a.items),n=a[t]),s[l]=n)},s.prototype.Ye=function(e){var t,r,n,o,i,a,s,l;if(e){if(t={name:e.name},e.colorScheme&&(r=e.colorScheme,t.themeColor={name:r.name,text1:r.schemeColors[1],text2:r.schemeColors[3],background1:r.schemeColors[0],background2:r.schemeColors[2],accent1:r.schemeColors[4],accent2:r.schemeColors[5],accent3:r.schemeColors[6],accent4:r.schemeColors[7],accent5:r.schemeColors[8],accent6:r.schemeColors[9],hyperlink:r.schemeColors[10],followedHyperlink:r.schemeColors[11]}),e.fontScheme){for(o=(n=e.fontScheme).majorFont.runFormattings,i=n.minorFont.runFormattings,a=0,s=o.length;a<s;a++)(l=o[a])&&0===l.fontLanguage&&(t.headingFont=l.typeface,this.Pe=l.typeface);for(a=0,s=i.length;a<s;a++)(l=i[a])&&0===l.fontLanguage&&(t.bodyFont=l.typeface,this.Qe=l.typeface)}this.Ze=t}},s.prototype.$e=function(e){e&&(this.te=T.ConverterHelper.toCellStyle(e,this.Pe,this.Qe),this.xe=e)},s.prototype._e=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d;if(e){if(n=(r=this).we,o=T.ConverterHelper.toCellStyle(e,r.Pe,r.Qe),!x.k(o.formatter)){for(i=RegExp("\\[DBNum\\d+\\]","ig"),a=void 0,s=o.formatter;null!==(a=i.exec(o.formatter));)l=a[0],(4<(u=parseInt(l.substring(l.indexOf("m")+1,l.indexOf("]")),10))||4===u&&s.indexOf("[$-412]")<0&&"ko-kr"!==x.Ia())&&(s=s.replace(l,"[DBNum3]"));o.formatter=s}r.ye.push(o),c=T.ExtendedNumberFormatHelper.getFormatCode(e),r.ze.push(p.DateTimeHelper.af(c)),"@"===c?r.Ae.push(!0):r.Ae.push(!1),e.isStyleFormat?(-1===(h=r.bf(t))&&(h=r.De),r.Ee.length>h?r.Be[r.Be.length]=r.Ee[h]:r.Be[r.Be.length]="__builtInStyle"+r.Be.length):(f="",e.parentFormatID!==k&&r.Be.length>e.parentFormatID&&(f=r.Be[e.parentFormatID]),"Normal"!==f&&"__builtInStyle"!==f.substring(0,14)&&!x.StringEx.q(f)||(f="__builtInStyle"+r.Be.length),d=void 0,"__builtInStyle"===(o.name=f).substring(0,14)||(d=r.He[f])===k||e.equals(d)||(o.parentName=f,f="__builtInStyle"+r.Be.length,o.name=f),n.namedStyles||(n.namedStyles=[]),x.la.fa(n.namedStyles,r.ve,o),r.Be[r.Be.length]=f)}},s.prototype.bf=function(e){return this.Ge[e]?this.Ge[e]:-1},s.prototype.cf=function(e,t){var r,n,o,i,a,s,l,u;if(e){if(n=(r=this).we,r.Ie&&(r.df(),r.Ie=!1),o=e.name,(i=r.Je)&&e.isBuiltInStyle())for(a=0,s=i.length;a<s;a++)if((l=i[a]).builtInStyle===e.builtInStyle){o=l.name;break}if(x.la.ca(r.ve,o)){for(a=0,s=r.Ke.length;a<s;a++)if(r.Ke[a].name===o){r.Ke[a]=e,r.Fe[a]=e.format(),r.Ge[t]=a;break}r.He[o]=e.format(),(u=T.ConverterHelper.toCellStyle(e.format(),r.Pe,r.Qe)).name=o,x.la.fa(n.namedStyles,r.ve,u)}else r.He[o]=e.format(),r.Ke.push(e),r.Fe.push(e.format()),r.Ge[t]=r.Fe.length-1,r.Ee.push(o),n.namedStyles||(n.namedStyles=[]),(u=T.ConverterHelper.toCellStyle(e.format(),r.Pe,r.Qe)).name=o,x.la.fa(n.namedStyles,r.ve,u)}},s.prototype.df=function(){var e,t,r,n,o=this,i=o.we;if(o.Ie)for(i.namedStyles||(i.namedStyles=[]),o.Je=T.BuiltInExcelStyles.getBuiltInStyles(),e=0,t=o.Je.length;e<t;e++)(r=o.Je[e])&&"Normal"===r.name&&(o.De=o.Fe.length),o.Ke.push(r),o.Fe.push(r.format()),o.Ee.push(r.name),o.He[r.name]=r.format(),(n=T.ConverterHelper.toCellStyle(r.format(),o.Pe,o.Qe)).name=r.name,x.la.fa(i.namedStyles,o.ve,n)},s.prototype.ef=function(e){this.Le=e},s.prototype.ff=function(e,t){var r=this.we;e||(r.showHorizontalScrollbar=e),t||(r.showVerticalScrollbar=t)},s.prototype.gf=function(e,t,r,n){var o=this.we;e||(o.tabStripVisible=e),o.startSheetIndex=r,o.activeSheetIndex=t,o.tabStripRatio=n/1e3},s.prototype.hf=function(e,t,r){var n={},o=this.we;n.name=e,n.index=t,1!==r&&2!==r||(n.visible=!1),n.allowCellOverflow=!0,n.theme=this.Ze,n.defaults=x.Ga(),x.k(o.sheetCount)&&(o.sheetCount=0),o.sheetCount++,o.sheets||(o.sheets={}),o.sheets[e]=n},s.prototype.if=function(e,t){var r,n,o=this.we;if(e&&(o.referenceStyle=1,o.sheets))for(r in o.sheets)o.sheets.hasOwnProperty(r)&&((n=o.sheets[r]).referenceStyle=1,n.colHeaderAutoText=1);o.iterativeCalculation="1"===t.iterate,o.iterativeCalculationMaximumIterations=x.k(t.count)?100:parseInt(t.count,10),o.iterativeCalculationMaximumChange=x.k(t.delta)?.001:parseFloat(t.delta)},s.prototype.jf=function(e,t,r){var n=this.we,o=n.sheets&&n.sheets[e];!1===r&&(o.rowOutlines||(o.rowOutlines={}),o.rowOutlines.direction=0),!1===t&&(o.columnOutlines||(o.columnOutlines={}),o.columnOutlines.direction=0)},s.prototype.kf=function(e,t){var r=this.we,n=r.sheets&&r.sheets[e];t!==T.ExcelColor.EmptyColor&&(t.isThemeColor()?n.sheetTabColor=T.ColorHelper.getThemeColorName(t):n.sheetTabColor=T.ColorHelper.toRGBColor(t))},s.prototype.lf=function(e,t,r){var n=this.we,o=n.sheets&&n.sheets[e];o.rowCount=t,o.columnCount=r},s.prototype.mf=function(e,t,r,n,o,i,a){var s,l=this.we,u=l.sheets&&l.sheets[e];n||(u.rowHeaderVisible=n,u.colHeaderVisible=n),i&&(u.showFormulas=!0),100!==o&&(u.zoomFactor=o/100),t&&t.isIndexedColor()&&64===t.value()&&(t=null),null===t&&r||(s={},null!==t&&(s.color=""+T.ColorHelper.toRGBColor(t)),r||(s.showVerticalGridline=r,s.showHorizontalGridline=r),u.gridline=s),u.isSelected=a},s.prototype.pf=function(e,t,r,n,o,i,a,s,l){var u,c,h,f,d,p,g,m,b=this.we,y=b.sheets&&b.sheets[e];if(this.Me===t){for(y.rowCount<=r&&(y.rowCount=r+1),y.columnCount<=n&&(y.columnCount=n+1),u=0,c=i.length;u<c;u++)h=i[u],f=a[u],d=s[u],p=l[u],-1===f&&(f=y.rowCount-1),-1===p&&(p=y.columnCount-1),f=0<=f?f:0,d=0<=d?d:0,p=0<=p?p:0,(h=0<=h?h:0)<y.rowCount&&d<y.columnCount&&(g=Math.min(y.rowCount-h,f-h+1),m=Math.min(y.columnCount-d,p-d+1),1<=g&&1<=m&&(y.selections=y.selections||{},y.selections[u]={row:h,rowCount:g,col:d,colCount:m}));y.selections&&(y.selections.length=i.length),y.activeRow=0<=r&&r<y.rowCount?r:0,y.activeCol=0<=n&&n<y.columnCount?n:0}},s.prototype.qf=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d;o&&(a=(i=this.we).sheets&&i.sheets[e],s=this.rf,l=x.IndexHelper.F(s),u=x.IndexHelper.G(s),c=x.IndexHelper.F(n),h=x.IndexHelper.G(n),r&&t?this.sf(c,h,e):r&&!t?this.sf(c,u,e):!r&&t&&this.sf(l,h,e),r&&(f=r+l,a.rowCount<=f&&(a.rowCount=f+1),a.frozenRowCount=f),t&&(d=t+u,a.columnCount<=d&&(a.columnCount=d+1),a.frozenColCount=d))},s.prototype.tf=function(e,t,r){var n=this.we;(n.sheets&&n.sheets[e]).defaults={colHeaderRowHeight:20,rowHeaderColWidth:40,rowHeight:t,colWidth:r}},s.prototype.uf=function(e,t){var r=this.we;(r.sheets&&r.sheets[e]).defaults.rowHeight=T.UnitHelper.pointToPixel(t)},s.prototype.vf=function(e,t,r){var n,o=this.we,i=o.sheets&&o.sheets[e];isNaN(r)?(n=this.wf(t),i.defaults._isExcelDefaultColumnWidth=!0):n=this.xf(r),i.defaults.colWidth=n},s.prototype.wf=function(e){var t=this.te;return e*(Math.round(this.getMaxiumDigitWidth(t.font))+1)},s.prototype.xf=function(e){var t,r;return 0===e?0:(t=this.te,r=Math.round(this.getMaxiumDigitWidth(t.font)),Math.floor((256*e+Math.floor(128/r))/256*r))},s.prototype.getMaxiumDigitWidth=function(e){return this.yf===k&&(this.yf=T.UnitHelper.getMaxiumDigitWidth(e)),this.yf},s.prototype.zf=function(e){var t=this.we,r=t.sheets&&t.sheets[e],n=r.columnCount||0,o=r.rowCount||0,i=this.Af,a=this.Bf;r.columnCount=Math.max(n,i+1),r.rowCount=Math.max(o,a+1)},s.prototype.Cf=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p=this.we,g=p.sheets&&p.sheets[e],m=g.columnOutlines&&0===g.columnOutlines.direction,b=this.Te,y=this.xf(o),C=x.ba.T;for(C-1<=r&&(r=C-1),l=t;l<=r;l++){if((0<a||s)&&(l+2>g.columnCount&&(g.columnCount=l+2),g.columnOutlines||(g.columnOutlines={}),g.columnOutlines.items||(g.columnOutlines.items=[]),g.columnOutlines.itemsData||(g.columnOutlines.itemsData=[]),g.columnOutlines.items[l]={level:a-1,collapsed:s,viewCollapsed:i},(c=(u=g.columnOutlines.itemsData)[u.length-1])&&l===c.index+c.count&&c.info.level===a-1&&c.info.collapsed===s?c.count++:u.push({index:l,count:1,info:{level:a-1,collapsed:s}})),g.columnOutlines&&g.columnOutlines.itemsData&&v(g.columnOutlines.itemsData,l,a,m,i,b[l-1]&&b[l-1].hidden),-1!==y||i){for(g.columns||(g.columns=[]),h=g.columns.length;h<l;h++)g.columns[h]=A,b[h]=A;f={},i&&0===a&&(f.visible=!1),-1!==y&&(f.size=y),!1===f.visible&&0===f.size&&(f.size=k),b[l]=f,g.columns[l]=f}1!==n&&((d=this.Be[n])!==k?this.Ne[l]={style:d}:n<this.ye.length&&(this.Ne[l]={style:this.ye[n]}))}g.columnCount>C&&(g.columnCount=C)},s.prototype.Df=function(e,t,r,n,o){var i=this.we,a=i.sheets&&i.sheets[e];a.spans||(a.spans=[]),r>=a.rowCount&&(r=a.rowCount-1),o>=a.columnCount&&(o=a.columnCount-1),a.spans.push(new x.Range(t,n,r-t+1,o-n+1))},s.prototype.Ef=function(e,t){var r=this.we;(r.sheets&&r.sheets[e]).isProtected=t},s.prototype.Ff=function(e,t,r){var n,o,i,a,s=this.we,l=s.sheets&&s.sheets[e];for(l.protectionOptions=l.protectionOptions||{},n=0;n<t.length;n++)o=t[n].name,i=t[n].value,(a=c.toProtectionOptions[o])?l.protectionOptions[a]=i:l.protectionOptions[o]=i;r&&l.protectionOptions.allowEditObjects===k&&(l.protectionOptions.allowEditObjects=!0)},s.prototype.Gf=function(e){var t,r=this.we,n=r.sheets&&r.sheets[e];n.data||(n.data={}),t=n.data,0<this.Oe.length&&(t.rowDataArray=this.Oe,this.Oe=[]),0<this.Ne.length&&(t.columnDataArray=this.Ne,this.Ne=[]),this.te&&(t.defaultDataNode={style:this.te}),this.Ze&&(n.theme=this.Ze),this.zf(e)},s.prototype.Hf=function(e,t,r,n,o,i,a){var s,l,u,c,h,f,d=this.we,p=d.sheets&&d.sheets[e],g=p.rowOutlines&&0===p.rowOutlines.direction,m=this.Se;if((0<o||i)&&(t+2>p.rowCount&&(p.rowCount=t+2),p.rowOutlines||(p.rowOutlines={}),p.rowOutlines.items||(p.rowOutlines.items=[]),p.rowOutlines.itemsData||(p.rowOutlines.itemsData=[]),p.rowOutlines.items[t]={level:o-1,collapsed:i,viewCollapsed:a},(l=(s=p.rowOutlines.itemsData)[s.length-1])&&t===l.index+l.count&&l.info.level===o-1&&l.info.collapsed===i?l.count++:s.push({index:t,count:1,info:{level:o-1,collapsed:i}})),u=m[t-1]&&m[t-1].hidden,p.rowOutlines&&p.rowOutlines.itemsData&&v(p.rowOutlines,t,o,g,a,u),o<=0&&t+1>p.rowCount&&(p.rowCount=t+1),-1!==r&&t<p.rowCount&&((c=this.Be[r])!==k?this.Oe[t]={style:c}:r<this.ye.length&&(this.Oe[t]={style:this.ye[r]})),-1!==n||a){for(p.rows||(p.rows=[]),h=p.rows.length;h<t;h++)p.rows.push(A),m.push(A);f={},a&&0===o&&(f.visible=!1),-1!==n&&(f.size=Math.round(T.UnitHelper.pointToPixel(n))),!1===f.visible&&0===f.size&&(f.size=k),m.push(f),p.rows.push(f)}},s.prototype.If=function(e){var t,r=this.we,n=r.sheets&&r.sheets[e];n.data||(n.data={}),(t=n.data).dataTable||(t.dataTable={})},s.prototype.Jf=function(e,t){var r=this.we,n=(r.sheets&&r.sheets[e]).data.dataTable;n[t]||(n[t]={})},s.prototype.Kf=function(e,t,r,n){var o,i,a=this.we,s=(a.sheets&&a.sheets[e]).data.dataTable[t];s[r]||(s[r]={}),o=s[r],(i=this.Be[n])!==k?o.style=i:n<this.ye.length&&(o.style=this.ye[n])},s.prototype.Lf=function(e,t,r,n){var o,i,a=this.we,s=a.sheets&&a.sheets[e],l=s.data.dataTable[t];l||(s.data.dataTable[t]=l={}),l[r]||(l[r]={}),"string"==typeof(i=(o=l[r]).style)&&(i=this.ye[this.Be.indexOf(o.style)]),i&&i.foreColor&&(n.linkColor=i.foreColor),o.hyperlink=n},s.prototype.Mf=function(e,t,r,n,o,i,a,s){var l,u,c,h=this.we,f=(h.sheets&&h.sheets[e]).data.dataTable[t];if(f[r]||(f[r]={}),l=f[r],n<this.ze.length&&this.ze[n]&&"number"==typeof o&&(o=this.Nf(o)),void 0!==o&&(l.value=o),void 0!==i&&(l.formula=i),a&&(l.arrayInfo=a),s){for(u=[],c=0;c<s.length;c++)s[c].style?u.push({style:T.ConverterHelper.toRichTextStyle(s[c].style,this.Pe,this.Qe),text:s[c].text}):u.push(s[c]);l.value={richText:u}}},s.prototype.Nf=function(e){return this.Le&&(e+=1462),(e=p.DateTimeHelper.se(e))instanceof Date&&(e=p.DateTimeHelper.Of(e)),p.DateTimeHelper.Pf(e)},s.prototype.Qf=function(e){var t,r,n;if(e&&0<e.length){for(T.ColorHelper.useCustomPalette=!0,t={},r=0,n=e.length;r<n;r++)t[r]=T.ColorHelper.fromArgb(e[r]);T.ColorHelper.customPalette=t}},s.prototype.Rf=function(){this.Me=3},s.prototype.Sf=function(e){this.Me=e},s.prototype.sf=function(e,t,r){var n=this.we,o=n.sheets&&n.sheets[r];o.topCellIndex=e,o.leftCellIndex=t},s.prototype.Tf=function(){for(var e in this.we.names=[],this.we.sheets)this.we.sheets.hasOwnProperty(e)&&(this.we.sheets[e].names=[])},s.prototype.Uf=function(e,t,r,n){var o,i;if(-1===r)this.we.names.push({name:e,formula:t,row:0,col:0,comment:n});else for(o in this.we.sheets)this.we.sheets.hasOwnProperty(o)&&(i=this.we.sheets[o]).index===r&&i.names.push({name:e,formula:t,row:0,col:0,comment:n})},s.prototype.Vf=function(e){var t=this.Wf[e];return o(t,this.Pe,this.Qe)},s.prototype.Xf=function(e){var t=this.Re[e];return o(t,this.Pe,this.Qe)},s.prototype.Yf=function(e,t){var r,n,o,i=this.we.sheets[e];for(i.conditionalFormats||(i.conditionalFormats={rules:[]}),r=0;r<t.rules.length;r++)n=t.rules[r],!x.k(n.dxfId)&&-1<n.dxfId&&((o=this.Xf(n.dxfId)).font&&0===o.font.indexOf("normal normal")&&delete o.font,n.style=o,delete n.dxfId),i.conditionalFormats.rules.push(n)},s.prototype.Zf=function(e){return this.we.sheets[e].conditionalFormats},s.prototype.$f=function(e,t){var r=this.we,n=r.sheets&&r.sheets[t];n.comments=e.map(function(e){return c.convertFromExcelComment(n,e)})},s.prototype._f=function(e,t){var r=this.we;(r.sheets&&r.sheets[t]).pivotTables=e},s.prototype.ag=function(e,t){var r=this.we,n=r.sheets&&r.sheets[t],o=e.pictures,i=e.charts,a=e.shapes;o&&this.bg(o,n),i&&this.cg(i,n),a&&this.dg(a,n)},s.prototype.bg=function(e,r){r.floatingObjects=r.floatingObjects||[];var n=r.floatingObjects;e.forEach(function(e){var t=c.convertFromExcelPicture(r,e,n);t.typeName="1",n.push(t)})},s.prototype.cg=function(e,r){r.charts=r.charts||[],e.map(function(e){var t=c.convertFromExcelChart(r,e);r.charts.push(t)})},s.prototype.eg=function(e,t){var r,n=this.we.pivotCaches;if(n)for(r in n)if(n.hasOwnProperty(r)&&n[r]&&n[r][e]===t)return n[r]},s.prototype.fg=function(e){var t,r,n,o,i,a=this,s=e.sp||e.cxnSp,l=s&&s.style,u=s&&s.spPr;l&&(t=l.lnRef,r=void 0,n=(n=u.ln)||{},!t||(r=t.idx)&&(g(a.Xe(1,r-1),n),u.ln=n)),!(o=e.grpSp)||(i=o.sp)&&i.length&&i.forEach(function(e){a.fg({sp:e})})},s.prototype.dg=function(e,r){var n=this;r.shapes=r.shapes||[],e.map(function(e){n.fg(e);var t=c.convertFromExcelShape(r,e);r.shapes.push(t)})},s.prototype.gg=function(e,t){var r,n,o,i=this.we,a=i.sheets&&i.sheets[t];for(a.sparklineGroups=e,r=0;r<e.length;r++)for(n=e[r].sparklines,o=0;o<n.length;o++)n[o].row>=a.rowCount&&(a.rowCount=n[o].row+1),n[o].col>=a.columnCount&&(a.columnCount=n[o].col+1)},s.prototype.hg=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d=this.we,p=d.sheets&&d.sheets[t];for(p.tables=e,r=0;r<e.length;r++){for(a in e[r].row+e[r].rowCount>p.rowCount&&(p.rowCount=e[r].row+e[r].rowCount),e[r].col+e[r].colCount>p.columnCount&&(p.columnCount=e[r].col+e[r].colCount),n=p.data&&p.data.dataTable,o=e[r],i=p.data&&p.data.defaultDataNode&&p.data.defaultDataNode.style&&p.data.defaultDataNode.style.font,o.style)o.style.hasOwnProperty(a)&&o.style[a]&&o.style[a].font&&(o.style[a].font=T.ConverterHelper.composeFontWeightAndFontStyleToDestFont(o.style[a].font,i));for(s={},l=o.row+o.rowCount,u=o.col+o.colCount,c=o.row;c<l;c++)for(h=o.col;h<u;h++)n[c]&&n[c][h]&&(f=n[c][h].style,s[f]?n[c][h].style=s[f]:m(this,d,n,c,h,s))}},s.prototype.ig=function(e,t,r,n){var o,i,a=this.we.sheets[e],s=[],l=0;if(a&&a.data&&a.data.dataTable&&(o=a.data.dataTable))for(;0<n&&l<t.rowCount;)o[t.row+l]&&(i=o[t.row+l][r],x.k(i.value)||(s.push(i.value),n--)),l++;return s},s.prototype.jg=function(e,C){var w,v,t,r,n,o,i,S=this;if(!x.k(e)&&!x.k(e.range))return(w={}).filterItemMap=[],w.filteredColumns=[],v=e.range,v=new x.Range(v.row+1,v.col,v.rowCount-1,v.colCount),w.range=v,e.filterColumns.forEach(function(e){var r,t,n,o,i,a,s,l,u,c,h,f,d,p,g,m=e.autoFilterColumnId+v.col,b=[],y=e.colorFilter;y&&b.push((c=y,h=S.Re[y.dxfId],p=c.cellColor?0:1,(g=h.fill)&&(f=0===g.patternType?"":(d={},T.ConverterHelper.re(g,d),d.backColor)),M(3,p,f))),(r=e.filters)&&(r.filter.forEach(function(e){b.push(M(2,0,e,r.blank))}),r.dateGroupItem.forEach(function(e){var t=new Date(e.year,0<e.month?e.month-1:e.month,e.day,e.hour,e.minute,e.second);b.push(M(5,0,t,!r.blank))})),e.customFilters&&b.push(I(e.customFilters,x.k(C)?v:S.ig(C,v,m,1))),e.dynamicFilter&&b.push((o=e.dynamicFilter,i=v,a=m,l=new x.Range(i.row,a,i.rowCount,1),100===(u=o.type)||101===u?s=M(10,A,A,A,u-100,A,A,A,l):16===u?s=M(6,A,0,A,A,A,A,A,A,6):17<=u&&u<=20?s=M(6,A,u-17,A,A,A,A,A,A,2):21<=u&&u<=32?s=M(6,A,u-21,A,A,A,A,A,A,3):0<=u&&u<=15&&(s=M(6,A,u)),s)),e.top10Filter&&b.push((t=e.top10Filter,n=t.top?0:1,M(8,A,t.value,A,n,t.percent))),w.filteredColumns.push(m),w.filterItemMap.push({index:m,conditions:b})}),(t=e.sortInfo)&&t.dxfId===k?w.sortInfo=t:t&&t.dxfId!==k&&(r=void 0,n=e.sortInfo.isBackColor,(o=S.Re[t.dxfId]&&S.Re[t.dxfId].fill)&&(r=0===o.patternType?"":(i={},T.ConverterHelper.re(o,i),"object"==typeof i.backColor?JSON.stringify(i.backColor):i.backColor)),w.sortInfo={ascending:t.ascending,index:t.index,isBackColor:n,color:r}),w},s.prototype.kg=function(e,h){if(!x.k(e)){var f={filterItemMap:[]};return e.filterColumns.forEach(function(e){var t,r,n,o,i,a,s,l,u=[];function c(e){var t,r=e.value,n=r.indexOf("*"),o=r.lastIndexOf("*");return-1!==n?t=n===r.length-1&&0!==n?M(s.conType,s.compareType,r.substring(0,r.length-1)):0===n&&n===o?M(s.conType,s.compareType,r.substring(1)):(-1!==n&&-1!==o&&(r=r.substr(1,r.length-2)),M(s.conType,s.compareType,r)):x.k(s)||(t=M(s.conType,s.compareType,r)),t}e.customFilters&&u.push((a=e.customFilters,s=h,a.filter1&&(l=c(a.filter1)),a.filter2?M(s.conType,s.compareType,A,A,A,A,l,c(a.filter2)):M(s.conType,s.compareType,A,A,A,A,l,A))),e.dynamicFilter&&u.push((e.dynamicFilter,1===(o=h).conType&&(i=M(1,o.compareType,A)),i)),e.top10Filter&&u.push((t=e.top10Filter,r=h,n=t.top?0:1,M(3,r.compareType,t.value,A,n,t.percent))),f.filterItemMap.push({conditions:u})}),f}},s.prototype.mg=function(e,t){if(!x.k(e)){var r=this.we;(r.sheets&&r.sheets[e]).rowFilter=this.jg(t,e)}},s.prototype.ng=function(e,t){var a,s,r,n=this.we,l=n.sheets&&n.sheets[t];for(r in l.slicers=l.slicers||[],a=l.slicers,s=[],n.sheets)n.sheets[r].tables&&(s=s.concat(n.sheets[r].tables));e.forEach(function(e){var t,r,n,o,i;e.tableName=(o=e.tableId,i=null,s.forEach(function(e){e.id===o&&(i=e.name)}),i),e.columnName=(t=e.tableId,r=e.columnId,n=null,s.forEach(function(e){e.id===t&&e.columns.forEach(function(e){e.id===r&&(n=e.name)})}),n),delete e.tableId,delete e.columnId,c.inflateWorksheetByAnchor(l,e),a.push(e)})},s.prototype.og=function(e,t){var r,n,o,i,a,s;x.k(e)||(n=(r=this.we).sheets&&r.sheets[e],o=this.pg(t),i=(i=n.validations)||(n.validations=[]),o.ranges=(a=t.ranges,s=s=", ",a.map(u).join(s)),i.push(o))},s.prototype.pg=function(e){var t,r,n,o,i,a,s,l,u;if(x.k(e))return A;switch(t=e.type,r=e.compareOperator,n=e.firstFormula,o=e.secondFormula,i={type:t},t){case 0:break;case 1:case 2:case 6:a={operator:r,value1:d(n),value2:d(o)};break;case 3:s=n,x.k(s)&&(s=o),s&&(a='"'===s[0]&&'"'===s[s.length-1]?{value:h(u=s)||u.length<=2?u:u.substr(1,u.length-2)}:{formula:d(s)});break;case 4:case 5:l=void 0,x.k(n)||(l=parseFloat(n),isNaN(l)||(n=this.Nf(l))),x.k(o)||(l=parseFloat(o),isNaN(l)||(o=this.Nf(l))),a={operator:r,value1:n&&-1!==n.indexOf("/OADate(")?n:d(n),value2:o&&-1!==o.indexOf("/OADate(")?o:d(o)};break;case 7:a={formula:d(n)}}return a&&(i.validatorInfo=a),i!==A&&(i.errorStyle=e.errorType,i.errorMessage=e.error,i.errorTitle=e.errorTitle,i.ignoreBlank=e.allowBlank,i.inCellDropdown=e.showPromptBox,i.inputMessage=e.prompt,i.inputTitle=e.promptTitle,i.showErrorMessage=e.showErrorMessage,i.showInputMessage=e.showInputMessage),i},s.prototype.qg=function(e,t){var r,n;function o(e){return e=e||0,parseInt(Math.round(96*e),10)}x.k(e)||((n=(r=this.we).sheets&&r.sheets[e]).printInfo||(n.printInfo={}),n.printInfo.margin={top:o(t.top),bottom:o(t.bottom),left:o(t.left),right:o(t.right),header:o(t.header),footer:o(t.footer)})},s.prototype.rg=function(e,t){var r,n,o,i,a,s,l;x.k(e)||((n=(r=this.we).sheets&&r.sheets[e]).printInfo||(n.printInfo={}),(o=n.printInfo).showGridLine=t.printGridLine,i=t.horizontalCentered,a=t.verticalCentered,s=0,i&&a?s=3:i?s=1:a&&(s=2),o.centering=s,l=t.printRowColumnsHeaders?2:1,o.showColumnHeader=l,o.showRowHeader=l)},s.prototype.sg=function(e,t,r){e.rows||(e.rows=[]);var n=e.rows[t];n?n.pageBreak=r:e.rows[t]={pageBreak:r}},s.prototype.tg=function(e,t,r){e.columns||(e.columns=[]);var n=e.columns[t];n?n.pageBreak=r:e.columns[t]={pageBreak:r}},s.prototype.ug=function(e,t){var r,n,o,i,a,s,l,u,c,h;function f(e){var t,r,n,o,i;if(e===k)return A;if(t=["","",""],e===A||""===e)return t;for(r=0,n=1,o=e.length;r<o;){if(r<o-1){if("&L"===(i=e.substr(r,2))){n=0,r+=2;continue}if("&C"===i){n=1,r+=2;continue}if("&R"===i){r+=n=2;continue}}t[n]=t[n].concat(e[r]),r++}return t}x.k(e)||(n=(r=this).we,(o=n.sheets&&n.sheets[e]).printInfo||(o.printInfo={}),i=o.printInfo,0!==(a=t.paperSizeIndex)&&(i.paperSize={kind:a}),t.useCustomStartingPage&&(i.firstPageNumber=t.firstPageNumber),x.k(t.showColor)||(i.blackAndWhite=!t.showColor),i.orientation=2===t.orientation?2:1,i.pageOrder=2===t.pageOrder?2:1,0<t.zoomFactor&&(i.zoomFactor=t.zoomFactor),t.useSmartPrint&&(1<=t.smartPrintPagesWidth&&(i.fitPagesWide=t.smartPrintPagesWidth),1<=t.smartPrintPagesHeight&&(i.fitPagesTall=t.smartPrintPagesHeight)),(s=t.advancedHeadFooterSetting)&&((l=f(s.headerOddPage))&&(i.headerLeft=l[0],i.headerCenter=l[1],i.headerRight=l[2]),(u=f(s.footerOddPage))&&(i.footerLeft=u[0],i.footerCenter=u[1],i.footerRight=u[2]),s.headerLeftImage&&(i.headerLeftImage=s.headerLeftImage),s.headerCenterImage&&(i.headerCenterImage=s.headerCenterImage),s.headerRightImage&&(i.headerRightImage=s.headerRightImage),s.footerLeftImage&&(i.footerLeftImage=s.footerLeftImage),s.footerCenterImage&&(i.footerCenterImage=s.footerCenterImage),s.footerRightImage&&(i.footerRightImage=s.footerRightImage)),(c=t.rowBreakLines)&&0<c.length&&c.forEach(function(e){r.sg(o,e,!0)}),(h=t.columnBreakLines)&&0<h.length&&h.forEach(function(e){r.tg(o,e,!0)}))},s.prototype.vg=function(e,t){var r,n,o;e<0||((r=this.wg(e)).printInfo||(r.printInfo={}),1===(n=a.getRangesFromString(t)).length&&(-1<(o=n[0]).row&&(r.printInfo.rowStart=o.row),0<o.rowCount&&(r.printInfo.rowEnd=o.row+o.rowCount-1),-1<o.col&&(r.printInfo.columnStart=o.col),0<o.colCount&&(r.printInfo.columnEnd=o.col+o.colCount-1)))},s.prototype.xg=function(e,t){var r,n,o,i;if(!(e<0))for((r=this.wg(e)).printInfo||(r.printInfo={}),n=a.getRangesFromString(t.replace(","," ")),o=0;o<n.length;o++)i=n[o],x.isRangeWholeRow(i)?(r.printInfo.repeatRowStart=i.row,r.printInfo.repeatRowEnd=i.row+i.rowCount-1):x.isRangeWholeColumn(i)&&(r.printInfo.repeatColumnStart=i.col,r.printInfo.repeatColumnEnd=i.col+i.colCount-1)},s.prototype.wg=function(e){var t,r,n=this.we.sheets;for(t in n)if(n.hasOwnProperty(t)&&(r=n[t]).index===e)return r;return k},s.prototype.yg=function(e){this.zg=e,this.Ag={},this.Bg={}},s.prototype.Cg=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y=this.zg,C=t-1;if(y&&("cm"===e?(n=y.cellMetadata,o=this.Ag):"vm"===e&&(n=y.valueMetadata,o=this.Bg)),n){if(!r)return{name:y.typeNames[C]};if(a=o[i=[e,C].join(",")])return a;if(s=S(n,C)){u=(l=s.rc.pe).t-1,c=+l.v;try{if(h=w(y.metadataTypes.metadataType),f=w(y.futureMetadata),p=(d=h[u])&&d.pe.name,m=p,g=(b=f.filter(function(e){return e.pe.name===m}))&&b[0])return a={name:p,detail:S(g,c)},o[i]=a}catch(e){}}}},s.prototype.Dg=function(e){var t=this.Cg("cm",e);return t&&"XLDAPR"===t.name},s.prototype.Eg=function(e,t){x.k(this.we.docProps)&&(this.we.docProps={}),x.k(this.we.docProps.docPropsCore)&&(this.we.docProps.docPropsCore={}),this.we.docProps.docPropsCore[e]=t},s.prototype.Fg=function(e,t){x.k(this.we.docProps)&&(this.we.docProps={}),x.k(this.we.docProps.docPropsApp)&&(this.we.docProps.docPropsApp={}),this.we.docProps.docPropsApp[e]=t},s.prototype.Gg=function(e){x.k(this.we.docProps)&&(this.we.docProps={}),x.k(this.we.docProps.docPropsCustom)&&(this.we.docProps.docPropsCustom=[]),this.we.docProps.docPropsCustom=e},t.ReaderDataModel=s},"./src/datamodel/datamodel-writer.ts":function(e,t,r){"use strict";var Z,d,b,Y,l,i,n,a,o,p,K,X,c,h,f,s,u;function g(e){return"string"==typeof e}function J(e){return"object"==typeof e}function m(e){var t=e.formula;return Z.k(t)&&(g(t=e.expected)&&(t='"'+t+'"')),t}function Q(e){var t,r,n;return g(e)&&(t=e.indexOf("/OADate(")+1,r=e.indexOf(")"),0!==t&&t<r&&(n=parseFloat(e.substring(t+7,r)),isNaN(n)||(e=""+n))),e}function $(e,t,r){var n;return(e.tables||[]).every(function(e){return!(e.row<=t&&t<=e.row+e.rowCount-1&&e.col<=r&&r<=e.col+e.colCount-1&&(n=e,1))}),n}function ee(e,t,r){var n;return(e.spans||[]).every(function(e){return!(e.row<=t&&t<=e.row+e.rowCount-1&&e.col<=r&&r<=e.col+e.colCount-1&&(n=e,1))}),n}function te(e,t){var r,n=e.spans||[];for(r=0;r<n.length;r++)if(t.row===n[r].row&&t.col===n[r].col){n.splice(r,1);break}}function y(e){var t=e.getTimezoneOffset();return-485===t&&(t=-485-43/60),-321===t&&(t=-321-10/60),t}function C(e,t,r){e.Hg||(e.Hg={}),e.Hg[t]=r}function w(e,t,r){return!e&&!t||e&&t&&(e.Ig||(e.Ig={Jg:b.ConverterHelper.toExtendedFormat(e)}),n=e.Ig.Jg,t.Ig||(t.Ig={Jg:b.ConverterHelper.toExtendedFormat(t)}),o=t.Ig.Jg,n.equals(o,r));var n,o}function v(e,t){var r,n;for(r=0;r<t.length;r++)if(w(e,n=t[r],!0))return n;return X}function S(e){return e.defaults?e.defaults.rowHeight:d.DefaultSize.wb}function x(e){return e.defaults?e.defaults.colWidth:d.DefaultSize.vb}function T(e,t,r){var n=e.data.dataTable[t];if(n&&n[r])return n[r].value}function A(e,t){var r=t.row,n=t.col,o=t.rowCount,i=t.colCount;return-1===r&&(r=0,o=e.rowCount),-1===n&&(n=0,i=e.columnCount),r<=0?r=0:(r--,o+=1),new Z.Range(r,n,o,i)}function k(e){return Z.k(e)?e:2<=e.length&&"="===e[0]?e.substring(1):"="===e?"":e}function M(e,t,r){var n,o={filterType:1};if(o.isBottom=1===t.type,t.percent&&(o.percent=!0),n=t.expected,!Z.k(n))return o.value=n,o.percent&&(n=Math.ceil(r.rowCount%n/100)),Z.k(r)?o.filterValue=NaN:o.filterValue=function(e,t,r,n){var o,i,a;if(1===r.colCount){for(o=[],a=r.row;a<r.row+r.rowCount;a++)i=T(e,a,r.col),Z.k(i)||o.push(i);return o.sort(function(e,t){return n?t-e:e-t}),o[t-1]}}(e,n,r,!o.isBottom),o}function I(e){var t,r=e.expected,n={filterType:2,type:r,conType:e.conType,expectTypeId:e.expectTypeId};return 0<=r&&r<=15||21<=r&&r<=32?(t=function(e){var t=new Date,r=t.getDay(),n=t.getDate(),o=new Date(t),i=new Date(t);switch(e){case 3:o.setDate(n-6);break;case 1:o.setDate(n-1);break;case 0:break;case 2:o.setDate(n+1);break;case 8:o.setDate(n-r-7),i.setDate(n-r-1);break;case 7:o.setDate(n-r),i.setDate(n-r+6);break;case 9:o.setDate(n-r+7),i.setDate(n-r+13);break;case 5:o.setDate(1),o.setMonth(o.getMonth()-1),i.setDate(0);break;case 4:o.setDate(1),i.setMonth(i.getMonth()+1),i.setDate(0);break;case 6:o.setDate(1),o.setMonth(o.getMonth()+1),i.setMonth(i.getMonth()+2),i.setDate(0)}return o.setHours(0),o.setMinutes(0),o.setSeconds(0),i.setHours(23),i.setMinutes(59),i.setSeconds(59),{from:o,to:i}}(r)).from&&t.to&&(n.value=t.from,n.maxValue=t.to):n.type=-1,n}function E(e){if(!Z.k(e.compareType)){var t={filterType:4,filter1:{}};return t.filter1.operator=e.compareType,e.item1&&!Z.k(e.item1.expected)&&(t.filter1.value=e.item1.expected),e.item2&&!Z.k(e.item2.expected)&&(t.filter2={},t.filter2.operator=e.compareType,t.filter2.value=e.item2.expected),t}}function R(e,t){var r;r="/OADate"===e.expected.substring(0,7)?function(e){var t,r,n,o,i,a,s,l;if("/OADate("===e.substr(0,8)){if(o=(864e5*(t=parseFloat(e.substr(8,e.length-10)))*1440+(0<=(r=t-25569)?1:-1)-3181192704e6+864e5*(n=y(new Date(864e5*r))))/1440,i=new Date(o),a=0<=n?1:-1,n!==(s=y(new Date(o+36e5*a))))if(l=new Date(o+60*(s-n)*1e3),s<n){if(-1==a||s===y(i))return 999===l.getMilliseconds()?new Date(l.valueOf()+1):l}else if(n<s&&(1==a||s===y(i)))return 999===l.getMilliseconds()?new Date(l.valueOf()+1):l;return 999===i.getMilliseconds()?new Date(i.valueOf()+1):i}}(e.expected):new Date(e.expected),t.dateGroupItem=t.dateGroupItem||[],t.dateGroupItem.push({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate(),hour:r.getHours(),minute:r.getMinutes(),second:r.getSeconds(),dateTimeGrouping:2})}function D(e,t){var r,n,o=e.compareType;if(8<=o&&o<=23)r={filterType:2,type:t},(n=function(e){var t,r,n,o,i,a,s=new Date,l=s.getDay(),u=s.getDate(),c=new Date(s),h=new Date(s);switch(e){case 11:c.setDate(u-6);break;case 9:c.setDate(u-1);break;case 8:break;case 10:c.setDate(u+1);break;case 16:c.setDate(u-l-7),h.setDate(u-l-1);break;case 15:c.setDate(u-l),h.setDate(u-l+6);break;case 17:c.setDate(u-l+7),h.setDate(u-l+13);break;case 13:c.setDate(1),c.setMonth(c.getMonth()-1),h.setDate(0);break;case 12:c.setDate(1),h.setMonth(h.getMonth()+1),h.setDate(0);break;case 14:c.setDate(1),c.setMonth(c.getMonth()+1),h.setMonth(h.getMonth()+2),h.setDate(0);break;case 18:r=3+(t=c.getMonth()-c.getMonth()%3+1+3)+3,c.setDate(1),c.setMonth(t),h.setMonth(r),h.setDate(0);break;case 19:o=(n=c.getMonth()-c.getMonth()%3+1)+3,c.setDate(1),c.setMonth(n),h.setMonth(o),h.setDate(0);break;case 20:i=c.getMonth()-c.getMonth()%3+1-3,a=n+3-3,c.setDate(1),c.setMonth(i),h.setMonth(a),h.setDate(0);break;case 21:c.setDate(1),c.setMonth(1),c.setFullYear(c.getFullYear()+1),h.setFullYear(h.getFullYear()+2),h.setMonth(0),h.setDate(0);break;case 22:c.setDate(1),c.setMonth(1),h.setFullYear(h.getFullYear()+1),h.setMonth(0),h.setDate(0);break;case 23:c.setDate(1),c.setMonth(1),c.setMonth(c.getFullYear()-1),h.setMonth(0),h.setDate(0)}return c.setHours(0),c.setMinutes(0),c.setSeconds(0),h.setHours(23),h.setMinutes(59),h.setSeconds(59),{from:c,to:h}}(o)).from&&n.to&&(r.value=n.from,r.maxValue=n.to);else if(24<=o&&o<=39)r={filterType:2,type:t};else if(0<=o&&o<=7)return E(e);return r}function N(e){var t,r,n=[],o=[];for(o.push(e);0<o.length;)0===(t=o.shift()).conType?(r=t,Z.k(r.item1)||o.push(r.item1),Z.k(r.item2)||o.push(r.item2)):n.push(t);return n}function F(e){var t=-1;switch(e){case 0:case 2:case 4:case 6:t=0;break;case 1:case 3:case 5:case 7:t=1;break;default:t=0}return t}function _(e,t){switch(t){case 0:case 1:return e;case 2:case 3:return e.concat("*");case 4:case 5:return"*".concat(e);case 6:case 7:return"*".concat(e).concat("*");default:return e}}function P(e){var t={filterType:3,filter:[]};return e.forEach(function(e){Z.k(e.expected)||t.filter.push(e.expected)}),t}function L(e,t){return e.every(function(e){return e.conType===t})}function O(e,t,r){if(e===X)return X;var n=t.conType;if(3!==n){if(8===n)return M(e,t,r);if(10===n)return function(e,t,r){var n,o,i,a,s={filterType:2};if(0===t.type?s.type=100:1===t.type&&(s.type=101),r===X)return X;for(i=o=n=0;i<r.rowCount;i++)a=parseFloat(T(e,r.row+i,r.col)),isNaN(a)||(n+=a,o++);return 0<o&&(s.value=n/o),s}(e,t,r);if(6===n)return I(t);if(11===n||1===n)return function(e){if(!Z.k(e.compareType)){var t={filterType:4,filter1:{}};return t.filter1.operator=e.compareType,Z.k(e.expected)?t.filter1.value=k(e.formula):t.filter1.value=e.expected,t}}(t);if(2===n)return function(e){var t=e.expected,r=-1;switch(e.compareType){case 0:return{filterType:3,filter:[t]};case 1:r=1;break;case 2:t+="*";break;case 3:r=1,t+="*";break;case 4:t="*"+t;break;case 5:r=1,t="*"+t;break;case 6:t="*"+t+"*";break;case 7:r=1,t="*"+t+"*"}return{filterType:4,filter1:{operator:r,value:t}}}(t);if(5===n)return function(e){var t,r;if(0===e.compareType)return R(e,t={filterType:3}),t;switch(r=-1,e.compareType){case 0:break;case 1:r=1;break;case 2:r=4;break;case 3:r=5;break;case 4:r=2;break;case 5:r=3}return-1!==r?{filterType:4,filter1:{operator:r,value:Q(m(e))}}:void 0}(t);if(0===n)return function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g;if(0===e.compareType){if(L(n=N(e),5))return o={filterType:3},n.forEach(function(e){R(e,o)}),o;if(L(n,2)){if(s=!1,n.length<=2)for(l=0;l<n.length;l++)if(0!==n[l].compareType){s=!0;break}return s?(a={filterType:4},i=F((u=n[0]).compareType),a.filter1={},a.filter1.operator=i,Z.k(u.expected)?a.filter1.value=k(u.formula):a.filter1.value=_(u.expected,u.compareType),2===n.length&&(i=F((u=n[1]).compareType),a.filter2={},a.filter2.operator=i,Z.k(u.expected)?a.filter2.value=k(u.formula):a.filter2.value=_(u.expected,u.compareType)),a.and=!1,a):P(n)}if(L(n,11)){if(c=!0,n.length<=2&&(c=!1),c)return P(n);if(0<n.length)return a={filterType:4,filter1:{operator:(h=n[0]).compareType}},Z.k(h.expected)?a.filter1.value=k(h.formula):a.filter1.value=h.expected,2===n.length&&(h=n[1],a.filter2={operator:h.compareType},Z.k(h.expected)?a.filter2.value=k(h.formula):a.filter2.value=h.expected),a.and=!1,a}return a={filterType:4,and:!1},f=O(t,n[0],r),a.filter1=f.filter1,1<n.length&&(d=O(t,n[1],r),a.filter2=d.filter1),a}if(2===(n=N(e)).length)return(a={filterType:4}).and=!0,p=O(t,n[0],r),Z.k(p)||!p.filter1?X:(a.filter1=p.filter1,g=O(t,n[1],r),Z.k(g)||!g.filter1?X:(a.filter2=g.filter1,a))}(t,e,r)}}function B(e,t){var r,n,o,i=e.conType;return 3===i?((o={filterType:1}).isBottom=1===(r=e).type,o.percent=1===r.compareType,n=r.expected,Z.k(n)||(o.value=n,o.filterValue=n),o):2===i?E(e):0===i?function(e){var t,r=e.value1,n=e.value2;if(n)return 12===e.compareType?{filterType:4,filter1:{operator:3,value:r},filter2:{operator:5,value:n}}:13===e.compareType?{filterType:4,filter1:{operator:4,value:r},filter2:{operator:2,value:n}}:void 0;switch(t=-1,e.compareType){case 0:return{filterType:3,filter:[r]};case 1:t=1;break;case 2:r+="*";break;case 3:t=1,r+="*";break;case 4:r="*"+r;break;case 5:t=1,r="*"+r;break;case 6:r="*"+r+"*";break;case 7:t=1,r="*"+r+"*"}return{filterType:4,filter1:{operator:t,value:r}}}(e):1===i?D(e,t):void 0}function j(e){if(!Z.k(e)){var t,r,n=e.conType;return 0===n?function e(t){var r,n,o;return Z.k(t)?X:(n=r=X,o=1===t.compareType?6:7,t.item1&&(r=(0===t.item1.conType?e:j)(t.item1)),t.item2&&(n=(0===t.item2.conType?e:j)(t.item2)),new i.Tuple(r,n,o))}(e):1===n||7===n?(t=e.compareType,r=e.formula,Z.k(r)&&(r=e.expected),new i.Tuple(r,X,t)):4===n?new i.Tuple(Z.k(e.formula)?e.expected:e.formula,X,1):12===n||5===n||13===n?(r=m(e),new i.Tuple(r,X,1)):X}}function H(e){if(e instanceof i.Tuple){var t=e;if(!Z.k(t.item1))return H(t.item1)}else if(!Z.k(e))return k(""+e);return""}function G(e,t,r){if(r.Hg&&r.Hg[e])return r.Hg[e];var n=Z.la.da(r.namedStyles,e);return n?(C(r,e,n),n):t.Hg&&t.Hg[e]?t.Hg[e]:((n=Z.la.da(t.namedStyles,e))&&C(t,e,n),n)}function U(e,c,h,f){e.forEach(function(e){var t,r,n,o,i,a,s,l,u=(t=e,r=h,n=f,Z.k(t)?X:(o=j(t.condition),a=i=X,Z.k(o)||(Z.k(o.item1)||(i=H(o.item1)),Z.k(o.item2)||(a=H(o.item2))),s={},(p(i,r,n)||p(a,r,n))&&(s.external=!0),l=t.type,s.type=l,s.firstFormula=i,s.secondFormula=a,4!==l&&5!==l||(Z.k(s.firstFormula)||(s.firstFormula=Q(s.firstFormula)),Z.k(s.secondFormula)||(s.secondFormula=Q(s.secondFormula))),s.compareOperator=t.comparisonOperator,s.allowBlank=t.ignoreBlank,s.error=t.errorMessage,s.errorTitle=t.errorTitle,s.errorStyle=t.errorStyle,s.prompt=t.inputMessage,s.showPromptBox=t.inCellDropdown,s.promptTitle=t.inputTitle,s.showErrorBox=t.showErrorMessage,s.showInputMessage=t.showInputMessage,s));u.ranges=e.ranges.split(", ").join(" "),c.push(u)})}function W(e){if(e){var t={};return e.borderColor&&(t.color=e.borderColor),e.borderStyle&&(t.style=u[e.borderStyle]),t}}function V(e,t){var r,n;if(e){for(r in e)e.hasOwnProperty(r)&&0<=r.indexOf("border")&&((n=e[r])&&(e[r]=W(n)));return t&&(e.isSlicerHeader=!0),e}}function re(e){var t,r;if(Z.k(e)||!Array.isArray(e))return X;for(t=[],r=0;r<e.length;r++)t.push(e[r].text?e[r].text:"");return t.join("")}function z(t,e){var r=null;return e.forEach(function(e){e.name===t&&(r=e.id)}),r}function q(e,t,r){for(var n=0;n<e.styleElements.length;n++)e.styleElements[n].type===t&&(e.styleElements[n].size=r)}function ne(e,t){return o(e,t,l.isBorderEqual)}function oe(e,t){return e[t.name]&&o(e[t.name],t,ne)}function ie(e,t){for(var r=t,n=1;e[r];)r=t+"_"+n,n++;return r}function ae(e){return(e/96).toFixed(2)}function se(e){var t=this;t.we=e,t.Kg={},t.Lg=[],t.Mg={},t.Ng=[],t.Og={},t.Ke=[],t.Pg=[],t.Qg={},t.Rg={},t.Sg={},t.Tg={},t.Ug={},t.Vg={},t.Wg={},t.Re=[],t.Xg=[],t.Yg=0,t.Zg={},t.$g={},t._g={}}Object.defineProperty(t,"__esModule",{value:!0}),Z=r("./src/common/common.ts"),d=r("./src/common/excel-types.ts"),b=r("./src/datamodel/excel-style.ts"),Y=r("./src/common/excel-types.ts"),l=r("./src/datamodel/excel-helper.ts"),i=r("./src/common/tuple.ts"),n=b.ColorHelper.fromColorToExcelColor,a=b.ColorHelper.toExcelColor,o=Z.Util.wa,p=Z.Util.xa,K=void 0,X=null,c="__builtInStyle",h="__builtInValidatorStyle",f="__builtInTableStyle",s=/^(__builtInTableStyle\d+)?__builtInStyle\d+$/,t.getFilterRange=A,u={double:6,dotted:4,dashed:3,solid:1},se.prototype.Ie=function(){var e=b.DefaultStyle.ah(this.we);this.Kg.Normal=0,this.Ke.push(e),this.Pg.push(e),this.Rg[e.name]=this.Ke.length-1},se.prototype.bh=function(e){var t=e.index;this.Qg[t]||(this.Qg[t]={}),this.Sg[t]||(this.Sg[t]={}),this.Tg[t]||(this.Tg[t]={}),this.Ug[t]||(this.Ug[t]={}),this.Vg[t]||(this.Vg[t]={})},se.prototype.dh=function(e,t){var r,n,o,i,a,s,l,u;if(!e||!t)return!1;if(r=!0,!Z.StringEx.q(t.fileName)&&(n=this.eh(t.fileType),!Z.StringEx.q(n))){for((o=new Y.OverrideContentType).partName=t.fileName,o.contentType=n,i=!1,a=0,s=e.length;a<s;a++)if((l=e[a])instanceof Y.OverrideContentType&&l.contentType===o.contentType&&l.partName===o.partName){i=!0;break}i||e.push(o)}if(t.relationFiles&&0<t.relationFiles.count)for(u in t.relationFiles)t.relationFiles.hasOwnProperty(u)&&"count"!==u&&(r=r&&this.dh(e,t.relationFiles[u]));return r},se.prototype.eh=function(e){if(Z.StringEx.q(e))return"";switch(e){case d.RelationshipConstants.Ua:return d.XFileConstants.Eb;case d.RelationshipConstants.Ra:return d.XFileConstants.Fb;case d.RelationshipConstants.Wa:return d.XFileConstants.Gb;case d.RelationshipConstants.Pa:return d.XFileConstants.Hb;case d.RelationshipConstants.Ta:return d.XFileConstants.Ib;case d.RelationshipConstants._a:return d.XFileConstants.Jb;case d.RelationshipConstants.ab:return d.XFileConstants.Kb;case d.RelationshipConstants.bb:return d.XFileConstants.Xb;case d.RelationshipConstants.eb:return d.XFileConstants.Lb;case d.RelationshipConstants.jb:return d.XFileConstants.bc;case d.RelationshipConstants.kb:return d.XFileConstants.cc;case d.RelationshipConstants.lb:return d.XFileConstants.Mb;case d.RelationshipConstants.mb:return d.XFileConstants.Ob;case d.RelationshipConstants.ob:return d.XFileConstants.Qb;case d.RelationshipConstants.pb:return d.XFileConstants.Pb;case d.RelationshipConstants.nb:return d.XFileConstants.Rb;case d.RelationshipConstants.qb:return d.XFileConstants.Pd;case d.RelationshipConstants.Ma:return d.XFileConstants.ae;case d.RelationshipConstants.Na:return d.XFileConstants.de;case d.RelationshipConstants.Oa:return d.XFileConstants.ge;case d.RelationshipConstants.Ya:return d.XFileConstants.$b;case d.RelationshipConstants.Za:return d.XFileConstants._b;case d.RelationshipConstants.$a:return d.XFileConstants.ac;default:return""}},se.prototype.fh=function(){var e,t,r=this,n=r.we;for(e in r.Ie(),r.gh(),n.sheets)if(n.sheets.hasOwnProperty(e)){if(!(t=n.sheets[e]))continue;r.hh(t),r.bh(t),r.ih(t),r.jh(t),r.kh(t),r.lh(t),r.mh(t)}!function(e){var t,r,n=e.sheets;if(n)for(t in n)n.hasOwnProperty(t)&&((r=n[t]).defaults=r.defaults||Z.Ga())}(r.we)},se.prototype.nh=function(){this.onCompleted&&this.onCompleted()},se.prototype.mh=function(e){var t,r,n=e.conditionalFormats&&e.conditionalFormats.rules;if(n)for(t=0;t<n.length;t++)(r=n[t]).style&&(r.style.isPartFontStyle=!0,r.style.isFormatStyle=!0,r.dxfId=this.oh(r.style));e.ph=this.qh(e),this.rh(e),this.sh(e),this.th(e)},se.prototype.oh=function(e){var t=this.Re.indexOf(e);return-1===t&&(t=this.Re.length,this.Re.push(e)),t},se.prototype.uh=function(e){var t=this.Xg.indexOf(e);return-1===t&&(t=this.Xg.length,this.Xg.push(e)),t},se.prototype.th=function(e){var s=this,t=e.slicers,l=s.vh();t&&0<t.length&&t.forEach(function(e){var t,r,n,o,i,a=e&&e.style;if(!Z.k(a.name)){if(t={},!oe(s.Mg,a)){for(r in t={styleElements:[],name:ie(s.Mg,a.name)},a.name=t.name,a)if(a.hasOwnProperty(r)&&"name"!==r&&!Z.k(a[r]))switch(r){case"headerStyle":case"wholeSlicerStyle":(n={}).type=r,n.dxfId=s.oh(V(a[r],"headerStyle"===r)),n.tableId=z(e.tableName,l),t.styleElements.push(n)}s.Lg.push(t)}if(!oe(s.Og,a)){for(i in o={styleElements:[],name:ie(s.Mg,a.name)},a.name=t.name,a)if(a.hasOwnProperty(i)&&"name"!==i&&!Z.k(a[i]))switch(i){case"selectedItemWithDataStyle":case"selectedItemWithNoDataStyle":case"unSelectedItemWithDataStyle":case"unSelectedItemWithNoDataStyle":case"hoveredSelectedItemWithDataStyle":case"hoveredSelectedItemWithNoDataStyle":case"hoveredUnSelectedItemWithDataStyle":case"hoveredUnSelectedItemWithNoDataStyle":o.styleElements.push({type:i,dxfId:s.uh(V(a[i]))})}s.Ng.push(o),s.Og[o.name]=a}}})},se.prototype.rh=function(e){var u=this,t=e.tables;t&&0<t.length&&t.forEach(function(e){var t,r,n,o,i,a,s,l=e&&e.style;if(!Z.k(l&&l.name)){if(oe(u.Mg,l))return;for(a in(t={styleElements:[]}).name=ie(u.Mg,l.name),l.name=t.name,i=o=n=r=void 0,l)if(l.hasOwnProperty(a)&&"name"!==a&&void 0!==l[a])switch(a){case"firstRowStripSize":r=l[a];break;case"secondRowStripSize":n=l[a];break;case"firstColumnStripSize":o=l[a];break;case"secondColumnStripSize":i=l[a];break;default:l[(s={}).type=a].isPartFontStyle=!0,s.dxfId=u.oh(l[a]),t.styleElements.push(s)}q(t,"firstRowStripStyle",r||1),q(t,"secondRowStripStyle",n||1),q(t,"firstColumnStripStyle",o||1),q(t,"secondColumnStripStyle",i||1),u.Lg.push(t),u.Mg[t.name]=l}})},se.prototype.sh=function(e){var t,r=e.tables,n=r?r.length:0;for(t=0;t<n;t++)r[t].tableSortInfo=this.wh(r[t].rowFilter);e.xh={},e.rowFilter&&(e.rowFilter.autoFilterSortInfo=this.wh(e.rowFilter))},se.prototype.jh=function(e){var t,r=e.rows,n=S(e);for(e.rowsVisibleInfo={},t=0;t<e.rowCount;t++)e.rowsVisibleInfo[t]={},e.rowsVisibleInfo[t].size=r&&r[t]&&r[t].size||n,e.rowsVisibleInfo[t].visible=this.yh(e,t)},se.prototype.kh=function(e){var t,r,n=e.columns,o=x(e),i=e.columnOutlines;for(e.columnVisibleInfo={},t=0;t<e.columnCount;t++)e.columnVisibleInfo[t]={},r=n&&n[t],e.columnVisibleInfo[t].size=r&&r.size||o,r&&!1===r.visible&&(e.columnVisibleInfo[t].visible=!1),l.isCollapsed(t,i)&&(e.columnVisibleInfo[t].visible=!1)},se.prototype.hh=function(e){e.rowCount===K&&(e.rowCount=200),e.columnCount===K&&(e.columnCount=20),e.activeRow===K&&(e.activeRow=0),e.activeCol===K&&(e.activeCol=0),e.visible===K&&(e.visible=!0)},se.prototype.lh=function(e){var t,r,n=e.index,o=this.Ug[n],i=e.columnCount,a=e.data&&e.data.defaultDataNode&&e.data.defaultDataNode.style;for(t=0;t<i;t++)r=this.Ah(e,-1,t),this.Bh(e,o,t,r,a)},se.prototype.ih=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G=this,U=e.index,W=e.data&&e.data.dataTable,V=e.data&&e.data.rowDataArray,z=G.Yg,q=G._g;if(0!==e.rowCount){if(t=G.Ch(W,e)+1,r=G.Sg[U],n=G.Tg[U],o=G.Dh(e,t),i=G.Vg[U],a=G.Eh(e),s=[],l=e.tables,!Z.k(l)&&Array.isArray(l))for(u=0;u<l.length;u++)for(f=(h=(c=l[u]).row)+c.rowCount-1,d=h;d<=f;d++)s[d]||(s[d]=!0);for(p=e.data&&e.data.defaultDataNode&&e.data.defaultDataNode.style,g=0;g<=a&&0<=g;g++)if(W&&W.hasOwnProperty(g+"")||V&&V[g]||s[g]){for(m=G.Bh(e,n,g,G.Ah(e,g,-1),p),b=W&&W[g],y=0;y<t&&0<=y;y++)if(C=$(e,g,y),b&&b.hasOwnProperty(y+"")||C){if(w=g*t+y,k=A=T=x=X,M=W&&W[g]&&W[g][y],I=K,E=!1,M&&(T=M.formula,A=M.prefix,R=(k=M.arrayInfo)&&k.isDynamicArray,D=M.value,Z.k(D)||(J(D)?Array.isArray(D)?x=D.join(","):((I=D.richText)&&(x=re(I)),(E=99<=D._code)&&z<3&&(z=R?2:3)):(x=D,R&&z<1&&(z=1)))),N=!1,C&&(N=!0,(F=ee(e,g,y))&&te(e,F)),S=(_=G.Fh(e,g,y,r,o[y],m,p,w,x)).styleName,v=_.styleInfo,N){if(!1!==C.showHeader&&g===C.row&&(x=C.columns[y-C.col]&&C.columns[y-C.col].name)&&-1!==x.indexOf("\n")&&I)for(P=0;P<I.length;P++)I[P].text=Z.Util.ya(I[P].text,"\r","");C.showFooter&&g===C.row+C.rowCount-1&&(x=(L=C.columns[y-C.col])&&L.footerValue,Z.k(x)||(x=""+x))}B=Q(B=(O=G.Gh(x,!Z.k(I))).value),j=O.cellType,!v&&!T&&B===X&&Z.StringEx.q(S)||((H=new Y.ExcelCell(g,y)).cellType=j,H.value=B,H.richText=I,H.isSpillError=E,G.Kf(r,w,v,S,H),G.Hh(T,k,H),G.Ih(U,g,H),G.Jh(H,e,g,y,q),A&&(H.prefix=A))}i[g]=57}G.Yg=z}},se.prototype.Eh=function(e){var t=this.Kh(e);return Math.min(e.rowCount-1,0<t.length?t.length:0)},se.prototype.Bh=function(e,t,r,n,o){var i,a;return n?((i=this.Lh(n)).parentName&&(a=this.Ke[this.Kg[i.parentName]],Z.la.ha(i,a)),this.Mh(i,o),Z.la.ga(i)||(t[r]=this.Nh(i),i.parentName&&w(this.Ke[this.Kg[i.parentName]],i,!0)||(i.parentName=X)),n):X},se.prototype.gh=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d=this,p=d.we,g={},m=[];for(t in g.Normal={},e=p.sheets)e.hasOwnProperty(t)&&d.Oh(e[t].namedStyles,g,m);for(d.Oh(p.namedStyles,g,m),n=[],o=0,i=(r=b.BuiltInExcelStyles.getBuiltInStyles()).length;o<i;o++)a=r[o],(s=b.ConverterHelper.toCellStyle(a.format())).name=a.name,n.push(s);for(this.Oh(n,g,m),o=0,i=d.Pg.length;o<i;o++)(l=d.Pg[o])&&l.parentName&&Z.la.ia(d.Pg,l);for(o=0,i=d.Ke.length;o<i;o++)l=d.Ke[o],(u=b.ConverterHelper.cloneSpreadJSStyle(l)).parentName=l.name,u.name="",d.Kg[l.name]=d.Ke.length,d.Ke.push(u),(c=v(l,m))&&(d.Kg[c.name]=d.Kg[l.name],c.added=!0);for(h=Z.la.da(p.namedStyles,"Normal"),o=0,i=m.length;o<i;o++)(f=m[o]).added||(w(f,h)?d.Kg[f.name]=0:(d.Kg[f.name]=d.Ke.length,d.Ke.push(f)))},se.prototype.Oh=function(e,t,r){var n,o,i,a,s,l;function u(e){var t,r,n="",o=Object.getOwnPropertyNames(e);for(t=0;t<o.length;t++)J(e[r=o[t]])?n+=r+":"+JSON.stringify(e[r])+"_":"name"!==r&&(n+=r+":"+e[r]+"_");return n}if(e)for(n={},o=0,i=e.length;o<i;o++)t[s=(a=e[o]).name]||(t[s]={},s.substring(0,23)===h||s.substring(0,19)===f||(s.substring(0,14)===c?r.push(a):(l=u(a),n.hasOwnProperty(l)?this.Rg[a.name]=n[l]:(this.Ke.push(a),this.Pg.push(a),this.Rg[a.name]=this.Ke.length-1,se.Ph[a.name]||(n[l]=this.Ke.length-1)))))},se.prototype.Ah=function(e,t,r){var n=e.data,o=X;return n?(t<0&&0<=r?o=n.columnDataArray&&n.columnDataArray[r]?n.columnDataArray[r].style:X:0<=t&&r<0?o=n.rowDataArray&&n.rowDataArray[t]?n.rowDataArray[t].style:X:0<=t&&0<=r&&(o=n.dataTable&&n.dataTable[t]&&n.dataTable[t][r]?e.data.dataTable[t][r].style:X),o):X},se.prototype.Qh=function(){var e,t,r,n=this.we,o=X;for(e in n.sheets)if(n.sheets.hasOwnProperty(e)&&(t=n.sheets[e])&&t.theme){o=t.theme;break}return o?g(o)?o:(r=o.name,Z.StringEx.C(r)?X:("OFFICE"===r.toUpperCase()&&(r="Office Theme"),new Y.ExcelTheme(r,this.Rh(o),this.Sh(o)))):X},se.prototype.Rh=function(e){var t=[];return t.push(n(e.themeColor.background1)),t.push(n(e.themeColor.text1)),t.push(n(e.themeColor.background2)),t.push(n(e.themeColor.text2)),t.push(n(e.themeColor.accent1)),t.push(n(e.themeColor.accent2)),t.push(n(e.themeColor.accent3)),t.push(n(e.themeColor.accent4)),t.push(n(e.themeColor.accent5)),t.push(n(e.themeColor.accent6)),t.push(n(e.themeColor.hyperlink)),t.push(n(e.themeColor.followedHyperlink)),new Y.ColorScheme(e.themeColor.name,t)},se.prototype.Sh=function(e){var t=new Y.ThemeFonts([new Y.RunFormatting(0,e.headingFont)],[]),r=new Y.ThemeFonts([new Y.RunFormatting(0,e.bodyFont)],[]);return new Y.FontScheme(e.name,t,r)},se.prototype.Th=function(e){return e=Math.min(e,d.ExcelConstants.rb-1),Z.IndexHelper.I(e)},se.prototype.Uh=function(e,t){var r=[],n=new d.DefaultContentType;return n.extension=d.XFileConstants.Ab,n.contentType=d.XFileConstants.Bb,r.push(n),(n=new d.DefaultContentType).extension=d.XFileConstants.Cb,n.contentType=d.XFileConstants.Db,r.push(n),(n=new d.DefaultContentType).extension=d.XFileConstants.gc,n.contentType=d.XFileConstants.ic,r.push(n),t&&((n=new d.DefaultContentType).extension=d.XFileConstants.hc,n.contentType=d.XFileConstants.ec,r.push(n)),(n=new d.DefaultContentType).extension=d.XFileConstants.jc,n.contentType=d.XFileConstants.kc,r.push(n),(n=new d.DefaultContentType).extension=d.XFileConstants.lc,n.contentType=d.XFileConstants.nc,r.push(n),(n=new d.DefaultContentType).extension=d.XFileConstants.qc,n.contentType=d.XFileConstants.sc,r.push(n),(n=new d.DefaultContentType).extension=d.XFileConstants.tc,n.contentType=d.XFileConstants.uc,r.push(n),(n=new d.DefaultContentType).extension=d.XFileConstants.vc,n.contentType=d.XFileConstants.wc,r.push(n),(n=new d.DefaultContentType).extension=d.XFileConstants.oc,n.contentType=d.XFileConstants.pc,r.push(n),(n=new d.DefaultContentType).extension=d.XFileConstants.xc,n.contentType=d.XFileConstants.yc,r.push(n),(n=new d.DefaultContentType).extension=d.XFileConstants.zc,n.contentType=d.XFileConstants.Ac,r.push(n),this.dh(r,e)?r:X},se.prototype.Vh=function(e){var t=this.we,r=t.sheets&&t.sheets[e];return this.Qg[r.index]},se.prototype.Wh=function(e){var t,r,n=[],o=this.we,i=o.sheets&&o.sheets[e],a=this.Kh(i),s=Math.min(i.rowCount-1,a.length),l=this.Xh(i.rowOutlines);for(t=0;t<=s;t++)a[t]?((r=this.Yh(i,t,l))||r.collapsed||!Z.k(r.outLineLevel)&&0!==r.outLineLevel||!1===r.visible||0<=r.formatId)&&(r.customHeight=!isNaN(r.height),n.push(r)):i.rowFilter&&this.Zh(i.rowFilter,t)&&((r=new Y.ExcelRow(t)).visible=!1,n.push(r));return n},se.prototype.Zh=function(e,t){var r,n,o=!1;if(e&&(r=e.filteredOutRows))for(n=0;n<r.length;n++)if(t===r[n]){o=!0;break}return o},se.prototype.yh=function(e,t){var r,n,o,i,a=e.rows,s=e.rowOutlines;if(a&&a[t]&&!1===a[t].visible)return!1;if(l.isCollapsed(t,s))return!1;if((r=e.rowFilter)&&0<t&&this.Zh(r,t))return!1;if(n=e.tables)for(o=0;o<n.length;o++)if(i=n[o],this.Zh(i.rowFilter,t))return!1;return!0},se.prototype.Yh=function(e,t,r){var n,o,i=new Y.ExcelRow(t),a=e.rowOutlines,s=e.rows&&e.rows[t];return i.height=b.UnitHelper.pixelToPoint(s&&void 0!==s.size?s.size:S(e)),0<=r&&(i.collapsed=this.$h(t,a),n=this._h(t,a),i.outLineLevel=-1===n?0:n),t<e.rowCount&&(i.visible=this.yh(e,t)),Z.k(this.Tg[e.index])||(o=this.Tg[e.index][t],i.formatId=Z.k(o)?-1:o),i},se.prototype.Kh=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p=this.Wg[e.index];if(void 0!==p)return p;if(p=[],t=e.rows,r=e.data&&e.data.rowDataArray,n=e.data&&e.data.dataTable,t)for(o=0,i=t.length;o<i;o++)t[o]&&(p[o]=!0);if(r)for(o=0,i=r.length;o<i;o++)r[o]&&(p[o]=!0);if(n)for(a in n)n[a]&&n.hasOwnProperty(a)&&(p[a]=!0);if((s=e.tables)&&s.forEach(function(e){var t,r=e.row,n=e.row+e.rowCount;for(t=r;t<n;t++)p[t]=!0}),l=e.spans)for(i=l.length,u=0;u<i;u++)for(h=(c=l[u]).row;h<c.row+c.rowCount;h++)p[h]=!0;if(f=e.rowOutlines&&e.rowOutlines.itemsData)for(o=0,i=f.length;o<i;o++)for(a=(d=f[o]).index;a<d.index+d.count;a++)p[a]=!0;return this.Wg[e.index]=p},se.prototype.ai=function(e){var t,r,n=[],o=this.we,i=o.sheets&&o.sheets[e],a=this.Xh(i.columnOutlines),s=i.columnCount;for(t=0;t<s;t++)(r=this.bi(i,t,a))&&(1e-4<Math.abs(r.width-this.ci(e))||r.collapsed||void 0!==r.outLineLevel&&r.outLineLevel!==X&&0!==r.outLineLevel||!1===r.visible||0<=r.formatId)&&n.push(r);return n},se.prototype._h=function(e,t){var r,n,o,i;if(!t||!t.itemsData)return 0;for(n=0,o=(r=t.itemsData).length;n<o;n++)if(e>=(i=r[n]).index&&e<i.index+i.count)return i.info?i.info.level+1:1;return 0},se.prototype.$h=function(e,t){var r,n,o,i;if(!t||!t.itemsData)return!1;for(n=0,o=(r=t.itemsData).length;n<o;n++)if(e>=(i=r[n]).index&&e<i.index+i.count)return!!i.info&&!!i.info.collapsed;return!1},se.prototype.bi=function(e,t,r){var n,o,i=new Y.ExcelColumn(t),a=e.columnOutlines,s=e.columns&&e.columns[t];return i.width=this.calcColumnWidth(s&&void 0!==s.size?s.size:x(e)),0<=r&&t<e.columnCount&&(i.collapsed=this.$h(t,a),n=this._h(t,a),i.outLineLevel=-1===n?0:n),t<e.columnCount&&(s&&!1===s.visible&&(i.visible=!1),l.isCollapsed(t,a)&&(i.visible=!1)),Z.k(this.Ug[e.index])||(o=this.Ug[e.index][t],i.formatId=Z.k(o)?-1:o),i},se.prototype.Xh=function(e){var t,r,n,o;if(!e||!e.itemsData)return-1;for(t=-1,r=0,n=e.itemsData.length;r<n;r++)(o=e.itemsData[r]).info&&o.info.level>t&&(t=o.info.level);return t},se.prototype.di=function(e){var t,r,n=this.we,o=n.sheets&&n.sheets[e],i=0,a=0,s=-1,l=o.rowOutlines;return l&&(s=this.Xh(l)),-1!==s&&(i=s+2),t=-1,(r=o.columnOutlines)&&(t=this.Xh(r)),-1!==t&&(a=t+2),{outlineLevelRow:i,outlineLevelColumn:a}},se.prototype.ei=function(e){var t=this.we,r=t.sheets&&t.sheets[e],n=b.UnitHelper.pixelToPoint(r.defaults?r.defaults.rowHeight:S(r));return{height:n,customHeight:2<=Math.abs(57-n)}},se.prototype.ci=function(e){var t=this.we,r=t.sheets&&t.sheets[e];return this.calcColumnWidth(r.defaults?r.defaults.colWidth:x(r))},se.prototype.fi=function(e){var t,r=this.we,n=r.sheets&&r.sheets[e];if(n.defaults&&n.defaults.colWidth&&!0!==n.defaults._isExcelDefaultColumnWidth)return t=n.defaults?n.defaults.colWidth:x(n),this.calcColumnWidth(t)},se.prototype.calcColumnWidth=function(e){var t,r,n;return 0===e?0:(t=se.ah(this.we),r=Math.round(this.gi(t.font)),n=Math.floor((e-5)/r*100+.5)/100,Math.floor((n*r+5)/r*256)/256)},se.prototype.gi=function(e){return this.yf===K&&(this.yf=b.UnitHelper.getMaxiumDigitWidth(e)),this.yf},se.prototype.hi=function(e,t,r,n){var o,i,a,s,l,u,c,h=this.we,f=h.sheets&&h.sheets[e];if(!f)return!1;if(o=f.frozenRowCount,i=f.frozenColCount,r.col=0<=f.activeCol?f.activeCol:0,r.row=0<=f.activeRow?f.activeRow:0,a=0<o,s=0<i,0===n){if(!a||!s)return!1}else if(1===n){if(!s)return!1;a&&(r.col=i,r.row=0)}else if(2===n){if(!a)return!1;s&&(r.col=0,r.row=o)}if(r.col=Math.min(d.ExcelConstants.rb,r.col),r.row=Math.min(d.ExcelConstants.sb,r.row),t)if(l=void 0,f.selections)for(u=0;u<f.selections.length;u++)J(c=f.selections[u])&&(l=new Z.Range(0<c.row?c.row:0,0<c.col?c.col:0,0<c.rowCount?c.rowCount:d.ExcelConstants.sb,0<c.colCount?c.colCount:d.ExcelConstants.rb),t.push(l));else t.push(new Z.Range(r.row,r.col,1,1));return!0},se.prototype.Ih=function(e,t,r){Z.k(this.Qg[e][t])&&(this.Qg[e][t]=[]),this.Qg[e][t].push(r)},se.prototype.ii=function(e,t){var r,n,o;if(g(e)&&"/OADate"===e.substring(0,7)&&t&&!t.formatter){if(t.autoFormatter)return void(t.formatter=t.autoFormatter.formatCached);r=e.indexOf("("),n=e.indexOf(")"),-1!==r&&-1!==n&&((o=parseInt(e.substring(r+1,n),10))<1?t.formatter="h:mm:ss":1<o&&(t.formatter="M/d/yyyy"))}},se.prototype.Kf=function(e,t,r,n,o){var i;Z.StringEx.q(n)?r&&void 0!==(i=e[t])?o.formatId=i:o.formatId=-1:void 0!==(i=this.Kg[n])?o.formatId=i:o.formatId=-1},se.prototype.Hh=function(e,t,r){Z.StringEx.C(e)||(r.formula=e,t?(r.isArrayFormula=!0,r.cellType=8,(r.arrayFormulaRange=t).isDynamicArray&&(r.isDynamicArray=!0)):r.cellType=3)},se.prototype.Jh=function(e,t,r,n,o){var i,a,s,l,u,c,h,f;if(t.data&&t.data.dataTable&&t.data.dataTable[r]&&(i=t.data.dataTable[r][n]&&t.data.dataTable[r][n].hyperlink)){if(l=!(a={}),s=this.ji(t.name))for(u=0;u<s.length;u++)if((c=s[u]).row===r&&c.col===n){a.ref=Z.IndexHelper.I(c.col)+(c.row+1)+":"+Z.IndexHelper.I(c.col+c.colCount-1)+(c.row+c.rowCount),l=!0;break}l||(a.ref=Z.IndexHelper.I(n)+(r+1)),h="sjs://",i.url.substring(0,h.length)===h?(a.location=Z.Util.sa(i.url.replace(h,"")),"string"==typeof(f=t.data.dataTable[r][n].value)&&(a.display=Z.Util.sa(f))):a.url=Z.Util.sa(i.url),i.tooltip&&(a.tooltip=Z.Util.sa(i.tooltip)),a["xr:uid"]=Z.Ja(),o[t.name]||(o[t.name]=[]),o[t.name].push(a)}},se.prototype.Gh=function(e,t){var r=0;if(Z.k(e))e=X;else{if(e._error)return r=7,{value:e._error,cellType:r};"number"==typeof e?(r=1,isNaN(e)&&(e=0)):"boolean"==typeof e?r=5:g(e)&&"/OADate"===e.substring(0,7)?r=6:t?r=9:g(e)?r=2:(r=2,e=""+e)}return{value:e,cellType:r}},se.prototype.Lh=function(e){var t;return J(e)?b.ConverterHelper.cloneSpreadJSStyle(e):g(e)?s.test(e)?(t=e.indexOf(c),b.ConverterHelper.cloneSpreadJSStyle(this.Ke[this.Kg[e.substring(t)]])):{parentName:e}:void 0},se.prototype.Mh=function(e,t){var r;t&&(t=this.Lh(t),Z.la.ha(e,t,!0),t.parentName&&(r=this.Ke[this.Kg[t.parentName]],Z.la.ha(e,r)))},se.prototype.ki=function(e,t){Z.k(t.linkColor)?t.linkColor===K&&e.foreColor||(e.foreColor="hyperlink"):e.foreColor=t.linkColor,Z.k(e.textDecoration)?e.textDecoration=1:1!=(1&e.textDecoration)&&(e.textDecoration+=1)},se.prototype.Fh=function(e,t,r,n,o,i,a,s,l){var u,c=this,h=e.data,f=c.Ah(e,t,r),d=X,p=X,g=h&&h.dataTable&&h.dataTable[t]&&h.dataTable[t][r]&&h.dataTable[t][r].hyperlink;return f?d=c.Lh(f):(l!==X&&void 0!==l||g)&&(d={}),d&&(d.parentName&&(u=c.Ke[c.Kg[d.parentName]]||c.Ke[c.Rg[d.parentName]],Z.la.ha(d,u)),c.Mh(d,i),c.Mh(d,o),c.Mh(d,a),g&&c.ki(d,g),c.ii(l,d),Z.la.ga(d)?d=X:(n[s]=c.Nh(d),d.parentName&&w(c.Ke[c.Kg[d.parentName]],d,!0)&&(p=d.parentName),d.name&&w(c.Ke[c.Kg[d.name]],d,!0)&&(p=d.name))),{styleName:p,styleInfo:d}},se.prototype.Nh=function(e){var t,r,n=this.Ke;if(!e)return 0;if(!Z.StringEx.C(e.name)){for((t=b.ConverterHelper.cloneSpreadJSStyle(e)).name=K,t.parentName=e.name,r=n.length-1;0<=r;r--)if(Z.la.ka(n[r],t))return r;return n.push(t),n.length-1}for(r=n.length-1;0<=r;r--)if(Z.la.ka(n[r],e))return r;return n.push(e),n.length-1},se.prototype.li=function(e){var t,r;if(!e)return 0;for(r in t=0,e)e.hasOwnProperty(r)&&parseInt(r,10)>t&&(t=parseInt(r,10));return t},se.prototype.Ch=function(e,t){var r,n,o,i=0;if(e)for(r in e)if(e.hasOwnProperty(r))for(n in e[r])parseInt(n,10)>i&&(i=parseInt(n,10));return(o=t.tables)&&o.forEach(function(e){e.col+e.colCount>i&&(i=e.col+e.colCount)}),i},se.prototype.mi=function(e,t,r){for(r++;0<=r&&r<t&&!e[r];)r++;return r<t?r:-1},se.prototype.ni=function(e,t,r,n,o){var i=X;if(0<=n&&n<t&&(i=e[n]),!i)return-1;for(o++;0<=o&&o<r&&!i[o];)o++;return o<r?o:-1},se.prototype.Dh=function(e,t){var r,n,o=[],i=e.columnCount;if(!e.data||!e.data.columnDataArray)return o;for(r=0;r<t;r++)r<i?(n=this.Ah(e,-1,r),o.push(n)):o.push(X);return o},se.prototype.oi=function(){var e,t,r,n,o,i,a=[],s={count:0};for(e=0,t=this.Ke.length;e<t;e++)r=this.Ke[e],n=b.ConverterHelper.toExtendedFormat(r),r.name&&r.name.substring(0,c.length)!==c?(s[r.name]||(s[r.name]=s.count,s.count++),n.isStyleFormat=!0):(void(o=0)!==s[r.parentName]&&s[r.parentName]!==X&&(i=a[o=s[r.parentName]],!n.applyNumberFormat&&i&&(i.numberFormat?n.numberFormat=i.numberFormat:void 0!==i.numberFormatIndex&&(n.numberFormatIndex=i.numberFormatIndex))),n.parentFormatID=o),a.push(n);return a},se.prototype.pi=function(){var e=b.ConverterHelper.cloneSpreadJSStyle(se.ah(this.we)),t=b.ConverterHelper.toExtendedFormat(e);return t.parentFormatID=0,t},se.prototype.qi=function(){var e,t,r,n,o,i,a,s=[],l=X;for(e=0,t=this.Pg.length;e<t;e++)if("Normal"===(r=this.Pg[e]).name){(n=new b.ExcelStyle).name="Normal",n.format(b.ConverterHelper.toExtendedFormat(r)),n.format().isStyleFormat=!0,n.builtInStyle=0,l=n,this.te=r;break}for(l||((o=new b.ExcelStyle).name="Normal",o.format(b.ConverterHelper.toExtendedFormat(se.ah(this.we))),o.format().font.fontSize=14.67,o.format().isStyleFormat=!0,o.builtInStyle=0,s.push(o)),e=0,t=this.Pg.length;e<t;e++)(i=this.Pg[e]).name&&(void 0!==se.Ph[i.name]?((n=new b.ExcelStyle).name=i.name,n.format(b.ConverterHelper.toExtendedFormat(i)),n.format().isStyleFormat=!0,n.builtInStyle=se.Ph[i.name],("RowLevel_"===i.name.substring(0,9)||"ColLevel_"===i.name.substring(0,9))&&9<i.name.length&&(n.outLineLevel=parseInt(i.name.substring(9),10)-1),s.push(n)):((a=new b.CustomExcelStyle).name=i.name,a.format(b.ConverterHelper.toExtendedFormat(i)),a.format().isStyleFormat=!0,s.push(a)));return s},se.prototype.ri=function(){var e,t=[],r=this.we.sheets;for(e in r)r.hasOwnProperty(e)&&(t[r[e].index]=e);return t},se.prototype.si=function(e){return this.we.sheets[e]},se.prototype.ti=function(e){var t=this.we,r=t.sheets&&t.sheets[e];return r?{colsSumRight:!(r.columnOutlines&&0===r.columnOutlines.direction),rowsSumBelow:!(r.rowOutlines&&0===r.rowOutlines.direction)}:{}},se.prototype.ui=function(e){var t=this.we,r=t.sheets&&t.sheets[e];return r?a(r.sheetTabColor):X},se.prototype.vi=function(e){var t=this.we,r=t.sheets&&t.sheets[e];return r?{rowCount:r.rowCount,columnCount:r.columnCount}:{}},se.prototype.wi=function(e){var t,r=this.we,n=r.sheets&&r.sheets[e],o={showGridLine:!0,showRowColHeaders:!0,gridlineColor:X,zoom:1};return n&&(!n.gridline||!1!==n.gridline.showVerticalGridline&&!1!==n.gridline.showHorizontalGridline||(o.showGridLine=!1),!1===n.rowHeaderVisible&&!1===n.colHeaderVisible&&(o.showRowColHeaders=!1),n.gridline&&n.gridline.color&&(o.gridlineColor=b.ColorHelper.toExcelIndexedColor(a(n.gridline.color,4291876837))),void 0!==n.topCellIndex&&void 0!==n.leftCellIndex&&(t={row:n.topCellIndex,col:n.leftCellIndex},o.topLeftCell=t),o.zoom=n.zoomFactor),o},se.prototype.xi=function(e){var t=this.we,r=t.sheets&&t.sheets[e],n={frozenRowCount:0,frozenColCount:0};return r&&(n.frozenRowCount=r.frozenRowCount||0,n.frozenColCount=r.frozenColCount||0),n},se.prototype.yi=function(e){var t=this.we,r=t.sheets&&t.sheets[e];return!!r&&r.isProtected},se.prototype.zi=function(e,t){var r,n,o=this.we,i=(o.sheets&&o.sheets[e]).protectionOptions,a={};for(n in i)i.hasOwnProperty(n)&&((r=i[n])&&"allowSelectLockedCells"===n||r&&"allowSelectUnlockedCells"===n||r&&"allowEditObjects"===n||(a[l.fromProtectionOptions[n]?l.fromProtectionOptions[n]:n]=i[n]));return t&&!i&&(a.objects=!1),a},se.prototype.ji=function(e){var t=this.we,r=t.sheets&&t.sheets[e];return r?r.spans:[]},se.prototype.Ai=function(){var e=this.we;return{showHorizontalScrollbar:e.showHorizontalScrollbar,showVerticalScrollbar:e.showVerticalScrollbar,tabStripVisible:e.tabStripVisible,tabStripRatio:e.tabStripRatio,startSheetIndex:e.startSheetIndex,activeSheetIndex:e.activeSheetIndex}},se.prototype.Bi=function(e){var t=this.we,r=t.sheets&&t.sheets[e];return!r||!1===r.visible},se.prototype.Ci=function(){var e,t,r,n,o,i=[];if(this.we.names)for(t=0;t<this.we.names.length;t++)e=this.we.names[t],i.push({name:e.name,localSheetId:-1,formula:e.formula,comment:e.comment});for(n in r=this.we.sheets)if(r.hasOwnProperty(n)&&(o=r[n]).names)for(t=0;t<o.names.length;t++)e=o.names[t],i.push({name:e.name,localSheetId:o.index,formula:e.formula,comment:e.comment});return i},se.prototype.Zf=function(e){return(this.we.sheets&&this.we.sheets[e]).conditionalFormats},se.ah=function(e){var t,r,n,o,i,a,s={foreColor:"black",font:"normal normal normal 11pt/normal Calibri",locked:!0,name:"Normal",textDecoration:0,hAlign:3,vAlign:0,formatter:"General"};for(t in e.sheets)if(e.sheets.hasOwnProperty(t)&&(r=e.sheets[t]).data&&r.data.defaultDataNode&&r.data.defaultDataNode.style){for(n=r.data.defaultDataNode.style,i=(o=this.prototype.Lh(n)).parentName;i&&(a=G(i,e,r));)Z.la.ha(o,a),i=a.parentName;return Z.la.ha(o,s),o}return s},se.prototype.Di=function(e){var t=this.we,r=t.sheets&&t.sheets[e];return r.comments&&r.comments.map(function(e){return l.convertToExcelComment(r,e)})},se.prototype.Ei=function(e){var t=this.we;return(t.sheets&&t.sheets[e]).pivotTables},se.prototype.Fi=function(t){return t.floatingObjects&&t.floatingObjects.filter(function(e){return"1"===e.typeName&&e.src&&-1!==e.src.indexOf(";base64,")}).map(function(e){return l.convertToExcelPicture(t,e)})},se.prototype.Gi=function(e){var t=this.we;return(t.sheets&&t.sheets[e]).sparklineGroups},se.prototype.qh=function(n){var o,i,e,a=n.rowFilter,s=this;if(a)return o=[],i=a.filteredColumns,(e=a.filterItemMap)&&i&&0<i.length&&e.forEach(function(e){var t,r;i.indexOf(e.index)<0||3===(t=e.conditions[0]).conType&&(r=0===t.compareType,o.push({autoFilterColumnId:e.index-A(n,a.range).col,colorFilter:{cellColor:r,dxfId:s.oh({isColorFilter:!0,fill:b.ColorHelper.toExcelBackColor(t.expected,r)})}}))}),o},se.prototype.wh=function(e){var t,r,n=X;return e&&(!(t=e.sortInfo)||Z.k(t.ascending)||Z.k(t.index)||(n={range:new Z.Range(e.range.row,t.index,e.range.rowCount,1),descending:!t.ascending},t.color!==K&&(r=t.isBackColor,n.isBackColor=r,"{"===t.color[0]&&(t.color=JSON.parse(t.color)),n.dxfid=this.oh({isColorFilter:!0,fill:b.ColorHelper.toExcelBackColor(t.color,r)})))),n},se.prototype.Hi=function(e,o){var t=e.autoFilter,i={range:"A1",filterColumns:[]},r=t.filterItemMap;return r&&r.forEach(function(e){var t,r,n;e&&(t={autoFilterColumnId:0},r=B(e.conditions[0],o),Z.k(r)||(1===(n=r.filterType)?t.top10=r:2===n?t.dynamicFilter=r:4===n&&(t.customFilters=r),i.filterColumns.push(t)))}),i},se.prototype.Ii=function(e,t,r){var s,l,u,n,o=this.we,c=o.sheets&&o.sheets[e];return Z.k(t)||Z.k(t.range)?X:(s=t.range,l={range:A(c,s),filterColumns:[]},c.ph&&0<c.ph.length&&(l.filterColumns=c.ph),u=t.filteredColumns,(n=t.filterItemMap)&&u&&0<u.length&&n.forEach(function(e){var t,r,n,o,i,a;if(!(e.index<s.col||e.index>=s.col+s.colCount||u.indexOf(e.index)<0)){for(r=(t=e.conditions)[0],n=1;n<t.length;n++)r={conType:0,compareType:0,item1:r,item2:t[n]};r&&(o={autoFilterColumnId:e.index-l.range.col},i=O(c,r,new Z.Range(l.range.row+1,l.range.col,l.range.rowCount-1,1)),Z.k(i)||(1===(a=i.filterType)?o.top10=i:2===a?o.dynamicFilter=i:3===a?o.filters=i:4===a&&(o.customFilters=i),l.filterColumns.push(o)))}}),l.sortInfo=r,l)},se.prototype.Ji=function(e){var t=this.we,r=t.sheets&&t.sheets[e],n=X;return r.rowFilter&&(n=r.rowFilter.autoFilterSortInfo),this.Ii(e,r.rowFilter,n)},se.prototype.vh=function(e){var t,r=[],n=this.we;if(e)return n.sheets[e].tables;for(t in n.sheets)n.sheets[t].tables&&(r=r.concat(n.sheets[t].tables));return r},se.prototype.Ki=function(e){var t=this.we.sheets[e];return t.slicers&&t.slicers.map(function(e){return l.convertToExcelSlicer(t,e)})},se.prototype.Li=function(t){return t.charts&&t.charts.map(function(e){return l.convertToExcelChart(t,e)})},se.prototype.Mi=function(t){return t.shapes&&t.shapes.map(function(e){return l.convertToExcelShape(t,e)})},se.prototype.Ni=function(e){var t=this.we,r=t.sheets&&t.sheets[e],n=this.Ki(e),o=this.Fi(r),i=this.Li(r),a=this.Mi(r),s=0;return[n,o,i,a].forEach(function(e){e&&(s+=e.length)}),{slicers:n,pictures:o,charts:i,shapes:a,withDrawingObjects:0<s}},se.prototype.Oi=function(e){var t=this.we,r=[],n=(t.sheets&&t.sheets[e]).validations;return n&&U(n,r,e,this.ri()),r},se.prototype.Pi=function(e){var t=this.we,r=(t.sheets&&t.sheets[e]).printInfo,n=r&&r.margin;return n?{bottom:ae(n.bottom),top:ae(n.top),left:ae(n.left),right:ae(n.right),header:ae(n.header),footer:ae(n.footer)}:X},se.prototype.Qi=function(e){var t,r=this.we,n=(r.sheets&&r.sheets[e]).printInfo;if(n)return{horizontalCentered:1===(t=n.centering)||3===t,verticalCentered:2===t||3===t,printGridLine:n.showGridLine,printRowColumnsHeaders:2===n.showRowHeader&&2===n.showColumnHeader}},se.prototype.Ri=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p;function g(e,t,r){return"&L"+(e=e||"")+"&C"+(t=t||"")+"&R"+(r=r||"")}return(o=(n=(r=this.we).sheets&&r.sheets[e]).printInfo)?(i={},a=o.fitPagesTall,s=o.fitPagesWide,Z.k(a)||-1===a||(i.useSmartPrint=!0,i.smartPrintPagesHeight=Math.max(1,a)),Z.k(s)||-1===s||(i.useSmartPrint=!0,i.smartPrintPagesWidth=Math.max(1,s)),t||(o.paperSize&&0!==(l=o.paperSize.kind)&&(i.paperSizeIndex=l),i.copies=1,Z.k(o.firstPageNumber)||(i.useCustomStartingPage=!0,i.firstPageNumber=o.firstPageNumber),i.orientation=2===o.orientation?2:1,i.pageOrder=1===o.pageOrder?1:2,i.zoomFactor=parseFloat(o.zoomFactor),i.showColor=!o.blackAndWhite,u=g(o.headerLeft,o.headerCenter,o.headerRight),c=g(o.footerLeft,o.footerCenter,o.footerRight),i.advancedHeadFooterSetting={headerEvenPage:u,headerOddPage:u,footerOddPage:c,footerEvenPage:c},h=n.rows,f=[],h&&0<h.length&&h.forEach(function(e,t){e&&e.pageBreak&&f.push(t)}),d=n.columns,p=[],d&&0<d.length&&d.forEach(function(e,t){e&&e.pageBreak&&p.push(t)}),0<f.length&&(i.rowBreakLines=f),0<p.length&&(i.columnBreakLines=p)),i):X},se.prototype.Si=function(e){return this.we.sheets&&this.we.sheets[e].printInfo},se.prototype.Ti=function(e){return this.we.sheets&&this.we.sheets[e].rowFilter},se.prototype.Ui=function(e){var t,r,n;function o(e,t){var r={name:e};return l.getPictureInfo(t,r),r}return n=[],(r=((t=this.we).sheets&&t.sheets[e]).printInfo)&&(r.headerLeftImage&&n.push(o("LH",r.headerLeftImage)),r.headerCenterImage&&n.push(o("CH",r.headerCenterImage)),r.headerRightImage&&n.push(o("RH",r.headerRightImage)),r.footerLeftImage&&n.push(o("LF",r.footerLeftImage)),r.footerCenterImage&&n.push(o("CF",r.footerCenterImage)),r.footerRightImage&&n.push(o("RF",r.footerRightImage))),n},se.prototype.Vi=function(){return this.Rg},se.Ph={"20% - Accent1":30,"20% - Accent2":34,"20% - Accent3":38,"20% - Accent4":42,"20% - Accent5":46,"20% - Accent6":50,"40% - Accent1":31,"40% - Accent2":35,"40% - Accent3":39,"40% - Accent4":43,"40% - Accent5":47,"40% - Accent6":51,"60% - Accent1":32,"60% - Accent2":36,"60% - Accent3":40,"60% - Accent4":44,"60% - Accent5":48,"60% - Accent6":52,Accent1:29,Accent2:33,Accent3:37,Accent4:41,Accent5:45,Accent6:49,Bad:27,Calculation:22,"Check Cell":23,Comma:3,"Comma [0]":6,Currency:4,"Currency [0]":7,"Explanatory Text":53,Good:26,"Heading 1":16,"Heading 2":17,"Heading 3":18,"Heading 4":19,Input:20,"Linked Cell":24,Neutral:28,Normal:0,Note:10,Output:21,Percent:5,Title:15,Total:25,"Warning Text":11,Hyperlink:8,FollowedHyperLink:9,RowLevel_1:1,RowLevel_2:1,RowLevel_3:1,RowLevel_4:1,RowLevel_5:1,RowLevel_6:1,RowLevel_7:1,ColLevel_1:2,ColLevel_2:2,ColLevel_3:2,ColLevel_4:2,ColLevel_5:2,ColLevel_6:2,ColLevel_7:2},t.WriterDataModel=se},"./src/datamodel/datetime-helper.ts":function(e,t,r){"use strict";var c;function u(e){var t=e.getTimezoneOffset();return-485===t&&(t=-485-43/60),t}function l(){}Object.defineProperty(t,"__esModule",{value:!0}),c=r("./src/common/common.ts"),l.Pf=function(e){return"/OADate("+e+")/"},l.Wi=function(e){return"string"==typeof e&&"/OADate("===e.substr(0,8)?parseInt(e.substr(8,e.length-8-1-1),10):e},l.Of=function(e){return null==e?0:("number"!=typeof e&&"string"!=typeof e||(e=new Date(e)),e instanceof Date?(1440*e.getTime()+3181192704e6-864e5*u(e))/124416e6:0)},l.se=function(e){var t,r=e-25569,n=0<=r?1:-1,o=u(new Date(864e5*r)),i=(864e5*e*1440+n-3181192704e6+864e5*o)/1440,a=new Date(i),s=0<=o?1:-1,l=u(new Date(i+36e5*s));if(o!==l)if(t=new Date(i+60*(l-o)*1e3),l<o){if(-1==s||l===u(a))return 999===t.getMilliseconds()?new Date(t.valueOf()+1):t}else if(o<l&&(1==s||l===u(a)))return 999===t.getMilliseconds()?new Date(t.valueOf()+1):t;return 999===a.getMilliseconds()?new Date(a.valueOf()+1):a},l.af=function(e){var t,r,n,o,i,a,s;if(!e||" "===e)return!1;if(0===e.length)return!1;if(-1!==(e=(e=(e=(e=e.toUpperCase()).replace(/(\[.*\])+/g," ")).replace(/"[^"]*"/g," ")).replace(/(\*.|_.|\\.)+/g," ")).indexOf("GENERAL"))return!1;for(n=!(t=-1),o=null,i=r=0;i<e.length;i++){if("["===(a=e[i]))for(;a=e[i],++i<e.length&&"]"!==a;);if("Y"===a||"D"===a||"M"===a||"H"===a||"S"===a||"A"===a)n?r++:(0===i||0<e.length&&"\\"!==e[i-1])&&(n=!0,t=i,r=1);else{if(n=!1," "===a&&o)return!0;0!==r&&(s=e.substring(t,t+r),t=i,r=0,o=(null===o||o)&&l.Xi(s))}}return 0!==r&&i===e.length&&(s=e.substring(t,t+r),o=(null===o||o)&&l.Xi(s)),!!o},l.Xi=function(e){var t,r,n,o,i,a,s,l,u;if(c.StringEx.C(e))return!1;for(t=[],r="",n=0,o=e.length;n<o;n++)i=e[n],-1===r.indexOf(i)&&(t.push({key:i,count:e.match(RegExp(i,"g")).length}),r+=i);for(a={Y:4,D:4,M:5,H:2,S:2,A:4},n=0,s=t.length;n<s;n++){if(void 0===(u=a[(l=t[n]).key]))return!1;if(l.count>u)return!1}return!0},t.DateTimeHelper=l},"./src/datamodel/excel-helper.ts":function(e,t,r){"use strict";var C,w,b,v,a,o,s,y,i;function R(e,t,r){var n,o=e.defaults.colWidth,i=e.columns,a=0,s=i?v:o;for(n=t;n<r;n++)a+=s||u(i,n,o,e.columnOutlines);return a}function u(e,t,r,n){var o=e[t];return o?n&&d(t,n)||!1===o.visible?0:o.size:r}function D(e,t,r){var n,o=e.defaults.rowHeight,i=e.rows,a=0,s=i?v:o;for(n=t;n<r;n++)a+=s||c(i,n,o,e.rowOutlines);return a}function c(e,t,r,n){var o=e[t];return o?n&&d(t,n)||!1===o.visible?0:o.size:r}function l(e,t){for(var r,n,o=e.defaults.colWidth,i=e.columnVisibleInfo,a=0,s=0,l=i?v:o;a<t;)a+=r=l||u(i,s,o),s++;return 0<(n=a-t)&&(s--,n=r-n),{col:s,colOffset:n}}function h(e,t){for(var r,n,o=e.defaults.rowHeight,i=e.rowsVisibleInfo,a=0,s=0,l=i?v:o;a<t;)a+=r=l||c(i,s,o),s++;return 0<(n=a-t)&&(s--,n=r-n),{row:s,rowOffset:n}}function f(e,t){var r=t.x,n=t.y,o={},i={},a=h(e,n);return x(a,o,["row","rowOffset"]),x(a=l(e,r),o,["col","colOffset"]),x(a=h(e,n+t.height),i,["row","rowOffset"]),x(a=l(e,r+t.width),i,["col","colOffset"]),{startPoint:o,endPoint:i}}function d(e,t){return!!t&&(t.items?t.items[e]&&t.items[e].viewCollapsed:!!t.itemsData&&(t.collapseIndexMap||function(e){var t,r,n,o,i,a,s,l=e.itemsData,u=e.collapseIndexMap={};if(0===e.direction){for(t=l.length-1;0<=t;t--)if((n=l[t])&&1===n.count&&n.info&&n.info.collapsed){for(o=n.index+n.count,i=t+1;i<l.length;i++)(a=l[i])&&a.info&&a.info.level>n.info.level&&a.index===o&&(o=a.index+a.count);for(s=n.index+1;s<o;s++)u[s]=!0}}else for(t=0,r=l.length;t<r;t++)if((n=l[t])&&1===n.count&&n.info&&n.info.collapsed){if((o=n.index-1)<0&&-1===n.info.level)break;for(i=t-1;0<=i;i--)(a=l[i])&&a.info&&a.info.level>n.info.level&&a.index+a.count-1===o&&(o=a.index-1);for(s=o+1;s<n.index;s++)u[s]=!0}}(t),!!t.collapseIndexMap[e]))}function x(t,r,e){e.forEach(function(e){void 0!==t[e]&&(r[e]=t[e])})}function S(e){return e?w.UnitHelper.pointToPixel(parseFloat(e.replace("pt",""))):0}function T(e){return!e||"hidden"===e}function A(e){switch(e){case"dotted":return"dot";case"dashed":return"dash";case"double":return"dbl"}return"solid"}function p(e,t){var r,n=e.indexOf(o);0<n&&(t.base64Image=e.substr(n+o.length),"x-icon"===(r=e.substr(0,n).split("/").pop())&&(r="png"),t.imageType=r)}function k(r,e,t){function n(e){var t=function(e){return e.name===this.name}.bind({name:e});return void 0!==r.filter(t)[0]}for(var o=e=e||t,i=1;n(o);)o=e+"_"+i++;return o}function M(e,t){var r,n,o,i,a;return e&&((r=e.fillFormat)&&1===r.fillFormatType&&(t.backColor=w.ColorHelper.toRGBColor(r.color)),void((n=e.lineFormat)&&(t.borderWidth=n.width,(o=n.fillFormat)&&1===o.fillFormatType?t.borderColor=w.ColorHelper.toRGBColor(o.color):o&&0===o.fillFormatType&&(t.noFill=!0),(i=n.lineDashType)&&(a=n.compoundLineType,t.borderStyle=function(e,t){switch(e){case"solid":return"dbl"===t?"double":"solid";case"dot":case"sysDot":return"dotted"}return"dashed"}(i,a)))))}function g(e,t,r){e.rowCount<t&&(e.rowCount=t),e.columnCount<r&&(e.columnCount=r)}function m(e,t){var r=0,n=0,o=t.endPoint;o&&(r=o.row,n=o.col),g(e,r+=s,n+=s)}function I(e,t,r){var n,o,i;o=t?(n=t[6],t[4]):(n=(i=f(e,r)).endPoint.row,i.endPoint.col),g(e,n+=s,o+=s)}function E(e,t,r){var n,o;return{x:n=R(e,0,t.col)+t.colOffset,y:o=D(e,0,t.row)+t.rowOffset,width:R(e,0,r.col)+r.colOffset-n,height:D(e,0,r.row)+r.rowOffset-o}}function N(e,t,r){var n,o,i;return C.k(t.startRow)?f(e,{x:t.x||0,y:t.y||0,width:t.width||0,height:t.height||0}):(r&&(n=e,t=0===(i=(o=t).pictureStretch)?o:1===i?function(e,t){var r,n,o,i,a,s,l,u,c,h,f=e.rowCount,d=e.columnCount,p=t.width,g=t.height,m=t.startRow,b=t.startRowOffset||0,y=t.startColumn,C=t.startColumnOffset||0,w=t.endRow,v=t.endRowOffset||0,S=t.endColumn,x=t.endColumnOffset||0,T=t.originalWidth,A=t.originalHeight,k=Math.min(p,T),M=Math.min(g,A),I=g<A?b:b+(g-A)/2,E=p<T?C:C+(p-T)/2;for(p=k,g=M,r=0,n=m,o=I,i=!1;n<f;)if(a=D(e,n,++n),i||(o-=a),o<0&&!i&&(m=n-1<0?0:n-1,b=a+o,i=!0),(r+=a)>g+I){w=n-1<0?0:n-1,v=a-(r-g-I);break}for(s=0,l=y,u=E,c=!1;l<d;)if(h=R(e,l,++l),c||(u-=h),u<0&&!c&&(y=l-1<0?0:l-1,C=h+u,c=!0),(s+=h)>p+E){S=l-1<0?0:l-1,x=h-(s-p-E);break}return t.width=p,t.height=g,t.startRow=m,t.startRowOffset=b,t.endRow=w,t.endRowOffset=v,t.startColumn=y,t.startColumnOffset=C,t.endColumn=S,t.endColumnOffset=x,t}(n,o):2===i?function(e,t){var r,n,o,i,a,s,l,u,c=e.rowCount,h=e.columnCount,f=t.width,d=t.height,p=t.startRow,g=t.startRowOffset||0,m=t.startColumn,b=t.startColumnOffset||0,y=t.endRow,C=t.endRowOffset||0,w=t.endColumn,v=t.endColumnOffset||0,S=t.originalWidth,x=t.originalHeight,T=f/d,A=S/x,k=0,M=0,I=f,E=d;if(0<d&&0<x&&A<T)k=b+f/2-(I=A*d)/2,d=1/A*(f=I);else{if(!(0<f&&0<S&&1/A<1/T))return t;M=g+d/2-(E=1/A*f)/2,f=A*(d=E)}if(0<k){for(r=R(e,m,++m);m<h;){if((k-=r)<0){m--,b=k+r;break}r=R(e,m,++m)}for(n=0,o=m;o<h;)if(i=R(e,o,++o),I+b<(n+=i)){v=i-(n-I-b),w=o-1<0?0:o-1;break}}else if(0<M){for(a=D(e,p,++p);p<c;){if((M-=a)<0){p--,g=M+a;break}a=D(e,p,++p)}for(s=0,l=p;l<c;)if(u=D(e,l,++l),E+g<(s+=u)){C=u-(s-E-g),y=l-1<0?0:l-1;break}}return t.width=f,t.height=d,t.startRow=p,t.startRowOffset=g,t.endRow=y,t.endRowOffset=C,t.startColumn=m,t.startColumnOffset=b,t.endColumn=w,t.endColumnOffset=v,t}(n,o):3===i?function(e,t){var r,n,o,i,a,s,l=e.rowCount,u=e.columnCount,c=t.width,h=t.height,f=t.startRow,d=t.startRowOffset||0,p=t.startColumn,g=t.startColumnOffset||0,m=t.endRow,b=t.endRowOffset||0,y=t.endColumn,C=t.endColumnOffset||0,w=t.originalWidth,v=t.originalHeight;for(c=Math.min(c,w),h=Math.min(h,v),r=0,n=f;n<l;)if(o=D(e,n,++n),(r+=o)>h+d){m=n-1<0?0:n-1,b=o-(r-h-d);break}for(i=0,a=p;a<u;)if(s=R(e,a,++a),(i+=s)>c+g){y=a-1<0?0:a-1,C=s-(i-c-g);break}return t.width=c,t.height=h,t.startRow=f,t.startRowOffset=d,t.endRow=m,t.endRowOffset=b,t.startColumn=p,t.startColumnOffset=g,t.endColumn=y,t.endColumnOffset=C,t}(n,o):o),{startPoint:{row:t.startRow,rowOffset:t.startRowOffset||0,col:t.startColumn,colOffset:t.startColumnOffset||0},endPoint:{row:t.endRow,rowOffset:t.endRowOffset||0,col:t.endColumn,colOffset:t.endColumnOffset||0},editAs:_(t.dynamicMove,t.dynamicSize)})}function F(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w=t.anchorType;return 0===w?E(e,(C=t).startPoint,C.endPoint):1===w?(m=e,y=(b=t).startPoint,{x:R(m,0,y.col)+y.colOffset,y:D(m,0,y.row)+y.rowOffset,width:b.width,height:b.height}):2===w?{x:(g=t).x,y:g.y,width:g.width,height:g.height}:3===w?(u=r,c=n,h=(l=t).startPoint,f=l.endPoint,d=h.x*u,p=h.y*c,{x:d,y:p,width:f.x*u-d,height:f.y*c-p}):4===w?(i=r,a=n,{x:(s=(o=t).startPoint).x*i,y:s.y*a,width:o.width,height:o.height}):null}function _(e,t){var r;return!1===e&&!1===t?r=2:!1===t&&(r=1),r}function P(e,t,r){var n=e.x||0,o=e.y||0,i=e.width||0,a=e.height||0;return{startPoint:{x:(n/t).toFixed(5),y:(o/r).toFixed(5)},endPoint:{x:((n+i)/t).toFixed(5),y:((o+a)/r).toFixed(5)}}}function L(e){var t,r;return e?2===(r=(t=w.ColorHelper.toExcelColor(e)).colorType())?{srgbClr:{val:w.ColorHelper.getRGBAColorData(t).rgb}}:3===r?{schemeClr:{val:t.value()}}:null:null}function O(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b;if(e&&e.rot)return t=e.rot,r=e.off,n=e.ext,o=r.x,i=r.y,a=n.cx/2,s=n.cy/2,l=t*y,u=Math.sin(l),c=Math.cos(l),h=o+a,f=i+s,d=[],p=[],[{x:-a,y:-s},{x:a,y:-s},{x:-a,y:s},{x:a,y:s}].forEach(function(e){var t,r,n,o=(r=u,n=c,{x:(t=e).x*n-t.y*r,y:t.x*r+t.y*n});d.push(o.x+h),p.push(o.y+f)}),g=Math.min.apply(null,d),m=Math.max.apply(null,d),{x:g,y:b=Math.min.apply(null,p),width:m-g,height:Math.max.apply(null,p)-b}}function B(e,t,r,n){var o,i,a,s,l,u,c=O(n)||F(t,e),h=(s=(a=e).anchorType||a.editAs||0,u=l=!0,2===s?u=l=!1:1===s&&(u=!1),{dynamicMove:l,dynamicSize:u});r.dynamicMove=h.dynamicMove,r.dynamicSize=h.dynamicSize,x(c,r,["x","y","width","height"]),0===e.anchorType?function(e,t){if(e){var r=e.startPoint,n=e.endPoint;t.startRow=r.row,t.startRowOffset=r.rowOffset,t.startColumn=r.col,t.startColumnOffset=r.colOffset,t.endRow=n.row,t.endRowOffset=n.rowOffset,t.endColumn=n.col,t.endColumnOffset=n.colOffset}}(o=n?f(t,c):e,r):o=f(t,c),m(t,o),(i=e.clientData)&&(r.isLocked=i.fLocksWithSheet,r.canPrint=i.fPrintsWithSheet)}function j(e,t){return!(!e||!t||e.color!==t.color||e.type!==t.type)||!e&&!t}function H(e){return JSON.parse(JSON.stringify(e))}function G(e){var t=e.sp||e.cxnSp||e.grpSp;return t&&(t.spPr&&t.spPr.xfrm||t.grpSpPr&&t.grpSpPr.xfrm)}Object.defineProperty(t,"__esModule",{value:!0}),C=r("./src/common/common.ts"),w=r("./src/datamodel/excel-style.ts"),b=r("./src/datamodel/chart-model.ts"),v=null,t.isCollapsed=d,t.convertFromExcelComment=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y={};return x(t,y,["fontSize","fontStyle","fontFamily","fontWeight","textDecoration","text","autoSize","dynamicMove","dynamicSize","locked","lockText","displayMode"]),r=e.forzenRowCount||0,n=e.forzenColumnCount||0,o=t.row,i=t.col,a=t.anchor,s=R(e,n,i+1),l=D(e,r,o),y.rowIndex=o-r,y.colIndex=i-n,a?(u=R(e,n,a[0])+a[1]-7,c=D(e,r,a[2])+a[3]-7,h=R(e,n,a[4])+a[5]+7,f=D(e,r,a[6])+a[7]+7,y.location={x:u-s,y:c-l},y.width=h-u,y.height=f-c,I(e,a)):(y.location={x:w.UnitHelper.pointToPixel(t.marginLeft)-s-7,y:w.UnitHelper.pointToPixel(t.marginTop)-l-7},y.width=S(t.width)+14,y.height=S(t.height)+14,I(e,v,{x:y.location.x+s,y:y.location.y+l,width:y.width,height:y.height})),(d=t.foreColor)&&d!==w.ExcelColor.EmptyColor&&(y.foreColor=w.ColorHelper.toRGBColor(d)),(d=t.backColor)&&(y.backColor=d.split(" ")[0]),(d=t.borderColor)&&(y.borderColor=d.split(" ")[0]),(p=t.borderWidth)&&(y.borderWidth=S(p)),y.borderStyle=function(e,t){if(!C.StringEx.q(t))return"double";if(e)switch(e.toLowerCase()){case"solid":return"solid";case"1 1":return"dotted";case"dash":case"dashdot":case"longdash":case"longdashdot":case"longdashdotdot":return"dashed"}return"solid"}(t.dashStyle,t.lineStyle),g=t.zIndex,C.k(g)||(y.zIndex=g),g=t.opacity,C.k(g)||(y.opacity=g),t.autoSize&&(y.autoSize=!0),y.locked=!1!==t.locked,y.lockText=!1!==t.lockText,y.dynamicSize=!1!==t.dynamicSize,y.dynamicMove=!1!==t.dynamicMove,(g=t.inset)&&(m=[0,0,0,0],g.trim().split(",").forEach(function(e,t){var r,n,o=e||["0.1in","0.05in"][t%2];m[t]=(n=0,-1!==(r=o).indexOf("in")?n=72*parseFloat(r.replace("in","").trim()):-1!==r.indexOf("cm")?n=72*parseFloat(r.replace("cm","").trim())/2.54:-1!==r.indexOf("mm")?n=72*parseFloat(r.replace("mm","").trim())/25.4:-1!==r.indexOf("pt")&&(n=parseFloat(r.replace("pt","").trim())),w.UnitHelper.pointToPixel(n))}),y.padding={left:m[0],top:m[1],right:m[2],bottom:m[3]}),-1!==(b=["left","center","right"].indexOf(t.hAlign))&&(y.horizontalAlign=b),y},t.convertToExcelComment=function(e,t){var r,n,o,i,a,s,l=t.rowIndex,u=t.colIndex,c=t.location||{x:9,y:-18},h={row:l,col:u};return C.k(t.width)&&(t.width=160),C.k(t.height)&&(t.height=100),t.fontFamily=t.fontFamily||"Arial",t.borderColor=t.borderColor||"black",t.backColor=t.backColor||"#FFFFE1",x(t,h,["zIndex","opacity","fontStyle","fontFamily","fontWeight","textDecoration","text","autoSize","dynamicMove","dynamicSize","locked","lockText","displayMode","backColor","borderColor"]),r=R(e,0,u+1),n=D(e,0,l),h.marginLeft=w.UnitHelper.pixelToPoint(r+c.x+7),h.marginTop=w.UnitHelper.pixelToPoint(n+c.y+7),h.width=w.UnitHelper.pixelToPoint(t.width-14)+"pt",h.height=w.UnitHelper.pixelToPoint(t.height-14)+"pt",-1!==(o=t.fontSize||"9pt").indexOf("px")?h.fontSize=w.UnitHelper.pixelToPoint(parseFloat(o)):h.fontSize=o.replace("pt",""),i=t.foreColor,h.foreColor=i&&w.ColorHelper.toExcelColor(i),h.borderWidth=w.UnitHelper.pixelToPoint(t.borderWidth||1)+"pt",a=function(e){var t,r;if(e)switch(e.toLowerCase()){case"solid":t="solid";break;case"dotted":t="1 1";break;case"dashed":t="dash";break;case"double":r="thinThin"}return{dashStyle:t,lineStyle:r}}(t.borderStyle),h.dashStyle=a.dashStyle,h.lineStyle=a.lineStyle,(s=t.padding)&&(h.inset=[w.UnitHelper.pixelToPoint(s.left)+"pt",w.UnitHelper.pixelToPoint(s.top)+"pt",w.UnitHelper.pixelToPoint(s.right)+"pt",w.UnitHelper.pixelToPoint(s.bottom)+"pt"].join(",")),h.hAlign=["Left","Center","Right"][t.horizontalAlign||0]||"Left",h.visibility=1===t.displayMode?"visible":"hidden",h},a=1e5,t.convertFromExcelPicture=function(e,t,r){var n,o,i={name:k(r,t.name,"picture"),alt:t.descr};return x(t,i,["src","isVisible","locked","rot"]),B(t.anchor,e,i,t.xfrm),M(t.pictureFormat,i),(n=t.srcRect)&&(i.srcRect={l:(o=n).l/a,t:o.t/a,r:o.r/a,b:o.b/a}),i},t.convertToExcelSlicer=function(e,t){return t.twoCellAnchor=N(e,t),t},t.convertToExcelPicture=function(e,t){var r,n,o={};return p(t.src,o),x(t,o,["name","locked","rot"]),o.descr=t.alt,o.twoCellAnchor=N(e,t,!0),o.hidden=!1===t.isVisible,o.fillColor=w.ColorHelper.toExcelColor(t.backColor),o.lineBorder={width:T(t.borderStyle)?0:t.borderWidth,color:w.ColorHelper.toExcelColor(t.borderColor),style:A(t.borderStyle),noFill:t.noFill},(r=t.srcRect)&&(o.srcRect=(n=r,{l:parseInt((n.l||0)*a,10),t:parseInt((n.t||0)*a,10),r:parseInt((n.r||0)*a,10),b:parseInt((n.b||0)*a,10)})),o},o=";base64,",t.getPictureInfo=p,s=2,t.inflateWorksheetByAnchor=m,t.getBounds=E,y=Math.PI/180/6e4,t.convertFromExcelChart=function(w,e){var t,r,n,o,i,a,v,S,s;return m(w,e),o=(n=C.Util.Da(e))&&n.layoutId,r=(t=C.Util.Ea(o)?e.AlternateContent&&e.AlternateContent.Choice&&e.AlternateContent.Choice.GraphicalObjectFrame&&e.AlternateContent.Choice.GraphicalObjectFrame.nvGraphicFramePr:e.graphicFrame&&e.graphicFrame.nvGraphicFramePr)&&t.cNvPr,a={name:k(w.charts,r.name,"chart"),chartSpace:i=e.chartSpace,isVisible:!r.hidden,alt:r.descr,AlternateContent:e.AlternateContent},B(e,w,a),v=a.width,S=a.height,(s=i.userShapes)&&(i.userShapes=s.map(function(e){return e.pic?(u=w,h=v,f=S,b=(c=e).pic&&c.pic.nvPicPr&&c.pic.nvPicPr.cNvPr,y=b.name,(C=u.floatingObjects)&&(y=k(C,y,"picture")),d=c.pic&&c.pic.blipFill,p=d&&d.blip&&d.blip.blipBlob,g=p&&p.blob,m={name:y,alt:b.descr,src:g,isVisible:!b.hidden},x(F(u,c,h,f),m,["x","y","width","height"]),M(c.pictureFormat,m),m):e.graphicFrame?(t=w,n=v,o=S,i=(r=e).graphicFrame&&r.graphicFrame.nvGraphicFramePr&&r.graphicFrame.nvGraphicFramePr.cNvPr&&r.graphicFrame.nvGraphicFramePr.cNvPr,a=k(t.charts,i.name,"chart"),s=F(t,r,n,o),l={name:a,chartSpace:r.chartSpace,isVisible:!i.hidden,alt:i.descr},x(s,l,["x","y","width","height"]),l):void 0;var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C})),a},t.convertToExcelShape=function(e,t){var r,n=t.shapeData;return n.editAs=_(t.dynamicMove,t.dynamicSize),n.clientData={fLocksWithSheet:t.isLocked,fPrintsWithSheet:t.canPrint},(r=t.alt)&&(n.sp?n.sp.nvSpPr.cNvPr.descr=r:n.cxnSp?n.cxnSp.nvCxnSpPr.cNvPr.descr=r:n.grpSp&&(n.grpSp.nvGrpSpPr.cNvPr.descr=r)),n},t.convertToExcelChart=function(e,m){var t,r=N(e,m),n=m.isVisible,o=m.chartSpace,i={anchorType:0,startPoint:r.startPoint,endPoint:r.endPoint,editAs:r.editAs,graphicFrame:{nvGraphicFramePr:{cNvPr:{name:m.name,descr:m.alt||"",hidden:!C.k(n)&&!n}}},clientData:{fLocksWithSheet:m.isLocked,fPrintsWithSheet:m.canPrint},chartSpace:o,AlternateContent:m.AlternateContent},a=o.userShapes;return a&&0<a.length&&(t=a.map(function(e){return"1"===e.typeName?(a=e,s=m.width,l=m.height,h=P(a,s,l),f={typeName:a.typeName,anchorType:3,startPoint:h.startPoint,endPoint:h.endPoint,pic:{nvPicPr:{cNvPr:{name:a.name,descr:a.alt||""},cNvPicPr:{picLocks:{}}},spPr:{ln:{w:T(a.borderStyle)?0:a.borderWidth},prstGeom:{prst:1,avLst:{}}}},src:a.src},d=f.pic.spPr,p=d.ln,(g=L(a.backColor))&&(d.solidFill=g),(u=L(a.borderColor))&&(p.solidFill=u),"dbl"===(c=A(a.borderStyle))?p.cmpd=b.Charts.ST_CompoundLine[c]:p.prstDash=b.Charts.ST_PresetLineDashVal[c],f):"2"===e.typeName?(t=e,r=m.width,n=m.height,o=P(t,r,n),i=t.isVisible,{typeName:t.typeName,anchorType:3,startPoint:o.startPoint,endPoint:o.endPoint,graphicFrame:{nvGraphicFramePr:{cNvPr:{name:t.name,descr:t.alt||"",hidden:!C.k(i)&&!i}}},chartSpace:t.chartSpace}):void 0;var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g}),o.userShapes={relSizeAnchor:t}),i},t.isBorderEqual=j,i={backColor:0,foreColor:0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},t.processTableCellStyle=function(e,t){var r,n={};for(r in e)e.hasOwnProperty(r)&&(0===i[r]?e[r]!==t[r]&&(n[r]=e[r]):1===i[r]&&j(e[r],t[r])||(n[r]=e[r]));return n},t.getImageContent=function(e,t){var r,n="png",o=e.lastIndexOf(".");return-1!==o&&(n=e.substr(o+1)),"svg"===n&&(n="svg+xml"),(r=t(e,!0))?"data:image/"+n+";base64,"+r:v},t.getXFrm=G,t.convertFromExcelShape=function(e,t){var r,n={};return B(t,e,n,G(t)),t.sp?(n.shapeType=t.sp.shapeType,n.name=t.sp.nvSpPr.cNvPr.name,n.alt=t.sp.nvSpPr.cNvPr.descr,n.shapeData=H(t)):t.cxnSp?(n.shapeType=t.cxnSp.shapeType,n.name=t.cxnSp.nvCxnSpPr.cNvPr.name,n.alt=t.cxnSp.nvCxnSpPr.cNvPr.descr,n.shapeData=H(t)):t.grpSp&&(n.shapeType=t.grpSp.shapeType,n.name=t.grpSp.nvGrpSpPr.cNvPr.name,n.alt=t.grpSp.nvGrpSpPr.cNvPr.descr,n.shapeData=H(t)),(r=n.shapeData)&&r.hidden&&(r.isVisible=!1,n.isVisible=!1,delete r.hidden),n},t.toProtectionOptions={selectLockedCells:"allowSelectLockedCells",selectUnlockedCells:"allowSelectUnlockedCells",autoFilter:"allowFilter",sort:"allowSort",insertColumns:"allowInsertColumns",insertRows:"allowInsertRows",deleteColumns:"allowDeleteColumns",deleteRows:"allowDeleteRows",objects:"allowEditObjects"},t.fromProtectionOptions={allowSelectLockedCells:"selectLockedCells",allowSelectUnlockedCells:"selectUnlockedCells",allowFilter:"autoFilter",allowSort:"sort",allowInsertColumns:"insertColumns",allowInsertRows:"insertRows",allowDeleteColumns:"deleteColumns",allowDeleteRows:"deleteRows",allowEditObjects:"objects"},t.excelSupportProtectionOptions={formatCells:!0,formatColumns:!0,formatRows:!0,insertColumns:!0,insertRows:!0,insertHyperlinks:!0,deleteColumns:!0,deleteRows:!0,sort:!0,autoFilter:!0,pivotTables:!0}},"./src/datamodel/excel-style.ts":function(e,t,r){"use strict";var p,d,u,g,m,b,y,C,w,o,v,S,x,T,A,k,M,I,l,i,E,n,a,s,c,h,f,R,D,N,F;function _(){}function P(){}function L(){this.bj=null,this.name=null}function O(){this.bj=null,this.builtInStyle=0,this.category=0,this.isCustomBuiltin=!1,this.name=null,this.outLineLevel=0}function B(){var e=this;e.font=(new x).Default(),e.border=new v,e.applyAlignment=b,e.applyBorder=b,e.applyFill=b,e.applyFont=b,e.applyNumberFormat=b,e.applyProtection=b,e.quotePrefix=b,e.fill=S.Default(),e.numberFormatIndex=0,e.numberFormat=b,e.isStyleFormat=!1,e.parentFormatID=b,e.parentName=b,e.horizontalAlign=0,e.verticalAlign=0,e.isLocked=!1,e.rotation=0,e.isWordWrap=!1,e.isJustfyLastLine=!1,e.isShrinkToFit=!1,e.isFirstSymbolApostrophe=!1,e.readingOrder=0,e.isHidden=!1,e.indent=0,e.isVerticalText=!1}function j(e,t){this.numberFormatId=e,this.numberFormatCode=t}function H(e,t,r){var n=this;n.fontColor=void 0!==t?t:null,n.fontName=void 0!==e?e:null,n.fontFamily=void 0!==r?r:0,n.isAutoColor=!1,n.isBold=!1,n.isItalic=!1,n.isOutlineStyle=!1,n.isShadowStyle=!1,n.isStrikeOut=!1,n.fontScheme=0,n.fontSize=11,n.charSetIndex=0,n.underLineStyle=0,n.vertAlign=0,n.aj=null}function G(){}function U(){this.left=new o,this.top=new o,this.right=new o,this.bottom=new o,this.diagonalUp=new o,this.diagonalDown=new o}function W(e,t){this.color=e||null,this.lineStyle=t||0}function V(e,t,r){if(3===e&&11<t&&241!==t&&242!==t&&243!==t&&244!==t&&255!==t)throw Error("themeColorIndexError");if(1<r||r<-1)throw Error("colorTintError");1===e&&32767===t&&(this.Yi=!0),this.Zi=e||2,this.$i=t||0,this._i=r||0}function z(e,t){var r=Math.pow(10,t);return Math.round(e*r)/r}function q(){}function Z(){}function Y(){}function K(){}function X(){}function J(e){var t,r,n,o,i=this,a=e.r,s=e.g,l=e.b,u=Math.max(Math.max(a,s),l),c=Math.min(Math.min(a,s),l),h=u+c;i.luminosity=parseInt(""+(240*h+255)/510,10),0==(t=u-c)?(i.saturation=0,i.hue=160):(i.luminosity<=120?i.saturation=parseInt(""+(240*t+h/2)/h,10):i.saturation=parseInt(""+(240*t+(510-h)/2)/(510-h),10),r=(40*(u-a)+t/2)/t,n=(40*(u-s)+t/2)/t,o=(40*(u-l)+t/2)/t,i.hue=a===u?parseInt(""+(o-n),10):s===u?parseInt(""+(80+r-o),10):parseInt(""+(160+n-r),10),i.hue<0&&(i.hue+=240),240<i.hue&&(i.hue-=240))}function Q(e,t,r,n){this.a=e,this.r=t,this.g=r,this.b=n}function $(){}Object.defineProperty(t,"__esModule",{value:!0}),p=r("./src/common/common.ts"),d=r("./src/common/builtIn-resource.ts"),u=r("./src/common/excel-types.ts"),g=r("./src/xml-io/xml-reader.ts"),m=r("./src/xlsx-io/reader/style-reader.ts"),b=void 0,y="Calibri",C="italic",(F=t.FontSchemeCategory||(t.FontSchemeCategory={}))[F.none=0]="none",F[F.major=1]="major",F[F.minor=2]="minor",F[F.ninched=255]="ninched",(N=t.ExcelVerticalAlignment||(t.ExcelVerticalAlignment={}))[N.top=0]="top",N[N.center=1]="center",N[N.bottom=2]="bottom",N[N.justify=3]="justify",N[N.distributed=4]="distributed",(D=t.ExcelHorizontalAlignment||(t.ExcelHorizontalAlignment={}))[D.general=0]="general",D[D.left=1]="left",D[D.center=2]="center",D[D.right=3]="right",D[D.fill=4]="fill",D[D.justify=5]="justify",D[D.centerContinuous=6]="centerContinuous",D[D.distributed=7]="distributed",(R=t.TextDirection||(t.TextDirection={}))[R.accordingToContext=0]="accordingToContext",R[R.leftToRight=1]="leftToRight",R[R.rightToLeft=2]="rightToLeft",(f=t.UnderLineStyle||(t.UnderLineStyle={}))[f.none=0]="none",f[f.single=1]="single",f[f.double=2]="double",f[f.singleaccounting=3]="singleaccounting",f[f.doubleaccounting=4]="doubleaccounting",(h=t.VertAlign||(t.VertAlign={}))[h.baseLine=0]="baseLine",h[h.superscript=1]="superscript",h[h.subscript=2]="subscript",(c=t.ExcelBorderStyle||(t.ExcelBorderStyle={}))[c.none=0]="none",c[c.thin=1]="thin",c[c.medium=2]="medium",c[c.dashed=3]="dashed",c[c.dotted=4]="dotted",c[c.thick=5]="thick",c[c.double=6]="double",c[c.hair=7]="hair",c[c.mediumDashed=8]="mediumDashed",c[c.dashDot=9]="dashDot",c[c.mediumDashDot=10]="mediumDashDot",c[c.dashDotDot=11]="dashDotDot",c[c.mediumDashDotDot=12]="mediumDashDotDot",c[c.slantDashDot=13]="slantDashDot",(s=t.FillPatternType||(t.FillPatternType={}))[s.none=0]="none",s[s.solid=1]="solid",s[s.darkGray=2]="darkGray",s[s.mediumGray=3]="mediumGray",s[s.lightGray=4]="lightGray",s[s.gray125=5]="gray125",s[s.gray0625=6]="gray0625",s[s.darkHorizontal=7]="darkHorizontal",s[s.darkVertical=8]="darkVertical",s[s.darkDown=9]="darkDown",s[s.darkUp=10]="darkUp",s[s.darkGrid=11]="darkGrid",s[s.darkTrellis=12]="darkTrellis",s[s.lightHorizontal=13]="lightHorizontal",s[s.lightVertical=14]="lightVertical",s[s.lightDown=15]="lightDown",s[s.lightUp=16]="lightUp",s[s.lightGrid=17]="lightGrid",s[s.lightTrellis=18]="lightTrellis",V.prototype.colorType=function(){return this.Zi},V.prototype.value=function(){return this.$i},V.prototype.tint=function(){return this._i},V.prototype.isAutoColor=function(e){return 0===arguments.length?this.Yi:void("boolean"==typeof e&&e!==this.Yi&&(this.Yi=e))},V.prototype.isIndexedColor=function(){return 1===this.Zi},V.prototype.isRGBColor=function(){return 2===this.Zi},V.prototype.isThemeColor=function(){return 3===this.Zi},V.prototype.equals=function(e){return this===e||!!e&&this.Zi===e.colorType()&&this.value()===e.value()&&this.tint()===e.tint()&&this.isAutoColor()===e.isAutoColor()},V.EmptyColor=new V,w=V,t.ExcelColor=w,W.prototype.equals=function(e){return this===e||!!e&&(this.color?this.color.equals(e.color)&&this.lineStyle===e.lineStyle:!e.color&&this.lineStyle===e.lineStyle)},o=W,t.ExcelBorderSide=o,U.prototype.clone=function(){var e=this,t=new U;return t.left=new o(e.left.color,e.left.lineStyle),t.right=new o(e.right.color,e.right.lineStyle),t.top=new o(e.top.color,e.top.lineStyle),t.bottom=new o(e.bottom.color,e.bottom.lineStyle),t.diagonalUp=new o(e.diagonalUp.color,e.diagonalUp.lineStyle),t.diagonalDown=new o(e.diagonalDown.color,e.diagonalDown.lineStyle),t},U.prototype.equals=function(e){return this===e||!!e&&this.left.equals(e.left)&&this.right.equals(e.right)&&this.top.equals(e.top)&&this.bottom.equals(e.bottom)&&this.diagonalUp.equals(e.diagonalUp)&&this.diagonalDown.equals(e.diagonalDown)},v=U,t.ExcelBorder=v,G.prototype.clone=function(){var e=this,t=new G;return t.bgColor=e.bgColor,t.fgColor=e.fgColor,t.patternType=e.patternType,t.stops=e.stops,t.type=e.type,t.degree=e.degree,t.left=e.left,t.right=e.right,t.top=e.top,t.bottom=e.bottom,t},G.prototype.equals=function(e){return this===e||!!e&&JSON.stringify(this)===JSON.stringify(e)},G.Default=function(){return G.aj||((G.aj=new G).bgColor=b,G.aj.fgColor=b,G.aj.patternType=0),G.aj},S=G,t.ExcelFill=S,H.prototype.equals=function(e){return this===e||!!e&&!(this.isBold!==e.isBold||this.isItalic!==e.isItalic||this.isOutlineStyle!==e.isOutlineStyle||this.isShadowStyle!==e.isShadowStyle||this.isStrikeOut!==e.isStrikeOut||this.fontName!==e.fontName||this.fontFamily!==e.fontFamily||this.fontSize!==e.fontSize||this.charSetIndex!==e.charSetIndex||this.underLineStyle!==e.underLineStyle||this.vertAlign!==e.vertAlign||this.fontScheme!==e.fontScheme)&&(!this.fontColor&&!e.fontColor||!(!this.fontColor&&e.fontColor)&&!(this.fontColor&&!e.fontColor)&&this.fontColor.equals(e.fontColor))},H.prototype.clone=function(){var e=this,t=new H(e.fontName,e.fontColor,e.fontFamily);return t.isAutoColor=e.isAutoColor,t.isBold=e.isBold,t.isItalic=e.isItalic,t.isOutlineStyle=e.isOutlineStyle,t.isShadowStyle=e.isShadowStyle,t.isStrikeOut=e.isStrikeOut,t.fontScheme=e.fontScheme,t.fontSize=e.fontSize,t.charSetIndex=e.charSetIndex,t.underLineStyle=e.underLineStyle,t.vertAlign=e.vertAlign,t},H.prototype.Default=function(){return this.aj||(this.aj=new H,this.aj.fontSize=11,this.aj.fontFamily=2,this.aj.fontColor=new w(1,0,0),this.aj.fontName="Calibri",this.aj.charSetIndex=0),this.aj},x=H,t.ExcelFont=x,j.prototype.equals=function(e){return this===e||!!e&&this.numberFormatId===e.numberFormatId&&this.numberFormatCode===e.numberFormatCode},T=j,t.ExcelNumerFormat=T,B.Default=function(){var e=new B;return e.numberFormatIndex=0,e.isLocked=!0,e.verticalAlign=2,e.horizontalAlign=0,e},B.prototype.copyFrom=function(e){var t=this;t.applyAlignment=e.applyAlignment,t.applyBorder=e.applyBorder,t.applyFill=e.applyFill,t.applyFont=e.applyFont,t.applyNumberFormat=e.applyNumberFormat,t.applyProtection=e.applyProtection,t.fill=null!==e.fill?e.fill.clone():null,t.border=null!==e.border?e.border.clone():null,t.font=null!==e.font?e.font.clone():null,t.numberFormatIndex=e.numberFormatIndex,t.numberFormat=e.numberFormat,t.isStyleFormat=e.isStyleFormat,t.parentFormatID=e.parentFormatID,t.horizontalAlign=e.horizontalAlign,t.verticalAlign=e.verticalAlign,t.isLocked=e.isLocked,t.rotation=e.rotation,t.isWordWrap=e.isWordWrap,t.isJustfyLastLine=e.isJustfyLastLine,t.isShrinkToFit=e.isShrinkToFit,t.isFirstSymbolApostrophe=e.isFirstSymbolApostrophe,t.readingOrder=e.readingOrder,t.isHidden=e.isHidden,t.indent=e.indent,t.quotePrefix=e.quotePrefix},B.prototype.clone=function(){var e=new B;return e.copyFrom(this),e},B.prototype.equals=function(e,t){var r,n=this;if(n===e)return!0;if(!e)return!1;if(!n.numberFormat&&e.numberFormat)return!1;if(r=n.numberFormatIndex===e.numberFormatIndex&&n.horizontalAlign===e.horizontalAlign&&n.verticalAlign===e.verticalAlign&&n.isLocked===e.isLocked&&n.rotation===e.rotation&&n.isWordWrap===e.isWordWrap&&n.isJustfyLastLine===e.isJustfyLastLine&&n.isShrinkToFit===e.isShrinkToFit&&n.isFirstSymbolApostrophe===e.isFirstSymbolApostrophe&&n.readingOrder===e.readingOrder&&n.isHidden===e.isHidden&&n.indent===e.indent&&n.applyAlignment===e.applyAlignment&&n.applyBorder===e.applyBorder&&n.applyFill===e.applyFill&&n.applyFont===e.applyFont&&n.applyNumberFormat===e.applyNumberFormat&&n.applyProtection===e.applyProtection&&n.parentFormatID===e.parentFormatID&&n.quotePrefix===e.quotePrefix&&n.border.equals(e.border),t||(r=r&&n.parentName===e.parentName),n.font)r=r&&n.font.equals(e.font);else if(e.font)return!1;if(n.numberFormat&&(r=r&&n.numberFormat.equals(e.numberFormat)),n.fill)r=r&&n.fill.equals(e.fill);else if(e.fill)return!1;return r},A=B,t.ExtendedFormat=A,O.prototype.format=function(e){return 0===arguments.length?(null===this.bj&&(this.bj=new A),this.bj):void(this.bj=e)},O.prototype.copy=function(){var e=new O;return e.builtInStyle=this.builtInStyle,e.outLineLevel=this.outLineLevel,e.isCustomBuiltin=this.isCustomBuiltin,e.category=this.category,e.name=this.name,e.format(this.format().clone()),e},O.prototype.isBuiltInStyle=function(){return!0},O.prototype.getBuiltInStyleCategory=function(){if(!this.isBuiltInStyle())return 0;switch(this.builtInStyle){case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 2:case 1:return 4;case 24:return 1;case 19:case 20:return 2;case 3:case 6:case 4:case 7:return 5;case 49:return 2;case 23:return 1;case 13:case 14:case 15:case 16:return 3;case 17:case 21:return 2;case 25:case 0:return 1;case 10:case 18:return 2;case 5:return 5;case 12:case 22:return 3;case 11:return 2;default:return 0}},k=O,t.ExcelStyle=k,L.prototype.format=function(e){return 0===arguments.length?(null===this.bj&&(this.bj=new A),this.bj):(this.bj=e,this)},L.prototype.copy=function(){var e=new L;return e.name=this.name,e.format(this.format().clone()),e},L.prototype.isBuiltInStyle=function(){return!1},t.CustomExcelStyle=L,P.initBuiltInExcelStyleCollections=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f;if(P.builtInStyles.length=0,e=d.BuiltInStylesResource)for((t=new g.XmlReader).reset(),t.setXml(e),r=[],n=[],o=[],i=[],a={};t.read();)if(1===t.depth&&2!==t.elementType)switch(t.name()){case"numFmts":m.readNumberFormats(t,a);break;case"fonts":m.readFonts(t,r);break;case"fills":m.readFills(t,n);break;case"borders":m.readBorders(t,o);break;case"cellStyleXfs":m.readXFs(t,i,r,o,a,n,!0);break;case"cellStyles":for(s=t.depth;t.read();){if(t.depth<=s)return;if(1===t.nodeType()&&"cellStyle"===t.name()){for(l=b,c=u=0;t.moveToNextAttribute();)switch(t.readAttributeNameAsString()){case"name":l=t.readContentAsString();break;case"xfId":u=t.readContentAsInt(0);break;case"builtinId":c=t.readContentAsInt(0)}(h=i[u]).isStyleFormat=!0,(f=new k).name=l,f.format(h.clone()),!f.format().numberFormat&&a[f.format().numberFormatIndex]&&(f.format().numberFormat=a[f.format().numberFormatIndex],f.format().numberFormatIndex=0),f.isCustomBuiltin=!1,f.builtInStyle=c,f.category=f.getBuiltInStyleCategory(),P.builtInStyles.push(f)}}}},P.getBuiltInStyles=function(){var e,t,r=P.builtInStyles.length;for(47!==r&&P.initBuiltInExcelStyleCollections(),e=[],r=P.builtInStyles.length,t=0;t<r;t++)e.push(P.builtInStyles[t].copy());return e},P.getNormalStyle=function(){var e,t=new A;return t.font=new x,t.font.fontColor=new w(3,1),t.font.fontSize=11,t.font.fontName="Calibri",(e=new k).format(t),e.name="Normal",e.builtInStyle=0,e},P.builtInStyles=[],t.BuiltInExcelStyles=P,_.builtInNumberFomrat=function(){return _.cj||(_.cj={count:0}),0===_.cj.count&&_.initBuintNumberFormat(),_.cj},_.languageIndepedentNumberFormat=function(){return _.dj||(_.dj={count:0}),0===_.dj.count&&_.initLanguageIndepedentNumberFormat(),_.dj},_.formatCodeTable=function(){return _.ej||(_.ej=[]),_.ej},_.customNumberFormat=function(){return _.fj||(_.fj={count:0}),_.fj},_.initBuintNumberFormat=function(){var e,t=_.cj;t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yyyy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yyyy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mm:ss.0",t[48]="##0.0E+0",t[49]="@",t.count=49,p.Ia()&&("zh-cn"===(e=p.Ia())?(t[14]="yyyy/m/d",t[17]="mmm-yy",t[22]="yyyy/m/d h:mm",t[27]='yyyy""m""',t[28]='m""d""',t[29]='m""d""',t[30]="m-d-yy",t[31]='yyyy""m""d""',t[32]='h""mm""',t[33]='h""mm""ss""',t[34]='/h""mm""',t[35]='/h""mm""ss""',t[36]='yyyy""m""',t[40]="#,##0.00;[Red]-#,##0.00",t[50]='yyyy""m""',t[51]='m""d""',t[52]='yyyy""m""',t[53]='m""d""',t[54]='m""d""',t[55]='/h""mm""',t[56]='/h""mm""ss""',t[57]='yyyy""m""',t[58]='m""d""',t.count=58):"ja-jp"===e&&(t[14]="yyyy/m/d",t[15]="dd-mmm-yy",t[16]="dd-mmm",t[17]="mmm-yy",t[22]="yyyy/mm/dd h:mm",t[27]="[$-411]ge.m.d",t[28]='[$-411]ggge""m""d"',t[29]='[$-411]ggge""m""d"',t[30]="m/d/yy",t[31]='yyyy""m""d""',t[32]='h""mm""',t[33]='h""mm""ss""',t[34]='yyyy""m""',t[35]='m""d""',t[36]="[$-411]ge.m.d",t[40]="#,##0.00;[Red]-#,##0.00",t[50]="[$-411]ge.m.d",t[51]='[$-411]ggge""m""d""',t[52]='yyyy""m""',t[53]='m""d""',t[54]='[$-411]ggge""m""d""',t[55]='yyyy""m""',t[56]='m""d""',t[57]="[$-411]ge.m.d",t[58]='[$-411]ggge""m""d""',t.count=58))},_.initLanguageIndepedentNumberFormat=function(){var e=_.dj;e[27]="m/d/yyyy",e[28]="m/d/yyyy",e[29]="m/d/yyyy",e[30]="m/d/yyyy",e[31]="m/d/yyyy",e[32]="h:mm:ss",e[33]="h:mm:ss",e[34]="m/d/yyyy",e[35]="m/d/yyyy",e[36]="m/d/yyyy",e[50]="m/d/yyyy",e[51]="m/d/yyyy",e[52]="m/d/yyyy",e[53]="m/d/yyyy",e[54]="m/d/yyyy",e[55]="m/d/yyyy",e[56]="m/d/yyyy",e[57]="m/d/yyyy",e[58]="m/d/yyyy"},_.getFormatCode=function(e){var t,r,n,o=_.builtInNumberFomrat(),i=_.customNumberFormat(),a=_.languageIndepedentNumberFormat(),s=e.numberFormatIndex;return e.numberFormat?(r=(t=e.numberFormat).numberFormatId,n=t.numberFormatCode,o[r]&&o[r]!==n?o[r]=n:i[n]||(i[n]=r,i.count++),n):o[s]?o[s]:a[s]?a[s]:"General"},_.getFormatId=function(e){var t,r,n,o,i,a,s,l=_.gj();if(l[e])return l[e];if(r=_.builtInNumberFomrat())for(n in r)if(r[n]===e)return t={isBuiltIn:!0,id:parseInt(n,10)},l[e]=t;if((o=_.customNumberFormat())&&o[e])return t={isBuiltIn:!1,id:o[e]},l[e]=t;if((i=0)<o.count){for(s in a=0,o)o[s]>a&&(a=o[s]);i=a}return i=Math.max(_.hj++,i)+1,{isBuiltIn:!1,id:o[e]=i}},_.gj=function(){return _.ij||(_.ij={}),_.ij},_.ej=null,_.ij=null,_.cj={count:0},_.dj={count:0},_.fj={count:0},_.hj=170,M=_,t.ExtendedNumberFormatHelper=M,$.pointToPixel=function(e){return z(96*e/72,2)},$.pixelToPoint=function(e){return 72*e/96},$.emuToPixles=function(e,t){return z(96*e/914400,t||2)},$.pixelToEMU=function(e){return Math.round(914400*e/96)},$.getMaxiumDigitWidth=function(e){var t,r,n,o,i,a,s=0,l=$.jj();if(l[e])return l[e];try{if($.kj||($.kj=document.createElement("span")),(t=$.kj).style.font=e,r=-1!==(r=t.style.fontSize).indexOf("px")?parseInt($.pixelToPoint(parseFloat(r)),10):parseInt(r,10),n=t.style.fontFamily,u.MaxDigitWidthMap[r]&&u.MaxDigitWidthMap[r][n]&&0<(s=u.MaxDigitWidthMap[r][n]))return l[e]=s}catch(e){}for(o="0123456789",a=i=0;a<o.length;a++)s<(i=$.measureText(o.charAt(a),e))&&(s=i);return 0<s?l[e]=s:(l[e]=7,l[e])},$.jj=function(){return $.lj||($.lj={}),$.lj},$.measureText=function(e,t){var r;try{return $.mj||($.mj=document.createElement("canvas")),(r=$.mj.getContext("2d")).font=t,r.measureText(e).width}catch(e){return 8}},$.kj=null,$.lj=null,$.mj=null,I=$,t.UnitHelper=I,Q.prototype.toString=function(){var e=this;return 255===e.a?"#"+e.getColorUnitString(e.r)+e.getColorUnitString(e.g)+e.getColorUnitString(e.b):"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},Q.prototype.getColorUnitString=function(e){var t=e.toString(16);return 1===t.length&&(t="0"+t),t},Q.hueToRGB=function(e,t,r){return r<0&&(r+=240),240<r&&(r-=240),r<40?e+((t-e)*r+20)/40:r<120?t:r<160?e+((t-e)*(160-r)+20)/40:e},Q.fromHLS=function(e,t,r){var n,o,i,a,s;return 0===r?n=o=i=parseInt(255*t/240,10):(a=2*t-(s=t<=120?(t*(240+r)+120)/240:t+r-(t*r+120)/240),n=parseInt((255*Q.hueToRGB(a,s,e+80)+120)/240,10),o=parseInt((255*Q.hueToRGB(a,s,e)+120)/240,10),i=parseInt((255*Q.hueToRGB(a,s,e-80)+120)/240,10)),new Q(255,n,o,i)},l=Q,t.nj=l,J.prototype.toColor=function(){return l.fromHLS(this.hue,this.luminosity,this.saturation)},i=J,X.getThemeColorName=function(e){if(!e||3!==e.colorType())return null;var t=Math.round(100*e.tint());return 0===e.value()||243===e.value()?"Background 1 "+t:1===e.value()||241===e.value()?"Text 1 "+t:2===e.value()||244===e.value()?"Background 2 "+t:3===e.value()||242===e.value()?"Text 2 "+t:4===e.value()?"Accent 1 "+t:5===e.value()?"Accent 2 "+t:6===e.value()?"Accent 3 "+t:7===e.value()?"Accent 4 "+t:8===e.value()?"Accent 5 "+t:9===e.value()?"Accent 6 "+t:10===e.value()?"hyperlink":11===e.value()?"followedHyperlink":null},X.getThemeColorIndex=function(e,t){return"Background 1"===e.substring(0,12)?t?243:0:"Text 1"===e.substring(0,6)?t?241:1:"Background 2"===e.substring(0,12)?t?244:2:"Text 2"===e.substring(0,6)?t?242:3:"Accent 1"===e.substring(0,8)?4:"Accent 2"===e.substring(0,8)?5:"Accent 3"===e.substring(0,8)?6:"Accent 4"===e.substring(0,8)?7:"Accent 5"===e.substring(0,8)?8:"Accent 6"===e.substring(0,8)?9:"hyperlink"===e?10:"followedHyperlink"===e?11:void 0},X.oj=function(){return X.pj||(X.pj={}),X.pj},X.getExcelThemeColor=function(e){var t,r,n,o;return p.StringEx.q(e)?w.EmptyColor:(t=X.oj())[e]?t[e]:(r=0,3<=(n=e.split(" ")).length&&(r=parseFloat(n[2]),isNaN(r)||(r/=100)),o=new w(3,X.getThemeColorIndex(e),r),t[e]=o)},X.toRGBColor=function(e){return e?""+X.getRGBColor(e):null},X.colorFromIndex=function(e,t){var r;return 32767===e?new l(0,0,0,0):e<0||e>=X.palette.length?new l(255,0,0,0):X.useCustomPalette?X.customPalette[e]!==b?X.customPalette[e]:64===e?new l(255,0,0,0):new l(65===e?255:0,255,255,255):(r=X.palette[e],new l(t,r>>16&255,r>>8&255,255&r))},X.updateTint=function(e,t){var r,n;return 0===t?e:(r=new i(e),0<t?(n=(240-r.luminosity)*t,l.fromHLS(r.hue,r.luminosity+n,r.saturation)):(n=r.luminosity*-t,l.fromHLS(r.hue,r.luminosity-n,r.saturation)))},X.getRGBColor=function(e){var t,r;return null===e||e===b?new l(0,255,255,255):e.isAutoColor()?new l(255,0,0,0):e.isIndexedColor()?(t=X.colorFromIndex(0|e.value(),255),X.updateTint(t,e.tint())):e.isRGBColor()?(r=4278190080+(16777215&e.value()),t=X.fromArgb(r),X.updateTint(t,e.tint())):e.isThemeColor()?X.getThemeColorName(e):new l(0,255,255,255)},X.fromArgb=function(e){return new l(e>>24&255,e>>16&255,e>>8&255,255&e)},X.getRGBAColorData=function(e){var t=X.fromArgb(e.value());return{rgb:t.getColorUnitString(t.r)+t.getColorUnitString(t.g)+t.getColorUnitString(t.b),alpha:t.a}},X.qj=function(){return X.rj||(X.rj={}),X.rj},X.fromHtmlColor=function(e){var t,r,n,o,i,a;if(e)return"string"!=typeof e?e:(t=X.qj())[e]?t[e]:(n="#"===(r=e.toLowerCase()).substring(0,1)?(7===r.length?r="#ff"+r.substring(1):4===r.length&&(r="#ff"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]),parseInt(r.substring(1,r.length),16)):"rgb("===r.substring(0,4)?(o=r.indexOf("("),i=r.indexOf(")"),a=r.substring(o+1,i).split(","),255*Math.pow(16,6)+parseInt(a[0],10)*Math.pow(16,4)+parseInt(a[1],10)*Math.pow(16,2)+parseInt(a[2],10)):"rgba("===r.substring(0,5)?(o=r.indexOf("("),i=r.indexOf(")"),a=r.substring(o+1,i).split(","),parseInt(255*parseFloat(a[3]),10)*Math.pow(16,6)+parseInt(a[0],10)*Math.pow(16,4)+parseInt(a[1],10)*Math.pow(16,2)+parseInt(a[2],10)):X.sj[r]?X.sj[r]:parseInt(r,10),t[e]=n)},X.isThemeColor=function(e){if(!e||"string"!=typeof e)return!1;switch((e=e.toLowerCase())[0]){case"b":return 0===e.indexOf("background ");case"t":return 0===e.indexOf("text ");case"a":return 0===e.indexOf("accent ");case"h":return 0===e.indexOf("hyperlink");case"f":return 0===e.indexOf("followedhyperlink");default:return!1}},X.mixTranslucentColor=function(e,t){var r,n,o,i;return 255===t.a?t:0===t.a?e:(r=Math.round((255-e.a)*t.a/255),n=X.getMaxInt(e.a,t.a,e.r,t.r,r+e.a),o=X.getMaxInt(e.a,t.a,e.g,t.g,r+e.a),i=X.getMaxInt(e.a,t.a,e.b,t.b,r+e.a),new l(Math.round(r+e.a),n,o,i))},X.getMaxInt=function(e,t,r,n,o){return 0===o?0:(t*n+(255-t)*e*r/255)/o},X.toExcelColor=function(e,t){if(e instanceof w)return e;if(t===b&&(t=16777215),!e)return null;if(X.isThemeColor(e))return X.getExcelThemeColor(e);var r=X.fromHtmlColor(e);return r!==t?X.fromColorToExcelColor(X.fromArgb(r)):null},X.toExcelBackColor=function(e,t){var r,n;if("object"==typeof e)if(e.stops)for(r=e,n=0;n<r.stops.length;n++)r.stops[n].color=X.toExcelColor(r.stops[n].color);else r={patternType:e.type,fgColor:X.toExcelColor(e.patternColor||"#000000"),bgColor:X.toExcelColor(e.backgroundColor||"#FFFFFF")};else r=e?{patternType:1,fgColor:X.toExcelColor(e),bgColor:X.toExcelColor(t?"#000000":"#FFFFFF")}:{patternType:0,fgColor:new w(1,64,0),bgColor:new w(1,65,0)};return r},X.toExcelIndexedColor=function(e){if(e){var t=X.getPaletteColorIndex(e,63);return new w(1,t)}return null},X.fromColorToExcelColor=function(e){var t,r,n,o,i;return 255!==(e=X.mixTranslucentColor(X.fromArgb(16777215),e)).a&&(r=(t=X.tj).r-e.a+e.a/255*e.r,n=t.g-e.a+e.a/255*e.g,o=t.b-e.a+e.a/255*e.b,e=new l(255,r,n,o)),i=e.a*Math.pow(16,6)+e.r*Math.pow(16,4)+e.g*Math.pow(16,2)+e.b,new w(2,i,0)},X.getClosestColorIndex=function(e,t){var r,n,o,i,a,s,l,u;for(t===b&&(t=64),r=-1,n=Number.MAX_VALUE,o=Math.min(X.palette.length-1,t);0<=o;o--)a=(16711680&(i=X.palette[o]))>>16,s=(65280&i)>>8,l=255&i,(u=Math.abs(.3*(a-e.r))+Math.abs(.59*(s-e.g))+Math.abs(.11*(l-e.b)))<n&&(n=u,r=o);return r},X.getPaletteColorIndex=function(e,t){return t===b&&(t=64),e.isThemeColor()?X.getClosestColorIndex(X.getRGBColor(new w(3,e.value(),0))):X.getClosestColorIndex(X.getRGBColor(e),t)},X.toColorSchemeIndex=function(e){return"ACCENT1"===e?4:"ACCENT2"===e?5:"ACCENT3"===e?6:"ACCENT4"===e?7:"ACCENT5"===e?8:"ACCENT6"===e?9:"DK1"===e?1:"DK2"===e?3:"LT1"===e?0:"LT2"===e?2:"HLIK"===e?10:"FOLHLINK"===e?11:"PHCLR"===e?240:"BG1"===e?243:"BG2"===e?244:"TX1"===e?241:"TX2"===e?242:255},X.scRgbTosRgb=function(e){return e<=0?0:e<=.0031308?255*e*12.92+.5:e<1?255*(1.055*Math.pow(e,.4166666666666667)-.055)+.5:255},X.convertHLSToRGB=function(e,t,r){var n,o,i=0,a=0,s=0;return s=0===r?a=i=255*t/255|0:(o=2*t-(n=t<=127?(t*(255+r)+127)/255:t+r-(t*r+127)/255),i=parseInt(""+(255*X.hueToRGB(o,n,e+85)+127)/255,10),a=parseInt(""+(255*X.hueToRGB(o,n,e)+127)/255,10),parseInt(""+(255*X.hueToRGB(o,n,e-85)+127)/255,10)),new l(0,i=(i=0<i?i:0)<255?i:255,a=(a=0<a?a:0)<255?a:255,s=255<(s=0<s?s:0)?s:255)},X.hueToRGB=function(e,t,r){return r<0&&(r+=255),255<r&&(r-=255),r<42?e+((t-e)*r+21)/42:r<127?t:r<170?e+((t-e)*(170-r)+21)/42:e},X.fromPresetColorVal=function(e){var t=X.sj[e];return t!==b?X.fromArgb(t):null},X.pj=null,X.rj=null,X.useCustomPalette=!1,X.customPalette=null,X.palette=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080],X.tj=new l(255,255,255,255),X.sj={aliceblue:4293982463,antiquewhite:4294634455,aqua:4278255615,aquamarine:4286578644,azure:4293984255,beige:4294309340,bisque:4294960324,black:4278190080,blanchedalmond:4294962125,blue:4278190335,blueviolet:4287245282,brown:4289014314,burlywood:4292786311,cadetblue:4284456608,chartreuse:4286578432,chocolate:4291979550,coral:4294934352,cornflowerblue:4284782061,cornsilk:4294965468,crimson:4292613180,cyan:4278255615,darkblue:4278190219,darkcyan:4278225803,darkgoldenrod:4290283019,darkgray:4289309097,darkgreen:4278215680,darkkhaki:4290623339,darkmagenta:4287299723,darkolivegreen:4283788079,darkorange:4294937600,darkorchid:4288230092,darkred:4287299584,darksalmon:4293498490,darkseagreen:4287609999,darkslateblue:4282924427,darkslategray:4281290575,darkturquoise:4278243025,darkviolet:4287889619,deeppink:4294907027,deepskyblue:4278239231,dimgray:4285098345,dodgerblue:4280193279,feldspar:4291924597,firebrick:4289864226,floralwhite:4294966e3,forestgreen:4280453922,fuchsia:4294902015,gainsboro:4292664540,ghostwhite:4294506751,gold:4294956800,goldenrod:4292519200,gray:4286611584,green:4278222848,greenyellow:4289593135,honeydew:4293984240,hotpink:4294928820,"indianred ":4291648604,"indigo ":4283105410,ivory:4294967280,khaki:4293977740,lavender:4293322490,lavenderblush:4294963445,lawngreen:4286381056,lemonchiffon:4294965965,lightblue:4289583334,lightcoral:4293951616,lightcyan:4292935679,lightgoldenrodyellow:4294638290,lightgrey:4292072403,lightgreen:4287688336,lightpink:4294948545,lightsalmon:4294942842,lightseagreen:4280332970,lightskyblue:4287090426,lightslateblue:4286869759,lightslategray:4286023833,lightsteelblue:4289774814,lightyellow:4294967264,lime:4278255360,limegreen:4281519410,linen:4294635750,magenta:4294902015,maroon:4286578688,mediumaquamarine:4284927402,mediumblue:4278190285,mediumorchid:4290401747,mediumpurple:4287852760,mediumseagreen:4282168177,mediumslateblue:4286277870,mediumspringgreen:4278254234,mediumturquoise:4282962380,mediumvioletred:4291237253,midnightblue:4279834992,mintcream:4294311930,mistyrose:4294960353,moccasin:4294960309,navajowhite:4294958765,navy:4278190208,oldlace:4294833638,olive:4286611456,olivedrab:4285238819,orange:4294944e3,orangered:4294919424,orchid:4292505814,palegoldenrod:4293847210,palegreen:4288215960,paleturquoise:4289720046,palevioletred:4292374675,papayawhip:4294963157,peachpuff:4294957753,peru:4291659071,pink:4294951115,plum:4292714717,powderblue:4289781990,purple:4286578816,red:4294901760,rosybrown:4290547599,royalblue:4282477025,saddlebrown:4287317267,salmon:4294606962,sandybrown:4294222944,seagreen:4281240407,seashell:4294964718,sienna:4288696877,silver:4290822336,skyblue:4287090411,slateblue:4285160141,slategray:4285563024,snow:4294966010,springgreen:4278255487,steelblue:4282811060,tan:4291998860,teal:4278222976,thistle:4292394968,tomato:4294927175,turquoise:4282441936,violet:4293821166,violetred:4291829904,wheat:4294303411,white:4294967295,whitesmoke:4294309365,yellow:4294967040,yellowgreen:4288335154,transparent:16777215},E=X,t.ColorHelper=E,K.getFontName=function(e){var t,r;if(!e)return null;if(-1!==(t=e).indexOf(",")&&(t=t.split(",")[0]),t){for(r=t.length-1;0<=r&&"/"!==t[r];)r--;0<=r&&(t=t.substring(r)),t&&"/#"===t.substring(0,2)&&(t=t.substring(2)),'"'===t[0]&&'"'===t[t.length-1]&&(t=t.substring(1,t.length-1))}return t},K.setStyleInfoFont=function(e,t,r,n){var o,i,a,s,l,u,c=e.fontName;c=c||y,i="",0<e.fontSize&&(i=Math.round(10*I.pointToPixel(e.fontSize))/10+"px"),a=e.isItalic?"italic":"normal",s=e.isBold?"bold":"normal",l="",e.fontColor&&(l=e.fontColor.isThemeColor()?E.getThemeColorName(e.fontColor):E.toRGBColor(e.fontColor)),t.foreColor=l||null,e.isStrikeOut&&(t.textDecoration=2),e.underLineStyle!==b&&0!==e.underLineStyle&&(u=1,2===e.underLineStyle&&(u=8),t.textDecoration===b?t.textDecoration=u:t.textDecoration=t.textDecoration|u),1===e.fontScheme?(t.themeFont="Headings",r&&(c=r)):2===e.fontScheme&&(t.themeFont="Body",n&&(c=n)),(o=a+" "+s+" "+i+" "+c)&&(t.font=o)},K.uj=function(){return K.vj||(K.vj={}),K.vj},K.fromHtmlFont=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d;if(!p.StringEx.q(e)){if(t={},(r=K.uj())[e])return r[e];if(0!==(n=K.splitFontString(e)).length){for(o=0,s=a=i=!1;o<n.length;){if("normal"!==(l=n[o].toLowerCase()))if(i||"italic"!==l&&"oblique"!==l&&"inherit"!==l)if(a||"small-caps"!==l)if(s||"bold"!==l&&"bolder"!==l&&"lighter"!==l&&"100"!==l&&"200"!==l&&"300"!==l&&"400"!==l&&"500"!==l&&"600"!==l&&"700"!==l&&"800"!==l&&"900"!==l&&"inherit"!==l){if("/"===l.substring(0,1)){o++;break}if("xx-small"===l||"x-small"===l||"small"===l||"medium"===l||"large"===l||"x-large"===l||"xx-large"===l||-1!==l.indexOf("px")||-1!==l.indexOf("pt"))break}else s=!0,"bolder"===l||700<=parseInt(l,10)?t.fontWeight="bold":t.fontWeight="lighter"===l?"ExtraLight":l;else a=!0,t.fontVariant=l;else i=!0,"oblique"===l&&(l=C),t.fontStyle=l;if(o++,i&&a&&s)break}if(o<n.length&&("xx-small"===(u=n[o].toLowerCase())||"x-small"===u||"small"===u||"medium"===u||"large"===u||"x-large"===u||"xx-large"===u?(c=10,"xx-small"===u||"x-small"===u?c=6:"small"===u?c=8:"medium"===u?c=10:"large"===u?c=14:"x-large"===u?c=18:"xx-large"===u&&(c=22),t.fontSize=c):(h=void 0,-1!==u.indexOf("px")?h=parseFloat(u):-1!==u.indexOf("pt")&&(f=parseFloat(u),isNaN(f)||(h=I.pointToPixel(f))),isNaN(h)||(t.fontSize=h)),o++),o<n.length&&"/"===n[o].toLowerCase().substring(0,1)&&o++,o<n.length){for(d=n[o],o++;o<n.length;o++)d=d+" "+n[o];t.fontFamily=d}return r[e]=t}}},K.composeFontWeightAndFontStyleToDestFont=function(e,t){var r=K.fromHtmlFont(e),n=K.fromHtmlFont(t);return r.fontWeight&&(n.fontWeight=r.fontWeight),r.fontStyle&&(n.fontStyle=r.fontStyle),(n.fontWeight?n.fontWeight:"normal")+" "+(n.fontStyle?n.fontStyle:"normal")+" "+n.fontSize+"px "+n.fontFamily+" "+(n.fontVariant?n.fontVariant:"")},K.splitFontString=function(e){var t,r,n,o,i;if(p.StringEx.q(e))return[];for(t=[],r="",n=0,o=(e=e.trim()).length;n<o;n++)if(" "===(i=e[n])||"/"===i)t.push(r),r="","/"===i&&(r+="/");else if("'"===i||'"'===i)for(n++;e[n]!==i;)r+=e[n],n++;else r+=i;return 0<r.length&&t.push(r),t},K.toVerticalAlignment=function(e){switch(e){case 0:return 0;case 1:return 1;case 2:default:return 2}},K.toExcelVerticalAlignment=function(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;default:return 0}},K.toHorizontalAlignment=function(e){switch(e){case 0:return 3;case 1:case 6:return 0;case 2:return 1;case 3:return 2;case 4:case 5:case 7:default:return 3}},K.toExcelHorizontalAlignment=function(e){switch(e){case 1:return 2;case 0:return 1;case 2:return 3;case 3:default:return 0}},K.toBorderLine=function(e){if(e)return 0===e.lineStyle?null:(e.color||(e.color=new w(1,0,0)),e.color.isThemeColor()?{color:E.getThemeColorName(e.color),style:e.lineStyle}:{color:""+E.getRGBColor(e.color),style:e.lineStyle})},K.toExcelBorderSide=function(e){var t,r,n=new o;return e&&(t=e.color,E.isThemeColor(t)?n.color=E.getExcelThemeColor(t):(r=e.color,n.color=new w(2,E.fromHtmlColor(r),0)),n.lineStyle=e.style),n},K.setStyleInfoBorders=function(e,t){t.borderLeft=K.toBorderLine(e.left),t.borderRight=K.toBorderLine(e.right),t.borderTop=K.toBorderLine(e.top),t.borderBottom=K.toBorderLine(e.bottom),t.borderVertical=K.toBorderLine(e.vertical),t.borderHorizontal=K.toBorderLine(e.horizontal),t.diagonalUp=K.toBorderLine(e.diagonalUp),t.diagonalDown=K.toBorderLine(e.diagonalDown)},K.toCellStyle=function(e,t,r){var n,o,i,a,s,l,u={};return e?((!e.isStyleFormat||e.isStyleFormat&&(e.applyFont===b||e.applyFont))&&e.font&&K.setStyleInfoFont(e.font,u,t,r),e.isStyleFormat&&(!e.isStyleFormat||e.applyProtection!==b&&!e.applyProtection)||(u.locked=e.isLocked),e.isStyleFormat&&(!e.isStyleFormat||e.applyAlignment!==b&&!e.applyAlignment)||(e.indent!==b&&(u.textIndent=e.indent,0<u.textIndent&&(n=u.textIndent,o=Math.floor(n),u.textIndent=n-o==.5&&0==(1&o)?o:Math.round(n))),u.wordWrap=e.isWordWrap,u.vAlign=K.toVerticalAlignment(e.verticalAlign),u.hAlign=K.toHorizontalAlignment(e.horizontalAlign),255===e.rotation&&(u.isVerticalText=!0)),e.border&&(i=e.border,e.isStyleFormat&&e.applyBorder!==b&&!e.applyBorder&&(i=null),i&&K.setStyleInfoBorders(i,u)),e.fill&&0!==e.fill.patternType?K.re(e.fill,u):u.backColor=null,e.isShrinkToFit&&(u.shrinkToFit=!0),e.rotation&&(u.textOrientation=90<e.rotation?90-e.rotation:e.rotation),a=M.getFormatCode(e),s=e.isStyleFormat,l=e.applyNumberFormat,s&&(l!==b&&!l||"General"===a)||(u.formatter=a),p.k(e.quotePrefix)||(u.quotePrefix=e.quotePrefix),u):null},K.toRichTextStyle=function(e,t,r){var n={};return K.setStyleInfoFont(e,n,t,r),n.charSetIndex=e.charSetIndex,n.isCondense=e.isCondense,n.isExtend=e.isExtend,n.fontFamily=e.fontFamily,n.isOutlineStyle=e.isOutlineStyle,n.isShadowStyle=e.isShadowStyle,n.vertAlign=e.vertAlign,n},K.fromRichTextStyle=function(e){var t,r,n,o,i;if(!p.k(e))return t=y,r={},e.font&&((n=K.fromHtmlFont(e.font)).fontFamily&&(t=K.getFontName(n.fontFamily)),p.StringEx.q(t)&&(t=y),r.fontFamily=t,n.fontSize&&(r.fontSize=Math.round(I.pixelToPoint(n.fontSize))),n.fontStyle===C&&(r.isItalic=!0),"bold"===n.fontWeight&&(r.isBold=!0)),e.foreColor&&(E.isThemeColor(e.foreColor)?r.foreColor=E.getExcelThemeColor(e.foreColor):(o=E.fromHtmlColor(e.foreColor),o=(i=E.mixTranslucentColor(E.fromArgb(16777215),E.fromArgb(o))).a*Math.pow(16,6)+i.r*Math.pow(16,4)+i.g*Math.pow(16,2)+i.b,r.foreColor=new w(2,o,0))),e.themeFont&&(e.themeFont.toUpperCase()==="Headings".toUpperCase()?r.fontScheme=1:e.themeFont.toUpperCase()==="Body".toUpperCase()&&(r.fontScheme=2)),1==(1&e.textDecoration)&&(r.underLineStyle=1),8==(8&e.textDecoration)&&(r.underLineStyle=2),r.isStrikeOut=2==(2&e.textDecoration),r.charSetIndex=e.charSetIndex,r.isCondense=e.isCondense,r.isExtend=e.isExtend,r.fontFamilySet=e.fontFamily,r.isOutlineStyle=e.isOutlineStyle,r.isShadowStyle=e.isShadowStyle,r.vertAlign=e.vertAlign,r},K.toSchemeClrValue=function(e){switch(e){case 255:return"";case 1:return"dk1";case 0:return"lt1";case 3:return"dk2";case 2:return"lt2";case 4:return"accent1";case 5:return"accent2";case 6:return"accent3";case 7:return"accent4";case 8:return"accent5";case 9:return"accent6";case 10:return"hlink";case 11:return"folHlink";case 240:return"phClr";case 241:return"tx1";case 242:return"tx2";case 243:return"bg1";case 244:return"bg2";default:return""}},K.re=function(e,t){1===e.patternType?K.wj(e.fgColor,t):e.patternType?K.xj(e.patternType,e.fgColor,e.bgColor,t):e.stops&&K.yj(e,t)},K.wj=function(e,t){if(p.k(e))t.backColor="#000000";else{var r=e.isRGBColor()&&0===e.value();if(e.isRGBColor()&&0===e.value()||e.isIndexedColor()&&64===e.value()||e.isIndexedColor()&&65===e.value())return void(r&&(t.backColor=null));e.isThemeColor()?t.backColor=E.getThemeColorName(e):t.backColor=E.toRGBColor(e)}},K.xj=function(e,t,r,n){n.backColor={type:e,patternColor:null,backgroundColor:null},t&&(t.isThemeColor()?n.backColor.patternColor=E.getThemeColorName(t):n.backColor.patternColor=E.toRGBColor(t)),r&&(r.isThemeColor()?n.backColor.backgroundColor=E.getThemeColorName(r):n.backColor.backgroundColor=E.toRGBColor(r))},K.yj=function(e,t){var r,n;for(t.backColor=e,r=0;r<e.stops.length;r++)"string"!=typeof(n=e.stops[r].color)&&(n.isThemeColor()?e.stops[r].color=E.getThemeColorName(n):e.stops[r].color=E.toRGBColor(n))},K.getStyleFormatter=function(e){var t,r,n=null,o=e.formatter;return"string"==typeof o&&("="===o.charAt(0)||0<=o.indexOf("{{")&&0<=o.indexOf("}}"))||("string"==typeof o&&" "!==o?n=o:e.autoFormatter?(t=e.autoFormatter.formatCached)&&!p.StringEx.C(t)&&(n=t):o&&(r=o.formatCached)&&!p.StringEx.C(r)&&(n=r)),n},K.toExtendedFormat=function(e){var t,r,n,o,i,a,s,l,u,c,h,f;if(e){if(t=new A,(r=K.getStyleFormatter(e))?(o=(n=M.getFormatId(r)).id,n.isBuiltIn?t.numberFormatIndex=o:t.numberFormat=new T(o,r),e.name&&"NORMAL"===e.name.toUpperCase()||e.parentName&&"NORMAL"===e.parentName.toUpperCase()&&0===o||(t.applyNumberFormat=!0)):t.numberFormatIndex=0,e.backColor&&0!==e.backColor.type){if(t.applyFill=!0,i=new S,"string"==typeof e.backColor)i.patternType=1,i.fgColor=e.backColor;else if(p.k(e.backColor.type)||"path"===e.backColor.type)for(a in e.backColor)i[a]=e.backColor[a];else i.patternType=e.backColor.type,i.fgColor=e.backColor.patternColor,i.bgColor=e.backColor.backgroundColor;for(p.k(i.fgColor)||(i.fgColor=E.toExcelColor(i.fgColor)),p.k(i.bgColor)||(i.bgColor=E.toExcelColor(i.bgColor)),s=i.stops&&i.stops.length,l=0;l<s;l++)i.stops[l].color=E.toExcelColor(i.stops[l].color);t.fill=i}return(e.borderLeft||e.borderRight||e.borderTop||e.borderBottom||e.diagonalUp||e.diagonalDown)&&(t.border=new v,e.borderLeft&&(t.border.left=K.toExcelBorderSide(e.borderLeft)),e.borderRight&&(t.border.right=K.toExcelBorderSide(e.borderRight)),e.borderTop&&(t.border.top=K.toExcelBorderSide(e.borderTop)),e.borderBottom&&(t.border.bottom=K.toExcelBorderSide(e.borderBottom)),e.diagonalDown&&(t.border.diagonalDown=K.toExcelBorderSide(e.diagonalDown)),e.diagonalUp&&(t.border.diagonalUp=K.toExcelBorderSide(e.diagonalUp)),t.applyBorder=!0),(e.font||e.foreColor||e.themeFont||e.textDecoration!==b&&null!==e.textDecoration)&&(t.applyFont=!0,u=y,e.font&&((c=K.fromHtmlFont(e.font)).fontFamily&&(u=K.getFontName(c.fontFamily)),p.StringEx.q(u)&&(u=y),t.font=new x(u.trim(),null,0),c.fontSize&&(t.font.fontSize=Math.round(I.pixelToPoint(c.fontSize))),c.fontStyle===C&&(t.font.isItalic=!0),"bold"===c.fontWeight&&(t.font.isBold=!0)),1==(1&e.textDecoration)&&(t.font.underLineStyle=1),8==(8&e.textDecoration)&&(t.font.underLineStyle=2),e.foreColor&&(E.isThemeColor(e.foreColor)?t.font.fontColor=E.getExcelThemeColor(e.foreColor):(h=E.fromHtmlColor(e.foreColor),h=(f=E.mixTranslucentColor(E.fromArgb(16777215),E.fromArgb(h))).a*Math.pow(16,6)+f.r*Math.pow(16,4)+f.g*Math.pow(16,2)+f.b,t.font.fontColor=new w(2,h,0))),t.font.isStrikeOut=2==(2&e.textDecoration)),e.themeFont&&(e.themeFont.toUpperCase()==="Headings".toUpperCase()?t.font.fontScheme=1:e.themeFont.toUpperCase()==="Body".toUpperCase()&&(t.font.fontScheme=2)),e.shrinkToFit&&(t.isShrinkToFit=!0),e.textOrientation&&(t.rotation=e.textOrientation<0?90-e.textOrientation:e.textOrientation),e.locked!==b?t.isLocked=e.locked:t.isLocked=!0,null!==e.wordWrap&&e.wordWrap!==b&&(t.isWordWrap=e.wordWrap),null!==e.textIndent&&e.textIndent!==b&&(t.indent=Math.ceil(e.textIndent)),t.verticalAlign=K.toExcelVerticalAlignment(e.vAlign),t.horizontalAlign=K.toExcelHorizontalAlignment(e.hAlign),!0===e.isVerticalText&&(t.isVerticalText=e.isVerticalText),p.k(e.quotePrefix)||(t.quotePrefix=e.quotePrefix),p.k(e.parentName)||(t.parentName=e.parentName),t}},K.toDifferentialFormatting=function(e){var t,r,n,o,i,a,s,l={},u=e.isSlicerHeader,c=e.isFormatStyle,h=e.formatter;return"string"==typeof h&&" "!==h&&(r=(t=M.getFormatId(h)).id,t.isBuiltIn?(l.numberFormatIndex=r,l.numberFormatCode=h):l.numberFormat=new T(r,h)),e.backColor!==b&&(n=e.backColor,l.fill=n?E.toExcelBackColor(n,!0):n),(c||e.borderLeft||e.borderRight||e.borderTop||e.borderBottom||e.borderVertical||e.borderHorizontal)&&(l.border=new v,e.borderLeft?l.border.left=K.toExcelBorderSide(e.borderLeft):(u||e.borderLeft===b&&c)&&(l.border.left=b),e.borderRight?l.border.right=K.toExcelBorderSide(e.borderRight):(u||e.borderRight===b&&c)&&(l.border.right=b),e.borderTop?l.border.top=K.toExcelBorderSide(e.borderTop):(u||e.borderTop===b&&c)&&(l.border.top=b),e.borderBottom?l.border.bottom=K.toExcelBorderSide(e.borderBottom):(u||e.borderBottom===b&&c)&&(l.border.bottom=b),e.borderVertical&&(l.border.vertical=K.toExcelBorderSide(e.borderVertical)),e.borderHorizontal&&(l.border.horizontal=K.toExcelBorderSide(e.borderHorizontal))),(e.font||e.foreColor!==b||e.themeFont||e.textDecoration!==b&&null!==e.textDecoration)&&(o=y,i=void 0,e.font&&((a=K.fromHtmlFont(e.font)).fontFamily&&(o=K.getFontName(a.fontFamily)),p.StringEx.q(o)&&(o=y),l.font=new x(o.trim(),null,0),a.fontSize&&(l.font.fontSize=Math.round(I.pixelToPoint(a.fontSize))),"italic"===a.fontStyle&&(l.font.isItalic=!0),"bold"===a.fontWeight&&(l.font.isBold=!0)),l.font||(l.font=new x(o.trim(),null,0)),1==(1&e.textDecoration)&&(l.font.underLineStyle=1),8==(8&e.textDecoration)&&(l.font.underLineStyle=2),e.foreColor&&(E.isThemeColor(e.foreColor)?l.font.fontColor=E.getExcelThemeColor(e.foreColor):(i=E.fromHtmlColor(e.foreColor),i=(s=E.mixTranslucentColor(E.fromArgb(16777215),E.fromArgb(i))).a*Math.pow(16,6)+s.r*Math.pow(16,4)+s.g*Math.pow(16,2)+s.b,l.font.fontColor=new w(2,i,0))),null===e.foreColor&&(l.font.fontColor=null),l.font.isStrikeOut=2==(2&e.textDecoration)),l.isPartFontStyle=e.isPartFontStyle,l.isSlicerHeader=u,l},K.cloneSpreadJSStyle=function(e){var t={};return t.backColor=e.backColor,t.foreColor=e.foreColor,t.hAlign=e.hAlign,t.vAlign=e.vAlign,t.font=e.font,t.themeFont=e.themeFont,t.formatter=e.formatter,t.borderLeft=e.borderLeft,t.borderTop=e.borderTop,t.borderRight=e.borderRight,t.borderBottom=e.borderBottom,t.diagonalDown=e.diagonalDown,t.diagonalUp=e.diagonalUp,t.locked=e.locked,t.textIndent=e.textIndent,t.wordWrap=e.wordWrap,t.shrinkToFit=e.shrinkToFit,t.textDecoration=e.textDecoration,t.textOrientation=e.textOrientation,t.isVerticalText=e.isVerticalText,t.quotePrefix=e.quotePrefix,t.autoFormatter=e.autoFormatter,t.name=e.name,t.parentName=e.parentName,t},K.convertDxfToStyle=function(e,t,r){var n,o={};return e.font&&K.setStyleInfoFont(e.font,o,t,r),e.fill&&(p.isNullOrUndefined(e.fill.patternType)&&e.fill.bgColor&&(e.fill.patternType=1),1===e.fill.patternType&&(e.fill.fgColor=e.fill.bgColor),K.re(e.fill,o)),e.border&&K.setStyleInfoBorders(e.border,o),e.numberFormat&&"General"!==(n=M.getFormatCode(e))&&(o.formatter=n),o},K.vj=null,n=K,t.ConverterHelper=n,Y.ah=function(e){var t,r,n,o,i={foreColor:"black",font:"normal normal normal 11pt/normal Calibri",locked:!0,name:"Normal",textDecoration:0,hAlign:3,vAlign:0,formatter:"General"};for(t in e.sheets)if(e.sheets.hasOwnProperty(t)&&(r=e.sheets[t]).data&&r.data.defaultDataNode&&r.data.defaultDataNode.style){for(o in n=r.data.defaultDataNode.style)n.hasOwnProperty(o)&&!p.k(n[o])&&(i[o]=n[o]);break}return i},t.DefaultStyle=Y,Z.getSystemColor=function(e){return E.fromArgb(Z.zj[e])},Z.zj=[4290032820,4288263377,4278190080,4289440683,4293980400,4288716960,4285098345,4293125091,4294967295,4278190080,4278190080,4290367978,4292338930,4285361517,4281571839,4294967295,4278216396,4294244348,4290760155,4282601044,4294967265,4278190080,4293980400,4293980400,4281571839,4278190080,4291348680,4294967295,4284769380,4278190080,4288716960,4293125091,4293980400,4294967295,4288716960,4278190080],a=Z,q.getSystemColor=function(e){return q.systemColors[e.toUpperCase()]},q.systemColors={length:0,"3DDKSHADOW":a.getSystemColor(30),"3DLIGHT":a.getSystemColor(31),ACTIVEBORDER:a.getSystemColor(0),ACTIVECAPTION:a.getSystemColor(1),APPWORKSPACE:a.getSystemColor(3),BACKGROUND:a.getSystemColor(10),BTNFACE:a.getSystemColor(32),BTNHIGHLIGHT:a.getSystemColor(33),BTNSHADOW:a.getSystemColor(34),BTNTEXT:a.getSystemColor(35),CAPTIONTEXT:a.getSystemColor(2),GRAYTEXT:a.getSystemColor(13),HIGHLIGHT:a.getSystemColor(14),HIGHLIGHTTEXT:a.getSystemColor(15),INACTIVEBORDER:a.getSystemColor(17),INACTIVECAPTION:a.getSystemColor(18),INACTIVECAPTIONTEXT:a.getSystemColor(19),INFOBK:a.getSystemColor(20),INFOTEXT:a.getSystemColor(21),MENU:a.getSystemColor(22),GRADIENTACTIVECAPTION:a.getSystemColor(11),HOTLIGHT:a.getSystemColor(16),GRADIENTINACTIVECAPTION:a.getSystemColor(12),MENUBAR:a.getSystemColor(23),MENUHIGHLIGHT:a.getSystemColor(24),MENUTEXT:a.getSystemColor(25),SCROLLBAR:a.getSystemColor(26),WINDOW:a.getSystemColor(27),WINDOWFRAME:a.getSystemColor(28),WINDOWTEXT:a.getSystemColor(29)},t.ExcelSystemColor=q,t.clearCache=function(){I.lj=b,M.ij=b,n.vj=b,E.pj=b,E.rj=b}},"./src/excel-io.ts":function(e,t,r){"use strict";var n,o,a,s,l,u,i;function c(){this.Dj=new n.FileLoader}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/xlsx-io/common/file-loader.ts"),o=r("./src/xlsx-io/reader/xlsx-reader.ts"),a=r("./src/xlsx-io/writer/xlsx-writer.ts"),s=r("./src/xlsx-io/password/xlsxEncryptionHelper.ts"),l=r("./src/xlsx-io/common/errorcode.ts"),u=r("./src/xlsx-io/common/errorMessage.ts"),t.ErrorCode=l.errorCode,(i=r("./src/lc/releaseLc.js"))&&(i.Aj&&i.Aj(t),1===i.Bj&&i.Cj()),c.prototype.open=function(e,t,r,n){t=t||function(){},r=r||function(){},this.Dj.onFileLoad=function(e){try{(new o.XlsxReader).Ej(e,function(e){t(e)})}catch(e){r({errorCode:l.errorCode.fileFormatError,errorMessage:u.sR().EXP_FILE_FORMAT})}},this.Dj.onError=r,this.Dj.loadFile(e,n)},c.prototype.save=function(e,t,r,n){var o,i;t=t||function(){},r=r||function(){},"object"==typeof e&&(o=JSON.parse(JSON.stringify(e))),"string"==typeof e&&(o=JSON.parse(e)),new a.XlsxWriter(o,function(){try{this.onZip=function(e){if(n&&n.password)try{e=s.XlsxEncryptionHelper.Fj(e,n.password),i||(e=s.XlsxEncryptionHelper.Gj(e))}catch(e){return void r({errorCode:l.errorCode.fileFormatError,errorMessage:u.sR().EXP_FILE_FORMAT})}t(e)},this.onError=function(){r({errorCode:l.errorCode.fileFormatError,errorMessage:u.sR().EXP_FILE_FORMAT})},n&&n.password&&(i=n.useArrayBuffer,n.useArrayBuffer=!0),this.Hj=n||{},this.Ij()}catch(e){r({errorCode:l.errorCode.fileFormatError,errorMessage:u.sR().EXP_FILE_FORMAT})}})},t.IO=c},"./src/lc/common.js":function(S,e,x){!function(){"use strict";var i,e,h,t,r={Aj:function(e){i=e}},o=x("./src/xlsx-io/reader/xlsx-reader.ts").XlsxReader,a=x("./src/datamodel/datamodel-writer.ts").WriterDataModel,s=x("./src/common/common.ts").Ha,n=x("./src/lc/lcValidator.js"),l=n.Jj,A=n.Kj,u="object"==typeof G&&G&&G.Object===Object&&G,c="object"==typeof self&&self&&self.Object===Object&&self,k=u||c||Function("return this")(),f=/^[\w\-]+$/i,M=/^[0-9.]+$/,d=A("XRsZ"),I=A("HUkJ"),E=A("T&g"),R=A("Q&w"),D=A("GRz1"),N=A("XSzB"),F=A("XRwh"),_=A("WQs5");function p(e,t){var r,n,o,i,a="",s=0;for(r=0;r<e.length;r++)s=Math.max(s,e[r].length);for(r=0;r<s;r++){for(t&&(n=""),i=0;i<e.length;i++)t?n+=r>=e[i].length?"00":e[i].charAt(r)+e[i].charAt(r+1):r<e[i].length&&(a+=e[i].charAt(r));t&&(o=parseInt(n,16),a+=String.fromCharCode(o),r++)}return a}function g(e){var t=s(),r=t&&t[p(["G","C"])],n=r&&r[p(["Sra","ped"])],o=n&&n[p(["Set","hes"])];return o&&o[e]||i&&i[e]}function m(){var e=s(),t=e&&e[p(["G","C"])],r=t&&t[p(["Sra","ped"])];return r&&r[p(["Cmo","omn"])]}function b(y,C){var w,v,S,x,e,t={isVd:function(e){var t=g("Workbook");return e=t&&1===t.lm||e,this.s&&!this.e&&(!this.adr||!!this.adr.dsr==!!e)}},T=(e=A("JYx3Gb#8Pb5R"),function(e){var t=A("VdgJHc#wJb59"),r=A("Zdg3Ga#UHbw5");return e&&(function(e){var t=A("MlSZto#Z");return e&&e===t}(e[t])||function(e){var t=A("yXbog&w");return e&&e===t}(e[t])||function(e){var t=A("4LJITMx8UMcA"),r=A("jOxo"),n=A("JYw3Gb4NOb6x"),o=A("g1Jbww#Y"),i=RegExp("^[\\w\\-]+\\."+o+"$","i");return e&&(e===t||e===r||e===n||f.test(e)||i.test(e))}(e[r]))}(k[e]));return t.b=T,t.s=function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b;if(!y)return!1;if(!(e=y[I])||!e.length)return!1;for(n=0,o=e.length;n<o;n++)if(r=(t=e[n])&&t[R]===C){w=t[E];break}if(!r)return!1;if(y[_]&&(x=y[_]),y[F]){if(i=new Date,s=y[F],a=new Date(P(s.substr(0,4))||0,P(s.substr(4,2))-1||0,P(s.substr(6,2))||0),S=Math.ceil((a-i)/864e5),v=S<=0)return!1}else S=void 0;return!!(T||!y[D]&&!y[N]||(d=y[D],y[N],function(){var e=A("JYx3Gb#8Pb5R"),t=A("VdgJHc#wJb59"),r=A("Udg36Y#oUddV"),n=k[e];return n&&n[t]===r}()&&(p=A("JYx3Gb#8Pb5R"),g=A("1agFGc#UHbw5"),(m=k[p]&&k[p][g])&&(m=m.toLowerCase(),b=d.split(","),d&&function(e,t){var r,n,o,i;if(e&&0===e.indexOf("//")&&!((r=e.slice(2).split("/")).length<1))for(n=r[0],o=0,i=t.length;o<i;o++)if(t[o]===n)return 1}(m,b))))||(l=y[D],y[N],c=A("JYx3Gb#8Pb5R"),h=A("Zdg3Ga#UHbw5"),!(f=k[c]&&k[c][h])||(f=f.toLowerCase(),u=l.split(","),l&&function(e,t){var r,n,o,i,a;for(r=0,n=t.length;r<n;r++){if(o=t[r],i=!1,o&&0===o.lastIndexOf("*.",0)&&(i=!0),(o=i?o.slice(2):o)===e)return 1;if(i&&0<(a=e.indexOf("."+o))&&a===e.length-o.length-1)return 1}}(f,u)||l&&function(e,t){var r,n,o,i;if(e&&4===e.split(".").length)for(r=0,n=t.length;r<n;r++)if((o=t[r])&&0<(i=o.length-2)&&(o===e||".*"===o.substr(i)&&e.substr(0,i)===o.substr(0,i)&&M.test(e)))return 1}(f,u))))}(),t.m=y?y[d]?-1:1:0,t.n=w,(t.e=v)||(t.d=S),t.adr=x,t}function P(e){return parseInt(e,10)}function y(e,t){e.m=t?e.m:-1}function C(e){var t=g(p(["S","R"])),r=m()&&t&&m().ResourceManager;return r&&new r(t).getResource()[e]}function w(e,t){var r,n,o,i=!0,a="";if(e)if("string"==typeof e)(e=e.trim())&&(r=[e]);else if(Array.isArray(e)){for(n=!0,r=[],o=0;o<e.length;o++)a=e[o].trim(),r.push(a),n&&a&&(n=!1);n&&(r=null)}return r||(i=!1,r=t),p(r,i)}function v(s,l,u){var c=this;e(function(e){var t,r,n,o,i,a=["Ivldlcneky mi sslsgaeiycmi o edhl.","nai ies e.Ealu.ae@rpct.o fyune ep"];if(e.hl)if(e.isVd(!1)){if(-1!==e.m)return l.apply(c),void(c.onCompleted&&c.onCompleted());a=e.d?(t="l2",["Pwrdb rpCt pedSet.\rYu eprr elyetkyeprsi 0 as","oee yGaeiySra.hes \nortmoaydpomn e xie n{}dy."]):(t="l6",["Pwrdb rpCt pedSet vlainVrin\no iesdfrDsrbto.","oee yGaeiySra.hesEauto eso\rNtLcne o itiuin"])}else(!e.adr||!e.adr.dsr)&&e.e?(t="l5",a=["Pwrdb rpCt pedSet.\rYu eprr elyetkyhseprd\rEalu.ae@rpct.o o ep","oee yGaeiySra.hes \nortmoaydpomn e a xie.\nmi sslsgaeiycmfrhl."]):t="l4";else a=e.b?(t="l1",["Pwrdb rpCt pedSet.\no a nydpo hsEAUTO eso oal.\rTmoaydpomn esaeaalbefrtsig \nmi sslsgaeiycm","oee yGaeiySra.hes\rYucnol elyti VLAINvrinlcly \neprr elyetky r vial o etn.\rEalu.ae@rpct.o."]):(t="l3",["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\rI o ucae  ies,yu e si orprhs ofraineal \nmi sslsgaeiycmi o edassac.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain \nfyuprhsdalcne orkyi nyu ucaecnimto mi.\rEalu.ae@rpct.o fyune sitne"]);if(r=function(e,t,r){var n,o={name:p(["Eauto eso","vlainVrin"]),index:0,allowCellOverflow:!0,defaults:{colHeaderRowHeight:20,rowHeaderColWidth:40,rowHeight:30,colWidth:60},rowCount:20,columnCount:20,data:{dataTable:{}}},i=h(e,t,r),a=o.data.dataTable;for(n=1;n<i.length+1;n++)a[n]={},a[n][1]={value:i[n-1]};return o}(t,a,e),!e.hl&&e.b||e.isVd(!1)){if(u&&l.apply(c),o=(n=s.sheets)[r.name])r.index=o.index;else{for(i in n)n.hasOwnProperty(i)&&n[i].index++;s.sheetCount++,s.activeSheetIndex=s.activeSheetIndex?++s.activeSheetIndex:1}n[r.name]=r,u||l.apply(c)}else s.sheetCount=1,s.sheets={},s.sheets[r.name]=r,u||l.apply(c);c.onCompleted&&c.onCompleted()})}e=function(t){var r,n=g(p(["Lcnee","iesKy"]));return l(n,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B0"},function(e){(r=b(e,"VIEE")).hl=!!n,y(r,n),t(r)},function(){(r=b()).hl=!!n,y(r,n),t(r)}),r},h=function(e,t,r){var n,o,i,a=C(p([e,"s"])),s=g(p(["Wrbo","okok"])),l=C(s&&1===s.lm?p(["ld","se"]):p(["lr","su"])),u=w(a,t);for(l=w(l,t),u=(u=u.replace("{0}",r.d)).replace("{1}",l).replace("{1}",l),n=[],i=o=0;i<u.length;i++)"\r"!==u[i]&&"\n"!==u[i]||(n.push(u.substring(o,i)),"\r"===u[i]&&i<u.length-1&&"\n"===u[i+1]&&i++,o=i+1);return o<u.length&&n.push(u.substring(o,u.length)),n},t=function(){var r,n=o.prototype.Lj;o.prototype.Lj=function(){var e=arguments,t=this;v.call(t,t.Mj.we,function(){n.apply(t,e)},!0)},o.prototype.nh=function(){},r=a.prototype.fh,a.prototype.fh=function(){var e=arguments,t=this;v.call(t,t.we,function(){r.apply(t,e)},!1)},a.prototype.nh=function(){}},r.Cj=t,S.exports=r}()},"./src/lc/lcValidator.js":function(e,t){var r,n,o=(n={},i.m=r=[function(e,s){(function(e){"use strict";var n,m,b,y,f,t,r,C;function o(e,t,r,n){return 1==e.length||e.splice(r,1,n(e.splice(t,1,n(e[r]))[0])),e}function i(e){function t(e){return function(e,t){var r=1<arguments.length&&void 0!==t?t:1,n=e.charCodeAt(0);return 65<=n&&n<=90?e.toLowerCase():97<=n&&n<=122?e.toUpperCase():48<=n&&n<=57?b(48+(n-48+10+r)%10):e}(e,-1)}var r,n=e.split("");for(r=n.length-5;0<=r;r--)o(n,r+1,r+3,t),o(n,r,r+2,t);return n.join("")}function a(e){return(m&&window.atob||function(e){var t,r,n,o,i,a,s,l=[],u=f,c=e;for(s=0;s<c.length;s+=4)t=(a=u.indexOf(c.charAt(s))<<18|u.indexOf(c.charAt(s+1))<<12|(o=u.indexOf(c.charAt(s+2)))<<6|(i=u.indexOf(c.charAt(s+3))))>>>16&255,r=a>>>8&255,n=255&a,l[s/4]=b(t,r,n),64==i&&(l[s/4]=b(t,r)),64==o&&(l[s/4]=b(t));return l.join("")})(e)}function w(e){return(m&&window.btoa||function(e){var t,r,n,o,i,a,s=[],l="",u=f,c=e,h=c.length%3;if(0<h)for(;h++<3;)l+="=",c+="\0";for(h=0;h<c.length;h+=3)r=(t=c.charCodeAt(h)<<16|c.charCodeAt(h+1)<<8|c.charCodeAt(h+2))>>18&63,n=t>>12&63,o=t>>6&63,i=63&t,s[h/3]=u.charAt(r)+u.charAt(n)+u.charAt(o)+u.charAt(i);return(a=s.join("")).slice(0,a.length-l.length)+l})(e)}function v(e){var t,r,n;return e?(t=i(e),t=t.split("").reverse().join(""),r=Math.ceil(t.length/2),t=(t=(t=t.substr(r)+t.substr(0,r)).replace("#","=")).replace("&","=="),n=t,decodeURIComponent(Array.prototype.map.call(a(n),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))):""}function S(e){var t,r=a(e),n=r.length,o=new y(n);for(t=0;t<n;t++)o[t]=r.charCodeAt(t);return o.buffer}function x(e){var t,r,n=new ArrayBuffer(e.length),o=new y(n);for(t=0,r=e.length;t<r;t++)o[t]=e.charCodeAt(t);return n}function T(r){return"oncomplete"in r&&(r.then=function(e,t){r.resolve=e,r.reject=t},r.oncomplete=function(e){r.resolve(r.result)},r.onerror=function(){r.reject()}),r}Object.defineProperty(s,"__esModule",{value:!0}),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m="undefined"!=typeof window,b=String.fromCharCode,y=m&&window.Uint8Array||function(e){var t,r;if("number"==typeof e)for(t=Array(e),r=0;r<e;++r)t[r]=0;else t=e.slice(0);return(t.buffer=t).byteLength=t.length,"object"===(void 0===e?"undefined":n(e))&&e.buffer&&(t.buffer=e.buffer),t},f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="object"==(void 0===e?"undefined":n(e))&&e&&e.Object===Object&&e,r="object"==("undefined"==typeof self?"undefined":n(self))&&self&&self.Object===Object&&self,C=t||r||Function("return this")(),s.iDe=v,s.attorn=function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d=m?window.msCrypto?window.msCrypto:window.crypto:void 0,p=function(e,t){try{t="#"+t;var r=e.indexOf(t);if(-1<r)return{prefix:e.substring(0,r),licData:JSON.parse(v(e.substr(r+t.length)))}}catch(e){}return!1}(e,t.aC);if(!p)return n();function g(){return function(e){var t,r,n,o=0,i=5381,a=0;for(t=e.length-1;0<=t;t--)o=(r=e.charCodeAt(t))+(o<<6)+(o<<16)-o,i=r+((i<<5)+i),a=r+((a<<5)-a),a&=a;return(n=o^i^a)<0&&(n=~n),n.toString(16).toUpperCase()}(i+JSON.stringify(o.D))===o.H?r(o.D):n()}return o=p.licData,i=p.prefix+"#"+t.aC,h=S((f=i+JSON.stringify(o.D),w(encodeURIComponent(f).replace(/%([0-9A-F]{2})/g,function(e,t){return b(parseInt(t,16))})))),a=b.apply(null,new y(h)),s=v("JYx3Gb#8Pb5R"),l=v("VdgJHc#wJb59"),(!C[s]||!C[s][l]||location.protocol.match(/^https/i))&&d&&d.subtle?(u={alg:"RS256",e:"AQAB",kty:"RSA",n:t.pK.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")},u=window.msCrypto?x(JSON.stringify(u)):u,c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},void T(d.subtle.importKey("jwk",u,c,!1,["verify"])).then(function(e){T(d.subtle.verify(c,e,S(o.S),x(a))).then(function(e){return e?r(o.D):n()})},function(){return g()})):g()}}).call(s,function(){return this}())}],i.c=n,i.p="dist",i(0));function i(e){if(n[e])return n[e].exports;var t=n[e]={exports:{},id:e,loaded:!1};return r[e].call(t.exports,t,t.exports,i),t.loaded=!0,t.exports}e.exports={Jj:o.attorn,Kj:o.iDe}},"./src/lc/releaseLc.js":function(e,t,r){var n=r("./src/lc/common.js");e.exports={Bj:1,Cj:n.Cj,Aj:n.Aj}},"./src/lib/jszip.min.js":function(e,t,r){e.exports=function o(i,a,s){function l(r,e){var t,n;if(!a[r]){if(!i[r]){if(u)return u(r,!0);throw(t=Error("Cannot find module '"+r+"'")).code="MODULE_NOT_FOUND",t}n=a[r]={exports:{}},i[r][0].call(n.exports,function(e){var t=i[r][1][e];return l(t||e)},n,n.exports,o,i,a,s)}return a[r].exports}for(var u=!1,e=0;e<s.length;e++)l(s[e]);return l}({1:[function(e,t,r){"use strict";var d=e("./utils"),h=e("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,n,o,i,a,s,l=[],u=0,c=e.length,h=c,f="string"!==d.getTypeOf(e);u<e.length;)h=c-u,n=f?(t=e[u++],r=u<c?e[u++]:0,u<c?e[u++]:0):(t=e.charCodeAt(u++),r=u<c?e.charCodeAt(u++):0,u<c?e.charCodeAt(u++):0),o=t>>2,i=(3&t)<<4|r>>4,a=1<h?(15&r)<<2|n>>6:64,s=2<h?63&n:64,l.push(p.charAt(o)+p.charAt(i)+p.charAt(a)+p.charAt(s));return l.join("")},r.decode=function(e){var t,r,n,o,i,a,s,l,u=0,c=0;if("data:"===e.substr(0,"data:".length))throw Error("Invalid base64 input, it looks like a data url.");if(l=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4,e.charAt(e.length-1)===p.charAt(64)&&l--,e.charAt(e.length-2)===p.charAt(64)&&l--,l%1!=0)throw Error("Invalid base64 input, bad content length.");for(s=h.uint8array?new Uint8Array(0|l):Array(0|l);u<e.length;)t=p.indexOf(e.charAt(u++))<<2|(o=p.indexOf(e.charAt(u++)))>>4,r=(15&o)<<4|(i=p.indexOf(e.charAt(u++)))>>2,n=(3&i)<<6|(a=p.indexOf(e.charAt(u++))),s[c++]=t,64!==i&&(s[c++]=r),64!==a&&(s[c++]=n);return s}},{"./support":30,"./utils":32}],2:[function(e,t,r){"use strict";var n=e("./external"),o=e("./stream/DataWorker"),i=e("./stream/DataLengthProbe"),a=e("./stream/Crc32Probe");function s(e,t,r,n,o){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=o}i=e("./stream/DataLengthProbe"),s.prototype={getContentWorker:function(){var e=new o(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new i("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new o(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,r){return e.pipe(new a).pipe(new i("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new i("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){"use strict";var n=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(e){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){"use strict";var n=e("./utils"),a=function(){var e,t,r,n;for(t=[],r=0;r<256;r++){for(e=r,n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?("string"!==n.getTypeOf(e)?function(e,t,r){var n,o=a,i=0+r;for(e^=-1,n=0;n<i;n++)e=e>>>8^o[255&(e^t[n])];return-1^e}:function(e,t,r){var n,o=a,i=0+r;for(e^=-1,n=0;n<i;n++)e=e>>>8^o[255&(e^t.charCodeAt(n))];return-1^e})(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){"use strict";var n=null;n="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,o=e("pako"),i=e("./utils"),a=e("./stream/GenericWorker"),s=n?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this.Nj=null,this.Oj=e,this.Pj=t,this.meta={}}r.magic="\b\0",i.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this.Nj&&this.Qj(),this.Nj.push(i.transformTo(s,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this.Nj&&this.Qj(),this.Nj.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.Nj=null},l.prototype.Qj=function(){this.Nj=new o[this.Oj]({raw:!0,level:this.Pj.level||-1});var t=this;this.Nj.onData=function(e){t.push({data:e,meta:t.meta})}},r.compressWorker=function(e){return new l("Deflate",e)},r.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){"use strict";function I(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function n(e,t,r,n,o,i){var a,s,l,u,c,h,f=e.file,d=e.compression,p=i!==R.utf8encode,g=E.transformTo("string",i(f.name)),m=E.transformTo("string",R.utf8encode(f.name)),b=f.comment,y=E.transformTo("string",i(b)),C=E.transformTo("string",R.utf8encode(b)),w=m.length!==f.name.length,v=C.length!==b.length,S="",x="",T="",A=f.dir,k=f.date,M={crc32:0,compressedSize:0,uncompressedSize:0};return t&&!r||(M.crc32=e.crc32,M.compressedSize=e.compressedSize,M.uncompressedSize=e.uncompressedSize),l=0,t&&(l|=8),p||!w&&!v||(l|=2048),c=u=0,A&&(u|=16),"UNIX"===o?(c=798,u|=function(e,t){var r=e;return e||(r=t?16893:33204),(65535&r)<<16}(f.unixPermissions,A)):(c=20,u|=function(e){return 63&(e||0)}(f.dosPermissions)),a=k.getUTCHours(),a<<=6,a|=k.getUTCMinutes(),a<<=5,a|=k.getUTCSeconds()/2,s=k.getUTCFullYear()-1980,s<<=4,s|=k.getUTCMonth()+1,s<<=5,s|=k.getUTCDate(),w&&(x=I(1,1)+I(D(g),4)+m,S+="up"+I(x.length,2)+x),v&&(T=I(1,1)+I(D(y),4)+C,S+="uc"+I(T.length,2)+T),h="",h+="\n\0",h+=I(l,2),h+=d.magic,h+=I(a,2),h+=I(s,2),h+=I(M.crc32,4),h+=I(M.compressedSize,4),h+=I(M.uncompressedSize,4),h+=I(g.length,2),h+=I(S.length,2),{fileRecord:N.LOCAL_FILE_HEADER+h+g+S,dirRecord:N.CENTRAL_FILE_HEADER+I(c,2)+h+I(y.length,2)+"\0\0\0\0"+I(u,4)+I(n,4)+g+S+y}}var E=e("../utils"),o=e("../stream/GenericWorker"),R=e("../utf8"),D=e("../crc32"),N=e("../signature");function i(e,t,r,n){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this.Rj=[]}E.inherits(i,o),i.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this.Rj.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},i.prototype.openedSource=function(e){var t,r;this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name,(t=this.streamFiles&&!e.file.dir)?(r=n(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName),this.push({data:r.fileRecord,meta:{percent:0}})):this.accumulate=!0},i.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=n(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:function(e){return N.DATA_DESCRIPTOR+I(e.crc32,4)+I(e.compressedSize,4)+I(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},i.prototype.flush=function(){var e,t,r,n;for(e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});r=this.bytesWritten-e,n=function(e,t,r,n,o){var i=E.transformTo("string",o(n));return N.CENTRAL_DIRECTORY_END+"\0\0\0\0"+I(e,2)+I(e,2)+I(t,4)+I(r,4)+I(i.length,2)+i}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName),this.push({data:n,meta:{percent:100}})},i.prototype.prepareNextSource=function(){this.previous=this.Rj.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},i.prototype.registerPrevious=function(e){this.Rj.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t.Rj.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},i.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this.Rj.length?(this.prepareNextSource(),!0):this.previous||this.Rj.length||this.generatedError?void 0:(this.end(),!0))},i.prototype.error=function(e){var t,r=this.Rj;if(!o.prototype.error.call(this,e))return!1;for(t=0;t<r.length;t++)try{r[t].error(e)}catch(e){}return!0},i.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this.Rj,t=0;t<e.length;t++)e[t].lock()},t.exports=i},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){"use strict";var u=e("../compressions"),n=e("./ZipFileWorker");r.generateWorker=function(e,a,t){var s=new n(a.streamFiles,t,a.platform,a.encodeFileName),l=0;try{e.forEach(function(e,t){l++;var r=function(e,t){var r=e||t,n=u[r];if(!n)throw Error(r+" is not a valid compression method !");return n}(t.options.compression,a.compression),n=t.options.compressionOptions||a.compressionOptions||{},o=t.dir,i=t.date;t.Sj(r,n).withStreamInfo("file",{name:e,dir:o,date:i,comment:t.comment||"",unixPermissions:t.unixPermissions,dosPermissions:t.dosPermissions}).pipe(s)}),s.entriesCount=l}catch(e){s.error(e)}return s}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){"use strict";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e,t=new n;for(e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.2.0",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){"use strict";var n=e("./utils"),o=e("./external"),s=e("./utf8"),l=(n=e("./utils"),e("./zipEntries")),i=e("./stream/Crc32Probe"),u=e("./nodejsUtils");function c(n){return new o.Promise(function(e,t){var r=n.decompressed.getContentWorker().pipe(new i);r.on("error",function(e){t(e)}).on("end",function(){r.streamInfo.crc32!==n.decompressed.crc32?t(Error("Corrupted zip : CRC32 mismatch")):e()}).resume()})}t.exports=function(e,i){var a=this;return i=n.extend(i||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),u.isNode&&u.isStream(e)?o.Promise.reject(Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,i.optimizedBinaryString,i.base64).then(function(e){var t=new l(i);return t.load(e),t}).then(function(e){var t,r=[o.Promise.resolve(e)],n=e.files;if(i.checkCRC32)for(t=0;t<n.length;t++)r.push(c(n[t]));return o.Promise.all(r)}).then(function(e){var t,r,n,o;for(t=e.shift(),r=t.files,n=0;n<r.length;n++)o=r[n],a.file(o.fileNameStr,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:i.createFolders});return t.zipComment.length&&(a.comment=t.zipComment),a})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){"use strict";var n=e("../utils"),o=e("../stream/GenericWorker");function i(e,t){o.call(this,"Nodejs stream input adapter for "+e),this.Tj=!1,this.Uj(t)}n.inherits(i,o),i.prototype.Uj=function(e){var t=this;(this.Vj=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t.Tj=!0:t.end()})},i.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this.Vj.pause(),!0)},i.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this.Tj?this.end():this.Vj.resume(),!0)},t.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){"use strict";var o=e("readable-stream").Readable;function n(e,t,r){o.call(this,t),this.Wj=e;var n=this;e.on("data",function(e,t){n.push(e)||n.Wj.pause(),r&&r(t)}).on("error",function(e){n.emit("error",e)}).on("end",function(){n.push(null)})}e("../utils").inherits(n,o),n.prototype.Xj=function(){this.Wj.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){"use strict";t.exports={isNode:void 0!==h,newBufferFrom:function(e,t){if(h.from&&h.from!==Uint8Array.from)return h.from(e,t);if("number"==typeof e)throw Error('The "data" argument must not be a number');return new h(e,t)},allocBuffer:function(e){if(h.alloc)return h.alloc(e);var t=new h(e);return t.fill(0),t},isBuffer:function(e){return h.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,r){"use strict";var o,u,c,i,h,f,d,a,p,g,m,b,y,n;function s(e,t,r){var n,o,i,a,s=u.getTypeOf(t),l=u.extend(r||{},h);l.date=l.date||new Date,null!==l.compression&&(l.compression=l.compression.toUpperCase()),"string"==typeof l.unixPermissions&&(l.unixPermissions=parseInt(l.unixPermissions,8)),l.unixPermissions&&16384&l.unixPermissions&&(l.dir=!0),l.dosPermissions&&16&l.dosPermissions&&(l.dir=!0),l.dir&&(e=b(e)),l.createFolders&&(n=m(e))&&y.call(this,n,!0),o="string"===s&&!1===l.binary&&!1===l.base64,r&&void 0!==r.binary||(l.binary=!o),(t instanceof f&&0===t.uncompressedSize||l.dir||!t||0===t.length)&&(l.base64=!1,l.binary=!0,t="",l.compression="STORE",s="string"),i=null,i=t instanceof f||t instanceof c?t:p.isNode&&p.isStream(t)?new g(e,t):u.prepareContent(e,t,l.binary,l.optimizedBinaryString,l.base64),a=new d(e,i,l),this.files[e]=a}function l(e){return"[object RegExp]"===Object.prototype.toString.call(e)}o=e("./utf8"),u=e("./utils"),c=e("./stream/GenericWorker"),i=e("./stream/StreamHelper"),h=e("./defaults"),f=e("./compressedObject"),d=e("./zipObject"),a=e("./generate"),p=e("./nodejsUtils"),g=e("./nodejs/NodejsStreamInputAdapter"),m=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},b=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},y=function(e,t){return t=void 0!==t?t:h.createFolders,e=b(e),this.files[e]||s.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]},n={load:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)this.files.hasOwnProperty(t)&&(n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n))},filter:function(r){var n=[];return this.forEach(function(e,t){r(e,t)&&n.push(t)}),n},file:function(e,t,r){var n,o;return 1!==arguments.length?(e=this.root+e,s.call(this,e,t,r),this):l(e)?(n=e,this.filter(function(e,t){return!t.dir&&n.test(e)})):(o=this.files[this.root+e])&&!o.dir?o:null},folder:function(r){if(!r)return this;if(l(r))return this.filter(function(e,t){return t.dir&&r.test(e)});var e=this.root+r,t=y.call(this,e),n=this.clone();return n.root=t.name,n},remove:function(r){var e,t,n;if(r=this.root+r,(e=this.files[r])||("/"!==r.slice(-1)&&(r+="/"),e=this.files[r]),e&&!e.dir)delete this.files[r];else for(t=this.filter(function(e,t){return t.name.slice(0,r.length)===r}),n=0;n<t.length;n++)delete this.files[t[n].name];return this},generate:function(e){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r,n={};try{if((n=u.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw Error("No output type specified.");u.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS"),r=n.comment||this.comment||"",t=a.generateWorker(this,n,r)}catch(e){(t=new c("error")).error(e)}return new i(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}},t.exports=n},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){"use strict";var n=e("./DataReader");function o(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(o,n),o.prototype.byteAt=function(e){return this.data[this.zero+e]},o.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),o=e.charCodeAt(3),i=this.length-4;0<=i;--i)if(this.data[i]===t&&this.data[i+1]===r&&this.data[i+2]===n&&this.data[i+3]===o)return i-this.zero;return-1},o.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),o=e.charCodeAt(3),i=this.readData(4);return t===i[0]&&r===i[1]&&n===i[2]&&o===i[3]},o.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){"use strict";var n=e("../utils");function o(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=o},{"../utils":32}],19:[function(e,t,r){"use strict";var n=e("./Uint8ArrayReader");function o(e){n.call(this,e)}e("../utils").inherits(o,n),o.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){"use strict";var n=e("./DataReader");function o(e){n.call(this,e)}e("../utils").inherits(o,n),o.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},o.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},o.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},o.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){"use strict";var n=e("./ArrayReader");function o(e){n.call(this,e)}e("../utils").inherits(o,n),o.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){"use strict";var n=e("../utils"),o=e("../support"),i=e("./ArrayReader"),a=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||o.uint8array?"nodebuffer"===t?new s(e):o.uint8array?new l(n.transformTo("uint8array",e)):new i(n.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,r){"use strict";var n=e("./GenericWorker"),o=e("../utils");function i(e){n.call(this,"ConvertWorker to "+e),this.destType=e}o.inherits(i,n),i.prototype.processChunk=function(e){this.push({data:o.transformTo(this.destType,e.data),meta:e.meta})},t.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){"use strict";var n=e("./GenericWorker"),o=e("../crc32");function i(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(i,n),i.prototype.processChunk=function(e){this.streamInfo.crc32=o(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){"use strict";var n=e("../utils"),o=e("./GenericWorker");function i(e){o.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(i,o),i.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}o.prototype.processChunk.call(this,e)},t.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){"use strict";var n=e("../utils"),o=e("./GenericWorker");function i(e){o.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this.Yj=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t.Zj()},function(e){t.error(e)})}n.inherits(i,o),i.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.Yj&&this.dataIsReady&&(this.Yj=!0,n.delay(this.Zj,[],this)),!0)},i.prototype.Zj=function(){this.Yj=!1,this.isPaused||this.isFinished||(this.$j(),this.isFinished||(n.delay(this.Zj,[],this),this.Yj=!0))},i.prototype.$j=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){"use strict";function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._j={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._j[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._j=[]},emit:function(e,t){if(this._j[e])for(var r=0;r<this._j[e].length;r++)this._j[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=n},{}],29:[function(e,t,r){"use strict";var l=e("../utils"),o=e("./ConvertWorker"),i=e("./GenericWorker"),u=e("../base64"),n=e("../support"),a=e("../external"),s=null;if(n.nodestream)try{s=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function c(e,t,r){var n=t;switch(t){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string"}try{this.ak=n,this.ck=t,this.dk=r,l.checkSupport(n),this.ek=e.pipe(new o(n)),e.lock()}catch(e){this.ek=new i("error"),this.ek.error(e)}}c.prototype={accumulate:function(e){return function(e,s){return new a.Promise(function(t,r){var n=[],o=e.ak,i=e.ck,a=e.dk;e.on("data",function(e,t){n.push(e),s&&s(t)}).on("error",function(e){n=[],r(e)}).on("end",function(){try{var e=function(e,t,r){switch(e){case"blob":return l.newBlob(l.transformTo("arraybuffer",t),r);case"base64":return u.encode(t);default:return l.transformTo(e,t)}}(i,function(e,t){var r,n=0,o=null,i=0;for(r=0;r<t.length;r++)i+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(o=new Uint8Array(i),r=0;r<t.length;r++)o.set(t[r],n),n+=t[r].length;return o;case"nodebuffer":return h.concat(t);default:throw Error("concat : unsupported type '"+e+"'")}}(o,n),a);t(e)}catch(e){r(e)}n=[]}).resume()})}(this,e)},on:function(e,t){var r=this;return"data"===e?this.ek.on(e,function(e){t.call(r,e.data,e.meta)}):this.ek.on(e,function(){l.delay(t,arguments,r)}),this},resume:function(){return l.delay(this.ek.resume,[],this.ek),this},pause:function(){return this.ek.pause(),this},toNodejsStream:function(e){if(l.checkSupport("nodestream"),"nodebuffer"!==this.ck)throw Error(this.ck+" is not supported by this method");return new s(this,{objectMode:"nodebuffer"!==this.ck},e)}},t.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){"use strict";var n,o;if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer=void 0!==h,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:"application/zip"}).size}catch(e){try{(o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder)).append(n),r.blob=0===o.getBlob("application/zip").size}catch(e){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(e){r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,i){"use strict";for(var s=e("./utils"),l=e("./support"),r=e("./nodejsUtils"),n=e("./stream/GenericWorker"),u=Array(256),o=0;o<256;o++)u[o]=252<=o?6:248<=o?5:240<=o?4:224<=o?3:192<=o?2:1;function a(){n.call(this,"utf-8 decode"),this.leftOver=null}function c(){n.call(this,"utf-8 encode")}u[254]=u[254]=1,i.utf8encode=function(e){return l.nodebuffer?r.newBufferFrom(e,"utf-8"):function(e){var t,r,n,o,i,a=e.length,s=0;for(o=0;o<a;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=l.uint8array?new Uint8Array(s):Array(s),o=i=0;i<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),r<128?t[i++]=r:(r<2048?t[i++]=192|r>>>6:(r<65536?t[i++]=224|r>>>12:(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63),t[i++]=128|r>>>6&63),t[i++]=128|63&r);return t}(e)},i.utf8decode=function(e){return l.nodebuffer?s.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,n,o,i=e.length,a=Array(2*i);for(t=r=0;t<i;)if((n=e[t++])<128)a[r++]=n;else if(4<(o=u[n]))a[r++]=65533,t+=o-1;else{for(n&=2===o?31:3===o?15:7;1<o&&t<i;)n=n<<6|63&e[t++],o--;1<o?a[r++]=65533:n<65536?a[r++]=n:(n-=65536,a[r++]=55296|n>>10&1023,a[r++]=56320|1023&n)}return a.length!==r&&(a.subarray?a=a.subarray(0,r):a.length=r),s.applyFromCharCode(a)}(e=s.transformTo(l.uint8array?"uint8array":"array",e))},s.inherits(a,n),a.prototype.processChunk=function(e){var t,r,n,o=s.transformTo(l.uint8array?"uint8array":"array",e.data);this.leftOver&&this.leftOver.length&&(l.uint8array?(t=o,(o=new Uint8Array(t.length+this.leftOver.length)).set(this.leftOver,0),o.set(t,this.leftOver.length)):o=this.leftOver.concat(o),this.leftOver=null),(r=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return!(r<0)&&0!==r&&r+u[e[r]]>t?r:t}(o))!==(n=o).length&&(l.uint8array?(n=o.subarray(0,r),this.leftOver=o.subarray(r,o.length)):(n=o.slice(0,r),this.leftOver=o.slice(r,o.length))),this.push({data:i.utf8decode(n),meta:e.meta})},a.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=a,s.inherits(c,n),c.prototype.processChunk=function(e){this.push({data:i.utf8encode(e.data),meta:e.meta})},i.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,a){"use strict";var o,n,s=e("./support"),l=e("./base64"),r=e("./nodejsUtils"),i=e("set-immediate-shim"),u=e("./external");function c(e){return e}function h(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}function f(e){var t=65536,r=a.getTypeOf(e),n=!0;if("uint8array"===r?n=o.applyCanBeUsed.uint8array:"nodebuffer"===r&&(n=o.applyCanBeUsed.nodebuffer),n)for(;1<t;)try{return o.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return o.stringifyByChar(e)}function d(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}a.newBlob=function(t,r){a.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(r)}catch(t){throw Error("Bug : can't construct the Blob.")}}},o={stringifyByChunk:function(e,t,r){var n=[],o=0,i=e.length;if(i<=r)return String.fromCharCode.apply(null,e);for(;o<i;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(o,Math.min(o+r,i)))):n.push(String.fromCharCode.apply(null,e.subarray(o,Math.min(o+r,i)))),o+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&1===String.fromCharCode.apply(null,r.allocBuffer(1)).length}catch(e){return!1}}()}},a.applyFromCharCode=f,(n={}).string={string:c,array:function(e){return h(e,Array(e.length))},arraybuffer:function(e){return n.string.uint8array(e).buffer},uint8array:function(e){return h(e,new Uint8Array(e.length))},nodebuffer:function(e){return h(e,r.allocBuffer(e.length))}},n.array={string:f,array:c,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(e)}},n.arraybuffer={string:function(e){return f(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),Array(e.byteLength))},arraybuffer:c,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(new Uint8Array(e))}},n.uint8array={string:f,array:function(e){return d(e,Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:c,nodebuffer:function(e){return r.newBufferFrom(e)}},n.nodebuffer={string:f,array:function(e){return d(e,Array(e.length))},arraybuffer:function(e){return n.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:c},a.transformTo=function(e,t){if(t=t||"",!e)return t;a.checkSupport(e);var r=a.getTypeOf(t);return n[r][e](t)},a.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":s.nodebuffer&&r.isBuffer(e)?"nodebuffer":s.uint8array&&e instanceof Uint8Array?"uint8array":s.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(e){if(!s[e.toLowerCase()])throw Error(e+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},a.delay=function(e,t,r){i(function(){e.apply(r||null,t||[])})},a.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},a.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},a.prepareContent=function(r,e,n,o,i){return u.Promise.resolve(e).then(function(n){return s.blob&&(n instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(n)))&&"undefined"!=typeof FileReader?new u.Promise(function(t,r){var e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=function(e){r(e.target.error)},e.readAsArrayBuffer(n)}):n}).then(function(e){var t=a.getTypeOf(e);return t?("arraybuffer"===t?e=a.transformTo("uint8array",e):"string"===t&&(i?e=l.decode(e):n&&!0!==o&&(e=function(e){return h(e,s.uint8array?new Uint8Array(e.length):Array(e.length))}(e))),e):u.Promise.reject(Error("Can't read the data of '"+r+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),o=e("./utils"),i=e("./signature"),a=e("./zipEntry"),s=(e("./utf8"),e("./support"));function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw Error("Corrupted zip or bug: unexpected signature ("+o.pretty(t)+", expected "+o.pretty(e)+")")}},isSignature:function(e,t){var r,n=this.reader.index;return this.reader.setIndex(e),r=this.reader.readString(4)===t,this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",r=o.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(i.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(i.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e,t,r,n=this.reader.lastIndexOfSignature(i.CENTRAL_DIRECTORY_END);if(n<0)throw this.isSignature(0,i.LOCAL_FILE_HEADER)?Error("Corrupted zip: can't find end of central directory"):Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");if(this.reader.setIndex(n),e=n,this.checkSignature(i.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(n=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(n),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,i.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}if(t=this.centralDirOffset+this.centralDirSize,this.zip64&&(t+=20,t+=12+this.zip64EndOfCentralSize),0<(r=e-t))this.isSignature(e,i.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),i=e("./utils"),o=e("./compressedObject"),a=e("./crc32"),s=e("./utf8"),l=e("./compressions"),u=e("./support");function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(l.hasOwnProperty(t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,r,n,o=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index<o;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n}},handleUTF8:function(){var e,t,r,n,o=u.uint8array?"uint8array":"array";this.useUTF8()?(this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment)):(null!==(e=this.findExtraFieldUnicodePath())?this.fileNameStr=e:(t=i.transformTo(o,this.fileName),this.fileNameStr=this.loadOptions.decodeFileName(t)),null!==(r=this.findExtraFieldUnicodeComment())?this.fileCommentStr=r:(n=i.transformTo(o,this.fileComment),this.fileCommentStr=this.loadOptions.decodeFileName(n)))},findExtraFieldUnicodePath:function(){var e,t=this.extraFields[28789];return t?1!==(e=n(t.value)).readInt(1)||a(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readData(t.length-5)):null},findExtraFieldUnicodeComment:function(){var e,t=this.extraFields[25461];return t?1!==(e=n(t.value)).readInt(1)||a(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readData(t.length-5)):null}},t.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){"use strict";var i,n,a,o,s,l,u,c;function h(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this.fk=t,this.gk=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}for(i=e("./stream/StreamHelper"),n=e("./stream/DataWorker"),a=e("./utf8"),o=e("./compressedObject"),s=e("./stream/GenericWorker"),h.prototype={internalStream:function(e){var t,r,n=null,o="string";try{if(!e)throw Error("No output type specified.");t="string"===(o=e.toLowerCase())||"text"===o,"binarystring"!==o&&"text"!==o||(o="string"),n=this.hk(),(r=!this.gk)&&!t&&(n=n.pipe(new a.Utf8EncodeWorker)),!r&&t&&(n=n.pipe(new a.Utf8DecodeWorker))}catch(e){(n=new s("error")).error(e)}return new i(n,o,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},Sj:function(e,t){if(this.fk instanceof o&&this.fk.compression.magic===e.magic)return this.fk.getCompressedWorker();var r=this.hk();return this.gk||(r=r.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(r,e,t)},hk:function(){return this.fk instanceof o?this.fk.getContentWorker():this.fk instanceof s?this.fk:new n(this.fk)}},l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<l.length;c++)h.prototype[l[c]]=u;t.exports=h},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,c,t){(function(t){"use strict";var r,n,e,o,i,a,s,l=t.MutationObserver||t.WebKitMutationObserver;function u(){var e,t,r;for(n=!0,r=s.length;r;){for(t=s,s=[],e=-1;++e<r;)t[e]();r=s.length}n=!1}r=l?(e=0,o=new l(u),i=t.document.createTextNode(""),o.observe(i,{characterData:!0}),function(){i.data=e=++e%2}):t.setImmediate||void 0===t.MessageChannel?"document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)}:((a=new t.MessageChannel).port1.onmessage=u,function(){a.port2.postMessage(0)}),s=[],c.exports=function(e){1!==s.push(e)||n||r()}}).call(this,void 0!==G?G:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,r){"use strict";var u,o,a,n,i=e("immediate");function c(){}function s(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=n,this.queue=[],this.outcome=void 0,e!==c&&d(this,e)}function l(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function h(t,r,n){i(function(){var e;try{e=r(n)}catch(e){return u.reject(t,e)}e===t?u.reject(t,new TypeError("Cannot resolve promise with itself")):u.resolve(t,e)})}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function d(t,e){var r,n=!1;function o(e){n||(n=!0,u.reject(t,e))}function i(e){n||(n=!0,u.resolve(t,e))}"error"===(r=p(function(){e(i,o)})).status&&o(r.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}u={},o=["REJECTED"],a=["FULFILLED"],n=["PENDING"],(t.exports=s).prototype.finally=function(t){if("function"!=typeof t)return this;var r=this.constructor;return this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})})},s.prototype.catch=function(e){return this.then(null,e)},s.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var r=new this.constructor(c);return this.state!==n?h(r,this.state===a?e:t,this.outcome):this.queue.push(new l(r,e,t)),r},l.prototype.callFulfilled=function(e){u.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){u.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},u.resolve=function(e,t){var r,n,o,i=p(f,t);if("error"===i.status)return u.reject(e,i.value);if(r=i.value)d(e,r);else for(e.state=a,e.outcome=t,n=-1,o=e.queue.length;++n<o;)e.queue[n].callFulfilled(t);return e},u.reject=function(e,t){e.state=o,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},s.resolve=function(e){return e instanceof this?e:u.resolve(new this(c),e)},s.reject=function(e){var t=new this(c);return u.reject(t,e)},s.all=function(e){var r,n,o,i,t,a,s=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));if(r=e.length,n=!1,!r)return this.resolve([]);for(o=Array(r),i=0,t=-1,a=new this(c);++t<r;)l(e[t],t);return a;function l(e,t){s.resolve(e).then(function(e){o[t]=e,++i!==r||n||(n=!0,u.resolve(a,o))},function(e){n||(n=!0,u.reject(a,e))})}},s.race=function(e){var t,r,n,o,i;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));if(t=e.length,r=!1,!t)return this.resolve([]);for(n=-1,o=new this(c);++n<t;)i=e[n],this.resolve(i).then(function(e){r||(r=!0,u.resolve(o,e))},function(e){r||(r=!0,u.reject(o,e))});return o}},{immediate:36}],38:[function(e,t,r){"use strict";var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){"use strict";var a=e("./zlib/deflate"),s=e("./utils/common"),l=e("./utils/strings"),o=e("./zlib/messages"),i=e("./zlib/zstream"),u=Object.prototype.toString,c=0,h=-1,f=0,d=8;function p(e){var t,r,n;if(!(this instanceof p))return new p(e);if(this.options=s.assign({level:h,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},e||{}),(t=this.options).raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0,(r=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy))!==c)throw Error(o[r]);if(t.header&&a.deflateSetHeader(this.strm,t.header),t.dictionary){if(n="string"==typeof t.dictionary?l.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=a.deflateSetDictionary(this.strm,n))!==c)throw Error(o[r]);this.ik=!0}}function n(e,t){var r=new p(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}p.prototype.push=function(e,t){var r,n,o=this.strm,i=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=l.string2buf(e):"[object ArrayBuffer]"===u.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new s.Buf8(i),o.next_out=0,o.avail_out=i),1!==(r=a.deflate(o,n))&&r!==c)return this.onEnd(r),!(this.ended=!0);0!==o.avail_out&&(0!==o.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(l.buf2binstring(s.shrinkBuf(o.output,o.next_out))):this.onData(s.shrinkBuf(o.output,o.next_out)))}while((0<o.avail_in||0===o.avail_out)&&1!==r);return 4===n?(r=a.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===c):2!==n||(this.onEnd(c),!(o.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=p,r.deflate=n,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,n(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,n(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){"use strict";var f=e("./zlib/inflate"),d=e("./utils/common"),p=e("./utils/strings"),g=e("./zlib/constants"),n=e("./zlib/messages"),o=e("./zlib/zstream"),i=e("./zlib/gzheader"),m=Object.prototype.toString;function a(e){var t,r;if(!(this instanceof a))return new a(e);if(this.options=d.assign({chunkSize:16384,windowBits:0,to:""},e||{}),(t=this.options).raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0,(r=f.inflateInit2(this.strm,t.windowBits))!==g.Z_OK)throw Error(n[r]);this.header=new i,f.inflateGetHeader(this.strm,this.header)}function s(e,t){var r=new a(t);if(r.push(e,!0),r.err)throw r.msg||n[r.err];return r.result}a.prototype.push=function(e,t){var r,n,o,i,a,s,l=this.strm,u=this.options.chunkSize,c=this.options.dictionary,h=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?g.Z_FINISH:g.Z_NO_FLUSH,"string"==typeof e?l.input=p.binstring2buf(e):"[object ArrayBuffer]"===m.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new d.Buf8(u),l.next_out=0,l.avail_out=u),(r=f.inflate(l,g.Z_NO_FLUSH))===g.Z_NEED_DICT&&c&&(s="string"==typeof c?p.string2buf(c):"[object ArrayBuffer]"===m.call(c)?new Uint8Array(c):c,r=f.inflateSetDictionary(this.strm,s)),r===g.Z_BUF_ERROR&&!0===h&&(r=g.Z_OK,h=!1),r!==g.Z_STREAM_END&&r!==g.Z_OK)return this.onEnd(r),!(this.ended=!0);l.next_out&&(0!==l.avail_out&&r!==g.Z_STREAM_END&&(0!==l.avail_in||n!==g.Z_FINISH&&n!==g.Z_SYNC_FLUSH)||("string"===this.options.to?(o=p.utf8border(l.output,l.next_out),i=l.next_out-o,a=p.buf2string(l.output,o),l.next_out=i,l.avail_out=u-i,i&&d.arraySet(l.output,l.output,o,i,0),this.onData(a)):this.onData(d.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(h=!0)}while((0<l.avail_in||0===l.avail_out)&&r!==g.Z_STREAM_END);return r===g.Z_STREAM_END&&(n=g.Z_FINISH),n===g.Z_FINISH?(r=f.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===g.Z_OK):n!==g.Z_SYNC_FLUSH||(this.onEnd(g.Z_OK),!(l.avail_out=0))},a.prototype.onData=function(e){this.chunks.push(e)},a.prototype.onEnd=function(e){e===g.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=a,r.inflate=s,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,s(e,t)},r.ungzip=s},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){"use strict";var n,o,i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){var t,r,n;for(t=Array.prototype.slice.call(arguments,1);t.length;)if(r=t.shift()){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)},n={arraySet:function(e,t,r,n,o){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),o);else for(var i=0;i<n;i++)e[o+i]=t[r+i]},flattenChunks:function(e){var t,r,n,o,i,a;for(t=n=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),t=o=0,r=e.length;t<r;t++)i=e[t],a.set(i,o),o+=i.length;return a}},o={arraySet:function(e,t,r,n,o){for(var i=0;i<n;i++)e[o+i]=t[r+i]},flattenChunks:function(e){return[].concat.apply([],e)}},r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,n)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(i)},{}],42:[function(e,t,r){"use strict";var l,n,u=e("./common"),o=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch(e){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){i=!1}for(l=new u.Buf8(256),n=0;n<256;n++)l[n]=252<=n?6:248<=n?5:240<=n?4:224<=n?3:192<=n?2:1;function c(e,t){if(t<65537&&(e.subarray&&i||!e.subarray&&o))return String.fromCharCode.apply(null,u.shrinkBuf(e,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}l[254]=l[254]=1,r.string2buf=function(e){var t,r,n,o,i,a=e.length,s=0;for(o=0;o<a;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new u.Buf8(s),o=i=0;i<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),r<128?t[i++]=r:(r<2048?t[i++]=192|r>>>6:(r<65536?t[i++]=224|r>>>12:(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63),t[i++]=128|r>>>6&63),t[i++]=128|63&r);return t},r.buf2binstring=function(e){return c(e,e.length)},r.binstring2buf=function(e){for(var t=new u.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,o,i,a=t||e.length,s=Array(2*a);for(r=n=0;r<a;)if((o=e[r++])<128)s[n++]=o;else if(4<(i=l[o]))s[n++]=65533,r+=i-1;else{for(o&=2===i?31:3===i?15:7;1<i&&r<a;)o=o<<6|63&e[r++],i--;1<i?s[n++]=65533:o<65536?s[n++]=o:(o-=65536,s[n++]=55296|o>>10&1023,s[n++]=56320|1023&o)}return c(s,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return!(r<0)&&0!==r&&r+l[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){for(var o=65535&e|0,i=e>>>16&65535|0,a=0;0!==r;){for(r-=a=2e3<r?2e3:r;i=i+(o=o+t[n++]|0)|0,--a;);o%=65521,i%=65521}return o|i<<16|0}},{}],44:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){"use strict";var s=function(){var e,t,r,n;for(t=[],r=0;r<256;r++){for(e=r,n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,n){var o,i=s,a=n+r;for(e^=-1,o=n;o<a;o++)e=e>>>8^i[255&(e^t[o])];return-1^e}},{}],46:[function(e,t,r){"use strict";var l,f=e("../utils/common"),u=e("./trees"),d=e("./adler32"),p=e("./crc32"),n=e("./messages"),c=0,h=0,g=-2,o=2,m=8,i=286,a=30,s=19,b=2*i+1,y=15,C=3,w=258,v=w+C+1,S=42,x=113;function T(e,t){return e.msg=n[t],t}function A(e){return(e<<1)-(4<e?9:0)}function k(e){for(var t=e.length;0<=--t;)e[t]=0}function M(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(f.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function I(e,t){u.jk(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,M(e.strm)}function E(e,t){e.pending_buf[e.pending++]=t}function R(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function D(e,t){var r,n,o=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-v?e.strstart-(e.w_size-v):0,u=e.window,c=e.w_mask,h=e.prev,f=e.strstart+w,d=u[i+a-1],p=u[i+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(r=t)+a]===p&&u[r+a-1]===d&&u[r]===u[i]&&u[++r]===u[i+1]){i+=2,r++;do{}while(u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&i<f);if(n=w-(f-i),i=f-w,a<n){if(e.match_start=t,s<=(a=n))break;d=u[i+a-1],p=u[i+a]}}}while((t=h[t&c])>l&&0!=--o);return a<=e.lookahead?a:e.lookahead}function N(e){var t,r,n,o,i,a,s,l,u,c,h=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=h+(h-v)){for(f.arraySet(e.window,e.window,h,h,0),e.match_start-=h,e.strstart-=h,e.block_start-=h,t=r=e.hash_size;n=e.head[--t],e.head[t]=h<=n?n-h:0,--r;);for(t=r=h;n=e.prev[--t],e.prev[t]=h<=n?n-h:0,--r;);o+=h}if(0===e.strm.avail_in)break;if(a=e.strm,s=e.window,l=e.strstart+e.lookahead,u=o,c=void 0,c=a.avail_in,u<c&&(c=u),r=0===c?0:(a.avail_in-=c,f.arraySet(s,a.input,a.next_in,c,l),1===a.state.wrap?a.adler=d(a.adler,s,c,l):2===a.state.wrap&&(a.adler=p(a.adler,s,c,l)),a.next_in+=c,a.total_in+=c,c),e.lookahead+=r,e.lookahead+e.insert>=C)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+C-1])&e.hash_mask,e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<C)););}while(e.lookahead<v&&0!==e.strm.avail_in)}function F(e,t){for(var r,n;;){if(e.lookahead<v){if(N(e),e.lookahead<v&&t===c)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=C&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-v&&(e.match_length=D(e,r)),e.match_length>=C)if(n=u.kk(e,e.strstart-e.match_start,e.match_length-C),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=C){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=u.kk(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(I(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<C-1?e.strstart:C-1,4===t?(I(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(I(e,!1),0===e.strm.avail_out)?1:2}function _(e,t){for(var r,n,o;;){if(e.lookahead<v){if(N(e),e.lookahead<v&&t===c)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=C&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=C-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-v&&(e.match_length=D(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===C&&4096<e.strstart-e.match_start)&&(e.match_length=C-1)),e.prev_length>=C&&e.match_length<=e.prev_length){for(o=e.strstart+e.lookahead-C,n=u.kk(e,e.strstart-1-e.prev_match,e.prev_length-C),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=C-1,e.strstart++,n&&(I(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=u.kk(e,0,e.window[e.strstart-1]))&&I(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=u.kk(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<C-1?e.strstart:C-1,4===t?(I(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(I(e,!1),0===e.strm.avail_out)?1:2}function P(e,t,r,n,o){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=o}function L(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new f.Buf16(2*b),this.dyn_dtree=new f.Buf16(2*(2*a+1)),this.bl_tree=new f.Buf16(2*(2*s+1)),k(this.dyn_ltree),k(this.dyn_dtree),k(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new f.Buf16(y+1),this.heap=new f.Buf16(2*i+1),k(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new f.Buf16(2*i+1),k(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function O(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=o,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?S:x,e.adler=2===t.wrap?0:1,t.last_flush=c,u.lk(t),h):T(e,g)}function B(e){var t=O(e);return t===h&&function(e){e.window_size=2*e.w_size,k(e.head),e.max_lazy_match=l[e.level].max_lazy,e.good_match=l[e.level].good_length,e.nice_match=l[e.level].nice_length,e.max_chain_length=l[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=C-1,e.match_available=0,e.ins_h=0}(e.state),t}function j(e,t,r,n,o,i){var a,s;return e?(-(a=1)===t&&(t=6),n<0?(a=0,n=-n):15<n&&(a=2,n-=16),o<1||9<o||r!==m||n<8||15<n||t<0||9<t||i<0||4<i?T(e,g):(8===n&&(n=9),s=new L,(e.state=s).strm=e,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=o+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+C-1)/C),s.window=new f.Buf8(2*s.w_size),s.head=new f.Buf16(s.hash_size),s.prev=new f.Buf16(s.w_size),s.lit_bufsize=1<<o+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new f.Buf8(s.pending_buf_size),s.d_buf=+s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=i,s.method=r,B(e))):g}l=[new P(0,0,0,0,function(e,t){var r,n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(N(e),0===e.lookahead&&t===c)return 1;if(0===e.lookahead)break}if(e.strstart+=e.lookahead,e.lookahead=0,r=e.block_start+n,(0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,I(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-v&&(I(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(I(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(I(e,!1),e.strm.avail_out),1)}),new P(4,4,8,4,F),new P(4,5,16,8,F),new P(4,6,32,32,F),new P(4,4,16,16,_),new P(8,16,32,32,_),new P(8,16,128,128,_),new P(8,32,128,256,_),new P(32,128,258,1024,_),new P(32,258,258,4096,_)],r.deflateInit=function(e,t){return j(e,t,m,15,8,0)},r.deflateInit2=j,r.deflateReset=B,r.deflateResetKeep=O,r.deflateSetHeader=function(e,t){return!e||!e.state||2!==e.state.wrap?g:(e.state.gzhead=t,h)},r.deflate=function(e,t){var r,n,o,i,a,s;if(!e||!e.state||5<t||t<0)return e?T(e,g):g;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&4!==t)return T(e,0===e.avail_out?-5:g);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===S&&(2===n.wrap?(e.adler=0,E(n,31),E(n,139),E(n,8),n.gzhead?(E(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),E(n,255&n.gzhead.time),E(n,n.gzhead.time>>8&255),E(n,n.gzhead.time>>16&255),E(n,n.gzhead.time>>24&255),E(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),E(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(E(n,255&n.gzhead.extra.length),E(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=p(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(E(n,0),E(n,0),E(n,0),E(n,0),E(n,0),E(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),E(n,3),n.status=x)):(a=m+(n.w_bits-8<<4)<<8,a|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=x,R(n,a),0!==n.strstart&&(R(n,e.adler>>>16),R(n,65535&e.adler)),e.adler=1)),69===n.status)if(n.gzhead.extra){for(o=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>o&&(e.adler=p(e.adler,n.pending_buf,n.pending-o,o)),M(e),o=n.pending,n.pending!==n.pending_buf_size));)E(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>o&&(e.adler=p(e.adler,n.pending_buf,n.pending-o,o)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(e.adler=p(e.adler,n.pending_buf,n.pending-o,o)),M(e),o=n.pending,n.pending===n.pending_buf_size)){i=1;break}i=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,E(n,i)}while(0!==i);n.gzhead.hcrc&&n.pending>o&&(e.adler=p(e.adler,n.pending_buf,n.pending-o,o)),0===i&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(e.adler=p(e.adler,n.pending_buf,n.pending-o,o)),M(e),o=n.pending,n.pending===n.pending_buf_size)){i=1;break}i=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,E(n,i)}while(0!==i);n.gzhead.hcrc&&n.pending>o&&(e.adler=p(e.adler,n.pending_buf,n.pending-o,o)),0===i&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&M(e),n.pending+2<=n.pending_buf_size&&(E(n,255&e.adler),E(n,e.adler>>8&255),e.adler=0,n.status=x)):n.status=x),0!==n.pending){if(M(e),0===e.avail_out)return n.last_flush=-1,h}else if(0===e.avail_in&&A(t)<=A(r)&&4!==t)return T(e,-5);if(666===n.status&&0!==e.avail_in)return T(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==c&&666!==n.status){if(3!==(s=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(N(e),0===e.lookahead)){if(t===c)return 1;break}if(e.match_length=0,r=u.kk(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(I(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(I(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(I(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var r,n,o,i,a=e.window;;){if(e.lookahead<=w){if(N(e),e.lookahead<=w&&t===c)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=C&&0<e.strstart&&(n=a[o=e.strstart-1])===a[++o]&&n===a[++o]&&n===a[++o]){i=e.strstart+w;do{}while(n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&o<i);e.match_length=w-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=C?(r=u.kk(e,1,e.match_length-C),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=u.kk(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(I(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(I(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(I(e,!1),0===e.strm.avail_out)?1:2}(n,t):l[n.level].func(n,t))&&4!==s||(n.status=666),1===s||3===s)return 0===e.avail_out&&(n.last_flush=-1),h;if(2===s&&(1===t?u.mk(n):5!==t&&(u.nk(n,0,0,!1),3===t&&(k(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),M(e),0===e.avail_out))return n.last_flush=-1,h}return 4!==t?h:n.wrap<=0?1:(2===n.wrap?(E(n,255&e.adler),E(n,e.adler>>8&255),E(n,e.adler>>16&255),E(n,e.adler>>24&255),E(n,255&e.total_in),E(n,e.total_in>>8&255),E(n,e.total_in>>16&255),E(n,e.total_in>>24&255)):(R(n,e.adler>>>16),R(n,65535&e.adler)),M(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?h:1)},r.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==S&&69!==t&&73!==t&&91!==t&&103!==t&&t!==x&&666!==t?T(e,g):(e.state=null,t===x?T(e,-3):h):g},r.deflateSetDictionary=function(e,t){var r,n,o,i,a,s,l,u,c=t.length;if(!e||!e.state)return g;if(2===(i=(r=e.state).wrap)||1===i&&r.status!==S||r.lookahead)return g;for(1===i&&(e.adler=d(e.adler,t,c,0)),r.wrap=0,c>=r.w_size&&(0===i&&(k(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new f.Buf8(r.w_size),f.arraySet(u,t,c-r.w_size,r.w_size,0),t=u,c=r.w_size),a=e.avail_in,s=e.next_in,l=e.input,e.avail_in=c,e.next_in=0,e.input=t,N(r);r.lookahead>=C;){for(n=r.strstart,o=r.lookahead-(C-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+C-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--o;);r.strstart=n,r.lookahead=C-1,N(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=C-1,r.match_available=0,e.next_in=s,e.input=l,e.avail_in=a,r.wrap=i,h},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k;r=e.state,n=e.next_in,A=e.input,o=n+(e.avail_in-5),i=e.next_out,k=e.output,a=i-(t-e.avail_out),s=i+(e.avail_out-257),l=r.dmax,u=r.wsize,c=r.whave,h=r.wnext,f=r.window,d=r.hold,p=r.bits,g=r.lencode,m=r.distcode,b=(1<<r.lenbits)-1,y=(1<<r.distbits)-1;e:do{p<15&&(d+=A[n++]<<p,p+=8,d+=A[n++]<<p,p+=8),C=g[d&b];t:for(;;){if(d>>>=w=C>>>24,p-=w,0==(w=C>>>16&255))k[i++]=65535&C;else{if(!(16&w)){if(0==(64&w)){C=g[(65535&C)+(d&(1<<w)-1)];continue t}if(32&w){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}v=65535&C,(w&=15)&&(p<w&&(d+=A[n++]<<p,p+=8),v+=d&(1<<w)-1,d>>>=w,p-=w),p<15&&(d+=A[n++]<<p,p+=8,d+=A[n++]<<p,p+=8),C=m[d&y];r:for(;;){if(d>>>=w=C>>>24,p-=w,!(16&(w=C>>>16&255))){if(0==(64&w)){C=m[(65535&C)+(d&(1<<w)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(S=65535&C,p<(w&=15)&&(d+=A[n++]<<p,(p+=8)<w&&(d+=A[n++]<<p,p+=8)),l<(S+=d&(1<<w)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(d>>>=w,p-=w,(w=i-a)<S){if(c<(w=S-w)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(T=f,(x=0)===h){if(x+=u-w,w<v){for(v-=w;k[i++]=f[x++],--w;);x=i-S,T=k}}else if(h<w){if(x+=u+h-w,(w-=h)<v){for(v-=w;k[i++]=f[x++],--w;);if(x=0,h<v){for(v-=w=h;k[i++]=f[x++],--w;);x=i-S,T=k}}}else if(x+=h-w,w<v){for(v-=w;k[i++]=f[x++],--w;);x=i-S,T=k}for(;2<v;)k[i++]=T[x++],k[i++]=T[x++],k[i++]=T[x++],v-=3;v&&(k[i++]=T[x++],1<v&&(k[i++]=T[x++]))}else{for(x=i-S;k[i++]=k[x++],k[i++]=k[x++],k[i++]=k[x++],2<(v-=3););v&&(k[i++]=k[x++],1<v&&(k[i++]=k[x++]))}break}}break}}while(n<o&&i<s);n-=v=p>>3,d&=(1<<(p-=v<<3))-1,e.next_in=n,e.next_out=i,e.avail_in=n<o?o-n+5:5-(n-o),e.avail_out=i<s?s-i+257:257-(i-s),r.hold=d,r.bits=p}},{}],49:[function(e,t,r){"use strict";var n,o,i,E=e("../utils/common"),R=e("./adler32"),D=e("./crc32"),N=e("./inffast"),F=e("./inftrees"),_=1,P=2,L=0,O=-2,B=1,a=852,s=592;function j(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function l(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new E.Buf16(320),this.work=new E.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function u(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=B,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new E.Buf32(a),t.distcode=t.distdyn=new E.Buf32(s),t.sane=1,t.back=-1,L):O}function c(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,u(e)):O}function h(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?O:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,c(e))):O}function f(e,t){var r,n;return e?(n=new l,(e.state=n).window=null,(r=h(e,t))!==L&&(e.state=null),r):O}function H(e){if(i){var t;for(n=new E.Buf32(512),o=new E.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(F(_,e.lens,0,288,n,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;F(P,e.lens,0,32,o,0,e.work,{bits:5}),i=!1}e.lencode=n,e.lenbits=9,e.distcode=o,e.distbits=5}function G(e,t,r,n){var o,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new E.Buf8(i.wsize)),n>=i.wsize?(E.arraySet(i.window,t,r-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):(n<(o=i.wsize-i.wnext)&&(o=n),E.arraySet(i.window,t,r-n,o,i.wnext),(n-=o)?(E.arraySet(i.window,t,r-n,n,0),i.wnext=n,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0}i=!0,r.inflateReset=c,r.inflateReset2=h,r.inflateResetKeep=u,r.inflateInit=function(e){return f(e,15)},r.inflateInit2=f,r.inflate=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k=0,M=new E.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return O;12===(r=e.state).mode&&(r.mode=13),a=e.next_out,o=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,u=r.hold,c=r.bits,h=s,f=l,x=L;e:for(;;)switch(r.mode){case B:if(0===r.wrap){r.mode=13;break}for(;c<16;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}if(2&r.wrap&&35615===u){M[r.check=0]=255&u,M[1]=u>>>8&255,r.check=D(r.check,M,2,0),c=u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&u)){e.msg="unknown compression method",r.mode=30;break}if(c-=4,S=8+(15&(u>>>=4)),0===r.wbits)r.wbits=S;else if(S>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<S,e.adler=r.check=1,r.mode=512&u?10:12,c=u=0;break;case 2:for(;c<16;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}if(r.flags=u,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&(M[0]=255&u,M[1]=u>>>8&255,r.check=D(r.check,M,2,0)),c=u=0,r.mode=3;case 3:for(;c<32;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}r.head&&(r.head.time=u),512&r.flags&&(M[0]=255&u,M[1]=u>>>8&255,M[2]=u>>>16&255,M[3]=u>>>24&255,r.check=D(r.check,M,4,0)),c=u=0,r.mode=4;case 4:for(;c<16;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&(M[0]=255&u,M[1]=u>>>8&255,r.check=D(r.check,M,2,0)),c=u=0,r.mode=5;case 5:if(1024&r.flags){for(;c<16;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&(M[0]=255&u,M[1]=u>>>8&255,r.check=D(r.check,M,2,0)),c=u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(s<(d=r.length)&&(d=s),d&&(r.head&&(S=r.head.extra_len-r.length,r.head.extra||(r.head.extra=Array(r.head.extra_len)),E.arraySet(r.head.extra,n,i,d,S)),512&r.flags&&(r.check=D(r.check,n,d,i)),s-=d,i+=d,r.length-=d),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break e;for(d=0;S=n[i+d++],r.head&&S&&r.length<65536&&(r.head.name+=String.fromCharCode(S)),S&&d<s;);if(512&r.flags&&(r.check=D(r.check,n,d,i)),s-=d,i+=d,S)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break e;for(d=0;S=n[i+d++],r.head&&S&&r.length<65536&&(r.head.comment+=String.fromCharCode(S)),S&&d<s;);if(512&r.flags&&(r.check=D(r.check,n,d,i)),s-=d,i+=d,S)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;c<16;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}if(u!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}c=u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;c<32;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}e.adler=r.check=j(u),c=u=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=u,r.bits=c,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){u>>>=7&c,c-=7&c,r.mode=27;break}for(;c<3;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}switch(r.last=1&u,--c,3&(u>>>=1)){case 0:r.mode=14;break;case 1:if(H(r),r.mode=20,6!==t)break;u>>>=2,c-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}u>>>=2,c-=2;break;case 14:for(u>>>=7&c,c-=7&c;c<32;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&u,c=u=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(d=r.length){if(s<d&&(d=s),l<d&&(d=l),0===d)break e;E.arraySet(o,n,i,d,a),s-=d,i+=d,l-=d,a+=d,r.length-=d;break}r.mode=12;break;case 17:for(;c<14;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}if(r.nlen=257+(31&u),u>>>=5,c-=5,r.ndist=1+(31&u),u>>>=5,c-=5,r.ncode=4+(15&u),u>>>=4,c-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;c<3;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}r.lens[I[r.have++]]=7&u,u>>>=3,c-=3}for(;r.have<19;)r.lens[I[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,T={bits:r.lenbits},x=F(0,r.lens,0,19,r.lencode,0,r.work,T),r.lenbits=T.bits,x){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;b=(k=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,y=65535&k,!((m=k>>>24)<=c);){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}if(y<16)u>>>=m,c-=m,r.lens[r.have++]=y;else{if(16===y){for(A=m+2;c<A;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}if(u>>>=m,c-=m,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}S=r.lens[r.have-1],d=3+(3&u),u>>>=2,c-=2}else if(17===y){for(A=m+3;c<A;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}c-=m,S=0,d=3+(7&(u>>>=m)),u>>>=3,c-=3}else{for(A=m+7;c<A;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}c-=m,S=0,d=11+(127&(u>>>=m)),u>>>=7,c-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;d--;)r.lens[r.have++]=S}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,T={bits:r.lenbits},x=F(_,r.lens,0,r.nlen,r.lencode,0,r.work,T),r.lenbits=T.bits,x){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,T={bits:r.distbits},x=F(P,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,T),r.distbits=T.bits,x){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=s&&258<=l){e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=u,r.bits=c,N(e,f),a=e.next_out,o=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,u=r.hold,c=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;b=(k=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,y=65535&k,!((m=k>>>24)<=c);){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}if(b&&0==(240&b)){for(C=m,w=b,v=y;b=(k=r.lencode[v+((u&(1<<C+w)-1)>>C)])>>>16&255,y=65535&k,!(C+(m=k>>>24)<=c);){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}u>>>=C,c-=C,r.back+=C}if(u>>>=m,c-=m,r.back+=m,r.length=y,0===b){r.mode=26;break}if(32&b){r.back=-1,r.mode=12;break}if(64&b){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&b,r.mode=22;case 22:if(r.extra){for(A=r.extra;c<A;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;b=(k=r.distcode[u&(1<<r.distbits)-1])>>>16&255,y=65535&k,!((m=k>>>24)<=c);){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}if(0==(240&b)){for(C=m,w=b,v=y;b=(k=r.distcode[v+((u&(1<<C+w)-1)>>C)])>>>16&255,y=65535&k,!(C+(m=k>>>24)<=c);){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}u>>>=C,c-=C,r.back+=C}if(u>>>=m,c-=m,r.back+=m,64&b){e.msg="invalid distance code",r.mode=30;break}r.offset=y,r.extra=15&b,r.mode=24;case 24:if(r.extra){for(A=r.extra;c<A;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===l)break e;if(d=f-l,r.offset>d){if((d=r.offset-d)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}p=d>r.wnext?(d-=r.wnext,r.wsize-d):r.wnext-d,d>r.length&&(d=r.length),g=r.window}else g=o,p=a-r.offset,d=r.length;for(l<d&&(d=l),l-=d,r.length-=d;o[a++]=g[p++],--d;);0===r.length&&(r.mode=21);break;case 26:if(0===l)break e;o[a++]=r.length,l--,r.mode=21;break;case 27:if(r.wrap){for(;c<32;){if(0===s)break e;s--,u|=n[i++]<<c,c+=8}if(f-=l,e.total_out+=f,r.total+=f,f&&(e.adler=r.check=(r.flags?D:R)(r.check,o,f,a-f)),f=l,(r.flags?u:j(u))!==r.check){e.msg="incorrect data check",r.mode=30;break}c=u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;c<32;){if(0===s)break e;s--,u+=n[i++]<<c,c+=8}if(u!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}c=u=0}r.mode=29;case 29:x=1;break e;case 30:x=-3;break e;case 31:return-4;case 32:default:return O}return e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=u,r.bits=c,(r.wsize||f!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&G(e,e.output,e.next_out,f-e.avail_out)?(r.mode=31,-4):(h-=e.avail_in,f-=e.avail_out,e.total_in+=h,e.total_out+=f,r.total+=f,r.wrap&&f&&(e.adler=r.check=(r.flags?D:R)(r.check,o,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==h&&0===f||4===t)&&x===L&&(x=-5),x)},r.inflateEnd=function(e){if(!e||!e.state)return O;var t=e.state;return t.window&&(t.window=null),e.state=null,L},r.inflateGetHeader=function(e,t){var r;return!e||!e.state||0==(2&(r=e.state).wrap)?O:((r.head=t).done=!1,L)},r.inflateSetDictionary=function(e,t){var r,n=t.length;return!e||!e.state||0!==(r=e.state).wrap&&11!==r.mode?O:11===r.mode&&R(1,t,n,0)!==r.check?-3:G(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,L)},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){"use strict";var _=e("../utils/common"),P=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],L=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],O=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],B=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,n,o,i,a,s){var l,u,c,h,f,d,p,g,m,b=s.bits,y=0,C=0,w=0,v=0,S=0,x=0,T=0,A=0,k=0,M=0,I=null,E=0,R=new _.Buf16(16),D=new _.Buf16(16),N=null,F=0;for(y=0;y<=15;y++)R[y]=0;for(C=0;C<n;C++)R[t[r+C]]++;for(S=b,v=15;1<=v&&0===R[v];v--);if(v<S&&(S=v),0===v)return o[i++]=20971520,o[i++]=20971520,s.bits=1,0;for(w=1;w<v&&0===R[w];w++);for(S<w&&(S=w),y=A=1;y<=15;y++)if(A<<=1,(A-=R[y])<0)return-1;if(0<A&&(0===e||1!==v))return-1;for(D[1]=0,y=1;y<15;y++)D[y+1]=D[y]+R[y];for(C=0;C<n;C++)0!==t[r+C]&&(a[D[t[r+C]]++]=C);if(d=0===e?(I=N=a,19):1===e?(I=P,E-=257,N=L,F-=257,256):(I=O,N=B,-1),y=w,f=i,T=C=M=0,c=-1,h=(k=1<<(x=S))-1,1===e&&852<k||2===e&&592<k)return 1;for(;;){for(p=y-T,m=a[C]<d?(g=0,a[C]):a[C]>d?(g=N[F+a[C]],I[E+a[C]]):(g=96,0),l=1<<y-T,w=u=1<<x;o[f+(M>>T)+(u-=l)]=p<<24|g<<16|m|0,0!==u;);for(l=1<<y-1;M&l;)l>>=1;if(0!==l?(M&=l-1,M+=l):M=0,C++,0==--R[y]){if(y===v)break;y=t[r+a[C]]}if(S<y&&(M&h)!==c){for(0===T&&(T=S),f+=w,A=1<<(x=y-T);x+T<v&&!((A-=R[x+T])<=0);)x++,A<<=1;if(k+=1<<x,1===e&&852<k||2===e&&592<k)return 1;o[c=M&h]=S<<24|x<<16|f-i|0}}return 0!==M&&(o[f+M]=y-T<<24|64<<16|0),s.bits=S,0}},{"../utils/common":41}],51:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){"use strict";var m,n,l,u,a,s,c,h,f,d,p,g,b,y,C,o,i=e("../utils/common");function w(e){for(var t=e.length;0<=--t;)e[t]=0}function v(e,t,r,n,o){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=o,this.has_stree=e&&e.length}function S(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function x(e){return e<256?f[e]:f[256+(e>>>7)]}function T(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function A(e,t,r){e.bi_valid>n-r?(e.bi_buf|=t<<e.bi_valid&65535,T(e,e.bi_buf),e.bi_buf=t>>n-e.bi_valid,e.bi_valid+=r-n):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function k(e,t,r){A(e,r[2*t],r[2*t+1])}function M(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function I(e,t,r){var n,o,i,a=Array(m+1),s=0;for(n=1;n<=m;n++)a[n]=s=s+r[n-1]<<1;for(o=0;o<=t;o++)0!==(i=e[2*o+1])&&(e[2*o]=M(a[i]++,i))}function E(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function R(e){8<e.bi_valid?T(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function D(e,t,r,n){var o=2*t,i=2*r;return e[o]<e[i]||e[o]===e[i]&&n[t]<=n[r]}function N(e,t,r){for(var n=e.heap[r],o=r<<1;o<=e.heap_len&&(o<e.heap_len&&D(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!D(t,n,e.heap[o],e.depth));)e.heap[r]=e.heap[o],r=o,o<<=1;e.heap[r]=n}function F(e,t,r){var n,o,i,a,s=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],o=e.pending_buf[e.l_buf+s],s++,0===n?k(e,o,t):(k(e,(i=d[o])+256+1,t),0!==(a=l[i])&&A(e,o-=p[i],a),k(e,i=x(--n),r),0!==(a=u[i])&&A(e,n-=C[i],a)),s<e.last_lit;);k(e,256,t)}function _(e,t){var r,n,o,i=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<l;r++)0!==i[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):i[2*r+1]=0;for(;e.heap_len<2;)i[2*(o=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[o]=0,e.opt_len--,s&&(e.static_len-=a[2*o+1]);for(t.max_code=u,r=e.heap_len>>1;1<=r;r--)N(e,i,r);for(o=l;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],N(e,i,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,i[2*o]=i[2*r]+i[2*n],e.depth[o]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,i[2*r+1]=i[2*n+1]=o,e.heap[1]=o++,N(e,i,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,o,i,a,s,l=t.dyn_tree,u=t.max_code,c=t.stat_desc.static_tree,h=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,p=t.stat_desc.max_length,g=0;for(i=0;i<=m;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)p<(i=l[2*l[2*(n=e.heap[r])+1]+1]+1)&&(i=p,g++),l[2*n+1]=i,u<n||(e.bl_count[i]++,a=0,d<=n&&(a=f[n-d]),s=l[2*n],e.opt_len+=s*(i+a),h&&(e.static_len+=s*(c[2*n+1]+a)));if(0!==g){do{for(i=p-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[p]--,g-=2}while(0<g);for(i=p;0!==i;i--)for(n=e.bl_count[i];0!==n;)u<(o=e.heap[--r])||(l[2*o+1]!==i&&(e.opt_len+=(i-l[2*o+1])*l[2*o],l[2*o+1]=i),n--)}}(e,t),I(i,u,e.bl_count)}function P(e,t,r){var n,o,i=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)o=a,a=t[2*(n+1)+1],++s<l&&o===a||(s<u?e.bl_tree[2*o]+=s:0!==o?(o!==i&&e.bl_tree[2*o]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,i=o,u=(s=0)===a?(l=138,3):o===a?(l=6,3):(l=7,4))}function L(e,t,r){var n,o,i=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),n=0;n<=r;n++)if(o=a,a=t[2*(n+1)+1],!(++s<l&&o===a)){if(s<u)for(;k(e,o,e.bl_tree),0!=--s;);else 0!==o?(o!==i&&(k(e,o,e.bl_tree),s--),k(e,16,e.bl_tree),A(e,s-3,2)):s<=10?(k(e,17,e.bl_tree),A(e,s-3,3)):(k(e,18,e.bl_tree),A(e,s-11,7));i=o,u=(s=0)===a?(l=138,3):o===a?(l=6,3):(l=7,4)}}function O(e,t,r,n){A(e,0+(n?1:0),3),function(e,t,r){R(e),T(e,r),T(e,~r),i.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r)}l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],s=[n=16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,m=15],w(c=Array(576)),w(h=Array(60)),w(f=Array(512)),w(d=Array(256)),w(p=Array(29)),w(C=Array(30)),o=!1,r.lk=function(e){o||(function(){var e,t,r,n,o,i=Array(m+1);for(n=r=0;n<28;n++)for(p[n]=r,e=0;e<1<<l[n];e++)d[r++]=n;for(d[r-1]=n,n=o=0;n<16;n++)for(C[n]=o,e=0;e<1<<u[n];e++)f[o++]=n;for(o>>=7;n<30;n++)for(C[n]=o<<7,e=0;e<1<<u[n]-7;e++)f[256+o++]=n;for(t=0;t<=m;t++)i[t]=0;for(e=0;e<=143;)c[2*e+1]=8,e++,i[8]++;for(;e<=255;)c[2*e+1]=9,e++,i[9]++;for(;e<=279;)c[2*e+1]=7,e++,i[7]++;for(;e<=287;)c[2*e+1]=8,e++,i[8]++;for(I(c,287,i),e=0;e<30;e++)h[2*e+1]=5,h[2*e]=M(e,5);g=new v(c,l,257,286,m),b=new v(h,u,0,30,m),y=new v(Array(0),a,0,19,7)}(),o=!0),e.l_desc=new S(e.dyn_ltree,g),e.d_desc=new S(e.dyn_dtree,b),e.bl_desc=new S(e.bl_tree,y),e.bi_buf=0,e.bi_valid=0,E(e)},r.nk=O,r.jk=function(e,t,r,n){var o,i,a=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),_(e,e.l_desc),_(e,e.d_desc),a=function(e){var t;for(P(e,e.dyn_ltree,e.l_desc.max_code),P(e,e.dyn_dtree,e.d_desc.max_code),_(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*s[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=o&&(o=i)):o=i=r+5,r+4<=o&&-1!==t?O(e,t,r,n):4===e.strategy||i===o?(A(e,2+(n?1:0),3),F(e,c,h)):(A(e,4+(n?1:0),3),function(e,t,r,n){var o;for(A(e,t-257,5),A(e,r-1,5),A(e,n-4,4),o=0;o<n;o++)A(e,e.bl_tree[2*s[o]+1],3);L(e,e.dyn_ltree,t-1),L(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),F(e,e.dyn_ltree,e.dyn_dtree)),E(e),n&&R(e)},r.kk=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(d[r]+256+1)]++,e.dyn_dtree[2*x(t)]++),e.last_lit===e.lit_bufsize-1},r.mk=function(e){A(e,2,3),k(e,256,c),function(e){16===e.bi_valid?(T(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){"use strict";t.exports="function"==typeof i?i:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}},{}]},{},[10])(10)},"./src/xlsx-io/common/chart-helper.ts":function(e,t,r){"use strict";var n,o,i,a,s,l;function u(){}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/datamodel/chart-model.ts"),o=n.Charts.ST_SystemColorVal,i=n.Charts.ST_SchemeColorVal,a=n.Charts.ST_SplitType,s=n.Charts.ST_MarkerStyle,l=n.Charts.ST_SeriesLayout,u.ToKnownColor=function(e){var t=null;switch(e){case o.scrollBar:t=23;break;case o.activeCaption:t=2;break;case o.inactiveCaption:t=17;break;case o.menu:t=21;break;case o.window:t=24;break;case o.windowFrame:t=25;break;case o.menuText:t=22;break;case o.windowText:t=26;break;case o.activeBorder:t=1;break;case o.inactiveBorder:t=16;break;case o.appWorkspace:t=4;break;case o.highlight:t=13;break;case o.highlightText:t=14;break;case o.btnFace:t=168;break;case o.btnShadow:t=170;break;case o.grayText:t=12;break;case o.inactiveCaptionText:t=18;break;case o.btnHighlight:t=169;break;case o.infoText:t=20;break;case o.infoBk:t=19;break;case o.gradientActiveCaption:t=171;break;case o.gradientInactiveCaption:t=172;break;case o.menuHighlight:t=174;break;case o.menuBar:t=173}return t},u.ToST_SystemColorVal=function(e){var t=null;switch(e){case 1:t=o.activeBorder;break;case 2:t=o.activeCaption;break;case 168:t=o.btnFace;break;case 169:t=o.btnHighlight;break;case 170:t=o.btnShadow;break;case 171:t=o.gradientActiveCaption;break;case 172:t=o.gradientInactiveCaption;break;case 12:t=o.grayText;break;case 13:t=o.highlight;break;case 14:t=o.highlightText;break;case 16:t=o.inactiveBorder;break;case 17:t=o.inactiveCaption;break;case 18:t=o.inactiveCaptionText;break;case 20:t=o.infoText;break;case 21:t=o.menu;break;case 173:t=o.menuBar;break;case 174:t=o.menuHighlight;break;case 22:t=o.menuText;break;case 24:t=o.window;break;case 25:t=o.windowFrame;break;case 26:t=o.windowText}return t},u.ToST_SchemeColorVal=function(e){var t=i.accent1;switch(e){case 4:t=i.accent1;break;case 5:t=i.accent2;break;case 6:t=i.accent3;break;case 7:t=i.accent4;break;case 8:t=i.accent5;break;case 9:t=i.accent6;break;case 0:t=i.bg1;break;case 2:t=i.bg2;break;case 11:t=i.folHlink;break;case 10:t=i.hlink;break;case 12:t=i.phClr;break;case 13:t=i.dk1;break;case 14:t=i.lt1;break;case 15:t=i.dk2;break;case 16:t=i.lt2;break;case 1:t=i.tx1;break;case 3:t=i.tx2}return t},u.ToColorSchemeIndex=function(e){var t=4;switch(e){case i.bg1:t=0;break;case i.tx1:t=1;break;case i.bg2:t=2;break;case i.tx2:t=3;break;case i.accent1:t=4;break;case i.accent2:t=5;break;case i.accent3:t=6;break;case i.accent4:t=7;break;case i.accent5:t=8;break;case i.accent6:t=9;break;case i.hlink:t=10;break;case i.folHlink:t=11;break;case i.phClr:t=12;break;case i.dk1:t=13;break;case i.lt1:t=14;break;case i.dk2:t=15;break;case i.lt2:t=16}return t},u.ToST_PresetLineDashVal=function(e){return 11===e&&(e=1),e},u.ToPatternType=function(e){var t=0;switch(e){case 0:t=1;break;case 1:t=2;break;case 2:t=3;break;case 3:t=4;break;case 4:t=5;break;case 5:t=6;break;case 6:t=7;break;case 7:t=8;break;case 8:t=9;break;case 9:t=10;break;case 10:t=11;break;case 11:t=12;break;case 16:t=13;break;case 17:t=14;break;case 27:t=15;break;case 28:t=16;break;case 34:t=17;break;case 52:t=18;break;case 14:t=19;break;case 15:t=20;break;case 25:t=21;break;case 26:t=22;break;case 36:t=23;break;case 45:t=24;break;case 29:t=25;break;case 30:t=26;break;case 32:t=27;break;case 31:t=28;break;case 19:t=29;break;case 18:t=30;break;case 21:t=31;break;case 20:t=32;break;case 40:t=33;break;case 37:t=34;break;case 41:t=35;break;case 35:t=36;break;case 39:t=37;break;case 53:t=38;break;case 43:t=39;break;case 42:t=40;break;case 44:t=41;break;case 46:t=42;break;case 47:t=43;break;case 48:t=44;break;case 38:t=45;break;case 49:t=46;break;case 50:t=47;break;case 51:t=48;break;case 12:t=49;break;case 13:t=50;break;case 22:t=51;break;case 23:t=52;break;case 24:t=53;break;case 33:t=54}return t},u.ToST_PresetPatternVal=function(e){var t=0;switch(e){case 1:t=0;break;case 2:t=1;break;case 3:t=2;break;case 4:t=3;break;case 5:t=4;break;case 6:t=5;break;case 7:t=6;break;case 8:t=7;break;case 9:t=8;break;case 10:t=9;break;case 11:t=10;break;case 12:t=11;break;case 13:t=16;break;case 14:t=17;break;case 15:t=27;break;case 16:t=28;break;case 17:t=34;break;case 18:t=52;break;case 19:t=14;break;case 20:t=15;break;case 21:t=25;break;case 22:t=26;break;case 23:t=36;break;case 24:t=45;break;case 25:t=29;break;case 26:t=30;break;case 27:t=32;break;case 28:t=31;break;case 29:t=19;break;case 30:t=18;break;case 31:t=21;break;case 32:t=20;break;case 33:t=40;break;case 34:t=37;break;case 35:t=41;break;case 36:t=35;break;case 37:t=39;break;case 38:t=53;break;case 39:t=43;break;case 40:t=42;break;case 41:t=44;break;case 42:t=46;break;case 43:t=47;break;case 44:t=48;break;case 45:t=38;break;case 46:t=49;break;case 47:t=50;break;case 48:t=51;break;case 49:t=12;break;case 50:t=13;break;case 51:t=22;break;case 52:t=23;break;case 53:t=24;break;case 54:t=33}return t},u.ToST_PresetShadowVal=function(e){return 19<e?0:e},u.ToST_SplitType=function(e){var t=a.pos;switch(e){case 0:t=a.pos;break;case 1:t=a.val;break;case 2:t=a.percent;break;case 3:t=a.cust}return t},u.ToChartSplitType=function(e){var t=0;switch(e){case a.auto:t=0;break;case a.cust:t=3;break;case a.percent:t=2;break;case a.pos:t=0;break;case a.val:t=1}return t},u.ToST_LightRigDirection=function(e){var t=1;switch(e){case 0:t=1;break;case 1:t=4;break;case 2:t=6;break;case 3:case 4:t=1;break;case 5:t=6;break;case 6:t=1;break;case 7:t=3;break;case 8:t=6}return t},u.ToST_MarkerStyle=function(e){return 11===e&&(e=s.circle),e},u.ToST_LegendPos=function(e){var t=0;switch(e){case 0:break;case 1:t=4;break;case 2:t=3;break;case 3:t=2;break;case 4:t=0;break;case 5:t=1}return t},u.ToLegendPosition=function(e){var t=4;switch(e){case 0:t=4;break;case 1:t=5;break;case 2:t=3;break;case 3:t=2;break;case 4:t=1}return t},u.ToST_PresetCameraType=function(e){return 62===e&&(e=0),e},u.ToST_BuiltInUnit=function(e){return 8<e&&(e=0),e},u.ToST_Crosses=function(e){var t=0;switch(e){case 0:break;case 1:t=0;break;case 2:t=1;break;case 3:t=2}return t},u.ToAxisCrosses=function(e){var t=1;switch(e){case 0:t=1;break;case 1:t=2;break;case 2:t=3}return t},u.ToCT_ChartType=function(e){var t=16;switch(e){case l.boxWhisker:t=16;break;case l.funnel:t=17;break;case l.paretoLine:t=18;break;case l.regionMap:t=19;break;case l.sunburst:t=20;break;case l.treemap:t=21;break;case l.waterfall:t=22;break;case l.clusteredColumn:t=23}return t},u.ToST_SeriesLayout=function(e){var t=0;switch(e){case 16:t=l.boxWhisker;break;case 17:t=l.funnel;break;case 18:t=l.paretoLine;break;case 19:t=l.regionMap;break;case 20:t=l.sunburst;break;case 21:t=l.treemap;break;case 22:t=l.waterfall;break;case 23:t=l.clusteredColumn}return t},t.ChartHelper=u},"./src/xlsx-io/common/color-reader.ts":function(e,t,r){"use strict";var u,c,h;Object.defineProperty(t,"__esModule",{value:!0}),u=r("./src/datamodel/excel-style.ts"),c=r("./src/common/common.ts"),h=r("./src/xml-io/xml-reader.ts"),t.readColor=function(e){var t,r,n=u.ExcelColor.EmptyColor,o=!1,i=-1,a=0,s="",l=-1;if(e&&e instanceof h.XmlReader)for(t=e;t.moveToNextAttribute();)switch(t.readAttributeNameAsString()){case"auto":o=t.readContentAsBoolean(!1);break;case"theme":i=t.readContentAsInt(-1);break;case"tint":a=t.readContentAsDouble(0);break;case"rgb":s=t.readContentAsString();break;case"indexed":l=t.readContentAsInt(-1)}else e&&(o=!!e.pe.auto,e.pe.theme&&(i=parseInt(e.pe.theme,10)),e.pe.tint&&(a=parseFloat(e.pe.tint)),s=e.pe.rgb||"",e.pe.indexed&&(l=parseInt(e.pe.indexed,10)));return o?(n.isAutoColor(!0),n):-1!==i?n=new u.ExcelColor(3,i,a):c.StringEx.q(s)?0<=l?n=new u.ExcelColor(1,l,0):n:(r=parseInt(s,16),n=new u.ExcelColor(2,r,a))}},"./src/xlsx-io/common/color-writer.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("./src/datamodel/excel-style.ts");t.writeColor=function(t,e,r){void 0!==r&&t.writeLeafElement(e,function(){if(null===r||r.isAutoColor())t.writeAttributeString("auto","1");else if(r.isIndexedColor())t.writeAttributeString("indexed",""+r.value());else if(r.isThemeColor())t.writeAttributeString("theme",""+r.value()),0!==r.tint()&&t.writeAttributeString("tint",""+r.tint());else if(r.isRGBColor()){var e=r.value().toString(16);t.writeAttributeString("rgb",e.toUpperCase()),0!==r.tint()&&t.writeAttributeString("tint",""+r.tint())}})},t.writeColorScheme=function(t,r,n){n&&t.writeElement(r,void 0,function(){if("a:dk1"===r)t.writeLeafElement("a:sysClr",function(){t.writeAttributeString("val","windowText"),t.writeAttributeString("lastClr","000000")});else if("a:lt1"===r)t.writeLeafElement("a:sysClr",function(){t.writeAttributeString("val","window"),t.writeAttributeString("lastClr","FFFFFF")});else if(2===n.colorType())t.writeLeafElement("a:srgbClr",function(){t.writeAttributeString("val",n.value().toString(16).substring(2))});else if(3===n.colorType())t.writeLeafElement("a:schemeClr",function(){t.writeAttributeString("val",o.ConverterHelper.toSchemeClrValue(n.value()))});else if(1===n.colorType()){var e=o.ColorHelper.toExcelIndexedColor(n);t.writeLeafElement("a:srgbClr",function(){t.writeAttributeString("val",e&&e.value?e.value().toString(16):"0")})}})}},"./src/xlsx-io/common/errorMessage.ts":function(e,t,r){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/common/common.ts"),o={en:{EXP_IO:"File read and write exception.",EXP_FILE_FORMAT:"Incorrect file format.",EXP_NO_PASSWORD:"The Excel file cannot be opened because the workbook/worksheet is password protected.",EXP_INVALID_PASSWORD:"The specified password is incorrect."},ja:{EXP_IO:"IO",EXP_FILE_FORMAT:"",EXP_NO_PASSWORD:"/Excel",EXP_INVALID_PASSWORD:""},zh:{EXP_IO:"",EXP_FILE_FORMAT:"",EXP_NO_PASSWORD:"Excel",EXP_INVALID_PASSWORD:""}},t.sR=function(){var e=n.Ia()||"en",t=o[e.split("-")[0]];return t||o.en}},"./src/xlsx-io/common/errorcode.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCode={fileIOError:0,fileFormatError:1,noPassword:2,invalidPassword:3}},"./src/xlsx-io/common/file-loader.ts":function(e,t,r){"use strict";var n,s,o,i,l;function a(e){if(this.loadType=void 0===e?1:e,"undefined"==typeof FileReader)throw Error("The browser doesn't support FileReader!");this.fileReader=new FileReader,this.passwordFileReader=new FileReader,this.compoundFile=new n.CompoundFile}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/xlsx-io/password/compoundFile.ts"),s=r("./src/xlsx-io/password/xlsxEncryptionHelper.ts"),o=r("./src/xlsx-io/common/errorcode.ts"),i=r("./src/xlsx-io/common/errorMessage.ts"),l=r("./src/lib/jszip.min.js"),a.prototype.loadFile=function(e,t){var r=this,n=r.fileReader;if(e instanceof ArrayBuffer)r.fileLoad(e,t);else if(e&&n)switch(n.onload=function(e){r.fileLoad(e.target.result,t)},n.onerror=function(){r.pk()},r.loadType){case 1:if(n.readAsArrayBuffer){n.readAsArrayBuffer(e);break}r.loadType=0;break;default:n.readAsDataURL&&n.readAsDataURL(e)}},a.prototype.pk=function(){this.onError({errorCode:o.errorCode.fileIOError,errorMessage:i.sR().EXP_IO})},a.prototype.qk=function(){this.onError({errorCode:o.errorCode.fileFormatError,errorMessage:i.sR().EXP_FILE_FORMAT})},a.prototype.rk=function(){this.onError({errorCode:o.errorCode.noPassword,errorMessage:i.sR().EXP_NO_PASSWORD})},a.prototype.sk=function(){this.onError({errorCode:o.errorCode.invalidPassword,errorMessage:i.sR().EXP_INVALID_PASSWORD})},a.prototype.fileLoad=function(e,t){var i,r,n,a=this;if(t&&t.password)try{if(!(e=s.XlsxEncryptionHelper.tk(e,t.password)))return void a.sk()}catch(e){return void a.sk()}else if(s.XlsxEncryptionHelper.uk(e))return void a.rk();switch(i=new l,a.loadType){case 1:i.loadAsync(e).then(o).catch(function(){a.qk()});break;case 0:default:-1!==(r=e.indexOf("base64,"))&&(n=e.substring(r+"base64,".length),i.loadAsync(n,{base64:!0}).then(o).catch(function(){a.qk()}))}function o(){var e,t,r,n=i.files,o={};for(e in n)n.hasOwnProperty(e)&&(t=".xml"===(r=e.substring(e.lastIndexOf(".")))||".rels"===r?"text":-1===e.indexOf("/media/")?"binarystring":"base64",n[e].async(t).then(function(r){return function(e){for(var t in o[r.toLowerCase()]=e,n)if(void 0===o[t.toLowerCase()])return;a.onFileLoad(o)}}(e)).catch(function(){a.qk()}))}},t.FileLoader=a},"./src/xlsx-io/password/aes.ts":function(e,t,r){"use strict";var l,i,n,h,f,d,u,c,p,g,m,b,y,C,w,v,S,x,T,o,a,s,A;function k(e){var t,r=[];for(t=0;t<e.length;t+=4)r.push(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]);return r}Object.defineProperty(t,"__esModule",{value:!0}),l=null,l=n=function(e){var t,r=[];if("number"==typeof e){for(t=0;t<e;t++)r.push(0);return r}for(t=0;t<e.length;t++)if(e[t]<0||256<=e[t]||"number"!=typeof e[t])throw Error("invalid byte ("+e[t]+":"+t+")");if(e.slice)return e.slice(0);for(t=0;t<e.length;t++)r.push(e[t]);return r},i=function(e,t,r,n,o){null===r&&(r=0),null===n&&(n=0),null===o&&(o=e.length);for(var i=n;i<o;i++)t[r++]=e[i]},h={16:10,24:12,32:14},f=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],d=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],u=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],c=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],p=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],g=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],m=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],b=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],y=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],C=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],w=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],v=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],S=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],x=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],T=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925],(o=function(e){if(!(this instanceof o))throw Error("AES must be instanitated with `new`");this.key=l(e),this.vk()}).prototype.vk=function(){var e,t,r,n,o,i,a,s,l,u,c=h[this.key.length];if(null===c)throw Error("invalid key size (must be 16, 24 or 32 bytes)");for(this.wk=[],this.xk=[],e=0;e<=c;e++)this.wk.push([0,0,0,0]),this.xk.push([0,0,0,0]);for(t=4*(c+1),r=this.key.length/4,n=k(this.key),e=0;e<r;e++)o=e>>2,this.wk[o][e%4]=n[e],this.xk[c-o][e%4]=n[e];for(i=0,a=r;a<t;){if(s=n[r-1],n[0]^=d[s>>16&255]<<24^d[s>>8&255]<<16^d[255&s]<<8^d[s>>24&255]^f[i]<<24,i+=1,8!=r)for(e=1;e<r;e++)n[e]^=n[e-1];else{for(e=1;e<r/2;e++)n[e]^=n[e-1];for(s=n[r/2-1],n[r/2]^=d[255&s]^d[s>>8&255]<<8^d[s>>16&255]<<16^d[s>>24&255]<<24,e=r/2+1;e<r;e++)n[e]^=n[e-1]}for(u=l=void(e=0);e<r&&a<t;)l=a>>2,u=a%4,this.wk[l][u]=n[e],this.xk[c-l][u]=n[e++],a++}for(l=1;l<c;l++)for(u=0;u<4;u++)s=this.xk[l][u],this.xk[l][u]=v[s>>24&255]^S[s>>16&255]^x[s>>8&255]^T[255&s]},o.prototype.encrypt=function(e){var t,r,n,o,i,a,s;if(16!==e.length)throw Error("invalid plaintext size (must be 16 bytes)");for(t=this.wk.length-1,r=[0,0,0,0],n=k(e),o=0;o<4;o++)n[o]^=this.wk[0][o];for(i=1;i<t;i++){for(o=0;o<4;o++)r[o]=c[n[o]>>24&255]^p[n[(o+1)%4]>>16&255]^g[n[(o+2)%4]>>8&255]^m[255&n[(o+3)%4]]^this.wk[i][o];n=r.slice(0)}for(a=l(16),o=0;o<4;o++)s=this.wk[t][o],a[4*o]=255&(d[n[o]>>24&255]^s>>24),a[4*o+1]=255&(d[n[(o+1)%4]>>16&255]^s>>16),a[4*o+2]=255&(d[n[(o+2)%4]>>8&255]^s>>8),a[4*o+3]=255&(d[255&n[(o+3)%4]]^s);return a},o.prototype.decrypt=function(e){var t,r,n,o,i,a,s;if(16!==e.length)throw Error("invalid ciphertext size (must be 16 bytes)");for(t=this.xk.length-1,r=[0,0,0,0],n=k(e),o=0;o<4;o++)n[o]^=this.xk[0][o];for(i=1;i<t;i++){for(o=0;o<4;o++)r[o]=b[n[o]>>24&255]^y[n[(o+3)%4]>>16&255]^C[n[(o+2)%4]>>8&255]^w[255&n[(o+1)%4]]^this.xk[i][o];n=r.slice(0)}for(a=l(16),o=0;o<4;o++)s=this.xk[t][o],a[4*o]=255&(u[n[o]>>24&255]^s>>24),a[4*o+1]=255&(u[n[(o+3)%4]>>16&255]^s>>16),a[4*o+2]=255&(u[n[(o+2)%4]>>8&255]^s>>8),a[4*o+3]=255&(u[255&n[(o+1)%4]]^s);return a},(a=function(e){if(!(this instanceof a))throw Error("AES must be instanitated with `new`");this.description="Electronic Code Block",this.name="ecb",this.yk=new o(e)}).prototype.encrypt=function(e){var t,r,n;if(e.length%16!=0)throw Error("invalid plaintext size (must be multiple of 16 bytes)");for(t=l(e.length),r=l(16),n=0;n<e.length;n+=16)i(e,r,0,n,n+16),r=this.yk.encrypt(r),i(r,t,n,0,16);return t},a.prototype.decrypt=function(e){var t,r,n;if(e.length%16!=0)throw Error("invalid ciphertext size (must be multiple of 16 bytes)");for(t=l(e.length),r=l(16),n=0;n<e.length;n+=16)i(e,r,0,n,n+16),r=this.yk.decrypt(r),i(r,t,n,0,16);return t},(s=function(e,t){if(!(this instanceof s))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Block Chaining",this.name="cbc",t){if(16!==t.length)throw Error("invalid initialation vector size (must be 16 bytes)")}else t=l([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);this.zk=l(t),this.yk=new o(e)}).prototype.encrypt=function(e){var t,r,n,o;if(e.length%16!=0)throw Error("invalid plaintext size (must be multiple of 16 bytes)");for(t=l(e.length),r=l(16),n=0;n<e.length;n+=16){for(i(e,r,0,n,n+16),o=0;o<16;o++)r[o]^=this.zk[o];this.zk=this.yk.encrypt(r),i(this.zk,t,n,0,16)}return t},s.prototype.decrypt=function(e){var t,r,n,o;if(e.length%16!=0)throw Error("invalid ciphertext size (must be multiple of 16 bytes)");for(t=l(e.length),r=l(16),n=0;n<e.length;n+=16){for(i(e,r,0,n,n+16),r=this.yk.decrypt(r),o=0;o<16;o++)t[n+o]=r[o]^this.zk[o];i(e,this.zk,0,n,n+16)}return t},A={ecb:a,cbc:s},t.aesJS={AES:o,ModeOfOperation:A,util:{Ak:n}}},"./src/xlsx-io/password/aesEngine.ts":function(e,t,r){"use strict";var h,w,f,n,l,s,v,M,S;function x(e){var t,r=h.Ha(),n=r&&r.atob&&r.atob(e),o=n?n.length:0,i=new Uint8Array(o);for(t=0;t<o;t++)i[t]=n.charCodeAt(t);return i}function I(e,t,r,n,o){var i,a=n;for(i=t;i<t+o;i++)r[a]=e[i],a++}function E(e){var t,r,n=[];for(t=0;t<e.length;++t)r=e.charCodeAt(t),n=n.concat([255&r,parseInt(r/256,10)>>>0]);return n}function d(e,t){for(var r=[];r[--e]=255&t,t>>=8,e;);return r.reverse()}function c(e,t,r){var n,o,i=l;switch(r){case"SHA1":i=s}for(n=[],o=0;o<e.length;o++)n.push(e[o]);return i.hash(n.concat(t))}function T(r){function e(e){var t=0;return h.BufferHelper.na(r,r.Bk,r.Bk+e).reverse().forEach(function(e){t=256*t+e}),r.Bk+=e,t}function t(e){var t=0;return h.BufferHelper.na(r,r.Bk,r.Bk+e).reverse().forEach(function(e){t=(t<<8)+e}),r.Bk+=e,t}function n(e){var t=h.BufferHelper.na(r,r.Bk,r.Bk+e);return r.Bk+=e,t}return{readUInt64:function(){return e(8)},readInt64:function(){return t(8)},readInt32:function(){return t(4)},readUInt32:function(){return e(4)},readInt16:function(){return t(2)},readUInt16:function(){return t(2)},readByte:function(){return n(1)},readBytes:function(e){return n(e)},readChars:function(e){var t=n(e),r=[];return t.forEach(function(e){r.push(String.fromCharCode(e))}),r},seek:function(e,t){t===M.Begin?r.Bk=e:t===M.Current?r.Bk+=e:t===M.End&&(r.Bk=r.length+e)}}}function R(i){function t(e,t){var r,n=d(e,t),o=i.Bk;for(r=0;r<n.length;r++)i[r+o]=n[r];i.Bk=o+e}return{writeBytes:function(e){var t,r=i.Bk;for(t=0;t<e.length;t++)i[t+r]=e[t];i.Bk=r+e.length},writeByte:function(e){this.writeBytes([e])},writeUshort:function(e){t(2,e)},writeShort:function(e){t(2,e)},writeInt:function(e){t(4,e)},writeUint:function(e){t(4,e)},writeLong:function(e){t(8,e)},seek:function(e,t){t===M.Begin?i.Bk=e:t===M.Current?i.Bk+=e:t===M.End&&(i.Bk=i.length+e)},getView:function(){return i}}}function p(e,t,r){var n,o,i=[];for(n=0;n<e;n++)for(i[n]=i[n]||[],o=0;o<t;o++)i[n][o]=r||0;return i}function g(e,t){var r=[];return r[0]=t[e[0]>>4][15&e[0]],r[1]=t[e[1]>>4][15&e[1]],r[2]=t[e[2]>>4][15&e[2]],r[3]=t[e[3]>>4][15&e[3]],r}function o(e){return e<128?(e<<1)%256:(e<<1^27)%256}function i(e){return(o(e)^e)%256}function a(e){return(o(o(o(e)))^e)%256}function u(e){return(o(o(o(e)))^o(e)^e)%256}function m(e){return(o(o(o(e)))^o(o(e))^e)%256}function b(e){return(o(o(o(e)))^o(o(e))^o(e))%256}function A(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m=[];return m.Bk=0,n=R(m),r<0&&(r=0),o=function(e){var t,r,n=[];for(t=0;t<128;t++)n[t]=0;return n.Bk=0,(r=R(n)).writeBytes(E("Root Entry")),r.seek(64,M.Begin),r.writeShort(22),r.writeByte(5),r.writeByte(0),r.writeInt(-1),r.writeInt(-1),r.writeInt(1),r.seek(100,M.Begin),r.writeInt(0),r.writeInt(0),r.writeInt(0),r.writeInt(0),r.writeInt(e),r.writeInt(832),r.getView()}(t),n.writeBytes(o),i=function(){var e,t,r=[];for(e=0;e<128;e++)r[e]=0;return r.Bk=0,(t=R(r)).writeBytes(E("EncryptionInfo")),t.seek(64,M.Begin),t.writeShort(30),t.writeByte(2),t.writeByte(1),t.writeInt(3),t.writeInt(2),t.writeInt(-1),t.seek(100,M.Begin),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(248),t.getView()}(),n.writeBytes(i),a=function(e,t){var r,n,o=[];for(r=0;r<128;r++)o[r]=0;return o.Bk=0,(n=R(o)).writeBytes(E("EncryptedPackage")),n.seek(64,M.Begin),n.writeShort(34),n.writeByte(2),n.writeByte(0),n.writeInt(-1),n.writeInt(-1),n.writeInt(-1),n.seek(100,M.Begin),n.writeInt(0),n.writeInt(0),n.writeInt(0),n.writeInt(0),n.writeInt(e),n.writeInt(t),n.getView()}(e,r),n.writeBytes(a),s=function(){var e,t,r=[];for(e=0;e<128;e++)r[e]=0;return r.Bk=0,(t=R(r)).writeShort(6),t.writeBytes(E("DataSpaces")),t.seek(64,M.Begin),t.writeShort(24),t.writeByte(1),t.writeByte(0),t.writeInt(-1),t.writeInt(-1),t.writeInt(5),t.seek(100,M.Begin),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.getView()}(),n.writeBytes(s),l=function(){var e,t,r=[];for(e=0;e<128;e++)r[e]=0;return r.Bk=0,(t=R(r)).writeBytes(E("Version")),t.seek(64,M.Begin),t.writeShort(16),t.writeByte(2),t.writeByte(1),t.writeInt(-1),t.writeInt(-1),t.writeInt(-1),t.seek(100,M.Begin),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(4),t.writeInt(76),t.getView()}(),n.writeBytes(l),u=function(){var e,t,r=[];for(e=0;e<128;e++)r[e]=0;return r.Bk=0,(t=R(r)).writeBytes(E("DataSpaceMap")),t.seek(64,M.Begin),t.writeShort(26),t.writeByte(2),t.writeByte(1),t.writeInt(4),t.writeInt(6),t.writeInt(-1),t.seek(100,M.Begin),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(6),t.writeInt(112),t.getView()}(),n.writeBytes(u),c=function(){var e,t,r=[];for(e=0;e<128;e++)r[e]=0;return r.Bk=0,(t=R(r)).writeBytes(E("DataSpaceInfo")),t.seek(64,M.Begin),t.writeShort(28),t.writeByte(1),t.writeByte(1),t.writeInt(-1),t.writeInt(8),t.writeInt(7),t.seek(100,M.Begin),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.getView()}(),n.writeBytes(c),h=function(){var e,t,r=[];for(e=0;e<128;e++)r[e]=0;return r.Bk=0,(t=R(r)).writeBytes(E("StrongEncryptionDataSpace")),t.seek(64,M.Begin),t.writeShort(52),t.writeByte(2),t.writeByte(1),t.writeInt(-1),t.writeInt(-1),t.writeInt(-1),t.seek(100,M.Begin),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(8),t.writeInt(64),t.getView()}(),n.writeBytes(h),f=function(){var e,t,r=[];for(e=0;e<128;e++)r[e]=0;return r.Bk=0,(t=R(r)).writeBytes(E("TransformInfo")),t.seek(64,M.Begin),t.writeShort(28),t.writeByte(1),t.writeByte(0),t.writeInt(-1),t.writeInt(-1),t.writeInt(9),t.seek(100,M.Begin),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.getView()}(),n.writeBytes(f),d=function(){var e,t,r=[];for(e=0;e<128;e++)r[e]=0;return r.Bk=0,(t=R(r)).writeBytes(E("StrongEncryptionTransform")),t.seek(64,M.Begin),t.writeShort(52),t.writeByte(1),t.writeByte(1),t.writeInt(-1),t.writeInt(-1),t.writeInt(10),t.seek(100,M.Begin),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.getView()}(),n.writeBytes(d),p=function(){var e,t,r=[];for(e=0;e<128;e++)r[e]=0;return r.Bk=0,(t=R(r)).writeShort(6),t.writeBytes(E("Primary")),t.seek(64,M.Begin),t.writeShort(18),t.writeByte(2),t.writeByte(1),t.writeInt(-1),t.writeInt(-1),t.writeInt(-1),t.seek(100,M.Begin),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(0),t.writeInt(9),t.writeInt(208),t.getView()}(),n.writeBytes(p),g=function(){var e,t,r=[];for(e=0;e<128;e++)r[e]=0;return r.Bk=0,(t=R(r)).seek(64,M.Begin),t.writeShort(0),t.writeShort(0),t.writeInt(-1),t.writeInt(-1),t.writeInt(-1),t.getView()}(),n.writeBytes(g),n.getView()}function k(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k=[];for(k.Bk=0,r=R(k),n=0,o=Array(256),null!==e&&I(e,0,o,0,e.length),r.writeBytes(o),i=parseInt(o.length/64,10),0<o.length%64&&i++,a=1;a<i;a++)t.push(a);for(t.push(-2),n+=i,s=Array(128),C=y=void 0,(C=[]).Bk=0,(y=R(C)).writeInt(60),y.writeBytes(E("Microsoft.Container.DataSpaces")),y.writeInt(1),y.writeInt(1),y.writeInt(1),I(l=y.getView(),0,s,0,l.length),r.writeBytes(s),u=parseInt(s.length/64,10),0<s.length%64&&u++,a=1;a<u;a++)t.push(a+n);for(t.push(-2),n+=u,c=Array(128),v=w=void 0,(v=[]).Bk=0,(w=R(v)).writeUint(8),w.writeUint(1),w.writeUint(104),w.writeUint(1),w.writeUint(0),w.writeUint(32),w.writeBytes(E("EncryptedPackage")),w.writeUint(50),w.writeBytes(E("StrongEncryptionDataSpace")),w.writeShort(0),I(h=w.getView(),0,c,0,h.length),r.writeBytes(c),f=parseInt(c.length/64,10),0<c.length%64&&f++,a=1;a<f;a++)t.push(a+n);for(t.push(-2),n+=f,x=S=void 0,(x=[]).Bk=0,(S=R(x)).writeUint(8),S.writeUint(1),S.writeUint(50),S.writeBytes(E("StrongEncryptionTransform")),S.writeShort(0),d=S.getView(),r.writeBytes(d),p=parseInt(d.length/64,10),0<d.length%64&&p++,a=1;a<p;a++)t.push(a+n);for(t.push(-2),n+=p,g=Array(448),A=T=void 0,(A=[]).Bk=0,(T=R(A)).writeUint(108),T.writeUint(1),T.writeInt(76),T.writeBytes(E("{FF9A3F03-56EF-4613-BDD5-5A41C1D07246}")),T.writeInt(78),T.writeBytes(E("Microsoft.Container.EncryptionTransform")),T.writeShort(0),T.writeInt(1),T.writeInt(1),T.writeInt(1),T.writeInt(7),T.writeBytes(E("AES128")),T.writeByte(0),T.writeInt(16),T.writeInt(0),T.writeInt(4),I(m=T.getView(),0,g,0,m.length),r.writeBytes(g),b=parseInt(m.length/64,10),0<m.length%64&&b++,a=1;a<b;a++)t.push(a+n);if(t.push(-2),t.length<128)for(a=t.length;a<128;a++)t.push(-1);return r.seek(0,M.Begin),r.getView()}function y(e,t,r){var n,o;for(n=0;n<4;++n)for(o=0;o<4;++o)t[n][o]=(t[n][o]^r[4*e+o][n])%256;return t}function C(e,t){var r,n,o=p(4,4,0);for(r=0;r<4;++r)for(n=0;n<4;++n)o[r][n]=e[r][n];for(r=1;r<4;++r)for(n=0;n<4;++n)e[r][n]=o[r][(n+r)%t];return e}function D(e){var t,r,n=p(4,4,0);for(t=0;t<4;++t)for(r=0;r<4;++r)n[t][r]=e[t][r];for(r=0;r<4;++r)e[0][r]=(o(n[0][r])^i(n[1][r])^n[2][r]^n[3][r])%256,e[1][r]=(n[0][r]^o(n[1][r])^i(n[2][r])^n[3][r])%256,e[2][r]=(n[0][r]^n[1][r]^o(n[2][r])^i(n[3][r]))%256,e[3][r]=(i(n[0][r])^n[1][r]^n[2][r]^o(n[3][r]))%256;return e}function N(e,t){var r,n;for(r=0;r<4;++r)for(n=0;n<4;++n)e[r][n]=t[e[r][n]>>4][15&e[r][n]];return e}function F(){this.salt=Array(16),this.pwdVerifier=Array(16),this.pwdVerifierHash=Array(32),this.blockLen=16,this.Ck=!1,this.hashAlgorithm="SHA1",this.cipherChaining="ChainingModeCBC",this.cipherAlgorithm="AES",this.iterator=1e5,this.blockSize=16,this.keyBits=128,this.saltSize=16,this.hashSize=20,this.encryptedKeyValueBlockKey=[20,110,11,231,171,172,208,214],this.encryptedVerifierHashInputBlockKey=[254,167,210,118,59,75,158,121],this.encryptedVerifierHashValueBlockKey=[215,170,15,109,48,97,52,78]}Object.defineProperty(t,"__esModule",{value:!0}),h=r("./src/common/common.ts"),w=r("./src/xml-io/xml-parser.ts"),f=r("./src/xlsx-io/password/aes.ts"),n=r("./src/xml-io/node-helper.ts"),l=r("./src/xlsx-io/password/sha512.js"),s=r("./src/xlsx-io/password/sha1.js"),v=n.XmlNodeHelper.qe,M={Begin:0,Current:1,End:2},S={Bits128:"Bits128",Bits192:"Bits192",Bits256:"Bits256"},F.prototype.Dk=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C;return e.Bk=0,r=(t=T(e)).readInt16(),n=t.readInt16(),3!==r&&4!==r||2!==n?4===r&&4===n&&64===t.readUInt32()&&null!==(s=t.readBytes(e.length-8))&&(l=w.parseXmlToObject(String.fromCharCode.apply(null,s)),u={},c=l.encryption,h=[],f=c.keyData,(d={}).SaltSize=f.pe.saltSize?f.pe.saltSize:16,d.BlockSize=f.pe.blockSize?f.pe.blockSize:16,d.KeyBits=f.pe.keyBits?f.pe.keyBits:128,d.HashSize=f.pe.hashSize?f.pe.hashSize:20,d.CipherAlgorithm=f.pe.cipherAlgorithm?f.pe.cipherAlgorithm:"AES",d.CipherChaining=f.pe.cipherChaining?f.pe.cipherChaining:"ChainingModeCBC",d.HashAlgorithm=f.pe.hashAlgorithm?f.pe.hashAlgorithm:"SHA1",d.SaltValue=x(f.pe.saltValue),u.KeyData=d,p=c.dataIntegrity,(g={}).EncryptedHmacKey=p.pe.encryptedHmacKey,g.EncryptedHmacValue=p.pe.encryptedHmacValue,u.DataIntegrity=g,m=c.keyEncryptors,(b={}).Uri=m.pe.uri?m.pe.uri:"http://schemas.microsoft.com/office/2006/keyEncryptor/password",b.Any={},(y=v(m.keyEncryptor))&&y.length&&y.forEach(function(e){var t=e["p:encryptedKey"];b.Any.SpinCount=t.pe.spinCount?t.pe.spinCount:1e5,b.Any.SaltSize=t.pe.saltSize?t.pe.saltSize:16,b.Any.BlockSize=t.pe.blockSize?t.pe.blockSize:16,b.Any.KeyBits=t.pe.keyBits?t.pe.keyBits:128,b.Any.HashSize=t.pe.hashSize?t.pe.hashSize:20,b.Any.CipherAlgorithm=t.pe.cipherAlgorithm?t.pe.cipherAlgorithm:"AES",b.Any.CipherChaining=t.pe.cipherChaining?t.pe.cipherChaining:"ChainingModeCBC",b.Any.HashAlgorithm=t.pe.hashAlgorithm?t.pe.hashAlgorithm:"SHA1",b.Any.SaltValue=x(t.pe.saltValue),b.Any.EncryptedVerifierHashInput=x(t.pe.encryptedVerifierHashInput),b.Any.EncryptedVerifierHashValue=x(t.pe.encryptedVerifierHashValue),b.Any.EncryptedKeyValue=x(t.pe.encryptedKeyValue),h.push(b),u.KeyEncryptors=h}),C=u.KeyEncryptors[0].Any,this.iterator=parseInt(C.SpinCount,10),this.blockSize=C.BlockSize,this.saltSize=C.SaltSize,this.hashSize=C.HashSize,this.keyBits=C.KeyBits,this.hashAlgorithm=C.HashAlgorithm,this.cipherAlgorithm=C.CipherAlgorithm,this.cipherChaining=C.CipherChaining,this.encryptedKeyValue=C.EncryptedKeyValue,this.encryptedVerifierHashInput=C.EncryptedVerifierHashInput,this.encryptedVerifierHashValue=C.EncryptedVerifierHashValue,this.salt=C.SaltValue,this.saltForIV=u.KeyData.SaltValue,this.Ck=!0,"AES"===this.cipherAlgorithm):(t.seek(8,M.Begin),o=t.readUInt32()+12,t.seek(28,M.Begin),128===(i=t.readInt32())?this.keySize=S.Bits128:192===i?this.keySize=S.Bits192:256===i&&(this.keySize=S.Bits256),t.seek(o,M.Begin),a=t.readInt32(),o+=4,t.seek(o,M.Begin),this.salt=t.readBytes(a),o+=a,t.seek(o,M.Begin),this.pwdVerifier=t.readBytes(a),o+=a,t.seek(o,M.Begin),t.readInt32(),o+=4,t.seek(o,M.Begin),this.pwdVerifierHash=t.readBytes(2*a),!0)},F.prototype.Ek=function(e){var t,r,n,o,i,a,s;for(this.userPassWord=e,t=this.Fk(this.salt,null,this.blockSize),r=this.Gk(e,this.encryptedVerifierHashInputBlockKey,this.salt),n=this.Hk(this.saltSize,r,this.encryptedVerifierHashInput,t),I(n=l.hash(n),0,o=Array(this.saltSize),0,this.saltSize),r=this.Gk(e,this.encryptedVerifierHashValueBlockKey,this.salt),i=this.Ik(o,r,t),(a=this.encryptedVerifierHashValue.length)>i.length&&(a=i.length),s=0;s<a;s++)if(i[s]!==this.encryptedVerifierHashValue[s])return!1;return!0},F.prototype.Ik=function(e,t,r){return new f.aesJS.ModeOfOperation.cbc(t,r).encrypt(e)},F.prototype.Hk=function(e,t,r,n){var o,i,a,s,l=[],u=0,c=parseInt(r.length/4096,10);for(i=0;i<c;i++)o=n||this.Fk(this.saltForIV,d(4,i),this.blockSize),I(new f.aesJS.ModeOfOperation.cbc(t,o).decrypt(h.BufferHelper.na(r,u,u+4096)),0,l,u,4096),u+=4096;return 0<(a=r.length%4096)&&(o=n||this.Fk(this.saltForIV,d(4,c),this.blockSize),I(new f.aesJS.ModeOfOperation.cbc(t,o).decrypt(h.BufferHelper.na(r,u,u+a)),0,l,u,a)),I(l,0,s=Array(e),0,e),s},F.prototype.Fk=function(e,t,r){var n,o,i,a=e;for(null!==t&&(a=c(a,t,this.hashAlgorithm)),r=+r,n=new Uint8Array(r),o=a.length,I(a,0,n,0,Math.min(r,o)),i=o;i<r;i++)n[i]=54;return n},F.prototype.Gk=function(e,t,r){var n,o,i,a,s,l,u=c(r,function(e){var t,r,n=[];for(r=0;r<e.length;++r)t=e.charCodeAt(r),n.push(255&t),n.push((65280&t)>>8);return n}(e),this.hashAlgorithm);for(n=0;n<this.iterator;n++)u=c(d(4,n),u,this.hashAlgorithm);for(u=c(u,t,this.hashAlgorithm),o=this.keyBits/8,i=[],a=u.length,s=Math.min(a,o),l=0;l<s;l++)i[l]=u[l];for(n=a;n<o;n++)i[n]=54;return i},F.prototype.Jk=function(e){var t,r,n,o,i={success:!1};return null===e||(e.Bk=0,r=(t=T(e)).readUInt64(),n=t.readBytes(e.length-8),this.Kk(this.userPassWord),null!==(o=this.Hk(r,this.key,n,null))&&(i.data=o,i.success=!0)),i},F.prototype.Kk=function(e){var t=this.Gk(e,this.encryptedKeyValueBlockKey,this.salt),r=this.Fk(this.salt,null,this.blockSize),n=this.keyBits/8;this.key=this.Hk(n,t,this.encryptedKeyValue,r)},F.prototype.Lk=function(e){var t,r,n,o;return!!e&&(e.Bk=0,r=(t=T(e)).readInt64(),n=t.readBytes(e.length-8),I(new f.aesJS.ModeOfOperation.ecb(this.key).decrypt(n)||null,0,o=Array(r),0,o.length),{success:!0,data:o})},F.prototype.Mk=function(e,t,r){var n,o,i,a=c(t,E(e),r);for(n=0;n<5e4;n++)a=c(d(4,n),a,r);for(a=c(a,d(4,0),r),o=[],n=0;n<64;n++)o[n]=54;for(n=0;n<a.length;n++)o[n]^=a[n];return I(a=s.hash(o),0,i=[],0,16),i},F.prototype.Ok=function(e){var t,r;if(e&&!(256<e.length))return(t=[]).Bk=0,(r=R(t)).writeUshort(3),r.writeUshort(2),r.writeInt(36),r.writeUint(164),r.writeInt(36),r.writeInt(0),r.writeInt(26126),r.writeInt(32772),r.writeUint(128),r.writeInt(24),r.writeLong(0),r.writeBytes(E("Microsoft Enhanced RSA and AES Cryptographic Provider (Prototype)")),r.writeShort(0),r.writeInt(16),this.Pk(e),this.Qk()&&(r.writeBytes(this.salt),r.writeBytes(this.pwdVerifier),r.writeUint(20),r.writeBytes(this.pwdVerifierHash)),r.seek(0,M.Begin),r.getView()},F.prototype.Pk=function(e){var t,r,n=[],o=[];for(t=0;t<this.blockLen;t++)n[t]=parseInt(255*Math.random(),10),o[t]=parseInt(255*Math.random(),10);return this.salt=n,this.key=this.Mk(e,this.salt,this.hashAlgorithm),this.Rk(S.Bits128,this.key),r=s.hash(o),this.pwdVerifier=this.Sk(o),this.pwdVerifierHash=this.Sk(r),!0},F.prototype.Rk=function(e,t){this.Nb=4,e===S.Bits128?(this.Nk=4,this.Nr=10):e===S.Bits192?(this.Nk=6,this.Nr=12):e===S.Bits256&&(this.Nk=8,this.Nr=14),this.key=[].concat(t),this.Sbox=[[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118],[202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192],[183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21],[4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117],[9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132],[83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207],[208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168],[81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210],[205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115],[96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219],[224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121],[231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8],[186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138],[112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158],[225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223],[140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]],this.iSbox=[[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251],[124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203],[84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78],[8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37],[114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146],[108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132],[144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6],[208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107],[58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115],[150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110],[71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27],[252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244],[31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95],[96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239],[160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97],[23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125]],this.Rcon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],this.w=function(e,t,r,n,o,i){var a,s,l,u,c,h=p(e*(t+1),4,0);for(a=0;a<r;++a)h[a][0]=n[4*a],h[a][1]=n[4*a+1],h[a][2]=n[4*a+2],h[a][3]=n[4*a+3];for(s=[],a=r;a<e*(t+1);++a)s[0]=h[a-1][0],s[1]=h[a-1][1],s[2]=h[a-1][2],s[3]=h[a-1][3],a%r==0?(s=g((c=void 0,(c=[])[0]=(u=s)[1],c[1]=u[2],c[2]=u[3],c[3]=u[0],c),i),l=o[parseInt(a/r,10)],s[0]=(s[0]^l[0])%256,s[1]=(s[1]^l[1])%256,s[2]=(s[2]^l[2])%256,s[3]=(s[3]^l[3])%256):6<r&&a%r==4&&(s=g(s)),h[a][0]=(h[a-r][0]^s[0])%256,h[a][1]=(h[a-r][1]^s[1])%256,h[a][2]=(h[a-r][2]^s[2])%256,h[a][3]=(h[a-r][3]^s[3])%256;return h}(this.Nb,this.Nr,this.Nk,this.key,this.Rcon,this.Sbox)},F.prototype.Sk=function(e){var t,r,n,o,i=e.length,a=e.length%this.blockLen;for(0!=a&&(i+=this.blockLen-a),I(e,0,t=[],0,e.length),r=[],n=[],o=0;o<i;o+=this.blockLen)I(t,o,r,0,this.blockLen),this.Tk(r,n),I(n,0,t,o,this.blockLen);return t},F.prototype.Tk=function(e,t){var r,n;for(this.State=p(4,this.Nb),r=0;r<4*this.Nb;++r)this.State[r%4][parseInt(r/4,10)]=e[r];for(this.State=y(0,this.State,this.w),n=1;n<=this.Nr-1;++n)this.State=N(this.State,this.Sbox),this.State=C(this.State,this.Nb),this.State=D(this.State),this.State=y(n,this.State,this.w);for(this.State=N(this.State,this.Sbox),this.State=C(this.State,this.Nb),this.State=y(this.Nr,this.State,this.w),r=0;r<4*this.Nb;++r)t[r]=this.State[r%4][parseInt(r/4,10)]},F.prototype.Qk=function(){var e,t=s,r=this.Uk(this.pwdVerifier),n=this.Uk(this.pwdVerifierHash);for(r=t.hash(r),e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0},F.prototype.Uk=function(e){var t,r,n,o,i,a;if(null===e)return null;if(t=e.length,e.length%this.blockLen==0&&!(t>e.length)){for(r=[],n=[],o=[],i=0;i<e.length;i+=this.blockLen)I(e,i,n,0,this.blockLen),this.Vk(n,o),I(o,0,r,i,0<(a=i+this.blockLen-t)?this.blockLen-a:this.blockLen);return r}},F.prototype.Vk=function(e,t){var r,n;for(this.State=p(4,this.Nb),r=0;r<4*this.Nb;++r)this.State[r%4][parseInt(r/4,10)]=e[r];for(this.State=y(this.Nr,this.State,this.w),n=this.Nr-1;1<=n;--n)this.Wk(),this.Xk(),this.State=y(n,this.State,this.w),this.Yk();for(this.Wk(),this.Xk(),this.State=y(0,this.State,this.w),r=0;r<4*this.Nb;++r)t[r]=this.State[r%4][parseInt(r/4,10)]},F.prototype.Wk=function(){var e,t,r=p(4,4);for(e=0;e<4;++e)for(t=0;t<4;++t)r[e][t]=this.State[e][t];for(e=1;e<4;++e)for(t=0;t<4;++t)this.State[e][(t+e)%this.Nb]=r[e][t]},F.prototype.Xk=function(){var e,t;for(e=0;e<4;++e)for(t=0;t<4;++t)this.State[e][t]=this.iSbox[this.State[e][t]>>4][15&this.State[e][t]]},F.prototype.Yk=function(){var e,t,r=p(4,4);for(e=0;e<4;++e)for(t=0;t<4;++t)r[e][t]=this.State[e][t];for(t=0;t<4;++t)this.State[0][t]=(b(r[0][t])^u(r[1][t])^m(r[2][t])^a(r[3][t]))%256,this.State[1][t]=(a(r[0][t])^b(r[1][t])^u(r[2][t])^m(r[3][t]))%256,this.State[2][t]=(m(r[0][t])^a(r[1][t])^b(r[2][t])^u(r[3][t]))%256,this.State[3][t]=(u(r[0][t])^m(r[1][t])^a(r[2][t])^b(r[3][t]))%256},F.prototype.Zk=function(e){var t,r,n,o,i,a=new Uint8Array(e);return a.Bk=0,t=T(a),r=a.length,n=t.readBytes(r),o=this.Sk(n),i=[],I(d(8,r),0,i,0,8),I(o,0,i,8,o.length),t.seek(0,M.Begin),i},F.prototype.$k=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T=[];for(T.Bk=0,r=R(T),n=0,o=[],i=[],a=[],s=Math.max(t.length,4096),l=parseInt(t.length/512,10),0<t.length%512&&l++,u=4*(l+6),c=parseInt(u/512,10),0<u%512&&c++,f=!(h=0);f;)p=d=0,f=!1,u=4*(l+6+c+h),d=parseInt(u/512,10),0<u%512&&d++,c<d?(c=d,f=!0):109<c&&(g=4*(c-109),p=parseInt(g/512,10),0<(m=g%512)&&p++,512<m+4*p&&p++,h<p&&(h=p,f=!0));if(0<h)for(b=128*h+109,n=y=0;n<b;n++)n<c?(0<(C=n-109)&&C%128==0&&o.push(++y),o.push(n+h)):o.push(-1);else for(n=0;n<109;n++)n<c?o.push(n):o.push(-1);if((w=0)<c){for(n=1;n<=h;n++)i.push(-4);for(w=h,n=1;n<=c;n++)i.push(-3);for(w+=c,n=1;n<1;n++)i.push(n);for(i.push(-2),w+=1,n=1;n<3;n++)i.push(n+w);for(i.push(-2),w+=3,n=1;n<2;n++)i.push(n+w);for(i.push(-2),w+=2,n=1;n<l;n++)i.push(n+w);i.push(-2)}for(r.writeInt(3759263696),r.writeInt(3776623009),r.writeLong(0),r.writeLong(0),r.writeShort(62),r.writeShort(3),r.writeShort(-2),r.writeShort(9),r.writeInt(6),r.writeInt(0),r.writeInt(0),r.writeInt(c),r.writeInt(h+c+1),r.writeInt(0),r.writeInt(4096),r.writeInt(c+h),r.writeInt(1),0<h?(r.writeInt(0),r.writeInt(h)):(r.writeInt(-2),r.writeInt(0)),o.forEach(function(e){r.writeInt(e)}),v=0;v<128*c;v++)v<i.length?r.writeInt(i[v]):r.writeInt(-1);return S=k(e,a),a.forEach(function(e){r.writeInt(e)}),x=A(w,w-2,s),r.writeBytes(x),r.writeBytes(S),r.writeBytes(t),{success:!0,data:r.getView()}},t.AesEngine=F},"./src/xlsx-io/password/compoundFile.ts":function(e,t,r){"use strict";var i,a,n,s,u,c,o,l,h,f;function d(e){this.Bk=0,this.Fl=new l,this.El=new f,this.Gl=new h,this.Hl=new h,this.Il=new h;var t=new o;t.setName(s),t.cl=a.Stream,t.Jl=n.Black,t.fl=-1,e||(t.Kl=(new Date).getTime(),t.Ll=(new Date).getTime()),t.dl=-1,t.el=-1,t.fl=-1,t.cl=a.RootStorage,t.gl=-2,t.il=0,t.Bytes=null,this.El.add(t)}function p(){this.El=[]}function g(){this.Dl=[]}function m(){this.kl=0xe11ab1a1e011d000,this.ll=62,this.ml=3,this.nl=65534,this.ol=9,this.pl=6,this.ql=0,this.rl=0,this.sl=0,this.ul=0,this.vl=0,this.wl=0,this.xl=4096,this.yl=-2,this.zl=0,this.Al=-2,this.Bl=0,this.Cl=[]}Object.defineProperty(t,"__esModule",{value:!0}),i=r("./src/common/common.ts"),a={Unknown:0,Storage:1,Stream:2,RootStorage:5},n={Red:0,Black:1},s="Root Entry",u=512,c=64,(o=function(){this._k=Array(32),this.al=0,this.cl=5,this.dl=-1,this.el=-1,this.fl=-1,this.gl=-1,this.il=0,this.jl=[]}).prototype={getName:function(){var r="";for(this._k.forEach(function(e){var t=e.indexOf("\0");r+=-1!==t?e.substring(0,t):e});0<r.length&&0===r[r.length-1];)r.substring(0,r.length-2);return r},setName:function(e){for(var t=0;t<this._k.length&&t<e.length;t++)this._k[t]=e[t];this.al=Math.min(2*this._k.length,2*(e.length+1))},read:function(e){switch(this._k=e.readChars(this._k.length),this.al=e.readInt16(),this.getName()){case"R":this.setName(s);break;case"Book":this.setName("Workbook")}this.cl=e.readByte()[0],e.readByte(),this.dl=e.readInt32(),this.el=e.readInt32(),this.fl=e.readInt32(),e.readInt32(),e.readInt32(),e.readInt32(),e.readInt32(),e.readInt32(),e.readInt64(),e.readInt64(),this.gl=e.readInt32(),this.il=e.readInt32(),e.readInt32()}},m.prototype.sectorSize=function(){return Math.pow(2,this.ol)},m.prototype.minisectorSize=function(){return Math.pow(2,this.pl)},m.prototype.read=function(e){var t,r;if(this.kl=e.readUInt64(),e.readInt32(),e.readInt32(),e.readInt32(),e.readInt32(),this.ll=e.readUInt16(),this.ml=e.readUInt16(),3<this.ml)return!1;for(this.nl=e.readUInt16(),this.ol=e.readInt16(),this.pl=e.readInt32(),this.ql=e.readInt32(),this.rl=e.readInt16(),this.sl=e.readInt16(),this.ul=e.readInt32(),this.vl=e.readInt32(),this.wl=e.readInt32(),this.xl=e.readInt32(),this.yl=e.readInt32(),this.zl=e.readInt32(),this.Al=e.readInt32(),this.Bl=e.readInt32(),t=Math.min(this.ul,109),this.Cl=[],r=0;r<t;r++)this.Cl[r]=e.readInt32()},l=m,g.prototype.length=function(){return this.Dl.length},g.prototype.getList=function(){return this.Dl},g.prototype.getSectorList=function(e){for(var t=[],r=e;r<=-6||-1<r;)t.push(r),r=this.Dl[r];return t},g.prototype.addRange=function(e){var t=this;e&&e.length&&e.forEach(function(e){t.Dl.push(e)})},g.prototype.read=function(e,t){for(var r=0;r<t;r++)this.Dl.push(e.readInt32())},h=g,p.prototype.add=function(e){e.getName()===s?this.El.splice(0,0,e):this.El.push(e)},p.prototype.clear=function(){this.El=[]},p.prototype.length=function(){return this.El.length},p.prototype.entries=function(){return this.El},p.prototype.read=function(e,t){var r,n;for(r=0;r<t;r++)(n=new o).read(e),this.El.push(n)},f=p,d.prototype.Ml=function(e,t){var r,n,o,i;for(1===arguments.length&&(t=s),r=-1,n=0;n<this.El.length();n++)if((o=this.El.entries()[n]).getName()===t&&(o.cl===a.Storage||o.cl===a.RootStorage)){r=n;break}if(-1===r)return null;if(-1===this.El.entries()[r].fl)return null;for((i=[]).push(this.El.entries()[r].fl),this.Nl(this.El.entries()[r].fl,i),n=0;n<i.length;n++)if((o=this.El.entries()[i[n]]).getName()===e&&o.cl===a.Stream)return o.jl;return null},d.prototype.Nl=function(e,t){-1!==this.El.entries()[e].dl&&(t.push(this.El.entries()[e].dl),this.Nl(this.El.entries()[e].dl,t)),-1!==this.El.entries()[e].el&&(t.push(this.El.entries()[e].el),this.Nl(this.El.entries()[e].el,t))},d.prototype.Xj=function(e){this.view=e;var t=this.Ol();this.Pl(t),this.Ql(t),this.Rl(t)},d.prototype.Pl=function(e){this.Fl.read(e),u=this.Fl.sectorSize(),c=this.Fl.minisectorSize()},d.prototype.Ql=function(e){var t,r,n,o,i;for(this.Gl.addRange(this.Fl.Cl),t=this.Fl.ul-(this.Fl.Cl?this.Fl.Cl.length:0),r=this.Fl.Al,n=(u-4)/4;0<t;)this.Sl(r),this.Gl.read(e,Math.min(n,t)),0<(t-=Math.min(n,t))&&(r=e.readInt32());for(o=0;o<this.Gl.length();o++)this.Sl(this.Gl.getList()[o]),this.Hl.read(e,u/4);for(i=this.Hl.getSectorList(this.Fl.yl),o=0;o<i.length;o++)this.Sl(i[o]),this.Il.read(e,u/4)},d.prototype.Rl=function(e){var t,r,n,o,i;for(this.El.clear(),t=this.Fl.vl,r=this.Hl.getSectorList(t),n=0;n<r.length;n++)this.Sl(r[n]),this.El.read(e,u/128);if((o=this.El.entries()[0]).getName()===s.replace(" ","")&&o.setName(s),o.getName()===s)for(n=1;n<this.El.length();n++)(i=this.El.entries()[n]).cl===a.Stream&&(i.jl=this.Tl(i,e))},d.prototype.Tl=function(e,t){return null===e?null:e.il<this.Fl.xl?this.Ul(e.gl,e.il,t):this.Vl(e.gl,e.il,t)},d.prototype.Ul=function(e,t,r){var n,o,i,a,s=[],l=this.Il.getSectorList(e);for(n=0;n<l.length;n++)for(this.Wl(l[n]),o=c,n===l.length-1&&t%c!=0&&(o=t%c),i=r.readBytes(o),a=0;a<i.length;a++)s.push(i[a]);return s},d.prototype.Sl=function(e){this.Bk=512+this.Fl.sectorSize()*e},d.prototype.Wl=function(e){var t=u/c,r=Math.floor(e/t),n=this.Hl.getSectorList(this.El.entries()[0].gl);this.Sl(n[r]),this.Bk+=e%t*c},d.prototype.Vl=function(e,t,r){var n,o,i,a,s=function(e){var t,r={StartSectorIndex:0,SectorCount:0},n=[];for(t=0;t<e.length;t++)0===r.SectorCount?(r.StartSectorIndex=e[t],r.SectorCount=1):e[t]===r.SectorCount+r.StartSectorIndex?r.SectorCount+=1:(n.push(r),r.SectorCount=0,t--);return n.push(r),n}(this.Hl.getSectorList(e)),l=[];for(n=0;n<s.length;n++)for(this.Sl(s[n].StartSectorIndex),o=u*s[n].SectorCount,n===s.length-1&&t%u!=0&&(o-=u-t%u),o=Math.min(o,this.view.length-this.Bk),i=r.readBytes(o),a=0;a<i.length;a++)l.push(i[a]);return l},d.prototype.Ol=function(){function r(e){var t,r=[];for(t=0;t<e.length;t++)r[t]=e[e.length-t-1];return r}function e(e){var t=0;return r(i.BufferHelper.na(n.view,n.Bk,n.Bk+e)).forEach(function(e){t=256*t+e}),n.Bk+=e,t}function t(e){var t=0;return r(i.BufferHelper.na(n.view,n.Bk,n.Bk+e)).forEach(function(e){t=(t<<8)+e}),n.Bk+=e,t}function o(e){var t=i.BufferHelper.na(n.view,n.Bk,n.Bk+e);return n.Bk+=e,t}var n=this;return{readUInt64:function(){return e(8)},readInt64:function(){return t(8)},readInt32:function(){return t(4)},readUInt32:function(){return e(4)},readInt16:function(){return t(2)},readUInt16:function(){return t(2)},readByte:function(){return o(1)},readBytes:function(e){return o(e)},readChars:function(e){var t,r,n=[];for(t=0;t<e;t++)r=o(2),n.push(String.fromCharCode.apply(null,r));return n}}},t.CompoundFile=d},"./src/xlsx-io/password/sha1.js":function(n,e){!function(e){"use strict";function t(e){var t,r,n,o,i,a,s,l,u=0,c=!1,h=0,f=0,d=0,p=e.length,g=1732584193,m=4023233417,b=2562383102,y=271733878,C=3285377520;do{for(S[0]=u,S[16]=S[1]=S[2]=S[3]=S[4]=S[5]=S[6]=S[7]=S[8]=S[9]=S[10]=S[11]=S[12]=S[13]=S[14]=S[15]=0,r=f;h<p&&r<64;++h)S[r>>2]|=e[h]<<v[3&r++];for(d+=r-f,f=r-64,h===p&&(S[r>>2]|=w[3&r],++h),u=S[16],p<h&&r<56&&(S[15]=d<<3,c=!0),n=16;n<80;++n)t=S[n-3]^S[n-8]^S[n-14]^S[n-16],S[n]=t<<1|t>>>31;for(o=g,i=m,a=b,s=y,l=C,n=0;n<20;n+=5)o=(t=(i=(t=(a=(t=(s=(t=(l=(t=o<<5|o>>>27)+(i&a|~i&s)+l+1518500249+S[n]<<0)<<5|l>>>27)+(o&(i=i<<30|i>>>2)|~o&a)+s+1518500249+S[n+1]<<0)<<5|s>>>27)+(l&(o=o<<30|o>>>2)|~l&i)+a+1518500249+S[n+2]<<0)<<5|a>>>27)+(s&(l=l<<30|l>>>2)|~s&o)+i+1518500249+S[n+3]<<0)<<5|i>>>27)+(a&(s=s<<30|s>>>2)|~a&l)+o+1518500249+S[n+4]<<0,a=a<<30|a>>>2;for(;n<40;n+=5)o=(t=(i=(t=(a=(t=(s=(t=(l=(t=o<<5|o>>>27)+(i^a^s)+l+1859775393+S[n]<<0)<<5|l>>>27)+(o^(i=i<<30|i>>>2)^a)+s+1859775393+S[n+1]<<0)<<5|s>>>27)+(l^(o=o<<30|o>>>2)^i)+a+1859775393+S[n+2]<<0)<<5|a>>>27)+(s^(l=l<<30|l>>>2)^o)+i+1859775393+S[n+3]<<0)<<5|i>>>27)+(a^(s=s<<30|s>>>2)^l)+o+1859775393+S[n+4]<<0,a=a<<30|a>>>2;for(;n<60;n+=5)o=(t=(i=(t=(a=(t=(s=(t=(l=(t=o<<5|o>>>27)+(i&a|i&s|a&s)+l-1894007588+S[n]<<0)<<5|l>>>27)+(o&(i=i<<30|i>>>2)|o&a|i&a)+s-1894007588+S[n+1]<<0)<<5|s>>>27)+(l&(o=o<<30|o>>>2)|l&i|o&i)+a-1894007588+S[n+2]<<0)<<5|a>>>27)+(s&(l=l<<30|l>>>2)|s&o|l&o)+i-1894007588+S[n+3]<<0)<<5|i>>>27)+(a&(s=s<<30|s>>>2)|a&l|s&l)+o-1894007588+S[n+4]<<0,a=a<<30|a>>>2;for(;n<80;n+=5)o=(t=(i=(t=(a=(t=(s=(t=(l=(t=o<<5|o>>>27)+(i^a^s)+l-899497514+S[n]<<0)<<5|l>>>27)+(o^(i=i<<30|i>>>2)^a)+s-899497514+S[n+1]<<0)<<5|s>>>27)+(l^(o=o<<30|o>>>2)^i)+a-899497514+S[n+2]<<0)<<5|a>>>27)+(s^(l=l<<30|l>>>2)^o)+i-899497514+S[n+3]<<0)<<5|i>>>27)+(a^(s=s<<30|s>>>2)^l)+o-899497514+S[n+4]<<0,a=a<<30|a>>>2;g=g+o<<0,m=m+i<<0,b=b+a<<0,y=y+s<<0,C=C+l<<0}while(!c);return[16*(g>>28&15)+(g>>24&15),16*(g>>20&15)+(g>>16&15),16*(g>>12&15)+(g>>8&15),16*(g>>4&15)+(15&g),16*(m>>28&15)+(m>>24&15),16*(m>>20&15)+(m>>16&15),16*(m>>12&15)+(m>>8&15),16*(m>>4&15)+(15&m),16*(b>>28&15)+(b>>24&15),16*(b>>20&15)+(b>>16&15),16*(b>>12&15)+(b>>8&15),16*(b>>4&15)+(15&b),16*(y>>28&15)+(y>>24&15),16*(y>>20&15)+(y>>16&15),16*(y>>12&15)+(y>>8&15),16*(y>>4&15)+(15&y),16*(C>>28&15)+(C>>24&15),16*(C>>20&15)+(C>>16&15),16*(C>>12&15)+(C>>8&15),16*(C>>4&15)+(15&C)]}var r={},w=[-2147483648,8388608,32768,128],v=[24,16,8,0],S=[];e.sha1=t,r.hash=t,n.exports=r}(this)},"./src/xlsx-io/password/sha512.js":function(n,e){!function(e){"use strict";function t(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W=!1,V=0,z=0,q=0,Z=e.length,Y=1779033703,K=4089235720,X=3144134277,J=2227873595,Q=1013904242,$=4271175723,ee=2773480762,te=1595750129,re=1359893119,ne=2917565137,oe=2600822924,ie=725511199,ae=528734635,se=4215389547,le=1541459225,ue=327033209,ce=0;do{for(pe[0]=ce,pe[1]=pe[2]=pe[3]=pe[4]=pe[5]=pe[6]=pe[7]=pe[8]=pe[9]=pe[10]=pe[11]=pe[12]=pe[13]=pe[14]=pe[15]=pe[16]=pe[17]=pe[18]=pe[19]=pe[20]=pe[21]=pe[22]=pe[23]=pe[24]=pe[25]=pe[26]=pe[27]=pe[28]=pe[29]=pe[30]=pe[31]=pe[32]=0,t=z;V<Z&&t<128;++V)pe[t>>2]|=e[V]<<fe[3&t++];for(q+=t-z,z=t-128,V===Z&&(pe[t>>2]|=he[3&t],++V),ce=pe[32],Z<V&&t<112&&(pe[31]=q<<3,W=!0),r=32;r<160;r+=2)n=((v=pe[r-30])>>>1|(S=pe[r-29])<<31)^(v>>>8|S<<24)^v>>>7,o=(S>>>1|v<<31)^(S>>>8|v<<24)^(S>>>7|v<<25),i=((v=pe[r-4])>>>19|(S=pe[r-3])<<13)^(S>>>29|v<<3)^v>>>6,a=(S>>>19|v<<13)^(v>>>29|S<<3)^(S>>>6|v<<26),v=pe[r-32],S=pe[r-31],c=((x=pe[r-14])>>>16)+(v>>>16)+(n>>>16)+(i>>>16)+((u=(65535&x)+(65535&v)+(65535&n)+(65535&i)+((l=((T=pe[r-13])>>>16)+(S>>>16)+(o>>>16)+(a>>>16)+((s=(65535&T)+(65535&S)+(65535&o)+(65535&a))>>>16))>>>16))>>>16),pe[r]=c<<16|65535&u,pe[r+1]=l<<16|65535&s;for(M=Y,I=K,F=ee,_=te,P=re,L=ne,O=oe,B=ie,j=ae,H=se,G=le,U=ue,b=(E=X)&(D=Q),y=(R=J)&(N=$),r=0;r<160;r+=8)n=(M>>>28|I<<4)^(I>>>2|M<<30)^(I>>>7|M<<25),o=(I>>>28|M<<4)^(M>>>2|I<<30)^(M>>>7|I<<25),i=(P>>>14|L<<18)^(P>>>18|L<<14)^(L>>>9|P<<23),a=(L>>>14|P<<18)^(L>>>18|P<<14)^(P>>>9|L<<23),C=(h=M&E)^M&D^b,w=(f=I&R)^I&N^y,A=P&O^~P&j,k=L&B^~L&H,v=pe[r],S=pe[r+1],v=(c=((x=de[r])>>>16)+(v>>>16)+(A>>>16)+(i>>>16)+(G>>>16)+((u=(65535&x)+(65535&v)+(65535&A)+(65535&i)+(65535&G)+((l=((T=de[r+1])>>>16)+(S>>>16)+(k>>>16)+(a>>>16)+(U>>>16)+((s=(65535&T)+(65535&S)+(65535&k)+(65535&a)+(65535&U))>>>16))>>>16))>>>16))<<16|65535&u,S=l<<16|65535&s,x=(c=(C>>>16)+(n>>>16)+((u=(65535&C)+(65535&n)+((l=(w>>>16)+(o>>>16)+((s=(65535&w)+(65535&o))>>>16))>>>16))>>>16))<<16|65535&u,T=l<<16|65535&s,G=(c=(F>>>16)+(v>>>16)+((u=(65535&F)+(65535&v)+((l=(_>>>16)+(S>>>16)+((s=(65535&_)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&u,U=l<<16|65535&s,n=((F=(c=(x>>>16)+(v>>>16)+((u=(65535&x)+(65535&v)+((l=(T>>>16)+(S>>>16)+((s=(65535&T)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&u)>>>28|(_=l<<16|65535&s)<<4)^(_>>>2|F<<30)^(_>>>7|F<<25),o=(_>>>28|F<<4)^(F>>>2|_<<30)^(F>>>7|_<<25),i=(G>>>14|U<<18)^(G>>>18|U<<14)^(U>>>9|G<<23),a=(U>>>14|G<<18)^(U>>>18|G<<14)^(G>>>9|U<<23),C=(d=F&M)^F&E^h,w=(p=_&I)^_&R^f,A=G&P^~G&O,k=U&L^~U&B,v=pe[r+2],S=pe[r+3],v=(c=((x=de[r+2])>>>16)+(v>>>16)+(A>>>16)+(i>>>16)+(j>>>16)+((u=(65535&x)+(65535&v)+(65535&A)+(65535&i)+(65535&j)+((l=((T=de[r+3])>>>16)+(S>>>16)+(k>>>16)+(a>>>16)+(H>>>16)+((s=(65535&T)+(65535&S)+(65535&k)+(65535&a)+(65535&H))>>>16))>>>16))>>>16))<<16|65535&u,S=l<<16|65535&s,x=(c=(C>>>16)+(n>>>16)+((u=(65535&C)+(65535&n)+((l=(w>>>16)+(o>>>16)+((s=(65535&w)+(65535&o))>>>16))>>>16))>>>16))<<16|65535&u,T=l<<16|65535&s,j=(c=(D>>>16)+(v>>>16)+((u=(65535&D)+(65535&v)+((l=(N>>>16)+(S>>>16)+((s=(65535&N)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&u,H=l<<16|65535&s,n=((D=(c=(x>>>16)+(v>>>16)+((u=(65535&x)+(65535&v)+((l=(T>>>16)+(S>>>16)+((s=(65535&T)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&u)>>>28|(N=l<<16|65535&s)<<4)^(N>>>2|D<<30)^(N>>>7|D<<25),o=(N>>>28|D<<4)^(D>>>2|N<<30)^(D>>>7|N<<25),i=(j>>>14|H<<18)^(j>>>18|H<<14)^(H>>>9|j<<23),a=(H>>>14|j<<18)^(H>>>18|j<<14)^(j>>>9|H<<23),C=(g=D&F)^D&M^d,w=(m=N&_)^N&I^p,A=j&G^~j&P,k=H&U^~H&L,v=pe[r+4],S=pe[r+5],v=(c=((x=de[r+4])>>>16)+(v>>>16)+(A>>>16)+(i>>>16)+(O>>>16)+((u=(65535&x)+(65535&v)+(65535&A)+(65535&i)+(65535&O)+((l=((T=de[r+5])>>>16)+(S>>>16)+(k>>>16)+(a>>>16)+(B>>>16)+((s=(65535&T)+(65535&S)+(65535&k)+(65535&a)+(65535&B))>>>16))>>>16))>>>16))<<16|65535&u,S=l<<16|65535&s,x=(c=(C>>>16)+(n>>>16)+((u=(65535&C)+(65535&n)+((l=(w>>>16)+(o>>>16)+((s=(65535&w)+(65535&o))>>>16))>>>16))>>>16))<<16|65535&u,T=l<<16|65535&s,O=(c=(E>>>16)+(v>>>16)+((u=(65535&E)+(65535&v)+((l=(R>>>16)+(S>>>16)+((s=(65535&R)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&u,B=l<<16|65535&s,n=((E=(c=(x>>>16)+(v>>>16)+((u=(65535&x)+(65535&v)+((l=(T>>>16)+(S>>>16)+((s=(65535&T)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&u)>>>28|(R=l<<16|65535&s)<<4)^(R>>>2|E<<30)^(R>>>7|E<<25),o=(R>>>28|E<<4)^(E>>>2|R<<30)^(E>>>7|R<<25),i=(O>>>14|B<<18)^(O>>>18|B<<14)^(B>>>9|O<<23),a=(B>>>14|O<<18)^(B>>>18|O<<14)^(O>>>9|B<<23),C=(b=E&D)^E&F^g,w=(y=R&N)^R&_^m,A=O&j^~O&G,k=B&H^~B&U,v=pe[r+6],S=pe[r+7],v=(c=((x=de[r+6])>>>16)+(v>>>16)+(A>>>16)+(i>>>16)+(P>>>16)+((u=(65535&x)+(65535&v)+(65535&A)+(65535&i)+(65535&P)+((l=((T=de[r+7])>>>16)+(S>>>16)+(k>>>16)+(a>>>16)+(L>>>16)+((s=(65535&T)+(65535&S)+(65535&k)+(65535&a)+(65535&L))>>>16))>>>16))>>>16))<<16|65535&u,S=l<<16|65535&s,x=(c=(C>>>16)+(n>>>16)+((u=(65535&C)+(65535&n)+((l=(w>>>16)+(o>>>16)+((s=(65535&w)+(65535&o))>>>16))>>>16))>>>16))<<16|65535&u,T=l<<16|65535&s,P=(c=(M>>>16)+(v>>>16)+((u=(65535&M)+(65535&v)+((l=(I>>>16)+(S>>>16)+((s=(65535&I)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&u,L=l<<16|65535&s,M=(c=(x>>>16)+(v>>>16)+((u=(65535&x)+(65535&v)+((l=(T>>>16)+(S>>>16)+((s=(65535&T)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&u,I=l<<16|65535&s;Y=(c=(Y>>>16)+(M>>>16)+((u=(65535&Y)+(65535&M)+((l=(K>>>16)+(I>>>16)+((s=(65535&K)+(65535&I))>>>16))>>>16))>>>16))<<16|65535&u,K=l<<16|65535&s,X=(c=(X>>>16)+(E>>>16)+((u=(65535&X)+(65535&E)+((l=(J>>>16)+(R>>>16)+((s=(65535&J)+(65535&R))>>>16))>>>16))>>>16))<<16|65535&u,J=l<<16|65535&s,Q=(c=(Q>>>16)+(D>>>16)+((u=(65535&Q)+(65535&D)+((l=($>>>16)+(N>>>16)+((s=(65535&$)+(65535&N))>>>16))>>>16))>>>16))<<16|65535&u,$=l<<16|65535&s,ee=(c=(ee>>>16)+(F>>>16)+((u=(65535&ee)+(65535&F)+((l=(te>>>16)+(_>>>16)+((s=(65535&te)+(65535&_))>>>16))>>>16))>>>16))<<16|65535&u,te=l<<16|65535&s,re=(c=(re>>>16)+(P>>>16)+((u=(65535&re)+(65535&P)+((l=(ne>>>16)+(L>>>16)+((s=(65535&ne)+(65535&L))>>>16))>>>16))>>>16))<<16|65535&u,ne=l<<16|65535&s,oe=(c=(oe>>>16)+(O>>>16)+((u=(65535&oe)+(65535&O)+((l=(ie>>>16)+(B>>>16)+((s=(65535&ie)+(65535&B))>>>16))>>>16))>>>16))<<16|65535&u,ie=l<<16|65535&s,ae=(c=(ae>>>16)+(j>>>16)+((u=(65535&ae)+(65535&j)+((l=(se>>>16)+(H>>>16)+((s=(65535&se)+(65535&H))>>>16))>>>16))>>>16))<<16|65535&u,se=l<<16|65535&s,le=(c=(le>>>16)+(G>>>16)+((u=(65535&le)+(65535&G)+((l=(ue>>>16)+(U>>>16)+((s=(65535&ue)+(65535&U))>>>16))>>>16))>>>16))<<16|65535&u,ue=l<<16|65535&s}while(!W);return[16*(Y>>28&15)+(Y>>24&15),16*(Y>>20&15)+(Y>>16&15),16*(Y>>12&15)+(Y>>8&15),16*(Y>>4&15)+(15&Y),16*(K>>28&15)+(K>>24&15),16*(K>>20&15)+(K>>16&15),16*(K>>12&15)+(K>>8&15),16*(K>>4&15)+(15&K),16*(X>>28&15)+(X>>24&15),16*(X>>20&15)+(X>>16&15),16*(X>>12&15)+(X>>8&15),16*(X>>4&15)+(15&X),16*(J>>28&15)+(J>>24&15),16*(J>>20&15)+(J>>16&15),16*(J>>12&15)+(J>>8&15),16*(J>>4&15)+(15&J),16*(Q>>28&15)+(Q>>24&15),16*(Q>>20&15)+(Q>>16&15),16*(Q>>12&15)+(Q>>8&15),16*(Q>>4&15)+(15&Q),16*($>>28&15)+($>>24&15),16*($>>20&15)+($>>16&15),16*($>>12&15)+($>>8&15),16*($>>4&15)+(15&$),16*(ee>>28&15)+(ee>>24&15),16*(ee>>20&15)+(ee>>16&15),16*(ee>>12&15)+(ee>>8&15),16*(ee>>4&15)+(15&ee),16*(te>>28&15)+(te>>24&15),16*(te>>20&15)+(te>>16&15),16*(te>>12&15)+(te>>8&15),16*(te>>4&15)+(15&te),16*(re>>28&15)+(re>>24&15),16*(re>>20&15)+(re>>16&15),16*(re>>12&15)+(re>>8&15),16*(re>>4&15)+(15&re),16*(ne>>28&15)+(ne>>24&15),16*(ne>>20&15)+(ne>>16&15),16*(ne>>12&15)+(ne>>8&15),16*(ne>>4&15)+(15&ne),16*(oe>>28&15)+(oe>>24&15),16*(oe>>20&15)+(oe>>16&15),16*(oe>>12&15)+(oe>>8&15),16*(oe>>4&15)+(15&oe),16*(ie>>28&15)+(ie>>24&15),16*(ie>>20&15)+(ie>>16&15),16*(ie>>12&15)+(ie>>8&15),16*(ie>>4&15)+(15&ie),16*(ae>>28&15)+(ae>>24&15),16*(ae>>20&15)+(ae>>16&15),16*(ae>>12&15)+(ae>>8&15),16*(ae>>4&15)+(15&ae),16*(se>>28&15)+(se>>24&15),16*(se>>20&15)+(se>>16&15),16*(se>>12&15)+(se>>8&15),16*(se>>4&15)+(15&se),16*(le>>28&15)+(le>>24&15),16*(le>>20&15)+(le>>16&15),16*(le>>12&15)+(le>>8&15),16*(le>>4&15)+(15&le),16*(ue>>28&15)+(ue>>24&15),16*(ue>>20&15)+(ue>>16&15),16*(ue>>12&15)+(ue>>8&15),16*(ue>>4&15)+(15&ue)]}var r={},he=[-2147483648,8388608,32768,128],fe=[24,16,8,0],de=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],pe=[];e.sha512=t,r.hash=t,n.exports=r}(this)},"./src/xlsx-io/password/xlsxEncryptionHelper.ts":function(e,t,r){"use strict";var a,l,i;function u(e){var t,r,n={success:!1,encryptionInfoStream:null,encryptPagStream:null},o=new a.CompoundFile,i=new Uint8Array(e);return o.Xj(i),t=o.Ml("EncryptionInfo"),r=o.Ml("EncryptedPackage"),null===t||null===r||(n.success=!0,n.encryptionInfoStream=t,n.encryptPagStream=r),n}function c(){}Object.defineProperty(t,"__esModule",{value:!0}),a=r("./src/xlsx-io/password/compoundFile.ts"),l=r("./src/xlsx-io/password/aesEngine.ts"),i=r("./src/common/common.ts"),c.tk=function(e,t){var r,n,o,i,a,s;return c.uk(e)?(r=t,a={success:!1},(s=u(e)).success&&(n=s.encryptionInfoStream,o=s.encryptPagStream,null===n||null===o||(i=new l.AesEngine).Dk(n)&&(i.Ck?i.Ek(r)&&(a=i.Jk(o)):(i.key=i.Mk(r,i.salt,i.hashAlgorithm),i.Rk(i.keySize,i.key),i.Qk()&&(a=i.Lk(o))))),a&&a.success?a.data:null):e},c.Fj=function(e,t){var r,n=new l.AesEngine,o=n.Ok(t),i=n.Zk(e);if(null!==o&&null!==i&&(r=n.$k(o,i)).success)return r.data},c.Gj=function(e){var t,r=[];for(t=0;t<e.length;t++)r[t]=String.fromCharCode(e[t]);return function(e,t){var r,n,o,i,a,s,l=atob(e),u=l.length,c=Math.ceil(u/1024),h=Array(c);for(r=0;r<c;++r){for(n=1024*r,o=Math.min(1024+n,u),i=Array(o-n),a=n,s=0;a<o;++s,++a)i[s]=l[a].charCodeAt(0);h[r]=new Uint8Array(i)}return new Blob(h,{type:t})}(btoa(r.join("")),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")},c.uk=function(e){function t(e){var t,r=[];for(t=0;t<e.length;t++)r[t]=e[e.length-t-1];return r}var r,n=0,o=0;if(t(new Uint8Array(i.BufferHelper.na(e,0,4))).forEach(function(e){n=256*n+e}),t(new Uint8Array(i.BufferHelper.na(e,4,8))).forEach(function(e){o=256*o+e}),"E011CFD0"===n.toString(16).toUpperCase()&&"E11AB1A1"===o.toString(16).toUpperCase())try{return(r=u(e)).success&&r.encryptionInfoStream&&r.encryptPagStream}catch(e){return!1}return!1},t.XlsxEncryptionHelper=c},"./src/xlsx-io/reader/autofilter-reader.ts":function(e,t,r){"use strict";var n,i,o,w,v,S,x,T,A,k;function a(e){var t={},r=e.sortCondition.pe;return r&&(t.ascending=!r.descending,t.index=o.getRangesFromString(r.ref)[0].col,"fontColor"!==r.sortBy&&"cellColor"!==r.sortBy||(t.isBackColor="cellColor"===r.sortBy,t.dxfId=x(r.dxfId,0))),t}function s(e){var t,C={},r=e.pe.ref.toUpperCase();return r&&"#REF!"!==r?((t=o.getRangesFromString(r))[0]&&(C.range=t[0]),C.filterColumns=[],T(e.filterColumn).forEach(function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b={},y=e.pe.colId;b.hiddenButton=w.XmlNodeHelper.Xl(e.pe.hiddenButton,!1),A(y)||(b.autoFilterColumnId=parseInt(y,10)),e.colorFilter&&(b.colorFilter=(g=e.colorFilter,(m={}).cellColor=v(g.pe.cellColor,!0),m.dxfId=w.XmlNodeHelper.Zl(g.pe.dxfId,0),m)),e.filters&&(b.filters=(d=e.filters,(p={filter:[]}).blank=d.pe.blank,T(d.filter).forEach(function(e){p.filter.push(e.pe.val)}),p.dateGroupItem=[],T(d.dateGroupItem).forEach(function(e){var t={},r=e.pe;t.day=x(r.day,1),t.hour=x(r.hour,0),t.minute=x(r.minute,0),t.month=x(r.month,0),t.second=x(r.second,0),t.year=x(r.year,0),p.dateGroupItem.push(t)}),p)),e.customFilters&&(b.customFilters=(s=e.customFilters,h={},f=s.pe.and,A(f)||(h.and="1"===f),0<(l=T(s.customFilter)).length&&((u=h.filter1={}).operator=l[0].pe.operator,u.value=l[0].pe.val),1<l.length&&((c=h.filter2={}).operator=l[1].pe.operator,c.value=l[1].pe.val),h)),e.dynamicFilter&&(b.dynamicFilter=(n=e.dynamicFilter,(a={}).type=k[n.pe.type],o=n.pe.val,i=n.pe.maxVal,A(o)||(a.value=o),A(i)||(a.maxValue=i),a)),e.top10&&(b.top10Filter=(t=e.top10,(r={}).value=S(t.pe.val,NaN),r.percent=v(t.pe.percent,!1),r.top=v(t.pe.top,!0),r)),C.filterColumns.push(b)}),C):null}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/common/common.ts"),i=r("./src/xml-io/xml-parser.ts"),o=r("./src/common/range-parser.ts"),w=r("./src/xml-io/node-helper.ts"),v=w.XmlNodeHelper.Xl,S=w.XmlNodeHelper.Yl,x=w.XmlNodeHelper.Zl,T=w.XmlNodeHelper.qe,A=n.StringEx.C,k={null:-1,aboveAverage:100,belowAverage:101,tomorrow:2,today:0,yesterday:1,nextWeek:9,thisWeek:7,lastWeek:8,nextMonth:6,thisMonth:4,lastMonth:5,nextQuarter:10,thisQuarter:11,lastQuarter:12,nextYear:13,thisYear:14,lastYear:15,yearToDate:16,Q1:17,Q2:18,Q3:19,Q4:20,M1:21,M2:22,M3:23,M4:24,M5:25,M6:26,M7:27,M8:28,M9:29,M10:30,M11:31,M12:32},t.readSortInfo=a,t.readAutoFilter=s,t.readAutoFilterForSheet=function(e,t,r){var n=i.parseXmlToObject(e.readFullElement()).autoFilter,o=s(n);n.sortState&&(o.sortInfo=a(n.sortState)),r.mg(t,o)}},"./src/xlsx-io/reader/chart-reader.ts":function(e,a,t){"use strict";var u,c,s,p,r,l,h,f,n,i,d,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,o;function Ee(e,t){return p.k(e)?t:e}function Re(e){var t=e.readAttributeNameAsString().split(":");return 1<t.length?t[1]:t[0]}function De(e){var t=e.name().split(":");return 1<t.length?t[1]:t[0]}function Ne(e,t,r){for(var n;e.moveToNextAttribute();)if(Re(e)===t)return n=e.readContentAsString(),r&&(n=r(n)),n}function Fe(e,t,r,n){var o,i,a,s=n||{};if(3===e.elementType)return s;for(o=e.depth;e.read()&&(i=e.depth,a=e.elementType,i!==o||2!==a);)o+1<i||2===a||De(e)===t&&(s[t]=r(e));return s}function _e(e,t){for(var r,n,o=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==o||2!==n);)if(!(o+1<r||2===n))switch(De(e)){case M:t.scrgbClr=mt(e);break;case I:t.srgbClr=yt(e);break;case E:t.hslClr=Ct(e);break;case R:t.sysClr=wt(e);break;case D:t.schemeClr=vt(e);break;case N:t.prstClr=St(e)}return t}function Pe(e,t){for(var r,n,o=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==o||2!==n);)if(!(o+1<r||2===n))switch(De(e)){case _:t.noFill=!0;break;case P:t.solidFill=mi(e);break;case L:t.gradFill=vi(e);break;case O:t.blipFill=ki(e);break;case B:t.pattFill=Mi(e);break;case j:t.grpFill={}}return t}function Le(e,t){for(var r,n,o=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==o||2!==n);)if(!(o+1<r||2===n))switch(De(e)){case _:t.items.push(a.DrawingReader.ReadCT_NoFillProperties(e));break;case P:t.items.push(a.DrawingReader.ReadCT_SolidColorFillProperties(e));break;case L:t.items.push(a.DrawingReader.ReadCT_GradientFillProperties(e));break;case O:t.items.push(a.DrawingReader.ReadCT_BlipFillProperties(e));break;case B:t.items.push(a.DrawingReader.ReadCT_PatternFillProperties(e));break;case j:t.items.push(a.DrawingReader.ReadCT_GroupFillProperties(e))}return t}function Oe(e,t){for(var r,n,o=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==o||2!==n);)if(!(o+1<r||2===n))switch(De(e)){case"tint":t.tint=[st(e)];break;case"shade":t.shade=[st(e)];break;case"comp":t.comp=[{}];break;case"inv":t.inv=[{}];break;case"gray":t.gray=[{}];break;case"alpha":t.alpha=[st(e)];break;case"alphaMod":t.alphaMod=[it(e)];break;case"alphaOff":t.alphaOff=[at(e)];break;case"hue":t.hue=[nt(e)];break;case"hueMod":t.hueMod=[it(e)];break;case"hueOff":t.hueOff=[rt(e)];break;case"sat":t.sat=[ot(e)];break;case"satMod":t.satMod=[ot(e)];break;case"satOff":t.satOff=[ot(e)];break;case"lum":t.lum=[ot(e)];break;case"lumMod":t.lumMod=[ot(e)];break;case"lumOff":t.lumOff=[ot(e)];break;case"red":t.red=[ot(e)];break;case"redMod":t.redMod=[ot(e)];break;case"redOff":t.redOff=[ot(e)];break;case"green":t.green=[ot(e)];break;case"greenMod":t.greenMod=[ot(e)];break;case"greenOff":t.greenOff=[ot(e)];break;case"blue":t.blue=[ot(e)];break;case"blueMod":t.blueMod=[ot(e)];break;case"blueOff":t.blueOff=[ot(e)];break;case"gamma":t.gamma=[{}];break;case"invGamma":t.invGamma=[{}]}return t}function Be(e,t){for(var r,n,o=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==o||2!==n);)if(!(o+1<r||2===n))switch(De(e)){case"wireframe":t.wireframe=_t(e);break;case se:t.ser.push(Kr(e));break;case"bandFmts":t.bandFmts=wn(e);break;case ue:t.axId.push(Ot(e));break;case y:t.extLst=Ht(e)}return t}function je(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||De(e)===C&&(o.cNvPr=Eo(e));return o}function He(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||De(e)===z&&(o.sqref=e.readElementContentAsString());return o}function Ge(e){var t,r,n,o,i,a={};if(a[g]=Ne(e,g),3===e.elementType)return a;for(t=e.depth,r=["dk1","lt1","dk2","lt2","accent1","accent2","accent3","accent4","accent5","accent6","hlink","folHlink"];e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)t+1<n||2===o||((i=De(e))===y?a[i]=Tt(e):0<=r.indexOf(i)&&(a[i]=Dt(e)));return a}function Ue(e){var t={};return t[g]=Ne(e,g),3===e.elementType?t:_e(e,t)}function We(e){for(var t,r={};e.moveToNextAttribute();)"script"!==(t=Re(e))&&"typeface"!==t||(r[t]=e.readContentAsString());return r}function Ve(e){var t,r,n,o,i={custClr:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("custClr"===(o=De(e))?i.custClr.push(Ue(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function ze(e){var t,r,n,o={font:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"latin":o.latin=ts(e);break;case"ea":o.ea=ts(e);break;case"cs":o.cs=ts(e);break;case"font":o.font.push(We(e));break;case y:o.extLst=Tt(e)}return o}function qe(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case v:o.effectLst=Li(e);break;case S:o.effectDag=Fi(e);break;case U:o.scene3d=Ho(e);break;case"sp3d":o.sp3d=Wo(e)}return o}function Ze(e){var t,r,n,o,i={};if(i[g]=Ne(e,g),3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("majorFont"===(o=De(e))||"minorFont"===o?i[o]=ze(e):o===y&&(i.extLst=Tt(e)));return i}function Ye(e){var t={items:[]};return 3===e.elementType?t:Le(e,t)}function Ke(e){var t,r,n,o,i={ln:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("ln"===(o=De(e))?i.ln.push(a.DrawingReader.ReadCT_LineProperties(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function Xe(e){var t,r,n,o,i={effectStyle:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("effectStyle"===(o=De(e))?i.effectStyle.push(qe(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function Je(e){var t={items:[]};return 3===e.elementType?t:Le(e,t)}function Qe(e){var t,r,n,o={};if(o[g]=Ne(e,g),3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"fillStyleLst":o.fillStyleLst=Ye(e);break;case"lnStyleLst":o.lnStyleLst=Ke(e);break;case"effectStyleLst":o.effectStyleLst=Xe(e);break;case"bgFillStyleLst":o.bgFillStyleLst=Je(e)}return o}function $e(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case J:o.clrScheme=Ge(e);break;case Q:o.fontScheme=Ze(e);break;case $:o.fmtScheme=Qe(e);break;case y:o.extLst=Tt(e)}return o}function et(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"id":t.id=e.readContentAsString();break;case"a16":t.name=e.readContentAsString()}return t}function tt(e){var t,r,n,o,i,a;if(3===e.elementType)return{hiddenExtensionType:4};for((t={creationId:[]}).uri=Ee(Ne(e,"uri"),""),n=(r=t.uri)===Ie.hiddenScene3dUri?0:r===Ie.hiddenSp3dUri?3:r===Ie.hiddenFillUri||r===Ie.hiddenFillUri2?1:r===Ie.hiddenLineUri||r===Ie.hiddenLineUri2?2:4,t.hiddenExtensionType=n,o=e.depth;e.read()&&(i=e.depth,a=e.elementType,i!==o||2!==a);)if(!(o+1<i||2===a))switch(De(e)){case"hiddenScene3d":t.Scene3d=Ho(e);break;case"hiddenSp3d":t.Shape3d=Wo(e);break;case"hiddenFill":t.Fill=Ei(e);break;case"hiddenLine":t.Line=la(e);break;case"creationId":t.creationId.push(et(e))}return t}function rt(e){return Ne(e,d,i)}function nt(e){return Ne(e,d,i)}function ot(e){return Ne(e,d,i)}function it(e){return Ne(e,d,i)}function at(e){return Ne(e,d,i)}function st(e){return Ne(e,d,i)}function lt(e){for(var t,r={};e.moveToNextAttribute();)"n"!==(t=Re(e))&&"d"!==t||(r[t]=e.readContentAsInt());return r}function ut(e,t){for(var r,n={};e.moveToNextAttribute();)"x"!==(r=Re(e))&&"y"!==r||(n[r]=e.readContentAsInt(),t&&(n[r]=l(n[r],6)));return n}function ct(e,t){for(var r,n={};e.moveToNextAttribute();)"cx"!==(r=Re(e))&&"cy"!==r||(n[r]=e.readContentAsInt(),t&&(n[r]=l(n[r],6)));return n}function ht(){return{}}function ft(){return{}}function dt(){return{}}function pt(){return{}}function gt(){return{}}function mt(e){for(var t,r={};e.moveToNextAttribute();)"r"!==(t=Re(e))&&"g"!==t&&"b"!==t||(r[t]=e.readContentAsInt());return 3===e.elementType?r:Oe(e,r)}function bt(e){var t,r,n=[];if(e)for(t=e.length,r=0;r<t;r+=2)n[r/2]=parseInt(e.substr(r,2),16);return n}function yt(e){var t={},r=Ne(e,d);return p.k(r)||(t.val=bt(r)),3===e.elementType?t:Oe(e,t)}function Ct(e){for(var t,r={};e.moveToNextAttribute();)"hue"!==(t=Re(e))&&"sat"!==t&&"lum"!==t||(r[t]=e.readContentAsInt());return 3===e.elementType?r:Oe(e,r)}function wt(e){for(var t,r={};e.moveToNextAttribute();)(t=Re(e))===d?r.val=s.ChartHelper.ToKnownColor(u.Charts.ST_SystemColorVal[e.readContentAsString()]):"lastClr"===t&&(r.lastClr=bt(e.readContentAsString()));return 3===e.elementType?r:Oe(e,r)}function vt(e){var t={},r=Ne(e,d);return p.k(r)||(t.val=s.ChartHelper.ToColorSchemeIndex(u.Charts.ST_SchemeColorVal[r])),3===e.elementType?t:Oe(e,t)}function St(e){var t={},r=Ne(e,d);return p.k(r)||(t.val=u.Charts.ST_PresetColorVal[r]),3===e.elementType?t:Oe(e,t)}function xt(e){var t={},r=Ne(e,d);return p.k(r)||(t.val=u.Charts.ST_StyleColorVal[r]),3===e.elementType?t:Oe(e,t)}function Tt(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth,r=[];e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)t+1<n||2===o||De(e)===k&&r.push(tt(e));return 0<r.length&&(i.ext=r),i}function At(e){for(var t,r,n,o,i,a={rot:0};e.moveToNextAttribute();)"rot"===(t=Re(e))?a.rot=e.readContentAsInt():"flipH"!==t&&"flipV"!==t||(a[t]=e.readContentAsBoolean());if(3===e.elementType)return a;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)r+1<n||2===o||("off"===(i=De(e))?a.off=ut(e,!0):i===k&&(a.ext=ct(e,!0)));return a}function kt(e){for(var t,r,n,o,i={rot:0};e.moveToNextAttribute();)"rot"===(t=Re(e))?i.rot=e.readContentAsInt():"flipH"!==t&&"flipV"!==t||(i[t]=e.readContentAsBoolean());if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"off":i.off=ut(e,!0);break;case k:i.ext=ct(e,!0);break;case"chOff":i.chOff=ut(e,!0);break;case"chExt":i.chExt=ct(e,!0)}return i}function Mt(e){for(var t,r={};e.moveToNextAttribute();)"x"!==(t=Re(e))&&"y"!==t&&"z"!==t||(r[t]=e.readContentAsInt());return r}function It(e){for(var t,r={};e.moveToNextAttribute();)"dx"!==(t=Re(e))&&"dy"!==t&&"dz"!==t||(r[t]=e.readContentAsInt());return r}function Et(e){for(var t,r={};e.moveToNextAttribute();)"lat"!==(t=Re(e))&&"lon"!==t&&"rev"!==t||(r[t]=e.readContentAsInt());return r}function Rt(e){for(var t,r={l:0,r:0,t:0,b:0},n={l:!0,t:!0,r:!0,b:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=e.readContentAsInt());return r}function Dt(e){var t={};return 3===e.elementType?t:_e(e,t)}function Nt(e){for(var t,r={name:"",builtIn:!1};e.moveToNextAttribute();)"embed"===(t=Re(e))||t===g?r[t]=e.readContentAsString():"builtIn"===t&&(r[t]=e.readContentAsBoolean());return r}function Ft(e){for(var t,r,n,o,i,a={invalidUrl:"",action:"",tgtFrame:"",tooltip:"",history:!0,highlightClick:!1,endSnd:!1},s={id:!0,invalidUrl:!0,action:!0,tgtFrame:!0,tooltip:!0},l={history:!0,highlightClick:!0,endSnd:!0};e.moveToNextAttribute();)s[t=Re(e)]?a[t]=e.readContentAsString():l[t]&&(a[t]=e.readContentAsBoolean());if(3===e.elementType)return a;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)r+1<n||2===o||("snd"===(i=De(e))?a.snd=Nt(e):i===y&&(a.extLst=Tt(e)));return a}function _t(e){for(;e.moveToNextAttribute();){if(Re(e)===d)return e.readContentAsBoolean()}}function Pt(e){return Ne(e,d,n)}function Lt(e){return Ne(e,d,i)}function Ot(e){return Ne(e,d,i)}function Bt(e){var t={};return t.id=Ne(e,"id"),t}function jt(e){var t,r,n,o,i={};if(i.uri=Ee(Ne(e,"uri"),"{6F2FDCE9-48DA-4B69-8628-5D25D57E5C99}"),3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("invertSolidFillFmt"===(o=De(e))?i.dataObject=go(e):"datalabelsRange"===o?i.dataObject=mo(e):"dataDisplayOptions16"===o&&(i.dataObject=$n(e)));return i}function Ht(e){var t,r,n,o,i,a={};if(3===e.elementType)return a;for(t=e.depth,r=[];e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)t+1<n||2===o||((i=De(e))===k?r.push(jt(e)):i===A&&(a.dumy=e.readElementContentAsBoolean()));return 0<r.length&&(a.ext=r),a}function Gt(e){for(var t,r,n,o,i={};e.moveToNextAttribute();)(t=Re(e))===G?i.idx=e.readContentAsInt():"formatCode"===t&&(i.formatCode=e.readContentAsString());if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)r+1<n||2===o||"v"===De(e)&&(i.v=e.readElementContentAsString());return i}function Ut(e){var t,r,n,o,i,a={};if(3===e.elementType)return a;for(t=e.depth,r=[];e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)if(!(t+1<n||2===o))switch(De(e)){case"formatCode":a.formatCode=e.readElementContentAsString();break;case"ptCount":a.ptCount=Lt(e);break;case"pt":r.push(Gt(e));break;case y:a.extLst=Ht(e)}return 0<r.length&&(a.pt=r.map(function(e){return e.v}),(i=r.map(function(e){return e.formatCode})).some(function(e){return!!e})&&(a.formatCodes=i)),a}function Wt(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"f":i.f=h(e.readElementContentAsString());break;case"numCache":delete(o=Ut(e)).pt,delete o.ptCount,i.numCache=o;break;case y:i.extLst=Ht(e)}return i}function Vt(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("numRef"===(o=De(e))?i.numRef=Wt(e):"numLit"===o&&(i.numLit=Ut(e)));return i}function zt(e){var t,r,n,o={};if(o[G]=Ne(e,G,i),3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||"v"===De(e)&&(o.v=h(e.readElementContentAsString()));return o}function qt(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth,r=[];e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)if(!(t+1<n||2===o))switch(De(e)){case"ptCount":i.ptCount=Lt(e);break;case"pt":r.push(zt(e).v);break;case y:i.extLst=Ht(e)}return 0<r.length&&(i.pt=r),i}function Zt(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"f":o.f=h(e.readElementContentAsString());break;case y:o.extLst=Ht(e)}return o}function Yt(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("strRef"===(o=De(e))?i.strRef=Zt(e):"rich"===o&&(i.rich=za(e)));return i}function Kt(e){var t,r,n,o={lvl:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"ptCount":o.ptCount=Lt(e);break;case"lvl":o.lvl.push(qt(e));break;case y:o.extLst=Ht(e)}return o}function Xt(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"f":o.f=h(e.readElementContentAsString());break;case"multiLvlStrCache":o.multiLvlStrCache=Kt(e);break;case y:o.extLst=Ht(e)}return o}function Jt(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"multiLvlStrRef":o.multiLvlStrRef=Xt(e);break;case"numRef":o.numRef=Wt(e);break;case"numLit":o.numLit=Ut(e);break;case"strRef":o.strRef=Zt(e);break;case"strLit":o.strLit=qt(e)}return o}function Qt(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("strRef"===(o=De(e))?i.strRef=Zt(e):"v"===o&&(i.v=e.readElementContentAsString()));return i}function $t(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_LayoutTarget[t]}function er(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_LayoutMode[t]}function tr(e){var t,r,n,o,i,a,s={};if(3===e.elementType)return s;for(t=e.depth,r={xMode:!0,yMode:!0,wMode:!0,hMode:!0},n={x:!0,y:!0,w:!0,h:!0};e.read()&&(o=e.depth,i=e.elementType,o!==t||2!==i);)t+1<o||2===i||(r[a=De(e)]?s[a]=er(e):n[a]?s[a]=Pt(e):"layoutTarget"===a?s.layoutTarget=$t(e):a===y&&(s.extLst=Ht(e)));return s}function rr(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("manualLayout"===(o=De(e))?i.manualLayout=tr(e):o===y&&(i.extLst=Ht(e)));return i}function nr(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"tx":o.tx=Yt(e);break;case ee:o.layout=rr(e);break;case"overlay":o.overlay=_t(e);break;case W:o.spPr=ua(e);break;case V:o.txPr=za(e);break;case y:o.extLst=Ht(e)}return o}function or(e){return Ee(Ne(e,d),0)}function ir(e){return Ee(Ne(e,d,i),100)}function ar(e){return Ee(Ne(e,d,i),0)}function sr(e){return Ee(Ne(e,d,i),100)}function lr(e){return Ee(Ne(e,d),30)}function ur(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"rotX":o.rotX=or(e);break;case"hPercent":o.hPercent=ir(e);break;case"rotY":o.rotY=ar(e);break;case"depthPercent":o.depthPercent=sr(e);break;case"rAngAx":o.rAngAx=_t(e);break;case"perspective":o.perspective=lr(e);break;case y:o.extLst=Ht(e)}return o}function cr(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"thickness":o.thickness=Lt(e);break;case W:o.spPr=ua(e);break;case te:o.pictureOptions=_n(e);break;case y:o.extLst=Ht(e)}return o}function hr(e){var t,r,n,o,i,a={};if(3===e.elementType)return a;for(t=e.depth,r={showHorzBorder:!0,showVertBorder:!0,showOutline:!0,showKeys:!0};e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)t+1<n||2===o||(r[i=De(e)]?a[i]=_t(e):i===W?a.spPr=ua(e):i===V?a.txPr=za(e):i===y&&(a.extLst=Ht(e)));return a}function fr(e){return Ee(Ne(e,d,i),150)}function dr(e){return Ee(Ne(e,d,i),0)}function pr(e){return Ee(Ne(e,d,i),100)}function gr(e){var t=Ee(Ne(e,d),"area");return u.Charts.ST_SizeRepresents[t]}function mr(e){return Ee(Ne(e,d,i),0)}function br(e){return Ee(Ne(e,d,i),0)}function yr(e){var t=Ee(Ne(e,d),"auto");return s.ChartHelper.ToChartSplitType(u.Charts.ST_SplitType[t])}function Cr(e){var t,r,n,o={secondPiePt:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||"secondPiePt"===De(e)&&o.secondPiePt.push(Lt(e));return o}function wr(e){return Ee(Ne(e,d,i),75)}function vr(e){for(var t,r={};e.moveToNextAttribute();)"formatCode"===(t=Re(e))?r.formatCode=h(e.readContentAsString()):"sourceLinked"===t&&(e.readContentAsBoolean()||(r.sourceLinked=!1));return r}function Sr(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_LblAlgn[t]}function xr(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_DLblPos[t]}function Tr(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case G:o.idx=Lt(e);break;case H:o.delete=_t(e);break;case ee:o.layout=rr(e);break;case"tx":o.tx=Yt(e);break;case be:o.numFmt=vr(e);break;case W:o.spPr=ua(e);break;case V:o.txPr=za(e);break;case"dLblPos":o.dLblPos=xr(e);break;case"showLegendKey":o.showLegendKey=_t(e);break;case"showVal":o.showVal=_t(e);break;case"showCatName":o.showCatName=_t(e);break;case"showSerName":o.showSerName=_t(e);break;case"showPercent":o.showPercent=_t(e);break;case"showBubbleSize":o.showBubbleSize=_t(e);break;case"separator":o.separator=e.readElementContentAsString(!0);break;case y:o.extLst=uo(e)}return o}function Ar(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth,r=[];e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)if(!(t+1<n||2===o))switch(De(e)){case"dLbl":r.push(Tr(e));break;case H:i.delete=_t(e);break;case be:i.numFmt=vr(e);break;case W:i.spPr=ua(e);break;case V:i.txPr=za(e);break;case"dLblPos":i.dLblPos=xr(e);break;case"showLegendKey":i.showLegendKey=_t(e);break;case"showVal":i.showVal=_t(e);break;case"showCatName":i.showCatName=_t(e);break;case"showSerName":i.showSerName=_t(e);break;case"showPercent":i.showPercent=_t(e);break;case"showBubbleSize":i.showBubbleSize=_t(e);break;case"separator":i.separator=e.readElementContentAsString(!0);break;case"showLeaderLines":i.showLeaderLines=_t(e);break;case"leaderLines":i.leaderLines=Jr(e);break;case y:i.extLst=ho(e)}return 0<r.length&&(i.dLbl=r),i}function kr(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_MarkerStyle[t]}function Mr(e){return c.UnitHelper.pointToPixel(Ee(Ne(e,d),5))}function Ir(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"symbol":o.symbol=kr(e);break;case"size":o.size=Mr(e);break;case W:o.spPr=ua(e);break;case y:o.extLst=Ht(e)}return o}function Er(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case G:o.idx=Lt(e);break;case q:o.invertIfNegative=_t(e);break;case Y:o.marker=Ir(e);break;case Z:o.bubble3D=_t(e);break;case"explosion":o.explosion=Lt(e);break;case W:o.spPr=ua(e);break;case te:o.pictureOptions=_n(e);break;case y:o.extLst=Ht(e)}return o}function Rr(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_TrendlineType[t]}function Dr(e){return Ne(e,d,i)}function Nr(e){return Ne(e,d,i)}function Fr(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ee:o.layout=rr(e);break;case"tx":o.tx=Yt(e);break;case be:o.numFmt=vr(e);break;case W:o.spPr=ua(e);break;case V:o.txPr=za(e);break;case y:o.extLst=Ht(e)}return o}function _r(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case g:o.name=e.readElementContentAsString();break;case W:o.spPr=ua(e);break;case"trendlineType":o.trendlineType=Rr(e);break;case re:o.order=Dr(e);break;case"period":o.period=Nr(e);break;case"forward":o.forward=Pt(e);break;case"backward":o.backward=Pt(e);break;case"intercept":o.intercept=Pt(e);break;case"dispRSqr":o.dispRSqr=_t(e);break;case"dispEq":o.dispEq=_t(e);break;case"trendlineLbl":o.trendlineLbl=Fr(e);break;case y:o.extLst=Ht(e)}return o}function Pr(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_ErrDir[t]}function Lr(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_ErrBarType[t]}function Or(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_ErrValType[t]}function Br(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"errDir":o.errDir=Pr(e);break;case"errBarType":o.errBarType=Lr(e);break;case"errValType":o.errValType=Or(e);break;case"noEndCap":o.noEndCap=_t(e);break;case"plus":o.plus=Vt(e);break;case"minus":o.minus=Vt(e);break;case d:o.val=Pt(e);break;case W:o.spPr=ua(e);break;case y:o.extLst=Ht(e)}return o}function jr(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||De(e)===W&&(o.spPr=ua(e));return o}function Hr(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ne:o.gapWidth=fr(e);break;case"upBars":o.upBars=jr(e);break;case"downBars":o.downBars=jr(e);break;case y:o.extLst=Ht(e)}return o}function Gr(e,t,r,n){0<t.length&&(e.dPt=t),n&&0<n.length&&(e.errBars=n),r&&0<r.length&&(e.trendline=r)}function Ur(e){var t,r,n,o,i,a,s={seriesType:2};if(3===e.elementType)return s;for(t=e.depth,r=[],n=[],o=[];e.read()&&(i=e.depth,a=e.elementType,i!==t||2!==a);)if(!(t+1<i||2===a))switch(De(e)){case G:s.idx=Lt(e);break;case re:s.order=Lt(e);break;case"tx":s.tx=Qt(e);break;case W:s.spPr=ua(e);break;case Y:s.marker=Ir(e);break;case"dPt":r.push(Er(e));break;case oe:s.dLbls=Ar(e);break;case ie:n.push(_r(e));break;case ae:o.push(Br(e));break;case"cat":s.cat=Jt(e);break;case d:s.val=Vt(e);break;case"smooth":s.smooth=_t(e);break;case y:s.extLst=Ht(e)}return Gr(s,r,n,o),s}function Wr(e){var t,r,n,o,i,a,s={seriesType:5};if(3===e.elementType)return s;for(t=e.depth,r=[],n=[],o=[];e.read()&&(i=e.depth,a=e.elementType,i!==t||2!==a);)if(!(t+1<i||2===a))switch(De(e)){case G:s.idx=Lt(e);break;case re:s.order=Lt(e);break;case"tx":s.tx=Qt(e);break;case W:s.spPr=ua(e);break;case Y:s.marker=Ir(e);break;case"dPt":r.push(Er(e));break;case oe:s.dLbls=Ar(e);break;case ie:n.push(_r(e));break;case ae:o.push(Br(e));break;case"xVal":s.xVal=Jt(e);break;case"yVal":s.yVal=Vt(e);break;case"smooth":s.smooth=_t(e);break;case y:s.extLst=Ht(e)}return Gr(s,r,n,o),s}function Vr(e){var t,r,n,o,i={seriesType:4};if(3===e.elementType)return i;for(t=e.depth,r=[];e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)if(!(t+1<n||2===o))switch(De(e)){case G:i.idx=Lt(e);break;case re:i.order=Lt(e);break;case"tx":i.tx=Qt(e);break;case W:i.spPr=ua(e);break;case Y:i.marker=Ir(e);break;case"dPt":r.push(Er(e));break;case oe:i.dLbls=Ar(e);break;case"cat":i.cat=Jt(e);break;case d:i.val=Vt(e);break;case y:i.extLst=Ht(e)}return Gr(i,r),i}function zr(e){var t,r,n,o,i,a,s={seriesType:0};if(3===e.elementType)return s;for(t=e.depth,r=[],n=[],o=[];e.read()&&(i=e.depth,a=e.elementType,i!==t||2!==a);)if(!(t+1<i||2===a))switch(De(e)){case G:s.idx=Lt(e);break;case re:s.order=Lt(e);break;case"tx":s.tx=Qt(e);break;case W:s.spPr=ua(e);break;case q:s.invertIfNegative=_t(e);break;case te:s.pictureOptions=_n(e);break;case"dPt":r.push(Er(e));break;case oe:s.dLbls=Ar(e);break;case ie:n.push(_r(e));break;case ae:o.push(Br(e));break;case"cat":s.cat=Jt(e);break;case d:s.val=Vt(e);break;case"shape":s.shape=ln(e);break;case y:s.extLst=Ht(e)}return Gr(s,r,n,o),s}function qr(e){var t,r,n,o,i,a,s={seriesType:1};if(3===e.elementType)return s;for(t=e.depth,r=[],n=[],o=[];e.read()&&(i=e.depth,a=e.elementType,i!==t||2!==a);)if(!(t+1<i||2===a))switch(De(e)){case G:s.idx=Lt(e);break;case re:s.order=Lt(e);break;case"tx":s.tx=Qt(e);break;case W:s.spPr=ua(e);break;case te:s.pictureOptions=_n(e);break;case"dPt":r.push(Er(e));break;case oe:s.dLbls=Ar(e);break;case ie:n.push(_r(e));break;case ae:o.push(Br(e));break;case"cat":s.cat=Jt(e);break;case d:s.val=Vt(e);break;case y:s.extLst=Ht(e)}return Gr(s,r,n,o),s}function Zr(e){var t,r,n,o,i={seriesType:3};if(3===e.elementType)return i;for(t=[],r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case G:i.idx=Lt(e);break;case re:i.order=Lt(e);break;case"tx":i.tx=Qt(e);break;case W:i.spPr=ua(e);break;case"explosion":i.explosion=Lt(e);break;case"dPt":t.push(Er(e));break;case oe:i.dLbls=Ar(e);break;case"cat":i.cat=Jt(e);break;case d:i.val=Vt(e);break;case y:i.extLst=Ht(e)}return Gr(i,t),i}function Yr(e){var t,r,n,o,i,a,s={seriesType:6};if(3===e.elementType)return s;for(t=e.depth,r=[],n=[],o=[];e.read()&&(i=e.depth,a=e.elementType,i!==t||2!==a);)if(!(t+1<i||2===a))switch(De(e)){case G:s.idx=Lt(e);break;case re:s.order=Lt(e);break;case"tx":s.tx=Qt(e);break;case W:s.spPr=ua(e);break;case q:s.invertIfNegative=_t(e);break;case"dPt":r.push(Er(e));break;case oe:s.dLbls=Ar(e);break;case ie:n.push(_r(e));break;case ae:o.push(Br(e));break;case"xVal":s.xVal=Jt(e);break;case"yVal":s.yVal=Vt(e);break;case"bubbleSize":s.bubbleSize=Vt(e);break;case Z:s.bubble3D=_t(e);break;case y:s.extLst=Ht(e)}return Gr(s,r,n,o),s}function Kr(e){var t,r,n,o={seriesType:7};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case G:o.idx=Lt(e);break;case re:o.order=Lt(e);break;case"tx":o.tx=Qt(e);break;case W:o.spPr=ua(e);break;case"cat":o.cat=Jt(e);break;case d:o.val=Vt(e);break;case y:o.extLst=Ht(e)}return o}function Xr(e){var t=Ee(Ne(e,d),"standard");return u.Charts.ST_Grouping[t]}function Jr(e){return Fe(e,W,ua)}function Qr(e){var t,r,n,o={chartType:8,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ce:o.grouping=Xr(e);break;case he:o.varyColors=_t(e);break;case se:o.ser.push(Ur(e));break;case oe:o.dLbls=Ar(e);break;case le:o.dropLines=Jr(e);break;case"hiLowLines":o.hiLowLines=Jr(e);break;case"upDownBars":o.upDownBars=Hr(e);break;case Y:o.marker=_t(e);break;case"smooth":o.smooth=_t(e);break;case ue:o.axId.push(Ot(e));break;case y:o.extLst=Ht(e)}return o}function $r(e){var t,r,n,o={chartType:9,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ce:o.grouping=Xr(e);break;case he:o.varyColors=_t(e);break;case se:o.ser.push(Ur(e));break;case oe:o.dLbls=Ar(e);break;case le:o.dropLines=Jr(e);break;case"gapDepth":o.gapDepth=fr(e);break;case ue:o.axId.push(Ot(e));break;case y:o.extLst=Ht(e)}return o}function en(e){var t,r,n,o={chartType:0,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case se:o.ser.push(Ur(e));break;case oe:o.dLbls=Ar(e);break;case le:o.dropLines=Jr(e);break;case"hiLowLines":o.hiLowLines=Jr(e);break;case"upDownBars":o.upDownBars=Hr(e);break;case ue:o.axId.push(Ot(e));break;case y:o.extLst=Ht(e)}return o}function tn(e){var t=Ee(Ne(e,d),"marker");return u.Charts.ST_ScatterStyle[t]}function rn(e){var t,r,n,o={chartType:1,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"scatterStyle":o.scatterStyle=tn(e);break;case he:o.varyColors=_t(e);break;case se:o.ser.push(Wr(e));break;case oe:o.dLbls=Ar(e);break;case ue:o.axId.push(Ot(e));break;case y:o.extLst=Ht(e)}return o}function nn(e){var t=Ee(Ne(e,d),"standard");return u.Charts.ST_RadarStyle[t]}function on(e){var t,r,n,o={chartType:2,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"radarStyle":o.radarStyle=nn(e);break;case he:o.varyColors=_t(e);break;case se:o.ser.push(Vr(e));break;case oe:o.dLbls=Ar(e);break;case ue:o.axId.push(Ot(e));break;case y:o.extLst=Ht(e)}return o}function an(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_BarGrouping[t]}function sn(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_BarDir[t]}function ln(e){var t=Ee(Ne(e,d),"box");return u.Charts.ST_Shape[t]}function un(e){var t,r,n,o={chartType:6,ser:[],serLines:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"barDir":o.barDir=sn(e);break;case ce:o.grouping=an(e);break;case he:o.varyColors=_t(e);break;case se:o.ser.push(zr(e));break;case oe:o.dLbls=Ar(e);break;case ne:o.gapWidth=fr(e);break;case"overlap":o.overlap=dr(e);break;case"serLines":o.serLines.push(Jr(e));break;case ue:o.axId.push(Ot(e));break;case y:o.extLst=Ht(e)}return o}function cn(e){var t,r,n,o={chartType:7,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"barDir":o.barDir=sn(e);break;case ce:o.grouping=an(e);break;case he:o.varyColors=_t(e);break;case se:o.ser.push(zr(e));break;case oe:o.dLbls=Ar(e);break;case ne:o.gapWidth=fr(e);break;case"gapDepth":o.gapDepth=fr(e);break;case"shape":o.shape=ln(e);break;case ue:o.axId.push(Ot(e));break;case y:o.extLst=Ht(e)}return o}function hn(e){var t,r,n,o={chartType:4,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ce:o.grouping=Xr(e);break;case he:o.varyColors=_t(e);break;case se:o.ser.push(qr(e));break;case oe:o.dLbls=Ar(e);break;case le:o.dropLines=Jr(e);break;case ue:o.axId.push(Ot(e));break;case y:o.extLst=Ht(e)}return o}function fn(e){var t,r,n,o={chartType:5,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ce:o.grouping=Xr(e);break;case he:o.varyColors=_t(e);break;case se:o.ser.push(qr(e));break;case oe:o.dLbls=Ar(e);break;case le:o.dropLines=Jr(e);break;case"gapDepth":o.gapDepth=fr(e);break;case ue:o.axId.push(Ot(e));break;case y:o.extLst=Ht(e)}return o}function dn(e){var t,r,n,o={chartType:10,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case he:o.varyColors=_t(e);break;case se:o.ser.push(Zr(e));break;case oe:o.dLbls=Ar(e);break;case"firstSliceAng":o.firstSliceAng=mr(e);break;case y:o.extLst=Ht(e)}return o}function pn(e){var t,r,n,o={chartType:11,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case he:o.varyColors=_t(e);break;case se:o.ser.push(Zr(e));break;case oe:o.dLbls=Ar(e);break;case y:o.extLst=Ht(e)}return o}function gn(e){var t,r,n,o={chartType:12,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case he:o.varyColors=_t(e);break;case se:o.ser.push(Zr(e));break;case oe:o.dLbls=Ar(e);break;case"firstSliceAng":o.firstSliceAng=mr(e);break;case"holeSize":o.holeSize=br(e);break;case y:o.extLst=Ht(e)}return o}function mn(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_OfPieType[t]}function bn(e){var t,r,n,o={chartType:13,ser:[],serLines:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"ofPieType":o.ofPieType=mn(e);break;case he:o.varyColors=_t(e);break;case se:o.ser.push(Zr(e));break;case oe:o.dLbls=Ar(e);break;case ne:o.gapWidth=fr(e);break;case"splitType":o.splitType=yr(e);break;case"splitPos":o.splitPos=Pt(e);break;case"custSplit":o.custSplit=Cr(e);break;case"secondPieSize":o.secondPieSize=wr(e);break;case"serLines":o.serLines.push(Jr(e));break;case y:o.extLst=Ht(e)}return o}function yn(e){var t,r,n,o={chartType:3,ser:[],axId:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case he:o.varyColors=_t(e);break;case se:o.ser.push(Yr(e));break;case oe:o.dLbls=Ar(e);break;case Z:o.bubble3D=_t(e);break;case"bubbleScale":o.bubbleScale=pr(e);break;case"showNegBubbles":o.showNegBubbles=_t(e);break;case"sizeRepresents":o.sizeRepresents=gr(e);break;case ue:o.axId.push(Ot(e));break;case y:o.extLst=Ht(e)}return o}function Cn(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||((o=De(e))===G?i.idx=Lt(e):o===W&&(i.spPr=ua(e)));return i}function wn(e){var t,r,n,o,i={bandFmt:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("bandFmt"===(o=De(e))?i.bandFmt.push(Cn(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function vn(e){var t={chartType:14,ser:[],axId:[]};return 3===e.elementType?t:Be(e,t)}function Sn(e){var t={chartType:15,ser:[],axId:[]};return 3===e.elementType?t:Be(e,t)}function xn(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_AxPos[t]}function Tn(e){var t=Ne(e,d);if(!p.k(t))return s.ChartHelper.ToAxisCrosses(u.Charts.ST_Crosses[t])}function An(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_CrossBetween[t]}function kn(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_TickMark[t]}function Mn(e){var t=Ee(Ne(e,d),"nextTo");if(!p.k(t))return u.Charts.ST_TickLblPos[t]}function In(e){return Ne(e,d,i)}function En(e){var t=Ee(Ne(e,d),"days");return u.Charts.ST_TimeUnit[t]}function Rn(e){return Ne(e,d,n)}function Dn(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_BuiltInUnit[t]}function Nn(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_PictureFormat[t]}function Fn(e){return Ne(e,d,n)}function _n(e){var t,r,n,o,i,a={};if(3===e.elementType)return a;for(t=e.depth,r={applyToFront:!0,applyToSides:!0,applyToEnd:!0};e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)t+1<n||2===o||(r[i=De(e)]?a[i]=_t(e):"pictureFormat"===i?a.pictureFormat=Nn(e):"pictureStackUnit"===i&&(a.pictureStackUnit=Fn(e)));return a}function Pn(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ee:o.layout=rr(e);break;case"tx":o.tx=Yt(e);break;case W:o.spPr=ua(e);break;case V:o.txPr=za(e)}return o}function Ln(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"custUnit":o.custUnit=Pt(e);break;case"builtInUnit":o.builtInUnit=Dn(e);break;case"dispUnitsLbl":o.dispUnitsLbl=Pn(e);break;case y:o.extLst=Ht(e)}return o}function On(e){var t=Ee(Ne(e,d),"minMax");return u.Charts.ST_Orientation[t]}function Bn(e){return Ne(e,d,n)}function jn(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"logBase":o.logBase=Bn(e);break;case"orientation":o.orientation=On(e);break;case"max":o.max=Pt(e);break;case"min":o.min=Pt(e);break;case y:o.extLst=Ht(e)}return o}function Hn(e){return Ee(Ne(e,d,i),100)}function Gn(e,t){e&&!e.spPr&&(e.spPr=o[t])}function Un(e){var t,r,n,o={axisType:0};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ue:o.axId=Ot(e);break;case fe:o.scaling=jn(e);break;case H:o.delete=_t(e);break;case de:o.axPos=xn(e);break;case pe:o.majorGridlines=Jr(e),Gn(o.majorGridlines,"majorGridlines");break;case ge:o.minorGridlines=Jr(e),Gn(o.minorGridlines,"minorGridlines");break;case me:o.title=nr(e);break;case be:o.numFmt=vr(e);break;case ye:o.majorTickMark=kn(e);break;case Ce:o.minorTickMark=kn(e);break;case we:o.tickLblPos=Mn(e);break;case W:o.spPr=ua(e);break;case V:o.txPr=za(e);break;case ve:o.crossAx=Ot(e);break;case Se:o.crosses=Tn(e);break;case xe:o.crossesAt=Pt(e);break;case"auto":o.auto=_t(e);break;case"lblAlgn":o.lblAlgn=Sr(e);break;case"lblOffset":o.lblOffset=Hn(e);break;case"tickLblSkip":o.tickLblSkip=In(e);break;case"tickMarkSkip":o.tickMarkSkip=In(e);break;case"noMultiLvlLbl":o.noMultiLvlLbl=_t(e);break;case y:o.extLst=Ht(e)}return Gn(o,"axis"),o}function Wn(e){var t,r,n,o={axisType:1};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ue:o.axId=Ot(e);break;case fe:o.scaling=jn(e);break;case H:o.delete=_t(e);break;case de:o.axPos=xn(e);break;case pe:o.majorGridlines=Jr(e),Gn(o.majorGridlines,"majorGridlines");break;case ge:o.minorGridlines=Jr(e),Gn(o.minorGridlines,"minorGridlines");break;case me:o.title=nr(e);break;case be:o.numFmt=vr(e);break;case ye:o.majorTickMark=kn(e);break;case Ce:o.minorTickMark=kn(e);break;case we:o.tickLblPos=Mn(e);break;case W:o.spPr=ua(e);break;case V:o.txPr=za(e);break;case ve:o.crossAx=Ot(e);break;case Se:o.crosses=Tn(e);break;case xe:o.crossesAt=Pt(e);break;case"auto":o.auto=_t(e);break;case"lblOffset":o.lblOffset=Hn(e);break;case"baseTimeUnit":o.baseTimeUnit=En(e);break;case"majorUnit":o.majorUnit=Rn(e);break;case"majorTimeUnit":o.majorTimeUnit=En(e);break;case"minorUnit":o.minorUnit=Rn(e);break;case"minorTimeUnit":o.minorTimeUnit=En(e);break;case y:o.extLst=Ht(e)}return Gn(o,"axis"),o}function Vn(e){var t,r,n,o={axisType:2};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ue:o.axId=Ot(e);break;case fe:o.scaling=jn(e);break;case H:o.delete=_t(e);break;case de:o.axPos=xn(e);break;case pe:o.majorGridlines=Jr(e),Gn(o.majorGridlines,"majorGridlines");break;case ge:o.minorGridlines=Jr(e),Gn(o.minorGridlines,"minorGridlines");break;case me:o.title=nr(e);break;case be:o.numFmt=vr(e);break;case ye:o.majorTickMark=kn(e);break;case Ce:o.minorTickMark=kn(e);break;case we:o.tickLblPos=Mn(e);break;case W:o.spPr=ua(e);break;case V:o.txPr=za(e);break;case ve:o.crossAx=Ot(e);break;case Se:o.crosses=Tn(e);break;case xe:o.crossesAt=Pt(e);break;case"tickLblSkip":o.tickLblSkip=In(e);break;case"tickMarkSkip":o.tickMarkSkip=In(e);break;case y:o.extLst=Ht(e)}return Gn(o,"axis"),o}function zn(e){var t,r,n,o={axisType:3};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ue:o.axId=Ot(e);break;case fe:o.scaling=jn(e);break;case H:o.delete=_t(e);break;case de:o.axPos=xn(e);break;case pe:o.majorGridlines=Jr(e),Gn(o.majorGridlines,"majorGridlines");break;case ge:o.minorGridlines=Jr(e),Gn(o.minorGridlines,"minorGridlines");break;case me:o.title=nr(e);break;case be:o.numFmt=vr(e);break;case ye:o.majorTickMark=kn(e);break;case Ce:o.minorTickMark=kn(e);break;case we:o.tickLblPos=Mn(e);break;case W:o.spPr=ua(e);break;case V:o.txPr=za(e);break;case ve:o.crossAx=Ot(e);break;case Se:o.crosses=Tn(e);break;case xe:o.crossesAt=Pt(e);break;case"crossBetween":o.crossBetween=An(e);break;case"majorUnit":o.majorUnit=Rn(e);break;case"minorUnit":o.minorUnit=Rn(e);break;case"dispUnits":o.dispUnits=Ln(e);break;case y:o.extLst=Ht(e)}return Gn(o,"axis"),o}function qn(e){var t,r,n,o={chartGroups:[],axes:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ee:o.layout=rr(e);break;case"areaChart":o.chartGroups.push(hn(e));break;case"area3DChart":o.chartGroups.push(fn(e));break;case"barChart":o.chartGroups.push(un(e));break;case"bar3DChart":o.chartGroups.push(cn(e));break;case"lineChart":o.chartGroups.push(Qr(e));break;case"line3DChart":o.chartGroups.push($r(e));break;case"stockChart":o.chartGroups.push(en(e));break;case"radarChart":o.chartGroups.push(on(e));break;case"scatterChart":o.chartGroups.push(rn(e));break;case"pieChart":o.chartGroups.push(dn(e));break;case"pie3DChart":o.chartGroups.push(pn(e));break;case"doughnutChart":o.chartGroups.push(gn(e));break;case"ofPieChart":o.chartGroups.push(bn(e));break;case"surfaceChart":o.chartGroups.push(vn(e));break;case"surface3DChart":o.chartGroups.push(Sn(e));break;case"bubbleChart":o.chartGroups.push(yn(e));break;case"catAx":o.axes.push(Un(e));break;case"valAx":o.axes.push(zn(e));break;case"dateAx":o.axes.push(Wn(e));break;case"serAx":o.axes.push(Vn(e));break;case"dTable":o.dTable=hr(e);break;case W:o.spPr=ua(e);break;case y:o.extLst=Ht(e)}return Gn(o,"plotArea"),o}function Zn(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case G:o.idx=Lt(e);break;case W:o.spPr=ua(e);break;case V:o.txPr=za(e);break;case Y:o.marker=Ir(e);break;case"dLbl":o.dLbl=Tr(e);break;case y:o.extLst=Ht(e)}return o}function Yn(e){var t,r,n,o={pivotFmt:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||"pivotFmt"===De(e)&&o.pivotFmt.push(Zn(e));return o}function Kn(e){var t=Ne(e,d);if(!p.k(t))return s.ChartHelper.ToLegendPosition(u.Charts.ST_LegendPos[t])}function Xn(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case G:o.idx=Lt(e);break;case H:o.delete=_t(e);break;case V:o.txPr=za(e);break;case y:o.extLst=Ht(e)}return o}function Jn(e){var t,r,n,o=[],i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"legendPos":i.legendPos=Kn(e);break;case"legendEntry":o.push(Xn(e));break;case ee:i.layout=rr(e);break;case"overlay":i.overlay=_t(e);break;case W:i.spPr=ua(e);break;case V:i.txPr=za(e);break;case y:i.extLst=Ht(e)}return 0<o.length&&(i.legendEntry=o),i}function Qn(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_DispBlanksAs[t]}function $n(e){var t,r,n,o={extDataType:2};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||"dispNaAsBlank"===De(e)&&(o.dispNaAsBlank=Ne(e,d));return o}function eo(e){var t,r,n,o={pivotFmts:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case me:o.title=nr(e);break;case"autoTitleDeleted":o.autoTitleDeleted=_t(e);break;case"pivotFmts":o.pivotFmts.push(Yn(e));break;case"view3D":o.view3D=ur(e);break;case"floor":o.floor=cr(e);break;case"sideWall":o.sideWall=cr(e);break;case"backWall":o.backWall=cr(e);break;case"plotArea":o.plotArea=qn(e);break;case"legend":o.legend=Jn(e);break;case"plotVisOnly":o.plotVisOnly=_t(e);break;case"dispBlanksAs":o.dispBlanksAs=Qn(e);break;case"showDLblsOverMax":o.showDLblsOverMax=_t(e);break;case y:o.extLst=Ht(e)}return o}function to(e){return Ne(e,d)}function ro(e){var t,r,n,o={extLst:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case g:o.name=e.readElementContentAsString();break;case"fmtId":o.fmtId=Lt(e);break;case y:o.extLst.push(Ht(e))}return o}function no(e){var t,r,n,o,i,a={};if(3===e.elementType)return a;for(t=e.depth,r={chartObject:!0,data:!0,formatting:!0,selection:!0,userInterface:!0};e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)t+1<n||2===o||r[i=De(e)]&&(a[i]=_t(e));return a}function oo(e){for(var t,r,n,o,i,a,s={alignWithMargins:!0};e.moveToNextAttribute();)"alignWithMargins"!==(t=Re(e))&&"differentOddEven"!==t&&"differentFirst"!==t||(s[t]=e.readContentAsBoolean());if(3===e.elementType)return s;for(r=e.depth,n={oddHeader:!0,oddFooter:!0,evenHeader:!0,evenFooter:!0,firstHeader:!0,firstFooter:!0};e.read()&&(o=e.depth,i=e.elementType,o!==r||2!==i);)r+1<o||2===i||n[a=De(e)]&&(s[a]=e.readElementContentAsString());return s}function io(e){for(var t,r={},n={l:!0,r:!0,t:!0,b:!0,header:!0,footer:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=e.readContentAsDouble());return r}function ao(e){var t={};return t.id=Ne(e,"id"),Fe(e,"autoUpdate",_t,t)}function so(e){for(var t,r={paperSize:1,firstPageNumber:1,orientation:0,blackAndWhite:!1,draft:!1,useFirstPageNumber:!1,horizontalDpi:600,verticalDpi:600,copies:1},n={paperSize:!0,firstPageNumber:!0,horizontalDpi:!0,verticalDpi:!0,copies:!0},o={blackAndWhite:!0,draft:!0,useFirstPageNumber:!0};e.moveToNextAttribute();)n[t=Re(e)]?r[t]=e.readContentAsInt():o[t]?r[t]=e.readContentAsBoolean():"orientation"===t&&(r.orientation=u.Charts.ST_PageSetupOrientation[e.readContentAsString()]);return r}function lo(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"headerFooter":o.headerFooter=oo(e);break;case"pageMargins":o.pageMargins=io(e);break;case"pageSetup":o.pageSetup=so(e);break;case"legacyDrawingHF":o.legacyDrawingHF=Bt(e)}return o}function uo(e){var t,r,n,o,i={ext:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||((o=De(e))===k?i.ext.push(co(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function co(e){var t,r,n,o={};if(o.uri=Ne(e,"uri"),3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ee:o.layout=rr(e);break;case"dlblFieldTable":o.dlblFieldTable=Co(e);break;case"showDataLabelsRange":o.showDataLabelsRange=_t(e)}return o}function ho(e){var t,r,n,o,i={ext:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||((o=De(e))===k?i.ext.push(fo(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function fo(e){var t,r,n,o={};if(o.uri=Ee(Ne(e,"uri"),"{CE6537A1-D6FC-4f65-9D91-7224C49458BB}"),3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case ee:o.layout=rr(e);break;case"showLeaderLines":o.showLeaderLines=_t(e);break;case"showDataLabelsRange":o.showDataLabelsRange=_t(e);break;case W:o.spPr=ua(e)}return o}function po(e){var t={};return t.id=Ne(e,"id"),Fe(e,"userShapes",xo,t)}function go(e){return Fe(e,W,ua,{extDataType:0})}function mo(e){var t,r,n,o,i={extDataType:1};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("f"===(o=De(e))?i.f=h(e.readElementContentAsString()):"dlblRangeCache"===o&&(i.dlblRangeCache=qt(e)));return i}function bo(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case z:o.sqref=e.readElementContentAsString();break;case W:o.spPr=ua(e);break;case"explosion":o.explosion=Lt(e);break;case q:o.invertIfNegative=_t(e);break;case Z:o.bubble3D=_t(e);break;case Y:o.marker=Ir(e);break;case"dLbl":o.dLbl=Tr(e)}return o}function yo(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"txfldGUID":o.txfldGUID=e.readElementContentAsString();break;case"f":o.f=h(e.readElementContentAsString());break;case"dlblFieldTableCache":o.dlblFieldTableCache=qt(e)}return o}function Co(e){var t,r,n,o,i={dlblFTEntry:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("dlblFTEntry"===(o=De(e))?i.dlblFTEntry.push(yo(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function wo(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("x"!==(o=De(e))&&"y"!==o||(i[o]=e.readElementContentAsDouble()));return i}function vo(e){var t,r,n,o={anchorType:3};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"from":o.startPoint=wo(e);break;case"to":o.endPoint=wo(e);break;case"sp":o.sp=ma(e);break;case K:o.grpSp=Ta(e);break;case T:o.graphicFrame=Sa(e);break;case X:o.cxnSp=ya(e);break;case"pic":o.pic=wa(e)}return o}function So(e){var t,r,n,o,i={anchorType:4};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"from":i.startPoint=wo(e);break;case k:o=ct(e,!0),i.width=o.cx,i.height=o.cy;break;case"sp":i.sp=ma(e);break;case K:i.grpSp=Ta(e);break;case T:i.graphicFrame=Sa(e);break;case X:i.cxnSp=ya(e);break;case"pic":i.pic=wa(e)}return i}function xo(e){var t,r,n,o,i={relSizeAnchor:[],absSizeAnchor:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("relSizeAnchor"===(o=De(e))?i.relSizeAnchor.push(vo(e)):"absSizeAnchor"===o&&i.absSizeAnchor.push(So(e)));return i}function To(e){for(var t,r={noGrp:!1,noSelect:!1,noRot:!1,noChangeAspect:!1,noMove:!1,noResize:!1,noEditPoints:!1,noAdjustHandles:!1,noChangeArrowheads:!1,noChangeShapeType:!1},n={noGrp:!0,noSelect:!0,noRot:!0,noChangeAspect:!0,noMove:!0,noResize:!0,noEditPoints:!0,noAdjustHandles:!0,noChangeArrowheads:!0,noChangeShapeType:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=e.readContentAsBoolean());return Fe(e,y,Tt,r)}function Ao(e){for(var t,r={noGrp:!1,noSelect:!1,noRot:!1,noChangeAspect:!1,noMove:!1,noResize:!1,noEditPoints:!1,noAdjustHandles:!1,noChangeArrowheads:!1,noChangeShapeType:!1,noTextEdit:!1},n={noGrp:!0,noSelect:!0,noRot:!0,noChangeAspect:!0,noMove:!0,noResize:!0,noEditPoints:!0,noAdjustHandles:!0,noChangeArrowheads:!0,noChangeShapeType:!0,noTextEdit:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=e.readContentAsBoolean());return Fe(e,y,Tt,r)}function ko(e){for(var t,r={},n={noGrp:!0,noSelect:!0,noRot:!0,noChangeAspect:!0,noMove:!0,noResize:!0,noEditPoints:!0,noAdjustHandles:!0,noChangeArrowheads:!0,noChangeShapeType:!0,noCrop:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=e.readContentAsBoolean());return Fe(e,y,Tt,r)}function Mo(e){for(var t,r={noGrp:!1,noUngrp:!1,noSelect:!1,noRot:!1,noChangeAspect:!1,noMove:!1,noResize:!1},n={noGrp:!0,noUngrp:!0,noSelect:!0,noRot:!0,noChangeAspect:!0,noMove:!0,noResize:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=e.readContentAsBoolean());return Fe(e,y,Tt,r)}function Io(e){for(var t,r={noGrp:!1,noDrilldown:!1,noSelect:!1,noChangeAspect:!1,noMove:!1,noResize:!1},n={noGrp:!0,noDrilldown:!0,noSelect:!0,noChangeAspect:!0,noMove:!0,noResize:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=e.readContentAsBoolean());return Fe(e,y,Tt,r)}function Eo(e){for(var t,r,n,o,i={};e.moveToNextAttribute();)switch(Re(e)){case"id":i.id=e.readContentAsInt();break;case g:i.name=h(e.readContentAsString());break;case me:i.title=e.readContentAsString();break;case"descr":i.descr=e.readContentAsString();break;case"hidden":i.hidden=e.readContentAsBoolean()}if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("hlinkClick"===(o=De(e))||"hlinkHover"===o?i[o]=Ft(e):o===y&&(i.extLst=Tt(e)));return i}function Ro(e){var t,r,n,o,i={};if(i.txBox=Ee(Ne(e,"txBox",f),!1),3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("spLocks"===(o=De(e))?i.spLocks=Ao(e):o===y&&(i.extLst=Tt(e)));return i}function Do(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"cxnSpLocks":o.cxnSpLocks=To(e);break;case"stCxn":o.stCxn=qi(e);break;case"endCxn":o.endCxn=qi(e);break;case y:o.extLst=Tt(e)}return o}function No(e){var t,r,n,o,i={};if(i.preferRelativeResize=Ne(e,"preferRelativeResize",f),3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("picLocks"===(o=De(e))?i.picLocks=ko(e):o===y&&(i.extLst=Tt(e)));return i}function Fo(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("grpSpLocks"===(o=De(e))?i.grpSpLocks=Mo(e):o===y&&(i.extLst=Tt(e)));return i}function _o(e){var t={};return t.id=Ne(e,"id"),t}function Po(e){for(var t,r,n={},o=e.depth;e.read()&&(t=e.depth,r=e.elementType,t!==o||2!==r);)o+1<t||2===r||"chart"===De(e)&&(n.chart=_o(e));return n}function Lo(e){return Fe(e,"graphicData",Po)}function Oo(e){return e.replace(/&#xA/g,"\n").replace(/&#xD/g,"\r")}function Bo(e){for(var t,r={zoom:1e5};e.moveToNextAttribute();)"fov"===(t=Re(e))||"zoom"===t?r[t]=e.readContentAsInt():t===b&&(r.prst=u.Charts.ST_PresetCameraType[e.readContentAsString()]);return Fe(e,"rot",Et,r)}function jo(e){for(var t,r={};e.moveToNextAttribute();)"rig"===(t=Re(e))?r.rig=u.Charts.ST_LightRigType[e.readContentAsString()]:"dir"===t&&(r.dir=u.Charts.ST_LightRigDirection[e.readContentAsString()]);return Fe(e,"rot",Et,r)}function Ho(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"camera":o.camera=Bo(e);break;case"lightRig":o.lightRig=jo(e);break;case"backdrop":o.backdrop=Go(e);break;case y:o.extLst=Tt(e)}return o}function Go(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"anchor":o.anchor=Mt(e);break;case"norm":o.norm=It(e);break;case"up":o.up=It(e);break;case y:o.extLst=Tt(e)}return o}function Uo(e){for(var t,r={w:76200,h:76200,prst:1};e.moveToNextAttribute();)"w"===(t=Re(e))||"h"===t?r[t]=e.readContentAsInt():t===b&&(r.prst=u.Charts.ST_BevelPresetType[e.readContentAsString()]);return r}function Wo(e){for(var t,r,n,o,i,a,s={};e.moveToNextAttribute();)"z"===(r=Re(e))||"extrusionH"===r||"contourW"===r?(t=e.readContentAsInt(),s[r]=l(t)):"prstMaterial"===r&&(s.prstMaterial=u.Charts.ST_PresetMaterialType[e.readContentAsString()]);if(3===e.elementType)return s;for(n=e.depth;e.read()&&(o=e.depth,i=e.elementType,o!==n||2!==i);)n+1<o||2===i||("bevelT"===(a=De(e))||"bevelB"===a?s[a]=Uo(e):"extrusionClr"===a||"contourClr"===a?s[a]=Dt(e):a===y&&(s.extLst=Tt(e)));return s}function Vo(e){var t={};return t.z=Ee(Ne(e,"z",i),0),t}function zo(e){var t={};return t.thresh=Ne(e,"thresh",i),t}function qo(){return{}}function Zo(){return{}}function Yo(e){var t={};return 3===e.elementType?t:_e(e,t)}function Ko(e){var t={};return t.amt=Ee(Ne(e,"amt",i),1e5),t}function Xo(e){var t={};return t.rad=Ee(Ne(e,"rad",i),0),t}function Jo(e){var t={};return t.a=Ne(e,"a",i),t}function Qo(e){var t={};return t.thresh=Ne(e,"thresh",i),t}function $o(e){for(var t,r={rad:0,grow:!0};e.moveToNextAttribute();)"rad"===(t=Re(e))?r.rad=e.readContentAsInt():"grow"===t&&(r.grow=e.readContentAsBoolean());return r}function ei(e){var t,r,n,o,i={};if(i.useA=Ee(Ne(e,"useA",f),!0),3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("clrFrom"!==(o=De(e))&&"clrTo"!==o||(i[o]=Dt(e)));return i}function ti(e){var t={};return 3===e.elementType?t:_e(e,t)}function ri(e){var t={};return 3===e.elementType?t:_e(e,t)}function ni(e){var t={};return t.rad=Ee(Ne(e,"rad",i),0),3===e.elementType?t:_e(e,t)}function oi(){return{}}function ii(e){for(var t,r={hue:0,sat:0,lum:0};e.moveToNextAttribute();)"hue"!==(t=Re(e))&&"sat"!==t&&"lum"!==t||(r[t]=e.readContentAsInt());return r}function ai(e){for(var t,r={blurRad:0,dist:0,dir:0,shadowEffectType:1};e.moveToNextAttribute();)"blurRad"!==(t=Re(e))&&"dist"!==t&&"dir"!==t||(r[t]=e.readContentAsInt());return 3===e.elementType?r:_e(e,r)}function si(e){for(var t,r={bright:0,contrast:0};e.moveToNextAttribute();)"bright"!==(t=Re(e))&&"contrast"!==t||(r[t]=e.readContentAsInt());return r}function li(e){var t,r,n={blurRad:0,dist:0,dir:0,sx:1e5,sy:1e5,kx:0,ky:0,algn:7,rotWithShape:!0,shadowEffectType:0};for(t={blurRad:!0,dist:!0,dir:!0,sx:!0,sy:!0,kx:!0,ky:!0};e.moveToNextAttribute();)t[r=Re(e)]?n[r]=e.readContentAsInt():"algn"===r?n.algn=u.Charts.ST_RectAlignment[e.readContentAsString()]:r===Ae&&(n.rotWithShape=e.readContentAsBoolean());return 3===e.elementType?n:_e(e,n)}function ui(e){for(var t,r={dist:0,dir:0,shadowEffectType:2};e.moveToNextAttribute();)"dist"===(t=Re(e))||"dir"===t?r[t]=e.readContentAsInt():t===b&&(r.prst=u.Charts.ST_PresetShadowVal[e.readContentAsString()]);return 3===e.elementType?r:_e(e,r)}function ci(e){for(var t,r={blurRad:0,stA:1e5,stPos:0,endA:0,endPos:1e5,dist:0,dir:0,fadeDir:54e5,sx:1e5,sy:1e5,kx:0,ky:0,algn:7,rotWithShape:!0},n={blurRad:!0,stA:!0,stPos:!0,endA:!0,endPos:!0,dist:!0,dir:!0,fadeDir:!0,sx:!0,sy:!0,kx:!0,ky:!0};e.moveToNextAttribute();)n[t=Re(e)]?r[t]=e.readContentAsInt():"algn"===t?r.algn=u.Charts.ST_RectAlignment[e.readContentAsString()]:t===Ae&&(r.rotWithShape=e.readContentAsBoolean());return r}function hi(e){for(var t,r={tx:0,ty:0};e.moveToNextAttribute();)"tx"!==(t=Re(e))&&"ty"!==t||(r[t]=e.readContentAsInt());return r}function fi(e){var t={};return t.rad=Ne(e,"rad",i),t}function di(e){for(var t,r={hue:0,amt:0};e.moveToNextAttribute();)"hue"!==(t=Re(e))&&"amt"!==t||(r[t]=e.readContentAsInt());return r}function pi(e){for(var t,r={sx:1e5,sy:1e5,kx:0,ky:0,tx:0,ty:0},n={sx:!0,sy:!0,kx:!0,ky:!0,tx:!0,ty:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=e.readContentAsInt());return r}function gi(){return!0}function mi(e){var t={};return 3===e.elementType?t:_e(e,t)}function bi(e){for(var t,r={};e.moveToNextAttribute();)"ang"===(t=Re(e))?r.ang=e.readContentAsInt():"scaled"===t&&(r.scaled=e.readContentAsBoolean());return r}function yi(e){var t={},r=Ne(e,"path");return p.k(r)||(t.path=u.Charts.ST_PathShadeType[r]),Fe(e,"fillToRect",Rt,t)}function Ci(e){var t={};return t.pos=Ne(e,"pos",i),3===e.elementType?t:_e(e,t)}function wi(e){var t,r,n,o,i={gs:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("gs"===(o=De(e))?i.gs.push(Ci(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function vi(e){for(var t,r,n,o,i={rotWithShape:!0};e.moveToNextAttribute();)"flip"===(t=Re(e))?i.flip=u.Charts.ST_TileFlipMode[e.readContentAsString()]:t===Ae&&(i.rotWithShape=e.readContentAsBoolean());if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"gsLst":i.gsLst=wi(e);break;case"lin":i.lin=bi(e);break;case"path":i.path=yi(e);break;case"tileRect":i.tileRect=Rt(e)}return i}function Si(e){for(var t,r,n={},o={tx:!0,ty:!0,sx:!0,sy:!0},i={tx:!0,ty:!0};e.moveToNextAttribute();)o[r=Re(e)]?(t=e.readContentAsInt(),i[r]&&(t=l(t)),n[r]=t):"flip"===r?n.flip=u.Charts.ST_TileFlipMode[e.readContentAsString()]:"algn"===r&&(n.algn=u.Charts.ST_RectAlignment[e.readContentAsString()]);return n}function xi(e){return Fe(e,"fillRect",Rt)}function Ti(e){for(var t,r,n,o,i={cstate:4};e.moveToNextAttribute();)"embed"===(t=Re(e))||"link"===t?i[t]=e.readContentAsString():"cstate"===t&&(i.cstate=u.Charts.ST_BlipCompression[e.readContentAsString()]);if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"alphaBiLevel":i.alphaBiLevel=zo(e);break;case"alphaCeiling":i.alphaCeiling={};break;case"alphaFloor":i.alphaFloor={};break;case"alphaInv":i.alphaInv=Yo(e);break;case"alphaMod":i.alphaMod=_i(e);break;case"alphaModFix":i.alphaModFix=Ko(e);break;case"alphaRepl":i.alphaRepl=Jo(e);break;case"biLevel":i.biLevel=Qo(e);break;case"blur":i.blur=$o(e);break;case"clrChange":i.clrChange=ei(e);break;case"clrRepl":i.clrRepl=ti(e);break;case"duotone":i.duotone=ri(e);break;case"fillOverlay":i.fillOverlay=Di(e);break;case"grayscl":i.grayscl={};break;case"hsl":i.hsl=ii(e);break;case"lum":i.lum=si(e);break;case"tint":i.tint=di(e);break;case"blipBlob":i.blipBlob=Ai(e);break;case y:i.extLst=Tt(e)}return i}function Ai(e){var t,r,n,o={},i=Ee(Ne(e,m),0);if(p.k(i)||(o.type=u.Charts.ST_BobType[i]),3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||"blob"===De(e)&&(o.blob=e.readElementContentAsString());return o}function ki(e){for(var t,r,n,o,i={};e.moveToNextAttribute();)"dpi"===(t=Re(e))?i.dpi=e.readContentAsInt():t===Ae&&(i.rotWithShape=e.readContentAsBoolean());if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"blip":i.blip=Ti(e);break;case"srcRect":i.srcRect=Rt(e);break;case"tile":i.tile=Si(e);break;case"stretch":i.stretch=xi(e)}return i}function Mi(e){var t,r,n,o,i={},a=Ne(e,b);if(p.k(a)||(i.prst=s.ChartHelper.ToPatternType(u.Charts.ST_PresetPatternVal[a])),3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("fgClr"!==(o=De(e))&&"bgClr"!==o||(i[o]=Dt(e)));return i}function Ii(){return{}}function Ei(e){var t={};return 3===e.elementType?t:Pe(e,t)}function Ri(e){var t={};return 3===e.elementType?t:Pe(e,t)}function Di(e){var t={},r=Ne(e,"blend");return p.k(r)||(t.blend=u.Charts.ST_BlendMode[r]),3===e.elementType?t:Pe(e,t)}function Ni(e){var t={};return t.ref=Ne(e,"ref"),t}function Fi(e){for(var t,r,n,o,i={type:0};e.moveToNextAttribute();)(t=Re(e))===m?i.type=u.Charts.ST_EffectContainerType[e.readContentAsString()]:t===g&&(i.name=e.readContentAsString());if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"cont":i.cont=Fi(e);break;case"effect":i.effect=Ni(e);break;case"alphaBiLevel":i.alphaBiLevel=zo(e);break;case"alphaCeiling":i.alphaCeiling={};break;case"alphaFloor":i.alphaFloor={};break;case"alphaInv":i.alphaInv=Yo(e);break;case"alphaMod":i.alphaMod=_i(e);break;case"alphaModFix":i.alphaModFix=Ko(e);break;case"alphaOutset":i.alphaOutset=Xo(e);break;case"alphaRepl":i.alphaRepl=Jo(e);break;case"biLevel":i.biLevel=Qo(e);break;case"blend":i.blend=Pi(e);break;case"blur":i.blur=$o(e);break;case"clrChange":i.clrChange=ei(e);break;case"clrRepl":i.clrRepl=ti(e);break;case"duotone":i.duotone=ri(e);break;case"fill":i.fill=Ri(e);break;case"fillOverlay":i.fillOverlay=Di(e);break;case"glow":i.glow=ni(e);break;case"grayscl":i.grayscl={};break;case"hsl":i.hsl=ii(e);break;case"innerShdw":i.innerShdw=ai(e);break;case"lum":i.lum=si(e);break;case"outerShdw":i.outerShdw=li(e);break;case"prstShdw":i.prstShdw=ui(e);break;case"reflection":i.reflection=ci(e);break;case"relOff":i.relOff=hi(e);break;case"softEdge":i.softEdge=fi(e);break;case"tint":i.tint=di(e);break;case"xfrm":i.xfrm=pi(e)}return i}function _i(e){return Fe(e,"cont",Fi)}function Pi(e){var t={},r=Ne(e,"blend");return p.k(r)||(t.blend=u.Charts.ST_BlendMode[r]),Fe(e,"cont",Fi,t)}function Li(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"blur":o.blur=$o(e);break;case"fillOverlay":o.fillOverlay=Di(e);break;case"glow":o.glow=ni(e);break;case"innerShdw":o.innerShdw=ai(e);break;case"outerShdw":o.outerShdw=li(e);break;case"prstShdw":o.prstShdw=ui(e);break;case"reflection":o.reflection=ci(e);break;case"softEdge":o.softEdge=fi(e)}return o}function Oi(e){for(var t,r={};e.moveToNextAttribute();)(t=Re(e))!==g&&"fmla"!==t||(r[t]=e.readContentAsString());return r}function Bi(e){var t,r,n,o,i={gd:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("gd"===(o=De(e))?i.gd.push(Oi(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function ji(e){for(var t,r={};e.moveToNextAttribute();)"x"!==(t=Re(e))&&"y"!==t||(r[t]=e.readContentAsString());return r}function Hi(e){for(var t,r={},n={l:!0,t:!0,r:!0,b:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=e.readContentAsString());return r}function Gi(e){for(var t,r={};e.moveToNextAttribute();)"gdRefX"!==(t=Re(e))&&"gdRefY"!==t||(r[t]=e.readContentAsString());return Fe(e,"pos",ji,r)}function Ui(e){for(var t,r={};e.moveToNextAttribute();)"gdRefR"!==(t=Re(e))&&"gdRefAng"!==t||(r[t]=e.readContentAsString());return Fe(e,"pos",ji,r)}function Wi(e){var t={};return t.ang=Ne(e,"ang"),Fe(e,"pos",ji,t)}function Vi(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("ahXY"===(o=De(e))?i.ahXY=Gi(e):"ahPolar"===o&&(i.ahPolar=Ui(e)));return i}function zi(e){var t,r,n,o,i={cxn:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("cxn"===(o=De(e))?i.cxn.push(Wi(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function qi(e){for(var t,r={};e.moveToNextAttribute();)"id"!==(t=Re(e))&&t!==G||(r[t]=e.readContentAsInt());return r}function Zi(e,t){var r,n,o,i={PtList:[],typeName:u.Charts.CT_PathType.CT_PathToList};if(i.pathToType=t,3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)r+1<n||2===o||"pt"===De(e)&&i.PtList.push(ji(e));return i}function Yi(){return{typeName:u.Charts.CT_PathType.CT_Path2DArcTo}}function Ki(){return{typeName:u.Charts.CT_PathType.CT_Path2DClose}}function Xi(e){for(var t,r,n,o,i={quadBezTo:[],cubicBezTo:[],w:0,h:0,fill:1,stroke:!0,extrusionOk:!0,pathToList:[]};e.moveToNextAttribute();)"w"===(t=Re(e))||"h"===t?i[t]=e.readContentAsInt():"stroke"===t||"extrusionOk"===t?i[t]=e.readContentAsBoolean():"fill"===t&&(i.fill=u.Charts.ST_PathFillMode[e.readContentAsString()]);if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"close":i.pathToList.push(Ki());break;case"moveTo":i.pathToList.push(Zi(e,1));break;case"lnTo":i.pathToList.push(Zi(e,0));break;case"arcTo":i.pathToList.push(Yi());break;case"quadBezTo":i.pathToList.push(Zi(e,2));break;case"cubicBezTo":i.pathToList.push(Zi(e,3))}return i}function Ji(e){var t,r,n,o=[];if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||"path"===De(e)&&o.push(Xi(e));return o}function Qi(e){var t={},r=Ne(e,b);return p.k(r)||(t.prst=u.Charts.ST_ShapeType[r]),Fe(e,"avLst",Bi,t)}function $i(e){var t={},r=Ne(e,b);return p.k(r)||(t.prst=u.Charts.ST_TextShapeType[r]),Fe(e,"avLst",Bi,t)}function ea(e){var t,r,n,o={pathLst:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"avLst":o.avLst=Bi(e);break;case"gdLst":o.gdLst=Bi(e);break;case"ahLst":o.ahLst=Vi(e);break;case"cxnLst":o.cxnLst=zi(e);break;case"rect":o.rect=Hi(e);break;case"pathLst":o.pathLst=Ji(e)}return o}function ta(e){for(var t={w:1,len:1};e.moveToNextAttribute();)switch(Re(e)){case m:t.type=u.Charts.ST_LineEndType[e.readContentAsString()];break;case"w":t.w=u.Charts.ST_LineEndWidth[e.readContentAsString()];break;case"len":t.len=u.Charts.ST_LineEndLength[e.readContentAsString()]}return t}function ra(){return{}}function na(){return!0}function oa(e){var t={};return t.lim=Ne(e,"lim",i),t}function ia(e){var t=Ne(e,d);if(!p.k(t))return u.Charts.ST_PresetLineDashVal[t]}function aa(e){for(var t,r={};e.moveToNextAttribute();)"d"!==(t=Re(e))&&"sp"!==t||(r[t]=e.readContentAsInt());return r}function sa(e){var t,r,n,o,i={ds:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("ds"===(o=De(e))?i.ds.push(aa(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function la(e){for(var t,r,n,o={};e.moveToNextAttribute();)switch(Re(e)){case"w":o.w=l(e.readContentAsInt());break;case"cap":o.cap=u.Charts.ST_LineCap[e.readContentAsString()];break;case"cmpd":o.cmpd=u.Charts.ST_CompoundLine[e.readContentAsString()];break;case"algn":o.algn=u.Charts.ST_PenAlignment[e.readContentAsString()]}if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case _:o.noFill=!0;break;case P:o.solidFill=mi(e);break;case L:o.gradFill=vi(e);break;case B:o.pattFill=Mi(e);break;case"prstDash":o.prstDash=ia(e);break;case"custDash":o.custDash=sa(e);break;case"round":o.round=!0;break;case"bevel":o.bevel={};break;case"miter":o.miter=oa(e);break;case"headEnd":o.headEnd=ta(e);break;case"tailEnd":o.tailEnd=ta(e);break;case y:o.extLst=Tt(e)}return 0!==o.w||o.noFill||(o.w=1),o}function ua(e){var t,r,n,o={},i=Ne(e,"bwMode");if(p.k(i)||(o.bwMode=u.Charts.ST_BlackWhiteMode[i]),3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"xfrm":o.xfrm=At(e);break;case"custGeom":o.custGeom=ea(e);break;case"prstGeom":o.prstGeom=Qi(e);break;case _:o.noFill=!0;break;case P:o.solidFill=mi(e);break;case L:o.gradFill=vi(e);break;case O:o.blipFill=ki(e);break;case B:o.pattFill=Mi(e);break;case j:o.grpFill={};break;case"ln":o.ln=la(e);break;case v:o.effectLst=Li(e);break;case S:o.effectDag=Fi(e);break;case U:o.scene3d=Ho(e);break;case"sp3d":o.sp3d=Wo(e);break;case y:o.extLst=Tt(e)}return o}function ca(e){var t,r,n,o={},i=Ne(e,"bwMode");if(p.k(i)||(o.bwMode=u.Charts.ST_BlackWhiteMode[i]),3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"xfrm":o.xfrm=kt(e);break;case _:o.noFill=!0;break;case P:o.solidFill=mi(e);break;case L:o.gradFill=vi(e);break;case O:o.blipFill=ki(e);break;case B:o.pattFill=Mi(e);break;case j:o.grpFill={};break;case v:o.effectLst=Li(e);break;case S:o.effectDag=Fi(e);break;case U:o.scene3d=Ho(e);break;case y:o.extLst=Tt(e)}return o}function ha(e){var t,r,n,o={ColorProp:{}};if(o[G]=Ne(e,G,i),3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case M:o.ColorProp.scrgbClr=mt(e);break;case I:o.ColorProp.srgbClr=yt(e);break;case E:o.ColorProp.hslClr=Ct(e);break;case R:o.ColorProp.sysClr=wt(e);break;case D:o.ColorProp.schemeClr=vt(e);break;case N:o.ColorProp.prstClr=St(e);break;case F:o.ColorProp.styleClr=xt(e)}return o}function fa(e){var t,r,n,o,i={TextCharacterProperties:{}};if(i[G]=Ne(e,G),i.idx&&(i.idx=u.Charts.ST_FontCollectionIndex[i.idx]),3===e.elementType)return i;for(t=i.TextCharacterProperties.solidFill={},r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case M:t.scrgbClr=mt(e);break;case I:t.srgbClr=yt(e);break;case E:t.hslClr=Ct(e);break;case R:t.sysClr=wt(e);break;case D:t.schemeClr=vt(e);break;case N:t.prstClr=St(e)}return i}function da(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("lnRef"===(o=De(e))||"fillRef"===o||"effectRef"===o?i[o]=ha(e):"fontRef"===o&&(i.fontRef=fa(e)));return i}function pa(e){for(var t,r={fLocksWithSheet:!0,fPrintsWithSheet:!0};e.moveToNextAttribute();)"fLocksWithSheet"!==(t=Re(e))&&"fPrintsWithSheet"!==t||(r[t]=e.readContentAsBoolean());return r}function ga(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||((o=De(e))===C?i.cNvPr=Eo(e):"cNvSpPr"===o&&(i.cNvSpPr=Ro(e)));return i}function ma(e){for(var t,r,n,o,i={shapeType:5};e.moveToNextAttribute();)(t=Re(e))===w||"textlink"===t?i[t]=e.readContentAsString():"fLocksText"!==t&&t!==x||(i[t]=e.readContentAsBoolean());if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"nvSpPr":i.nvSpPr=ga(e);break;case W:i.spPr=ua(e);break;case Te:i.style=da(e);break;case"txBody":i.txBody=za(e)}return i}function ba(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||((o=De(e))===C?i.cNvPr=Eo(e):"cNvCxnSpPr"===o&&(i.cNvCxnSpPr=Do(e)));return i}function ya(e){for(var t,r,n,o,i={shapeType:4};e.moveToNextAttribute();)(t=Re(e))===w?i.macro=e.readContentAsString():t===x&&(i.fPublished=e.readContentAsBoolean());if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"nvCxnSpPr":i.nvCxnSpPr=ba(e);break;case W:i.spPr=ua(e);break;case Te:i.style=da(e)}return i}function Ca(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||((o=De(e))===C?i.cNvPr=Eo(e):"cNvPicPr"===o&&(i.cNvPicPr=No(e)));return i}function wa(e){for(var t,r,n,o,i={shapeType:1};e.moveToNextAttribute();)(t=Re(e))===w?i.macro=e.readContentAsString():t===x&&(i.fPublished=e.readContentAsBoolean());if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"nvPicPr":i.nvPicPr=Ca(e);break;case O:i.blipFill=ki(e);break;case W:i.spPr=ua(e);break;case Te:i.style=da(e)}return i}function va(e){return je(e)}function Sa(e){for(var t,r,n,o,i={shapeType:2};e.moveToNextAttribute();)(t=Re(e))===w?i.macro=e.readContentAsString():t===x&&(i.fPublished=e.readContentAsBoolean());if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"nvGraphicFramePr":i.nvGraphicFramePr=va(e);break;case"xfrm":i.xfrm=At(e);break;case"graphic":i.graphic=Lo(e)}return i}function xa(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||((o=De(e))===C?i.cNvPr=Eo(e):"cNvGrpSpPr"===o&&(i.cNvGrpSpPr=Fo(e)));return i}function Ta(e){var t,r,n,o,i,a={shapeType:3,sp:[]};if(3===e.elementType)return a;for(t=e.depth,r=!1;(r||e.read())&&(r=!1,n=e.depth,o=e.elementType,n!==t||2!==o);)if(!(t+1<n||2===o))switch(De(e)){case"nvGrpSpPr":a.nvGrpSpPr=xa(e);break;case"grpSpPr":a.grpSpPr=ca(e);break;case"sp":a.sp.push(ma(e));break;case K:a.sp.push(Ta(e));break;case T:a.sp.push(Sa(e));break;case X:a.sp.push(ya(e));break;case"pic":a.sp.push(wa(e));break;case"AlternateContent":Aa(i=Ia(e))&&a.sp.push(i),r=!0}return a}function Aa(e){return e&&e.Choice&&e.Choice.GraphicalObjectFrame&&e.Choice.GraphicalObjectFrame.graphic&&e.Choice.GraphicalObjectFrame.graphic.graphicData&&e.Choice.GraphicalObjectFrame.graphic.graphicData.slicer}function ka(e){var t,r,n,o,i,a={};if(3===e.elementType)return a;for(t=e.depth,r={col:!0,row:!0};e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)t+1<n||2===o||(r[i=De(e)]?a[i]=e.readElementContentAsInt():"rowOff"===i?a.rowOffset=l(e.readElementContentAsInt()):"colOff"===i&&(a.colOffset=l(e.readElementContentAsInt())));return a}function Ma(e){var t,r,n,o,i={anchorType:0},a=Ne(e,"editAs");if(p.k(a)||(i.editAs=u.Charts.ST_EditAs[a]),3===e.elementType)return i;for(t=e.depth,r=!1;(r||e.read())&&(r=!1,n=e.depth,o=e.elementType,n!==t||2!==o);)if(!(t+1<n||2===o))switch(De(e)){case"from":i.startPoint=ka(e);break;case"to":i.endPoint=ka(e);break;case"sp":i.sp=ma(e);break;case K:i.grpSp=Ta(e);break;case T:i.graphicFrame=Sa(e);break;case X:i.cxnSp=ya(e);break;case"pic":i.pic=wa(e);break;case"AlternateContent":i.AlternateContent=Ia(e),r=!0;break;case"clientData":i.clientData=pa(e)}return i}function Ia(e){for(var t,r,n,o,i={shapeType:0};e.moveToNextAttribute();)i.AlternateContent=e.readContentAsString().replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("Choice"===(o=De(e))?i.Choice=Ea(e):"Fallback"===o&&(i.Fallback={},i.Fallback.Shape=ma(e)));return i}function Ea(e){for(var t,r,n,o,i,a={};e.moveToNextAttribute();)Re(e)===ke?(t=e.readContentAsString(),a.Requires=0!==t&&1!==t?t:f(t)):a.cx=e.readContentAsString();if(3===e.elementType)return a;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)r+1<n||2===o||((i=De(e))===T?a.GraphicalObjectFrame=Sa(e):"sp"===i?a.sp=ma(e):i===K?a.grpSp=Ta(e):i===X&&(a.cxnSp=ya(e)));return a}function Ra(e){var t,r,n,o,i,a={anchorType:1};if(3===e.elementType)return a;for(t=e.depth,r=!1;(r||e.read())&&(r=!1,n=e.depth,o=e.elementType,n!==t||2!==o);)if(!(t+1<n||2===o))switch(De(e)){case"from":a.startPoint=ka(e);break;case k:i=ct(e,!0),a.width=i.cx,a.height=i.cy;break;case"sp":a.sp=ma(e);break;case K:a.grpSp=Ta(e);break;case T:a.graphicFrame=Sa(e);break;case X:a.cxnSp=ya(e);break;case"pic":a.pic=wa(e);break;case"AlternateContent":a.AlternateContent=Ia(e),r=!0;break;case"clientData":a.clientData=pa(e)}return a}function Da(e){var t,r,n,o,i,a,s={anchorType:2};if(3===e.elementType)return s;for(t=e.depth,r=!1;(r||e.read())&&(r=!1,n=e.depth,o=e.elementType,n!==t||2!==o);)if(!(t+1<n||2===o))switch(De(e)){case"pos":i=ut(e,!0),s.x=i.x,s.y=i.y;break;case k:a=ct(e,!0),s.width=a.cx,s.height=a.cy;break;case"sp":s.sp=ma(e);break;case K:s.grpSp=Ta(e);break;case T:s.graphicFrame=Sa(e);break;case X:s.cxnSp=ya(e);break;case"pic":s.pic=wa(e);break;case"AlternateContent":s.AlternateContent=Ia(e),r=!0;break;case"clientData":s.clientData=pa(e)}return s}function Na(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case W:o.spPr=ua(e);break;case"bodyPr":o.bodyPr=Va(e);break;case"lstStyle":o.lstStyle=ja(e);break;case Te:o.style=da(e);break;case y:o.extLst=Tt(e)}return o}function Fa(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("spDef"===(o=De(e))||"lnDef"===o||"txDef"===o?i[o]=Na(e):o===y&&(i.extLst=Tt(e)));return i}function _a(){return{}}function Pa(e){for(var t,r={},n={bg1:!0,tx1:!0,bg2:!0,tx2:!0,accent1:!0,accent2:!0,accent3:!0,accent4:!0,accent5:!0,accent6:!0,hlink:!0,folHlink:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=u.Charts.ST_ColorSchemeIndex[e.readContentAsString()]);return Fe(e,y,Tt,r)}function La(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||((o=De(e))===J?i.clrScheme=Ge(e):"clrMap"===o&&(i.clrMap=Pa(e)));return i}function Oa(e){var t,r,n,o,i={extraClrScheme:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("extraClrScheme"===(o=De(e))?i.extraClrScheme.push(La(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function Ba(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth,r=[];e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)if(!(t+1<n||2===o))switch(De(e)){case"pPr":i.pPr=hs(e);break;case"r":r.push(a.DrawingReader.ReadCT_RegularTextRun(e));break;case"br":r.push(a.DrawingReader.ReadCT_TextLineBreak(e));break;case"fld":r.push(a.DrawingReader.ReadCT_TextField(e));break;case"endParaRPr":i.endParaRPr=is(e)}return 0<r.length&&(i.elements=r),i}function ja(e){var t,r,n,o,i,a={};if(3===e.elementType)return a;for(t=e.depth,r={defPPr:!0,lvl1pPr:!0,lvl2pPr:!0,lvl3pPr:!0,lvl4pPr:!0,lvl5pPr:!0,lvl6pPr:!0,lvl7pPr:!0,lvl8pPr:!0,lvl9pPr:!0};e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)t+1<n||2===o||(r[i=De(e)]?a[i]=hs(e):i===y&&(a.extLst=Tt(e)));return a}function Ha(e){for(var t,r={fontScale:1e5,lnSpcReduction:0};e.moveToNextAttribute();)"fontScale"!==(t=Re(e))&&"lnSpcReduction"!==t||(r[t]=e.readContentAsInt());return r}function Ga(){return!0}function Ua(){return{}}function Wa(e){return e/6e4}function Va(e){for(var t,r,n,o,i,a={},s={lIns:!0,tIns:!0,rIns:!0,bIns:!0,numCol:!0,spcCol:!0},l={spcFirstLastPara:!0,rtlCol:!0,fromWordArt:!0,anchorCtr:!0,forceAA:!0,upright:!0,compatLnSpc:!0};e.moveToNextAttribute();)s[t=Re(e)]?a[t]=e.readContentAsInt():l[t]?a[t]=e.readContentAsBoolean():"rot"===t?(r=e.readContentAsInt(),p.k(r)||-6e7===r||(a.rot=r/6e4)):"vertOverflow"===t?a.vertOverflow=u.Charts.ST_TextVertOverflowType[e.readContentAsString()]:"horzOverflow"===t?a.horzOverflow=u.Charts.ST_TextHorzOverflowType[e.readContentAsString()]:"vert"===t?a.vert=u.Charts.ST_TextVerticalType[e.readContentAsString()]:"wrap"===t?a.wrap=u.Charts.ST_TextWrappingType[e.readContentAsString()]:"anchor"===t&&(a.anchor=u.Charts.ST_TextAnchoringType[e.readContentAsString()]);if(3===e.elementType)return a;for(n=e.depth;e.read()&&(o=e.depth,i=e.elementType,o!==n||2!==i);)if(!(n+1<o||2===i))switch(De(e)){case"prstTxWarp":a.prstTxWarp=$i(e);break;case"noAutofit":a.noAutofit={};break;case"normAutofit":a.normAutofit=Ha(e);break;case"spAutoFit":a.spAutoFit=!0;break;case U:a.scene3d=Ho(e);break;case"sp3d":a.sp3d=Wo(e);break;case"flatTx":a.flatTx=Vo(e);break;case y:a.extLst=Tt(e)}return a}function za(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth,r=[];e.read()&&(n=e.depth,o=e.elementType,n!==t||2!==o);)if(!(t+1<n||2===o))switch(De(e)){case"bodyPr":i.bodyPr=Va(e);break;case"lstStyle":i.lstStyle=ja(e);break;case"p":r.push(Ba(e))}return 0<r.length&&(i.p=r),i}function qa(){return{}}function Za(){return{}}function Ya(e){return Ne(e,d,i)}function Ka(e){return Ne(e,d,i)}function Xa(){return{}}function Ja(e){for(var t,r={startAt:1};e.moveToNextAttribute();)(t=Re(e))===m?r.type=u.Charts.ST_TextAutonumberScheme[e.readContentAsString()]:"startAt"===t&&(r.startAt=e.readContentAsInt());return r}function Qa(e){var t={};return t.char=Ne(e,"char"),t}function $a(e){return Fe(e,"blip",Ti)}function es(){return{}}function ts(e){for(var t,r={pitchFamily:0,charset:1},n={typeface:!0,panose:!0,pitchFamily:!0,charset:!0};e.moveToNextAttribute();)n[t=Re(e)]&&(r[t]=e.readContentAsString());return r}function rs(){return{}}function ns(){return{}}function os(e){var t={};return 3===e.elementType?t:Pe(e,t)}function is(e){for(var t,r,n,o,i={},a={kern:!0,spc:!0,baseline:!0,smtId:!0},s={kumimoji:!0,normalizeH:!0,noProof:!0,dirty:!0,err:!0,smtClean:!0},l={altLang:!0,bmk:!0};e.moveToNextAttribute();)a[t=Re(e)]?i[t]=e.readContentAsInt():s[t]?i[t]=e.readContentAsBoolean():l[t]?i[t]=e.readContentAsString():"sz"===t?i.sz=c.UnitHelper.pointToPixel(e.readContentAsInt()/100):"b"===t?i.b=e.readContentAsBoolean():"i"===t?i.i=e.readContentAsBoolean():"u"===t?i.u=u.Charts.ST_TextUnderlineType[e.readContentAsString()]:"strike"===t?i.strike=u.Charts.ST_TextStrikeType[e.readContentAsString()]:"cap"===t&&(i.cap=u.Charts.ST_TextCapsType[e.readContentAsString()]);if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"ln":i.ln=la(e);break;case _:i.noFill=!0;break;case P:i.solidFill=mi(e);break;case L:i.gradFill=vi(e);break;case O:i.blipFill=ki(e);break;case B:i.pattFill=Mi(e);break;case j:i.grpFill={};break;case v:i.effectLst=Li(e);break;case S:i.effectDag=Fi(e);break;case"highlight":i.highlight=Dt(e);break;case"uLnTx":i.uLnTx={};break;case"uLn":i.uLn=la(e);break;case"uFillTx":i.uFillTx={};break;case"uFill":i.uFill=os(e);break;case"latin":i.latin=ts(e);break;case"ea":i.ea=ts(e);break;case"cs":i.cs=ts(e);break;case"sym":i.sym=ts(e);break;case"hlinkClick":i.hlinkClick=Ft(e);break;case"hlinkMouseOver":i.hlinkMouseOver=Ft(e);break;case y:i.extLst=Tt(e)}return i}function as(e){return Ne(e,d,i)}function ss(e){return Ne(e,d,i)}function ls(e){for(var t,r={};e.moveToNextAttribute();)"pos"===(t=Re(e))?r.pos=e.readContentAsInt():"algn"===t&&(r.algn=u.Charts.ST_TextTabAlignType[e.readContentAsString()]);return r}function us(e){var t,r,n,o,i={tab:[]};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("tab"===(o=De(e))?i.tab.push(ls(e)):o===A&&(i.dumy=e.readElementContentAsBoolean()));return i}function cs(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("spcPct"===(o=De(e))?i.spcPct=as(e):"spcPts"===o&&(i.spcPts=ss(e)));return i}function hs(e){for(var t,r,n,o,i={},a={marL:!0,marR:!0,lvl:!0,indent:!0,defTabSz:!0},s={rtl:!0,eaLnBrk:!0,latinLnBrk:!0,hangingPunct:!0};e.moveToNextAttribute();)a[t=Re(e)]?i[t]=e.readContentAsInt():s[t]?i[t]=e.readContentAsBoolean():"fontAlgn"===t?i.fontAlgn=u.Charts.ST_TextFontAlignType[e.readContentAsString()]:"algn"===t&&(i.algn=u.Charts.ST_TextAlignType[e.readContentAsString()]);if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"lnSpc":i.lnSpc=cs(e);break;case"spcBef":i.spcBef=cs(e);break;case"spcAft":i.spcAft=cs(e);break;case"buClrTx":i.buClrTx={};break;case"buClr":i.buClr=Dt(e);break;case"buSzTx":i.buSzTx={};break;case"buSzPct":i.buSzPct=Ya(e);break;case"buSzPts":i.buSzPts=Ka(e);break;case"buFontTx":i.buFontTx={};break;case"buFont":i.buFont=ts(e);break;case"buNone":i.buNone={};break;case"buAutoNum":i.buAutoNum=Ja(e);break;case"buChar":i.buChar=Qa(e);break;case"buBlip":i.buBlip=$a(e);break;case"tabLst":i.tabLst=us(e);break;case"defRPr":i.defRPr=is(e);break;case y:i.extLst=Tt(e)}return i}Object.defineProperty(a,"__esModule",{value:!0}),u=t("./src/datamodel/chart-model.ts"),c=t("./src/datamodel/excel-style.ts"),s=t("./src/xlsx-io/common/chart-helper.ts"),p=t("./src/common/common.ts"),r=t("./src/xml-io/node-helper.ts"),l=c.UnitHelper.emuToPixles,h=p.Util.ta,f=r.XmlNodeHelper.Xl,n=r.XmlNodeHelper.Yl,i=r.XmlNodeHelper.Zl,d="val",g="name",m="type",b="prst",y="extLst",C="cNvPr",w="macro",v="effectLst",S="effectDag",x="fPublished",T="graphicFrame",A="dumy",k="ext",M="scrgbClr",I="srgbClr",E="hslClr",R="sysClr",D="schemeClr",N="prstClr",F="styleClr",_="noFill",P="solidFill",L="gradFill",O="blipFill",B="pattFill",j="grpFill",H="delete",G="idx",U="scene3d",W="spPr",V="txPr",z="sqref",q="invertIfNegative",Z="bubble3D",Y="marker",K="grpSp",X="cxnSp",J="clrScheme",Q="fontScheme",$="fmtScheme",ee="layout",te="pictureOptions",re="order",ne="gapWidth",oe="dLbls",ie="trendline",ae="errBars",se="ser",le="dropLines",ue="axId",ce="grouping",he="varyColors",fe="scaling",de="axPos",pe="majorGridlines",ge="minorGridlines",me="title",be="numFmt",ye="majorTickMark",Ce="minorTickMark",we="tickLblPos",ve="crossAx",Se="crosses",xe="crossesAt",Te="style",Ae="rotWithShape",ke="Requires",a.DrawingReader={},Me={ReadContentValueAsString:function(e){for(var t="";e.moveToNextAttribute();)switch(Re(e)){case"val":t=e.readContentAsString()}return t},ReadElementContentAsString:function(e){var t="";if(3===e.elementType)return t;for(1===e.elementType&&(t=e.readElementContentAsString());e.read()&&2!==e.elementType;);return t},ReadCT_ChartStyle:function(e){for(var t,r,n,o={attribute:{}};e.moveToNextAttribute();)t=Re(e),o.attribute[t]=e.readContentAsString();for(r=e.depth;e.read()&&!(e.depth<=r)&&("dataPointMarkerLayout"===(n=De(e))?o.dataPointMarkerLayout=Me.ReadCT_DataPointMarkerLayout(e):"extLst"===n?o.extLst=Tt(e):o[n]=Me.ReadCT_ChartStyleElement(e),!(e.depth<=r)););return o},ReadCT_ChartStyleElement:function(e){for(var t,r,n={attribute:{}},o=e.depth;e.moveToNextAttribute();)"mods"===(t=Re(e))&&(n.attribute[t]=e.readContentAsString());if(3===e.elementType)return n;for(;e.read()&&!(e.depth<=o)&&("lnRef"===(r=De(e))||"fillRef"===r||"effectRef"===r?n[r]=ha(e):"fontRef"===r?n.fontRef=fa(e):r===W?n.spPr=ua(e):"defRPr"===r?n.defRPr=is(e):"bodyPr"===r&&(n.bodyPr=Va(e)),!(e.depth<=o)););return n},ReadCT_DataPointMarkerLayout:function(e){for(var t,r={attribute:{}};e.moveToNextAttribute();)t=Re(e),r.attribute[t]=e.readContentAsString();return r},ReadCT_Extension:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"uri":t.uri=e.readContentAsString()}return e.elementType,t},ReadCT_chartColors:function(e){for(var t,r,n={schemeClr:[],variation:[],attribute:{}},o=e.depth;e.moveToNextAttribute();)t=Re(e),n.attribute[t]=e.readContentAsString();if(3===e.elementType)return n;for(;e.read()&&!(e.depth<=o)&&("schemeClr"===(r=De(e))?n.schemeClr.push(vt(e)):"variation"===r&&n.variation.push(Me.ReadCT_Variation(e)),!(e.depth<=o)););return n},ReadCT_Variation:function(e){var t,r={},n=e.depth;if(3===e.elementType)return r;for(;e.read()&&!(e.depth<=n)&&("lumMod"===(t=De(e))?r.lumMod=ot(e):"lumOff"===t&&(r.lumOff=ot(e)),!(e.depth<=n)););return r},ReadCT_ExtensionList:function(e){var t,r={ext:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"ext":r.ext.push(Me.ReadCT_Extension(e))}if(e.depth<=t)break}return r},ReadCT_NumberFormat:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"formatCode":t.formatCode=h(e.readContentAsString());break;case"sourceLinked":t.sourceLinked=e.readContentAsBoolean()}return t},ReadCT_ValueColors:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"minColor":r.minColor=mi(e);break;case"midColor":r.midColor=mi(e);break;case"maxColor":r.maxColor=mi(e)}if(e.depth<=t)break}return r},ReadCT_ExternalData:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"id":t.id=e.readContentAsString();break;case"autoUpdate":t.autoUpdate=e.readContentAsBoolean()}return t},ReadCT_Formula:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"dir":t.dir=u.Charts.ST_FormulaDirection[e.readContentAsString()]}if(3===e.elementType)return t;for(1===e.elementType&&(t.formula=e.readElementContentAsString());e.read()&&2!==e.elementType;);return t},ReadCT_Value:function(e){var t={};if(3===e.elementType)return t;for(1===e.elementType&&(t.value=e.readElementContentAsString());e.read()&&2!==e.elementType;);return t},ReadCT_DataId:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"val":t.val=parseInt(e.readContentAsString(),10)}return t},ReadST_AxisId:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"val":t.val=parseInt(e.readContentAsString(),10)}return t},ReadCT_StringValue:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"idx":t.idx=e.readContentAsInt()}if(3===e.elementType)return t;for(1===e.elementType&&(t.value=e.readElementContentAsString());e.read()&&2!==e.elementType;);return t},ReadCT_StringLevel:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"ptCount":r.ptCount=parseInt(e.readContentAsString(),10);break;case"name":r.name=e.readContentAsString()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"pt":r.pt.push(Me.ReadCT_StringValue(e))}if(e.depth<=t)break}return r},ReadCT_StringDimension:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"type":r.type=u.Charts.ST_StringDimensionType[e.readContentAsString()]}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"lvl":r.lvl.push(Me.ReadCT_StringLevel(e));break;case"nf":r.nf=Me.ReadCT_Formula(e);break;case"f":r.f=Me.ReadCT_Formula(e)}if(e.depth<=t)break}return r},ReadCT_NumericValue:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"idx":t.idx=e.readContentAsInt()}if(3===e.elementType)return t;for(1===e.elementType&&(t.value=e.readElementContentAsDouble());e.read()&&2!==e.elementType;);return t},ReadCT_NumericLevel:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"ptCount":r.ptCount=parseInt(e.readContentAsString(),10);break;case"formatCode":r.formatCode=e.readContentAsString();break;case"name":r.name=e.readContentAsString()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"pt":r.pt.push(Me.ReadCT_NumericValue(e))}if(e.depth<=t)break}return r},ReadCT_NumericDimension:function(e){for(var t,r={lvl:[]};e.moveToNextAttribute();)switch(Re(e)){case"type":r.type=u.Charts.ST_NumericDimensionType[e.readContentAsString()]}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"lvl":r.lvl.push(Me.ReadCT_NumericLevel(e));break;case"nf":r.nf=Me.ReadCT_Formula(e);break;case"f":r.f=Me.ReadCT_Formula(e)}if(e.depth<=t)break}return r},ReadCT_Data:function(e){for(var t,r={numDim:[],strDim:[]};e.moveToNextAttribute();)switch(Re(e)){case"id":r.id=parseInt(e.readContentAsString(),10)}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"extLst":r.extLst=Me.ReadCT_ExtensionList(e);break;case"numDim":r.numDim.push(Me.ReadCT_NumericDimension(e));break;case"strDim":r.strDim.push(Me.ReadCT_StringDimension(e))}if(e.depth<=t)break}return r},ReadCT_ChartData:function(e){var t,r={data:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"externalData":r.externalData=Me.ReadCT_ExternalData(e);break;case"data":r.data.push(Me.ReadCT_Data(e));break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_TextData:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"f":r.f=Me.ReadCT_Formula(e);break;case"v":r.v=Me.ReadCT_Value(e)}if(e.depth<=t)break}return r},ReadCT_Text:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"txData":r.txData=Me.ReadCT_TextData(e);break;case"rich":r.rich=za(e)}if(e.depth<=t)break}return r},ReadCT_ChartTitle:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"pos":r.pos=u.Charts.ST_SidePos[e.readContentAsString()];break;case"align":r.align=u.Charts.ST_PosAlign[e.readContentAsString()];break;case"overlay":r.overlay=e.readContentAsBoolean()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"tx":r.tx=Me.ReadCT_Text(e);break;case"spPr":r.spPr=ua(e);break;case"txPr":r.txPr=za(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_CategoryAxisScaling:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"gapWidth":t.gapWidth=e.readContentAsString()}return t},ReadCT_ValueAxisScaling:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"max":t.max=e.readContentAsString();break;case"min":t.min=e.readContentAsString();break;case"majorUnit":t.majorUnit=e.readContentAsString();break;case"minorUnit":t.minorUnit=e.readContentAsString()}return t},ReadCT_AxisTitle:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"tx":r.tx=Me.ReadCT_Text(e);break;case"spPr":r.spPr=ua(e);break;case"txPr":r.txPr=za(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_AxisUnitsLabel:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"tx":r.tx=Me.ReadCT_Text(e);break;case"spPr":r.spPr=ua(e);break;case"txPr":r.txPr=za(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_AxisUnits:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"unit":r.unit=u.Charts.ST_AxisUnit[e.readContentAsString()]}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"unitsLabel":r.unitsLabel=Me.ReadCT_AxisUnitsLabel(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_Gridlines:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"spPr":r.spPr=ua(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_TickMarks:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"type":r=u.Charts.ST_TickMarksType[e.readContentAsString()]}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_TickLabels:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_Axis:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"id":r.id=parseInt(e.readContentAsString(),10);break;case"hidden":r.hidden=e.readContentAsBoolean()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"title":r.title=Me.ReadCT_AxisTitle(e);break;case"units":r.units=Me.ReadCT_AxisUnits(e);break;case"majorGridlines":r.majorGridlines=Me.ReadCT_Gridlines(e);break;case"minorGridlines":r.minorGridlines=Me.ReadCT_Gridlines(e);break;case"majorTickMarks":r.majorTickMarks=Me.ReadCT_TickMarks(e);break;case"minorTickMarks":r.minorTickMarks=Me.ReadCT_TickMarks(e);break;case"tickLabels":r.tickLabels=Me.ReadCT_TickLabels(e);break;case"numFmt":r.numFmt=Me.ReadCT_NumberFormat(e);break;case"spPr":r.spPr=ua(e);break;case"txPr":r.txPr=za(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e);break;case"catScaling":r.catScaling=Me.ReadCT_CategoryAxisScaling(e);break;case"valScaling":r.valScaling=Me.ReadCT_ValueAxisScaling(e)}if(e.depth<=t)break}return r},ReadCT_ParentLabelLayout:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"val":t.val=u.Charts.ST_ParentLabelLayout[e.readContentAsString()]}return t},ReadCT_RegionLabelLayout:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"val":t.val=u.Charts.ST_RegionLabelLayout[e.readContentAsString()]}return t},ReadCT_SeriesElementVisibilities:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"connectorLines":t.connectorLines=e.readContentAsBoolean();break;case"meanLine":t.meanLine=e.readContentAsBoolean();break;case"meanMarker":t.meanMarker=e.readContentAsBoolean();break;case"nonoutliers":t.nonoutliers=e.readContentAsBoolean();break;case"outliers":t.outliers=e.readContentAsBoolean()}return t},ReadCT_Aggregation:function(){return{}},ReadCT_Binning:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"intervalClosed":r.intervalClosed=u.Charts.ST_IntervalClosedSide[e.readContentAsString()];break;case"underflow":r.underflow=e.readContentAsString();break;case"overflow":r.overflow=e.readContentAsString()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"binSize":r.binSize=Me.ReadBinSize(e);break;case"binCount":r.binCount=Me.ReadBinCount(e)}if(e.depth<=t)break}return r},ReadBinSize:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"val":t.val=e.readContentAsDouble()}return t},ReadBinCount:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"val":t.val=e.readContentAsInt()}return t},ReadCT_GeoLocationQuery:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"countryRegion":t.countryRegion=e.readContentAsString();break;case"adminDistrict1":t.adminDistrict1=e.readContentAsString();break;case"adminDistrict2":t.adminDistrict2=e.readContentAsString();break;case"postalCode":t.postalCode=e.readContentAsString();break;case"entityType":t.entityType=u.Charts.ST_EntityType[e.readContentAsString()]}return t},ReadCT_Address:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"address1":t.address1=e.readContentAsString();break;case"countryRegion":t.countryRegion=e.readContentAsString();break;case"adminDistrict1":t.adminDistrict1=e.readContentAsString();break;case"adminDistrict2":t.adminDistrict2=e.readContentAsString();break;case"postalCode":t.postalCode=e.readContentAsString();break;case"locality":t.locality=e.readContentAsString();break;case"isoCountryCode":t.isoCountryCode=e.readContentAsString()}return t},ReadCT_GeoLocation:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"latitude":r.latitude=e.readContentAsDouble();break;case"longitude":r.longitude=e.readContentAsDouble();break;case"entityName":r.entityName=e.readContentAsString();break;case"entityType":r.entityType=u.Charts.ST_EntityType[e.readContentAsString()]}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"address":r.address=Me.ReadCT_Address(e)}if(e.depth<=t)break}return r},ReadCT_GeoLocations:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoLocation":r.geoLocation=Me.ReadCT_GeoLocation(e)}if(e.depth<=t)break}return r},ReadCT_GeoLocationQueryResult:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoLocationQuery":r.geoLocationQuery=Me.ReadCT_GeoLocationQuery(e);break;case"geoLocations":r.geoLocations=Me.ReadCT_GeoLocations(e)}if(e.depth<=t)break}return r},ReadCT_GeoLocationQueryResults:function(e){var t,r={geoLocationQueryResult:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoLocationQueryResult":r.geoLocationQueryResult.push(Me.ReadCT_GeoLocationQueryResult(e))}if(e.depth<=t)break}return r},ReadCT_GeoPolygon:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"polygonId":t.polygonId=e.readContentAsString();break;case"numPoints":break;case"pcaRings":t.pcaRings=e.readContentAsString()}return t},ReadCT_GeoPolygons:function(e){var t,r={geoPolygon:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoPolygon":r.geoPolygon.push(Me.ReadCT_GeoPolygon(e))}if(e.depth<=t)break}return r},ReadCT_Copyrights:function(e){var t,r={copyright:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"copyright":r.copyright.push(Me.ReadElementContentAsString(e))}if(e.depth<=t)break}return r},ReadCT_GeoData:function(e){for(var t,r={geoPolygons:[],copyrights:[]};e.moveToNextAttribute();)switch(Re(e)){case"entityName":r.entityName=e.readContentAsString();break;case"entityId":r.entityId=e.readContentAsString();break;case"east":r.east=e.readContentAsDouble();break;case"west":r.west=e.readContentAsDouble();break;case"north":r.north=e.readContentAsDouble();break;case"south":r.south=e.readContentAsDouble()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoPolygons":r.geoPolygons.push(Me.ReadCT_GeoPolygon(e));break;case"copyrights":r.copyrights=Me.ReadCT_Copyrights(e)}if(e.depth<=t)break}return r},ReadCT_GeoDataEntityQuery:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"entityType":t.entityType=u.Charts.ST_EntityType[e.readContentAsString()];break;case"entityId":t.entityId=e.readContentAsString()}return t},ReadCT_GeoDataEntityQueryResult:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoDataEntityQuery":r.geoDataEntityQuery=Me.ReadCT_GeoDataEntityQuery(e);break;case"geoData":r.geoData=Me.ReadCT_GeoData(e)}if(e.depth<=t)break}return r},ReadCT_GeoDataEntityQueryResults:function(e){var t,r={geoDataEntityQueryResult:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoDataEntityQueryResult":r.geoDataEntityQueryResult.push(Me.ReadCT_GeoDataEntityQueryResult(e))}if(e.depth<=t)break}return r},ReadCT_GeoDataPointQuery:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"entityType":t.entityType=u.Charts.ST_EntityType[e.readContentAsString()];break;case"latitude":t.latitude=e.readContentAsDouble();break;case"longitude":t.longitude=e.readContentAsDouble()}return t},ReadCT_GeoDataPointToEntityQuery:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"entityType":t.entityType=u.Charts.ST_EntityType[e.readContentAsString()];break;case"entityId":t.entityId=e.readContentAsString()}return t},ReadCT_GeoDataPointToEntityQueryResult:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoDataPointQuery":r.geoDataPointQuery=Me.ReadCT_GeoDataPointQuery(e);break;case"geoDataPointToEntityQuery":r.geoDataPointToEntityQuery=Me.ReadCT_GeoDataPointToEntityQuery(e)}if(e.depth<=t)break}return r},ReadCT_GeoDataPointToEntityQueryResults:function(e){var t,r={geoDataPointToEntityQueryResult:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoDataPointToEntityQueryResult":r.geoDataPointToEntityQueryResult.push(Me.ReadCT_GeoDataPointToEntityQueryResult(e))}if(e.depth<=t)break}return r},ReadCT_GeoChildTypes:function(e){var t,r={entityType:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"entityType":r.entityType.push(Me.ReadElementContentAsString(e))}if(e.depth<=t)break}return r},ReadCT_GeoChildEntitiesQuery:function(e){for(var t,r={geoChildTypes:[]};e.moveToNextAttribute();)switch(Re(e)){case"entityId":r.entityId=e.readContentAsString()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoChildTypes":r.geoChildTypes=Me.ReadCT_GeoChildTypes(e)}if(e.depth<=t)break}return r},ReadCT_GeoHierarchyEntity:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"entityName":t.entityName=e.readContentAsString();break;case"entityId":t.entityId=e.readContentAsString();break;case"entityType":t.entityType=u.Charts.ST_EntityType[e.readContentAsString()]}return t},ReadCT_GeoChildEntities:function(e){var t,r={geoHierarchyEntity:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoHierarchyEntity":r.geoHierarchyEntity.push(Me.ReadCT_GeoHierarchyEntity(e))}if(e.depth<=t)break}return r},ReadCT_GeoChildEntitiesQueryResult:function(e){var t,r={geoChildEntities:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoChildEntitiesQuery":r.geoChildEntitiesQuery=Me.ReadCT_GeoChildEntitiesQuery(e);break;case"geoChildEntities":r.geoChildEntities.push(Me.ReadCT_GeoHierarchyEntity(e))}if(e.depth<=t)break}return r},ReadCT_GeoChildEntitiesQueryResults:function(e){var t,r={geoChildEntitiesQueryResult:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoChildEntitiesQueryResult":r.geoChildEntitiesQueryResult.push(Me.ReadCT_GeoChildEntitiesQueryResult(e))}if(e.depth<=t)break}return r},ReadCT_Clear:function(e){var t,r={geoChildEntitiesQueryResults:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoLocationQueryResults":r.geoLocationQueryResults=Me.ReadCT_GeoLocationQueryResults(e);break;case"geoDataEntityQueryResults":r.geoDataEntityQueryResults=Me.ReadCT_GeoDataEntityQueryResults(e);break;case"geoDataPointToEntityQueryResults":r.geoDataPointToEntityQueryResults=Me.ReadCT_GeoDataPointToEntityQueryResults(e);break;case"geoChildEntitiesQueryResults":r.geoChildEntitiesQueryResults=Me.ReadCT_GeoChildEntitiesQueryResults(e)}if(e.depth<=t)break}return r},ReadCT_GeoCache:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"provider":t.provider=e.readContentAsString();break;case"binary":t.binary=e.readContentAsString();break;case"clear":t.clear=Me.ReadCT_Clear(e)}return t},ReadCT_Geography:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"projectionType":r.projectionType=u.Charts.ST_GeoProjectionType[e.readContentAsString()];break;case"viewedRegionType":r.viewedRegionType=u.Charts.ST_GeoMappingLevel[e.readContentAsString()];break;case"cultureLanguage":r.cultureLanguage=e.readContentAsString();break;case"cultureRegion":r.cultureRegion=e.readContentAsString();break;case"attribution":r.attribution=e.readContentAsString()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"geoCache":r.geoCache=Me.ReadCT_GeoCache(e)}if(e.depth<=t)break}return r},ReadCT_Statistics:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"quartileMethod":t.quartileMethod=u.Charts.ST_QuartileMethod[e.readContentAsString()]}return t},ReadCT_Subtotals:function(e){var t,r={idx:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"idx":r.idx.push(parseInt(Me.ReadContentValueAsString(e),10))}if(e.depth<=t)break}return r},ReadCT_SeriesLayoutProperties:function(e){var t,r={subtotals:[],extLst:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"parentLabelLayout":r.parentLabelLayout=Me.ReadCT_ParentLabelLayout(e);break;case"regionLabelLayout":r.regionLabelLayout=Me.ReadCT_RegionLabelLayout(e);break;case"visibility":r.visibility=Me.ReadCT_SeriesElementVisibilities(e);break;case"geography":r.geography=Me.ReadCT_Geography(e);break;case"statistics":r.statistics=Me.ReadCT_Statistics(e);break;case"subtotals":r.subtotals=Me.ReadCT_Subtotals(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e);break;case"aggregation":r.aggregation=Me.ReadCT_Aggregation(e);break;case"binning":r.binning=Me.ReadCT_Binning(e)}if(e.depth<=t)break}return r},ReadCT_DataPoint:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"idx":r.idx=parseInt(e.readContentAsString(),10)}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"spPr":r.spPr=ua(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_ExtremeValueColorPosition:function(){return{}},ReadCT_NumberColorPosition:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"val":t.val=e.readContentAsDouble()}return t},ReadCT_PercentageColorPosition:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"val":t.val=e.readContentAsDouble()}return t},ReadCT_ValueColorEndPosition:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"extremeValue":r.extremeValue=Me.ReadCT_ExtremeValueColorPosition(e);break;case"number":r.number=Me.ReadCT_NumberColorPosition(e);break;case"percent":r.percent=Me.ReadCT_PercentageColorPosition(e)}if(e.depth<=t)break}return r},ReadCT_ValueColorMiddlePosition:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"number":r.aggregation=Me.ReadCT_NumberColorPosition(e);break;case"percent":r.binning=Me.ReadCT_PercentageColorPosition(e)}if(e.depth<=t)break}return r},ReadCT_ValueColorPositions:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"count":r.count=e.readContentAsInt()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"min":r.min=Me.ReadCT_ValueColorEndPosition(e);break;case"mid":r.mid=Me.ReadCT_ValueColorMiddlePosition(e);break;case"max":r.max=Me.ReadCT_ValueColorEndPosition(e)}if(e.depth<=t)break}return r},ReadCT_DataLabelVisibilities:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"seriesName":t.seriesName=e.readContentAsBoolean();break;case"categoryName":t.categoryName=e.readContentAsBoolean();break;case"value":t.value=e.readContentAsBoolean()}return t},ReadCT_DataLabel:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"idx":r.idx=parseInt(e.readContentAsString(),10);break;case"pos":r.pos=u.Charts.ST_DataLabelPos[e.readContentAsString()]}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"numFmt":r.numFmt=Me.ReadCT_NumberFormat(e);break;case"spPr":r.spPr=ua(e);break;case"txPr":r.txPr=za(e);break;case"visibility":r.visibility=Me.ReadCT_DataLabelVisibilities(e);break;case"separator":r.separator=Me.ReadElementContentAsString(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_DataLabelHidden:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"idx":t.idx=parseInt(e.readContentAsString(),10)}return t},ReadCT_DataLabels:function(e){for(var t,r={dataLabel:[],dataLabelHidden:[],extLst:[]};e.moveToNextAttribute();)switch(Re(e)){case"pos":r.pos=u.Charts.ST_DataLabelPos[e.readContentAsString()]}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"numFmt":r.numFmt=Me.ReadCT_NumberFormat(e);break;case"spPr":r.spPr=ua(e);break;case"txPr":r.txPr=za(e);break;case"visibility":r.visibility=Me.ReadCT_DataLabelVisibilities(e);break;case"separator":r.separator=Me.ReadElementContentAsString(e);break;case"dataLabel":r.dataLabel.push(Me.ReadCT_DataLabel(e));break;case"dataLabelHidden":r.dataLabelHidden.push(Me.ReadCT_DataLabelHidden(e));break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_Series:function(e){for(var t,r={dataPt:[],axisId:[],extLst:[]};e.moveToNextAttribute();)switch(Re(e)){case"layoutId":r.layoutId=s.ChartHelper.ToCT_ChartType(u.Charts.ST_SeriesLayout[e.readContentAsString()]);break;case"hidden":r.hidden=e.readContentAsBoolean();break;case"ownerIdx":r.ownerIdx=parseInt(e.readContentAsString(),10);break;case"uniqueId":r.uniqueId=e.readContentAsString();break;case"formatIdx":r.formatIdx=parseInt(e.readContentAsString(),10)}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"tx":r.tx=Me.ReadCT_Text(e);break;case"spPr":r.spPr=ua(e);break;case"valueColors":r.valueColors=Me.ReadCT_ValueColors(e);break;case"valueColorPositions":r.valueColorPositions=Me.ReadCT_ValueColorPositions(e);break;case"dataPt":r.dataPt.push(Me.ReadCT_DataPoint(e));break;case"dataLabels":r.dataLabels=Me.ReadCT_DataLabels(e);break;case"dataId":r.dataId=Me.ReadCT_DataId(e);break;case"layoutPr":r.layoutPr=Me.ReadCT_SeriesLayoutProperties(e);break;case"axisId":r.axisId.push(Me.ReadST_AxisId(e));break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_Legend:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"pos":r.legendPos=u.Charts.ST_2016ChartPosLegend[e.readContentAsString()];break;case"align":r.align=u.Charts.ST_PosAlign[e.readContentAsString()];break;case"overlay":r.overlay=e.readContentAsBoolean()}if(r.legendPos===u.Charts.ST_2016ChartPosLegend.r&&r.align===u.Charts.ST_PosAlign.min&&(r.legendPos=5),3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"spPr":r.spPr=ua(e);break;case"txPr":r.txPr=za(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_PlotSurface:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"spPr":r.spPr=ua(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_PlotAreaRegion:function(e){var t,r={extLst:[],series:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"plotSurface":r.plotSurface=Me.ReadCT_PlotSurface(e);break;case"series":r.series.push(Me.ReadCT_Series(e));break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_PlotArea:function(e){var t,r={axes:[],extLst:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"plotAreaRegion":r.plotAreaRegion=Me.ReadCT_PlotAreaRegion(e);break;case"axis":r.axes.push(Me.ReadCT_Axis(e));break;case"spPr":r.spPr=ua(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_Chart:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"title":r.title=Me.ReadCT_ChartTitle(e);break;case"plotArea":r.plotArea=Me.ReadCT_PlotArea(e);break;case"legend":r.legend=Me.ReadCT_Legend(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_FormatOverride:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"idx":r.idx=parseInt(e.readContentAsString(),10)}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"spPr":r.spPr=ua(e);break;case"extLst":r.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=t)break}return r},ReadCT_FormatOverrides:function(e){var t,r={fmtOvr:[]};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"fmtOvr":r.fmtOvr.push(Me.ReadCT_FormatOverride(e))}if(e.depth<=t)break}return r},ReadCT_HeaderFooter:function(e){for(var t,r={};e.moveToNextAttribute();)switch(Re(e)){case"alignWithMargins":r.alignWithMargins=e.readContentAsBoolean();break;case"differentOddEven":r.differentOddEven=e.readContentAsBoolean();break;case"differentFirst":r.differentFirst=e.readContentAsBoolean()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"oddHeader":r.oddHeader=Me.ReadElementContentAsString(e);break;case"oddFooter":r.oddFooter=Me.ReadElementContentAsString(e);break;case"evenHeader":r.evenHeader=Me.ReadElementContentAsString(e);break;case"evenFooter":r.evenFooter=Me.ReadElementContentAsString(e);break;case"firstHeader":r.firstHeader=Me.ReadElementContentAsString(e);break;case"firstFooter":r.firstFooter=Me.ReadElementContentAsString(e)}if(e.depth<=t)break}return r},ReadCT_PageMargins:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"l":t.l=e.readContentAsDouble();break;case"r":t.r=e.readContentAsDouble();break;case"t":t.t=e.readContentAsDouble();break;case"b":t.b=e.readContentAsDouble();break;case"header":t.header=e.readContentAsDouble();break;case"footer":t.footer=e.readContentAsDouble()}return t},ReadCT_PageSetup:function(e){for(var t={};e.moveToNextAttribute();)switch(Re(e)){case"paperSize":t.paperSize=parseInt(e.readContentAsString(),10);break;case"firstPageNumber":t.firstPageNumber=parseInt(e.readContentAsString(),10);break;case"orientation":t.orientation=u.Charts.ST_PageOrientation[e.readContentAsString()];break;case"blackAndWhite":t.blackAndWhite=e.readContentAsBoolean();break;case"draft":t.draft=e.readContentAsBoolean();break;case"useFirstPageNumber":t.useFirstPageNumber=e.readContentAsBoolean();break;case"horizontalDpi":t.horizontalDpi=e.readContentAsInt();break;case"verticalDpi":t.verticalDpi=e.readContentAsInt();break;case"copies":t.copies=parseInt(e.readContentAsString(),10)}return t},ReadCT_PrintSettings:function(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);){switch(De(e)){case"headerFooter":r.headerFooter=Me.ReadCT_HeaderFooter(e);break;case"pageMargins":r.pageMargins=Me.ReadCT_PageMargins(e);break;case"pageSetup":r.pageSetup=Me.ReadCT_PageSetup(e)}if(e.depth<=t)break}return r},ReadCT_ChartSpace:function(e,t){var r,n={};if(3===e.elementType)return n;for(r=e.depth;e.read()&&!(e.depth<=r);){switch(De(e)){case"chartData":n.chartData=Me.ReadCT_ChartData(e);break;case"chart":n.chart=Me.ReadCT_Chart(e);break;case"spPr":n.spPr=ua(e);break;case"txPr":n.txPr=za(e);break;case"clrMapOvr":n.clrMapOvr=Pa(e);break;case"fmtOvrs":n.fmtOvrs=Me.ReadCT_FormatOverrides(e);break;case"printSettings":n.printSettings=Me.ReadCT_PrintSettings(e);break;case"extLst":n.extLst=Me.ReadCT_ExtensionList(e)}if(e.depth<=r)break}return t&&Me.TranstateSeriesIDToData(n.chart.plotArea.plotAreaRegion.series,n.chartData.data,t),n},TranstateSeriesIDToData:function(e,t,r){var n,o,i,a,s,l,u,c,h,f=Me.TranslateChartData(t),d=Me.TranslateNameSpace(r);for(n=0;n<e.length;n++)o=e[n],p.k(o.dataId)||(i=f[o.dataId.val],p.k(i)||(a={},s=void 0,l=i.numDim&&i.numDim.formula,u=i.strDim&&i.strDim.formula,l&&(s=d[l],a.numDim=s),u&&(s=d[u],a.strDim=s),o.formulaObj=a)),(c=o.tx&&o.tx.txData&&o.tx.txData.f&&o.tx.txData.f.formula)&&((h=d[c])&&(o.tx.txData.f.formula=h))},TranslateChartData:function(e){var t,r,n,o={};for(t=0;t<e.length;t++)r=e[t].id,n={},0<e[t].numDim.length&&(n.numDim=e[t].numDim&&e[t].numDim[0].f),0<e[t].strDim.length&&(n.strDim=e[t].strDim&&e[t].strDim[0].f),o[r]=n;return o},TranslateNameSpace:function(e){var t,r,n,o={};for(t=0;t<e.length;t++)r=e[t].name,n=e[t].formula,o[r]=n;return o}},a.DrawingReader.Chart2016Reader=Me,a.DrawingReader.ReadCT_ColorScheme=Ge,a.DrawingReader.ReadCT_CustomColor=Ue,a.DrawingReader.ReadCT_SupplementalFont=We,a.DrawingReader.ReadCT_CustomColorList=Ve,a.DrawingReader.ReadCT_FontCollection=ze,a.DrawingReader.ReadCT_EffectStyleItem=qe,a.DrawingReader.ReadCT_FontScheme=Ze,a.DrawingReader.ReadCT_FillStyleList=Ye,a.DrawingReader.ReadCT_LineStyleList=Ke,a.DrawingReader.ReadCT_EffectStyleList=Xe,a.DrawingReader.ReadCT_BackgroundFillStyleList=Je,a.DrawingReader.ReadCT_StyleMatrix=Qe,a.DrawingReader.ReadCT_BaseStyles=$e,Ie={hiddenScene3dUri:"{31F19639-BCED-4A60-ADC4-E9642A236FB7}",hiddenSp3dUri:"{E45631CC-5BF2-4C18-A39C-3461C7D3F71A}",hiddenFillUri:"{909E8E84-426E-40DD-AFC4-6F175D3DCCD1}",hiddenFillUri2:"{909E8E84-426E-40dd-AFC4-6F175D3DCCD1}",hiddenLineUri:"{91240B29-F687-4F45-9708-019B960494DF}",hiddenLineUri2:"{91240B29-F687-4f45-9708-019B960494DF}"},a.DrawingReader.ReadCT_creationId=et,a.DrawingReader.ReadCT_OfficeArtExtension=tt,a.DrawingReader.ReadCT_Angle=rt,a.DrawingReader.ReadCT_PositiveFixedAngle=nt,a.DrawingReader.ReadCT_Percentage=ot,a.DrawingReader.ReadCT_PositivePercentage=it,a.DrawingReader.ReadCT_FixedPercentage=at,a.DrawingReader.ReadCT_PositiveFixedPercentage=st,a.DrawingReader.ReadCT_Ratio=lt,a.DrawingReader.ReadCT_Point2D=ut,a.DrawingReader.ReadCT_PositiveSize2D=ct,a.DrawingReader.ReadCT_ComplementTransform=ht,a.DrawingReader.ReadCT_InverseTransform=ft,a.DrawingReader.ReadCT_GrayscaleTransform=dt,a.DrawingReader.ReadCT_GammaTransform=pt,a.DrawingReader.ReadCT_InverseGammaTransform=gt,a.DrawingReader.ReadCT_ScRgbColor=mt,a.DrawingReader.StringToByteArray=bt,a.DrawingReader.ReadCT_SRgbColor=yt,a.DrawingReader.ReadCT_HslColor=Ct,a.DrawingReader.ReadCT_SystemColor=wt,a.DrawingReader.ReadCT_SchemeColor=vt,a.DrawingReader.ReadCT_PresetColor=St,a.DrawingReader.ReadCT_StyleColor=xt,a.DrawingReader.ReadCT_OfficeArtExtensionList=Tt,a.DrawingReader.ReadCT_Scale2D=function(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("sx"!==(o=De(e))&&"sy"!==o||(i[o]=lt(e)));return i},a.DrawingReader.ReadCT_Transform2D=At,a.DrawingReader.ReadCT_GroupTransform2D=kt,a.DrawingReader.ReadCT_Point3D=Mt,a.DrawingReader.ReadCT_Vector3D=It,a.DrawingReader.ReadCT_SphereCoords=Et,a.DrawingReader.ReadCT_RelativeRect=Rt,a.DrawingReader.ReadCT_Color=Dt,a.DrawingReader.ReadCT_ColorMRU=function(e){var t,r,n,o={scrgbClr:[],srgbClr:[],hslClr:[],sysClr:[],schemeClr:[],prstClr:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case M:o.scrgbClr.push(mt(e));break;case I:o.srgbClr.push(yt(e));break;case E:o.hslClr.push(Ct(e));break;case R:o.sysClr.push(wt(e));break;case D:o.schemeClr.push(vt(e));break;case N:o.prstClr.push(St(e))}return o},a.DrawingReader.ReadCT_EmbeddedWAVAudioFile=Nt,a.DrawingReader.ReadCT_Hyperlink=Ft,a.DrawingReader.ReadCT_Boolean=_t,a.DrawingReader.ReadCT_Double=Pt,a.DrawingReader.ReadCT_UnsignedInt=Lt,a.DrawingReader.ReadCT_Int=Ot,a.DrawingReader.ReadCT_RelId=Bt,a.DrawingReader.ReadCT_Extension=jt,a.DrawingReader.ReadCT_ExtensionList=Ht,a.DrawingReader.ReadCT_NumVal=Gt,a.DrawingReader.ReadCT_NumData=Ut,a.DrawingReader.ReadCT_NumRef=Wt,a.DrawingReader.ReadCT_NumDataSource=Vt,a.DrawingReader.ReadCT_StrVal=zt,a.DrawingReader.ReadCT_StrData=qt,a.DrawingReader.ReadCT_StrRef=Zt,a.DrawingReader.ReadCT_Tx=Yt,a.DrawingReader.ReadCT_TextLanguageID=function(e){return Ne(e,d)},a.DrawingReader.ReadCT_Lvl=function(e){var t,r,n,o={pt:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||"pt"===De(e)&&o.pt.push(zt(e));return o},a.DrawingReader.ReadCT_MultiLvlStrData=Kt,a.DrawingReader.ReadCT_MultiLvlStrRef=Xt,a.DrawingReader.ReadCT_AxDataSource=Jt,a.DrawingReader.ReadCT_SerTx=Qt,a.DrawingReader.ReadCT_LayoutTarget=$t,a.DrawingReader.ReadCT_LayoutMode=er,a.DrawingReader.ReadCT_ManualLayout=tr,a.DrawingReader.ReadCT_Layout=rr,a.DrawingReader.ReadCT_Title=nr,a.DrawingReader.ReadCT_RotX=or,a.DrawingReader.ReadCT_HPercent=ir,a.DrawingReader.ReadCT_RotY=ar,a.DrawingReader.ReadCT_DepthPercent=sr,a.DrawingReader.ReadCT_Perspective=lr,a.DrawingReader.ReadCT_View3D=ur,a.DrawingReader.ReadCT_Surface=cr,a.DrawingReader.ReadCT_DTable=hr,a.DrawingReader.ReadCT_GapAmount=fr,a.DrawingReader.ReadCT_Overlap=dr,a.DrawingReader.ReadCT_BubbleScale=pr,a.DrawingReader.ReadCT_SizeRepresents=gr,a.DrawingReader.ReadCT_FirstSliceAng=mr,a.DrawingReader.ReadCT_HoleSize=br,a.DrawingReader.ReadCT_SplitType=yr,a.DrawingReader.ReadCT_CustSplit=Cr,a.DrawingReader.ReadCT_SecondPieSize=wr,a.DrawingReader.ReadCT_NumFmt=vr,a.DrawingReader.ReadCT_LblAlgn=Sr,a.DrawingReader.ReadCT_DLblPos=xr,a.DrawingReader.ReadCT_DLbl=Tr,a.DrawingReader.ReadCT_DLbls=Ar,a.DrawingReader.ReadCT_MarkerStyle=kr,a.DrawingReader.ReadCT_MarkerSize=Mr,a.DrawingReader.ReadCT_Marker=Ir,a.DrawingReader.ReadCT_DPt=Er,a.DrawingReader.ReadCT_TrendlineType=Rr,a.DrawingReader.ReadCT_Order=Dr,a.DrawingReader.ReadCT_Period=Nr,a.DrawingReader.ReadCT_TrendlineLbl=Fr,a.DrawingReader.ReadCT_Trendline=_r,a.DrawingReader.ReadCT_ErrDir=Pr,a.DrawingReader.ReadCT_ErrBarType=Lr,a.DrawingReader.ReadCT_ErrValType=Or,a.DrawingReader.ReadCT_ErrBars=Br,a.DrawingReader.ReadCT_UpDownBar=jr,a.DrawingReader.ReadCT_UpDownBars=Hr,a.DrawingReader.ReadCT_LineSer=Ur,a.DrawingReader.ReadCT_ScatterSer=Wr,a.DrawingReader.ReadCT_RadarSer=Vr,a.DrawingReader.ReadCT_BarSer=zr,a.DrawingReader.ReadCT_AreaSer=qr,a.DrawingReader.ReadCT_PieSer=Zr,a.DrawingReader.ReadCT_BubbleSer=Yr,a.DrawingReader.ReadCT_SurfaceSer=Kr,a.DrawingReader.ReadCT_Grouping=Xr,a.DrawingReader.ReadCT_ChartLines=Jr,a.DrawingReader.ReadCT_LineChart=Qr,a.DrawingReader.ReadCT_Line3DChart=$r,a.DrawingReader.ReadCT_StockChart=en,a.DrawingReader.ReadCT_ScatterStyle=tn,a.DrawingReader.ReadCT_ScatterChart=rn,a.DrawingReader.ReadCT_RadarStyle=nn,a.DrawingReader.ReadCT_RadarChart=on,a.DrawingReader.ReadCT_BarGrouping=an,a.DrawingReader.ReadCT_BarDir=sn,a.DrawingReader.ReadCT_ShapeBox=ln,a.DrawingReader.ReadCT_BarChart=un,a.DrawingReader.ReadCT_Bar3DChart=cn,a.DrawingReader.ReadCT_AreaChart=hn,a.DrawingReader.ReadCT_Area3DChart=fn,a.DrawingReader.ReadCT_PieChart=dn,a.DrawingReader.ReadCT_Pie3DChart=pn,a.DrawingReader.ReadCT_DoughnutChart=gn,a.DrawingReader.ReadCT_OfPieType=mn,a.DrawingReader.ReadCT_OfPieChart=bn,a.DrawingReader.ReadCT_BubbleChart=yn,a.DrawingReader.ReadCT_BandFmt=Cn,a.DrawingReader.ReadCT_BandFmts=wn,a.DrawingReader.ReadCT_SurfaceChart=vn,a.DrawingReader.ReadCT_Surface3DChart=Sn,a.DrawingReader.ReadCT_AxPos=xn,a.DrawingReader.ReadCT_Crosses=Tn,a.DrawingReader.ReadCT_CrossBetween=An,a.DrawingReader.ReadCT_TickMark=kn,a.DrawingReader.ReadCT_TickLblPos=Mn,a.DrawingReader.ReadCT_Skip=In,a.DrawingReader.ReadCT_TimeUnit=En,a.DrawingReader.ReadCT_AxisUnit=Rn,a.DrawingReader.ReadCT_BuiltInUnit=Dn,a.DrawingReader.ReadCT_PictureFormat=Nn,a.DrawingReader.ReadCT_PictureStackUnit=Fn,a.DrawingReader.ReadCT_PictureOptions=_n,a.DrawingReader.ReadCT_DispUnitsLbl=Pn,a.DrawingReader.ReadCT_DispUnits=Ln,a.DrawingReader.ReadCT_Orientation=On,a.DrawingReader.ReadCT_LogBase=Bn,a.DrawingReader.ReadCT_Scaling=jn,a.DrawingReader.ReadCT_LblOffset=Hn,o={majorGridlines:{ln:{w:1,cap:2,cmpd:0,algn:0,solidFill:{schemeClr:{val:1,lumMod:[15e3],lumOff:[85e3]}},round:!0},effectLst:{}},minorGridlines:{ln:{w:1,cap:2,cmpd:0,algn:0,solidFill:{schemeClr:{val:1,lumMod:[5e3],lumOff:[95e3]}},round:!0},effectLst:{}},axis:{noFill:!0,ln:{w:1,cap:2,cmpd:0,algn:0,solidFill:{schemeClr:{val:1,lumMod:[15e3],lumOff:[85e3]}},round:!0},effectLst:{}},plotArea:{noFill:!0,ln:{noFill:!0},effectLst:{}}},a.DrawingReader.ReadCT_CatAx=Un,a.DrawingReader.ReadCT_DateAx=Wn,a.DrawingReader.ReadCT_SerAx=Vn,a.DrawingReader.ReadCT_ValAx=zn,a.DrawingReader.ReadCT_PlotArea=qn,a.DrawingReader.ReadCT_PivotFmt=Zn,a.DrawingReader.ReadCT_PivotFmts=Yn,a.DrawingReader.ReadCT_LegendPos=Kn,a.DrawingReader.ReadCT_LegendEntry=Xn,a.DrawingReader.ReadCT_Legend=Jn,a.DrawingReader.ReadCT_DispBlanksAs=Qn,a.DrawingReader.ReadCT_DispNaAsBlank=$n,a.DrawingReader.ReadCT_Chart=eo,a.DrawingReader.ReadCT_Style=to,a.DrawingReader.ReadCT_PivotSource=ro,a.DrawingReader.ReadCT_Protection=no,a.DrawingReader.ReadCT_HeaderFooter=oo,a.DrawingReader.ReadCT_PageMargins=io,a.DrawingReader.ReadCT_ExternalData=ao,a.DrawingReader.ReadCT_PageSetup=so,a.DrawingReader.ReadCT_PrintSettings=lo,a.DrawingReader.ReadCT_ChartSpace=function(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"roundedCorners":o.roundedCorners=_t(e);break;case Te:o.style=to(e);break;case"clrMapOvr":o.clrMapOvr=Pa(e);break;case"pivotSource":o.pivotSource=ro(e);break;case"protection":o.protection=no(e);break;case"chart":o.chart=eo(e);break;case W:o.spPr=ua(e);break;case V:o.txPr=za(e);break;case"externalData":o.externalData=ao(e);break;case"printSettings":o.printSettings=lo(e);break;case"userShapes":o.userShapes=po(e);break;case y:o.extLst=Ht(e)}return o},a.DrawingReader.ReadCT_DLblExtensionList=uo,a.DrawingReader.ReadCT_DLblExt=co,a.DrawingReader.ReadCT_DLblsExtensionList=ho,a.DrawingReader.ReadCT_DLblsExt=fo,a.DrawingReader.ReadCT_UserShapes=po,a.DrawingReader.ReadCT_InvertSolidFillFmt=go,a.DrawingReader.ReadCT_FullRef=function(e){return He(e)},a.DrawingReader.ReadCT_LevelRef=function(e){return He(e)},a.DrawingReader.ReadCT_FormulaRef=function(e){return He(e)},a.DrawingReader.ReadCT_FilteredSeriesTitle=function(e){return Fe(e,"tx",Yt)},a.DrawingReader.ReadCT_FilteredCategoryTitle=function(e){return Fe(e,"cat",Jt)},a.DrawingReader.ReadCT_FilteredBarSer=function(e){return Fe(e,se,zr)},a.DrawingReader.ReadCT_FilteredLineSer=function(e){return Fe(e,se,Ur)},a.DrawingReader.ReadCT_FilteredScatterSer=function(e){return Fe(e,se,Wr)},a.DrawingReader.ReadCT_FilteredAreaSer=function(e){return Fe(e,se,qr)},a.DrawingReader.ReadCT_FilteredPieSer=function(e){return Fe(e,se,Zr)},a.DrawingReader.ReadCT_FilteredBubbleSer=function(e){return Fe(e,se,Yr)},a.DrawingReader.ReadCT_FilteredRadarSer=function(e){return Fe(e,se,Vr)},a.DrawingReader.ReadCT_FilteredSurfaceSer=function(e){return Fe(e,se,Kr)},a.DrawingReader.ReadCT_SeriesDataLabelsRange=mo,a.DrawingReader.ReadCT_CategoryFilterException=bo,a.DrawingReader.ReadCT_CategoryFilterExceptions=function(e){var t,r,n,o={categoryFilterException:[]};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||"categoryFilterException"===De(e)&&o.categoryFilterException.push(bo(e));return o},a.DrawingReader.ReadCT_DataLabelFieldTableEntry=yo,a.DrawingReader.ReadCT_DataLabelFieldTable=Co,a.DrawingReader.ReadCT_GraphicFrameNonVisual=function(e){return je(e)},a.DrawingReader.ReadCT_CdrPosition=wo,a.DrawingReader.ReadCT_RelSizeAnchor=vo,a.DrawingReader.ReadCT_AbsSizeAnchor=So,a.DrawingReader.ReadCT_ChartDrawing=xo,a.DrawingReader.ReadCT_ConnectorLocking=To,a.DrawingReader.ReadCT_ShapeLocking=Ao,a.DrawingReader.ReadCT_PictureLocking=ko,a.DrawingReader.ReadCT_GroupLocking=Mo,a.DrawingReader.ReadCT_GraphicalObjectFrameLocking=Io,a.DrawingReader.ReadCT_NonVisualDrawingProps=Eo,a.DrawingReader.ReadCT_NonVisualDrawingShapeProps=Ro,a.DrawingReader.ReadCT_NonVisualConnectorProperties=Do,a.DrawingReader.ReadCT_NonVisualPictureProperties=No,a.DrawingReader.ReadCT_NonVisualGroupDrawingShapeProps=Fo,a.DrawingReader.ReadCT_NonVisualGraphicFrameProperties=function(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("graphicFrameLocks"===(o=De(e))?i.graphicFrameLocks=Io(e):o===y&&(i.extLst=Tt(e)));return i},a.DrawingReader.ReadCT_GraphicalObjectDataContent=_o,a.DrawingReader.ReadCT_GraphicalObjectData=Po,a.DrawingReader.ReadCT_GraphicalObject=Lo,a.DrawingReader.NormalizeSignificantWhitespaceFromXml=Oo,a.DrawingReader.ReadCT_Slicer=function(e){var t,r,n,o={name:""};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||De(e)===g&&(o.name=Oo(e.readContentAsString()));return o},a.DrawingReader.ReadCT_Camera=Bo,a.DrawingReader.ReadCT_LightRig=jo,a.DrawingReader.ReadCT_Scene3D=Ho,a.DrawingReader.ReadCT_Backdrop=Go,a.DrawingReader.ReadCT_Bevel=Uo,a.DrawingReader.ReadCT_Shape3D=Wo,a.DrawingReader.ReadCT_FlatText=Vo,a.DrawingReader.ReadCT_AlphaBiLevelEffect=zo,a.DrawingReader.ReadCT_AlphaCeilingEffect=qo,a.DrawingReader.ReadCT_AlphaFloorEffect=Zo,a.DrawingReader.ReadCT_AlphaInverseEffect=Yo,a.DrawingReader.ReadCT_AlphaModulateFixedEffect=Ko,a.DrawingReader.ReadCT_AlphaOutsetEffect=Xo,a.DrawingReader.ReadCT_AlphaReplaceEffect=Jo,a.DrawingReader.ReadCT_BiLevelEffect=Qo,a.DrawingReader.ReadCT_BlurEffect=$o,a.DrawingReader.ReadCT_ColorChangeEffect=ei,a.DrawingReader.ReadCT_ColorReplaceEffect=ti,a.DrawingReader.ReadCT_DuotoneEffect=ri,a.DrawingReader.ReadCT_GlowEffect=ni,a.DrawingReader.ReadCT_GrayscaleEffect=oi,a.DrawingReader.ReadCT_HSLEffect=ii,a.DrawingReader.ReadCT_InnerShadowEffect=ai,a.DrawingReader.ReadCT_LuminanceEffect=si,a.DrawingReader.ReadCT_OuterShadowEffect=li,a.DrawingReader.ReadCT_PresetShadowEffect=ui,a.DrawingReader.ReadCT_ReflectionEffect=ci,a.DrawingReader.ReadCT_RelativeOffsetEffect=hi,a.DrawingReader.ReadCT_SoftEdgesEffect=fi,a.DrawingReader.ReadCT_TintEffect=di,a.DrawingReader.ReadCT_TransformEffect=pi,a.DrawingReader.ReadCT_NoFillProperties=gi,a.DrawingReader.ReadCT_SolidColorFillProperties=mi,a.DrawingReader.ReadCT_LinearShadeProperties=bi,a.DrawingReader.ReadCT_PathShadeProperties=yi,a.DrawingReader.ReadCT_GradientStop=Ci,a.DrawingReader.ReadCT_GradientStopList=wi,a.DrawingReader.ReadCT_GradientFillProperties=vi,a.DrawingReader.ReadCT_TileInfoProperties=Si,a.DrawingReader.ReadCT_StretchInfoProperties=xi,a.DrawingReader.ReadCT_Blip=Ti,a.DrawingReader.ReadCT_BlipBlob=Ai,a.DrawingReader.ReadCT_BlipFillProperties=ki,a.DrawingReader.ReadCT_PatternFillProperties=Mi,a.DrawingReader.ReadCT_GroupFillProperties=Ii,a.DrawingReader.ReadCT_FillProperties=Ei,a.DrawingReader.ReadCT_FillEffect=Ri,a.DrawingReader.ReadCT_FillOverlayEffect=Di,a.DrawingReader.ReadCT_EffectReference=Ni,a.DrawingReader.ReadCT_EffectContainer=Fi,a.DrawingReader.ReadCT_AlphaModulateEffect=_i,a.DrawingReader.ReadCT_BlendEffect=Pi,a.DrawingReader.ReadCT_EffectList=Li,a.DrawingReader.ReadCT_EffectProperties=function(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||((o=De(e))===v?i.effectLst=Li(e):o===S&&(i.effectDag=Fi(e)));return i},a.DrawingReader.ReadCT_GeomGuide=Oi,a.DrawingReader.ReadCT_GeomGuideList=Bi,a.DrawingReader.ReadCT_AdjPoint2D=ji,a.DrawingReader.ReadCT_GeomRect=Hi,a.DrawingReader.ReadCT_XYAdjustHandle=Gi,a.DrawingReader.ReadCT_PolarAdjustHandle=Ui,a.DrawingReader.ReadCT_ConnectionSite=Wi,a.DrawingReader.ReadCT_AdjustHandleList=Vi,a.DrawingReader.ReadCT_ConnectionSiteList=zi,a.DrawingReader.ReadCT_Connection=qi,a.DrawingReader.ReadCT_Path2DArcTo=Yi,a.DrawingReader.ReadCT_Path2DClose=Ki,a.DrawingReader.ReadCT_Path2D=Xi,a.DrawingReader.ReadCT_Path2DList=Ji,a.DrawingReader.ReadCT_PresetGeometry2D=Qi,a.DrawingReader.ReadCT_PresetTextShape=$i,a.DrawingReader.ReadCT_CustomGeometry2D=ea,a.DrawingReader.ReadCT_LineEndProperties=ta,a.DrawingReader.ReadCT_LineJoinBevel=ra,a.DrawingReader.ReadCT_LineJoinRound=na,a.DrawingReader.ReadCT_LineJoinMiterProperties=oa,a.DrawingReader.ReadCT_PresetLineDashProperties=ia,a.DrawingReader.ReadCT_DashStop=aa,a.DrawingReader.ReadCT_DashStopList=sa,a.DrawingReader.ReadCT_LineProperties=la,a.DrawingReader.ReadCT_ShapeProperties=ua,a.DrawingReader.ReadCT_GroupShapeProperties=ca,a.DrawingReader.ReadCT_StyleMatrixReference=ha,a.DrawingReader.ReadCT_FontReference=fa,a.DrawingReader.ReadCT_ShapeStyle=da,a.DrawingReader.ReadCT_AnchorClientData=pa,a.DrawingReader.ReadCT_ShapeNonVisual=ga,a.DrawingReader.ReadCT_Shape=ma,a.DrawingReader.ReadCT_ConnectorNonVisual=ba,a.DrawingReader.ReadCT_Connector=ya,a.DrawingReader.ReadCT_PictureNonVisual=Ca,a.DrawingReader.ReadCT_Picture=wa,a.DrawingReader.ReadCT_GraphicalObjectFrameNonVisual=va,a.DrawingReader.ReadCT_GraphicalObjectFrame=Sa,a.DrawingReader.ReadCT_GroupShapeNonVisual=xa,a.DrawingReader.ReadCT_GroupShape=Ta,a.DrawingReader.ReadCT_Position=ka,a.DrawingReader.ReadCT_TwoCellAnchor=Ma,a.DrawingReader.ReadCT_AlternateContent=Ia,a.DrawingReader.ReadCT_Choice=Ea,a.DrawingReader.ReadCT_OneCellAnchor=Ra,a.DrawingReader.ReadCT_AbsoluteAnchor=Da,a.DrawingReader.ReadCT_Drawing=function(e){var t,r,n,o,i,a,s,l,u,c,h={twoCellAnchor:[],oneCellAnchor:[],absoluteAnchor:[],AnchorBaseList:[]};if(3===e.elementType)return h;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n)){switch(o=null,De(e)){case"twoCellAnchor":o=Ma(e);break;case"oneCellAnchor":o=Ra(e);break;case"absoluteAnchor":o=Da(e)}!o||!o.sp&&(l=s=void 0,u=(a=o).AlternateContent,c=p.Util.Ca(u),u&&!Aa(u)&&!c||!c&&(s=a.graphicFrame,(l=s&&s.graphic&&s.graphic.graphicData)&&!l.chart&&!l.slicer))||(i=p.Util.Ca(o.AlternateContent),h.AnchorBaseList.push(o),o.AlternateContent&&!i&&delete o.AlternateContent),o&&o.AlternateContent&&o.AlternateContent.Choice&&(o.AlternateContent.Choice.sp||o.AlternateContent.Choice.grpSp||o.AlternateContent.Choice.cxnSp)&&(o.AlternateContent.Choice.sp&&(o.sp=o.AlternateContent.Choice.sp),o.AlternateContent.Choice.grpSp&&(o.grpSp=o.AlternateContent.Choice.grpSp),o.AlternateContent.Choice.cxnSp&&(o.cxnSp=o.AlternateContent.Choice.cxnSp),h.AnchorBaseList.push(o))}return h},a.DrawingReader.ReadCT_DefaultShapeDefinition=Na,a.DrawingReader.ReadCT_ObjectStyleDefaults=Fa,a.DrawingReader.ReadCT_EmptyElement=_a,a.DrawingReader.ReadCT_ColorMapping=Pa,a.DrawingReader.ReadCT_ColorMappingOverride=function(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("masterClrMapping"===(o=De(e))?i.masterClrMapping={}:"overrideClrMapping"===o&&(i.overrideClrMapping=Pa(e)));return i},a.DrawingReader.ReadCT_ColorSchemeAndMapping=La,a.DrawingReader.ReadCT_ColorSchemeList=Oa,a.DrawingReader.ReadCT_OfficeStyleSheet=function(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case"theme":o[g]=Ne(e,g);break;case"themeElements":o.themeElements=$e(e);break;case"objectDefaults":o.objectDefaults=Fa(e);break;case"extraClrSchemeLst":o.extraClrSchemeLst=Oa(e);break;case"custClrLst":o.custClrLst=Ve(e);break;case y:o.extLst=Tt(e)}return o},a.DrawingReader.ReadCT_BaseStylesOverride=function(e){var t,r,n,o={};if(3===e.elementType)return o;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)if(!(t+1<r||2===n))switch(De(e)){case J:o.clrScheme=Ge(e);break;case Q:o.fontScheme=Ze(e);break;case $:o.fmtScheme=Qe(e)}return o},a.DrawingReader.ReadCT_ClipboardStyleSheet=function(e){var t,r,n,o,i={};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("themeElements"===(o=De(e))?i.themeElements=$e(e):"clrMap"===o&&(i.clrMap=Pa(e)));return i},a.DrawingReader.ReadCT_TextParagraph=Ba,a.DrawingReader.ReadCT_TextListStyle=ja,a.DrawingReader.ReadCT_TextNormalAutofit=Ha,a.DrawingReader.ReadCT_TextShapeAutofit=Ga,a.DrawingReader.ReadCT_TextNoAutofit=Ua,a.DrawingReader.getRotationDegree=Wa,a.DrawingReader.ReadCT_TextBodyProperties=Va,a.DrawingReader.ReadCT_TextBody=za,a.DrawingReader.ReadCT_TextBulletColorFollowText=qa,a.DrawingReader.ReadCT_TextBulletSizeFollowText=Za,a.DrawingReader.ReadCT_TextBulletSizePercent=Ya,a.DrawingReader.ReadCT_TextBulletSizePoint=Ka,a.DrawingReader.ReadCT_TextBulletTypefaceFollowText=Xa,a.DrawingReader.ReadCT_TextAutonumberBullet=Ja,a.DrawingReader.ReadCT_TextCharBullet=Qa,a.DrawingReader.ReadCT_TextBlipBullet=$a,a.DrawingReader.ReadCT_TextNoBullet=es,a.DrawingReader.ReadCT_TextFont=ts,a.DrawingReader.ReadCT_TextUnderlineLineFollowText=rs,a.DrawingReader.ReadCT_TextUnderlineFillFollowText=ns,a.DrawingReader.ReadCT_TextUnderlineFillGroupWrapper=os,a.DrawingReader.ReadCT_TextCharacterProperties=is,a.DrawingReader.ReadCT_TextSpacingPercent=as,a.DrawingReader.ReadCT_TextSpacingPoint=ss,a.DrawingReader.ReadCT_TextTabStop=ls,a.DrawingReader.ReadCT_TextTabStopList=us,a.DrawingReader.ReadCT_TextLineBreak=function(e){return Fe(e,"rPr",is,{elementType:1})},a.DrawingReader.ReadCT_TextSpacing=cs,a.DrawingReader.ReadCT_TextParagraphProperties=hs,a.DrawingReader.ReadCT_TextField=function(e){for(var t,r,n,o,i={elementType:2};e.moveToNextAttribute();)"id"!==(t=Re(e))&&t!==m||(i[t]=e.readContentAsInt());if(3===e.elementType)return i;for(r=e.depth;e.read()&&(n=e.depth,o=e.elementType,n!==r||2!==o);)if(!(r+1<n||2===o))switch(De(e)){case"rPr":i.rPr=is(e);break;case"pPr":i.pPr=hs(e);break;case"t":i.t=e.readElementContentAsString()}return i},a.DrawingReader.ReadCT_RegularTextRun=function(e){var t,r,n,o,i={elementType:0};if(3===e.elementType)return i;for(t=e.depth;e.read()&&(r=e.depth,n=e.elementType,r!==t||2!==n);)t+1<r||2===n||("rPr"===(o=De(e))?i.rPr=is(e):"t"===o&&(i.t=h(e.readElementContentAsString())));return i}},"./src/xlsx-io/reader/comment-reader.ts":function(e,t,r){"use strict";var c,b,n,y,C,w,v,S,x;function h(e,t,r){var n,f,o,i,a,s,l,u,c,h,d=[],p=r(e.fileName);return p&&(s=p,l=d,u=C.parseXmlToObject,c=u(s),(h=c.comments&&c.comments.commentList)&&v(h.comment).forEach(function(e){var t={},r=e.pe.ref;t.row=b.IndexHelper.F(r),t.col=b.IndexHelper.G(r),function(s,e){if(e){var t=v(e.r),l=1===t.length,u=[];t.forEach(function(e){var t,r,n,o,i,a=e.rPr;a&&l&&((t=a.rFont&&a.rFont.pe.val)&&(s.fontFamily=t),r=0,a.u&&(o=1,(n=a.u&&a.u.pe.val)&&(o=y.UnderLineStyle[n]),r|=2===o?8:1),a.strike&&(r|=2),r&&(s.textDecoration=r),a.b&&(s.fontWeight="bold"),a.i&&(s.fontStyle="italic"),(t=a.color)&&(1===(i=w.readColor(t)).colorType()&&81===i.value()||(s.foreColor=i)),(t=a.sz&&a.sz.pe.val)&&(s.fontSize=t+"pt")),u.push(S(e,"t"))}),s.text=x(u.join(""))}}(t,e.text),l.push(t)}),p=r(t.fileName),n=p,f=d,o=C.parseXmlToObject,i=o(n,!0).xml,(a=v(i["v:shape"]))&&a.forEach(function(e){var t,r,n,o,i,a,s,l,u,c,h=e["x:ClientData"];if(h){if(t=parseInt(S(h,"x:Row"),10),r=parseInt(S(h,"x:Column"),10),isNaN(t)||isNaN(r))return;if(u=t,c=r,!(n=f.filter(function(e){return e.row===u&&e.col===c})[0]))return;(o=(i=e.pe).fillcolor)&&(n.backColor=o),(o=i.strokecolor)&&(n.borderColor=o),(o=i.strokeweight)&&(n.borderWidth=o),(o=i.style)&&m(n,o),(o=e["v:fill"])&&((a=o.pe.opacity)&&("f"===a.substr(-1)?n.opacity=parseFloat(a.substr(0,a.length-1))/65535:n.opacity=parseFloat(a))),(o=e["v:stroke"])&&(n.dashStyle=o.pe.dashstyle,n.lineStyle=o.pe.linestyle),(o=e["v:textbox"])&&((s=o.pe.style)&&-1!==s.indexOf("mso-fit-shape-to-text:t")&&(n.autoSize=!0),n.inset=o.pe.inset),h["x:SizeWithCells"]&&(n.dynamicSize=!1),h["x:MoveWithCells"]&&(n.dynamicMove=!1),(o=S(h,"x:Anchor"))&&(l=o.split(",").map(function(e){return parseInt(e,10)}),n.anchor=l),(o=S(h,"x:Locked"))&&(n.locked=g(o,!0)),(o=S(h,"x:LockText"))&&(n.lockText=g(o,!0)),(o=S(h,"x:TextHAlign"))&&(n.hAlign=o.toLowerCase()),h["x:Visible"]&&(n.displayMode=1)}})),d;function g(e,t){if(e){var r=e.trim().toLowerCase();if(-1!==["false"].indexOf(r))return!1;if(-1!==["true"].indexOf(r))return!0}return t}function m(a,e){e.split(";").forEach(function(e){var t,r,n=(t=":",{key:(r=(e||"").trim().split(t))[0],value:r[1]}),o=n.key,i=n.value;if(!b.k(i))switch(o){case"margin-left":a.marginLeft=T(i);break;case"margin-top":a.marginTop=T(i);break;case"width":a.width=i;break;case"height":a.height=i;break;case"z-index":a.zIndex=parseInt(i,10)}})}}function T(e){try{return-1!==e.indexOf("pt")?parseFloat(e.replace("pt","")):-1!==e.indexOf("in")?72*parseFloat(e.replace("in","")):-1!==e.indexOf("cm")?37.7952755905512*parseFloat(e.replace("cm",""))*72/96:parseFloat(e)}catch(e){return 0}}Object.defineProperty(t,"__esModule",{value:!0}),c=r("./src/common/excel-types.ts"),b=r("./src/common/common.ts"),n=r("./src/xml-io/node-helper.ts"),y=r("./src/datamodel/excel-style.ts"),C=r("./src/xml-io/xml-parser.ts"),w=r("./src/xlsx-io/common/color-reader.ts"),v=n.XmlNodeHelper.qe,S=n.XmlNodeHelper.$l,x=b.Util.ta,t.readComments=function(e,t,r,n){var o,i,a,s,l,u;if(e){for(a in i=o=void 0,e)if("count"!==a&&((s=e[a])&&((l=s.fileType)===c.RelationshipConstants.bb?o=s:l===c.RelationshipConstants.cb&&(i=s),o&&i)))break;o&&i&&(u=h(o,i,n),r.$f(u,t))}},t.readCommentsFromFile=h},"./src/xlsx-io/reader/conditionalformat-reader.ts":function(e,t,r){"use strict";var I,c,h,E,R,D,N,F,_,n,P,f,d,p,i,L,o;function O(e,t,r){return R.Util.ta(n(e,t,r))}function B(e){return e&&"="!==e.charAt(0)?"="+e:e}function u(e,t){var r,n,o,i,a,s,l,u={priority:0,ranges:t},c=e.pe;switch(R.k(c.type)||(r=c.type),R.k(c.priority)||(u.priority=D.XmlNodeHelper.Zl(c.priority,0)),r){case"colorScale":n=b(e.colorScale),u.minType=d[n._l[0].type],u.minValue=B(n._l[0].val),u.minColor=n.am[0],3===n._l.length?(u.ruleType=11,u.midType=d[n._l[1].type],u.midValue=B(n._l[1].val),u.midColor=n.am[1],u.maxType=d[n._l[2].type],u.maxValue=B(n._l[2].val),u.maxColor=n.am[2]):(u.ruleType=10,u.maxType=d[n._l[1].type],u.maxValue=B(n._l[1].val),u.maxColor=n.am[1]);break;case"dataBar":u.ruleType=12,o=e.dataBar,R.k(o.pe.showValue)||(u.showBarOnly=!D.XmlNodeHelper.Xl(o.pe.showValue,!0)),n=b(o),u.minType=d[n._l[0].type],u.minValue=B(n._l[0].val),u.maxType=d[n._l[1].type],u.maxValue=B(n._l[1].val),u.color=n.am[0];break;case"iconSet":u.ruleType=13,u.iconSetType=p.$3TrafficLights1,a=(i=e.iconSet).pe,R.k(a.iconSet)||(u.iconSetType=p["$"+a.iconSet]),R.k(a.showValue)||(u.showIconOnly=!D.XmlNodeHelper.Xl(a.showValue,!0)),R.k(a.reverse)||(u.reverseIconOrder=D.XmlNodeHelper.Xl(a.reverse,!1)),u.iconCriteria=g(i);break;case"cellIs":u.ruleType=1,s=e.pe,R.k(s.stopIfTrue)||(u.stopIfTrue=D.XmlNodeHelper.Xl(s.stopIfTrue,!1)),R.k(s.dxfId)||(u.dxfId=D.XmlNodeHelper.Zl(s.dxfId,-1)),R.k(s.operator)||(u.operator=L[s.operator]),l=_(e.formula),u.value1="="+R.Util.ta(l[0].formula),2===l.length&&(u.value2="="+R.Util.ta(l[1].formula));break;default:u.ruleType=f[r],R.k(c.dxfId)||(u.dxfId=D.XmlNodeHelper.Zl(c.dxfId,-1)),R.k(c.aboveAverage)||(u.aboveAverage=D.XmlNodeHelper.Xl(c.aboveAverage,!0),u.aboveAverage||"aboveAverage"!==r||(r="belowAverage")),R.k(c.bottom)||(u.bottom=D.XmlNodeHelper.Xl(c.bottom,!1)),R.k(c.equalAverage)||D.XmlNodeHelper.Xl(c.equalAverage,!1)&&("aboveAverage"===r&&(r="aboveOrEqualToAverage"),"belowAverage"===r&&(r="belowOrEqualToAverage")),R.k(c.operator)||(u.operator=c.operator),R.k(c.percent)||(u.percent=D.XmlNodeHelper.Xl(c.percent,!1)),R.k(c.rank)||(u.rank=D.XmlNodeHelper.Zl(c.rank,0)),R.k(c.stdDev)||(u.stdDev=D.XmlNodeHelper.Zl(c.stdDev,0)),R.k(c.stopIfTrue)||(u.stopIfTrue=D.XmlNodeHelper.Xl(c.stopIfTrue,!1)),R.k(c.text)||(u.text=R.Util.ta(c.text)),R.k(c.timePeriod)||(r=c.timePeriod),R.k(e.formula)||(u.formula=O(e,"formula")),u=function(e,t){var r,n,o,i,a,s,l;switch(t){case"expression":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return e;case"top10":return r=e.ranges[0],n={ruleType:e.ruleType,dxfId:e.dxfId,rank:e.rank,stopIfTrue:e.stopIfTrue,priority:e.priority,ranges:e.ranges,type:0},e.bottom&&(n.type=1),e.percent&&(0===(o=Math.floor(r.rowCount*r.colCount*e.rank/100))&&(o=1),n.rank=o),n;case"uniqueValues":case"duplicateValues":return e;case"containsText":return e.operator=0,e;case"aboveAverage":case"belowAverage":case"aboveOrEqualToAverage":case"belowOrEqualToAverage":return a=!(i=0),"belowAverage"===t&&(a=!1,i=1),"belowOrEqualToAverage"===t&&(a=!1,i=3),"aboveOrEqualToAverage"===t&&(i=2),R.k(e.stdDev)||(s=e.stdDev,a?1===s?i=4:2===s?i=6:3===s&&(i=8):1===s?i=5:2===s?i=7:3===s&&(i=9)),e.type=i,e;case"beginsWith":return e.operator=2,e;case"endsWith":return e.operator=3,e;case"notContainsText":return e.operator=1,e;case"timePeriod":case"today":case"tomorrow":case"yesterday":case"last7Days":case"lastMonth":case"nextMonth":case"thisWeek":case"nextWeek":case"lastWeek":case"thisMonth":return l={today:0,yesterday:1,tomorrow:2,last7Days:3,thisMonth:4,lastMonth:5,nextMonth:6,thisWeek:7,lastWeek:8,nextWeek:9},e.type=0,l[t]&&(e.type=l[t]),e;default:return e}}(u,r)}return e.extLst&&e.extLst.ext&&e.extLst.ext["x14:id"]&&(u.id=O(e.extLst.ext,"x14:id")),u}function g(e){var t,r,n=[],o=b(e);for(t=1;t<o._l.length;t++)!(r={isGreaterThanOrEqualTo:!0})===o._l[t].gte&&(r.isGreaterThanOrEqualTo=o._l[t].gte),r.iconValueType=i[o._l[t].type],r.iconValue=B(o._l[t].val),n.push(r);return n}function m(e){var t={};return R.k(e.pe.type)||(t.type=e.pe.type),R.k(e.pe.val)||(t.val=e.pe.val),R.k(e.pe.gte)||(t.gte=D.XmlNodeHelper.Xl(e.pe.gte,!0)),e["xm:f"]&&(t.val=O(e,"xm:f")),t}function b(e){var t,r,n,o,i,a,s={_l:[],am:[],bm:[]},l=_(e.cfvo||e["x14:cfvo"]),u=_(e["x14:cfIcon"]);for(t=0;t<l.length;t++)r=m(l[t]),s._l.push(r);for(t=0;t<u.length;t++)i=u[t],a=void 0,a={},R.k(i.pe.iconSet)||(a.iconSetType=p["$"+i.pe.iconSet]),R.k(i.pe.iconId)||(a.iconIndex=parseInt(i.pe.iconId,10)),s.bm.push(a);if(e.color)for(n=_(e.color||e["x14:color"]),o=0;o<n.length;o++)s.am.push(h.ColorHelper.toRGBColor(c.readColor(n[o])));return s}function j(e,t,r){var n,o,i,a=e.Zf(t);if(a=a||{rules:[]},!R.k(r)&&((n=a.rules)&&0<n.length))for(o=0;o<n.length;o++)if(n[o].id===r)return n[o];return i={},e.Yf(t,{rules:[i]}),i}function H(e,t){var r,n=e.pe;R.k(n.showValue)||(t.showBarOnly=!D.XmlNodeHelper.Xl(n.showValue,!0)),R.k(n.border)||(t.showBorder=D.XmlNodeHelper.Xl(n.border,!1)),R.k(n.gradient)||(t.gradient=D.XmlNodeHelper.Xl(n.gradient,!0)),R.k(n.direction)||(t.dataBarDirection="rightToLeft"===n.direction?1:0),R.k(n.axisPosition)||(t.axisPosition=o[n.axisPosition]),R.k(n.negativeBarColorSameAsPositive)||(t.useNegativeFillColor=!D.XmlNodeHelper.Xl(n.negativeBarColorSameAsPositive,!1)),R.k(n.negativeBarBorderColorSameAsPositive)||(t.useNegativeBorderColor=!D.XmlNodeHelper.Xl(n.negativeBarBorderColorSameAsPositive,!0)),r=[],e["x14:cfvo"]&&_(e["x14:cfvo"]).forEach(function(e){r.push(m(e))}),e["x14:fillColor"]&&(t.color=h.ColorHelper.toRGBColor(c.readColor(e["x14:fillColor"]))),e["x14:borderColor"]&&(t.borderColor=h.ColorHelper.toRGBColor(c.readColor(e["x14:borderColor"]))),e["x14:negativeFillColor"]&&(t.negativeFillColor=h.ColorHelper.toRGBColor(c.readColor(e["x14:negativeFillColor"]))),e["x14:negativeBorderColor"]&&(t.negativeBorderColor=h.ColorHelper.toRGBColor(c.readColor(e["x14:negativeBorderColor"]))),e["x14:axisColor"]&&(t.axisColor=h.ColorHelper.toRGBColor(c.readColor(e["x14:axisColor"]))),2===r.length&&(t.minType=d[r[0].type],t.minValue=B(r[0].val),t.maxType=d[r[1].type],t.maxValue=B(r[1].val))}function G(e,t){var r=e.pe;R.k(r.iconSet)||(t.iconSetType=p["$"+r.iconSet]),R.k(r.showValue)||(t.showIconOnly=!D.XmlNodeHelper.Xl(r.showValue,!0)),R.k(r.reverse)||(t.reverseIconOrder=D.XmlNodeHelper.Xl(r.reverse,!1)),t.iconCriteria=g(e),t.icons=function(e){var t,r,n=[],o=b(e);for(t=0;t<o.bm.length;t++)(r={}).iconSetType=o.bm[t].iconSetType,r.iconIndex=o.bm[t].iconIndex,n.push(r);return n}(e)}Object.defineProperty(t,"__esModule",{value:!0}),I=r("./src/common/range-parser.ts"),c=r("./src/xlsx-io/common/color-reader.ts"),h=r("./src/datamodel/excel-style.ts"),E=r("./src/xml-io/xml-parser.ts"),R=r("./src/common/common.ts"),D=r("./src/xml-io/node-helper.ts"),N=r("./src/xlsx-io/reader/style-reader.ts"),F=r("./src/xml-io/xml-reader.ts"),_=D.XmlNodeHelper.qe,n=D.XmlNodeHelper.$l,P=h.ConverterHelper.convertDxfToStyle,t.readConditionalFormatting=function(e,t,r){var n,o,i,a,s,l;if(3!==e.elementType&&(o={rules:[]},i=[],(n=E.parseXmlToObject(e.readFullElement()).conditionalFormatting).pe.sqref&&(i=I.getRangesFromString(n.pe.sqref)),0!==i.length)){for(a=_(n.cfRule),s=0;s<a.length;s++)(l=u(a[s],i))&&o.rules.push(l);r.Yf(t,o)}},f={beginsWith:2,endsWith:2,notContainsText:2,containsText:2,expression:3,containsBlanks:3,notContainsBlanks:3,containsErrors:3,notContainsErrors:3,timePeriod:4,today:4,tomorrow:4,yesterday:4,last7Days:4,lastMonth:4,nextMonth:4,thisWeek:4,nextWeek:4,lastWeek:4,thisMonth:4,top10:5,uniqueValues:6,duplicateValues:7,aboveAverage:8,belowAverage:8,aboveOrEqualToAverage:8,belowOrEqualToAverage:8},d={num:0,min:1,max:2,percent:3,percentile:4,stddev:0,formula:6,autoMin:5,autoMax:7},p={$3Arrows:0,$3ArrowsGray:1,$3Flags:4,$3TrafficLights1:5,$3TrafficLights2:6,$3Signs:7,$3Symbols:8,$3Symbols2:9,$4Arrows:10,$4ArrowsGray:11,$4RedToBlack:12,$4Rating:13,$4TrafficLights:14,$5Arrows:15,$5ArrowsGray:16,$5Rating:17,$5Quarters:18,$3Stars:3,$3Triangles:2,$5Boxes:19,$NoIcons:20},i={num:1,percent:4,formula:7,percentile:5},L={equal:0,notEqual:1,greaterThan:2,greaterThanOrEqual:3,lessThan:4,lessThanOrEqual:5,between:6,notBetween:7},t.readExtensionConditionalFormating=function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M=E.parseXmlToObject(e.readFullElement()).ext;if(M["x14:conditionalFormattings"]&&M["x14:conditionalFormattings"]["x14:conditionalFormatting"])for(o=_(M["x14:conditionalFormattings"]["x14:conditionalFormatting"]),i=0;i<o.length;i++)for(a=o[i],s=_(a["x14:cfRule"]),l=0;l<s.length;l++)c=(u=s[l]).pe,R.k(c.type)||(n=c.type),h=j(r,t,c.id),c.priority&&(h.priority=+c.priority),"dataBar"===n?(h.ruleType=12,H(u["x14:dataBar"],h)):"iconSet"===n?(h.ruleType=13,G(u["x14:iconSet"],h)):"expression"===n?(h.ruleType=3,v=u,x=r,A=void 0,(S=h).formula=B(O(v,"xm:f")),T=E.convertObjectToXml(v["x14:dxf"],"x14:dxf"),(A=new F.XmlReader).setXml(T),A.read(),k=N.readDifferentialFormattingRecord(A),S.style=P(k,x.Pe,x.Qe)):"cellIs"===n&&(h.ruleType=1,p=h,g=r,y=void 0,w=(d=u).pe,R.k(w.stopIfTrue)||(p.stopIfTrue=D.XmlNodeHelper.Xl(w.stopIfTrue,!1)),R.k(w.operator)||(p.operator=L[w.operator]),m=_(d["xm:f"]),p.value1="="+R.Util.ta(m[0]["xm:f"]),2===m.length&&(p.value2="="+R.Util.ta(m[1]["xm:f"])),b=E.convertObjectToXml(d["x14:dxf"],"x14:dxf"),(y=new F.XmlReader).setXml(b),y.read(),C=N.readDifferentialFormattingRecord(y),p.style=P(C,g.Pe,g.Qe)),a["xm:sqref"]&&(f=I.getRangesFromString(O(a,"xm:sqref")),h&&(h.ranges=f))},o={automatic:0,middle:1,none:2},t.readExtensionDataBarRule=H,t.readExtensionIconSetRule=G},"./src/xlsx-io/reader/datavalidation-reader.ts":function(e,t,r){"use strict";var h,o,i,f,d,p,g,m,b;function y(e,t,r){return p(i.XmlNodeHelper.$l(e,t,r))}function a(e,t,r,n){var o,i,a,s,l,u,c;h.isNullOrUndefined(e)||h.isNullOrUndefined(t)||(o=e.pe,(i={type:g[o.type]||0,errorType:m[o.errorStyle]||0,compareOperator:h.isNullOrUndefined(b[o.operator])?6:b[o.operator],allowBlank:d(o.allowBlank,!1),showPromptBox:!d(o.showDropDown,!1),showInputMessage:d(o.showInputMessage,!1),showErrorMessage:d(o.showErrorMessage,!1),errorTitle:p(o.errorTitle),error:p(o.error),promptTitle:p(o.promptTitle),prompt:p(o.prompt)}).error=h.Util.Aa(i.error),i.prompt=h.Util.Aa(i.prompt),n?(a=y(e,"xm:sqref"),u=e["x14:formula1"],c=e["x14:formula2"],u&&(s=y(u,"xm:f")),c&&(l=y(c,"xm:f"))):(a=o.sqref,s=y(e,"formula1"),l=y(e,"formula2")),i.firstFormula=s,i.secondFormula=l,i.ranges=f.getRangesFromString(a),r.og(t,i))}Object.defineProperty(t,"__esModule",{value:!0}),h=r("./src/common/common.ts"),o=r("./src/xml-io/xml-parser.ts"),i=r("./src/xml-io/node-helper.ts"),f=r("./src/common/range-parser.ts"),d=i.XmlNodeHelper.Xl,p=h.Util.ta,g={none:0,whole:1,decimal:2,list:3,date:4,time:5,textLength:6,custom:7},m={stop:0,warning:1,information:2},b={between:6,notBetween:7,equal:0,notEqual:1,greaterThan:2,lessThan:4,greaterThanOrEqual:3,lessThanOrEqual:5},t.readDataValidations=function(e,t,r){var n=o.parseXmlToObject(e.readFullElement()).dataValidations;i.XmlNodeHelper.qe(n.dataValidation).forEach(function(e){a(e,t,r)})},t.readExtensionDataValidation=function(e,t,r){var n=o.parseXmlToObject(e.readFullElement()).ext["x14:dataValidations"];i.XmlNodeHelper.qe(n["x14:dataValidation"]).forEach(function(e){a(e,t,r,!0)})}},"./src/xlsx-io/reader/docpropsapp-reader.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("./src/xml-io/xml-reader.ts");function i(e,t,r){if(1===e.nodeType()){var n=e.readElementContentAsString(!0);t.Fg(r,n)}}function a(e,t,r){var n,o,i,a,s,l;if(3!==e.elementType){for(n={},o=[],i=e.depth;e.read()&&!(e.depth<=i);)if(1===e.nodeType()&&"vt:vector"===e.name()){if(u(e,n),3===e.elementType)continue;for(a=e.depth;e.read()&&!(e.depth<=a);)if(1===e.nodeType()){if(3===e.elementType)continue;for(s=e.depth;e.read()&&!(e.depth<=s);)1===e.nodeType()&&((l={}).elementType=e.name(),l.value=e.readElementContentAsString(!0),o.push(l));n.workbookInfoArray=o}}t.Fg(r,n)}}function s(e,t,r){var n,o,i,a,s;if(3!==e.elementType){for(n={},o=[],i=e.depth;e.read()&&!(e.depth<=i);)if(1===e.nodeType()&&"vt:vector"===e.name()){if(u(e,n),3===e.elementType)continue;for(a=e.depth;e.read()&&!(e.depth<=a);)1===e.nodeType()&&(s=e.readElementContentAsString(!0),o.push(s));n.sheetsNameArray=o}t.Fg(r,n)}}function u(e,t){for(;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"size":t.size=e.readContentAsInt(1);break;case"baseType":t.baseType=e.readContentAsString()}}t.readDocPropsAppFile=function(e,t){var r,n=new o.XmlReader;for(n.setXml(e);n.read();)if(1===n.depth&&2!==n.elementType)switch(r=n.name()){case"HeadingPairs":a(n,t,r);break;case"TitlesOfParts":s(n,t,r);break;default:i(n,t,r)}}},"./src/xlsx-io/reader/docpropscore-reader.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("./src/xml-io/xml-reader.ts");function i(e,t,r){if(1===e.nodeType()){var n=e.readElementContentAsString(!0);t.Eg(r,n)}}t.readDocPropsCoreFile=function(e,t){var r,n=new o.XmlReader;for(n.setXml(e);n.read();)1===n.depth&&2!==n.elementType&&(-1!==(r=n.name()).indexOf(":")&&(r=n.name().split(":")[1]),i(n,t,r))}},"./src/xlsx-io/reader/docpropscustom-reader.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("./src/xml-io/xml-reader.ts");function i(e,t){var r,n,o,i,a;if(3!==e.elementType&&1===e.nodeType()&&"property"===e.name()){for(r={};e.moveToNextAttribute();)n=e.readAttributeNameAsString(),o=e.readContentAsString(),r[n]=o;for(i=e.depth;e.read()&&!(e.depth<=i);)1===e.nodeType()&&(a={},n=e.name(),o=e.readElementContentAsString(!0),a[n]=o,r.propertyItemChildElement=a);t.push(r)}}t.readDocPropsCustomFile=function(e,t){var r,n=new o.XmlReader;for(n.setXml(e),r=[];n.read();)1===n.depth&&2!==n.elementType&&i(n,r);t.Gg(r)}},"./src/xlsx-io/reader/drawing-reader.ts":function(e,t,r){"use strict";var n,S,v,x,p,T,A,k,M,I,E,R,D,N,o;function F(e,t,r){var n,o,i,a,s,l=e&&e.blipFill&&e.blipFill.blip&&e.blipFill.blip.embed;l&&(!(n=t[l])||0<=(i=(o=n.fileName).lastIndexOf("."))&&((a=T.getImageContent(o,r))&&((s=e.blipFill.blip.blipBlob={}).blob=a,s.type=o.substr(i+1))))}function _(){this.cache={},this.get=function(e,t){var r=this.cache[e];return!r&&t&&(r=this.cache[e]=new o(t)),r}}function P(e,t,r,n){var o,i,a={};return function(e,t,r,n){var o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w;if(t){if((o=t["xdr:nvPicPr"])&&(i=o["xdr:cNvPr"],r.name=i&&i.pe.name,r.descr=i&&i.pe.descr,r.isVisible=!v.XmlNodeHelper.Xl(i&&i.pe.hidden,!1)),o=t["xdr:blipFill"]){for(u in a=o["a:blip"],s=a&&a.pe["r:embed"],(l=a&&a["a:extLst"]&&a["a:extLst"]["a:ext"])instanceof Array||(l=[l]),l)l.hasOwnProperty(u)&&((c=l[u]&&l[u]["asvg:svgBlip"])&&(s=c.pe["r:embed"]));s&&((h=e[s])&&((f=T.getImageContent(h.fileName,n))&&(r.src=f))),d=o["a:srcRect"],(p=d&&d.pe)&&(g=+p.l||0,m=+p.t||0,b=+p.r||0,y=+p.b||0,(g||m||b||y)&&(r.srcRect={l:g,t:m,r:b,b:y}))}(o=t["xdr:spPr"])&&(r.pictureFormat=B(o),(C=o["a:xfrm"])&&((w=parseInt(C.pe.rot,10))&&(r.rot=k.DrawingReader.getRotationDegree(w))))}}(r,t["xdr:pic"],a,n),o=t["xdr:clientData"],i=a,o&&(i.locked=v.XmlNodeHelper.Xl(o.pe.fLocksWithSheet,!0)),a.src&&e.push(a),a}function L(e,t,r){var n,o,i,a,s,l,u,c,h;if(!e)return null;for(n=t(e.fileName,!0),(o=new A.XmlReader).reset(),o.setXml(n),o.keepRootNamespace=!0;o.read();)if(0===o.depth&&2!==o.elementType){if("c:chartSpace"===o.name()){i=k.DrawingReader.ReadCT_ChartSpace(o),a=!1;break}if("cx:chartSpace"===o.name()){s=r&&r.names?r.names:[],i=k.DrawingReader.Chart2016Reader.ReadCT_ChartSpace(o,s),a=!0;break}}if(a)for(u in l=e.relationFiles)"count"!==u&&((h=(c=l[u])&&c.fileType)===S.RelationshipConstants.pb?i.style=f(c,t):h===S.RelationshipConstants.ob&&(i.colors=d(c,t)));return i}function f(e,t){var r=t(e.fileName,!0),n=new A.XmlReader;for(n.reset(),n.setXml(r);n.read();)if(0===n.depth&&2!==n.elementType)return k.DrawingReader.Chart2016Reader.ReadCT_ChartStyle(n)}function d(e,t){var r=t(e.fileName,!0),n=new A.XmlReader;for(n.reset(),n.setXml(r);n.read();)if(0===n.depth&&2!==n.elementType)return k.DrawingReader.Chart2016Reader.ReadCT_chartColors(n)}function O(e){var t,r,n=e&&e["c:userShapes"];if(n){if(t=n["cdr:absSizeAnchor"],r=n["cdr:relSizeAnchor"],t)return t["cdr:pic"]&&t["cdr:pic"]["cdr:spPr"];if(r)return r["cdr:pic"]&&r["cdr:pic"]["cdr:spPr"]}return null}function i(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y=e["a:solidFill"];return y?{fillFormatType:1,color:C(y,b={}),drawingColorSettings:b}:(y=e["a:pattFill"])?(g=(c=y).pe.prst||"pct5",(m=c["a:bgClr"])&&(f=C(m,h={})),(m=c["a:fgClr"])&&(p=C(m,d={})),{fillFormatType:4,fillPattern:g,backgroundDrawingColorSettings:h,backgroundColor:f,foregroundDrawingColorSettings:d,foregroundColor:p}):(y=e["a:noFill"])?{fillFormatType:0}:(y=e["a:gradFill"])?(s=[],l=(i=y).pe,(u={fillFomatType:2,gradientStops:s}).flipMode=l.flip||"none",u.rotateWithShape=v.XmlNodeHelper.Xl(l.rotWithShape,!1),(a=i["a:gsLst"])&&M(a["a:gs"]).forEach(function(e){var t,r,n;s.push((n=C(t=e,r={}),{position:parseFloat(t.pe.pos||"100000")/1e5,color:n,drawingColorSettings:r}))}),(a=i["a:lin"])&&(u.gradientFillType="linear",u.angle=parseFloat(a.pe.ang||"0")/6e4,u.scaled=v.XmlNodeHelper.Xl(a.pe.scaled,!1)),(a=i["a:path"])&&(u.gradientFillType=a.pe.path||"shape",u.fillToRect=w(a["a:fillToRect"])),u.tileRect=w(i["a:tileRect"]),u):(y=e["a:blipFill"])?(t=y,(o={transparency:1}).rotateWithShape=v.XmlNodeHelper.Xl(t.pe.rotWithShape,!1),(r=t["a:blip"])&&(o.imageID=r.pe["r:embed"],(n=r["a:alphaModFix"])&&(o.transparency=1-parseFloat(n.pe.amt||"0")/1e5)),(r=t["a:tile"])&&(o.tile=function(e){var t=e.pe,r=t.sx,n=t.sy,o=t.tx,i=t.ty;return{alignment:t.algn||"tl",flipping:t.flip||"none",horizontalRatio:r&&parseFloat(r)/1e5||1,verticalRatio:n&&parseFloat(n)/1e5||1,horizontalOffset:o&&parseFloat(o)/1e5||0,verticalOffset:i&&parseFloat(i)/1e5||0}}(r)),(r=t["a:stretch"])&&(o.stretch=w(r["a:fillRect"])),o):void 0}function g(r,n,e){e.forEach(function(e){var t=n["a:"+e];t&&(r[e]=parseInt(t.pe.val||"0",10))})}function C(e,t){var r,n,o,i,a,s,l,u,c,h,f,d=e["a:schemeClr"];return d&&(r=(d.pe.val||"").toUpperCase(),g(t,d,["alpha","shade","tint","hue","hueOff","hueMod","sat","satOff","satMod","lum","lumOff","lumMod"]),r)?new p.ExcelColor(3,p.ColorHelper.toColorSchemeIndex(r),0):(d=e["a:hslClr"])?(o=d.pe,i=parseInt(o.hue||"0",10),a=parseInt(o.sat||"0",10),s=parseInt(o.lum||"0",10),g(t,d,["alpha","shade","tint"]),p.ColorHelper.fromColorToExcelColor(p.ColorHelper.convertHLSToRGB(i,s,a))):(d=e["a:prstClr"])&&(r=d.pe.val||"",g(t,d,["alpha","shade","tint"]),r)?p.ColorHelper.fromColorToExcelColor(p.ColorHelper.fromPresetColorVal(r)):(d=e["a:scrgbClr"])?(o=d.pe,l=parseInt(o.r||"0",10),u=parseInt(o.g||"0",10),c=parseInt(o.b||"0",10),g(t,d,["alpha","shade","tint"]),p.ColorHelper.fromColorToExcelColor(new p.nj(255,p.ColorHelper.scRgbTosRgb(l),p.ColorHelper.scRgbTosRgb(u),p.ColorHelper.scRgbTosRgb(c)))):(d=e["a:srgbClr"])&&(n=d.pe.val,g(t,d,["alpha","shade","tint"]),n&&(r=parseInt(n,16),!isNaN(r)))?new p.ExcelColor(2,r,0):(d=e["a:sysClr"])&&(h=d.pe.val,f=p.ExcelSystemColor.getSystemColor(h),g(t,d,["alpha","shade","tint","lumMode"]),f)?p.ColorHelper.fromColorToExcelColor(f):null}function a(e){if(e){var t=e.pe;return{length:t.len||"lg",type:t.type||"none",width:t.w||"lg"}}}function w(e){if(e){var t=e.pe;return[t.l,t.t,t.r,t.b].map(function(e){return parseFloat(e||"0")/1e5})}}function B(e){var t,r={};return r.lineFormat=function(e){var t,r,n,o;if(e)return t={},r=e.pe,n=parseInt(r.w||"0",10),t.width=p.UnitHelper.emuToPixles(n),t.compoundLineType=r.compd||"sng",t.lineEndingCap=r.cap||"sq",t.penAlignment=r.align||"ctr",t.fillFormat=i(e),t.headLineEndStyle=a(e["a:headEnd"]),t.tailLineEndStyle=a(e["a:tailEnd"]),e["a:bevel"]&&(t.joinType="bevel"),e["a:miter"]&&(t.joinType="miter"),e["a:round"]&&(t.joinType="round"),o=e["a:prstDash"],t.lineDashType=o&&o.pe.val||"solid",t}(e["a:ln"]),(t=i(e))&&(r.fillFormat=t),r}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/common/common.ts"),S=r("./src/common/excel-types.ts"),v=r("./src/xml-io/node-helper.ts"),x=r("./src/xml-io/xml-parser.ts"),p=r("./src/datamodel/excel-style.ts"),T=r("./src/datamodel/excel-helper.ts"),A=r("./src/xml-io/xml-reader.ts"),k=r("./src/xlsx-io/reader/chart-reader.ts"),M=v.XmlNodeHelper.qe,I=v.XmlNodeHelper.cm,E=v.XmlNodeHelper.dm,R=v.XmlNodeHelper.em,D=n.Util.Ca,N=r("./src/datamodel/chart-model.ts"),t.readDrawings=function(e,t,r,n){var o,i,a,s,l,y,C,w,v;if(e){for(i in o=[],e)"count"!==i&&((a=e[i])&&((s=a.fileType)!==S.RelationshipConstants.eb&&s!==S.RelationshipConstants.fb||o.push(a)));o.length&&(l={names:r.we.names||[]},y=n,C=l,v={},o.forEach(function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b=e.relationFiles;if(b)for(t in b)"count"!==t&&(r=b[t])&&((n=r.fileType)!==S.RelationshipConstants.hb&&n!==S.RelationshipConstants.ib&&n!==S.RelationshipConstants.lb&&n!==S.RelationshipConstants.mb||(v[t]=r));(o=y(e.fileName,!0))&&(i=o,a=v,s=y,l=C,g=x.parseXmlToObject(i,!0)["xdr:wsDr"],m={},g&&(0<(u=function(e,n,o){var i,a;return e?(i=[],M(e["xdr:oneCellAnchor"]).forEach(function(e){if(e&&e["xdr:pic"]){var t={startPoint:R(e["xdr:from"])};E(e["xdr:ext"],t),a=P(i,e,n,o),t.anchorType=1,a.anchor=t}}),M(e["xdr:twoCellAnchor"]).forEach(function(e){var t,r;e&&e["xdr:pic"]&&(t={startPoint:R(e["xdr:from"]),endPoint:R(e["xdr:to"])},(r=e.pe.editAs)&&(t.editAs=N.Charts.ST_EditAs[r]),a=P(i,e,n,o),t.anchorType=0,a.anchor=t)}),M(e["xdr:absoluteAnchor"]).forEach(function(e){if(e&&e["xdr:pic"]){var t={};I(e["xdr:pos"],t),E(e["xdr:ext"],t),a=P(i,e,n,o),t.anchorType=2,a.anchor=t}}),i):[]}(g,a,s)).length&&(m.pictures=u),c=function(e){var t=new A.XmlReader;for(t.reset(),t.setXml(e),t.keepRootNamespace=!0;t.read();)if(0===t.depth&&2!==t.elementType&&"xdr:wsDr"===t.name())return k.DrawingReader.ReadCT_Drawing(t);return null}(i),h=c&&c.AnchorBaseList,0<(f=function(e,m,b,y){var C=[];return e&&0<e.length&&e.forEach(function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g=e.AlternateContent;if((r=(t=D(g)?g.Choice.GraphicalObjectFrame:e.graphicFrame)&&t.graphic&&t.graphic.graphicData&&t.graphic.graphicData.chart&&t.graphic.graphicData.chart.id)&&(o=L(n=m[r],b,y))){for(s in i={},a=n.relationFiles)"count"!==s&&(l=a[s])&&((u=l.fileType)!==S.RelationshipConstants.nb&&u!==S.RelationshipConstants.hb||(i[s]=l));(c=function(e,t,a){var r,s,n,o,i,l,u;if(!e||!e.id)return null;for(o in r=t[e.id],s={},n=r.relationFiles)"count"!==o&&(i=n[o])&&((l=i.fileType)!==S.RelationshipConstants.hb&&l!==S.RelationshipConstants.lb||(s[o]=i));return(u=function(e,t){var r,n,o,i,a;if(!e)return null;for(r=e.fileName,n=t(r,!0),(o=new A.XmlReader).reset(),o.setXml(n),o.keepRootNamespace=!0;o.read();)if(0===o.depth&&2!==o.elementType&&"c:userShapes"===o.name()&&(i=k.DrawingReader.ReadCT_ChartDrawing(o)))return(a=i.relSizeAnchor.concat(i.absSizeAnchor)).forEach(function(e){if(e.pic){var t=x.parseXmlToObject(n);e.pictureStyleInfo=O(t)}}),a;return null}(r,a))&&0<u.length?u.map(function(e){return e.pic?function(e,t,r){F(e.pic,t,r);var n=e.pictureStyleInfo;n&&(e.pictureFormat=B(n),delete e.pictureStyleInfo)}(e,s,a):e.graphicFrame&&(r=s,n=a,o=(t=e).graphicFrame.graphic&&t.graphicFrame.graphic.graphicData&&t.graphicFrame.graphic.graphicData.chart&&t.graphicFrame.graphic.graphicData.chart.id,(i=r[o])&&(t.chartSpace=L(i,n))),e;var t,r,n,o,i}):void 0}(o.userShapes,i,b))&&(o.userShapes=c),f=i,d=b,(p=(h=o).chart.plotArea)&&p.chartGroups&&p.chartGroups.forEach(function(e){e&&e.ser&&e.ser.forEach(function(e){e.spPr&&F(e.spPr,f,d),e.dLbls&&e.dLbls.spPr&&F(e.dLbls.spPr,f,d)})}),p&&p.spPr&&F(p.spPr,f,d),h.spPr&&F(h.spPr,f,d),e.chartSpace=o,C.push(e)}}),C}(h,a,s,l)).length&&(m.charts=f),0<(d=function(e,o,i){var a=[];return e&&0<e.length&&e.forEach(function(e){var t,r,n;(e.sp||e.cxnSp||e.grpSp)&&(r=o,n=i,(t=e).sp&&t.sp.spPr?F(t.sp.spPr,r,n):t.grpSp&&(t.grpSp.sp&&t.grpSp.sp.forEach(function(e){e.spPr&&F(e.spPr,r,n)}),t.grpSp.grpSpPr&&F(t.grpSp.grpSpPr,r,n)),a.push(e))}),a}(h,a,s)).length&&(m.shapes=d),p=new _,h.forEach(function(e,t){var r=e.pic;r&&!r.nvPicPr.cNvPr.hidden&&function(e,t,r){var n,o,i,a,s,l,u=r.get(t,e[t].pic.spPr.xfrm);if(u)for(n=0;n<t;n++)(o=e[n]).pic||o.hidden||(i=T.getXFrm(o))&&(a=r.get(n,i))&&(l=u,(s=a).left>=l.left&&s.top>=l.top&&s.right<=l.right&&s.bottom<=l.bottom)&&(o.hidden=!0)}(h,t,p)})),w=m)}),r.ag(w,t))}},o=function(e){var t=e.off,r=e.ext,n=r.cx,o=r.cy;this.left=t.x,this.top=t.y,this.right=this.left+n,this.bottom=this.top+o}},"./src/xlsx-io/reader/metadata-reader.ts":function(e,t,r){"use strict";var o,n,i;function a(e){return e.pe.name}Object.defineProperty(t,"__esModule",{value:!0}),o=r("./src/xml-io/xml-parser.ts"),n=r("./src/xml-io/node-helper.ts"),i=n.XmlNodeHelper.qe,t.readSheetMetadata=function(e,t){var r,n=o.parseXmlToObject(e).metadata;n&&(r=i(n.metadataTypes.metadataType).map(a),n.typeNames=r,t.yg(n))}},"./src/xlsx-io/reader/pivot-reader.ts":function(e,t,r){"use strict";var c,u,h,n,f,d,p,g,m,b,y;function o(e,t){for(var r=e.depth;e.read()&&!(e.depth<=r);)switch(e.name()){case"cacheSource":a(e,t);break;case"cacheFields":s(e,t);break;case"cacheHierarchy":x(e,t);break;case"kpi":k(e,t);break;case"tupleCache":M(e,t);break;case"calculatedItem":I(e,t);break;case"calculatedMember":E(e,t);break;case"dimension":R(e,t);break;case"measureGroup":D(e,t);break;case"map":N(e,t);break;case"extLst":F(e,t)}}function i(e,t){for(;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"backgroundQuery":t.backgroundQuery=e.readContentAsBoolean();break;case"createdVersion":t.createdVersion=e.readContentAsInt();break;case"enableRefresh":t.enableRefresh=e.readContentAsBoolean();break;case"r:id":t.rid=e.readContentAsString();break;case"invalid":t.invalid=e.readContentAsBoolean();break;case"minRefreshableVersion":t.minRefreshableVersion=e.readContentAsInt();break;case"missingItemsLimit":t.missingItemsLimit=e.readContentAsInt();break;case"recordCount":t.recordCount=e.readContentAsInt();break;case"optimizeMemory":t.optimizeMemory=e.readContentAsBoolean();break;case"refreshedBy":t.refreshedBy=e.readContentAsString();break;case"refreshedDate":t.refreshedDate=n.DateTimeHelper.se(e.readContentAsDouble());break;case"refreshedVersion":t.refreshedVersion=e.readContentAsInt();break;case"refreshOnLoad":t.refreshOnLoad=e.readContentAsBoolean();break;case"saveData":t.saveData=e.readContentAsBoolean();break;case"supportAdvancedDrill":t.supportAdvancedDrill=e.readContentAsBoolean();break;case"supportSubquery":t.supportSubquery=e.readContentAsBoolean();break;case"tupleCache":t.tupleCache=e.readContentAsBoolean();break;case"upgradeOnRefresh":t.upgradeOnRefresh=e.readContentAsBoolean()}}function a(e,t){for(var r;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"type":t.sourceType=e.readContentAsString();break;case"connectionId":t.sourceConnectionId=e.readContentAsInt()}for(r=e.depth;e.read()&&!(e.depth<=r);)switch(e.name()){case"worksheetSource":for(;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"ref":t.ref=e.readContentAsString();break;case"sheet":t.sheet=e.readContentAsString();break;case"name":t.sourceName=e.readContentAsString()}}}function s(e,t){var r,n,o,i;for(t.fields=[],r=e.depth;e.read()&&!(e.depth<=r);){for(n={};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"caption":n.caption=e.readContentAsString();break;case"databaseField":n.databaseField=e.readContentAsBoolean();break;case"formula":n.formula=e.readContentAsString();break;case"hierarchy":n.hierarchy=e.readContentAsInt();break;case"level":n.level=e.readContentAsInt();break;case"mappingCount":n.mappingCount=e.readContentAsInt();break;case"memberPropertyField":n.memberPropertyField=e.readContentAsBoolean();break;case"name":n.name=y(e.readContentAsString());break;case"numFmtId":n.numFmtId=e.readContentAsInt();break;case"propertyName":n.propertyName=e.readContentAsString();break;case"serverField":n.serverField=e.readContentAsBoolean();break;case"sqlType":n.sqlType=e.readContentAsInt();break;case"uniqueList":n.uniqueList=e.readContentAsBoolean()}if(3!==e.elementType)for(o=e.depth;e.read()&&!(e.depth<=o);)switch(e.name()){case"sharedItems":w(e,n),v(e,n);break;case"fieldGroup":l(e,i={}),h.isNullOrUndefined(i.base)||C(e,i),n.fieldGroup=i;break;case"mpMap":for(n.mpMap=[];e.moveToNextAttribute();)"v"===e.readAttributeNameAsString()&&n.mpMap.push(e.readContentAsInt())}t.fields.push(n)}}function l(e,t){for(;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"par":t.parent=e.readContentAsInt();break;case"base":t.base=e.readContentAsInt()}}function C(e,t){for(var r,n,o=e.depth;e.read()&&!(e.depth<=o);)switch(e.name()){case"rangePr":for(t.hasRangeGroup=!0;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"autoStart":t.autoStart=e.readContentAsBoolean();break;case"autoEnd":t.autoEnd=e.readContentAsBoolean();break;case"groupBy":t.groupBy=e.readContentAsString();break;case"startNum":t.startNum=e.readContentAsDouble();break;case"endNum":t.endNum=e.readContentAsDouble();break;case"startDate":t.startDate=Date.parse(e.readContentAsString());break;case"endDate":t.endDate=Date.parse(e.readContentAsString());break;case"groupInterval":t.groupInterval=e.readContentAsDouble()}break;case"discretePr":for(t.discreteGroup=[],r=e.depth;e.read()&&!(e.depth<=r);)if("x"===e.name())for(;e.moveToNextAttribute();)"v"===e.readAttributeNameAsString()&&t.discreteGroup.push(e.readContentAsInt());break;case"groupItems":for(t.groupItems=[],n=e.depth;e.read()&&!(e.depth<=n);)t.groupItems.push(S(e))}}function w(e,t){for(;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"containsBlank":t.containsBlank=e.readContentAsBoolean();break;case"containsDate":t.containsDate=e.readContentAsBoolean();break;case"containsInteger":t.containsInteger=e.readContentAsBoolean();break;case"containsMixedTypes":t.containsMixedTypes=e.readContentAsBoolean();break;case"containsNonDate":t.containsNonDate=e.readContentAsBoolean();break;case"containsNumber":t.containsNumber=e.readContentAsBoolean();break;case"containsSemiMixedTypes":t.containsSemiMixedTypes=e.readContentAsBoolean();break;case"containsString":t.containsString=e.readContentAsBoolean();break;case"longText":t.longText=e.readContentAsBoolean();break;case"maxDate":t.maxDate=Date.parse(e.readContentAsString());break;case"maxValue":t.maxValue=e.readContentAsDouble();break;case"minDate":t.minDate=Date.parse(e.readContentAsString());break;case"minValue":t.minValue=e.readContentAsDouble()}}function v(e,t){t.entities=[];var r=e.depth;if(3!==e.elementType)for(;e.read()&&!(e.depth<=r);)t.entities.push(S(e))}function S(e){var t={},r=e.name();switch(r){case"b":t.type="b";break;case"d":t.type="d";break;case"e":t.type="e";break;case"m":t.type="m";break;case"n":t.type="n";break;case"s":t.type="s"}for(;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"c":t.caption=e.readContentAsString();break;case"cp":t.propertyCount=e.readContentAsInt();break;case"f":t.isCalculatedItem=e.readContentAsBoolean();break;case"u":t.isUnusedItem=e.readContentAsBoolean();break;case"b":t.isBold=e.readContentAsBoolean();break;case"bc":t.backgroundColor=e.readContentAsInt();break;case"fc":t.foregroundColor=e.readContentAsInt();break;case"i":t.isItalic=e.readContentAsBoolean();break;case"in":t.formatIndex=e.readContentAsInt();break;case"st":t.isStrikethrough=e.readContentAsBoolean();break;case"un":t.isUnderline=e.readContentAsBoolean();break;case"v":switch(r){case"b":t.value=e.readContentAsBoolean();break;case"d":t.value=h.Util.Aa(e.readContentAsString());break;case"e":t.value=e.readContentAsError();break;case"n":t.value=e.readContentAsDouble();break;case"s":t.value=e.readContentAsString();break;case"x":t.value=e.readContentAsString()}}return t}function x(e,t){var r,n;for(t.cacheHierarchies=[];e.read();){for(r={fieldsUsages:[],groupLevels:[]};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"uniqueName":r.uniqueName=e.readContentAsString();break;case"caption":r.caption=e.readContentAsString();break;case"measure":r.measure=e.readContentAsBoolean();break;case"set":r.set=e.readContentAsBoolean();break;case"parentSet":r.parentSet=e.readContentAsInt();break;case"iconSet":r.iconSet=e.readContentAsInt();break;case"attribute":r.attribute=e.readContentAsBoolean();break;case"time":r.time=e.readContentAsBoolean();break;case"keyAttribute":r.keyAttribute=e.readContentAsBoolean();break;case"defaultMemberUniqueName":r.defaultMemberUniqueName=e.readContentAsString();break;case"allUniqueName":r.allUniqueName=e.readContentAsString();break;case"allCaption":r.allCaption=e.readContentAsString();break;case"dimensionUniqueName":r.dimensionUniqueName=e.readContentAsString();break;case"displayFolder":r.displayFolder=e.readContentAsString();break;case"measureGroup":r.measureGroup=e.readContentAsString();break;case"measures":r.measures=e.readContentAsBoolean();break;case"count":r.count=e.readContentAsInt();break;case"oneField":r.oneField=e.readContentAsBoolean();break;case"memberValueDatatype":r.memberValueDatatype=e.readContentAsInt();break;case"unbalanced":r.unbalanced=e.readContentAsBoolean();break;case"unbalancedGroup":r.unbalancedGroup=e.readContentAsBoolean();break;case"hidden":r.hidden=e.readContentAsBoolean()}for(n=e.depth;e.read()&&!(e.depth<=n);)switch(e.name()){case"fieldUsage":r.fieldsUsages.push(e.readContentAsInt());break;case"groupLevel":r.groupLevels.push(T(e))}t.cacheHierarchies.push(r)}}function T(e){for(var t,r={};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"uniqueName":r.uniqueName=e.readContentAsString();break;case"caption":r.caption=e.readContentAsString();break;case"user":r.user=e.readContentAsBoolean();break;case"customRollUp":r.customRollUp=e.readContentAsBoolean()}for(t=e.depth;e.read()&&!(e.depth<=t);)e.name()&&r.groups.push(A(e));return r}function A(e){for(var t,r,n={groupMembers:[]};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"name":n.Name=e.readContentAsString();break;case"uniqueName":n.UniqueName=e.readContentAsString();break;case"caption":n.Caption=e.readContentAsString();break;case"uniqueParent":n.UniqueParent=e.readContentAsString();break;case"id":n.Id=e.readContentAsInt()}for(t=e.depth;e.read()&&!(e.depth<=t);)if("groupMember"===e.name()){for(r={};e.moveToNextAttribute();)switch(e.name()){case"uniqueName":r.uniqueName=e.readContentAsString();break;case"group":r.group=e.readContentAsBoolean()}n.groupMembers.push(r)}return n}function k(e,t){for(t.KPIs=[];e.moveToNextAttribute();){var r={};switch(e.readAttributeNameAsString()){case"uniqueName":r.uniqueName=e.readContentAsString();break;case"caption":r.caption=e.readContentAsString();break;case"displayFolder":r.displayFolder=e.readContentAsString();break;case"measureGroup":r.measureGroup=e.readContentAsString();break;case"parent":r.parent=e.readContentAsString();break;case"value":r.value=e.readContentAsString();break;case"goal":r.goal=e.readContentAsString();break;case"status":r.status=e.readContentAsString();break;case"trend":r.trend=e.readContentAsString();break;case"weight":r.weight=e.readContentAsString();break;case"time":r.time=e.readContentAsString()}t.KPIs.push(r)}}function M(e,t){for(var r,n={entries:[]};e.read();)switch(e.name()){case"entries":for(r=e.depth;e.read()&&e.depth>r;)n.entries.push(S(e))}t.pivotCacheTupleCache=n}function I(e,t){var r,n={};for(t.calculatedItems=[];e.moveToNextAttribute();)switch(e.name()){case"field":n.field=e.readContentAsInt();break;case"formula":n.formula=e.readContentAsString()}for(r=e.depth;e.read()&&!(e.depth<=r);)"pivotArea"===e.name()&&(n.pivotArea=Z(e));t.calculatedItems.push(n)}function E(e,t){for(var r={};e.moveToNextAttribute();)switch(e.name()){case"name":r.name=y(e.readContentAsString());break;case"mdx":r.mdx=e.readContentAsString();break;case"memberName":r.memberName=e.readContentAsString();break;case"hierarchy":r.hierarchy=e.readContentAsString();break;case"parent":r.parent=e.readContentAsString();break;case"solveOrder":r.solveOrder=e.readContentAsInt();break;case"set":r.set=e.readContentAsBoolean()}t.calculatedMembers.push(r)}function R(e,t){for(var r={};e.moveToNextAttribute();)switch(e.name()){case"name":case"measure":r.measure=e.readContentAsBoolean();break;case"name":r.name=y(e.readContentAsString());break;case"uniqueName":r.uniqueName=e.readContentAsString();break;case"caption":r.caption=e.readContentAsString()}t.dimensions.push(r)}function D(e,t){for(var r={};e.moveToNextAttribute();)switch(e.name()){case"name":r.name=y(e.readContentAsString());break;case"caption":r.caption=e.readContentAsString()}t.measureGroups.push(r)}function N(e,t){for(var r={};e.moveToNextAttribute();)switch(e.name()){case"measureGroup":r.name=e.readContentAsInt();break;case"dimension":r.caption=e.readContentAsInt()}t.measureDimensionMap.push(r)}function F(e,t){for(var r,n=e.depth;e.read()&&!(e.depth<=n);)if("ext"===e.name())for(r=e.depth;e.read()&&!(e.depth<=r);)if("x14:pivotCacheDefinition"===e.name())for(;e.moveToNextAttribute();)"pivotCacheId"===e.readAttributeNameAsString()&&(t.fm=e.readContentAsInt())}function _(e,t){var r,n=new u.XmlReader;for(n.setXml(e),r={fields:[],chartFormats:[],pivotFilters:[],formats:[],rowFields:[],rowItems:[],columnFields:[],columnItems:[],pageFields:[],dataFields:[],pivotHierarchies:[],hideValuesRow:!1};n.read();)0===n.depth&&2!==n.elementType&&"pivotTableDefinition"===n.name()&&(P(n,r),L(n,r,t));return r}function P(e,t){for(t.outline=!1,t.outlineData=!1;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"applyAlignmentFormats":t.applyAlignmentFormats=e.readContentAsBoolean();break;case"applyBorderFormats":t.applyBorderFormats=e.readContentAsBoolean();break;case"applyFontFormats":t.applyFontFormats=e.readContentAsBoolean();break;case"applyNumberFormats":t.applyNumberFormats=e.readContentAsBoolean();break;case"applyPatternFormats":t.applyPatternFormats=e.readContentAsBoolean();break;case"applyWidthHeightFormats":t.applyWidthHeightFormats=e.readContentAsBoolean();break;case"asteriskTotals":t.asteriskTotals=e.readContentAsBoolean();break;case"autoFormatId":t.autoFormatId=e.readContentAsInt();break;case"cacheId":t.cacheId=e.readContentAsInt();break;case"chartFormat":t.chartFormat=e.readContentAsInt();break;case"colGrandTotals":t.colGrandTotals=e.readContentAsBoolean();break;case"colHeaderCaption":t.colHeaderCaption=e.readContentAsString();break;case"compact":t.compact=e.readContentAsBoolean();break;case"compactData":t.compactData=e.readContentAsBoolean();break;case"createdVersion":t.createdVersion=e.readContentAsInt();break;case"customListSort":t.customListSort=e.readContentAsBoolean();break;case"dataCaption":t.dataCaption=e.readContentAsString();break;case"disableFieldList":t.disableFieldList=e.readContentAsBoolean();break;case"editData":t.editData=e.readContentAsBoolean();break;case"enableDrill":t.enableDrill=e.readContentAsBoolean();break;case"enableFieldProperties":t.enableFieldProperties=e.readContentAsBoolean();break;case"enableWizard":t.enableWizard=e.readContentAsBoolean();break;case"errorCaption":t.errorCaption=e.readContentAsString();break;case"fieldListSortAscending":t.fieldListSortAscending=e.readContentAsBoolean();break;case"fieldPrintTitles":t.fieldPrintTitles=e.readContentAsBoolean();break;case"grandTotalCaption":t.grandTotalCaption=e.readContentAsString();break;case"gridDropZones":t.gridDropZones=e.readContentAsBoolean();break;case"immersive":t.immersive=e.readContentAsBoolean();break;case"indent":t.indent=e.readContentAsInt();break;case"itemPrintTitles":t.itemPrintTitles=e.readContentAsBoolean();break;case"mdxSubqueries":t.mdxSubqueries=e.readContentAsBoolean();break;case"mergeItem":t.mergeItem=e.readContentAsBoolean();break;case"minRefreshableVersion":t.minRefreshableVersion=e.readContentAsInt();break;case"missingCaption":t.missingCaption=e.readContentAsString();break;case"multipleFieldFilters":t.multipleFieldFilters=e.readContentAsBoolean();break;case"name":t.name=y(e.readContentAsString());break;case"outline":t.outline=e.readContentAsBoolean();break;case"outlineData":t.outlineData=e.readContentAsBoolean();break;case"pageOverThenDown":t.pageOverThenDown=e.readContentAsBoolean();break;case"pageStyle":t.pageStyle=e.readContentAsString();break;case"pageWrap":t.pageWrap=e.readContentAsInt();break;case"pivotTableStyle":t.pivotTableStyle=e.readContentAsString();break;case"preserveFormatting":t.preserveFormatting=e.readContentAsBoolean();break;case"printDrill":t.printDrill=e.readContentAsBoolean();break;case"published":t.published=e.readContentAsBoolean();break;case"rowGrandTotals":t.rowGrandTotals=e.readContentAsBoolean();break;case"rowHeaderCaption":t.rowHeaderCaption=e.readContentAsString();break;case"showCalcMbrs":t.showCalcMbrs=e.readContentAsBoolean();break;case"showDataDropDown":t.showDataDropDown=e.readContentAsBoolean();break;case"showDataTips":t.showDataTips=e.readContentAsBoolean();break;case"showDrill":t.showDrill=e.readContentAsBoolean();break;case"showDropZones":t.showDropZones=e.readContentAsBoolean();break;case"showEmptyCol":t.showEmptyCol=e.readContentAsBoolean();break;case"showEmptyRow":t.showEmptyRow=e.readContentAsBoolean();break;case"showError":t.showError=e.readContentAsBoolean();break;case"showHeaders":t.showHeaders=e.readContentAsBoolean();break;case"showItems":t.showItems=e.readContentAsBoolean();break;case"showMemberPropertyTips":t.showMemberPropertyTips=e.readContentAsBoolean();break;case"showMissing":t.showMissing=e.readContentAsBoolean();break;case"showMultipleLabel":t.showMultipleLabel=e.readContentAsBoolean();break;case"subtotalHiddenItems":t.subtotalHiddenItems=e.readContentAsBoolean();break;case"tag":t.tag=e.readContentAsString();break;case"updatedVersion":t.updatedVersion=e.readContentAsInt();break;case"useAutoFormatting":t.useAutoFormatting=e.readContentAsBoolean();break;case"vacatedStyle":t.vacatedStyle=e.readContentAsString();break;case"visualTotals":t.visualTotals=e.readContentAsBoolean()}}function L(e,t,r){for(var n,o=e.depth;e.read()&&!(e.depth<=o);)switch(e.name()){case"pivotTableDefinition":P(e,t);break;case"location":z(e,t);break;case"pivotFields":for(n=e.depth;e.read()&&!(e.depth<=n);)t.fields.push(q(e));break;case"format":Y(e,t);break;case"conditionalFormat":W(e,t,void 0);break;case"chartFormat":V(e,t);break;case"filter":U(e,t,r);break;case"pivotTableStyleInfo":K(e,t);break;case"rowFields":t.rowFields=X(e);break;case"rowItems":t.rowItems=J(e);break;case"colFields":t.columnFields=X(e);break;case"colItems":t.columnItems=J(e);break;case"pageFields":G(e,t);break;case"dataFields":H(e,t);break;case"pivotHierarchies":j(e,t);break;case"rowHierarchiesUsage":t.rowHierarchyUsage=B(e);break;case"colHierarchiesUsage":t.columnHierarchyUsage=B(e);break;case"extLst":O(e,t)}}function O(e,t){for(var r,n=e.depth;e.read()&&!(e.depth<=n);)for(r=e.depth;e.read()&&!(e.depth<=r);){if("x14:pivotTableDefinition"===e.name())for(;e.moveToNextAttribute();)"hideValuesRow"===e.readAttributeNameAsString()&&(t.hideValuesRow=e.readContentAsBoolean());if("xpdl:pivotTableDefinition16"===e.name())for(;e.moveToNextAttribute();)"SubtotalsOnTopDefault"===e.readAttributeNameAsString()&&(t.subtotalsOnTopDefault=e.readContentAsBoolean())}}function B(e){for(var t=[],r=e.depth;e.read()&&!(e.depth<=r);)for(;e.moveToNextAttribute();)"hierarchyUsage"===e.readAttributeNameAsString()&&t.push(e.readContentAsInt());return t}function j(e,t){for(var r,n,o,i,a,s,l=e.depth;e.read()&&!(e.depth<=l);){for(r={memberProperties:[],members:[]};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"caption":r.caption=e.readContentAsString();break;case"dragOff":r.dragOff=e.readContentAsBoolean();break;case"dragToCol":r.dragToCol=e.readContentAsBoolean();break;case"dragToData":r.dragToData=e.readContentAsBoolean();break;case"dragToPage":r.dragToPage=e.readContentAsBoolean();break;case"dragToRow":r.dragToRow=e.readContentAsBoolean();break;case"includeNewItemsInFilter":r.includeNewItemsInFilter=e.readContentAsBoolean();break;case"multipleItemSelectionAllowed":r.multipleItemSelectionAllowed=e.readContentAsBoolean();break;case"outline":r.outline=e.readContentAsBoolean();break;case"showInFieldList":r.showInFieldList=e.readContentAsBoolean();break;case"subtotalTop":r.subtotalTop=e.readContentAsBoolean()}for(n=e.depth;e.read()&&!(e.depth<=n);)switch(e.name()){case"sh:mps":for(o=e.depth;e.read()&&(i={},!(e.depth<=o));){if("sh:mp"===e.name())for(;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"name":i.name=y(e.readContentAsString());break;case"showCell":i.showCell=e.readContentAsBoolean();break;case"showTip":i.showTip=e.readContentAsBoolean();break;case"showAsCaption":i.showAsCaption=e.readContentAsBoolean();break;case"nameLen":i.nameLen=e.readContentAsInt();break;case"pPos":i.pPos=e.readContentAsInt();break;case"pLen":i.pLen=e.readContentAsInt();break;case"level":i.level=e.readContentAsInt();break;case"field":i.field=e.readContentAsInt()}r.memberProperties.push(i)}break;case"members":for(a={members:[]};e.moveToNextAttribute();)"level"===e.readAttributeNameAsString()&&(a.level=e.readContentAsInt());for(s=e.depth;e.read()&&!(e.depth<=s);)for(;e.moveToNextAttribute();)"name"===e.readAttributeNameAsString()&&a.members.push(e.readContentAsString())}t.pivotHierarchies.push(r)}}function H(e,t){for(var r,n=e.depth;e.read()&&!(e.depth<=n);){for(r={isOnRead:!0};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"baseField":r.baseField=e.readContentAsInt();break;case"baseItem":r.baseItem=e.readContentAsInt();break;case"fld":r.fld=e.readContentAsInt();break;case"name":r.name=y(e.readContentAsString());break;case"numFmtId":r.numFmtId=e.readContentAsInt();break;case"showDataAs":r.showDataAs=e.readContentAsString();break;case"subtotal":r.subtotal=e.readContentAsString()}r.isOnRead=!1,t.dataFields.push(r)}}function G(e,t){for(var r,n=e.depth;e.read()&&!(e.depth<=n);){for(r={};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"cap":r.cap=e.readContentAsString();break;case"fld":r.fld=e.readContentAsInt();break;case"hier":r.hier=e.readContentAsInt();break;case"item":r.item=e.readContentAsInt();break;case"name":r.name=y(e.readContentAsString())}t.pageFields.push(r)}}function U(e,t,r){for(var n,o,i,a,s={};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"fld":s.fld=e.readContentAsInt();break;case"mpFld":s.mpFld=e.readContentAsInt();break;case"type":s.type=e.readContentAsString();break;case"evalOrder":s.evalOrder=e.readContentAsInt();break;case"id":s.id=e.readContentAsInt();break;case"iMeasureHier":s.iMeasureHier=e.readContentAsInt();break;case"iMeasureFld":s.iMeasureFld=e.readContentAsInt();break;case"name":s.name=y(e.readContentAsString());break;case"description":s.description=e.readContentAsString();break;case"stringValue1":s.stringValue1=e.readContentAsString();break;case"stringValue2":s.stringValue2=e.readContentAsString()}for(n=e.depth;e.read()&&!(e.depth<=n);)"autoFilter"===e.name()&&(o=f.parseXmlToObject(e.readFullElement()).autoFilter,i=d.readAutoFilter(o),a=void 0,o.sortState&&(i.sortInfo=d.readSortInfo(o.sortState)),h.isNullOrUndefined(s.type)||(a=-1<(l=s.type).indexOf("caption")&&!h.isNullOrUndefined(p[l])?{conType:0,compareType:p[l]}:-1<l.indexOf("value")&&!h.isNullOrUndefined(g[l])?{conType:2,compareType:g[l]}:h.isNullOrUndefined(m[l])?h.isNullOrUndefined(b[l])?void 0:{conType:3,compareType:b[l]}:{conType:1,compareType:m[l]}),s.conType=a&&a.conType,s.autoFilter=r.kg(i,a));var l;t.pivotFilters.push(s)}function W(e,t,r){for(var n,o={},i=function(){switch(e.readAttributeNameAsString()){case"scope":o.scope=e.readContentAsString();break;case"type":o.type=e.readContentAsString();break;case"priority":var t=e.readContentAsInt();r.forEach(function(e){e.priority===t&&(o.rule=e)})}};e.moveToNextAttribute();)i();for(n=e.depth;e.read()&&!(e.depth<=n);)"pivotArea"===e.name()&&o.pivotAreas.push(Z(e));t.pivotTableConditionFormat.push(o)}function V(e,t){for(var r,n={};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"chart":n.chart=e.readContentAsInt();break;case"format":n.format=e.readContentAsInt();break;case"series":n.series=e.readContentAsBoolean()}for(r=e.depth;e.read()&&!(e.depth<=r);)"pivotArea"===e.name()&&(n.pivotArea=Z(e));t.chartFormats.push(n)}function z(e,t){for(;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"ref":t.ref=e.readContentAsString();break;case"firstHeaderRow":t.firstHeaderRow=e.readContentAsInt();break;case"firstDataRow":t.firstDataRow=e.readContentAsInt();break;case"firstDataCol":t.firstDataCol=e.readContentAsInt();break;case"rowPageCount":t.rowPageCount=e.readContentAsInt();break;case"colPageCount":t.colPageCount=e.readContentAsInt()}}function q(e){for(var t,r,n,o,i={items:[],isOnRead:!0,showAll:!0,defaultSubtotal:!0};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"allDrilled":i.allDrilled=e.readContentAsBoolean();break;case"autoShow":i.autoShow=e.readContentAsBoolean();break;case"avgSubtotal":i.avgSubtotal=e.readContentAsBoolean();break;case"axis":i.axis=e.readContentAsString();break;case"compact":i.compact=e.readContentAsBoolean();break;case"countASubtotal":i.countASubtotal=e.readContentAsBoolean();break;case"countSubtotal":i.countSubtotal=e.readContentAsBoolean();break;case"dataField":i.dataField=e.readContentAsBoolean();break;case"dataSourceSort":i.dataSourceSort=e.readContentAsBoolean();break;case"defaultAttributeDrillState":i.defaultAttributeDrillState=e.readContentAsBoolean();break;case"defaultSubtotal":i.defaultSubtotal=e.readContentAsBoolean();break;case"dragOff":i.dragOff=e.readContentAsBoolean();break;case"dragToCol":i.dragToCol=e.readContentAsBoolean();break;case"dragToData":i.dragToData=e.readContentAsBoolean();break;case"dragToPage":i.dragToPage=e.readContentAsBoolean();break;case"dragToRow":i.dragToRow=e.readContentAsBoolean();break;case"hiddenLevel":i.hiddenLevel=e.readContentAsBoolean();break;case"hideNewItems":i.hideNewItems=e.readContentAsBoolean();break;case"includeNewItemsInFilter":i.includeNewItemsInFilter=e.readContentAsBoolean();break;case"insertBlankRow":i.insertBlankRow=e.readContentAsBoolean();break;case"insertPageBreak":i.insertPageBreak=e.readContentAsBoolean();break;case"itemPageCount":i.itemPageCount=e.readContentAsInt();break;case"maxSubtotal":i.maxSubtotal=e.readContentAsBoolean();break;case"measureFilter":i.measureFilter=e.readContentAsBoolean();break;case"minSubtotal":i.minSubtotal=e.readContentAsBoolean();break;case"multipleItemSelectionAllowed":i.multipleItemSelectionAllowed=e.readContentAsBoolean();break;case"name":i.name=y(e.readContentAsString());break;case"nonAutoSortDefault":i.nonAutoSortDefault=e.readContentAsBoolean();break;case"numFmtId":i.numFmtId=e.readContentAsInt();break;case"outline":i.outline=e.readContentAsBoolean();break;case"productSubtotal":i.productSubtotal=e.readContentAsBoolean();break;case"rankBy":i.rankBy=e.readContentAsInt();break;case"serverField":i.serverField=e.readContentAsBoolean();break;case"showAll":i.showAll=e.readContentAsBoolean();break;case"showDropDowns":i.showDropDowns=e.readContentAsBoolean();break;case"showPropAsCaption":i.showPropAsCaption=e.readContentAsBoolean();break;case"showPropCell":i.showPropCell=e.readContentAsBoolean();break;case"showPropTip":i.showPropTip=e.readContentAsBoolean();break;case"sortType":i.sortType=e.readContentAsString();break;case"stdDevPSubtotal":i.stdDevPSubtotal=e.readContentAsBoolean();break;case"stdDevSubtotal":i.stdDevSubtotal=e.readContentAsBoolean();break;case"subtotalCaption":i.subtotalCaption=e.readContentAsString();break;case"subtotalTop":i.subtotalTop=e.readContentAsBoolean();break;case"sumSubtotal":i.sumSubtotal=e.readContentAsBoolean();break;case"topAutoShow":i.topAutoShow=e.readContentAsBoolean();break;case"uniqueMemberProperty":i.uniqueMemberProperty=e.readContentAsString();break;case"varPSubtotal":i.varPSubtotal=e.readContentAsBoolean();break;case"varSubtotal":i.varSubtotal=e.readContentAsBoolean()}if(3===e.elementType)return i.isOnRead=!1,i;for(t=e.depth;e.read()&&!(e.depth<=t);)switch(e.name()){case"items":for(r=e.depth;e.read()&&!(e.depth<=r);){for(n={};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"c":n.childItems=e.readContentAsBoolean();break;case"d":n.expanded=e.readContentAsBoolean();break;case"e":n.drillAcross=e.readContentAsBoolean();break;case"f":n.calculatedMember=e.readContentAsBoolean();break;case"h":n.hidden=e.readContentAsBoolean();break;case"m":n.missing=e.readContentAsBoolean();break;case"n":n.caption=e.readContentAsString();break;case"s":n.character=e.readContentAsBoolean();break;case"sd":n.collapse=!e.readContentAsBoolean();break;case"t":n.type=e.readContentAsString();break;case"x":n.indexValue=e.readContentAsInt()}i.items.push(n)}0<i.items.length&&(i.isShared=!0);break;case"autoSortScope":for(o=e.depth;e.read()&&!(e.depth<=o);)"pivotArea"===e.name()&&(i.autoSortScope=Z(e))}return i.isOnRead=!1,i}function Z(e){for(var t,r,n,o={references:[],outline:!1};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"axis":o.axis=e.readContentAsString();break;case"cacheIndex":o.cacheIndex=e.readContentAsBoolean();break;case"collapsedLevelsAreSubtotals":o.collapsedLevelsAreSubtotals=e.readContentAsBoolean();break;case"dataOnly":o.dataOnly=e.readContentAsBoolean();break;case"field":o.field=e.readContentAsInt();break;case"fieldPosition":o.fieldPosition=e.readContentAsInt();break;case"grandCol":o.grandCol=e.readContentAsBoolean();break;case"grandRow":o.grandRow=e.readContentAsBoolean();break;case"labelOnly":o.labelOnly=e.readContentAsBoolean();break;case"offset":o.offset=e.readContentAsString();break;case"outline":o.outline=e.readContentAsBoolean();break;case"type":o.type=e.readContentAsString()}for(t=e.depth;e.read()&&!(e.depth<=t);)if("reference"===e.name()){for(r={indexes:[]};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"avgSubtotal":r.avgSubtotal=e.readContentAsBoolean();break;case"byPosition":r.byPosition=e.readContentAsBoolean();break;case"countASubtotal":r.countASubtotal=e.readContentAsBoolean();break;case"countSubtotal":r.countSubtotal=e.readContentAsBoolean();break;case"defaultSubtotal":r.defaultSubtotal=e.readContentAsBoolean();break;case"field":r.field=e.readContentAsDouble();break;case"maxSubtotal":r.maxSubtotal=e.readContentAsBoolean();break;case"minSubtotal":r.minSubtotal=e.readContentAsBoolean();break;case"productSubtotal":r.productSubtotal=e.readContentAsBoolean();break;case"relative":r.relative=e.readContentAsBoolean();break;case"selected":r.selected=e.readContentAsBoolean();break;case"stdDevPSubtotal":r.stdDevPSubtotal=e.readContentAsBoolean();break;case"stdDevSubtotal":r.stdDevSubtotal=e.readContentAsBoolean();break;case"sumSubtotal":r.sumSubtotal=e.readContentAsBoolean();break;case"varPSubtotal":r.varPSubtotal=e.readContentAsBoolean();break;case"varSubtotal":r.varSubtotal=e.readContentAsBoolean()}for(n=e.depth;e.read()&&!(e.depth<=n);)if("x"===e.name())for(;e.moveToNextAttribute();)"v"===e.readAttributeNameAsString()&&r.indexes.push(e.readContentAsInt());o.references.push(r)}return o}function Y(e,t){for(var r,n={};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"action":n.action=e.readContentAsString();break;case"dxfId":n.dxfId=e.readContentAsInt()}for(r=e.depth;e.read()&&!(e.depth<=r);)"pivotArea"===e.name()&&(n.pivotArea=Z(e));t.formats.push(n)}function K(e,t){for(;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"name":t.styleName=e.readContentAsString();break;case"showColHeaders":t.showColHeaders=e.readContentAsBoolean();break;case"showColStripes":t.showColStripes=e.readContentAsBoolean();break;case"showLastColumn":t.showLastColumn=e.readContentAsBoolean();break;case"showRowHeaders":t.showRowHeaders=e.readContentAsBoolean();break;case"showRowStripes":t.showRowStripes=e.readContentAsBoolean()}h.isNullOrUndefined(t.styleName)&&(t.styleName="PivotStyleLight0")}function X(e){for(var t=[],r=e.depth;e.read()&&!(e.depth<=r);)if("field"===e.name())for(;e.moveToNextAttribute();)"x"===e.readAttributeNameAsString()&&t.push(e.readContentAsInt());return t}function J(e){for(var t=[],r=e.depth;e.read()&&!(e.depth<=r);)t.push(Q(e));return t}function Q(e){for(var t,r={pivotItemIndexes:[]};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"t":r.type=e.readContentAsString();break;case"r":r.repeatCount=e.readContentAsInt();break;case"i":r.dataFieldIndex=e.readContentAsInt()}if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);)if("x"===e.name()){if(!e.moveToNextAttribute()){r.pivotItemIndexes.push(0);continue}if("v"===e.readAttributeNameAsString()){r.pivotItemIndexes.push(e.readContentAsInt());continue}for(;e.moveToNextAttribute();)if("v"===e.readAttributeNameAsString()){r.pivotItemIndexes.push(e.readContentAsInt());break}}return r}Object.defineProperty(t,"__esModule",{value:!0}),c=r("./src/common/excel-types.ts"),u=r("./src/xml-io/xml-reader.ts"),h=r("./src/common/common.ts"),n=r("./src/datamodel/datetime-helper.ts"),f=r("./src/xml-io/xml-parser.ts"),d=r("./src/xlsx-io/reader/autofilter-reader.ts"),p={captionEqual:0,captionNotEqual:1,captionBeginsWith:2,captionNotBeginsWith:3,captionEndsWith:4,captionNotEndsWith:5,captionContains:6,captionNotContains:7,captionGreaterThan:8,captionGreaterThanOrEqual:9,captionLessThan:10,captionLessThanOrEqual:11,captionBetween:12,captionNotBetween:13},g={valueEqual:0,valueNotEqual:1,valueGreaterThan:2,valueGreaterThanOrEqual:3,valueLessThan:4,valueLessThanOrEqual:5,valueBetween:6,valueNotBetween:7},m={dateEqual:0,dateNotEqual:1,dateOlderThan:2,dateOlderThanOrEqual:3,dateNewerThan:4,dateNewerThanOrEqual:5,dateBetween:6,dateNotBetween:7,tomorrow:10,today:8,yesterday:9,nextWeek:17,thisWeek:15,lastWeek:16,nextMonth:14,thisMonth:12,lastMonth:13,nextQuarter:18,thisQuarter:19,lastQuarter:20,nextYear:21,thisYear:22,lastYear:23,yearToDate:40,Q1:24,Q2:25,Q3:26,Q4:27,M1:28,M2:29,M3:30,M4:31,M5:32,M6:33,M7:34,M8:35,M9:36,M10:37,M11:38,M12:39},b={count:0,percent:1,sum:2},y=h.Util.ta,t.readPivotCacheDefinitions=function(e,t,r){var n=new u.XmlReader;for(n.setXml(e);n.read();)if(0===n.depth&&2!==n.elementType)switch(n.name()){case"pivotCacheDefinition":i(n,r),o(n,r)}},t.readPivotCacheRecords=function(e,t){var r,n,o,i,a,s,l=new u.XmlReader;for(l.setXml(e),r=[];l.read();)if(0===l.depth&&2!==l.elementType&&"pivotCacheRecords"===l.name())for(n=l.depth;l.read()&&!(l.depth<=n);)if("r"===l.name()){for(o=[],i=l.depth;l.read()&&!(l.depth<=i);){for(a=l.name(),s={};l.moveToNextAttribute();)switch(l.readAttributeNameAsString()){case"v":switch(a){case"b":s.type=c.PivotSharedItemType.B,s.value=l.readContentAsBoolean();break;case"d":s.type=c.PivotSharedItemType.D,s.value=h.Util.Aa(l.readContentAsString());break;case"e":s.type=c.PivotSharedItemType.E,s.value=l.readContentAsError();break;case"m":s.type=c.PivotSharedItemType.M,s.value=null;break;case"n":s.type=c.PivotSharedItemType.N,s.value=l.readContentAsDouble();break;case"s":s.type=c.PivotSharedItemType.S,s.value=h.Util.Aa(l.readContentAsString());break;case"x":s.type=c.PivotSharedItemType.X,s.value=l.readContentAsInt()}break;case"c":s.caption=l.readContentAsString();break;case"cp":s.propertyCount=l.readContentAsInt();break;case"f":s.isCalculatedItem=l.readContentAsBoolean();break;case"u":s.isUnusedItem=l.readContentAsBoolean();break;case"b":s.isBold=l.readContentAsBoolean();break;case"bc":s.backgroundColor=l.readContentAsInt();break;case"fc":s.foregroundColor=l.readContentAsInt();break;case"i":s.isItalic=l.readContentAsBoolean();break;case"in":s.formatIndex=l.readContentAsInt();break;case"st":s.isStrikethrough=l.readContentAsBoolean();break;case"un":s.isUnderline=l.readContentAsBoolean()}o.push(s)}r.push(o)}t.pivotCacheRecords=r},t.readPivotTableDefinition=function(e,t,r,n){var o,i,a,s,l=[],u=[];if(e)for(o in e)"count"!==o&&((i=e[o])&&(i.fileType===c.RelationshipConstants.$a&&l.push(i)));for(a=0;a<l.length;a++)if(s=n(l[a].fileName))try{u.push(_(s,r))}catch(e){}r._f(u,t)}},"./src/xlsx-io/reader/print-reader.ts":function(e,t,r){"use strict";var n,l,u,a,c,h,s,f,d,p,i,g,m,b;function y(e,t,r){var n,o;if(r)switch(n=e.gm,n.advancedHeadFooterSetting||(n.advancedHeadFooterSetting={}),o=n.advancedHeadFooterSetting,t){case b.CH:o.headerCenterImage=r;break;case b.RH:o.headerRightImage=r;break;case b.LF:o.footerLeftImage=r;break;case b.CF:o.footerCenterImage=r;break;case b.RF:o.footerRightImage=r;break;case b.LH:default:o.headerLeftImage=r}}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/common/common.ts"),l=r("./src/common/excel-types.ts"),u=r("./src/xml-io/xml-parser.ts"),a=r("./src/xml-io/node-helper.ts"),c=r("./src/datamodel/excel-helper.ts"),h=a.XmlNodeHelper.Xl,s=a.XmlNodeHelper.Zl,f=a.XmlNodeHelper.$l,d=a.XmlNodeHelper.qe,p=n.Util.ta,i=parseFloat,g={auto:0,downThenOver:1,overThenDown:2},m={auto:0,portrait:1,landscape:2},b={LH:0,CH:1,RH:2,LF:3,CF:4,RF:5},t.readPageMargins=function(e,t,r){var n,o=u.parseXmlToObject(e.readFullElement()).pageMargins;o&&(n=o.pe,r.qg(t,{left:i(n.left),right:i(n.right),top:i(n.top),bottom:i(n.bottom),header:i(n.header),footer:i(n.footer)}))},t.readPrintOptions=function(e,t,r){var n,o=u.parseXmlToObject(e.readFullElement()).printOptions;o&&(n=o.pe,r.rg(t,{printGridLine:h(n.gridLines,!1)&&h(n.gridLinesSet,!0),horizontalCentered:h(n.horizontalCentered,!1),verticalCentered:h(n.verticalCentered,!1),printRowColumnsHeaders:h(n.headings,!1)}))},t.readPageSetup=function(e,t){var r,n,o,i=u.parseXmlToObject(e.readFullElement()).pageSetup;i&&(r=i.pe,n=t.gm,(o=void 0)!==r.paperSize&&(o=parseInt(r.paperSize,10)),n.showColor=!h(r.blackAndWhite,!1),n.copies=s(r.copies,1),n.draft=h(r.draft,!1),n.useCustomStartingPage=h(r.useFirstPageNumber,!1),n.firstPageNumber=s(r.firstPageNumber,1),n.smartPrintPagesHeight=s(r.fitToHeight,1),n.smartPrintPagesWidth=s(r.fitToWidth,1),n.pageOrder=g[r.pageOrder]||0,n.paperSizeIndex="number"==typeof o?o:1,n.zoomFactor=a.XmlNodeHelper.Yl(r.scale,100)/100,n.orientation=m[r.orientation]||0)},t.readPageSetupAdditionalProperty=function(e,t){var r=u.parseXmlToObject(e.readFullElement()).pageSetUpPr;r&&(t.gm.useSmartPrint=h(r.pe.fitToPage,!1))},t.readHeaderFooter=function(e,t){var r,n,o,i,a,s=u.parseXmlToObject(e.readFullElement()).headerFooter;s&&(r=s.pe,(n=t.gm.advancedHeadFooterSetting={headerFooterAlignWithPageMargin:h(r.alignWithMargins,!0),headerFooterDifferentFirstPage:h(r.differentFirst,!1)}).headerFooterDifferentFirstPage&&(n.headerFirstPage=s.firstHeader,n.footerFirstPage=s.firstFooter),o=n.headerFooterDifferentOddEvenPages=h(r.differentOddEven,!1),i=p(f(s,"oddHeader")),a=p(f(s,"oddFooter")),n.headerEvenPage=o?p(f(s,"evenHeader")):i,n.footerEvenPage=o?p(f(s,"evenFooter")):a,n.headerOddPage=i,n.footerOddPage=a,n.headerFooterScalesWithDocument=h("scaleWithDoc",!0))},t.readRowColumnBreaks=function(e,t,r){var n=u.parseXmlToObject(e.readFullElement()),o=r?n.rowBreaks:n.colBreaks,i=[];d(o.brk).forEach(function(e){if(e){var t=s(e.pe.id,0);0<t&&i.push(t)}}),r?t.gm.rowBreakLines=i:t.gm.columnBreakLines=i},t.readLegacyDrawingHF=function(e,t){var r=u.parseXmlToObject(e.readFullElement()).legacyDrawingHF;r&&(t.hm=r.pe["r:id"])},t.readHeaderFooterImage=y,t.readVmlDrawing=function(e,i,a){var t,s,r,n;e&&i.hm&&((t=e[i.hm])&&t.fileType===l.RelationshipConstants.cb&&(s=function(e){var t,r,n,o={};for(t in e)e.hasOwnProperty(t)&&((n=(r=e[t]).fileType)!==l.RelationshipConstants.hb&&n!==l.RelationshipConstants.ib||(o[t]=r.fileName));return o}(t.relationFiles),r=a(t.fileName),n=u.parseXmlToObject(r).xml,d(n["v:shape"]).forEach(function(e){var t,r=e.pe.id,n=e["v:imagedata"].pe["o:relid"],o=s[n];!o||(t=c.getImageContent(o,a))&&y(i,b[r],t)})),i.hm="")}},"./src/xlsx-io/reader/sharedstring-reader.ts":function(e,t,r){"use strict";var u,c,h;Object.defineProperty(t,"__esModule",{value:!0}),u=r("./src/xml-io/xml-reader.ts"),c=r("./src/xlsx-io/reader/style-reader.ts"),h=r("./src/common/common.ts"),t.readSharedString=function(e){var t,r,n,o,i,a,s,l=new u.XmlReader;for(l.setXml(e),t=[];l.read();)if(1===l.depth&&2!==l.elementType&&"si"===l.name()){for(r=l.depth,n="",o=[];l.read()&&!(l.depth<=r);)if(1===l.nodeType())if("t"===(i=l.name())&&1===l.elementType&&l.depth===r+1)n=h.Util.Aa(l.readElementContentAsString());else if("r"===i){for(a=l.depth,s={};l.read()&&!(l.depth<=a);)1===l.elementType&&"t"===l.name()?(s.text=h.Util.ta(h.Util.Aa(l.readElementContentAsString(!0))),n+=s.text):1===l.elementType&&"rPr"===l.name()&&(s.style=c.readRichTextFont(l));o.push(s)}0===o.length&&(o=void 0),t.push({value:h.Util.ta(n),richText:o})}return t}},"./src/xlsx-io/reader/slicer-reader.ts":function(e,t,r){"use strict";var I,E,R,D,N,n,l,F,_,P,o;function i(e){if(e){var t={};return e.style&&(t.borderWidth=o[e.style]||1,t.borderStyle=function(e){switch(e){case 6:return"double";case 9:case 11:case 4:case 13:case 10:case 12:return"dotted";case 2:case 3:case 8:return"dashed";default:return"solid"}}(e.style)),e.color&&(t.borderColor=e.color),t}}function L(e){var t,r;if(e){for(t in e)e.hasOwnProperty(t)&&0<=t.indexOf("border")&&((r=e[t])?e[t]=i(r):null===r&&(e[t]=void 0));return e}}function O(e,a){var s=[];return e.forEach(function(e){var t,n,r,o,i=a(e.fileName);i&&(t=i,n=s,(o=R.parseXmlToObject(t).slicers)&&(r=N(o.slicer),D.isNullOrUndefined(r)||r.forEach(function(e){var t={},r=e.pe;D.isNullOrUndefined(r)||(D.isNullOrUndefined(r.name)||(t.name=D.Util.ta(D.Util.ya(r.name,"_x000a_","\n"))),D.isNullOrUndefined(r.cache)||(t.nameInFormula=r.cache),D.isNullOrUndefined(r.caption)||(t.captionName=r.caption),D.isNullOrUndefined(r.columnCount)||(t.columnCount=E.XmlNodeHelper.Zl(r.columnCount,1)),D.isNullOrUndefined(r.showCaption)||(t.showHeader="0"!==r.showCaption),t.style={name:r.style},D.isNullOrUndefined(r.lockedPosition)||(t.disableResizingAndMoving="1"===r.lockedPosition),D.isNullOrUndefined(r.rowHeight)||(t.itemHeight=l(parseInt(r.rowHeight,10)))),n.push(t)})))}),s}Object.defineProperty(t,"__esModule",{value:!0}),I=r("./src/common/excel-types.ts"),E=r("./src/xml-io/node-helper.ts"),R=r("./src/xml-io/xml-parser.ts"),D=r("./src/common/common.ts"),N=E.XmlNodeHelper.qe,n=r("./src/datamodel/excel-style.ts"),l=n.UnitHelper.emuToPixles,F=E.XmlNodeHelper.em,_=r("./src/datamodel/excel-helper.ts"),P={selectedItemWithData:"selectedItemWithDataStyle",selectedItemWithNoData:"selectedItemWithNoDataStyle",unselectedItemWithData:"unSelectedItemWithDataStyle",unselectedItemWithNoData:"unSelectedItemWithNoDataStyle",hoveredSelectedItemWithData:"hoveredSelectedItemWithDataStyle",hoveredSelectedItemWithNoData:"hoveredSelectedItemWithNoDataStyle",hoveredUnselectedItemWithData:"hoveredUnSelectedItemWithDataStyle",hoveredUnselectedItemWithNoData:"hoveredUnSelectedItemWithNoDataStyle",wholeTable:"wholeSlicerStyle",headerRow:"headerStyle"},o={9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3},t.readSlicers=function(e,t,r,n,o){var i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M;if(e){for(s in i=[],a=[],e)"count"!==s&&((l=e[s])&&((u=l.fileType)===I.RelationshipConstants.jb?i.push(l):u!==I.RelationshipConstants.eb&&u!==I.RelationshipConstants.fb||a.push(l)));c=function(e){var t=e.me(I.RelationshipConstants.Ra);if(t=t||e.me(I.RelationshipConstants.Sa),t)return t}(o),h=function(e){var t,r,n=e.relationFiles,o=[];for(t in n)"count"!==t&&(r=n[t])&&r.fileType===I.RelationshipConstants.kb&&o.push(r);return o}(o),i.length&&(f=O(i,n),d=r.we.sheets[t],k=f,M=n,h.forEach(function(e){var t=M(e.fileName,!0);t&&function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d=R.parseXmlToObject(t).slicerCacheDefinition;if(d){if(r=d.pe,n=r.name,o=[],e.forEach(function(e){e.nameInFormula===n&&o.push(e)}),!o.length)return;i=r.sourceName,h=c=u=!(l=s=a=null),(f=d.extLst)&&N(f["x:ext"]).forEach(function(e){var t,r=e.pe.uri,n=null;switch(r){case"{03082B11-2C62-411c-B77F-237D8FCFBE4C}":break;case"{2F2917AC-EB37-4324-AD4E-5DD8C200BD13}":N(e["x15:tableSlicerCache"]).forEach(function(e){var t=e.pe;a=E.XmlNodeHelper.Zl(t.tableId,0),s=E.XmlNodeHelper.Zl(t.column,0),l=t.sortOrder,n=t.crossFilter});break;case"{470722E0-AACD-4C17-9CDC-17EF765DBC7E}":(t=N(e["x15:slicerCacheHideItemsWithNoData"]))&&0<t.length&&(u=!1)}switch(n){case"none":c=!1;break;case"showItemsWithNoData":h=!1}}),o.forEach(function(e){e.sourceName=i,e.tableId=a,e.columnId=s,"descending"===l&&(e.sortState=2),e.showNoDataItems=u,e.visuallyNoDataItems=c,e.showNoDataItemsInLast=h})}}(k,t)}),x=f,T=n,A=d,a.forEach(function(e){var d,t,p,r,n=T(e.fileName,!0);n&&(d=x,t=n,p=A,r=R.parseXmlToObject(t,!0)["xdr:wsDr"],function(e){var o=["mc:AlternateContent","mc:Choice","xdr:graphicFrame","a:graphic","a:graphicData"],i=[];return e.forEach(function(r){var e,t,n=r;for(t=0;t<o.length;t++)e=!1,n&&n[o[t]]&&(e=!0,n=n[o[t]]);!e||"http://schemas.microsoft.com/office/drawing/2010/slicer"===n.pe.uri&&N(n["sle:slicer"]).forEach(function(e){var t=e.pe.name;r.slicerName=t,i.push(r)})}),i}(N(r["xdr:twoCellAnchor"])).forEach(function(e){var t,r,n,o,i,a,s,l,u,c=!0,h=!0,f=e.pe.editAs;"absolute"===f?h=c=!1:"oneCell"===f&&(h=!(c=!0)),t=!0,r=e.clientData,n=F(e["xdr:from"]),o=F(e["xdr:to"]),i=_.getBounds(p,n,o),!r||"0"===r.pe.fLocksWithSheet&&(t=!1),a=D.Util.ta(D.Util.ya(e.slicerName,"&#xA;","\n")),l=a,u=null,d.forEach(function(e){e.name===l&&(u=e)}),s=u,D.isNullOrUndefined(s)||(s.dynamicMove=c,s.dynamicSize=h,s.x=i.x,s.y=i.y,s.width=i.width,s.height=i.height,s.isLocked=t,s.endPoint=o)}))}),p=f,g=r,(S=n(c.fileName,!0))&&(m=R.parseXmlToObject(S),b=m.styleSheet,y={},C=g.im,D.isNullOrUndefined(C)||N(C["x14:slicerStyle"]).forEach(function(e){var t=e.pe.name,a={name:t};N(e["x14:slicerStyleElements"]).forEach(function(e){N(e["x14:slicerStyleElement"]).forEach(function(e){var t,r=e.pe,n=r.type,o=r.dxfId,i=P[n];!D.isNullOrUndefined(o)&&i&&(t=g.Vf(o),a[i]=L(t))})}),y[t]=a}),w=b.tableStyles,D.isNullOrUndefined(w)||N(w.tableStyle).forEach(function(e){var t=e.pe.name,a=y[t];a&&N(e.tableStyleElement).forEach(function(e){var t=e.pe,r=t.type,n=t.dxfId,o=g.Xf(n),i=P[r];!D.isNullOrUndefined(n)&&i&&(a[i]=L(o))})}),v=C.pe.defaultSlicerStyle,p.forEach(function(e){var t=e.style.name;t||(t=e.style.name=v),y[t]&&(e.style=y[t])})),r.ng(f,t))}},t.readSlicersFromFile=O},"./src/xlsx-io/reader/sparkline-reader.ts":function(e,t,r){"use strict";var c,a,h,f,d,n,p,g,m,b;function s(e,t){var r,n,o,i,a,s,l,u;if(!f.isNullOrUndefined(e))return(r={setting:{}}).sparklineType=0,n=e.pe,f.isNullOrUndefined(n)||(f.isNullOrUndefined(n.manualMax)||(r.setting.manualMax=c.XmlNodeHelper.Yl(n.manualMax,0)),f.isNullOrUndefined(n.manualMin)||(r.setting.manualMin=c.XmlNodeHelper.Yl(n.manualMin,0)),f.isNullOrUndefined(n.lineWeight)||(r.setting.lineWeight=4*c.XmlNodeHelper.Yl(n.lineWeight,1)/3),f.isNullOrUndefined(n.type)||(r.sparklineType=m[n.type]||0),f.isNullOrUndefined(n.dateAxis)||(r.displayDateAxis=c.XmlNodeHelper.Xl(n.dateAxis,!1)),f.isNullOrUndefined(n.displayEmptyCellsAs)||(r.setting.displayEmptyCellsAs=g[n.displayEmptyCellsAs]||0),f.isNullOrUndefined(n.markers)||(r.setting.showMarkers=c.XmlNodeHelper.Xl(n.markers,!1)),f.isNullOrUndefined(n.high)||(r.setting.showHigh=c.XmlNodeHelper.Xl(n.high,!1)),f.isNullOrUndefined(n.low)||(r.setting.showLow=c.XmlNodeHelper.Xl(n.low,!1)),f.isNullOrUndefined(n.first)||(r.setting.showFirst=c.XmlNodeHelper.Xl(n.first,!1)),f.isNullOrUndefined(n.last)||(r.setting.showLast=c.XmlNodeHelper.Xl(n.last,!1)),f.isNullOrUndefined(n.negative)||(r.setting.showNegative=c.XmlNodeHelper.Xl(n.negative,!1)),f.isNullOrUndefined(n.displayXAxis)||(r.setting.displayXAxis=c.XmlNodeHelper.Xl(n.displayXAxis,!1)),f.isNullOrUndefined(n.displayHidden)||(r.setting.displayHidden=c.XmlNodeHelper.Xl(n.displayHidden,!1)),f.isNullOrUndefined(n.rightToLeft)||(r.setting.rightToLeft=c.XmlNodeHelper.Xl(n.rightToLeft,!1)),f.isNullOrUndefined(n.minAxisType)||(r.setting.minAxisType=b[n.minAxisType]||0),f.isNullOrUndefined(n.maxAxisType)||(r.setting.maxAxisType=b[n.maxAxisType]||0)),f.isNullOrUndefined(e["x14:colorSeries"])||(r.setting.seriesColor=y(h.readColor(e["x14:colorSeries"]))||"rgba(36,64,98,255)"),f.isNullOrUndefined(e["x14:colorNegative"])||(r.setting.negativeColor=y(h.readColor(e["x14:colorNegative"]))||"Brown"),f.isNullOrUndefined(e["x14:colorAxis"])||(r.setting.axisColor=y(h.readColor(e["x14:colorAxis"]))||"Black"),f.isNullOrUndefined(e["x14:colorMarkers"])||(r.setting.markersColor=y(h.readColor(e["x14:colorMarkers"]))||"rgba(36,64,98,255)"),f.isNullOrUndefined(e["x14:colorFirst"])||(r.setting.firstMarkerColor=y(h.readColor(e["x14:colorFirst"]))||"rgba(149,179,215,255)"),f.isNullOrUndefined(e["x14:colorLast"])||(r.setting.lastMarkerColor=y(h.readColor(e["x14:colorLast"]))||"rgba(149,179,215,255)"),f.isNullOrUndefined(e["x14:colorHigh"])||(r.setting.highMarkerColor=y(h.readColor(e["x14:colorHigh"]))||"Blue"),f.isNullOrUndefined(e["x14:colorLow"])||(r.setting.lowMarkerColor=y(h.readColor(e["x14:colorLow"]))||"Blue"),f.isNullOrUndefined(e["xm:f"])||(o=e["xm:f"]["xm:f"].split("!"),r.axisReference=d.getRangesFromString(o[1])[0]||null,o[0]!==t&&(r.axisReference.sheetName=o[0])),f.isNullOrUndefined(e["x14:sparklines"])||(r.sparklines=(a=e["x14:sparklines"],s=t,l=[],u=a&&a["x14:sparkline"],p(u).forEach(function(e){var t,r,n,o,i;f.isNullOrUndefined(e["xm:f"])||(n=e["xm:f"]["xm:f"].split("!"),t=d.getRangesFromString(n[1])[0]||null),f.isNullOrUndefined(e["xm:sqref"])||(o=e["xm:sqref"],r=d.getRangesFromString(o["xm:sqref"])[0]||null),f.isNullOrUndefined(t)||f.isNullOrUndefined(r)||((i={}).row=r.row,i.col=r.col,i.orientation=1===t.rowCount?1:0,i.data=t,n&&n[0]!==s&&(i.data.sheetName=n[0]),l.push(i))}),l)),i=r.axisReference,r.displayDateAxis&&i&&(r.axisOrientation=1===i.rowCount?1:0),r}function y(e){return e.isThemeColor()?n.ColorHelper.getThemeColorName(e):n.ColorHelper.toRGBColor(e)}Object.defineProperty(t,"__esModule",{value:!0}),c=r("./src/xml-io/node-helper.ts"),a=r("./src/xml-io/xml-parser.ts"),h=r("./src/xlsx-io/common/color-reader.ts"),f=r("./src/common/common.ts"),d=r("./src/common/range-parser.ts"),n=r("./src/datamodel/excel-style.ts"),p=c.XmlNodeHelper.qe,t.readSparklineGroups=function(e,t,r){var n,o,i;if(3!==e.elementType){for(n=[],o=e.depth;e.read()&&!(e.depth<=o);)1===e.nodeType()&&"x14:sparklineGroup"===e.name()&&((i=s(a.parseXmlToObject(e.readFullElement(),!0)[e.name()],t)).sparklines&&0<i.sparklines.length&&n.push(i));r.gg(n,t)}},g={span:2,gap:0,zero:1},m={line:0,column:1,stacked:2},b={individual:0,group:1,custom:2}},"./src/xlsx-io/reader/style-reader.ts":function(e,t,r){"use strict";var f,m,c,d,l,b;function y(e,t){var r,n;if(3!==e.elementType)for(r=e.depth;e.read();){if(e.depth<=r)return;1===e.nodeType()&&"numFmt"===e.name()&&((n=o(e))&&0<n.numberFormatId&&(t[n.numberFormatId]=n))}}function o(e){for(var t,r=-1,n="",o="";e.moveToNextAttribute();)"numFmtId"===(t=e.readAttributeNameAsString())?r=e.readContentAsInt(-1):"formatCode"===t?n=e.readContentAsString():-1<t.indexOf("formatCode16")&&(-1<(o=e.readContentAsString()).indexOf("[$-ja-JP-x-gannen]")&&(n=o));return n=f.Util.ta(n),new d.ExcelNumerFormat(r,n)}function C(e,t){if(3!==e.elementType)for(var r=e.depth;e.read();){if(e.depth<=r)return;1===e.nodeType()&&"font"===e.name()&&t.push(n(e))}}function n(e){var t,r,n,o,i,a,s;if(3!==e.elementType){for(t=new d.ExcelFont,r=e.depth;e.read()&&!(e.depth<=r);)if(1===e.nodeType())switch(e.name()){case"b":for(t.isBold=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(t.isBold=e.readContentAsBoolean(-1));break;case"charset":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(t.charSetIndex=e.readContentAsInt(-1));break;case"family":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(t.fontFamily=e.readContentAsInt(0));break;case"name":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(t.fontName=e.readContentAsString());break;case"scheme":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(n=e.readContentAsString(),f.StringEx.C(n)||void 0===c.FontSchemeCategory[n.toLocaleLowerCase()]||(t.fontScheme=c.FontSchemeCategory[n.toLocaleLowerCase()]));break;case"u":for(o=1;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(i=e.readContentAsString(),f.StringEx.C(i)||void 0===d.UnderLineStyle[i]||(o=d.UnderLineStyle[i]));t.underLineStyle=o;break;case"i":for(t.isItalic=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(t.isItalic=e.readContentAsBoolean(-1));break;case"outline":for(t.isOutlineStyle=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(t.isOutlineStyle=e.readContentAsBoolean(-1));break;case"shadow":for(t.isShadowStyle=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(t.isShadowStyle=e.readContentAsBoolean(-1));break;case"strike":for(t.isStrikeOut=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(t.isStrikeOut=e.readContentAsBoolean(-1));break;case"sz":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(t.fontSize=e.readContentAsDouble(0));break;case"vertAlign":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&((a=e.readContentAsString())&&void 0!==d.VertAlign[a.toLocaleLowerCase()]&&(t.vertAlign=d.VertAlign[a.toLocaleLowerCase()]));break;case"color":(s=l.readColor(e))!==c.ExcelColor.EmptyColor&&(t.fontColor=s)}return t}}function w(e,t){if(3!==e.elementType)for(var r=e.depth;e.read();){if(e.depth<=r)return;1===e.nodeType()&&"fill"===e.name()&&(t.push(i(e)),0===t.length&&t.push({patternType:0,fgColor:c.ExcelColor.EmptyColor,bgColor:c.ExcelColor.EmptyColor}))}}function i(e){for(var t,r,n,o,i,a=new d.ExcelFill,s=e.depth;e.read()&&!(e.depth<=s);)if(1===e.nodeType()&&"patternFill"===e.name()){for(;e.moveToNextAttribute();)"patternType"===e.readAttributeNameAsString()&&((t=e.readContentAsString())&&void 0!==d.FillPatternType[t]&&(a.patternType=d.FillPatternType[t]));if(3===e.elementType)break;for(r=e.depth;e.read()&&!(e.depth<=r);)1===e.nodeType()&&("fgColor"===e.name()?a.fgColor=l.readColor(e):"bgColor"===e.name()&&(a.bgColor=l.readColor(e)))}else if(1===e.nodeType()&&"gradientFill"===e.name()){for(a.stops=[];e.moveToNextAttribute();)a[n=e.readAttributeNameAsString()]="type"===n?e.readContentAsString():"degree"===n?e.readContentAsInt():e.readContentAsDouble();if(3===e.elementType)break;for(r=e.depth;e.read()&&!(e.depth<=r);)if("stop"===e.name()){for(o={},e.moveToNextAttribute()&&"position"===e.readAttributeNameAsString()&&(o.position=e.readContentAsDouble()),i=e.depth;e.read()&&!(e.depth<=i);)o.color=l.readColor(e);a.stops.push(o)}}return a}function v(e,t){if(3!==e.elementType)for(var r=e.depth;e.read();){if(e.depth<=r)return;1===e.nodeType()&&"border"===e.name()&&t.push(a(e))}}function a(e){for(var t,r,n=e.depth,o=new d.ExcelBorder,i=!1,a=!1;e.moveToNextAttribute();)"diagonalUp"===(t=e.readAttributeNameAsString())?i=!0:"diagonalDown"===t&&(a=!0);if(3===e.elementType&&!i&&!a)return o;for(o.top=void 0,o.right=void 0,o.bottom=void 0,o.left=void 0;e.read()&&!(e.depth<=n);)if(1===e.nodeType())switch(e.name()){case"top":o.top=s(e);break;case"right":case"end":o.right=s(e);break;case"bottom":o.bottom=s(e);break;case"left":case"start":o.left=s(e);break;case"vertical":o.vertical=s(e);break;case"horizontal":o.horizontal=s(e);break;case"diagonal":r=s(e),i&&(o.diagonalUp=r),a&&(o.diagonalDown=r)}return o}function s(e){var t,r,n=new d.ExcelBorderSide;for(n.lineStyle=0;e.moveToNextAttribute();)"style"===e.readAttributeNameAsString()&&((t=e.readContentAsString())&&void 0!==d.ExcelBorderStyle[t]&&(n.lineStyle=d.ExcelBorderStyle[t]));if(3===e.elementType)return n;for(r=e.depth;e.read()&&!(e.depth<=r);)1===e.nodeType()&&"color"===e.name()&&(n.color=l.readColor(e));return n}function S(e,t,r,n,o,i,a){var s,l,u;if(3!==e.elementType)for(s=e.depth;e.read();){if(e.depth<=s)return;if(1===e.nodeType()&&"xf"===e.name()){if((l=new d.ExtendedFormat).isStyleFormat=a,h(e,l,r,n,o,i),t.push(l),3===e.elementType)continue;for(u=e.depth;e.read()&&!(e.depth<=u);)1===e.nodeType()&&("alignment"===e.name()?p(e,l):"protection"===e.name()&&g(e,l))}}}function h(e,t,r,n,o,i){for(var a,s,l,u,c,h,f,d,p,g=0,m=0,b=0,y=0;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"numFmtId":g=e.readContentAsInt(0);break;case"fontId":m=e.readContentAsInt(0);break;case"fillId":b=e.readContentAsInt(0);break;case"borderId":y=e.readContentAsInt(0);break;case"applyAlignment":0!==(a=e.readContentAsInt(-1))&&1!==a||(t.applyAlignment=1===a);break;case"applyBorder":0!==(s=e.readContentAsInt(-1))&&1!==s||(t.applyBorder=1===s);break;case"applyFill":0!==(l=e.readContentAsInt(-1))&&1!==l||(t.applyFill=1===l);break;case"applyFont":0!==(u=e.readContentAsInt(-1))&&1!==u||(t.applyFont=1===u);break;case"applyProtection":0!==(c=e.readContentAsInt(-1))&&1!==c||(t.applyProtection=1===c);break;case"applyNumberFormat":0!==(h=e.readContentAsInt(-1))&&1!==h||(t.applyNumberFormat=1===h);break;case"xfId":0<=(f=e.readContentAsInt(-1))&&(t.parentFormatID=f);break;case"quotePrefix":d=e.readContentAsBoolean(),t.quotePrefix=d}t.font=r[m],t.border=n[y],o[g]?t.numberFormat=o[g]:t.numberFormatIndex=g,(p=i[b])&&(t.fill=p),t.isLocked=!0,t.isHidden=!1,t.horizontalAlign=0,t.verticalAlign=2}function p(e,t){for(var r,n,o,i=null,a=null,s=!1,l=!1,u=!1;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"horizontal":i=e.readContentAsString();break;case"vertical":a=e.readContentAsString();break;case"textRotation":r=e.readContentAsString(),f.StringEx.C(r)||(t.rotation=parseInt(r,10));break;case"readingOrder":n=e.readContentAsString(),f.StringEx.C(n)||(t.readingOrder=parseInt(n,10));break;case"indent":o=e.readContentAsString(),f.StringEx.C(o)||(t.indent=parseInt(o,10));break;case"justifyLastLine":s=e.readContentAsBoolean(!1);break;case"shrinkToFit":l=e.readContentAsBoolean(!1);break;case"wrapText":u=e.readContentAsBoolean(!1)}t.isJustfyLastLine=s,t.isShrinkToFit=l,t.isWordWrap=u,f.StringEx.C(i)&&(i="general"),f.StringEx.C(a)&&(a="bottom"),t.verticalAlign=c.ExcelVerticalAlignment[a],t.horizontalAlign=d.ExcelHorizontalAlignment[i]}function g(e,t){for(var r,n;e.moveToNextAttribute();)"hidden"===(r=e.readAttributeNameAsString())?t.isHidden=e.readContentAsBoolean(!1):"locked"===r&&(n=e.readContentAsString(),f.StringEx.q(n)||"0"!==n&&"false"!==n||(t.isLocked=!1))}function x(e,t,r){var n,o,i,a,s,l,u,c,h;if(3!==e.elementType)for(n=e.depth;e.read();){if(e.depth<=n)return;if(1===e.nodeType()&&"cellStyle"===e.name()){for(o=void 0,s=!(a=-1),l=i=0;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"name":o=f.Util.ta(e.readContentAsString());break;case"xfId":i=e.readContentAsInt(0);break;case"builtinId":a=e.readContentAsInt(-1);break;case"customBuiltin":s=e.readContentAsBoolean(!1);break;case"iLevel":l=e.readContentAsInt(0)}u=r[i],-1!==a?((c=new d.ExcelStyle).name=o,c.format(u.clone()),c.isCustomBuiltin=s,c.builtInStyle=a,2!==c.builtInStyle&&1!==c.builtInStyle||(c.outLineLevel=l),t.cf(c,i)):((h=new d.CustomExcelStyle).name=o,h.format(u.clone()),t.cf(h,i))}}}function T(e,t){var r,n,o,i;if(3!==e.elementType)for(r=e.depth,n=[];e.read();){if(e.depth<=r)return;if(1===e.nodeType()&&"indexedColors"===e.name())for(o=e.depth;e.read();){if(e.depth<=o)return void t.Qf(n);if(1===e.nodeType()){for(i=0;e.moveToNextAttribute();)"rgb"===e.readAttributeNameAsString()&&(i=parseInt(e.readContentAsString(),16));n.push(4278190080+(16777215&i))}}}}function A(e,t){var r,n,o=null,i=null;if(3!==e.elementType){for(r=e.depth;e.read()&&!(e.depth<=r);)if(1===e.nodeType()&&"ext"===e.name())for(;e.moveToNextAttribute();)if("uri"===e.readAttributeNameAsString())switch(e.readContentAsString()){case"{46F421CA-312F-682f-3DD2-61675219B42D}":o=u(e);break;case"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}":n=b.parseXmlToObject(e.readFullElement(),!0).ext,f.isNullOrUndefined(n)||(i=n["x14:slicerStyles"])}t.Wf=o,t.im=i}}function u(e){var t,r=[];if(3!==e.elementType){for(t=e.depth;e.read()&&!(e.depth<=t);)1===e.nodeType()&&"x14:dxfs"===e.name()&&(r=k(e));return r}}function k(e){var t,r;if(3!==e.elementType){for(t=e.depth,r=[];e.read()&&!(e.depth<=t);)1===e.nodeType()&&"dxf"===e.name()&&r.push(M(e));return r}}function M(e){var t,r={};if(3===e.elementType)return r;for(t=e.depth;e.read()&&!(e.depth<=t);)if(1===e.nodeType())switch(e.name()){case"font":r.font=n(e);break;case"border":r.border=a(e);break;case"fill":r.fill=i(e);break;case"numFmt":r.numberFormat=o(e)}return r}Object.defineProperty(t,"__esModule",{value:!0}),f=r("./src/common/common.ts"),m=r("./src/xml-io/xml-reader.ts"),c=r("./src/datamodel/excel-style.ts"),d=r("./src/datamodel/excel-style.ts"),l=r("./src/xlsx-io/common/color-reader.ts"),b=r("./src/xml-io/xml-parser.ts"),t.readStyle=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g=new m.XmlReader;for(g.setXml(e),r=[],n=[],o={},i=[],a=[],s=[];g.read();)if(1===g.depth&&2!==g.elementType)switch(g.name()){case"numFmts":y(g,o);break;case"fonts":C(g,n);break;case"fills":w(g,i);break;case"borders":v(g,a);break;case"cellStyleXfs":S(g,r,n,a,o,i,!0);break;case"cellXfs":S(g,s,n,a,o,i,!1);break;case"cellStyles":x(g,t,r);break;case"colors":T(g,t);break;case"dxfs":d=t,p=k(g),d.Re=p;break;case"tableStyles":f=t,3!==(h=g).elementType&&(f.tableStylesObj=b.parseXmlToObject(h.readFullElement()).tableStyles);break;case"extLst":A(g,t)}if(0<(l=r.length)){for(t.$e(r[0]),u=0,c=l;u<c;u++)t._e(r[u],u);for(u=0,c=s.length;u<c;u++)t._e(s[u],u)}else t.te={foreColor:"Text 1 0",themeFont:"Body",font:"normal normal 14.7px Calibri",locked:!0,textIndent:0,wordWrap:!1,vAlign:2,hAlign:3};return l},t.readNumberFormats=y,t.readFonts=C,t.readRichTextFont=function(e){for(var t,r,n,o,i,a=new d.ExcelFont,s=e.depth;e.read()&&!(e.depth<=s);)if(1===e.nodeType())switch(e.name()){case"b":for(a.isBold=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.isBold=e.readContentAsBoolean(-1));break;case"charset":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.charSetIndex=e.readContentAsInt(-1));break;case"color":(t=l.readColor(e))!==c.ExcelColor.EmptyColor&&(a.fontColor=t);break;case"condense":for(a.isCondense=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.isCondense=e.readContentAsBoolean(-1));break;case"extend":for(a.isExtend=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.isExtend=e.readContentAsBoolean(-1));break;case"family":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.fontFamily=e.readContentAsInt(0));break;case"i":for(a.isItalic=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.isItalic=e.readContentAsBoolean(-1));break;case"outline":for(a.isOutlineStyle=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.isOutlineStyle=e.readContentAsBoolean(-1));break;case"rFont":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.fontName=e.readContentAsString());break;case"scheme":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(r=e.readContentAsString(),f.StringEx.C(r)||void 0===c.FontSchemeCategory[r.toLocaleLowerCase()]||(a.fontScheme=c.FontSchemeCategory[r.toLocaleLowerCase()]));break;case"shadow":for(a.isShadowStyle=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.isShadowStyle=e.readContentAsBoolean(-1));break;case"strike":for(a.isStrikeOut=!0;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.isStrikeOut=e.readContentAsBoolean(-1));break;case"sz":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(a.fontSize=e.readContentAsDouble(0));break;case"u":for(n=1;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&(o=e.readContentAsString(),f.StringEx.C(o)||void 0===d.UnderLineStyle[o]||(n=d.UnderLineStyle[o]));a.underLineStyle=n;break;case"vertAlign":for(;e.moveToNextAttribute();)"val"===e.readAttributeNameAsString()&&((i=e.readContentAsString())&&void 0!==d.VertAlign[i.toLocaleLowerCase()]&&(a.vertAlign=d.VertAlign[i.toLocaleLowerCase()]))}return a},t.readFills=w,t.readBorders=v,t.readXFs=S,t.readDifferentialFormattingRecords=k,t.readDifferentialFormattingRecord=M},"./src/xlsx-io/reader/table-reader.ts":function(e,t,r){"use strict";var u,w,v,S,x,T,A,k,c,M,I;function h(e,t,r,n){var o=t(e.fileName);if(o)return function(e,t,r){var n,o,i,a,s,l,u,c,h,f,d=v.parseXmlToObject(e),p={},g=d&&d.table&&d.table.pe;if(!w.isNullOrUndefined(g)){if(p.id=S.XmlNodeHelper.Zl(g.id,0),p.name=g.name,n=g.ref,w.isNullOrUndefined(n)||(o=x.getRangesFromString(n,!0)[0],p.row=o.row,p.col=o.col,p.rowCount=o.rowCount,p.colCount=o.colCount),i=S.XmlNodeHelper.Zl(g.headerRowCount,1),p.showHeader=1<=i,p.showFooter=S.XmlNodeHelper.Xl(g.totalsRowShown,!0),a=S.XmlNodeHelper.Zl(g.totalsRowCount,-1),p.showFooter=!(a<1),s=d&&d.table,u=l=void 0,!w.isNullOrUndefined(s))for(c in s)if(s.hasOwnProperty(c)&&!w.isNullOrUndefined(s[c]))switch(c){case"autoFilter":l=T.readAutoFilter(s[c]);break;case"sortState":u=A.readSortInfo(s[c]);break;case"tableColumns":p.columns=E(s[c]);break;case"tableStyleInfo":m=s[c],b=p,y=t,0,C=m.pe,w.isNullOrUndefined(C)||(w.isNullOrUndefined(C.name)||function(e,t,r,n){var o,i,a,s,l,u,c;if(I[n.toUpperCase()])t.buildInName=function(e){return e.substr(10)}(n);else if(o=r.tableStylesObj,!w.isNullOrUndefined(o)&&(i=o.pe,!w.isNullOrUndefined(i))){if(a=S.XmlNodeHelper.Zl(i.count,0),s=void 0,0<a&&(l=k(o.tableStyle),!w.isNullOrUndefined(l)))for(u=0;u<l.length;u++)if(c=l[u].pe.name,n===c){s=l[u];break}!function(e,t,r,n){var o=r.pe;t.name=o.name,o.count&&0<o.count&&function(e,a,t,s){var r=k(t.tableStyleElement);w.isNullOrUndefined(r)||r.forEach(function(e){var t,r,n,o,i=e.pe;w.isNullOrUndefined(i)||(t=i.type||"wholeTable",r=S.XmlNodeHelper.Zl(i.dxfId)||0,n=S.XmlNodeHelper.Zl(i.size)||1,o=s.Xf(r),a[M[t]]=o,"firstRowStripe"!==t&&"secondRowStripe"!==t&&"firstColumnStripe"!==t&&"secondColumnStripe"!==t||(a[t.substr(0,t.length-1)+"Size"]=n))}),e.style=a}(e,t,r,n)}(e,t,s,r)}e.style=t}(b,{},y,C.name),w.isNullOrUndefined(C.showFirstColumn)||(b.highlightFirstColumn=S.XmlNodeHelper.Xl(C.showFirstColumn,!1)),w.isNullOrUndefined(C.showLastColumn)||(b.highlightLastColumn=S.XmlNodeHelper.Xl(C.showLastColumn,!1)),w.isNullOrUndefined(C.showRowStripes)||(b.bandRows=S.XmlNodeHelper.Xl(C.showRowStripes,!1)),w.isNullOrUndefined(C.showColumnStripes)||(b.bandColumns=S.XmlNodeHelper.Xl(C.showColumnStripes,!1)));break;case"extLst":p.reservedElement=s[c]}for(h=l||{},p.rowFilter=t.jg(h,r)||{},p.rowFilter.sortInfo=u,p.rowFilter.showFilterButton=!0,p.rowFilter.filterButtonVisibleInfo={},f=0;f<p.colCount;f++)p.rowFilter.filterButtonVisibleInfo[f]=!0;if(!p.rowFilter.range){if(!p.rowFilter.sortInfo)for(p.rowFilter.showFilterButton=!1,p.rowFilter.filterButtonVisibleInfo={},f=0;f<p.colCount;f++)p.rowFilter.filterButtonVisibleInfo[f]=!1;p.rowFilter.range={row:p.row+1,col:p.col,rowCount:p.rowCount-1,colCount:p.colCount},p.showFooter&&p.rowFilter.range.rowCount--}if(p.rowFilter.filteredColumns&&0<p.rowFilter.filteredColumns.length&&(h.filterColumns[0].hiddenButton||!1===p.rowFilter.showFilterButton))for(p.rowFilter.showFilterButton=!1,p.rowFilter.filterButtonVisibleInfo={},f=0;f<p.colCount;f++)p.rowFilter.filterButtonVisibleInfo[f]=!1;!1===p.showHeader&&(p.rowFilter.showFilterButton=!1)}var m,b,y,C;return p}(o,r,n)}function E(e){var l=[],t=k(e.tableColumn);return w.isNullOrUndefined(t)||t.forEach(function(e){var t,r,n,o,i,a,s={};s.footerFormula=null,s.footerValue=null,t=e.pe,w.isNullOrUndefined(t)||(w.isNullOrUndefined(t.id)||(s.id=S.XmlNodeHelper.Zl(t.id,0)),w.isNullOrUndefined(t.name)||(r=w.Util.ya(t.name,"_x000d__x000a_","\n"),s.name=w.Util.ta(w.Util.ya(r,"_x000a_","\n"))),w.isNullOrUndefined(t.totalsRowLabel)||(s.footerValue=w.Util.ta(t.totalsRowLabel)),w.isNullOrUndefined(t.totalsRowFunction)||("custom"===t.totalsRowFunction?s.footerFormula=(o=e,i="totalsRowFormula",w.Util.ta(c(o,i,a))):s.footerFormula=t.totalsRowFunction)),n=e.calculatedColumnFormula,w.isNullOrUndefined(n)||(s.dataAreaFormula=w.Util.ta(w.processFunction(n.calculatedColumnFormula))),l.push(s)}),l}Object.defineProperty(t,"__esModule",{value:!0}),u=r("./src/common/excel-types.ts"),w=r("./src/common/common.ts"),v=r("./src/xml-io/xml-parser.ts"),S=r("./src/xml-io/node-helper.ts"),x=r("./src/common/range-parser.ts"),T=r("./src/xlsx-io/reader/autofilter-reader.ts"),A=r("./src/xlsx-io/reader/autofilter-reader.ts"),k=S.XmlNodeHelper.qe,c=S.XmlNodeHelper.$l,M={wholeTable:"wholeTableStyle",headerRow:"headerRowStyle",totalRow:"footerRowStyle",firstColumn:"highlightFirstColumnStyle",lastColumn:"highlightLastColumnStyle",firstRowStripe:"firstRowStripStyle",secondRowStripe:"secondRowStripStyle",firstColumnStripe:"firstColumnStripStyle",secondColumnStripe:"secondColumnStripStyle",firstHeaderCell:"firstHeaderCellStyle",lastHeaderCell:"lastHeaderCellStyle",firstTotalCell:"firstFooterCellStyle",lastTotalCell:"lastFooterCellStyle"},I=function(){var e,t={};for(e=1;e<=28;e++)e<=21&&(t["TABLESTYLELIGHT"+e]=!0),e<=11&&(t["TABLESTYLEDARK"+e]=!0),t["TABLESTYLEMEDIUM"+e]=!0;return t}(),t.readTables=function(e,t,r,n){var o,i,a,s,l;if(e){for(a in o=void 0,i=[],e)"count"!==a&&((s=e[a])&&(s.fileType===u.RelationshipConstants.ab&&(o=s),o&&(l=h(o,n,r,t),w.isNullOrUndefined(l)||i.push(l))));r.hg(i,t)}},t.readTablesFromFile=h},"./src/xlsx-io/reader/theme-reader.ts":function(e,t,r){"use strict";var f,d,g,p,m,n,b;function y(e){var t,r,n,o,i=[],a=[];if(e)if(e["a:latin"])i.push(new g.RunFormatting(0,f.isNullOrUndefined(e["a:latin"].pe.typeface)?"":e["a:latin"].pe.typeface));else if(e["a:ea"])i.push(new g.RunFormatting(2,f.isNullOrUndefined(e["a:ea"].pe.typeface)?"":e["a:ea"].pe.typeface));else if(e["a:cs"])i.push(new g.RunFormatting(1,f.isNullOrUndefined(e["a:cs"].pe.typeface)?"":e["a:cs"].pe.typeface));else if(e["a:sym"])i.push(new g.RunFormatting(3,f.isNullOrUndefined(e["a:sym"].pe.typeface)?"":e["a:sym"].pe.typeface));else if(e["a:font"])for(t=e["a:font"],Array.isArray(t)||(t=[t]),r=0,n=t.length;r<n;r++)o=t[r],a.push(new g.ThemeFont(o.pe.script,o.pe.typeface));return new g.ThemeFonts(i,a)}function C(e){var t,r,n,o,i,a,s,l,u,c,h;if(e&&(e["a:sysClr"]?(r=e["a:sysClr"].pe.val,void 0!==(n=p.ExcelSystemColor.getSystemColor(r))?t=n:(r=e["a:sysClr"].pe.lastClr,f.StringEx.q(r)||(o=4278190080+(16777215&parseInt(r,16)),t=p.ColorHelper.fromArgb(o)))):e["a:srgbClr"]?(r=e["a:srgbClr"].pe.val,f.StringEx.q(r)||(o=4278190080+(16777215&parseInt(r,16)),t=p.ColorHelper.fromArgb(o))):e["a:scrgbClr"]?(i=parseFloat(e["a:scrgbClr"].jm),a=parseFloat(e["a:scrgbClr"].pe.g),s=parseFloat(e["a:scrgbClr"].pe.b),t=new p.nj(255,p.ColorHelper.scRgbTosRgb(i),p.ColorHelper.scRgbTosRgb(a),p.ColorHelper.scRgbTosRgb(s))):e["a:hslClr"]?(l=parseFloat(e["a:hslClr"].km),u=parseFloat(e["a:hslClr"].pe.sat),c=parseFloat(e["a:hslClr"].pe.lum),t=p.ColorHelper.convertHLSToRGB(l,c,u)):e["a:prstClr"]?(h=e["a:prstClr"].pe.val,f.StringEx.C(h)||(t=p.ColorHelper.fromPresetColorVal(h))):e["a:schemeClr"],void 0!==t))return{a:t.a,r:t.r,g:t.g,b:t.b}}Object.defineProperty(t,"__esModule",{value:!0}),f=r("./src/common/common.ts"),d=r("./src/xml-io/xml-parser.ts"),g=r("./src/common/excel-types.ts"),p=r("./src/datamodel/excel-style.ts"),m=r("./src/xml-io/xml-reader.ts"),n=r("./src/xlsx-io/reader/chart-reader.ts"),b=n.DrawingReader.ReadCT_OfficeStyleSheet,t.readTheme=function(e,t){var r,n,o,i,a,s,l,u,c,h,f=d.parseXmlToObject(e,!0)["a:theme"];f&&((r=f.pe.name)&&"OFFICE"===r.toUpperCase().substring(0,6)&&(r="Office"),(n=f["a:themeElements"])&&(o=function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d=[],p=e["a:clrScheme"];if(p)return(t=C(p["a:lt1"]))&&d.push(t),(r=C(p["a:dk1"]))&&d.push(r),(n=C(p["a:lt2"]))&&d.push(n),(o=C(p["a:dk2"]))&&d.push(o),(i=C(p["a:accent1"]))&&d.push(i),(a=C(p["a:accent2"]))&&d.push(a),(s=C(p["a:accent3"]))&&d.push(s),(l=C(p["a:accent4"]))&&d.push(l),(u=C(p["a:accent5"]))&&d.push(u),(c=C(p["a:accent6"]))&&d.push(c),(h=C(p["a:hlink"]))&&d.push(h),(f=C(p["a:folHlink"]))&&d.push(f),new g.ColorScheme(p.pe.name,d)}(n),i=(h=n["a:fontScheme"])?(u=y(h["a:majorFont"]),c=y(h["a:minorFont"]),new g.FontScheme(h.pe.name,u,c)):null,a=new g.ExcelTheme(r,o,i),t.Ye(a)),(s=new m.XmlReader).setXml(e),l=b(s),t.Ue(l))},t.readThemeFonts=y,t.readThemeColor=C},"./src/xlsx-io/reader/workbook-reader.ts":function(e,t,r){"use strict";var u,l,c,h;function f(e,t){l.XmlNodeHelper.Xl(e.pe.dateCompatibility,!0)&&t.ef(l.XmlNodeHelper.Xl(e.pe.date1904,!1))}function d(e){var t={};return t.cacheId=e.pe.cacheId,t.rid=e.pe["r:id"],t}function p(e,t){var r=l.XmlNodeHelper.Xl(e.pe.showHorizontalScroll,!0),n=l.XmlNodeHelper.Xl(e.pe.showVerticalScroll,!0),o=l.XmlNodeHelper.Xl(e.pe.showSheetTabs,!0),i=l.XmlNodeHelper.Zl(e.pe.firstSheet,0),a=l.XmlNodeHelper.Zl(e.pe.activeTab,0),s=l.XmlNodeHelper.Zl(e.pe.tabRatio,600);t.ff(r,n),t.gf(o,a,i,s)}function g(e){var t,r,n,o;for(t=0,r=Object.keys(e);t<r.length;t++)if((o=(n=r[t]).split(":"))&&2===o.length&&"id"===o[1])return e[n];return null}function m(e,t){var r,n=e.pe.refMode,o=!1;n&&"R1C1"===n&&(o=!0),r={iterate:e.pe.iterate,count:e.pe.iterateCount,delta:e.pe.iterateDelta},t.if(o,r)}Object.defineProperty(t,"__esModule",{value:!0}),u=r("./src/xml-io/xml-parser.ts"),l=r("./src/xml-io/node-helper.ts"),c=r("./src/common/excel-types.ts"),h=r("./src/common/common.ts"),t.readWorkbook=function(e,t){var r,n,o,i,a,s=[],l=u.parseXmlToObject(e).workbook;if(l){if(l.workbookPr&&f(l.workbookPr,t),l.bookViews)for(void 0===(n=(r=l.bookViews.workbookView).length)&&(r=[r],n=1),o=0;o<n;o++)p(r[o],t);if(l.pivotCaches)for(t.we.pivotCaches={},Array.isArray(l.pivotCaches.pivotCache)||(l.pivotCaches.pivotCache=[l.pivotCaches.pivotCache]),o=0;o<l.pivotCaches.pivotCache.length;o++)i=d(l.pivotCaches.pivotCache[o]),t.we.pivotCaches[i.cacheId]=i;l.sheets&&l.sheets.sheet&&(a=l.sheets.sheet,Array.isArray(a)||(a=[a]),s=function(e,t){var r,n,o,i,a,s,l=[];for(r=0;r<e.length;r++)n=e[r],o=new c.SheetInfo,i=h.Util.Aa(h.Util.ta(n.pe.name)),o.name=i,o.index=r,o.sheetId=n.pe.sheetId,o.rID=n.pe["r:id"]||g(n.pe),h.StringEx.C(o.rID)||l.push(o),a=n.pe.state,s=0,a&&("hidden"===a?s=1:"veryHidden"===a&&(s=2)),t.hf(i,r,s);return l}(a,t)),l.definedNames&&function(e,t){var r,n,o,i,a,s,l;if(0<e.length)for(t.Tf(),r=void 0,n=0;n<e.length;n++)(r=e[n])&&(o=r.pe.localSheetId,i=h.Util.ta(r.pe.name),a=h.Util.ta(r.pe.comment),s=h.Util.ta(r.definedName),l=-1,h.isNullOrUndefined(o)||(l=parseInt(o,10)),"_xlnm.Print_Area"===i?t.vg(l,s):"_xlnm.Print_Titles"===i?t.xg(l,s):t.Uf(i,h.processFunction(s),l,a))}(Array.isArray(l.definedNames.definedName)?l.definedNames.definedName:[l.definedNames.definedName],t),l.calcPr&&m(l.calcPr,t)}return s},t.readWorkbookProperties=f,t.readPivotCache=d,t.readWorkbookView=p,t.readWorkbookCalcProperties=m},"./src/xlsx-io/reader/worksheet-reader.ts":function(e,t,r){"use strict";var a,u,B,E,h,f,c,d,p,g,m,j;function b(e,t,r){for(var n,o,i;e.moveToNextAttribute();)"filterMode"===e.readAttributeNameAsString()&&e.readContentAsString();if(3!==e.elementType)for(n=e.depth;e.read()&&!(e.depth<=n);)if(1===e.nodeType())switch(e.name()){case"tabColor":r.kf(t,a.readColor(e));break;case"outlinePr":for(i=o=!0;e.moveToNextAttribute();)"summaryBelow"===e.readAttributeNameAsString()?o=e.readContentAsBoolean():"summaryRight"===e.readAttributeNameAsString()&&(i=e.readContentAsBoolean());r.jf(t,i,o);break;case"pageSetUpPr":m.readPageSetupAdditionalProperty(e,r)}}function y(e,t,r){for(var n,o,i,a,s,l,u;e.moveToNextAttribute();)"ref"===e.readAttributeNameAsString()&&(i=o=void 0,2===(n=e.readContentAsString().split(":")).length?(a=B.IndexHelper.F(n[0]),s=B.IndexHelper.F(n[1]),l=B.IndexHelper.G(n[0]),u=B.IndexHelper.G(n[1]),o=Math.max(a,s)+1,i=Math.max(l,u)+1):1===n.length&&(o=(a=B.IndexHelper.F(n[0]))+1,i=(l=B.IndexHelper.G(n[0]))+1),r.lf(t,o,i))}function C(e,t,r){var n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I;if(r.Rf(),3!==e.elementType)for(n=e.depth;e.read()&&!(e.depth<=n);)if(1===e.nodeType()&&"sheetView"===e.name()){if(R(e,t,r),a=i=void 0,(o=r.rf)&&(i=B.IndexHelper.F(o),a=B.IndexHelper.G(o)),void 0!==i&&void 0!==a&&r.sf(i,a,t),3===e.elementType)continue;for(s=e.depth;e.read()&&!(e.depth<=s);)if(1===e.nodeType())if("selection"===e.name()){for(u=l=-1,c=0,h=[],f=[],d=[],p=[],g=[],m="",b=3;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"sqref":g=e.readContentAsString().split(" ");break;case"activeCellId":break;case"activeCell":m=e.readContentAsString();break;case"pane":(y=e.readContentAsString())&&void 0!==E.PaneType[y]&&(b=E.PaneType[y])}for(C=0,w=g.length;C<w;C++)1===(v=g[C].split(":")).length?(S=B.IndexHelper.F(v[0]),x=B.IndexHelper.G(v[0]),h.push(S),f.push(S),d.push(x),p.push(x),c++):2===v.length&&(h.push(B.IndexHelper.F(v[0])),d.push(B.IndexHelper.G(v[0])),f.push(B.IndexHelper.F(v[1])),p.push(B.IndexHelper.G(v[1])),c++);m&&(l=B.IndexHelper.F(m),u=B.IndexHelper.G(m)),r.pf(t,b,l,u,c,h,f,d,p)}else if("pane"===e.name()){for(T=null,A=!1,k=3,I=M=0;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"topLeftCell":o=e.readContentAsString();break;case"xSplit":M=e.readContentAsInt(0);break;case"ySplit":I=e.readContentAsInt(0);break;case"state":!(T=e.readContentAsString())||"frozen"!==T&&"frozenSplit"!==T||(A=!0);break;case"activePane":(y=e.readContentAsString())&&void 0!==E.PaneType[y]&&(k=E.PaneType[y])}r.Sf(k),r.qf(t,M,I,o,A)}}}function R(e,t,r){for(var n,o=!1,i=null,a=!0,s=!0,l=100,u=!1,c="A1";e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"colorId":0<=(n=e.readContentAsInt(-1))&&(i=new h.ExcelColor(1,n,0));break;case"showGridLines":a=e.readContentAsBoolean();break;case"showRowColHeaders":s=e.readContentAsBoolean();break;case"showFormulas":u=e.readContentAsBoolean();break;case"zoomScale":l=e.readContentAsDouble(100);break;case"topLeftCell":c=e.readContentAsString();break;case"tabSelected":o=e.readContentAsBoolean()}r.mf(t,i,a,s,l,u,o),r.rf=c}function w(e,t,r){for(var n=NaN,o=NaN,i=8,a=15;e.moveToNextAttribute();)"defaultRowHeight"===e.readAttributeNameAsString()?n=e.readContentAsDouble(NaN):"defaultColWidth"===e.readAttributeNameAsString()?o=e.readContentAsDouble(NaN):"baseColWidth"===e.readAttributeNameAsString()&&(i=e.readContentAsDouble(8));return isNaN(n)||(r.uf(t,n),a=n),r.vf(t,i,o),a}function v(e,t,r,n){var o,i,a,s,l,u,c,h;if(3!==e.elementType){for(o=e.depth;e.read()&&!(e.depth<=o);)if(1===e.nodeType()&&"col"===e.name()){for(u=l=s=a=i=0,h=c=!1;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"min":i=e.readContentAsInt(0)-1;break;case"max":a=e.readContentAsInt(0)-1;break;case"style":s=e.readContentAsInt(0);break;case"width":l=e.readContentAsDouble(8);break;case"hidden":c=e.readContentAsBoolean(!1);break;case"collapsed":h=e.readContentAsBoolean(!1);break;case"outlineLevel":u=e.readContentAsInt(0)}0<=i&&0<=a&&r.Cf(t,i,a,s+n,l,c,u,h)}!function(e){var t,r,n,o;if(e&&e.columns)for(t=e.columns,r=e.columnOutlines,n=0;n<t.length;n++)t[n]&&((o=f.isCollapsed(n,r))&&0===t[n].size&&(t[n].size=j),o&&t[n]&&!1===t[n].visible&&delete t[n].visible)}(r.we.sheets&&r.we.sheets[t])}}function S(e,t,r){var n,o,i,a,s,l;if(3!==e.elementType)for(n=e.depth;e.read()&&!(e.depth<=n);)if(1===e.nodeType()&&"mergeCell"===e.name())for(;e.moveToNextAttribute();)"ref"===e.readAttributeNameAsString()&&(2===(o=e.readContentAsString().split(":")).length&&(i=B.IndexHelper.F(o[0]),a=B.IndexHelper.F(o[1]),s=B.IndexHelper.G(o[0]),l=B.IndexHelper.G(o[1]),r.Df(t,i,a,s,l)))}function x(e,t,r,n,o,i,a){var s,l;if(3!==e.elementType){s=e.depth,r.If(t),l=-1;do{if(e.fastRead(),e.depth<=s)break;l=T(e,t,n,l,r,o,i,a)}while(e.depth>s);r.Bf<l&&(r.Bf=l)}r.Gf(t)}function T(e,t,r,n,o,i,a,s){for(var l,u,c,h=n+1,f=-1,d=!1,p=!1,g=i,m=0;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"r":h=e.readContentAsInt(0)-1;break;case"spans":break;case"s":f=e.readContentAsInt(-1);break;case"collapsed":d=e.readContentAsBoolean(!1);break;case"hidden":p=e.readContentAsBoolean(!1);break;case"ht":g=e.readContentAsDouble(0);break;case"outlineLevel":m=e.readContentAsInt(0)}if(409.5<g&&(g=i),l=-1===f?-1:f+a,o.Hf(t,h,l,g,m,d,p),3===e.elementType)return h;u=-1,c=e.depth;do{if(e.fastRead(),e.depth<=c)break;o.Jf(t,h),u=A(e,t,r,h,u,o,a,s)}while(e.depth>c);return o.Af<u&&(o.Af=u),h}function A(e,t,r,n,o,i,a,s){for(var l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P=o+1,L="n",O=0;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"r":P=B.IndexHelper.G(e.readContentAsString());break;case"t":L=e.readContentAsString();break;case"s":O=e.readContentAsInt(0);break;case"vm":u=!0;break;case"cm":l=e.readContentAsInt(0)}if((0!==O||i.Oe&&i.Oe[n]&&i.Oe[n].style||i.Ne&&i.Ne[n]&&i.Ne[n].style)&&(c=O+a),i.Kf(t,n,P,c),3===e.elementType)return P;h=e.depth,p=null,g=d=f=void 0;do{if(e.fastRead(),e.depth<=h)break;if(m=e.buffer[e.mm+e.al-1],1==(1&e.elementType))if("v"===m&&1===e.elementType)switch(b=e.readElementContentAsString(),L){case"b":f="1"===b;break;case"d":f=new Date(b);break;case"e":switch(y=j,b){case"#DIV/0!":y=7;break;case"#N/A":y=42;break;case"#NAME?":y=29;break;case"#NULL!":y=0;break;case"#NUM!":y=36;break;case"#REF!":y=23;break;case"#VALUE!":y=15}f=y!==j?{_error:b,_code:y}:j,u&&(f={_error:"#SPILL!",_code:99});break;case"inlineStr":f="";break;case"n":C=parseFloat(b),f=isNaN(C)?j:C;break;case"s":w=parseInt(b,10),s&&0<=w&&w<s.length&&s[w]?(f=s[w].value,g=s[w].richText):f=b;break;case"str":f=B.Util.ta(b);break;default:f=b}else if("f"===m){for(x=S=v=j;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"t":v=e.readContentAsString();break;case"ref":S=e.readContentAsString();break;case"si":x=e.readContentAsString()}1===e.elementType&&(d=e.readElementContentAsString()),"array"===v?(T=S.split(":"),I=k=0,A=B.IndexHelper.F(T[0]),M=B.IndexHelper.G(T[0]),I=1===T.length?(k=A,M):(k=B.IndexHelper.F(T[1]),B.IndexHelper.G(T[1])),p={row:A,rowCount:k-A+1,col:M,colCount:I-M+1},l&&(p.isDynamicArray=i.Dg(l))):"shared"===v&&x!==j&&(E=parseInt(x,10),d?(R={baseFormula:d},S&&(2===(D=S.split(":")).length?(k=B.IndexHelper.F(D[1]),N=B.IndexHelper.G(D[1]),R.baseRow=n,R.baseColumn=P,R.isRowShared=k===R.baseRow,R.isRowShared?R.count=N-R.baseColumn+1:R.count=k-R.baseRow+1):(R.baseRow=B.IndexHelper.F(D[0]),R.baseColumn=B.IndexHelper.G(D[0]),R.isRowShared=!0,R.count=1)),r[E]||(r[E]=R)):(R=r[E])&&(F=P-R.baseColumn,_=n-R.baseRow,d=B.ba.P(R,F,_)))}else"t"===m&&"inlineStr"===L&&(f=B.Util.ta(e.readElementContentAsString()))}while(e.depth>h);return u&&p&&p.isDynamicArray&&(p.isInvalid=!0),i.Mf(t,n,P,c,f,B.Util.ta(B.processFunction(d)),p,g),P}function k(e,t,r){for(var n,o=[],i=!1;e.moveToNextAttribute();)"sheet"===(n=e.readAttributeNameAsString())?(i=e.readContentAsBoolean(!1),r.Ef(t,i)):"algorithmName"===n||"hashValue"===n||"saltValue"===n||"spinCount"===n?o.push({name:n,value:e.readContentAsString()}):o.push({name:n,value:!e.readContentAsBoolean(!1)});r.Ff(t,o,i)}function M(e,t,r){var n,o,i,a,s,l;if(3!==e.elementType)for(n=e.depth;e.read()&&!(e.depth<=n);)if(1===e.nodeType()){if(i=o=void 0,"ext"===e.name())for(;e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"uri":o=e.readContentAsString();break;case"xmlns:x14":i=e.readContentAsString()}0,l="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"===i,"{78C0D931-6437-407d-A8EE-F0AAD7539E65}"===o&&l&&c.readExtensionConditionalFormating(e,t,r),0,s="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"===i,"{05C60535-1F16-4fd2-B633-F4F36F0B64E0}"===o&&s&&d.readSparklineGroups(e,t,r),0,a="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"===i,"{CCE6A557-97BC-4b89-ADB6-D9C93CAAB3DF}"===o&&a&&g.readExtensionDataValidation(e,t,r)}}function I(e,t,r,n){var o,i,a,s;if(3!==e.elementType)for(o=e.depth;e.read()&&!(e.depth<=o);)if(1===e.nodeType()&&"hyperlink"===e.name()){for(i={url:"",linkColor:"hyperlink",visitedLinkColor:"followedHyperlink",tooltip:"",target:0,drawUnderline:!0,command:""},a={row:0,col:0};e.moveToNextAttribute();)switch(e.readAttributeNameAsString()){case"ref":s=e.readContentAsString().split(":"),a.row=B.IndexHelper.F(s[0]),a.col=B.IndexHelper.G(s[0]);break;case"r:id":i.url=B.Util.ta(n[e.readContentAsString()].fileName);break;case"location":i.url?i.url=i.url+"#"+B.Util.ta(e.readContentAsString()):i.url="sjs://"+B.Util.ta(e.readContentAsString());break;case"tooltip":i.tooltip=B.Util.ta(e.readContentAsString())}r.Lf(t,a.row,a.col,i)}}Object.defineProperty(t,"__esModule",{value:!0}),a=r("./src/xlsx-io/common/color-reader.ts"),u=r("./src/xml-io/xml-reader.ts"),B=r("./src/common/common.ts"),E=r("./src/common/excel-types.ts"),h=r("./src/datamodel/excel-style.ts"),f=r("./src/datamodel/excel-helper.ts"),c=r("./src/xlsx-io/reader/conditionalformat-reader.ts"),d=r("./src/xlsx-io/reader/sparkline-reader.ts"),p=r("./src/xlsx-io/reader/autofilter-reader.ts"),g=r("./src/xlsx-io/reader/datavalidation-reader.ts"),m=r("./src/xlsx-io/reader/print-reader.ts"),j=null,t.readWorksheets=function(e,t,r,n,o,i){var a,s,l=new u.XmlReader;for(l.reset(),l.setXml(e),a=15,s={},n.Se=[],n.Te=[],n.Bf=0,n.Af=0;l.read();)if(1===l.depth&&2!==l.elementType)try{switch(l.name()){case"sheetPr":b(l,r,n);break;case"dimension":y(l,r,n);break;case"sheetViews":C(l,r,n);break;case"sheetFormatPr":a=w(l,r,n);break;case"cols":v(l,r,n,o);break;case"mergeCells":S(l,r,n);break;case"sheetData":x(l,r,n,s,a,o,i);break;case"sheetProtection":k(l,r,n);break;case"conditionalFormatting":c.readConditionalFormatting(l,r,n);break;case"extLst":M(l,r,n);break;case"autoFilter":p.readAutoFilterForSheet(l,r,n);break;case"dataValidations":g.readDataValidations(l,r,n);break;case"pageMargins":m.readPageMargins(l,r,n);break;case"printOptions":m.readPrintOptions(l,r,n);break;case"pageSetup":m.readPageSetup(l,n);break;case"headerFooter":m.readHeaderFooter(l,n);break;case"rowBreaks":m.readRowColumnBreaks(l,n,!0);break;case"colBreaks":m.readRowColumnBreaks(l,n,!1);break;case"legacyDrawingHF":m.readLegacyDrawingHF(l,n);break;case"hyperlinks":I(l,r,n,t)}}catch(e){}}},"./src/xlsx-io/reader/xlsx-reader.ts":function(e,t,r){"use strict";var s,n,o,i,a,l,u,c,h,f,d,p,g,m,b,y,C,w;function v(){this.nm={},this.om=0,this.pm=[],this.Mj=new n.ReaderDataModel}Object.defineProperty(t,"__esModule",{value:!0}),s=r("./src/common/excel-types.ts"),n=r("./src/datamodel/datamodel-reader.ts"),o=r("./src/xlsx-io/reader/docpropscore-reader.ts"),i=r("./src/xlsx-io/reader/docpropsapp-reader.ts"),a=r("./src/xlsx-io/reader/docpropscustom-reader.ts"),l=r("./src/xlsx-io/reader/sharedstring-reader.ts"),u=r("./src/xlsx-io/reader/theme-reader.ts"),c=r("./src/xlsx-io/reader/workbook-reader.ts"),h=r("./src/xlsx-io/reader/style-reader.ts"),f=r("./src/xlsx-io/reader/worksheet-reader.ts"),d=r("./src/xlsx-io/reader/comment-reader.ts"),p=r("./src/xlsx-io/reader/drawing-reader.ts"),g=r("./src/xlsx-io/reader/slicer-reader.ts"),m=r("./src/xlsx-io/reader/table-reader.ts"),b=r("./src/xlsx-io/reader/print-reader.ts"),y=r("./src/datamodel/excel-style.ts"),C=r("./src/xlsx-io/reader/metadata-reader.ts"),w=r("./src/xlsx-io/reader/pivot-reader.ts"),v.prototype.Ej=function(e,t){var r,n,o;e&&((r=this).nm=e,(n=new s.XFile("","")).ie(e),o=(o=n.me(s.RelationshipConstants.Pa))||n.me(s.RelationshipConstants.Qa),r.onCompleted=function(){r.qm(),r.rm(),t(r.Mj.we)},r.tm(n),r.um(o))},v.prototype.tm=function(e){var t=e.me(s.RelationshipConstants.Ma),r=e.me(s.RelationshipConstants.Na),n=e.me(s.RelationshipConstants.Oa);t&&this.vm(t),r&&this.wm(r),n&&this.xm(n)},v.prototype.vm=function(e){var t=this.ym(e.fileName,!0);if(t)try{o.readDocPropsCoreFile(t,this.Mj)}catch(e){}},v.prototype.wm=function(e){var t=this.ym(e.fileName,!0);if(t)try{i.readDocPropsAppFile(t,this.Mj)}catch(e){}},v.prototype.xm=function(e){var t=this.ym(e.fileName,!0);if(t)try{a.readDocPropsCustomFile(t,this.Mj)}catch(e){}},v.prototype.um=function(e){if(!e)throw Error("Incorrect file format.");if(this.zm(e),this.Am(e),this.Bm(e),this.Cm(e),this.Dm(e),this.Em(e),0===this.pm.length)throw Error("Incorrect file format.");this.Lj(e),this.nh()},v.prototype.zm=function(e){var t,r,n=e.me(s.RelationshipConstants.Ua);if((n=n||e.me(s.RelationshipConstants.Va))&&(r=(t=this).ym(n.fileName)))try{t.sharedString=l.readSharedString(r)}catch(e){}},v.prototype.Am=function(e){var t,r=e.me(s.RelationshipConstants.Wa);if((r=r||e.me(s.RelationshipConstants.Xa))&&(t=this.ym(r.fileName)))try{u.readTheme(t,this.Mj)}catch(e){}},v.prototype.Dm=function(e){var t,r,n,o,i,a=e.ne(s.RelationshipConstants.Ya);if(a)for((t=this.Mj).pivotCaches=[],r=0;r<a.length;r++){if(n=a[r],o=t.eg("rid",n.id),this.Fm(n,o),i=this.ym(n.file.fileName))try{w.readPivotCacheDefinitions(i,t,o)}catch(e){}t.pivotCaches.push(o)}},v.prototype.Fm=function(e,t){var r,n;if(e&&(r=e.file.me(s.RelationshipConstants.Za))&&(n=this.ym(r.fileName)))try{w.readPivotCacheRecords(n,t)}catch(e){}},v.prototype.Bm=function(e){var t,r,n=e.me(s.RelationshipConstants.Ra);if((n=n||e.me(s.RelationshipConstants.Sa))&&(r=(t=this).ym(n.fileName,!0)))try{t.om=h.readStyle(r,t.Mj)}catch(e){}},v.prototype.Cm=function(e){var t=this.ym(e.fileName);if(t)try{this.pm=c.readWorkbook(t,this.Mj)}catch(e){}},v.prototype.Lj=function(e){var t,r,n,o,i,a,s,l=this,u=l.Mj,c=l.ym.bind(l);for(n=0,o=l.pm.length;n<o;n++)if(r=(t=l.pm[n]).name,i=e.oe(t.rID)){if(a=l.ym(i.fileName),u.gm={},a)try{f.readWorksheets(a,i.relationFiles,r,u,l.om,l.sharedString)}catch(e){}s=i.relationFiles;try{w.readPivotTableDefinition(s,r,u,c)}catch(e){}try{d.readComments(s,r,u,c)}catch(e){}try{p.readDrawings(s,r,u,c)}catch(e){}try{m.readTables(s,r,u,c)}catch(e){}try{b.readVmlDrawing(s,u,c)}catch(e){}u.ug(r,u.gm),u.gm={}}for(n=0,o=l.pm.length;n<o;n++)if(r=(t=l.pm[n]).name,i=e.oe(t.rID)){s=i.relationFiles;try{g.readSlicers(s,r,u,c,e)}catch(e){}}for(n=0,o=l.pm.length;n<o;n++)r=(t=l.pm[n]).name,l.Gm(r)},v.prototype.nh=function(){this.onCompleted&&this.onCompleted()},v.prototype.setRowVisible=function(e,t){if(t){var r=t.range,n=t.filteredColumns,o=void 0;if(r&&e.rows&&n&&0<n.length)for(o=r.row;o<r.row+r.rowCount;o++)e.rows[o]&&(e.rows[o].visible=!0)}},v.prototype.Gm=function(e){var t,r,n,o=this.Mj.we,i=o.sheets&&o.sheets[e];if(i&&(this.setRowVisible(i,i.rowFilter),t=i.tables))for(r=0;r<t.length;r++)n=t[r],this.setRowVisible(i,n.rowFilter)},v.prototype.ym=function(e,t){var r=e.substr("/"===e.charAt(0)?1:0).toLowerCase(),n=this.nm[r];return t||(this.nm[r]=null),n},v.prototype.qm=function(){this.nm={}},v.prototype.rm=function(){y.clearCache()},v.prototype.Em=function(e){var t,r,n=e.me(s.RelationshipConstants.qb);if(n&&(r=(t=this).ym(n.fileName)))try{C.readSheetMetadata(r,t.Mj),t.Mj.we.allowDynamicArray=!0}catch(e){}},t.XlsxReader=v},"./src/xlsx-io/writer/autofilter-writer.ts":function(e,t,r){"use strict";var l,o,u,n,i,c,h;function f(e,t){e.writeLeafElement("top10",function(){t.isBottom&&e.writeAttributeString("top","0"),t.percent&&e.writeAttributeString("percent","1"),isNaN(t.value)||e.writeAttributeString("val",t.value),isNaN(t.filterValue)||e.writeAttributeString("filterVal",t.filterValue)})}function d(t,r){l.k(r.filter1)&&l.k(r.filter2)||t.writeElement("customFilters",function(){r.and&&t.writeAttributeString("and","1")},function(){l.k(r.filter1)||t.writeLeafElement("customFilter",function(){var e=i[r.filter1.operator];"none"!==e&&t.writeAttributeString("operator",e),t.writeAttributeString("val",r.filter1.value)}),l.k(r.filter2)||t.writeLeafElement("customFilter",function(){var e=i[r.filter2.operator];"none"!==e&&t.writeAttributeString("operator",e),t.writeAttributeString("val",r.filter2.value)})})}function a(t,r){t.writeElement("sortState",function(){t.writeAttributeString("ref",o.getRangeString([r.range]))},function(){t.writeLeafElement("sortCondition",function(){if(t.writeAttributeString("ref",o.getRangeString([r.range])),r.descending&&t.writeAttributeString("descending","1"),r.isBackColor!==n){var e=r.isBackColor?"cellColor":"fontColor";t.writeAttributeString("sortBy",e),t.writeAttributeString("dxfId",r.dxfid)}})})}function s(s,e){e&&e.range&&(0<e.filterColumns.length||e.sortInfo?s.writeElement("autoFilter",function(){s.writeAttributeString("ref",o.getRangeString([e.range]))},function(){e.filterColumns&&e.filterColumns.forEach(function(a){a.colorFilter||a.top10||a.filters||a.dynamicFilter||a.customFilters?s.writeElement("filterColumn",function(){s.writeAttributeString("colId",a.autoFilterColumnId),l.k(a.hiddenButton)||s.writeAttributeString("hiddenButton",a.hiddenButton)},function(){var e,t,r,n,o,i;l.k(a.colorFilter)?l.k(a.top10)?l.k(a.filters)?l.k(a.dynamicFilter)?l.k(a.customFilters)||d(s,a.customFilters):(o=s,i=a.dynamicFilter,l.k(i.type)||o.writeLeafElement("dynamicFilter",function(){var e=c[i.type],t=i.conType,r=i.expectTypeId||0;6===t&&(e=h[r][i.type]),e&&"null"!==e?o.writeAttributeString("type",e):o.writeAttributeString("type","null"),"Q"!==e[0]&&"M"!==e[0]&&(l.k(i.value)||o.writeAttributeString("val",i.value),l.k(i.maxValue)||o.writeAttributeString("maxVal",i.maxValue))})):(r=s,n=a.filters,r.writeElement("filters",function(){n.blank&&r.writeAttributeString("blank","1")},function(){n.filter&&n.filter.forEach(function(e){u(e)||r.writeLeafElement("filter",function(){r.writeAttributeString("val",e)})}),n.dateGroupItem&&n.dateGroupItem.forEach(function(e){r.writeLeafElement("dateGroupItem",function(){0<e.year&&r.writeAttributeString("year",e.year),0<=e.month&&e.month<12&&r.writeAttributeString("month",e.month),0<e.day&&e.day<32&&r.writeAttributeString("day",e.day),e.hour<24&&r.writeAttributeString("hour",e.hour),e.minute<60&&r.writeAttributeString("minute",e.minute),e.second<60&&r.writeAttributeString("second",e.second),r.writeAttributeString("dateTimeGrouping","day")})})})):f(s,a.top10):(e=s,t=a.colorFilter,e.writeLeafElement("colorFilter",function(){t.cellColor||e.writeAttributeString("cellColor","0"),e.writeAttributeString("dxfId",t.dxfId)}))}):s.writeLeafElement("filterColumn",function(){s.writeAttributeString("colId",a.autoFilterColumnId),l.k(a.hiddenButton)||s.writeAttributeString("hiddenButton",a.hiddenButton)})}),e.sortInfo&&a(s,e.sortInfo)}):s.writeLeafElement("autoFilter",function(){s.writeAttributeString("ref",o.getRangeString([e.range]))}),e.sortInfo&&a(s,e.sortInfo))}Object.defineProperty(t,"__esModule",{value:!0}),l=r("./src/common/common.ts"),o=r("./src/common/range-parser.ts"),u=l.StringEx.C,n=void 0,i={"-1":"none",0:"equal",4:"lessThan",5:"lessThanOrEqual",1:"notEqual",2:"greaterThan",3:"greaterThanOrEqual"},c={"-1":"null",100:"aboveAverage",101:"belowAverage"},h=[["today","yesterday","tomorrow","lastWeek","thisMonth","lastMonth","nextMonth","thisWeek","lastWeek","nextWeek","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear"],[],["Q1","Q2","Q3","Q4"],["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12"],[],[],["yearToDate"]],t.writeSortInfo=a,t.writeAutoFilter=s,t.writePivotAutoFilter=function(n,e){e&&e.range&&(0<e.filterColumns.length||e.sortInfo?n.writeElement("autoFilter",function(){n.writeAttributeString("ref",e.range)},function(){e.filterColumns&&e.filterColumns.forEach(function(e){e.colorFilter||e.top10||e.filters||e.dynamicFilter||e.customFilters?n.writeElement("filterColumn",function(){n.writeAttributeString("colId",e.autoFilterColumnId),l.k(e.hiddenButton)||n.writeAttributeString("hiddenButton",e.hiddenButton)},function(){var t,r;l.k(e.top10)?l.k(e.dynamicFilter)?l.k(e.customFilters)||d(n,e.customFilters):(t=n,r=e.dynamicFilter,l.k(r.type)||t.writeLeafElement("dynamicFilter",function(){var e=r.type;e&&"null"!==e?t.writeAttributeString("type",e):t.writeAttributeString("type","null"),l.k(r.value)||t.writeAttributeString("val",r.value),l.k(r.maxValue)||t.writeAttributeString("maxVal",r.maxValue)})):f(n,e.top10)}):n.writeLeafElement("filterColumn",function(){n.writeAttributeString("colId",e.autoFilterColumnId),l.k(e.hiddenButton)||n.writeAttributeString("hiddenButton",e.hiddenButton)})})}):n.writeLeafElement("autoFilter",function(){n.writeAttributeString("ref",o.getRangeString([e.range]))}))},t.writeAutoFilterForSheet=function(e,t,r){var n=r.Ji(t);n&&s(e,n)}},"./src/xlsx-io/writer/chart-writer.ts":function(e,l,t){"use strict";var p,u,s,i,N,a,c,h,f,o,d,w,g,m,y,C,r,b,v,S,x,T,A,k,M,I,E,R,D,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie,ae,se,le,ue,ce,he,fe,de,pe,ge,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,Ie,Ee,Re,De,Ne,Fe,_e,Pe,n,Le;function Oe(e){return N.k(e)||""===e}function Be(e,t,r){e.writeLeafElement(t+":"+r)}function je(e,t,r,n,o,i,a,s){e.writeLeafElement(t+":"+r,function(){N.k(n)||!N.k(i)&&n===i||(s&&(n=s(n)),a&&(n=a[n]),e.writeAttributeString(o,n))})}function He(t,e,r,n,o,i,a){t.writeElement(e+":"+r,function(){var e=n[a];N.k(e)||o(t,i,a,e)})}function Ge(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.sqref)||e.writeElementString("c15:sqref",n.sqref)})}function Ue(r,e,t,n,o,i){r.writeLeafElement(e+":"+t,function(){var e=n[o],t=n[i];N.k(e)||r.writeAttributeString(o,e),N.k(t)||r.writeAttributeString(i,t)})}function We(e,t){if(!N.k(t)){var r=t.scrgbClr,n=t.srgbClr,o=t.hslClr,i=t.sysClr,a=t.schemeClr,s=t.prstClr,l=t.styleClr;N.k(r)?N.k(n)?N.k(o)?N.k(i)?N.k(a)?N.k(s)?N.k(l)||Gt(e,Pe,I,l):Ht(e,Te,M,s):jt(e,Te,k,a):Bt(e,Te,A,i):Ot(e,Te,T,o):Lt(e,Te,x,n):Pt(e,Te,S,r)}}function Ve(e,t){var r=t.noFill,n=t.solidFill,o=t.gradFill,i=t.blipFill,a=t.pattFill,s=t.grpFill;N.k(r)?N.k(n)?N.k(o)?N.k(i)?N.k(a)?N.k(s)||Gi(e,Te,P):Hi(e,Te,_,a):ji(e,Te,F,i):Pi(e,Te,D,o):Ri(e,Te,R,n):Ei(e,Te,E)}function ze(t,e,r,n){t.writeElement(e+":"+r,function(){n.noFill?Xe(n.noFill,function(){Ei(t,Te,E)}):n.solidFill?Xe(n.solidFill,function(e){Ri(t,Te,R,e)}):n.gradFill?Xe(n.gradFill,function(e){Pi(t,Te,D,e)}):n.blipFill?Xe(n.blipFill,function(e){ji(t,Te,F,e)}):n.pattFill?Xe(n.pattFill,function(e){Hi(t,Te,_,e)}):n.grpFill&&Xe(n.grpFill,function(){Gi(t,Te,P)})})}function qe(t,e){Xe(e.tint,function(e){kt(t,Te,"tint",e)}),Xe(e.shade,function(e){kt(t,Te,"shade",e)}),Xe(e.comp,function(){Rt(t,Te,"comp")}),Xe(e.inv,function(){Dt(t,Te,"inv")}),Xe(e.gray,function(){Nt(t,Te,"gray")}),Xe(e.alpha,function(e){kt(t,Te,"alpha",e)}),Xe(e.alphaMod,function(e){Tt(t,Te,"alphaMod",e)}),Xe(e.alphaOff,function(e){At(t,Te,"alphaOff",e)}),Xe(e.hue,function(e){St(t,Te,"hue",e)}),Xe(e.hueMod,function(e){Tt(t,Te,"hueMod",e)}),Xe(e.hueOff,function(e){vt(t,Te,"hueOff",e)}),Xe(e.sat,function(e){xt(t,Te,"sat",e)}),Xe(e.satMod,function(e){xt(t,Te,"satMod",e)}),Xe(e.satOff,function(e){xt(t,Te,"satOff",e)}),Xe(e.lum,function(e){xt(t,Te,"lum",e)}),Xe(e.lumMod,function(e){xt(t,Te,"lumMod",e)}),Xe(e.lumOff,function(e){xt(t,Te,"lumOff",e)}),Xe(e.red,function(e){xt(t,Te,"red",e)}),Xe(e.redMod,function(e){xt(t,Te,"redMod",e)}),Xe(e.redOff,function(e){xt(t,Te,"redOff",e)}),Xe(e.green,function(e){xt(t,Te,"green",e)}),Xe(e.greenMod,function(e){xt(t,Te,"greenMod",e)}),Xe(e.greenOff,function(e){xt(t,Te,"greenOff",e)}),Xe(e.blue,function(e){xt(t,Te,"blue",e)}),Xe(e.blueMod,function(e){xt(t,Te,"blueMod",e)}),Xe(e.blueOff,function(e){xt(t,Te,"blueOff",e)}),Xe(e.gamma,function(){Ft(t,Te,"gamma")}),Xe(e.invGamma,function(){_t(t,Te,"invGamma")})}function Ze(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.wireframe,t=o.bandFmts,r=o.extLst;N.k(e)||Qt(n,Ie,"wireframe",e),Xe(o.ser,function(e){dn(n,Ie,te,e)}),N.k(t)||On(n,Ie,"bandFmts",t),Xe(o.axId,function(e){tr(n,Ie,ne,e)}),N.k(r)||or(n,Ie,w,r)})}function Ye(t,e,r,n,o){t.writeElement(e+":"+r,function(){var e=n.cNvPr;N.k(e)||Wo(t,o,g,e),Yo(t,o,ve)})}function Ke(e,t){var r=t.axId,n=t.scaling,o=t.delete,i=t.axPos,a=t.majorGridlines,s=t.minorGridlines,l=t.title,u=t.numFmt,c=t.majorTickMark,h=t.minorTickMark,f=t.tickLblPos,d=t.spPr,p=t.txPr,g=t.crossAx,m=t.crosses,b=t.crossesAt;N.k(r)||tr(e,Ie,ne,r),N.k(n)||ro(e,Ie,ae,n),N.k(o)||Qt(e,Ie,L,o),N.k(i)||Hn(e,Ie,se,i),N.k(a)||gn(e,Ie,le,a),N.k(s)||gn(e,Ie,ue,s),N.k(l)||vr(e,Ie,ce,l),N.k(u)||jr(e,Ie,he,u),N.k(c)||Wn(e,Ie,fe,c),N.k(h)||Wn(e,Ie,de,h),N.k(f)||Vn(e,Ie,pe,f),N.k(d)||Sa(e,Ie,B,d),N.k(p)||bs(e,Ie,j,p),N.k(g)||tr(e,Ie,ge,g),N.k(m)||Gn(e,Ie,me,m),N.k(b)||$t(e,Ie,"crossesAt",b)}function Xe(e,t){var r,n,o;if(!N.k(e))for(r=0,n=e.length;r<n;r++)o=e[r],N.k(o)||t(o,r)}function Je(t,e){var r=e.idx,n=e.order,o=e.tx,i=e.spPr,a=e.marker,s=e.dLbls,l=e.smooth,u=e.extLst;N.k(r)||er(t,Ie,"idx",r),N.k(n)||er(t,Ie,X,n),N.k(o)||mr(t,Ie,"tx",o),N.k(i)||Sa(t,Ie,B,i),N.k(a)||qr(t,Ie,U,a),Xe(e.dPt,function(e){Zr(t,Ie,"dPt",e)}),N.k(s)||Wr(t,Ie,Q,s),Xe(e.trendline,function(e){Qr(t,Ie,$,e)}),Xe(e.errBars,function(e){rn(t,Ie,ee,e)}),N.k(l)||Qt(t,Ie,"smooth",l),N.k(u)||or(t,Ie,w,u)}function Qe(t,e){var r=e.idx,n=e.order,o=e.tx,i=e.spPr,a=e.pictureOptions,s=e.dLbls,l=e.cat,u=e.val,c=e.extLst;N.k(r)||er(t,Ie,"idx",r),N.k(n)||er(t,Ie,X,n),N.k(o)||mr(t,Ie,"tx",o),N.k(i)||Sa(t,Ie,B,i),N.k(a)||Jn(t,Ie,K,a),Xe(e.dPt,function(e){Zr(t,Ie,"dPt",e)}),N.k(s)||Wr(t,Ie,Q,s),Xe(e.trendline,function(e){Qr(t,Ie,$,e)}),Xe(e.errBars,function(e){rn(t,Ie,ee,e)}),N.k(l)||gr(t,Ie,"cat",l),N.k(u)||lr(t,Ie,h,u),N.k(c)||or(t,Ie,w,c)}function $e(e,t){!0===t.noGrp&&e.writeAttributeString("noGrp","1"),!0===t.noSelect&&e.writeAttributeString("noSelect","1"),!0===t.noRot&&e.writeAttributeString("noRot","1"),!0===t.noChangeAspect&&e.writeAttributeString("noChangeAspect","1"),!0===t.noMove&&e.writeAttributeString("noMove","1"),!0===t.noResize&&e.writeAttributeString("noResize","1"),!0===t.noEditPoints&&e.writeAttributeString("noEditPoints","1"),!0===t.noAdjustHandles&&e.writeAttributeString("noAdjustHandles","1"),!0===t.noChangeArrowheads&&e.writeAttributeString("noChangeArrowheads","1"),!0===t.noChangeShapeType&&e.writeAttributeString("noChangeShapeType","1")}function et(e,t){var r=t.numFmt,n=t.spPr,o=t.txPr,i=t.dLblPos,a=t.showLegendKey,s=t.showVal,l=t.showCatName,u=t.showSerName,c=t.showPercent,h=t.showBubbleSize;N.k(r)||jr(e,Ie,he,r),N.k(n)||Sa(e,Ie,B,n),N.k(o)||bs(e,Ie,j,o),N.k(i)||Gr(e,Ie,"dLblPos",i),N.k(a)||Qt(e,Ie,"showLegendKey",a),N.k(s)||Qt(e,Ie,"showVal",s),N.k(l)||Qt(e,Ie,"showCatName",l),N.k(u)||Qt(e,Ie,"showSerName",u),N.k(c)||Qt(e,Ie,"showPercent",c),N.k(h)||Qt(e,Ie,"showBubbleSize",h),N.k(t.separator)||e.writeElementString("c:separator",t.separator)}function tt(e,t){var r=t.sx,n=t.sy,o=t.kx,i=t.ky,a=t.algn;N.k(r)||1e5===r||e.writeAttributeString("sx",r),N.k(n)||1e5===n||e.writeAttributeString("sy",n),N.k(o)||0===o||e.writeAttributeString("kx",o),N.k(i)||0===i||e.writeAttributeString("ky",i),N.k(a)||7===a||e.writeAttributeString("algn",p.Charts.ST_RectAlignment[a]),!1===t.rotWithShape&&e.writeAttributeString(ye,"0")}function rt(o,e,t,i,a,s){o.writeElement(e+":"+t,function(){var e=i.macro,t=i.textlink;N.k(e)||o.writeAttributeString(m,e),N.k(t)||o.writeAttributeString("textlink",t),!1===i.fLocksText&&o.writeAttributeString("fLocksText","0"),!0===i.fPublished&&o.writeAttributeString(r,"1")},function(){var e=i.nvSpPr,t=i.spPr,r=i.style,n=i.txBody;N.k(e)||s(o,a,"nvSpPr",e),N.k(t)||Sa(o,a,B,t,!1),N.k(r)||ka(o,a,be,r),N.k(n)||bs(o,a,"txBody",n)})}function nt(r,e,t,n,o){r.writeElement(e+":"+t,function(){var e=n.cNvPr,t=n.cNvSpPr;N.k(e)||Wo(r,o,g,e),N.k(t)||Vo(r,o,"cNvSpPr",t)})}function ot(e,t,r){var n,o,i=t.ext,a=t.sp,s=t.grpSp,l=t.graphicFrame,u=t.cxnSp,c=t.AlternateContent,h=t.clientData;!i&&r&&(n=t.width,o=t.height,isNaN(n)||isNaN(o)||(i={cx:n,cy:o})),N.k(i)||Et(e,Me,v,i,!0),N.k(a)||Da(e,Me,"sp",a),N.k(s)||Ja(e,Me,W,s),N.k(l)||Ya(e,Me,b,l),N.k(u)||Pa(e,Me,V,u),N.k(c)||es(e,Fe,Se),N.k(h)||Ma(e,Me,xe,h)}function it(d,e,t,p){d.writeElement(e+":"+t,function(){N.k(p.name)||d.writeAttributeString(f,p.name)},function(){var e=p.dk1,t=p.lt1,r=p.dk2,n=p.lt2,o=p.accent1,i=p.accent2,a=p.accent3,s=p.accent4,l=p.accent5,u=p.accent6,c=p.hlink,h=p.folHlink,f=p.extLst;N.k(e)||Kt(d,Te,"dk1",e),N.k(t)||Kt(d,Te,"lt1",t),N.k(r)||Kt(d,Te,"dk2",r),N.k(n)||Kt(d,Te,"lt2",n),N.k(o)||Kt(d,Te,"accent1",o),N.k(i)||Kt(d,Te,"accent2",i),N.k(a)||Kt(d,Te,"accent3",a),N.k(s)||Kt(d,Te,"accent4",s),N.k(l)||Kt(d,Te,"accent5",l),N.k(u)||Kt(d,Te,"accent6",u),N.k(c)||Kt(d,Te,"hlink",c),N.k(h)||Kt(d,Te,"folHlink",h),N.k(f)||Ut(d,Te,w,f)})}function at(e,t,r,n){e.writeElement(t+":"+r,function(){Oe(n.name)||e.writeAttributeString(f,n.name)},function(){We(e,n)})}function st(r,e,t,n){r.writeLeafElement(e+":"+t,function(){var e=n.script,t=n.typeface;N.k(e)||r.writeAttributeString("script",e),N.k(t)||r.writeAttributeString("typeface",t)})}function lt(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.custClr,function(e){at(t,Te,"custClr",e)})})}function ut(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.latin,t=i.ea,r=i.cs,n=i.extLst;N.k(e)||Ms(o,Te,"latin",e),N.k(t)||Ms(o,Te,"ea",t),N.k(r)||Ms(o,Te,"cs",r),Xe(i.font,function(e){st(o,Te,"font",e)}),N.k(n)||Ut(o,Te,w,n)})}function ct(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.effectLst,t=i.effectDag,r=i.scene3d,n=i.sp3d;N.k(e)||Ki(o,Te,y,e),N.k(t)||qi(o,Te,C,t),N.k(r)||ei(o,Te,O,r),N.k(n)||ni(o,Te,"sp3d",n)})}function ht(n,e,t,o){n.writeElement(e+":"+t,function(){N.k(o.name)||n.writeAttributeString(f,o.name)},function(){var e=o.majorFont,t=o.minorFont,r=o.extLst;N.k(e)||ut(n,Te,"majorFont",e),N.k(t)||ut(n,Te,"minorFont",t),N.k(r)||Ut(n,Te,w,r)})}function ft(e,t,r,n){ze(e,t,r,n)}function dt(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.ln,function(e){va(t,Te,"ln",e)})})}function pt(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.effectStyle,function(e){ct(t,Te,"effectStyle",e)})})}function gt(e,t,r,n){ze(e,t,r,n)}function mt(o,e,t,i){o.writeElement(e+":"+t,function(){Oe(i.name)||o.writeAttributeString(f,i.name)},function(){var e=i.fillStyleLst,t=i.lnStyleLst,r=i.effectStyleLst,n=i.bgFillStyleLst;N.k(e)||ft(o,Te,"fillStyleLst",e),N.k(t)||dt(o,Te,"lnStyleLst",t),N.k(r)||pt(o,Te,"effectStyleLst",r),N.k(n)||gt(o,Te,"bgFillStyleLst",n)})}function bt(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.clrScheme,t=i.fontScheme,r=i.fmtScheme,n=i.extLst;N.k(e)||it(o,Te,z,e),N.k(t)||ht(o,Te,q,t),N.k(r)||mt(o,Te,Z,r),N.k(n)||Ut(o,Te,w,n)})}function yt(e){return e.map(function(e){return("00"+e.toString(16)).substr(-2)}).join("")}function Ct(t,e,r,n){t.writeElement(e+":"+r,function(){N.k(n.uri)||t.writeAttributeString("uri",n.uri)},function(){if(N.k(n.dataObject)||t.writeValue(n.dataObject),0===n.hiddenExtensionType&&ei(t,De,"hiddenScene3d",n.Scene3d),3===n.hiddenExtensionType&&ni(t,De,"hiddenSp3d",n.Shape3d),1===n.hiddenExtensionType&&Ui(t,De,"hiddenFill",n.Fill),2===n.hiddenExtensionType&&va(t,De,"hiddenLine",n.Line),!N.k(n.creationId)&&0<n.creationId.length)for(var e=0;e<n.creationId.length;e++)wt(t,"a16","creationId",n.creationId[e])})}function wt(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.name)||e.writeAttributeString("xmlns:a16",""+n.name),N.k(n.id)||e.writeAttributeString("id",""+n.id)})}function vt(e,t,r,n){je(e,t,r,n,h)}function St(e,t,r,n){je(e,t,r,n,h)}function xt(e,t,r,n){je(e,t,r,n,h)}function Tt(e,t,r,n){je(e,t,r,n,h)}function At(e,t,r,n){je(e,t,r,n,h)}function kt(a,e,t,s){a.writeLeafElement(e+":"+t,function(){var e,t,r,n,o,i=s;N.k(i)||(-1!==(t=(e=""+i).indexOf("."))&&e.length>t+3&&(n=i.toFixed(2),"0"===(o=n.substr(-2))[1]&&(r=1,"0"===o[0]&&(r=3),n=n.substr(0,n.length-r)),e=n),a.writeAttributeString(h,e))})}function Mt(e,t,r,n){Ue(e,t,r,n,"n","d")}function It(r,e,t,n,o){r.writeLeafElement(e+":"+t,function(){N.k(o)&&(o=!0);var e=n.x,t=n.y;N.k(e)||(o&&(e=s(e)),r.writeAttributeString("x",e)),N.k(t)||(o&&(t=s(t)),r.writeAttributeString("y",t))})}function Et(r,e,t,n,o){r.writeLeafElement(e+":"+t,function(){N.k(o)&&(o=!0);var e=n.cx,t=n.cy;N.k(e)||(o&&(e=s(e)),r.writeAttributeString("cx",e)),N.k(t)||(o&&(t=s(t)),r.writeAttributeString("cy",t))})}function Rt(e,t,r){Be(e,t,r)}function Dt(e,t,r){Be(e,t,r)}function Nt(e,t,r){Be(e,t,r)}function Ft(e,t,r){Be(e,t,r)}function _t(e,t,r){Be(e,t,r)}function Pt(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.r)||e.writeAttributeString(ke,n.r),N.k(n.g)||e.writeAttributeString("g",n.g),N.k(n.b)||e.writeAttributeString("b",n.b)},function(){qe(e,n)})}function Lt(r,e,t,n){r.writeElement(e+":"+t,function(){var e,t=n.val;N.k(t)||(e="string"==typeof t?t:yt(t),r.writeAttributeString(h,e))},function(){qe(r,n)})}function Ot(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.hue1)||e.writeAttributeString("hue",n.hue1),N.k(n.sat1)||e.writeAttributeString("sat",n.sat1),N.k(n.lum1)||e.writeAttributeString("lum",n.lum1)},function(){qe(e,n)})}function Bt(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.val)||e.writeAttributeString(h,p.Charts.ST_SystemColorVal[i.ChartHelper.ToST_SystemColorVal(n.val)]),N.k(n.lastClr)||e.writeAttributeString("lastClr",yt(n.lastClr))},function(){qe(e,n)})}function jt(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.val)||e.writeAttributeString(h,p.Charts.ST_SchemeColorVal[i.ChartHelper.ToST_SchemeColorVal(n.val)])},function(){qe(e,n)})}function Ht(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.val)||e.writeAttributeString(h,p.Charts.ST_PresetColorVal[n.val])},function(){qe(e,n)})}function Gt(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.val)||e.writeAttributeString(h,p.Charts.ST_StyleColorVal[n.val])},function(){qe(e,n)})}function Ut(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.ext,function(e){N.k(e.uri)&&(e.uri="{96DAC541-7B7A-43D3-8B79-37D633B846F1}"),Ct(t,Te,v,e)})})}function Wt(r,e,t,n,o){r.writeElement(e+":"+t,function(){if(!o){var e=n.rot;N.k(e)||0===e||r.writeAttributeString("rot",parseInt(e,10)),!0===n.flipH&&r.writeAttributeString("flipH","1"),!0===n.flipV&&r.writeAttributeString("flipV","1")}},function(){var e,t;o?(It(r,Te,"off",{x:0,y:0},!0),Et(r,Te,v,{cx:0,cy:0},!0)):(e=n.off,N.k(e)||(N.k(e.x)&&(e.x=0),N.k(e.y)&&(e.y=0),It(r,Te,"off",e,!0)),t=n.ext,N.k(t)||(N.k(t.cx)&&(t.cx=0),N.k(t.cy)&&(t.cy=0),Et(r,Te,v,t,!0)))})}function Vt(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.rot;N.k(e)||0===e||o.writeAttributeString("rot",parseInt(e,10)),!0===i.flipH&&o.writeAttributeString("flipH","1"),!0===i.flipV&&o.writeAttributeString("flipV","1")},function(){var e=i.off,t=i.ext,r=i.chOff,n=i.chExt;N.k(e)||(N.k(e.x)&&(e.x=0),N.k(e.y)&&(e.y=0),It(o,Te,"off",e,!0)),N.k(t)||(N.k(t.cx)&&(t.cx=0),N.k(t.cy)&&(t.cy=0),Et(o,Te,v,t,!0)),N.k(r)||It(o,Te,"chOff",r,!0),N.k(n)||Et(o,Te,"chExt",n,!0)})}function zt(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.x)||e.writeAttributeString("x",n.x),N.k(n.y)||e.writeAttributeString("y",n.y),N.k(n.z)||e.writeAttributeString("z",n.z)})}function qt(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.dx)||e.writeAttributeString("dx",n.dx),N.k(n.dy)||e.writeAttributeString("dy",n.dy),N.k(n.dz)||e.writeAttributeString("dz",n.dz)})}function Zt(e,t,r,n){var o=!N.k(n.lat),i=!N.k(n.lon),a=!N.k(n.rev);(o||i||a)&&e.writeLeafElement(t+":"+r,function(){o&&e.writeAttributeString("lat",n.lat),i&&e.writeAttributeString("lon",n.lon),a&&e.writeAttributeString("rev",n.rev)})}function Yt(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.l)||0===n.l||e.writeAttributeString("l",n.l),N.k(n.t)||0===n.t||e.writeAttributeString("t",n.t),N.k(n.r)||0===n.r||e.writeAttributeString(ke,n.r),N.k(n.b)||0===n.b||e.writeAttributeString("b",n.b)})}function Kt(e,t,r,n){e.writeElement(t+":"+r,function(){We(e,n)})}function Xt(r,e,t,n){r.writeLeafElement(e+":"+t,function(){var e=n.embed,t=n.name;N.k(e)||r.writeAttributeString("embed",e),Oe(t)||r.writeAttributeString(f,t),!0===n.builtIn&&r.writeAttributeString("builtIn","1")})}function Jt(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.action,t=o.tgtFrame,r=o.tooltip;n.writeAttributeString("xmlns:r",l.DrawingWriter.r),N.k(o.id)||n.writeAttributeString("id",o.id),Oe(e)||n.writeAttributeString("action",o.action),Oe(t)||n.writeAttributeString("tgtFrame",t),Oe(r)||n.writeAttributeString("tooltip",r),!1===o.history&&n.writeAttributeString("history","0"),!0===o.highlightClick&&n.writeAttributeString("highlightClick","1"),!0===o.endSnd&&n.writeAttributeString("endSnd","1")},function(){N.k(o.snd)||Xt(n,Te,"snd",o.snd),N.k(o.extLst)||Ut(n,Te,w,o.extLst)})}function Qt(e,t,r,n){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString(h,n?"1":"0")})}function $t(e,t,r,n){je(e,t,r,n,h)}function er(e,t,r,n){je(e,t,r,n,h)}function tr(e,t,r,n){je(e,t,r,n,h)}function rr(e,t,r,n){je(e,t,r,n.id,"id")}function nr(t,e,r,n){t.writeElement(e+":"+r,function(){N.k(n.uri)||t.writeAttributeString("uri",n.uri),t.writeAttributeString("xmlns:c14",l.DrawingWriter.c14)},function(){var e=n.dataObject;e&&(0===e.extDataType?Ro(t,Ne,"invertSolidFillFmt",e):1===e.extDataType?No(t,Ee,"datalabelsRange",e):2===e.extDataType&&go(t,Re,"dataDisplayOptions16",e))})}function or(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.ext,function(e){nr(t,Ne,v,e)})})}function ir(t,e,r,n,o){t.writeElement(e+":"+r,function(){N.k(o)||t.writeAttributeString("idx",o)},function(){if(!N.k(n)){var e=n.replace(/,/g,"");t.writeElementString("c:v",e)}})}function ar(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.ptCount,t=n.extLst;N.k(n.formatCode)||r.writeElementString("c:formatCode",a(n.formatCode)),N.k(e)||er(r,Ie,"ptCount",e),Xe(n.pt,function(e,t){ir(r,Ie,"pt",e,t)}),N.k(t)||or(r,Ie,w,t)})}function sr(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.numCache,t=n.extLst;N.k(n.f)||r.writeElementString("c:f",a(n.f)),N.k(e)||ar(r,Ie,"numCache",e),N.k(t)||or(r,Ie,w,t)})}function lr(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.numRef,t=n.numLit;N.k(e)||sr(r,Ie,"numRef",e),N.k(t)||ar(r,Ie,"numLit",t)})}function ur(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.idx)||e.writeAttributeString("idx",n.idx)},function(){N.k(n.v)||e.writeElementString("c:v",a(n.v))})}function cr(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.ptCount,t=n.extLst;N.k(e)||er(r,Ie,"ptCount",e),Xe(n.pt,function(e,t){ur(r,Ie,"pt",{idx:t,v:e})}),N.k(t)||or(r,Ie,w,t)})}function hr(t,e,r,n){t.writeElement(e+":"+r,function(){var e=n.extLst;N.k(n.f)||t.writeElementString("c:f",a(n.f)),N.k(e)||or(t,Ie,w,e)})}function fr(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.strRef,t=n.rich;N.k(e)||hr(r,Ie,"strRef",e),N.k(t)||bs(r,Ie,"rich",t)})}function dr(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.ptCount,t=n.extLst;N.k(e)||er(r,Ie,"ptCount",e),Xe(n.lvl,function(e){cr(r,Ie,"lvl",e)}),N.k(t)||or(r,Ie,w,t)})}function pr(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.multiLvlStrCache,t=n.extLst;N.k(n.f)||r.writeElementString("c:f",a(n.f)),N.k(e)||dr(r,Ie,"multiLvlStrCache",e),N.k(t)||or(r,Ie,w,t)})}function gr(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.multiLvlStrRef,t=a.numRef,r=a.numLit,n=a.strRef,o=a.strLit;N.k(e)||pr(i,Ie,"multiLvlStrRef",e),N.k(t)||sr(i,Ie,"numRef",t),N.k(r)||ar(i,Ie,"numLit",r),N.k(n)||hr(i,Ie,"strRef",n),N.k(o)||cr(i,Ie,"strLit",o)})}function mr(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.strRef)||hr(e,Ie,"strRef",n.strRef),N.k(n.v)||e.writeElementString("c:v",n.v)})}function br(e,t,r,n){je(e,t,r,n,h,1,p.Charts.ST_LayoutTarget)}function yr(e,t,r,n){je(e,t,r,n,h,1,p.Charts.ST_LayoutMode)}function Cr(a,e,t,s){a.writeElement(e+":"+t,function(){var e=s.layoutTarget,t=s.xMode,r=s.yMode,n=s.wMode,o=s.hMode,i=s.extLst;N.k(e)||br(a,Ie,"layoutTarget",e),N.k(t)||yr(a,Ie,"xMode",t),N.k(r)||yr(a,Ie,"yMode",r),N.k(n)||yr(a,Ie,"wMode",n),N.k(o)||yr(a,Ie,"hMode",o),N.k(s.x)||$t(a,Ie,"x",s.x),N.k(s.y)||$t(a,Ie,"y",s.y),N.k(s.w)||$t(a,Ie,"w",s.w),N.k(s.h)||$t(a,Ie,"h",s.h),N.k(i)||or(a,Ie,w,i)})}function wr(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.manualLayout,t=n.extLst;N.k(e)||Cr(r,Ie,"manualLayout",e),N.k(t)||or(r,Ie,w,t)})}function vr(a,e,t,s){a.writeElement(e+":"+t,function(){var e=s.tx,t=s.layout,r=s.overlay,n=s.spPr,o=s.txPr,i=s.extLst;N.k(e)||fr(a,Ie,"tx",e),N.k(t)||wr(a,Ie,Y,t),N.k(r)||Qt(a,Ie,"overlay",r),N.k(n)||Sa(a,Ie,B,n),N.k(o)||bs(a,Ie,j,o),N.k(i)||or(a,Ie,w,i)})}function Sr(e,t,r,n){je(e,t,r,n,h,0)}function xr(e,t,r,n){je(e,t,r,n,h)}function Tr(e,t,r,n){je(e,t,r,n,h)}function Ar(e,t,r,n){je(e,t,r,n,h)}function kr(e,t,r,n){je(e,t,r,n,h,30)}function Mr(s,e,t,l){s.writeElement(e+":"+t,function(){var e=l.rotX,t=l.hPercent,r=l.rotY,n=l.depthPercent,o=l.rAngAx,i=l.perspective,a=l.extLst;N.k(e)||Sr(s,Ie,"rotX",e),N.k(t)||xr(s,Ie,"hPercent",t),N.k(r)||Tr(s,Ie,"rotY",r),N.k(n)||Ar(s,Ie,"depthPercent",n),N.k(o)||Qt(s,Ie,"rAngAx",o),N.k(i)||kr(s,Ie,"perspective",i),N.k(a)||or(s,Ie,w,a)})}function Ir(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.thickness,t=i.spPr,r=i.pictureOptions,n=i.extLst;N.k(e)||er(o,Ie,"thickness",e),N.k(t)||Sa(o,Ie,B,t),N.k(r)||Jn(o,Ie,K,r),N.k(n)||or(o,Ie,w,n)})}function Er(s,e,t,l){s.writeElement(e+":"+t,function(){var e=l.showHorzBorder,t=l.showVertBorder,r=l.showOutline,n=l.showKeys,o=l.spPr,i=l.txPr,a=l.extLst;N.k(e)||Qt(s,Ie,"showHorzBorder",e),N.k(t)||Qt(s,Ie,"showVertBorder",t),N.k(r)||Qt(s,Ie,"showOutline",r),N.k(n)||Qt(s,Ie,"showKeys",n),N.k(o)||Sa(s,Ie,B,o),N.k(i)||bs(s,Ie,j,i),N.k(a)||or(s,Ie,w,a)})}function Rr(e,t,r,n){je(e,t,r,n,h)}function Dr(e,t,r,n){je(e,t,r,n,h,0)}function Nr(e,t,r,n){je(e,t,r,n,h,100)}function Fr(e,t,r,n){je(e,t,r,n,h,0,p.Charts.ST_SizeRepresents)}function _r(e,t,r,n){je(e,t,r,n,h,0)}function Pr(e,t,r,n){je(e,t,r,n,h)}function Lr(e,t,r,n){je(e,t,r,n,h,0,p.Charts.ST_SplitType,i.ChartHelper.ToST_SplitType)}function Or(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.secondPiePt,function(e){er(t,Ie,"secondPiePt",e)})})}function Br(e,t,r,n){je(e,t,r,n,h,75)}function jr(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.formatCode)||e.writeAttributeString("formatCode",a(n.formatCode)),!1===n.sourceLinked&&e.writeAttributeString("sourceLinked","0")})}function Hr(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_LblAlgn)}function Gr(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_DLblPos)}function Ur(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.idx,t=a.delete,r=a.layout,n=a.tx,o=a.extLst;N.k(e)||er(i,Ie,"idx",e),N.k(t)||Qt(i,Ie,L,t),N.k(r)||wr(i,Ie,Y,r),N.k(n)||fr(i,Ie,"tx",n),et(i,a),N.k(o)||Ao(i,Ie,w,o)})}function Wr(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.delete,t=i.showLeaderLines,r=i.leaderLines,n=i.extLst;Xe(i.dLbl,function(e){Ur(o,Ie,"dLbl",e)}),N.k(e)||Qt(o,Ie,L,e),et(o,i),N.k(t)||Qt(o,Ie,"showLeaderLines",t),N.k(r)||gn(o,Ie,"leaderLines",r),N.k(n)||Mo(o,Ie,w,n)})}function Vr(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_MarkerStyle,i.ChartHelper.ToST_MarkerStyle)}function zr(e,t,r,n){je(e,t,r,Math.min(72,Math.round(u.UnitHelper.pixelToPoint(n))),h)}function qr(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.symbol,t=i.size,r=i.spPr,n=i.extLst;N.k(e)||Vr(o,Ie,"symbol",e),N.k(t)||zr(o,Ie,"size",t),N.k(r)||Sa(o,Ie,B,r),N.k(n)||or(o,Ie,w,n)})}function Zr(l,e,t,u){l.writeElement(e+":"+t,function(){var e=u.idx,t=u.invertIfNegative,r=u.marker,n=u.bubble3D,o=u.explosion,i=u.spPr,a=u.pictureOptions,s=u.extLst;N.k(e)||er(l,Ie,"idx",e),N.k(t)||Qt(l,Ie,H,t),N.k(r)||qr(l,Ie,U,r),N.k(n)||Qt(l,Ie,G,n),N.k(o)||er(l,Ie,"explosion",o),N.k(i)||Sa(l,Ie,B,i),N.k(a)||Jn(l,Ie,K,a),N.k(s)||or(l,Ie,w,s)})}function Yr(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_TrendlineType)}function Kr(e,t,r,n){je(e,t,r,n,h)}function Xr(e,t,r,n){je(e,t,r,n,h)}function Jr(a,e,t,s){a.writeElement(e+":"+t,function(){var e=s.layout,t=s.tx,r=s.numFmt,n=s.spPr,o=s.txPr,i=s.extLst;N.k(e)||wr(a,Ie,Y,e),N.k(t)||fr(a,Ie,"tx",t),N.k(r)||jr(a,Ie,he,r),N.k(n)||Sa(a,Ie,B,n),N.k(o)||bs(a,Ie,j,o),N.k(i)||or(a,Ie,w,i)})}function Qr(h,e,t,f){h.writeElement(e+":"+t,function(){var e=f.spPr,t=f.trendlineType,r=f.order,n=f.period,o=f.forward,i=f.backward,a=f.intercept,s=f.dispRSqr,l=f.dispEq,u=f.trendlineLbl,c=f.extLst;N.k(f.name)||h.writeElementString("c:name",f.name),N.k(e)||Sa(h,Ie,B,e),N.k(t)||Yr(h,Ie,"trendlineType",t),N.k(r)||Kr(h,Ie,X,r),N.k(n)||Xr(h,Ie,"period",n),N.k(o)||$t(h,Ie,"forward",o),N.k(i)||$t(h,Ie,"backward",i),N.k(a)||$t(h,Ie,"intercept",a),N.k(s)||Qt(h,Ie,"dispRSqr",s),N.k(l)||Qt(h,Ie,"dispEq",l),N.k(u)||Jr(h,Ie,"trendlineLbl",u),N.k(c)||or(h,Ie,w,c)})}function $r(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_ErrDir)}function en(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_ErrBarType)}function tn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_ErrValType)}function rn(u,e,t,c){u.writeElement(e+":"+t,function(){var e=c.errDir,t=c.errBarType,r=c.errValType,n=c.noEndCap,o=c.plus,i=c.minus,a=c.val,s=c.spPr,l=c.extLst;N.k(e)||$r(u,Ie,"errDir",e),N.k(t)||en(u,Ie,"errBarType",t),N.k(r)||tn(u,Ie,"errValType",r),N.k(n)||Qt(u,Ie,"noEndCap",n),N.k(o)||lr(u,Ie,"plus",o),N.k(i)||lr(u,Ie,"minus",i),N.k(a)||$t(u,Ie,h,a),N.k(s)||Sa(u,Ie,B,s),N.k(l)||or(u,Ie,w,l)})}function nn(e,t,r,n){He(e,t,r,n,Sa,Ie,B)}function on(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.gapWidth,t=i.upBars,r=i.downBars,n=i.extLst;N.k(e)||Rr(o,Ie,J,e),N.k(t)||nn(o,Ie,"upBars",t),N.k(r)||nn(o,Ie,"downBars",r),N.k(n)||or(o,Ie,w,n)})}function an(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.cat,t=n.val;Je(r,n),N.k(e)||gr(r,Ie,"cat",e),N.k(t)||lr(r,Ie,h,t)})}function sn(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.xVal,t=n.yVal;Je(r,n),N.k(e)||gr(r,Ie,"xVal",e),N.k(t)||lr(r,Ie,"yVal",t)})}function ln(u,e,t,c){u.writeElement(e+":"+t,function(){var e=c.idx,t=c.order,r=c.tx,n=c.spPr,o=c.marker,i=c.dLbls,a=c.cat,s=c.val,l=c.extLst;N.k(e)||er(u,Ie,"idx",e),N.k(t)||er(u,Ie,X,t),N.k(r)||mr(u,Ie,"tx",r),N.k(n)||Sa(u,Ie,B,n),N.k(o)||qr(u,Ie,U,o),Xe(c.dPt,function(e){Zr(u,Ie,"dPt",e)}),N.k(i)||Wr(u,Ie,Q,i),N.k(a)||gr(u,Ie,"cat",a),N.k(s)||lr(u,Ie,h,s),N.k(l)||or(u,Ie,w,l)})}function un(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.invertIfNegative,t=n.shape;Qe(r,n),N.k(e)||Qt(r,Ie,H,e),N.k(t)||An(r,Ie,"shape",t)})}function cn(e,t,r,n){e.writeElement(t+":"+r,function(){Qe(e,n)})}function hn(u,e,t,c){u.writeElement(e+":"+t,function(){var e=c.idx,t=c.order,r=c.tx,n=c.spPr,o=c.explosion,i=c.dLbls,a=c.cat,s=c.val,l=c.extLst;N.k(e)||er(u,Ie,"idx",e),N.k(t)||er(u,Ie,X,t),N.k(r)||mr(u,Ie,"tx",r),N.k(n)||Sa(u,Ie,B,n),N.k(o)||er(u,Ie,"explosion",o),Xe(c.dPt,function(e){Zr(u,Ie,"dPt",e)}),N.k(i)||Wr(u,Ie,Q,i),N.k(a)||gr(u,Ie,"cat",a),N.k(s)||lr(u,Ie,h,s),N.k(l)||or(u,Ie,w,l)})}function fn(h,e,t,f){h.writeElement(e+":"+t,function(){var e=f.idx,t=f.order,r=f.tx,n=f.spPr,o=f.invertIfNegative,i=f.dLbls,a=f.xVal,s=f.yVal,l=f.bubbleSize,u=f.bubble3D,c=f.extLst;N.k(e)||er(h,Ie,"idx",e),N.k(t)||er(h,Ie,X,t),N.k(r)||mr(h,Ie,"tx",r),N.k(n)||Sa(h,Ie,B,n),N.k(o)||Qt(h,Ie,H,o),Xe(f.dPt,function(e){Zr(h,Ie,"dPt",e)}),N.k(i)||Wr(h,Ie,Q,i),Xe(f.trendline,function(e){Qr(h,Ie,$,e)}),Xe(f.errBars,function(e){rn(h,Ie,ee,e)}),N.k(a)||gr(h,Ie,"xVal",a),N.k(s)||lr(h,Ie,"yVal",s),N.k(l)||lr(h,Ie,"bubbleSize",l),N.k(u)||Qt(h,Ie,G,u),N.k(c)||or(h,Ie,w,c)})}function dn(s,e,t,l){s.writeElement(e+":"+t,function(){var e=l.idx,t=l.order,r=l.tx,n=l.spPr,o=l.cat,i=l.val,a=l.extLst;N.k(e)||er(s,Ie,"idx",e),N.k(t)||er(s,Ie,X,t),N.k(r)||mr(s,Ie,"tx",r),N.k(n)||Sa(s,Ie,B,n),N.k(o)||gr(s,Ie,"cat",o),N.k(i)||lr(s,Ie,h,i),N.k(a)||or(s,Ie,w,a)})}function pn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_Grouping)}function gn(e,t,r,n){He(e,t,r,n,Sa,Ie,B)}function mn(u,e,t,c){u.writeElement(e+":"+t,function(){var e=c.grouping,t=c.varyColors,r=c.dLbls,n=c.dropLines,o=c.hiLowLines,i=c.upDownBars,a=c.marker,s=c.smooth,l=c.extLst;N.k(e)||pn(u,Ie,oe,e),N.k(t)||Qt(u,Ie,ie,t),Xe(c.ser,function(e){an(u,Ie,te,e)}),N.k(r)||Wr(u,Ie,Q,r),N.k(n)||gn(u,Ie,re,n),N.k(o)||gn(u,Ie,"hiLowLines",o),N.k(i)||on(u,Ie,"upDownBars",i),N.k(a)||Qt(u,Ie,U,a),N.k(s)||Qt(u,Ie,"smooth",s),Xe(c.axId,function(e){tr(u,Ie,ne,e)}),N.k(l)||or(u,Ie,w,l)})}function bn(a,e,t,s){a.writeElement(e+":"+t,function(){var e=s.grouping,t=s.varyColors,r=s.dLbls,n=s.dropLines,o=s.gapDepth,i=s.extLst;N.k(e)||pn(a,Ie,oe,e),N.k(t)||Qt(a,Ie,ie,t),Xe(s.ser,function(e){an(a,Ie,te,e)}),N.k(r)||Wr(a,Ie,Q,r),N.k(n)||gn(a,Ie,re,n),N.k(o)||Rr(a,Ie,"gapDepth",o),Xe(s.axId,function(e){tr(a,Ie,ne,e)}),N.k(i)||or(a,Ie,w,i)})}function yn(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.dLbls,t=a.dropLines,r=a.hiLowLines,n=a.upDownBars,o=a.extLst;Xe(a.ser,function(e){an(i,Ie,te,e)}),N.k(e)||Wr(i,Ie,Q,e),N.k(t)||gn(i,Ie,re,t),N.k(r)||gn(i,Ie,"hiLowLines",r),N.k(n)||on(i,Ie,"upDownBars",n),Xe(a.axId,function(e){tr(i,Ie,ne,e)}),N.k(o)||or(i,Ie,w,o)})}function Cn(e,t,r,n){je(e,t,r,n,h,3,p.Charts.ST_ScatterStyle)}function wn(i,e,t,a){i.writeElement(e+":"+t,function(){var e,t=a.scatterStyle,r=a.varyColors,n=a.dLbls,o=a.extLst;N.k(t)||(1===(e=t)||3===e?t=2:4===e&&(t=5),Cn(i,Ie,"scatterStyle",t)),N.k(r)||Qt(i,Ie,ie,r),Xe(a.ser,function(e){sn(i,Ie,te,e)}),N.k(n)||Wr(i,Ie,Q,n),Xe(a.axId,function(e){tr(i,Ie,ne,e)}),N.k(o)||or(i,Ie,w,o)})}function vn(e,t,r,n){je(e,t,r,n,h,0,p.Charts.ST_RadarStyle)}function Sn(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.radarStyle,t=i.varyColors,r=i.dLbls,n=i.extLst;N.k(e)||vn(o,Ie,"radarStyle",e),N.k(t)||Qt(o,Ie,ie,t),Xe(i.ser,function(e){ln(o,Ie,te,e)}),N.k(r)||Wr(o,Ie,Q,r),Xe(i.axId,function(e){tr(o,Ie,ne,e)}),N.k(n)||or(o,Ie,w,n)})}function xn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_BarGrouping)}function Tn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_BarDir)}function An(e,t,r,n){je(e,t,r,n,h,2,p.Charts.ST_Shape)}function kn(s,e,t,l){s.writeElement(e+":"+t,function(){var e=l.barDir,t=l.grouping,r=l.varyColors,n=l.dLbls,o=l.gapWidth,i=l.overlap,a=l.extLst;N.k(e)||Tn(s,Ie,"barDir",e),N.k(t)||xn(s,Ie,oe,t),N.k(r)||Qt(s,Ie,ie,r),Xe(l.ser,function(e){un(s,Ie,te,e)}),N.k(n)||Wr(s,Ie,Q,n),N.k(o)||Rr(s,Ie,J,o),N.k(i)||Dr(s,Ie,"overlap",i),Xe(l.serLines,function(e){gn(s,Ie,"serLines",e)}),Xe(l.axId,function(e){tr(s,Ie,ne,e)}),N.k(a)||or(s,Ie,w,a)})}function Mn(l,e,t,u){l.writeElement(e+":"+t,function(){var e=u.barDir,t=u.grouping,r=u.varyColors,n=u.dLbls,o=u.gapWidth,i=u.gapDepth,a=u.shape,s=u.extLst;N.k(e)||Tn(l,Ie,"barDir",e),N.k(t)||xn(l,Ie,oe,t),N.k(r)||Qt(l,Ie,ie,r),Xe(u.ser,function(e){un(l,Ie,te,e)}),N.k(n)||Wr(l,Ie,Q,n),N.k(o)||Rr(l,Ie,J,o),N.k(i)||Rr(l,Ie,"gapDepth",i),N.k(a)||An(l,Ie,"shape",a),Xe(u.axId,function(e){tr(l,Ie,ne,e)}),N.k(s)||or(l,Ie,w,s)})}function In(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.grouping,t=a.varyColors,r=a.dLbls,n=a.dropLines,o=a.extLst;N.k(e)||pn(i,Ie,oe,e),N.k(t)||Qt(i,Ie,ie,t),Xe(a.ser,function(e){cn(i,Ie,te,e)}),N.k(r)||Wr(i,Ie,Q,r),N.k(n)||gn(i,Ie,re,n),Xe(a.axId,function(e){tr(i,Ie,ne,e)}),N.k(o)||or(i,Ie,w,o)})}function En(a,e,t,s){a.writeElement(e+":"+t,function(){var e=s.grouping,t=s.varyColors,r=s.dLbls,n=s.dropLines,o=s.gapDepth,i=s.extLst;N.k(e)||pn(a,Ie,oe,e),N.k(t)||Qt(a,Ie,ie,t),Xe(s.ser,function(e){cn(a,Ie,te,e)}),N.k(r)||Wr(a,Ie,Q,r),N.k(n)||gn(a,Ie,re,n),N.k(o)||Rr(a,Ie,"gapDepth",o),Xe(s.axId,function(e){tr(a,Ie,ne,e)}),N.k(i)||or(a,Ie,w,i)})}function Rn(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.varyColors,t=i.dLbls,r=i.firstSliceAng,n=i.extLst;N.k(e)||Qt(o,Ie,ie,e),Xe(i.ser,function(e){hn(o,Ie,te,e)}),N.k(t)||Wr(o,Ie,Q,t),N.k(r)||_r(o,Ie,"firstSliceAng",r),N.k(n)||or(o,Ie,w,n)})}function Dn(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.varyColors,t=o.dLbls,r=o.extLst;N.k(e)||Qt(n,Ie,ie,e),Xe(o.ser,function(e){hn(n,Ie,te,e)}),N.k(t)||Wr(n,Ie,Q,t),N.k(r)||or(n,Ie,w,r)})}function Nn(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.varyColors,t=a.dLbls,r=a.firstSliceAng,n=a.holeSize,o=a.extLst;N.k(e)||Qt(i,Ie,ie,e),Xe(a.ser,function(e){hn(i,Ie,te,e)}),N.k(t)||Wr(i,Ie,Q,t),N.k(r)||_r(i,Ie,"firstSliceAng",r),N.k(n)||Pr(i,Ie,"holeSize",n),N.k(o)||or(i,Ie,w,o)})}function Fn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_OfPieType)}function _n(u,e,t,c){u.writeElement(e+":"+t,function(){var e=c.ofPieType,t=c.varyColors,r=c.dLbls,n=c.gapWidth,o=c.splitType,i=c.splitPos,a=c.custSplit,s=c.secondPieSize,l=c.extLst;N.k(e)||Fn(u,Ie,"ofPieType",e),N.k(t)||Qt(u,Ie,ie,t),Xe(c.ser,function(e){hn(u,Ie,te,e)}),N.k(r)||Wr(u,Ie,Q,r),N.k(n)||Rr(u,Ie,J,n),N.k(o)||Lr(u,Ie,"splitType",o),N.k(i)||$t(u,Ie,"splitPos",i),N.k(a)||Or(u,Ie,"custSplit",a),N.k(s)||Br(u,Ie,"secondPieSize",s),Xe(c.serLines,function(e){gn(u,Ie,"serLines",e)}),N.k(l)||or(u,Ie,w,l)})}function Pn(s,e,t,l){s.writeElement(e+":"+t,function(){var e=l.varyColors,t=l.dLbls,r=l.bubble3D,n=l.bubbleScale,o=l.showNegBubbles,i=l.sizeRepresents,a=l.extLst;N.k(e)||Qt(s,Ie,ie,e),Xe(l.ser,function(e){fn(s,Ie,te,e)}),N.k(t)||Wr(s,Ie,Q,t),N.k(r)||Qt(s,Ie,G,r),N.k(n)||Nr(s,Ie,"bubbleScale",n),N.k(o)||Qt(s,Ie,"showNegBubbles",o),N.k(i)||Fr(s,Ie,"sizeRepresents",i),Xe(l.axId,function(e){tr(s,Ie,ne,e)}),N.k(a)||or(s,Ie,w,a)})}function Ln(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.idx)||er(e,Ie,"idx",n.idx),N.k(n.spPr)||Sa(e,Ie,B,n.spPr)})}function On(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.bandFmt,function(e){Ln(t,Ie,"bandFmt",e)})})}function Bn(e,t,r,n){Ze(e,t,r,n)}function jn(e,t,r,n){Ze(e,t,r,n)}function Hn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_AxPos)}function Gn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_Crosses,i.ChartHelper.ToST_Crosses)}function Un(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_CrossBetween)}function Wn(e,t,r,n){je(e,t,r,n,h,0,p.Charts.ST_TickMark)}function Vn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_TickLblPos)}function zn(e,t,r,n){je(e,t,r,n,h)}function qn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_TimeUnit)}function Zn(e,t,r,n){je(e,t,r,n,h)}function Yn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_BuiltInUnit,i.ChartHelper.ToST_BuiltInUnit)}function Kn(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_PictureFormat)}function Xn(e,t,r,n){je(e,t,r,n,h)}function Jn(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.applyToFront,t=a.applyToSides,r=a.applyToEnd,n=a.pictureFormat,o=a.pictureStackUnit;N.k(e)||Qt(i,Ie,"applyToFront",e),N.k(t)||Qt(i,Ie,"applyToSides",t),N.k(r)||Qt(i,Ie,"applyToEnd",r),N.k(n)||Kn(i,Ie,"pictureFormat",n),N.k(o)||Xn(i,Ie,"pictureStackUnit",o)})}function Qn(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.layout,t=i.tx,r=i.spPr,n=i.txPr;N.k(e)||wr(o,Ie,Y,e),N.k(t)||fr(o,Ie,"tx",t),N.k(r)||Sa(o,Ie,B,r),N.k(n)||bs(o,Ie,j,n)})}function $n(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.custUnit,t=a.builtInUnit,r=a.dispUnitsLbl,n=a.extLst,o=a.visible;N.k(e)?N.k(t)||Yn(i,Ie,"builtInUnit",t):$t(i,Ie,"custUnit",e),!N.k(r)&&o&&Qn(i,Ie,"dispUnitsLbl",r),N.k(n)||or(i,Ie,w,n)})}function eo(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_Orientation)}function to(e,t,r,n){je(e,t,r,n,h)}function ro(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.logBase,t=a.orientation,r=a.max,n=a.min,o=a.extLst;N.k(e)||to(i,Ie,"logBase",e),N.k(t)||eo(i,Ie,"orientation",t),N.k(r)||$t(i,Ie,"max",r),N.k(n)||$t(i,Ie,"min",n),N.k(o)||or(i,Ie,w,o)})}function no(e,t,r,n){je(e,t,r,n,h,100)}function oo(s,e,t,l){s.writeElement(e+":"+t,function(){var e=l.auto,t=l.lblAlgn,r=l.lblOffset,n=l.tickLblSkip,o=l.tickMarkSkip,i=l.noMultiLvlLbl,a=l.extLst;Ke(s,l),N.k(e)||Qt(s,Ie,"auto",e),N.k(t)||Hr(s,Ie,"lblAlgn",t),N.k(r)||no(s,Ie,"lblOffset",r),N.k(n)||zn(s,Ie,"tickLblSkip",n),N.k(o)||zn(s,Ie,"tickMarkSkip",o),N.k(i)||Qt(s,Ie,"noMultiLvlLbl",i),N.k(a)||or(s,Ie,w,a)})}function io(l,e,t,u){l.writeElement(e+":"+t,function(){var e=u.auto,t=u.lblOffset,r=u.baseTimeUnit,n=u.majorUnit,o=u.majorTimeUnit,i=u.minorUnit,a=u.minorTimeUnit,s=u.extLst;Ke(l,u),N.k(e)||Qt(l,Ie,"auto",e),N.k(t)||no(l,Ie,"lblOffset",t),N.k(r)||qn(l,Ie,"baseTimeUnit",r),N.k(n)||Zn(l,Ie,"majorUnit",n),N.k(o)||qn(l,Ie,"majorTimeUnit",o),N.k(i)||Zn(l,Ie,"minorUnit",i),N.k(a)||qn(l,Ie,"minorTimeUnit",a),N.k(s)||or(l,Ie,w,s)})}function ao(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.tickLblSkip,t=o.tickMarkSkip,r=o.extLst;Ke(n,o),N.k(e)||zn(n,Ie,"tickLblSkip",e),N.k(t)||zn(n,Ie,"tickMarkSkip",t),N.k(r)||or(n,Ie,w,r)})}function so(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.crossBetween,t=a.majorUnit,r=a.minorUnit,n=a.dispUnits,o=a.extLst;Ke(i,a),N.k(e)||Un(i,Ie,"crossBetween",e),N.k(t)||Zn(i,Ie,"majorUnit",t),N.k(r)||Zn(i,Ie,"minorUnit",r),N.k(n)||$n(i,Ie,"dispUnits",n),N.k(o)||or(i,Ie,w,o)})}function lo(u,e,t,c){u.writeElement(e+":"+t,function(){var e,t,r,n,o,i=c.layout,a=c.dTable,s=c.spPr,l=c.extLst;N.k(i)||wr(u,Ie,Y,i),Xe(c.chartGroups,function(e){var t=e.chartType;4===t?In(u,Ie,"areaChart",e):5===t?En(u,Ie,"area3DChart",e):6===t?kn(u,Ie,"barChart",e):7===t?Mn(u,Ie,"bar3DChart",e):8===t?mn(u,Ie,"lineChart",e):9===t?bn(u,Ie,"line3DChart",e):0===t?yn(u,Ie,"stockChart",e):2===t?Sn(u,Ie,"radarChart",e):1===t?wn(u,Ie,"scatterChart",e):10===t?Rn(u,Ie,"pieChart",e):11===t?Dn(u,Ie,"pie3DChart",e):12===t?Nn(u,Ie,"doughnutChart",e):13===t?_n(u,Ie,"ofPieChart",e):14===t?Bn(u,Ie,"surfaceChart",e):15===t?jn(u,Ie,"surface3DChart",e):3===t&&Pn(u,Ie,"bubbleChart",e)}),(e=c.axes)&&((t=e.filter(function(e){return 0===e.AxisGroup&&0===e.AxisType})[0])&&(0===t.axisType?oo(u,Ie,"catAx",t):1===t.axisType?io(u,Ie,"dateAx",t):3===t.axisType&&so(u,Ie,"valAx",t)),r=e.filter(function(e){return 0===e.AxisGroup&&1===e.AxisType})[0],N.k(r)||so(u,Ie,"valAx",r),n=e.filter(function(e){return 1===e.AxisGroup&&1===e.AxisType})[0],N.k(n)||so(u,Ie,"valAx",n),(o=e.filter(function(e){return 1===e.AxisGroup&&0===e.AxisType})[0])&&(0===o.axisType?oo(u,Ie,"catAx",o):1===o.axisType?io(u,Ie,"dateAx",o):3===o.axisType&&so(u,Ie,"valAx",o)),Xe(e.filter(function(e){return 2===e.axisType}),function(e){ao(u,Ie,"serAx",e)})),N.k(a)||Er(u,Ie,"dTable",a),N.k(s)||Sa(u,Ie,B,s),N.k(l)||or(u,Ie,w,l)})}function uo(a,e,t,s){a.writeElement(e+":"+t,function(){var e=s.idx,t=s.spPr,r=s.txPr,n=s.marker,o=s.dLbl,i=s.extLst;N.k(e)||er(a,Ie,"idx",e),N.k(t)||Sa(a,Ie,B,t),N.k(r)||bs(a,Ie,j,r),N.k(n)||qr(a,Ie,U,n),N.k(o)||Ur(a,Ie,"dLbl",o),N.k(i)||or(a,Ie,w,i)})}function co(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_LegendPos,i.ChartHelper.ToST_LegendPos)}function ho(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.idx,t=i.delete,r=i.txPr,n=i.extLst;N.k(e)||er(o,Ie,"idx",e),N.k(t)||Qt(o,Ie,L,t),N.k(r)||bs(o,Ie,j,r),N.k(n)||or(o,Ie,w,n)})}function fo(a,e,t,s){a.writeElement(e+":"+t,function(){var e=s.legendPos,t=s.layout,r=s.overlay||!1,n=s.spPr,o=s.txPr,i=s.extLst;N.k(e)||co(a,Ie,"legendPos",e),Xe(s.legendEntry,function(e){ho(a,Ie,"legendEntry",e)}),N.k(t)||wr(a,Ie,Y,t),Qt(a,Ie,"overlay",r),N.k(n)||Sa(a,Ie,B,n),N.k(o)||bs(a,Ie,j,o),N.k(i)||or(a,Ie,w,i)})}function po(e,t,r,n){je(e,t,r,n,h,null,p.Charts.ST_DispBlanksAs)}function go(e,t,r,n){e.writeElement(t+":"+r,function(){e.writeAttributeString("xmlns:c16",l.DrawingWriter.c16)},function(){N.k(n.dispNaAsBlank)||e.writeLeafElement(t+":dispNaAsBlank",function(){e.writeAttributeString(h,n.dispNaAsBlank?"1":"0")})})}function mo(p,e,t,g){p.writeElement(e+":"+t,function(){var o,e=g.title,t=g.autoTitleDeleted,r=g.view3D,n=g.floor,i=g.sideWall,a=g.backWall,s=g.plotArea,l=g.legend,u=g.plotVisOnly,c=g.dispBlanksAs,h=g.showDLblsOverMax,f=g.extLst,d=g.pivotFmts;N.k(e)||vr(p,Ie,ce,e),N.k(t)||Qt(p,Ie,"autoTitleDeleted",t),N.k(d)||0<(o=d.length)&&p.writeElement("c:pivotFmts",function(){var e,t,r,n;for(e=0;e<o;e++)for(t=d[e].pivotFmt,r=0;r<t.length;r++)n=t[e],N.k(n)||uo(p,Ie,"pivotFmt",n)}),N.k(r)||Mr(p,Ie,"view3D",r),N.k(n)||Ir(p,Ie,"floor",n),N.k(i)||Ir(p,Ie,"sideWall",i),N.k(a)||Ir(p,Ie,"backWall",a),N.k(s)||lo(p,Ie,"plotArea",s),N.k(l)||fo(p,Ie,"legend",l),N.k(u)||Qt(p,Ie,"plotVisOnly",u),N.k(c)||po(p,Ie,"dispBlanksAs",c),N.k(h)||Qt(p,Ie,"showDLblsOverMax",h),N.k(f)||or(p,Ie,w,f)})}function bo(e,t,r,n){je(e,t,r,n,h)}function yo(t,e,r,n){t.writeElement(e+":"+r,function(){N.k(n.name)||t.writeElementString("c:name",n.name);var e=n.fmtId;N.k(e)||er(t,Ie,"fmtId",e),Xe(n.extLst,function(e){or(t,Ie,w,e)})})}function Co(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.chartObject,t=a.data,r=a.formatting,n=a.selection,o=a.userInterface;N.k(e)||Qt(i,Ie,"chartObject",e),N.k(t)||Qt(i,Ie,"data",t),N.k(r)||Qt(i,Ie,"formatting",r),N.k(n)||Qt(i,Ie,"selection",n),N.k(o)||Qt(i,Ie,"userInterface",o)})}function wo(a,e,t,s){a.writeElement(e+":"+t,function(){!1===s.alignWithMargins&&a.writeAttributeString("alignWithMargins","0"),!0===s.differentOddEven&&a.writeAttributeString("differentOddEven","1"),!0===s.differentFirst&&a.writeAttributeString("differentFirst","1")},function(){var e=s.oddHeader,t=s.oddFooter,r=s.evenHeader,n=s.evenFooter,o=s.firstHeader,i=s.firstFooter;N.k(e)||a.writeElementString("c:oddHeader",e),N.k(t)||a.writeElementString("c:oddFooter",t),N.k(r)||a.writeElementString("c:evenHeader",r),N.k(n)||a.writeElementString("c:evenFooter",n),N.k(o)||a.writeElementString("c:firstHeader",o),N.k(i)||a.writeElementString("c:firstFooter",i)})}function vo(r,e,t,n){r.writeLeafElement(e+":"+t,function(){var e=n.header,t=n.footer;N.k(n.l)||r.writeAttributeString("l",n.l),N.k(n.r)||r.writeAttributeString(ke,n.r),N.k(n.t)||r.writeAttributeString("t",n.t),N.k(n.b)||r.writeAttributeString("b",n.b),N.k(e)||r.writeAttributeString("header",e),N.k(t)||r.writeAttributeString("footer",t)})}function So(t,e,r,n){t.writeElement(e+":"+r,function(){N.k(n.id)||t.writeAttributeString("id",n.id)},function(){var e=n.autoUpdate;N.k(e)||Qt(t,Ie,"autoUpdate",e)})}function xo(a,e,t,s){a.writeLeafElement(e+":"+t,function(){var e=s.paperSize,t=s.firstPageNumber,r=s.orientation,n=s.horizontalDpi,o=s.verticalDpi,i=s.copies;N.k(e)||1===e||a.writeAttributeString("paperSize",e),N.k(t)||1===t||a.writeAttributeString("firstPageNumber",t),N.k(r)||0===r||a.writeAttributeString("orientation",p.Charts.ST_PageSetupOrientation[r]),!0===s.blackAndWhite&&a.writeAttributeString("blackAndWhite","1"),!0===s.draft&&a.writeAttributeString("draft","1"),!0===s.useFirstPageNumber&&a.writeAttributeString("useFirstPageNumber","1"),N.k(n)||600===n||a.writeAttributeString("horizontalDpi",n),N.k(o)||600===o||a.writeAttributeString("verticalDpi",o),N.k(i)||1===i||a.writeAttributeString("copies",i)})}function To(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.headerFooter,t=i.pageMargins,r=i.pageSetup,n=i.legacyDrawingHF;N.k(e)||wo(o,Ie,"headerFooter",e),N.k(t)||vo(o,Ie,"pageMargins",t),N.k(r)||xo(o,Ie,"pageSetup",r),N.k(n)||rr(o,Ie,"legacyDrawingHF",n)})}function Ao(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.ext,function(e){ko(t,0,v,e)})})}function ko(n,e,t,o){n.writeElement("c:"+t,function(){n.writeAttributeString("xmlns:c15",l.DrawingWriter.c15),N.k(o.uri)||n.writeAttributeString("uri",o.uri)},function(){var e=o.layout,t=o.dlblFieldTable,r=o.showDataLabelsRange;N.k(e)||wr(n,Ee,Y,e),N.k(t)||Po(n,Ee,"dlblFieldTable",t),N.k(r)||Qt(n,Ee,"showDataLabelsRange",r)})}function Mo(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.ext,function(e){Io(t,0,v,e)})})}function Io(i,e,t,a){i.writeElement("c:"+t,function(){i.writeAttributeString("xmlns:c15",l.DrawingWriter.c15),N.k(a.uri)||i.writeAttributeString("uri",a.uri)},function(){var e=a.layout,t=a.showLeaderLines,r=a.showDataLabelsRange,n=a.leaderLines,o=a.spPr;N.k(e)||wr(i,Ee,Y,e),N.k(t)||Qt(i,Ee,"showLeaderLines",t),N.k(r)||Qt(i,Ee,"showDataLabelsRange",r),N.k(n)||gn(i,Ee,"leaderLines",n),N.k(o)||Sa(i,Ee,B,o)})}function Eo(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.id)||e.writeAttributeString("r:id",n.id)})}function Ro(e,t,r,n){He(e,t,r,n,Sa,Ne,B)}function Do(t,e,r,n){t.writeElement(e+":"+r,function(){var e=p.Charts.ST_ColorSchemeIndex;t.writeAttributeString("bg1",e[n.bg1]),t.writeAttributeString("tx1",e[n.tx1]),t.writeAttributeString("bg2",e[n.bg2]),t.writeAttributeString("tx2",e[n.tx2]),t.writeAttributeString("accent1",e[n.accent1]),t.writeAttributeString("accent2",e[n.accent2]),t.writeAttributeString("accent3",e[n.accent3]),t.writeAttributeString("accent4",e[n.accent4]),t.writeAttributeString("accent5",e[n.accent5]),t.writeAttributeString("accent6",e[n.accent6]),t.writeAttributeString("hlink",e[n.hlink]),t.writeAttributeString("folHlink",e[n.folHlink])},function(){N.k(n.extLst)||Ut(t,Te,w,n.extLst)})}function No(t,e,r,n){t.writeElement(e+":"+r,function(){t.writeAttributeString("xmlns:c15",l.DrawingWriter.c15)},function(){var e=n.dlblRangeCache;N.k(n.f)||t.writeElementString("c15:f",a(n.f)),N.k(e)||cr(t,Ie,"dlblRangeCache",e)})}function Fo(s,e,t,l){s.writeElement(e+":"+t,function(){var e=l.sqref,t=l.spPr,r=l.explosion,n=l.invertIfNegative,o=l.bubble3D,i=l.marker,a=l.dLbl;N.k(e)||s.writeElementString("c15:sqref",e),N.k(t)||Sa(s,Te,B,t),N.k(r)||er(s,Ie,"explosion",r),N.k(n)||Qt(s,Ie,H,n),N.k(o)||Qt(s,Ie,G,o),N.k(i)||qr(s,Ie,U,i),N.k(a)||Ur(s,Ie,"dLbl",a)})}function _o(t,e,r,n){t.writeElement(e+":"+r,function(){var e=n.dlblFieldTableCache;N.k(n.txfldGUID)||t.writeElementString("c15:txfldGUID",n.txfldGUID),N.k(n.f)||t.writeElementString("c15:f",a(n.f)),N.k(e)||cr(t,Ee,"dlblFieldTableCache",e)})}function Po(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.dlblFTEntry,function(e){_o(t,Ee,"dlblFTEntry",e)})})}function Lo(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.x)||e.writeElementString("cdr:x",n.x),N.k(n.y)||e.writeElementString("cdr:y",n.y)})}function Oo(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.startPoint,t=i.endPoint,r=i.sp,n=i.grpSp;N.k(e)||Lo(o,Ae,"from",e),N.k(t)||Lo(o,Ae,"to",t),N.k(r)||Na(o,Ae,"sp",r),N.k(n)||Ja(o,Ae,W,n),N.k(i.graphicFrame)||Ka(o,Ae,b,i.graphicFrame),N.k(i.cxnSp)||La(o,Ae,V,i.cxnSp),N.k(i.pic)||Ua(o,Ae,"pic",i.pic)})}function Bo(a,e,t,s){a.writeElement(e+":"+t,function(){a.writeAttributeString("xmlns:cdr",l.DrawingWriter.cdr)},function(){var e=s.from,t=s.ext,r=s.sp,n=s.grpSp,o=s.cxnSp,i=s.pic;N.k(e)||Lo(a,Ae,"from",e),N.k(t)||Et(a,Te,v,t,!0),N.k(r)||Da(a,Me,"sp",r),N.k(n)||Ja(a,Me,W,n),N.k(s.graphicFrame)||Ya(a,Ae,b,s.graphicFrame),N.k(o)||Pa(a,Me,V,o),N.k(i)||Wa(a,Me,"pic",i)})}function jo(e,t,r,n){e.writeElement(t+":"+r,function(){$e(e,n)},function(){N.k(n.extLst)||Ut(e,Te,w,n.extLst)})}function Ho(e,t,r,n){e.writeElement(t+":"+r,function(){$e(e,n),!0===n.noTextEdit&&e.writeAttributeString("noTextEdit","1")},function(){N.k(n.extLst)||Ut(e,Te,w,n.extLst)})}function Go(e,t,r,n){e.writeElement(t+":"+r,function(){$e(e,n),!0===n.noCrop&&e.writeAttributeString("noCrop","1")},function(){N.k(n.extLst)||Ut(e,Te,w,n.extLst)})}function Uo(e,t,r,n){e.writeElement(t+":"+r,function(){!0===n.noGrp&&e.writeAttributeString("noGrp","1"),!0===n.noUngrp&&e.writeAttributeString("noUngrp","1"),!0===n.noSelect&&e.writeAttributeString("noSelect","1"),!0===n.noRot&&e.writeAttributeString("noRot","1"),!0===n.noChangeAspect&&e.writeAttributeString("noChangeAspect","1"),!0===n.noMove&&e.writeAttributeString("noMove","1"),!0===n.noResize&&e.writeAttributeString("noResize","1")},function(){N.k(n.extLst)||Ut(e,Te,w,n.extLst)})}function Wo(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.descr,t=o.title;n.writeAttributeString("id",o.id||n.Hm++),N.k(o.name)||n.writeAttributeString(f,a(o.name)),Oe(e)||n.writeAttributeString("descr",e),Oe(t)||n.writeAttributeString(ce,t),!0===o.hidden&&n.writeAttributeString("hidden","1")},function(){var e=o.hlinkClick,t=o.hlinkHover,r=o.extLst;N.k(e)||Jt(n,Te,"hlinkClick",e),N.k(t)||Jt(n,Te,"hlinkHover",t),N.k(r)||Ut(n,Te,w,r)})}function Vo(r,e,t,n){r.writeElement(e+":"+t,function(){!0===n.txBox&&r.writeAttributeString("txBox","1")},function(){var e=n.spLocks,t=n.extLst;N.k(e)||Ho(r,Te,"spLocks",e),N.k(t)||Ut(r,Te,w,t)})}function zo(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.cxnSpLocks,t=i.stCxn,r=i.endCxn,n=i.extLst;N.k(e)||jo(o,Te,"cxnSpLocks",e),N.k(t)||ia(o,Te,"stCxn",t),N.k(r)||ia(o,Te,"endCxn",r),N.k(n)||Ut(o,Te,w,n)})}function qo(r,e,t,n){r.writeElement(e+":"+t,function(){!1===n.preferRelativeResize&&r.writeAttributeString("preferRelativeResize","0")},function(){var e=n.picLocks,t=n.extLst;N.k(e)||Go(r,Te,"picLocks",e),N.k(t)||Ut(r,Te,w,t)})}function Zo(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.grpSpLocks,t=n.extLst;N.k(e)||Uo(r,Te,"grpSpLocks",e),N.k(t)||Ut(r,Te,w,t)})}function Yo(e,t,r){e.writeLeafElement(t+":"+r)}function Ko(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){o?e.writeAttributeString("xmlns:"+t,Le.cx):e.writeAttributeString("xmlns:"+t,l.DrawingWriter.c),e.writeAttributeString("xmlns:r",l.DrawingWriter.r),N.k(n.id)||e.writeAttributeString("r:id",n.id)})}function Xo(t,e,r,n,o){t.writeElement(e+":"+r,function(){var e=o?Le.cx:l.DrawingWriter.c;t.writeAttributeString("uri",e)},function(){N.k(n.chart)||Ko(t,o?_e:Ie,"chart",n.chart,o)})}function Jo(t,e,r,n,o){t.writeElement(e+":"+r,function(){var e=n.graphicData;N.k(e)||Xo(t,Te,"graphicData",e,o)})}function Qo(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.prst)||e.writeAttributeString(d,p.Charts.ST_PresetCameraType[i.ChartHelper.ToST_PresetCameraType(n.prst)]),N.k(n.fov)||0===n.fov||e.writeAttributeString("fov",n.fov),N.k(n.zoom)||1e5===n.zoom||e.writeAttributeString("zoom",n.zoom)},function(){N.k(n.rot)||Zt(e,Te,"rot",n.rot)})}function $o(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.rig)||e.writeAttributeString("rig",p.Charts.ST_LightRigType[n.rig]),N.k(n.dir)||e.writeAttributeString("dir",p.Charts.ST_LightRigDirection[i.ChartHelper.ToST_LightRigDirection(n.dir)])},function(){N.k(n.rot)||Zt(e,Te,"rot",n.rot)})}function ei(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.camera,t=i.lightRig,r=i.backdrop,n=i.extLst;N.k(e)||Qo(o,Te,"camera",e),N.k(t)||$o(o,Te,"lightRig",t),N.k(r)||ti(o,Te,"backdrop",r),N.k(n)||Ut(o,Te,w,n)})}function ti(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.anchor,t=i.norm,r=i.up,n=i.extLst;N.k(e)||zt(o,Te,"anchor",e),N.k(t)||qt(o,Te,"norm",t),N.k(r)||qt(o,Te,"up",r),N.k(n)||Ut(o,Te,w,n)})}function ri(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.w)||76200===n.w||e.writeAttributeString("w",n.w),N.k(n.h)||76200===n.h||e.writeAttributeString("h",n.h),N.k(n.prst)||1===n.prst||e.writeAttributeString(d,p.Charts.ST_BevelPresetType[n.prst])})}function ni(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.z,t=a.extrusionH,r=a.contourW,n=a.prstMaterial;N.k(e)||0===e||i.writeAttributeString("z",s(e)),N.k(t)||0===t||i.writeAttributeString("extrusionH",s(t)),N.k(r)||0===r||i.writeAttributeString("contourW",s(r)),N.k(n)||7===n||i.writeAttributeString("prstMaterial",p.Charts.ST_PresetMaterialType[n])},function(){var e=a.bevelT,t=a.bevelB,r=a.extrusionClr,n=a.contourClr,o=a.extLst;N.k(e)||ri(i,Te,"bevelT",e),N.k(t)||ri(i,Te,"bevelB",t),N.k(r)||Kt(i,Te,"extrusionClr",r),N.k(n)||Kt(i,Te,"contourClr",n),N.k(o)||Ut(i,Te,w,o)})}function oi(e,t,r,n){je(e,t,r,n.z,"z",0)}function ii(e,t,r,n){je(e,t,r,n.thresh,"thresh")}function ai(e,t,r){Be(e,t,r)}function si(e,t,r){Be(e,t,r)}function li(e,t,r,n){e.writeElement(t+":"+r,function(){We(e,n)})}function ui(e,t,r,n){je(e,t,r,n.amt,"amt",1e5)}function ci(e,t,r,n){je(e,t,r,n.rad,"rad",0)}function hi(e,t,r,n){je(e,t,r,n[Te],Te)}function fi(e,t,r,n){je(e,t,r,n.thresh,"thresh")}function di(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.rad)||0===n.rad||e.writeAttributeString("rad",n.rad),!1===n.grow&&e.writeAttributeString("grow","0")})}function pi(e,t,r,n){e.writeElement(t+":"+r,function(){!1===n.useA&&e.writeAttributeString("useA","0")},function(){N.k(n.clrFrom)||Kt(e,Te,"clrFrom",n.clrFrom),N.k(n.clrTo)||Kt(e,Te,"clrTo",n.clrTo)})}function gi(e,t,r,n){e.writeElement(t+":"+r,function(){We(e,n)})}function mi(a,e,t,s){a.writeElement(e+":"+t,function(){var e=s.scrgbClr,t=s.hslClr,r=s.sysClr,n=s.schemeClr,o=s.prstClr,i=s.srgbClr;N.k(e)||Pt(a,Te,S,e),N.k(t)||Ot(a,Te,T,t),N.k(r)||Bt(a,Te,A,r),N.k(n)||jt(a,Te,k,n),N.k(o)||Ht(a,Te,M,o),N.k(i)||Lt(a,Te,x,i)})}function bi(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.rad)||0===n.rad||e.writeAttributeString("rad",n.rad)},function(){We(e,n)})}function yi(e,t,r){Be(e,t,r)}function Ci(n,e,t,o){n.writeLeafElement(e+":"+t,function(){var e=o.hue,t=o.sat,r=o.lum;N.k(e)||0===e||n.writeAttributeString("hue",e),N.k(t)||0===t||n.writeAttributeString("sat",t),N.k(r)||0===r||n.writeAttributeString("lum",r)})}function wi(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.blurRad,t=o.dist,r=o.dir;N.k(e)||0===e||n.writeAttributeString("blurRad",e),N.k(t)||0===t||n.writeAttributeString("dist",t),N.k(r)||0===r||n.writeAttributeString("dir",r)},function(){We(n,o)})}function vi(r,e,t,n){r.writeLeafElement(e+":"+t,function(){var e=n.bright,t=n.contrast;N.k(e)||0===e||r.writeAttributeString("bright",e),N.k(t)||0===t||r.writeAttributeString("contrast",t)})}function Si(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.blurRad,t=o.dist,r=o.dir;N.k(e)||0===e||n.writeAttributeString("blurRad",e),N.k(t)||0===t||n.writeAttributeString("dist",t),N.k(r)||0===r||n.writeAttributeString("dir",r),tt(n,o)},function(){We(n,o)})}function xi(r,e,t,n){r.writeElement(e+":"+t,function(){N.k(n.prst)||r.writeAttributeString(d,p.Charts.ST_PresetShadowVal[i.ChartHelper.ToST_PresetShadowVal(n.prst)]);var e=n.dist,t=n.dir;N.k(e)||0===e||r.writeAttributeString("dist",e),N.k(t)||0===t||r.writeAttributeString("dir",t)},function(){We(r,n)})}function Ti(l,e,t,u){l.writeLeafElement(e+":"+t,function(){var e=u.blurRad,t=u.stA,r=u.stPos,n=u.endA,o=u.endPos,i=u.dist,a=u.dir,s=u.fadeDir;N.k(e)||0===e||l.writeAttributeString("blurRad",e),N.k(t)||1e5===t||l.writeAttributeString("stA",t),N.k(r)||0===r||l.writeAttributeString("stPos",r),N.k(n)||0===n||l.writeAttributeString("endA",n),N.k(o)||1e5===o||l.writeAttributeString("endPos",o),N.k(i)||0===i||l.writeAttributeString("dist",i),N.k(a)||0===a||l.writeAttributeString("dir",a),N.k(s)||54e5===s||l.writeAttributeString("fadeDir",s),tt(l,u)})}function Ai(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.tx)||0===n.tx||e.writeAttributeString("tx",n.tx),N.k(n.ty)||0===n.ty||e.writeAttributeString("ty",n.ty)})}function ki(e,t,r,n){je(e,t,r,n.rad,"rad")}function Mi(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.hue)||0===n.hue||e.writeAttributeString("hue",n.hue),N.k(n.amt)||0===n.amt||e.writeAttributeString("amt",n.amt)})}function Ii(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.sx)||1e5===n.sx||e.writeAttributeString("sx",n.sx),N.k(n.sy)||1e5===n.sy||e.writeAttributeString("sy",n.sy),N.k(n.kx)||0===n.kx||e.writeAttributeString("kx",n.kx),N.k(n.ky)||0===n.ky||e.writeAttributeString("ky",n.ky),N.k(n.tx)||0===n.tx||e.writeAttributeString("tx",n.tx),N.k(n.ty)||0===n.ty||e.writeAttributeString("ty",n.ty)})}function Ei(e,t,r){Be(e,t,r)}function Ri(e,t,r,n){e.writeElement(t+":"+r,function(){We(e,n)})}function Di(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.ang)||e.writeAttributeString("ang",n.ang),N.k(n.scaled)||e.writeAttributeString("scaled",n.scaled?"1":"0")})}function Ni(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.path)||e.writeAttributeString("path",p.Charts.ST_PathShadeType[n.path])},function(){N.k(n.fillToRect)||Yt(e,Te,"fillToRect",n.fillToRect)})}function Fi(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.pos)||e.writeAttributeString("pos",n.pos.toFixed(0))},function(){We(e,n)})}function _i(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.gs,function(e){Fi(t,Te,"gs",e)})})}function Pi(o,e,t,i){o.writeElement(e+":"+t,function(){N.k(i.flip)||o.writeAttributeString("flip",p.Charts.ST_TileFlipMode[i.flip]),!1===i.rotWithShape&&o.writeAttributeString(ye,"0")},function(){var e=i.gsLst,t=i.lin,r=i.path,n=i.tileRect;N.k(e)||_i(o,Te,"gsLst",e),N.k(t)||Di(o,Te,"lin",t),N.k(r)||Ni(o,Te,"path",r),N.k(n)||Yt(o,Te,"tileRect",n)})}function Li(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.tx)||e.writeAttributeString("tx",s(n.tx)),N.k(n.ty)||e.writeAttributeString("ty",s(n.ty)),N.k(n.sx)||e.writeAttributeString("sx",n.sx),N.k(n.sy)||e.writeAttributeString("sy",n.sy),N.k(n.flip)||e.writeAttributeString("flip",p.Charts.ST_TileFlipMode[n.flip]),N.k(n.algn)||e.writeAttributeString("algn",p.Charts.ST_RectAlignment[n.algn])})}function Oi(e,t,r,n){He(e,t,r,n,Yt,Te,"fillRect")}function Bi(y,e,t,C){y.writeElement(e+":"+t,function(){y.writeAttributeString("xmlns:r",l.DrawingWriter.r),N.k(C.embed)||""===C.embed||y.writeAttributeString("r:embed",C.embed);var e=C.link,t=C.cstate;Oe(e)||y.writeAttributeString("link",e),N.k(t)||4===t||y.writeAttributeString("cstate",p.Charts.ST_BlipCompression[t])},function(){var e=C.alphaBiLevel,t=C.alphaCeiling,r=C.alphaFloor,n=C.alphaInv,o=C.alphaMod,i=C.alphaModFix,a=C.alphaRepl,s=C.biLevel,l=C.blur,u=C.clrChange,c=C.clrRepl,h=C.duotone,f=C.fillOverlay,d=C.grayscl,p=C.hsl,g=C.lum,m=C.tint,b=C.extLst;N.k(e)||ii(y,Te,"alphaBiLevel",e),N.k(t)||ai(y,Te,"alphaCeiling"),N.k(r)||si(y,Te,"alphaFloor"),N.k(n)||li(y,Te,"alphaInv",n),N.k(o)||Zi(y,Te,"alphaMod",o),N.k(i)||ui(y,Te,"alphaModFix",i),N.k(a)||hi(y,Te,"alphaRepl",a),N.k(s)||fi(y,Te,"biLevel",s),N.k(l)||di(y,Te,"blur",l),N.k(u)||pi(y,Te,"clrChange",u),N.k(c)||gi(y,Te,"clrRepl",c),N.k(h)||mi(y,Te,"duotone",h),N.k(f)||Vi(y,Te,"fillOverlay",f),N.k(d)||yi(y,Te,"grayscl"),N.k(p)||Ci(y,Te,"hsl",p),N.k(g)||vi(y,Te,"lum",g),N.k(m)||Mi(y,Te,"tint",m),N.k(C.blipBlob),N.k(b)||Ut(y,Te,w,b)})}function ji(o,e,t,i){o.writeElement(e+":"+t,function(){N.k(i.dpi)||o.writeAttributeString("dpi",i.dpi),N.k(i.rotWithShape)||o.writeAttributeString(ye,i.rotWithShape?"1":"0")},function(){var e=i.blip,t=i.srcRect,r=i.tile,n=i.stretch;N.k(e)||Bi(o,Te,"blip",e),N.k(t)||Yt(o,Te,"srcRect",t),N.k(r)||Li(o,Te,"tile",r),N.k(n)||Oi(o,Te,"stretch",n)})}function Hi(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.prst)||e.writeAttributeString(d,p.Charts.ST_PresetPatternVal[i.ChartHelper.ToST_PresetPatternVal(parseInt(n.prst,10))])},function(){N.k(n.fgClr)||Kt(e,Te,"fgClr",n.fgClr),N.k(n.bgClr)||Kt(e,Te,"bgClr",n.bgClr)})}function Gi(e,t,r){Be(e,t,r)}function Ui(e,t,r,n){e.writeElement(t+":"+r,function(){Ve(e,n)})}function Wi(e,t,r,n){e.writeElement(t+":"+r,function(){Ve(e,n)})}function Vi(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.blend)||e.writeAttributeString("blend",p.Charts.ST_BlendMode[n.blend])},function(){Ve(e,n)})}function zi(e,t,r,n){je(e,t,r,n.ref,"ref")}function qi(R,e,t,D){R.writeElement(e+":"+t,function(){var e=D.type,t=D.name;N.k(e)||0===e||R.writeAttributeString(o,p.Charts.ST_EffectContainerType[e]),N.k(t)||R.writeAttributeString(f,t)},function(){var e=D.cont,t=D.effect,r=D.alphaBiLevel,n=D.alphaCeiling,o=D.alphaFloor,i=D.alphaInv,a=D.alphaMod,s=D.alphaModFix,l=D.alphaOutset,u=D.alphaRepl,c=D.biLevel,h=D.blend,f=D.blur,d=D.clrChange,p=D.clrRepl,g=D.duotone,m=D.fill,b=D.fillOverlay,y=D.glow,C=D.grayscl,w=D.hsl,v=D.innerShdw,S=D.lum,x=D.outerShdw,T=D.prstShdw,A=D.reflection,k=D.relOff,M=D.softEdge,I=D.tint,E=D.xfrm;N.k(e)||qi(R,Te,"cont",e),N.k(t)||zi(R,Te,"effect",t),N.k(r)||ii(R,Te,"alphaBiLevel",r),N.k(n)||ai(R,Te,"alphaCeiling"),N.k(o)||si(R,Te,"alphaFloor"),N.k(i)||li(R,Te,"alphaInv",i),N.k(a)||Zi(R,Te,"alphaMod",a),N.k(s)||ui(R,Te,"alphaModFix",s),N.k(l)||ci(R,Te,"alphaOutset",l),N.k(u)||hi(R,Te,"alphaRepl",u),N.k(c)||fi(R,Te,"biLevel",c),N.k(h)||Yi(R,Te,"blend",h),N.k(f)||di(R,Te,"blur",f),N.k(d)||pi(R,Te,"clrChange",d),N.k(p)||gi(R,Te,"clrRepl",p),N.k(g)||mi(R,Te,"duotone",g),N.k(m)||Wi(R,Te,"fill",m),N.k(b)||Vi(R,Te,"fillOverlay",b),N.k(y)||bi(R,Te,"glow",y),N.k(C)||yi(R,Te,"grayscl"),N.k(w)||Ci(R,Te,"hsl",w),N.k(v)||wi(R,Te,"innerShdw",v),N.k(S)||vi(R,Te,"lum",S),N.k(x)||Si(R,Te,"outerShdw",x),N.k(T)||xi(R,Te,"prstShdw",T),N.k(A)||Ti(R,Te,"reflection",A),N.k(k)||Ai(R,Te,"relOff",k),N.k(M)||ki(R,Te,"softEdge",M),N.k(I)||Mi(R,Te,"tint",I),N.k(E)||Ii(R,Te,"xfrm",E)})}function Zi(e,t,r,n){He(e,t,r,n,qi,Te,"cont")}function Yi(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.blend)||e.writeAttributeString("blend",p.Charts.ST_BlendMode[n.blend])},function(){N.k(n.cont)||qi(e,Te,"cont",n.cont)})}function Ki(l,e,t,u){l.writeElement(e+":"+t,function(){var e=u.blur,t=u.fillOverlay,r=u.glow,n=u.innerShdw,o=u.outerShdw,i=u.prstShdw,a=u.reflection,s=u.softEdge;N.k(e)||di(l,Te,"blur",e),N.k(t)||Vi(l,Te,"fillOverlay",t),N.k(r)||bi(l,Te,"glow",r),N.k(n)||wi(l,Te,"innerShdw",n),N.k(o)||Si(l,Te,"outerShdw",o),N.k(i)||xi(l,Te,"prstShdw",i),N.k(a)||Ti(l,Te,"reflection",a),N.k(s)||ki(l,Te,"softEdge",s)})}function Xi(e,t,r,n){Ue(e,t,r,n,f,"fmla")}function Ji(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.gd,function(e){Xi(t,Te,"gd",e)})})}function Qi(e,t,r,n){Ue(e,t,r,n,"x","y")}function $i(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.l)||e.writeAttributeString("l",n.l),N.k(n.t)||e.writeAttributeString("t",n.t),N.k(n.r)||e.writeAttributeString(ke,n.r),N.k(n.b)||e.writeAttributeString("b",n.b)})}function ea(a,e,t,s){a.writeElement(e+":"+t,function(){var e=s.gdRefX,t=s.minX,r=s.maxX,n=s.gdRefY,o=s.minY,i=s.maxY;N.k(e)||a.writeAttributeString("gdRefX",e),N.k(t)||a.writeAttributeString("minX",t),N.k(r)||a.writeAttributeString("maxX",r),N.k(n)||a.writeAttributeString("gdRefY",n),N.k(o)||a.writeAttributeString("minY",o),N.k(i)||a.writeAttributeString("maxY",i)},function(){N.k(s.pos)||Qi(a,Te,"pos",s.pos)})}function ta(a,e,t,s){a.writeElement(e+":"+t,function(){var e=s.gdRefR,t=s.minR,r=s.maxR,n=s.gdRefAng,o=s.minAng,i=s.maxAng;N.k(e)||a.writeAttributeString("gdRefR",e),N.k(t)||a.writeAttributeString("minR",t),N.k(r)||a.writeAttributeString("maxR",r),N.k(n)||a.writeAttributeString("gdRefAng",n),N.k(o)||a.writeAttributeString("minAng",o),N.k(i)||a.writeAttributeString("maxAng",i)},function(){N.k(s.pos)||Qi(a,Te,"pos",s.pos)})}function ra(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.ang)||e.writeAttributeString("ang",n.ang)},function(){N.k(n.pos)||Qi(e,Te,"pos",n.pos)})}function na(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.ahXY)||ea(e,Te,"ahXY",n.ahXY),N.k(n.ahPolar)||ta(e,Te,"ahPolar",n.ahPolar)})}function oa(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.cxn,function(e){ra(t,Te,"cxn",e)})})}function ia(e,t,r,n){Ue(e,t,r,n,"id","idx")}function aa(o,e,t,i){o.writeLeafElement(e+":"+t,function(){var e=i.wR,t=i.hR,r=i.stAng,n=i.swAng;N.k(e)||o.writeAttributeString("wR",e),N.k(t)||o.writeAttributeString("hR",t),N.k(r)||o.writeAttributeString("stAng",r),N.k(n)||o.writeAttributeString("swAng",n)})}function sa(e,t,r){Be(e,t,r)}function la(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.w,t=o.h,r=o.fill;N.k(e)||0===e||n.writeAttributeString("w",e),N.k(t)||0===t||n.writeAttributeString("h",t),N.k(r)||1===r||n.writeAttributeString("fill",p.Charts.ST_PathFillMode[r]),!1===o.stroke&&n.writeAttributeString("stroke","0"),!1===o.extrusionOk&&n.writeAttributeString("extrusionOk","0")},function(){Xe(o.pathToList,function(e){if(e.typeName===p.Charts.CT_PathType.CT_Path2DClose)sa(n,Te,"close");else if(e.typeName===p.Charts.CT_PathType.CT_PathToList){switch(e.pathToType){case 0:ua(n,Te,"lnTo",e);break;case 1:ua(n,Te,"moveTo",e);break;case 2:ua(n,Te,"quadBezTo",e);break;case 3:ua(n,Te,"cubicBezTo",e)}}else e.typeName===p.Charts.CT_PathType.CT_Path2DArcTo&&aa(n,Te,"arcTo",e)})})}function ua(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.PtList,function(e){Qi(t,Te,"pt",e)})})}function ca(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n,function(e){la(t,Te,"path",e)})})}function ha(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.prst)||e.writeAttributeString(d,p.Charts.ST_ShapeType[n.prst])},function(){N.k(n.avLst)||Ji(e,Te,"avLst",n.avLst)})}function fa(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.prst)||e.writeAttributeString(d,p.Charts.ST_TextShapeType[n.prst])},function(){N.k(n.avLst)||Ji(e,Te,"avLst",n.avLst)})}function da(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.avLst,t=a.gdLst,r=a.ahLst,n=a.cxnLst,o=a.rect;N.k(e)||Ji(i,Te,"avLst",e),N.k(t)||Ji(i,Te,"gdLst",t),N.k(r)||na(i,Te,"ahLst",r),N.k(n)||oa(i,Te,"cxnLst",n),N.k(o)||$i(i,Te,"rect",o),ca(i,Te,"pathLst",a.pathLst)})}function pa(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.type)||e.writeAttributeString(o,p.Charts.ST_LineEndType[n.type]),N.k(n.w)||e.writeAttributeString("w",p.Charts.ST_LineEndWidth[n.w]),N.k(n.len)||e.writeAttributeString("len",p.Charts.ST_LineEndLength[n.len])})}function ga(e,t,r){Be(e,t,r)}function ma(e,t,r){Be(e,t,r)}function ba(e,t,r,n){je(e,t,r,n.lim,"lim")}function ya(e,t,r,n){je(e,t,r,n,h,c,p.Charts.ST_PresetLineDashVal,i.ChartHelper.ToST_PresetLineDashVal)}function Ca(e,t,r,n){Ue(e,t,r,n,"d","sp")}function wa(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.ds,function(e){Ca(t,Te,"ds",e)})})}function va(f,e,t,d){d.w<=0&&(d.noFill=!0),f.writeElement(e+":"+t,function(){!N.k(d.w)&&0<=d.w&&f.writeAttributeString("w",s(d.w)),N.k(d.cap)||f.writeAttributeString("cap",p.Charts.ST_LineCap[d.cap]),N.k(d.cmpd)||f.writeAttributeString("cmpd",p.Charts.ST_CompoundLine[d.cmpd]),N.k(d.algn)||f.writeAttributeString("algn",p.Charts.ST_PenAlignment[d.algn])},function(){var e=d.noFill,t=d.solidFill,r=d.gradFill,n=d.pattFill,o=d.prstDash,i=d.custDash,a=d.round,s=d.bevel,l=d.miter,u=d.headEnd,c=d.tailEnd,h=d.extLst;N.k(e)?N.k(t)?N.k(r)?N.k(n)||Hi(f,Te,_,n):Pi(f,Te,D,r):Ri(f,Te,R,t):Ei(f,Te,E),N.k(o)?N.k(i)||wa(f,Te,"custDash",i):ya(f,Te,"prstDash",o),N.k(a)||ma(f,Te,"round"),N.k(s)||ga(f,Te,"bevel"),N.k(l)||ba(f,Te,"miter",l),N.k(u)||pa(f,Te,"headEnd",u),N.k(c)||pa(f,Te,"tailEnd",c),N.k(h)||Ut(f,Te,w,h)})}function Sa(g,e,t,m,b){g.writeElement(e+":"+t,function(){var e=m.bwMode;N.k(e)||0===e||g.writeAttributeString("bwMode",p.Charts.ST_BlackWhiteMode[e])},function(){var e=m.xfrm,t=m.custGeom,r=m.prstGeom,n=m.noFill,o=m.solidFill,i=m.gradFill,a=m.blipFill,s=m.pattFill,l=m.grpFill,u=m.ln,c=m.effectLst,h=m.effectDag,f=m.scene3d,d=m.sp3d,p=m.extLst;N.k(b)&&(b=!0),Wt(g,Te,"xfrm",e,b),N.k(t)?N.k(r)||ha(g,Te,"prstGeom",r):da(g,Te,"custGeom",t),N.k(n)?N.k(o)?N.k(i)?N.k(a)?N.k(s)?N.k(l)||Gi(g,Te,P):Hi(g,Te,_,s):ji(g,Te,F,a):Pi(g,Te,D,i):Ri(g,Te,R,o):Ei(g,Te,E),N.k(u)||va(g,Te,"ln",u),N.k(c)||Ki(g,Te,y,c),N.k(h)||qi(g,Te,C,h),N.k(f)||ei(g,Te,O,f),N.k(d)||ni(g,Te,"sp3d",d),N.k(p)||Ut(g,Te,w,p)})}function xa(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.bwMode;N.k(e)||0===e||i.writeAttributeString("bwMode",p.Charts.ST_BlackWhiteMode[e])},function(){var e=a.xfrm,t=a.scene3d,r=a.extLst,n=a.effectLst,o=a.effectDag;N.k(e)||Vt(i,Te,"xfrm",e),Ve(i,a),N.k(n)||Ki(i,Te,y,n),N.k(o)||qi(i,Te,C,o),N.k(t)||ei(i,Te,O,t),N.k(r)||Ut(i,Te,w,r)})}function Ta(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.idx)||e.writeAttributeString("idx",n.idx)},function(){n.ColorProp&&We(e,n.ColorProp)})}function Aa(t,e,r,n){t.writeElement(e+":"+r,function(){N.k(n.idx)||t.writeAttributeString("idx",p.Charts.ST_FontCollectionIndex[n.idx])},function(){var e=n.TextCharacterProperties.solidFill;e&&We(t,e)})}function ka(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.lnRef,t=i.fillRef,r=i.effectRef,n=i.fontRef;N.k(e)||Ta(o,Te,"lnRef",e),N.k(t)||Ta(o,Te,"fillRef",t),N.k(r)||Ta(o,Te,"effectRef",r),N.k(n)||Aa(o,Te,"fontRef",n)})}function Ma(e,t,r,n){e.writeLeafElement(t+":"+r,function(){!1===n.fLocksWithSheet&&e.writeAttributeString("fLocksWithSheet","0"),!1===n.fPrintsWithSheet&&e.writeAttributeString("fPrintsWithSheet","0")})}function Ia(e,t,r,n){nt(e,t,r,n,t)}function Ea(e,t,r,n){nt(e,t,r,n,Ae)}function Ra(e,t,r,n){nt(e,t,r,n,Me)}function Da(e,t,r,n){rt(e,t,r,n,t,Ia)}function Na(e,t,r,n){rt(e,t,r,n,Ae,Ea)}function Fa(e,t,r,n){rt(e,t,r,n,Me,Ra)}function _a(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.cNvPr,t=n.cNvCxnSpPr;N.k(e)||Wo(r,Me,g,e),N.k(t)||zo(r,Me,"cNvCxnSpPr",t)})}function Pa(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.macro;N.k(e)||n.writeAttributeString(m,e),!0===o.fPublished&&n.writeAttributeString(r,"1")},function(){var e=o.nvCxnSpPr,t=o.spPr,r=o.style;N.k(e)||_a(n,Me,"nvCxnSpPr",e),N.k(t)||Sa(n,Me,B,t,!1),N.k(r)||ka(n,Me,be,r)})}function La(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.macro;N.k(e)||n.writeAttributeString(m,e),!0===o.fPublished&&n.writeAttributeString(r,"1")},function(){var e=o.nvCxnSpPr,t=o.spPr,r=o.style;N.k(e)||_a(n,Ae,"nvCxnSpPr",e),N.k(t)||Sa(n,Ae,B,t,!1),N.k(r)||ka(n,Ae,be,r)})}function Oa(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.cNvPr,t=n.cNvPicPr;N.k(e)||Wo(r,Me,g,e),N.k(t)||qo(r,Me,Ce,t)})}function Ba(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.cNvPr,t=n.cNvPicPr;N.k(e)||Wo(r,Te,g,e),N.k(t)||qo(r,Te,Ce,t)})}function ja(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.cNvPr,t=n.cNvPicPr;N.k(e)||Wo(r,Ae,g,e),N.k(t)||qo(r,Ae,Ce,t)})}function Ha(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.cNvPr,t=n.cNvPicPr;N.k(e)||Wo(r,Me,g,e),N.k(t)||qo(r,Me,Ce,t)})}function Ga(o,e,t,i){o.writeElement(e+":"+t,function(){Oe(i.macro)||o.writeAttributeString(m,i.macro),!0===i.fPublished&&o.writeAttributeString(r,"1")},function(){var e=i.nvPicPr,t=i.blipFill,r=i.spPr,n=i.style;N.k(e)||Oa(o,Me,we,e),N.k(t)||ji(o,Me,F,t),N.k(r)||Sa(o,Me,B,r),N.k(n)||ka(o,Te,be,n)})}function Ua(o,e,t,i){o.writeElement(e+":"+t,function(){Oe(i.macro)||o.writeAttributeString(m,i.macro),!0===i.fPublished&&o.writeAttributeString(r,"1")},function(){var e=i.nvPicPr,t=i.blipFill,r=i.spPr,n=i.style;N.k(e)||ja(o,Ae,we,e),N.k(t)||ji(o,Ae,F,t),N.k(r)||Sa(o,Ae,B,r),N.k(n)||ka(o,Ae,be,n)})}function Wa(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.macro;Oe(e)||o.writeAttributeString(m,e),!0===i.fPublished&&o.writeAttributeString(r,"1")},function(){var e=i.nvPicPr,t=i.blipFill,r=i.spPr,n=i.style;N.k(e)||Ba(o,Me,we,e),N.k(t)||ji(o,Te,F,t),N.k(r)||Sa(o,Te,B,r),N.k(n)||ka(o,Te,be,n)})}function Va(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.macro;Oe(e)||o.writeAttributeString(m,e),!0===i.fPublished&&o.writeAttributeString(r,"1")},function(){var e=i.nvPicPr,t=i.blipFill,r=i.spPr,n=i.style;N.k(e)||Ba(o,Me,we,e),N.k(t)||ji(o,Me,F,t),N.k(r)||Sa(o,Me,B,r),N.k(n)||ka(o,Te,be,n)})}function za(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.macro;Oe(e)||o.writeAttributeString(m,e),!0===i.fPublished&&o.writeAttributeString(r,"1")},function(){var e=i.nvPicPr,t=i.blipFill,r=i.spPr,n=i.style;N.k(e)||Ha(o,Me,we,e),N.k(t)||ji(o,Me,F,t),N.k(r)||Sa(o,Me,B,r),N.k(n)||ka(o,Me,be,n)})}function qa(e,t,r,n){Ye(e,t,r,n,Me)}function Za(e,t,r,n){Ye(e,t,r,n,Ae)}function Ya(r,e,t,n,o){r.writeElement(e+":"+t,function(){r.writeAttributeString(m,"")},function(){var e=n.nvGraphicFramePr,t=n.graphic;N.k(e)||qa(r,Me,"nvGraphicFramePr",e),Wt(r,Me,"xfrm",c,!0),N.k(t)||Jo(r,Te,"graphic",t,o)})}function Ka(n,e,t,o){n.writeElement(e+":"+t,function(){N.k(o.macro)||n.writeAttributeString(m,o.macro),!0===o.fPublished&&n.writeAttributeString(r,"1")},function(){var e=o.nvGraphicFramePr,t=o.xfrm,r=o.graphic;N.k(e)||Za(n,Ae,"nvGraphicFramePr",e),Wt(n,Ae,"xfrm",t,!0),N.k(r)||Jo(n,Te,"graphic",r)})}function Xa(r,n,e,o){r.writeElement(n+":"+e,function(){var e=o.cNvPr,t=o.cNvGrpSpPr;N.k(e)||Wo(r,n,g,e),N.k(t)||Zo(r,n,"cNvGrpSpPr",t)})}function Ja(r,n,e,o){r.writeElement(n+":"+e,function(){var e=o.nvGrpSpPr,t=o.grpSpPr;N.k(e)||Xa(r,Me,"nvGrpSpPr",e),N.k(t)||xa(r,Me,"grpSpPr",t),o.sp.forEach(function(e){5===e.shapeType?Da(r,n,"sp",e):3===e.shapeType?Ja(r,n,W,e):2===e.shapeType?Ya(r,n,b,e):4===e.shapeType?Pa(r,n,V,e):1===e.shapeType?Ga(r,n,"pic",e):0===e.shapeType&&es(r,Fe,Se)})})}function Qa(r,e,t,n){r.writeElement(e+":"+t,function(){var e,t;N.k(n.col)||r.writeElementString("xdr:col",n.col),e=n.colOffset,N.k(e)||r.writeElementString("xdr:colOff",s(e)),N.k(n.row)||r.writeElementString("xdr:row",n.row),t=n.rowOffset,N.k(t)||r.writeElementString("xdr:rowOff",s(t))})}function $a(f,e,t,d){f.writeElement(e+":"+t,function(){var e=d.editAs;N.k(e)||0===e||f.writeAttributeString("editAs",p.Charts.ST_EditAs[e])},function(){var e=d.startPoint,t=d.endPoint,r=d.AlternateContent,n=d.sp,o=d.grpSp,i=d.graphicFrame,a=d.cxnSp,s=d.pic,l=d.clientData,u=N.Util.Da(d),c=u&&u.layoutId,h=N.Util.Ea(c);N.k(e)||Qa(f,Me,"from",e),N.k(t)||Qa(f,Me,"to",t),!N.k(r)&&h&&es(f,Fe,Se,r,h),N.k(n)||Fa(f,Me,"sp",n),N.k(o)||Ja(f,Me,W,o),N.k(i)||h||Ya(f,Me,b,i,h),N.k(a)||Pa(f,Me,V,a),N.k(s)||za(f,Me,"pic",s),N.k(l)||Ma(f,Me,xe,l)})}function es(r,e,t,n,o){r.writeElement(e+":"+t,function(){r.writeAttributeString("xmlns:mc",n.AlternateContent)},function(){var e=n.Choice,t=n.Fallback;N.k(e)||ts(r,Fe,"Choice",e,o),N.k(t)||rs(r,Fe,"Fallback",t)})}function ts(t,e,r,n,o){t.writeElement(e+":"+r,function(){!o||N.k(n.Requires)||N.k(n.cx)||t.writeAttributeString("xmlns:"+n.Requires,n.cx),t.writeAttributeString("Requires",n.Requires)},function(){var e=n.GraphicalObjectFrame;N.k(e)||Ya(t,Me,"graphicFrame",e,o)})}function rs(t,e,r,n){t.writeElement(e+":"+r,function(){},function(){var e=n.GraphicalObjectFrame;N.k(e)||Ya(t,Me,"graphicFrame",e)})}function ns(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.startPoint,t=n.pic;N.k(e)||Qa(r,Me,"from",e),N.k(t)||Va(r,Me,"pic",t),ot(r,n,!0)})}function os(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.pos,t=n.pic;N.k(e)||It(r,Me,"pos",e,!0),N.k(t)||Wa(r,Me,"pic",t),ot(r,n)})}function is(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.spPr,t=a.bodyPr,r=a.lstStyle,n=a.style,o=a.extLst;N.k(e)||Sa(i,Te,B,e),N.k(t)||ms(i,Te,"bodyPr",t),N.k(r)||hs(i,Te,"lstStyle",r),N.k(n)||ka(i,Te,be,n),N.k(o)||Ut(i,Te,w,o)})}function as(o,e,t,i){o.writeElement(e+":"+t,function(){var e=i.spDef,t=i.lnDef,r=i.txDef,n=i.extLst;N.k(e)||is(o,Te,"spDef",e),N.k(t)||is(o,Te,"lnDef",t),N.k(r)||is(o,Te,"txDef",r),N.k(n)||Ut(o,Te,w,n)})}function ss(e,t,r){Be(e,t,r)}function ls(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.clrScheme,t=n.clrMap;N.k(e)||it(r,Te,z,e),N.k(t)||Do(r,Te,"clrMap",t)})}function us(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.extraClrScheme,function(e){ls(t,Te,"extraClrScheme",e)})})}function cs(n,o,e,i){n.writeElement(o+":"+e,function(){var e=i.pPr,t=i.endParaRPr,r=i.elements;N.k(e)||Bs(n,o,"pPr",e),N.k(r)||r.forEach(function(e){0===e.elementType?Hs(n,o,ke,e):1===e.elementType?Ls(n,o,"br",e):2===e.elementType&&js(n,o,"fld",e)}),N.k(t)||Ds(n,o,"endParaRPr",t)})}function hs(h,e,t,f){h.writeElement(e+":"+t,function(){var e=f.defPPr,t=f.lvl1pPr,r=f.lvl2pPr,n=f.lvl3pPr,o=f.lvl4pPr,i=f.lvl5pPr,a=f.lvl6pPr,s=f.lvl7pPr,l=f.lvl8pPr,u=f.lvl9pPr,c=f.extLst;N.k(e)||Bs(h,Te,"defPPr",e),N.k(t)||Bs(h,Te,"lvl1pPr",t),N.k(r)||Bs(h,Te,"lvl2pPr",r),N.k(n)||Bs(h,Te,"lvl3pPr",n),N.k(o)||Bs(h,Te,"lvl4pPr",o),N.k(i)||Bs(h,Te,"lvl5pPr",i),N.k(a)||Bs(h,Te,"lvl6pPr",a),N.k(s)||Bs(h,Te,"lvl7pPr",s),N.k(l)||Bs(h,Te,"lvl8pPr",l),N.k(u)||Bs(h,Te,"lvl9pPr",u),N.k(c)||Ut(h,Te,w,c)})}function fs(r,e,t,n){r.writeLeafElement(e+":"+t,function(){var e=n.fontScale,t=n.lnSpcReduction;N.k(e)||1e5===e||r.writeAttributeString("fontScale",e),N.k(t)||0===t||r.writeAttributeString("lnSpcReduction",t)})}function ds(e,t,r){Be(e,t,r)}function ps(e,t,r){Be(e,t,r)}function gs(e){return 6e4*e}function ms(h,e,t,f){h.writeElement(e+":"+t,function(){var e=f.rot,t=f.vertOverflow,r=f.horzOverflow,n=f.wrap,o=f.lIns,i=f.tIns,a=f.rIns,s=f.bIns,l=f.numCol,u=f.spcCol,c=f.anchor;N.k(e)||h.writeAttributeString("rot",6e4*e),!0===f.spcFirstLastPara&&h.writeAttributeString("spcFirstLastPara","1"),N.k(t)||0===t||h.writeAttributeString("vertOverflow",p.Charts.ST_TextVertOverflowType[t]),N.k(r)||0===r||h.writeAttributeString("horzOverflow",p.Charts.ST_TextHorzOverflowType[r]),N.k(f.vert)||h.writeAttributeString("vert",p.Charts.ST_TextVerticalType[f.vert]),N.k(n)||0===n||h.writeAttributeString("wrap",p.Charts.ST_TextWrappingType[n]),N.k(o)||0===o||h.writeAttributeString("lIns",o),N.k(i)||0===i||h.writeAttributeString("tIns",i),N.k(a)||0===a||h.writeAttributeString("rIns",a),N.k(s)||0===s||h.writeAttributeString("bIns",s),N.k(l)||0===l||h.writeAttributeString("numCol",l),N.k(u)||0===u||h.writeAttributeString("spcCol",u),!0===f.rtlCol&&h.writeAttributeString("rtlCol","1"),!0===f.fromWordArt&&h.writeAttributeString("fromWordArt","1"),N.k(c)||0===c||h.writeAttributeString("anchor",p.Charts.ST_TextAnchoringType[c]),!0===f.anchorCtr&&h.writeAttributeString("anchorCtr","1"),!0===f.forceAA&&h.writeAttributeString("forceAA","1"),!0===f.upright&&h.writeAttributeString("upright","1"),!0===f.compatLnSpc&&h.writeAttributeString("compatLnSpc","1")},function(){var e=f.prstTxWarp,t=f.noAutofit,r=f.normAutofit,n=f.spAutoFit,o=f.scene3d,i=f.sp3d,a=f.flatTx,s=f.extLst;N.k(e)||fa(h,Te,"prstTxWarp",e),N.k(t)||ps(h,Te,"noAutofit"),N.k(r)||fs(h,Te,"normAutofit",r),N.k(n)||ds(h,Te,"spAutoFit"),N.k(o)||ei(h,Te,O,o),N.k(i)||ni(h,Te,"sp3d",i),N.k(a)||oi(h,Te,"flatTx",a),N.k(s)||Ut(h,Te,w,s)})}function bs(n,e,t,o){n.writeElement(e+":"+t,function(){var e,t=o.bodyPr,r=o.lstStyle;ms(n,Te,"bodyPr",t||{}),N.k(r)||hs(n,Te,"lstStyle",r),e=o.p,N.k(e)?cs(n,Te,"p",{pPr:{defRPr:{}},endParaRPr:{},elements:[]}):Xe(o.p,function(e){cs(n,Te,"p",e)})})}function ys(e,t,r){Be(e,t,r)}function Cs(e,t,r){Be(e,t,r)}function ws(e,t,r,n){je(e,t,r,n,h)}function vs(e,t,r,n){je(e,t,r,n,h)}function Ss(e,t,r){Be(e,t,r)}function xs(t,e,r,n){t.writeLeafElement(e+":"+r,function(){var e=n.startAt;N.k(n.type)||t.writeAttributeString(o,p.Charts.ST_TextAutonumberScheme[n.type]),N.k(e)||1===e||t.writeAttributeString("startAt",e)})}function Ts(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.char)||e.writeAttributeString("char",n.char)})}function As(e,t,r,n){He(e,t,r,n,Bi,Te,"blip")}function ks(e,t,r){Be(e,t,r)}function Ms(o,e,t,i){o.writeLeafElement(e+":"+t,function(){var e=i.typeface,t=i.panose,r=i.pitchFamily,n=i.charset;N.k(e)||o.writeAttributeString("typeface",u.ConverterHelper.getFontName(e)),N.k(t)||o.writeAttributeString("panose",t),N.k(r)||0===r||o.writeAttributeString("pitchFamily",r),N.k(n)||1===n||o.writeAttributeString("charset",n)})}function Is(e,t,r){Be(e,t,r)}function Es(e,t,r){Be(e,t,r)}function Rs(e,t,r,n){e.writeElement(t+":"+r,function(){Ve(e,n)})}function Ds(g,e,t,m){g.writeElement(e+":"+t,function(){var e=m.altLang,t=m.sz,r=m.kern,n=m.cap,o=m.spc,i=m.baseline,a=m.smtId,s=m.bmk;!0===m.kumimoji&&g.writeAttributeString("kumimoji","1"),N.k(e)||g.writeAttributeString("altLang",e),N.k(t)||0===t||g.writeAttributeString("sz",Math.round(100*u.UnitHelper.pixelToPoint(t))),N.k(m.b)||g.writeAttributeString("b",m.b?"1":"0"),N.k(m.i)||g.writeAttributeString("i",m.i?"1":"0"),N.k(m.u)||g.writeAttributeString("u",p.Charts.ST_TextUnderlineType[m.u]),N.k(m.strike)||g.writeAttributeString("strike",p.Charts.ST_TextStrikeType[m.strike]),N.k(r)||0===r||g.writeAttributeString("kern",r),N.k(n)||0===n||g.writeAttributeString("cap",p.Charts.ST_TextCapsType[n]),N.k(o)||g.writeAttributeString("spc",o),!0===m.normalizeH&&g.writeAttributeString("normalizeH","1"),N.k(i)||g.writeAttributeString("baseline",i),!0===m.noProof&&g.writeAttributeString("noProof","1"),!1===m.dirty&&g.writeAttributeString("dirty","0"),!0===m.err&&g.writeAttributeString("err","1"),!1===m.smtClean&&g.writeAttributeString("smtClean","0"),N.k(a)||0===a||g.writeAttributeString("smtId",a),N.k(s)||g.writeAttributeString("bmk",s)},function(){var e=m.ln,t=m.highlight,r=m.uLnTx,n=m.uLn,o=m.uFillTx,i=m.uFill,a=m.latin,s=m.ea,l=m.cs,u=m.sym,c=m.hlinkClick,h=m.hlinkMouseOver,f=m.extLst,d=m.effectLst,p=m.effectDag;N.k(e)||va(g,Te,"ln",e),Ve(g,m),N.k(d)||Ki(g,Te,y,d),N.k(p)||qi(g,Te,C,p),N.k(t)||Kt(g,Te,"highlight",t),N.k(r)||Is(g,Te,"uLnTx"),N.k(n)||va(g,Te,"uLn",n),N.k(o)||Es(g,Te,"uFillTx"),N.k(i)||Rs(g,Te,"uFill",i),N.k(a)||Ms(g,Te,"latin",a),N.k(s)||Ms(g,Te,"ea",s),N.k(l)||Ms(g,Te,"cs",l),N.k(u)||Ms(g,Te,"sym",u),N.k(c)||Jt(g,Te,"hlinkClick",c),N.k(h)||Jt(g,Te,"hlinkMouseOver",h),N.k(f)||Ut(g,Te,w,f)})}function Ns(e,t,r,n){je(e,t,r,n,h)}function Fs(e,t,r,n){je(e,t,r,n,h)}function _s(e,t,r,n){e.writeLeafElement(t+":"+r,function(){N.k(n.pos)||e.writeAttributeString("pos",n.pos),N.k(n.algn)||e.writeAttributeString("algn",p.Charts.ST_TextTabAlignType[n.algn])})}function Ps(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.tab,function(e){_s(t,Te,"tab",e)})})}function Ls(e,t,r,n){He(e,t,r,n,Ds,Te,"rPr")}function Os(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.spcPct)||Ns(e,Te,"spcPct",n.spcPct),N.k(n.spcPts)||Fs(e,Te,"spcPts",n.spcPts)})}function Bs(b,e,t,y){b.writeElement(e+":"+t,function(){var e=y.marL,t=y.marR,r=y.lvl,n=y.indent,o=y.algn,i=y.defTabSz,a=y.fontAlgn;N.k(e)||0===e||b.writeAttributeString("marL",e),N.k(t)||0===t||b.writeAttributeString("marR",t),N.k(r)||0===r||b.writeAttributeString("lvl",r),N.k(n)||0===n||b.writeAttributeString("indent",n),N.k(o)||0===o||b.writeAttributeString("algn",p.Charts.ST_TextAlignType[o]),N.k(i)||0===i||b.writeAttributeString("defTabSz",i),!0===y.rtl&&b.writeAttributeString("rtl","1"),!0===y.eaLnBrk&&b.writeAttributeString("eaLnBrk","1"),N.k(a)||0===a||b.writeAttributeString("fontAlgn",p.Charts.ST_TextFontAlignType[a]),!0===y.latinLnBrk&&b.writeAttributeString("latinLnBrk","1"),!0===y.hangingPunct&&b.writeAttributeString("hangingPunct","1")},function(){var e=y.lnSpc,t=y.spcBef,r=y.spcAft,n=y.buClrTx,o=y.buClr,i=y.buSzTx,a=y.buSzPct,s=y.buSzPts,l=y.buFontTx,u=y.buFont,c=y.buNone,h=y.buAutoNum,f=y.buChar,d=y.buBlip,p=y.tabLst,g=y.defRPr,m=y.extLst;N.k(e)||Os(b,Te,"lnSpc",e),N.k(t)||Os(b,Te,"spcBef",t),N.k(r)||Os(b,Te,"spcAft",r),N.k(n)||ys(b,Te,"buClrTx"),N.k(o)||Kt(b,Te,"buClr",o),N.k(i)||Cs(b,Te,"buSzTx"),N.k(a)||ws(b,Te,"buSzPct",a),N.k(s)||vs(b,Te,"buSzPts",s),N.k(l)||Ss(b,Te,"buFontTx"),N.k(u)||Ms(b,Te,"buFont",u),N.k(c)||ks(b,Te,"buNone"),N.k(h)||xs(b,Te,"buAutoNum",h),N.k(f)||Ts(b,Te,"buChar",f),N.k(d)||As(b,Te,"buBlip",d),N.k(p)||Ps(b,Te,"tabLst",p),N.k(g)||Ds(b,Te,"defRPr",g),N.k(m)||Ut(b,Te,w,m)})}function js(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.id)||e.writeAttributeString("id",n.id),N.k(n.type)||e.writeAttributeString(o,n.type)},function(){N.k(n.rPr)||Ds(e,Te,"rPr",n.rPr),N.k(n.pPr)||Bs(e,Te,"pPr",n.pPr),N.k(n.t)||e.writeElementString("a:t",n.t)})}function Hs(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.rPr)||Ds(e,Te,"rPr",n.rPr),N.k(n.t)||e.writeElementString("a:t",a(n.t))})}Object.defineProperty(l,"__esModule",{value:!0}),p=t("./src/datamodel/chart-model.ts"),u=t("./src/datamodel/excel-style.ts"),s=u.UnitHelper.pixelToEMU,i=t("./src/xlsx-io/common/chart-helper.ts"),N=t("./src/common/common.ts"),a=N.Util.sa,c=null,h="val",f="name",o="type",d="prst",w="extLst",g="cNvPr",m="macro",y="effectLst",C="effectDag",r="fPublished",b="graphicFrame",v="ext",S="scrgbClr",x="srgbClr",T="hslClr",A="sysClr",k="schemeClr",M="prstClr",I="styleClr",E="noFill",R="solidFill",D="gradFill",F="blipFill",_="pattFill",P="grpFill",L="delete",O="scene3d",B="spPr",j="txPr",H="invertIfNegative",G="bubble3D",U="marker",W="grpSp",V="cxnSp",z="clrScheme",q="fontScheme",Z="fmtScheme",Y="layout",K="pictureOptions",X="order",J="gapWidth",Q="dLbls",$="trendline",ee="errBars",te="ser",re="dropLines",ne="axId",oe="grouping",ie="varyColors",ae="scaling",se="axPos",le="majorGridlines",ue="minorGridlines",ce="title",he="numFmt",fe="majorTickMark",de="minorTickMark",pe="tickLblPos",ge="crossAx",me="crosses",be="style",ye="rotWithShape",Ce="cNvPicPr",we="nvPicPr",ve="cNvGraphicFramePr",Se="AlternateContent",xe="clientData",Te="a",Ae="cdr",ke="r",Me="xdr",Ie="c",Ee="c15",Re="c16",De="a14",Ne="c14",Fe="mc",_e="cx",Pe="cs",n="chartDefinedName",l.DrawingWriter={a:"http://schemas.openxmlformats.org/drawingml/2006/main",cdr:"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",xdr:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",c:"http://schemas.openxmlformats.org/drawingml/2006/chart",c15:"http://schemas.microsoft.com/office/drawing/2012/chart",a14:"http://schemas.microsoft.com/office/drawing/2010/main",c14:"http://schemas.microsoft.com/office/drawing/2007/8/2/chart",c16:"http://schemas.microsoft.com/office/drawing/2017/03/chart",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex"},(Le={WriteCT_ChartStyle:function(o,e,t,r,i){o.writeElement(e+":"+t,function(){var e=i.attribute,t=e.cs,r=e.a,n=e.id;Oe(t)||o.writeAttributeString("xmlns:cs",t),Oe(r)||o.writeAttributeString("xmlns:a",r),Oe(n)||o.writeAttributeString("id",n)},function(){var e,t;for(e in i)"attribute"!==e&&("dataPointMarkerLayout"===e?Le.WriteCT_DataPointMarkerLayout(o,Pe,e,r,i[e]):"extLst"===e?(t=i.extLst,N.k(t)||Ut(o,Te,w,t)):Le.WriteCT_ChartStyleElement(o,Pe,e,r,i[e]))})},WriteCT_ChartStyleElement:function(s,l,e,t,u){s.writeElement(l+":"+e,function(){for(var e in u.attribute)u.attribute.hasOwnProperty(e)&&s.writeAttributeString(e,u.attribute[e])},function(){var e=u.lnRef,t=u.fillRef,r=u.effectRef,n=u.fontRef,o=u.spPr,i=u.defRPr,a=u.bodyPr;N.k(e)||Ta(s,Pe,"lnRef",e),N.k(t)||Ta(s,Pe,"fillRef",t),N.k(r)||Ta(s,Pe,"effectRef",r),N.k(n)||Aa(s,Pe,"fontRef",n),N.k(o)||Sa(s,l,"spPr",u.spPr),N.k(i)||Ds(s,Pe,"defRPr",i),N.k(a)||ms(s,Pe,"bodyPr",a)})},WriteCT_DataPointMarkerLayout:function(t,e,r,n,o){t.writeLeafElement(e+":"+r,function(){for(var e in o.attribute)o.attribute.hasOwnProperty(e)&&t.writeAttributeString(e,o.attribute[e])})},WriteCT_ChartColors:function(i,e,t,o,a){i.writeElement(e+":"+t,function(){var e=a.attribute,t=e.cs,r=e.a,n=e.id,o=e.meth;Oe(t)||i.writeAttributeString("xmlns:cs",t),Oe(r)||i.writeAttributeString("xmlns:a",r),Oe(o)||i.writeAttributeString("meth",o),Oe(n)||i.writeAttributeString("id",n)},function(){var e,t,r=a.schemeClr,n=a.variation;if(Xe(r,function(e){jt(i,Te,k,e)}),!N.k(n))for(e=0;e<n.length;e++)t=n[e],Le.WriteCT_Variation(i,Pe,"variation",o,t)})},WriteCT_Variation:function(r,e,t,n,o){r.writeElement(e+":"+t,null,function(){if(o){var e=o.lumMod,t=o.lumOff;N.k(e)||xt(r,Te,"lumMod",e),N.k(t)||xt(r,Te,"lumOff",t)}})},WriteCT_Extension:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){N.k(o.uri)||e.writeAttributeString("uri",""+o.uri)})},WriteCT_ExtensionList:function(t,r,e,n,o){t.writeElement(r+":"+e,null,function(){if(o&&o.ext&&0<o.ext.length)for(var e=0;e<o.ext.length;e++)N.k(o.ext[e])||Le.WriteCT_Extension(t,r,"ext","",o.ext[e])})},WriteCT_NumberFormat:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){N.k(o.formatCode)||e.writeAttributeString("formatCode",a(o.formatCode)),e.writeAttributeString("sourceLinked",o.sourceLinked?"1":"0")})},WriteCT_ValueColors:function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){N.k(o.minColor)||Ri(e,t,"minColor",o.minColor),N.k(o.midColor)||Ri(e,t,"midColor",o.midColor),N.k(o.maxColor)||Ri(e,t,"maxColor",o.maxColor)})},WriteCT_ExternalData:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){N.k(o.id)||e.writeAttributeString("id",""+o.id),e.writeAttributeString("autoUpdate",o.autoUpdate?"1":"0")})},WriteCT_Formula:function(t,e,r,n,o){t.writeElement(e+":"+r,function(){Oe(o.dir)||t.writeAttributeString("dir",p.Charts.ST_FormulaDirection[o.dir])},function(){var e=o.formula;Oe(e)||t.writeValue(e)})},WriteCT_Value:function(t,e,r,n,o){t.writeElement(e+":"+r,function(){var e=o.value;Oe(e)||t.writeValue(e)})},WriteCT_DataId:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("val",""+o.val)})},WriteST_AxisId:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("val",""+o.val)})},WriteCT_StringValue:function(t,e,r,n,o){t.writeElement(e+":"+r,function(){Oe(o.idx)||t.writeAttributeString("idx",o.idx)},function(){var e=o.value;Oe(e)||t.writeValue(e)})},WriteCT_StringLevel:function(t,r,e,n,o){t.writeElement(r+":"+e,function(){t.writeAttributeString("ptCount",""+o.ptCount),N.k(o.name)||t.writeAttributeString("name",""+o.name)},function(){for(var e=0;e<o.pt.length;e++)N.k(o.pt[e])||Le.WriteCT_StringValue(t,r,"pt","",o.pt[e])})},WriteCT_StringDimension:function(t,r,e,n,o){t.writeElement(r+":"+e,function(){t.writeAttributeString("type",p.Charts.ST_StringDimensionType[o.type])},function(){if(o.lvl&&0<o.lvl.length)for(var e=0;e<o.lvl.length;e++)N.k(o.lvl[e])||Le.WriteCT_StringLevel(t,r,"lvl","",o.lvl[e]);N.k(o.nf)||Le.WriteCT_Formula(t,r,"nf","",o.nf),N.k(o.f)||Le.WriteCT_Formula(t,r,"f","",o.f)})},WriteCT_NumericValue:function(t,e,r,n,o){t.writeElement(e+":"+r,function(){Oe(o.idx)||t.writeAttributeString("idx",o.idx)},function(){var e=o.value;Oe(e)||t.writeValue(e)})},WriteCT_NumericLevel:function(t,r,e,n,o){t.writeElement(r+":"+e,function(){t.writeAttributeString("ptCount",""+o.ptCount),N.k(o.formatCode)||t.writeAttributeString("formatCode",""+o.formatCode),N.k(o.name)||t.writeAttributeString("name",""+o.name)},function(){for(var e=0;e<o.pt.length;e++)N.k(o.pt[e])||Le.WriteCT_NumericValue(t,r,"pt","",o.pt[e])})},WriteCT_NumericDimension:function(t,r,e,n,o){t.writeElement(r+":"+e,function(){t.writeAttributeString("type",p.Charts.ST_NumericDimensionType[o.type])},function(){if(o.lvl&&0<o.lvl.length)for(var e=0;e<o.lvl.length;e++)N.k(o.lvl[e])||Le.WriteCT_NumericLevel(t,r,"lvl","",o.lvl[e]);N.k(o.nf)||Le.WriteCT_Formula(t,r,"nf","",o.nf),N.k(o.f)||Le.WriteCT_Formula(t,r,"f","",o.f)})},WriteCT_Data:function(t,r,e,n,o){t.writeElement(r+":"+e,function(){t.writeAttributeString("id",""+o.id)},function(){var e;if(N.k(o.extLst)||Le.WriteCT_ExtensionList(t,r,"extLst","",o.extLst),o.numDim&&0<o.numDim.length)for(e=0;e<o.numDim.length;e++)N.k(o.numDim[e])||Le.WriteCT_NumericDimension(t,r,"numDim","",o.numDim[e]);if(o.strDim&&0<o.strDim.length)for(e=0;e<o.strDim.length;e++)N.k(o.strDim[e])||Le.WriteCT_StringDimension(t,r,"strDim","",o.strDim[e])})},WriteCT_ChartData:function(t,r,e,n,o){t.writeElement(r+":"+e,null,function(){var e;for(N.k(o.externalData)||Le.WriteCT_ExternalData(t,r,"externalData","",o.externalData),e=0;e<o.data.length;e++)N.k(o.data[e])||Le.WriteCT_Data(t,r,"data","",o.data[e]);N.k(o.extLst)||Le.WriteCT_ExtensionList(t,r,"extLst","",o.extLst)})},WriteCT_TextData:function(e,t,r,n,o){e.writeElement(t+":"+r,function(){N.k(o.f)||Le.WriteCT_Formula(e,t,"f","",o.f),N.k(o.v)||Le.WriteCT_Value(e,t,"v","",o.v)})},WriteCT_Text:function(e,t,r,n,o){e.writeElement(t+":"+r,function(){N.k(o.txData)?N.k(o.rich)||bs(e,t,"rich",o.rich):Le.WriteCT_TextData(e,t,"txData","",o.txData)})},WriteCT_ChartTitle:function(e,t,r,n,o){e.writeElement(t+":"+r,function(){N.k(o.pos)||e.writeAttributeString("pos",p.Charts.ST_SidePos[o.pos]),N.k(o.align)||e.writeAttributeString("align",p.Charts.ST_PosAlign[o.align]),N.k(o.overlay)||e.writeAttributeString("overlay",o.overlay?"1":"0")},function(){N.k(o.tx)||Le.WriteCT_Text(e,t,"tx","",o.tx),N.k(o.spPr)||Sa(e,t,"spPr",o.spPr),N.k(o.txPr)||bs(e,t,"txPr",o.txPr),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},WriteCT_CategoryAxisScaling:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){N.k(o.gapWidth)||e.writeAttributeString("gapWidth",""+o.gapWidth)})},WriteCT_ValueAxisScaling:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){N.k(o.max)||e.writeAttributeString("max",""+o.max),N.k(o.min)||e.writeAttributeString("min",""+o.min),N.k(o.majorUnit)||e.writeAttributeString("majorUnit",""+o.majorUnit),N.k(o.minorUnit)||e.writeAttributeString("minorUnit",""+o.minorUnit)})},WriteCT_AxisTitle:function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){N.k(o.tx)||Le.WriteCT_Text(e,t,"tx","",o.tx),N.k(o.spPr)||Sa(e,t,"spPr",o.spPr),N.k(o.txPr)||bs(e,t,"txPr",o.txPr),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},WriteCT_AxisUnitsLabel:function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){N.k(o.tx)||Le.WriteCT_Text(e,t,"tx","",o.tx),N.k(o.spPr)||Sa(e,"cx","spPr",o.spPr),N.k(o.txPr)||bs(e,t,"txPr",o.txPr),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},WriteCT_AxisUnits:function(e,t,r,n,o){e.writeElement(t+":"+r,function(){e.writeAttributeString("unit",p.Charts.ST_AxisUnit[o.unit])},function(){N.k(o.unitsLabel)||Le.WriteCT_AxisUnitsLabel(e,t,"unitsLabel","",o.unitsLabel),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},WriteCT_Gridlines:function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){o&&!N.k(o.spPr)&&Sa(e,"cx","spPr",o.spPr),o&&!N.k(o.extLst)&&Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},WriteCT_TickMarks:function(e,t,r,n,o){e.writeElement(t+":"+r,function(){e.writeAttributeString("type",p.Charts.ST_TickMarksType[o])},function(){N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},WriteCT_TickLabels:function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){o&&!N.k(o.extLst)&&Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},WriteCT_Axis:function(t,r,e,n,o){t.writeElement(r+":"+e,function(){var e=o.id?o.id:1;t.writeAttributeString("id",""+e),!1!==o.hidden&&t.writeAttributeString("hidden",o.hidden?"1":"0")},function(){if(N.k(o.title)||Le.WriteCT_AxisTitle(t,r,"title","",o.title),N.k(o.units)||Le.WriteCT_AxisUnits(t,r,"units","",o.units),N.k(o.majorGridlines)||Le.WriteCT_Gridlines(t,r,"majorGridlines","",o.majorGridlines),N.k(o.minorGridlines)||Le.WriteCT_Gridlines(t,r,"minorGridlines","",o.minorGridlines),N.k(o.majorTickMarks)||N.k(o.majorTickMarks)||Le.WriteCT_TickMarks(t,r,"majorTickMarks","",o.majorTickMarks),N.k(o.minorTickMarks)||N.k(o.minorTickMarks)||Le.WriteCT_TickMarks(t,r,"minorTickMarks","",o.minorTickMarks),Le.WriteCT_TickLabels(t,r,"tickLabels","",o.tickLabels),N.k(o.numFmt)||Le.WriteCT_NumberFormat(t,r,"numFmt","",o.numFmt),N.k(o.spPr)||Sa(t,r,"spPr",o.spPr),N.k(o.txPr)||bs(t,r,"txPr",o.txPr),N.k(o.catScaling)){var e=o.valScaling||{};Le.WriteCT_ValueAxisScaling(t,r,"valScaling","",e)}else Le.WriteCT_CategoryAxisScaling(t,r,"catScaling","",o.catScaling);N.k(o.extLst)||Le.WriteCT_ExtensionList(t,r,"extLst","",o.extLst)})},WriteCT_ParentLabelLayout:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("val",p.Charts.ST_ParentLabelLayout[o.val])})},WriteCT_RegionLabelLayout:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("val",p.Charts.ST_RegionLabelLayout[o.val])})},WriteCT_SeriesElementVisibilities:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("connectorLines",o.connectorLines?"1":"0"),e.writeAttributeString("meanLine",o.meanLine?"1":"0"),e.writeAttributeString("meanMarker",o.meanMarker?"1":"0"),e.writeAttributeString("nonoutliers",o.nonoutliers?"1":"0"),e.writeAttributeString("outliers",o.outliers?"1":"0")})},WriteCT_Aggregation:function(e,t,r){e.writeLeafElement(t+":"+r,null)},WriteCT_Binning:function(e,t,r,n,o){e.writeElement(t+":"+r,function(){e.writeAttributeString("intervalClosed",p.Charts.ST_IntervalClosedSide[o.intervalClosed]),N.k(o.underflow)||e.writeAttributeString("underflow",""+o.underflow),N.k(o.overflow)||e.writeAttributeString("overflow",""+o.overflow)},function(){N.k(o.binSize)||Le.WriteBinSize(e,t,"binSize","",o.binSize),N.k(o.binCount)||Le.WriteBinCount(e,t,"binCount","",o.binCount)})},WriteBinSize:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("val",""+o.val)})},WriteBinCount:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("val",""+o.val)})},WriteCT_GeoLocationQuery:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){N.k(o.countryRegion)||e.writeAttributeString("countryRegion",""+o.countryRegion),N.k(o.adminDistrict1)||e.writeAttributeString("adminDistrict1",""+o.adminDistrict1),N.k(o.adminDistrict2)||e.writeAttributeString("adminDistrict2",""+o.adminDistrict2),N.k(o.postalCode)||e.writeAttributeString("postalCode",""+o.postalCode),e.writeAttributeString("entityType",p.Charts.ST_EntityType[o.entityType])})},WriteCT_Address:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){N.k(o.address1)||e.writeAttributeString("address1",""+o.address1),N.k(o.countryRegion)||e.writeAttributeString("countryRegion",""+o.countryRegion),N.k(o.adminDistrict1)||e.writeAttributeString("adminDistrict1",""+o.adminDistrict1),N.k(o.adminDistrict2)||e.writeAttributeString("adminDistrict2",""+o.adminDistrict2),N.k(o.postalCode)||e.writeAttributeString("postalCode",""+o.postalCode),N.k(o.locality)||e.writeAttributeString("locality",""+o.locality),N.k(o.isoCountryCode)||e.writeAttributeString("isoCountryCode",""+o.isoCountryCode)})},WriteCT_GeoLocation:function(e,t,r,n,o){e.writeElement(t+":"+r,function(){e.writeAttributeString("latitude",""+o.latitude),e.writeAttributeString("longitude",""+o.longitude),N.k(o.entityName)||e.writeAttributeString("entityName",""+o.entityName),e.writeAttributeString("entityType",p.Charts.ST_EntityType[o.entityType])},function(){N.k(o.address)||Le.WriteCT_Address(e,t,"address","",o.address)})},WriteCT_GeoLocations:function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){N.k(o.geoLocation)||Le.WriteCT_GeoLocation(e,t,"geoLocation","",o.geoLocation)})},WriteCT_GeoLocationQueryResult:function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){N.k(o.geoLocationQuery)||Le.WriteCT_GeoLocationQuery(e,t,"geoLocationQuery","",o.geoLocationQuery),N.k(o.geoLocations)||Le.WriteCT_GeoLocations(e,t,"geoLocations","",o.geoLocations)})},WriteCT_GeoLocationQueryResults:function(t,r,e,n,o){t.writeElement(r+":"+e,null,function(){for(var e=0;e<o.geoLocationQueryResult.length;e++)N.k(o.geoLocationQueryResult[e])||Le.WriteCT_GeoLocationQueryResult(t,r,"geoLocationQueryResult","",o.geoLocationQueryResult[e])})},WriteCT_GeoPolygon:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){N.k(o.polygonId)||e.writeAttributeString("polygonId",""+o.polygonId),e.writeAttributeString("numPoints",""+o.numPoints),N.k(o.pcaRings)||e.writeAttributeString("pcaRings",""+o.pcaRings)})},WriteCT_GeoPolygons:function(t,r,e,n,o){t.writeElement(r+":"+e,null,function(){for(var e=0;e<o.geoPolygon.length;e++)N.k(o.geoPolygon[e])||Le.WriteCT_GeoPolygon(t,r,"geoPolygon","",o.geoPolygon[e])})},WriteCT_Copyrights:function(r,n,e,t,o){r.writeLeafElement(n+":"+e,function(){var e,t=o.copyright;if(!N.k(t))for(e=0;e<t.length;e++)r.writeElementString(n+":copyright",""+t[e])})},WriteCT_GeoData:function(t,r,e,n,o){t.writeElement(r+":"+e,function(){N.k(o.entityName)||t.writeAttributeString("entityName",""+o.entityName),N.k(o.entityId)||t.writeAttributeString("entityId",""+o.entityId),t.writeAttributeString("east",""+o.east),t.writeAttributeString("west",""+o.west),t.writeAttributeString("north",""+o.north),t.writeAttributeString("south",""+o.south)},function(){var e;for(e=0;e<o.geoPolygons.length;e++)N.k(o.geoPolygons[e])||Le.WriteCT_GeoPolygon(t,r,"geoPolygons","",o.geoPolygons[e]);for(e=0;e<o.copyrights.length;e++)N.k(o.copyrights[e])||Le.WriteCT_Copyrights(t,r,"copyrights","",o.copyrights)})},WriteCT_GeoDataEntityQuery:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("entityType",p.Charts.ST_EntityType[o.entityType]),N.k(o.entityId)||e.writeAttributeString("entityId",""+o.entityId)})},WriteCT_GeoDataEntityQueryResult:function(e,t,r,n,o){e.writeElement(t+":"+r,c,function(){N.k(o.geoDataEntityQuery)||Le.WriteCT_GeoDataEntityQuery(e,t,"geoDataEntityQuery","",o.geoDataEntityQuery),N.k(o.geoData)||Le.WriteCT_GeoData(e,t,"geoData","",o.geoData)})},WriteCT_GeoDataEntityQueryResults:function(t,r,e,n,o){t.writeElement(r+":"+e,c,function(){for(var e=0;e<o.geoDataEntityQueryResult.length;e++)N.k(o.geoDataEntityQueryResult[e])||Le.WriteCT_GeoDataEntityQueryResult(t,r,"geoDataEntityQueryResult","",o.geoDataEntityQueryResult[e])})},WriteCT_GeoDataPointQuery:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("entityType",p.Charts.ST_EntityType[o.entityType]),e.writeAttributeString("latitude",""+o.latitude),e.writeAttributeString("longitude",""+o.longitude)})},WriteCT_GeoDataPointToEntityQuery:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("entityType",p.Charts.ST_EntityType[o.entityType]),N.k(o.entityId)||e.writeAttributeString("entityId",""+o.entityId)})},WriteCT_GeoDataPointToEntityQueryResult:function(e,t,r,n,o){e.writeElement(t+":"+r,c,function(){N.k(o.geoDataPointQuery)||Le.WriteCT_GeoDataPointQuery(e,t,"geoDataPointQuery","",o.geoDataPointQuery),N.k(o.geoDataPointToEntityQuery)||Le.WriteCT_GeoDataPointToEntityQuery(e,t,"geoDataPointToEntityQuery","",o.geoDataPointToEntityQuery)})},WriteCT_GeoDataPointToEntityQueryResults:function(t,r,e,n,o){t.writeElement(r+":"+e,c,function(){for(var e=0;e<o.geoDataPointToEntityQueryResult.length;e++)N.k(o.geoDataPointToEntityQueryResult[e])||Le.WriteCT_GeoDataPointToEntityQueryResult(t,r,"geoDataPointToEntityQueryResult","",o.geoDataPointToEntityQueryResult[e])})},WriteCT_GeoChildTypes:function(r,n,e,t,o){r.writeLeafElement(n+":"+e,function(){var e,t=o.entityType;if(t&&0<t.length)for(e=0;e<t.length;e++)r.writeElementString(n+":entityType",""+t[e])})},WriteCT_GeoChildEntitiesQuery:function(e,t,r,n,o){e.writeElement(t+":"+r,function(){N.k(o.entityId)||e.writeAttributeString("entityId",""+o.entityId)},function(){N.k(o.geoChildTypes)||Le.WriteCT_GeoChildTypes(e,t,"geoChildTypes","",o.geoChildTypes)})},WriteCT_GeoHierarchyEntity:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){N.k(o.entityName)||e.writeAttributeString("entityName",""+o.entityName),N.k(o.entityId)||e.writeAttributeString("entityId",""+o.entityId),e.writeAttributeString("entityType",p.Charts.ST_EntityType[o.entityType])})},WriteCT_GeoChildEntities:function(t,r,e,n,o){t.writeElement(r+":"+e,null,function(){for(var e=0;e<o.geoHierarchyEntity.length;e++)N.k(o.geoHierarchyEntity[e])||Le.WriteCT_GeoHierarchyEntity(t,r,"geoHierarchyEntity","",o.geoHierarchyEntity[e])})},WriteCT_GeoChildEntitiesQueryResult:function(t,r,e,n,o){t.writeElement(r+":"+e,null,function(){N.k(o.geoChildEntitiesQuery)||Le.WriteCT_GeoChildEntitiesQuery(t,r,"geoChildEntitiesQuery","",o.geoChildEntitiesQuery);for(var e=0;e<o.geoChildEntities.length;e++)N.k(o.geoChildEntities[e])||Le.WriteCT_GeoHierarchyEntity(t,r,"geoChildEntities","",o.geoChildEntities[e])})},WriteCT_GeoChildEntitiesQueryResults:function(t,r,e,n,o){t.writeElement(r+":"+e,null,function(){for(var e=0;e<o.geoChildEntitiesQueryResult.length;e++)N.k(o.geoChildEntitiesQueryResult[e])||Le.WriteCT_GeoChildEntitiesQueryResult(t,r,"geoChildEntitiesQueryResult","",o.geoChildEntitiesQueryResult[e])})},WriteCT_Clear:function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){N.k(o.geoLocationQueryResults)||Le.WriteCT_GeoLocationQueryResults(e,t,"geoLocationQueryResults","",o.geoLocationQueryResults),N.k(o.geoDataEntityQueryResults)||Le.WriteCT_GeoDataEntityQueryResults(e,t,"geoDataEntityQueryResults","",o.geoDataEntityQueryResults),N.k(o.geoDataPointToEntityQueryResults)||Le.WriteCT_GeoDataPointToEntityQueryResults(e,t,"geoDataPointToEntityQueryResults","",o.geoDataPointToEntityQueryResults),N.k(o.geoChildEntitiesQueryResults)||Le.WriteCT_GeoChildEntitiesQueryResults(e,t,"geoChildEntitiesQueryResults","",o.geoChildEntitiesQueryResults)})},WriteCT_GeoCache:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){N.k(o.provider)||e.writeAttributeString("provider",""+o.provider),N.k(o.binary)||e.writeAttributeString("binary",""+o.binary),N.k(o.clear)||Le.WriteCT_Clear(e,t,"clear",n,o.clear)})},WriteCT_Geography:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("projectionType",p.Charts.ST_GeoProjectionType[o.projectionType]),e.writeAttributeString("viewedRegionType",p.Charts.ST_GeoMappingLevel[o.viewedRegionType]),N.k(o.cultureLanguage)||e.writeAttributeString("cultureLanguage",""+o.cultureLanguage),N.k(o.cultureRegion)||e.writeAttributeString("cultureRegion",""+o.cultureRegion),N.k(o.attribution)||e.writeAttributeString("attribution",""+o.attribution),N.k(o.geoCache)||Le.WriteCT_GeoCache(e,t,"geoCache","",o.geoCache)})},WriteCT_Statistics:function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("quartileMethod",p.Charts.ST_QuartileMethod[o.quartileMethod])})}}).WriteCT_Subtotals=function(n,o,e,t,i){n.writeElement(o+":"+e,null,function(){function e(e){return function(){n.writeAttributeString("val",""+r[e])}}var t,r=i.idx;if(r&&0<r.length)for(t=0;t<r.length;t++)n.writeLeafElement(o+":idx",e(t))})},Le.WriteCT_SeriesLayoutProperties=function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){N.k(o.parentLabelLayout)||Le.WriteCT_ParentLabelLayout(e,t,"parentLabelLayout","",o.parentLabelLayout),N.k(o.regionLabelLayout)||Le.WriteCT_RegionLabelLayout(e,t,"regionLabelLayout","",o.regionLabelLayout),N.k(o.visibility)||Le.WriteCT_SeriesElementVisibilities(e,t,"visibility","",o.visibility),N.k(o.geography)||Le.WriteCT_Geography(e,t,"geography","",o.geography),N.k(o.statistics)||Le.WriteCT_Statistics(e,t,"statistics","",o.statistics),N.k(o.aggregation)||Le.WriteCT_Aggregation(e,t,"aggregation"),N.k(o.binning)||Le.WriteCT_Binning(e,t,"binning","",o.binning),N.k(o.subtotals)||Le.WriteCT_Subtotals(e,t,"subtotals","",o.subtotals),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},Le.WriteCT_DataPoint=function(e,t,r,n,o){e.writeElement(t+":"+r,function(){e.writeAttributeString("idx",""+o.idx)},function(){N.k(o.spPr)||Sa(e,"cx","spPr",o.spPr),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},Le.WriteCT_ExtremeValueColorPosition=function(e,t,r){e.writeLeafElement(t+":"+r,null)},Le.WriteCT_NumberColorPosition=function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("val",""+o.val)})},Le.WriteCT_PercentageColorPosition=function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("val",""+o.val)})},Le.WriteCT_ValueColorEndPosition=function(e,t,r,n,o){e.writeElement(t+":"+r,function(){N.k(o.extremeValue)||Le.WriteCT_ExtremeValueColorPosition(e,t,"extremeValue"),N.k(o.number)||Le.WriteCT_NumberColorPosition(e,t,"number","",o.number),N.k(o.percent)||Le.WriteCT_PercentageColorPosition(e,t,"percent","",o.percent)})},Le.WriteCT_ValueColorMiddlePosition=function(e,t,r,n,o){e.writeElement(t+":"+r,function(){N.k(o.number)||Le.WriteCT_NumberColorPosition(e,t,"number","",o.number),N.k(o.percent)||Le.WriteCT_PercentageColorPosition(e,t,"percent","",o.percent)})},Le.WriteCT_ValueColorPositions=function(e,t,r,n,o){e.writeElement(t+":"+r,function(){2!==o.count&&e.writeAttributeString("count",""+o.count)},function(){N.k(o.min)&&Le.WriteCT_ValueColorEndPosition(e,t,"min","",o.min),N.k(o.mid)&&Le.WriteCT_ValueColorMiddlePosition(e,t,"mid","",o.mid),N.k(o.max)&&Le.WriteCT_ValueColorEndPosition(e,t,"max","",o.max)})},Le.WriteCT_DataLabelVisibilities=function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("seriesName",o.seriesName?"1":"0"),e.writeAttributeString("categoryName",o.categoryName?"1":"0"),e.writeAttributeString("value",o.value?"1":"0")})},Le.WriteCT_DataLabel=function(e,t,r,n,o){e.writeElement(t+":"+r,function(){e.writeAttributeString("idx",""+o.idx),e.writeAttributeString("pos",p.Charts.ST_DataLabelPos[o.pos])},function(){N.k(o.numFmt)||Le.WriteCT_NumberFormat(e,t,"numFmt","",o.numFmt),N.k(o.spPr)||Sa(e,"cx","spPr",o.spPr),N.k(o.txPr)||bs(e,t,"txPr",o.txPr),N.k(o.visibility)||Le.WriteCT_DataLabelVisibilities(e,t,"visibility","",o.visibility),N.k(o.separator)||e.writeElementString(t+":separator",""+o.separator),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},Le.WriteCT_DataLabelHidden=function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("idx",""+o.idx)})},Le.WriteCT_DataLabels=function(t,r,e,n,o){t.writeElement(r+":"+e,function(){N.k(o.pos)||t.writeAttributeString("pos",p.Charts.ST_DataLabelPos[o.pos])},function(){var e;if(N.k(o.numFmt)||Le.WriteCT_NumberFormat(t,r,"numFmt","",o.numFmt),N.k(o.spPr)||Sa(t,r,"spPr",o.spPr),N.k(o.txPr)||bs(t,r,"txPr",o.txPr),N.k(o.visibility)||Le.WriteCT_DataLabelVisibilities(t,r,"visibility","",o.visibility),N.k(o.separator)||t.writeElementString(r+":separator",""+o.separator),!N.k(o.dataLabel))for(e=0;e<o.dataLabel.length;e++)N.k(o.dataLabel[e])||Le.WriteCT_DataLabel(t,r,"dataLabel","",o.dataLabel[e]);if(!N.k(o.dataLabelHidden))for(e=0;e<o.dataLabelHidden.length;e++)N.k(o.dataLabelHidden[e])||Le.WriteCT_DataLabelHidden(t,r,"dataLabelHidden","",o.dataLabelHidden[e]);N.k(o.extLst)||Le.WriteCT_ExtensionList(t,r,"extLst","",o.extLst)})},Le.WriteCT_Series=function(t,r,e,n,o){t.writeElement(r+":"+e,function(){t.writeAttributeString("layoutId",p.Charts.ST_SeriesLayout[i.ChartHelper.ToST_SeriesLayout(o.layoutId)]),!1!==o.hidden&&void 0!==o.hidden&&t.writeAttributeString("hidden",o.hidden?"1":"0"),N.k(o.ownerIdx)||t.writeAttributeString("ownerIdx",""+o.ownerIdx),N.k(o.uniqueId)||t.writeAttributeString("uniqueId",""+o.uniqueId),N.k(o.formatIdx)||t.writeAttributeString("formatIdx",""+o.formatIdx)},function(){var e;if(N.k(o.tx)||Le.WriteCT_Text(t,r,"tx","",o.tx),N.k(o.spPr)||Sa(t,r,"spPr",o.spPr),N.k(o.valueColors)||Le.WriteCT_ValueColors(t,r,"valueColors","",o.valueColors),N.k(o.valueColorPositions)||Le.WriteCT_ValueColorPositions(t,r,"valueColorPositions","",o.valueColorPositions),o.dataPt&&0<o.dataPt.length)for(e=0;e<o.dataPt.length;e++)N.k(o.dataPt[e])||Le.WriteCT_DataPoint(t,r,"dataPt","",o.dataPt[e]);if(N.k(o.dataLabels)||Le.WriteCT_DataLabels(t,r,"dataLabels","",o.dataLabels),N.k(o.dataId)||Le.WriteCT_DataId(t,r,"dataId","",o.dataId),N.k(o.layoutPr)||Le.WriteCT_SeriesLayoutProperties(t,r,"layoutPr","",o.layoutPr),o.axisId&&0<o.axisId.length)for(e=0;e<o.axisId.length;e++)N.k(o.axisId[e])||Le.WriteST_AxisId(t,r,"axisId","",o.axisId[e]);N.k(o.extLst)||Le.WriteCT_ExtensionList(t,r,"extLst","",o.extLst)})},Le.WriteCT_Legend=function(e,t,r,n,o){e.writeElement(t+":"+r,function(){N.k(o.legendPos)||5!==o.legendPos?(N.k(o.legendPos)||e.writeAttributeString("pos",p.Charts.ST_2016ChartPosLegend[o.legendPos]),N.k(o.align)||e.writeAttributeString("align",p.Charts.ST_PosAlign[o.align])):(e.writeAttributeString("pos",p.Charts.ST_2016ChartPosLegend[p.Charts.ST_2016ChartPosLegend.r]),e.writeAttributeString("align",p.Charts.ST_PosAlign[p.Charts.ST_PosAlign.min])),N.k(o.overlay)||e.writeAttributeString("overlay",o.overlay?"1":"0")},function(){N.k(o.spPr)||Sa(e,t,"spPr",o.spPr),N.k(o.txPr)||bs(e,t,"txPr",o.txPr),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},Le.WriteCT_PlotSurface=function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){N.k(o.spPr)||Sa(e,t,"spPr",o.spPr),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},Le.WriteCT_PlotAreaRegion=function(t,r,e,n,o){t.writeElement(r+":"+e,null,function(){var e;for(N.k(o.plotSurface)||Le.WriteCT_PlotSurface(t,r,"plotSurface","",o.plotSurface),e=0;e<o.series.length;e++)N.k(o.series[e])||Le.WriteCT_Series(t,r,"series","",o.series[e]);N.k(o.extLst)||Le.WriteCT_ExtensionList(t,r,"extLst","",o.extLst)})},Le.WriteCT_PlotArea=function(t,r,e,n,o){t.writeElement(r+":"+e,null,function(){var e;if(N.k(o.plotAreaRegion)||Le.WriteCT_PlotAreaRegion(t,r,"plotAreaRegion","",o.plotAreaRegion),!N.k(o.axes))for(e=0;e<o.axes.length;e++)N.k(o.axes[e])||Le.WriteCT_Axis(t,r,"axis","",o.axes[e]);N.k(o.spPr)||Sa(t,r,"spPr",o.spPr),N.k(o.extLst)||Le.WriteCT_ExtensionList(t,r,"extLst","",o.extLst)})},Le.WriteCT_Chart=function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){N.k(o.title)||Le.WriteCT_ChartTitle(e,t,"title","",o.title),N.k(o.plotArea)||Le.WriteCT_PlotArea(e,t,"plotArea","",o.plotArea),N.k(o.legend)||Le.WriteCT_Legend(e,t,"legend","",o.legend),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},Le.WriteCT_FormatOverride=function(e,t,r,n,o){e.writeElement(t+":"+r,function(){e.writeAttributeString("idx",""+o.idx)},function(){N.k(o.spPr)||Sa(e,t,"spPr",o.spPr),N.k(o.extLst)||Le.WriteCT_ExtensionList(e,t,"extLst","",o.extLst)})},Le.WriteCT_FormatOverrides=function(t,r,e,n,o){t.writeElement(r+":"+e,null,function(){for(var e=0;e<o.fmtOvr.length;e++)N.k(o.fmtOvr[e])||Le.WriteCT_FormatOverride(t,r,"fmtOvr","",o.fmtOvr[e])})},Le.WriteCT_HeaderFooter=function(e,t,r,n,o){e.writeElement(t+":"+r,function(){e.writeAttributeString("alignWithMargins",o.alignWithMargins?"1":"0"),e.writeAttributeString("differentOddEven",o.differentOddEven?"1":"0"),e.writeAttributeString("differentFirst",o.differentFirst?"1":"0")},function(){N.k(o.oddHeader)||e.writeElementString(t+":oddHeader",""+o.oddHeader),N.k(o.oddFooter)||e.writeElementString(t+":oddFooter",""+o.oddFooter),N.k(o.evenHeader)||e.writeElementString(t+":evenHeader",""+o.evenHeader),N.k(o.evenFooter)||e.writeElementString(t+":evenFooter",""+o.evenFooter),N.k(o.firstHeader)||e.writeElementString(t+":firstHeader",""+o.firstHeader),N.k(o.firstFooter)||e.writeElementString(t+":firstFooter",""+o.firstFooter)})},Le.WriteCT_PageMargins=function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("l",""+o.l),e.writeAttributeString("r",""+o.r),e.writeAttributeString("t",""+o.t),e.writeAttributeString("b",""+o.b),e.writeAttributeString("header",""+o.header),e.writeAttributeString("footer",""+o.footer)})},Le.WriteCT_PageSetup=function(e,t,r,n,o){e.writeLeafElement(t+":"+r,function(){e.writeAttributeString("paperSize",""+o.paperSize),e.writeAttributeString("firstPageNumber",""+o.firstPageNumber),e.writeAttributeString("orientation",p.Charts.ST_PageOrientation[o.orientation]),e.writeAttributeString("blackAndWhite",o.blackAndWhite?"1":"0"),e.writeAttributeString("draft",o.draft?"1":"0"),e.writeAttributeString("useFirstPageNumber",o.useFirstPageNumber?"1":"0"),e.writeAttributeString("horizontalDpi",""+o.horizontalDpi),e.writeAttributeString("verticalDpi",""+o.verticalDpi),e.writeAttributeString("copies",""+o.copies)})},Le.WriteCT_PrintSettings=function(e,t,r,n,o){e.writeElement(t+":"+r,null,function(){N.k(o.headerFooter)||Le.WriteCT_HeaderFooter(e,t,"headerFooter","",o.headerFooter),N.k(o.pageMargins)||Le.WriteCT_PageMargins(e,t,"pageMargins","",o.pageMargins),N.k(o.pageSetup)||Le.WriteCT_PageSetup(e,t,"pageSetup","",o.pageSetup)})},Le.WriteCT_ChartSpace=function(t,r,e,n,o,i){var a=n.chart&&n.chart.plotArea&&n.chart.plotArea.plotAreaRegion&&n.chart.plotArea.plotAreaRegion.series,s=[];a&&0<a.length&&(n.chart.plotArea.plotAreaRegion.series=Le.TranstateSeriesDataToId(a,o,i,s)),t.writeElement(r+":"+e,function(){t.writeAttributeString("xmlns:a",l.DrawingWriter.a),t.writeAttributeString("xmlns:r",l.DrawingWriter.r),t.writeAttributeString("xmlns:cx",Le.cx)},function(){var e=n.chartData||{};e.data=s,N.k(e)||Le.WriteCT_ChartData(t,r,"chartData","",e),N.k(n.chart)||Le.WriteCT_Chart(t,r,"chart","",n.chart),N.k(n.spPr)||Sa(t,r,"spPr",n.spPr),N.k(n.txPr)||bs(t,r,"txPr",n.txPr),N.k(n.clrMapOvr)||Do(t,r,"clrMapOvr",n.clrMapOvr),N.k(n.fmtOvrs)||Le.WriteCT_FormatOverrides(t,r,"fmtOvrs","",n.fmtOvrs),N.k(n.printSettings)||Le.WriteCT_PrintSettings(t,r,"printSettings","",n.printSettings),N.k(n.extLst)||Le.WriteCT_ExtensionList(t,r,"extLst","",n.extLst)})},Le.TranstateSeriesDataToId=function(e,t,r,n){var o,i,a,s,l,u,c,h,f=Le.TranslateNameSpace(t);for(o=0;o<e.length;o++)(a=(i=e[o]).tx&&i.tx.txData&&i.tx.txData.f&&i.tx.txData.f.formula)&&((s=f[a])&&(i.tx.txData.f.formula=s)),c={},h=u=void 0,((l=i.formulaObj||{}).numDim||l.strDim)&&(i.dataId={val:o}),l.numDim&&(h=0<r.length?r[r.length-1].name:null,u=this.CreateNameByLastName(h),r.push({name:u,formula:l.numDim,hidden:!0}),c.id=o,c.numDim=[],e[0]&&17===e[0].layoutId?c.numDim.push({type:p.Charts.ST_NumericDimensionType.val,f:{formula:u}}):c.numDim.push({type:p.Charts.ST_NumericDimensionType.size,f:{formula:u}})),l.strDim&&(h=0<r.length?r[r.length-1].name:null,u=this.CreateNameByLastName(h),r.push({name:u,formula:l.strDim,hidden:!0}),c.id=c.id||o,c.strDim=[],c.strDim.push({type:p.Charts.ST_StringDimensionType.cat,f:{formula:u}})),N.k(c.id)||n.push(c);return e},Le.CreateNameByLastName=function(e){e=(e=e||"0").replace(n,"");var t=parseInt(e,10)+1;return n+t},Le.TranslateNameSpace=function(e){var t,r,n={};for(t=0;t<e.length;t++)r=e[t].name,n[e[t].formula]=r;return n},Le.cx="http://schemas.microsoft.com/office/drawing/2014/chartex",l.DrawingWriter.chart2016Write=Le,l.DrawingWriter.WriteCT_ColorScheme=it,l.DrawingWriter.WriteCT_CustomColor=at,l.DrawingWriter.WriteCT_SupplementalFont=st,l.DrawingWriter.WriteCT_CustomColorList=lt,l.DrawingWriter.WriteCT_FontCollection=ut,l.DrawingWriter.WriteCT_EffectStyleItem=ct,l.DrawingWriter.WriteCT_FontScheme=ht,l.DrawingWriter.WriteCT_FillStyleList=ft,l.DrawingWriter.WriteCT_LineStyleList=dt,l.DrawingWriter.WriteCT_EffectStyleList=pt,l.DrawingWriter.WriteCT_BackgroundFillStyleList=gt,l.DrawingWriter.WriteCT_StyleMatrix=mt,l.DrawingWriter.WriteCT_BaseStyles=bt,l.DrawingWriter.WriteCT_OfficeArtExtension=Ct,l.DrawingWriter.WriteCT_creationId=wt,l.DrawingWriter.WriteCT_Angle=vt,l.DrawingWriter.WriteCT_PositiveFixedAngle=St,l.DrawingWriter.WriteCT_Percentage=xt,l.DrawingWriter.WriteCT_PositivePercentage=Tt,l.DrawingWriter.WriteCT_FixedPercentage=At,l.DrawingWriter.WriteCT_PositiveFixedPercentage=kt,l.DrawingWriter.WriteCT_Ratio=Mt,l.DrawingWriter.WriteCT_Point2D=It,l.DrawingWriter.WriteCT_PositiveSize2D=Et,l.DrawingWriter.WriteCT_ComplementTransform=Rt,l.DrawingWriter.WriteCT_InverseTransform=Dt,l.DrawingWriter.WriteCT_GrayscaleTransform=Nt,l.DrawingWriter.WriteCT_GammaTransform=Ft,l.DrawingWriter.WriteCT_InverseGammaTransform=_t,l.DrawingWriter.WriteCT_ScRgbColor=Pt,l.DrawingWriter.WriteCT_SRgbColor=Lt,l.DrawingWriter.WriteCT_HslColor=Ot,l.DrawingWriter.WriteCT_SystemColor=Bt,l.DrawingWriter.WriteCT_SchemeColor=jt,l.DrawingWriter.WriteCT_PresetColor=Ht,l.DrawingWriter.WriteCT_StyleColor=Gt,l.DrawingWriter.WriteCT_OfficeArtExtensionList=Ut,l.DrawingWriter.WriteCT_Scale2D=function(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.sx)||Mt(e,Te,"sx",n.sx),N.k(n.sy)||Mt(e,Te,"sy",n.sy)})},l.DrawingWriter.WriteCT_Transform2D=Wt,l.DrawingWriter.WriteCT_GroupTransform2D=Vt,l.DrawingWriter.WriteCT_Point3D=zt,l.DrawingWriter.WriteCT_Vector3D=qt,l.DrawingWriter.WriteCT_SphereCoords=Zt,l.DrawingWriter.WriteCT_RelativeRect=Yt,l.DrawingWriter.WriteCT_Color=Kt,l.DrawingWriter.WriteCT_ColorMRU=function(t,e,r,n){t.writeElement(e+":"+r,function(){n.scrgbClr?Xe(n.scrgbClr,function(e){Pt(t,Te,S,e)}):n.srgbClr?Xe(n.srgbClr,function(e){Lt(t,Te,x,e)}):n.hslClr?Xe(n.hslClr,function(e){Ot(t,Te,T,e)}):n.sysClr?Xe(n.sysClr,function(e){Bt(t,Te,A,e)}):n.schemeClr?Xe(n.schemeClr,function(e){jt(t,Te,k,e)}):n.prstClr&&Xe(n.prstClr,function(e){Ht(t,Te,M,e)})})},l.DrawingWriter.WriteCT_EmbeddedWAVAudioFile=Xt,l.DrawingWriter.WriteCT_Hyperlink=Jt,l.DrawingWriter.WriteCT_Boolean=Qt,l.DrawingWriter.WriteCT_Double=$t,l.DrawingWriter.WriteCT_UnsignedInt=er,l.DrawingWriter.WriteCT_Int=tr,l.DrawingWriter.WriteCT_RelId=rr,l.DrawingWriter.WriteCT_Extension=nr,l.DrawingWriter.WriteCT_ExtensionList=or,l.DrawingWriter.WriteCT_NumVal=ir,l.DrawingWriter.WriteCT_NumData=ar,l.DrawingWriter.WriteCT_NumRef=sr,l.DrawingWriter.WriteCT_NumDataSource=lr,l.DrawingWriter.WriteCT_StrVal=ur,l.DrawingWriter.WriteCT_StrData=cr,l.DrawingWriter.WriteCT_StrRef=hr,l.DrawingWriter.WriteCT_Tx=fr,l.DrawingWriter.WriteCT_TextLanguageID=function(e,t,r,n){je(e,t,r,n,h)},l.DrawingWriter.WriteCT_Lvl=function(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.pt,function(e){ur(t,Ie,"pt",e)})})},l.DrawingWriter.WriteCT_MultiLvlStrData=dr,l.DrawingWriter.WriteCT_MultiLvlStrRef=pr,l.DrawingWriter.WriteCT_AxDataSource=gr,l.DrawingWriter.WriteCT_SerTx=mr,l.DrawingWriter.WriteCT_LayoutTarget=br,l.DrawingWriter.WriteCT_LayoutMode=yr,l.DrawingWriter.WriteCT_ManualLayout=Cr,l.DrawingWriter.WriteCT_Layout=wr,l.DrawingWriter.WriteCT_Title=vr,l.DrawingWriter.WriteCT_RotX=Sr,l.DrawingWriter.WriteCT_HPercent=xr,l.DrawingWriter.WriteCT_RotY=Tr,l.DrawingWriter.WriteCT_DepthPercent=Ar,l.DrawingWriter.WriteCT_Perspective=kr,l.DrawingWriter.WriteCT_View3D=Mr,l.DrawingWriter.WriteCT_Surface=Ir,l.DrawingWriter.WriteCT_DTable=Er,l.DrawingWriter.WriteCT_GapAmount=Rr,l.DrawingWriter.WriteCT_Overlap=Dr,l.DrawingWriter.WriteCT_BubbleScale=Nr,l.DrawingWriter.WriteCT_SizeRepresents=Fr,l.DrawingWriter.WriteCT_FirstSliceAng=_r,l.DrawingWriter.WriteCT_HoleSize=Pr,l.DrawingWriter.WriteCT_SplitType=Lr,l.DrawingWriter.WriteCT_CustSplit=Or,l.DrawingWriter.WriteCT_SecondPieSize=Br,l.DrawingWriter.WriteCT_NumFmt=jr,l.DrawingWriter.WriteCT_LblAlgn=Hr,l.DrawingWriter.WriteCT_DLblPos=Gr,l.DrawingWriter.WriteCT_DLbl=Ur,l.DrawingWriter.WriteCT_DLbls=Wr,l.DrawingWriter.WriteCT_MarkerStyle=Vr,l.DrawingWriter.WriteCT_MarkerSize=zr,l.DrawingWriter.WriteCT_Marker=qr,l.DrawingWriter.WriteCT_DPt=Zr,l.DrawingWriter.WriteCT_TrendlineType=Yr,l.DrawingWriter.WriteCT_Order=Kr,l.DrawingWriter.WriteCT_Period=Xr,l.DrawingWriter.WriteCT_TrendlineLbl=Jr,l.DrawingWriter.WriteCT_Trendline=Qr,l.DrawingWriter.WriteCT_ErrDir=$r,l.DrawingWriter.WriteCT_ErrBarType=en,l.DrawingWriter.WriteCT_ErrValType=tn,l.DrawingWriter.WriteCT_ErrBars=rn,l.DrawingWriter.WriteCT_UpDownBar=nn,l.DrawingWriter.WriteCT_UpDownBars=on,l.DrawingWriter.WriteCT_LineSer=an,l.DrawingWriter.WriteCT_ScatterSer=sn,l.DrawingWriter.WriteCT_RadarSer=ln,l.DrawingWriter.WriteCT_BarSer=un,l.DrawingWriter.WriteCT_AreaSer=cn,l.DrawingWriter.WriteCT_PieSer=hn,l.DrawingWriter.WriteCT_BubbleSer=fn,l.DrawingWriter.WriteCT_SurfaceSer=dn,l.DrawingWriter.WriteCT_Grouping=pn,l.DrawingWriter.WriteCT_ChartLines=gn,l.DrawingWriter.WriteCT_LineChart=mn,l.DrawingWriter.WriteCT_Line3DChart=bn,l.DrawingWriter.WriteCT_StockChart=yn,l.DrawingWriter.WriteCT_ScatterStyle=Cn,l.DrawingWriter.WriteCT_ScatterChart=wn,l.DrawingWriter.WriteCT_RadarStyle=vn,l.DrawingWriter.WriteCT_RadarChart=Sn,l.DrawingWriter.WriteCT_BarGrouping=xn,l.DrawingWriter.WriteCT_BarDir=Tn,l.DrawingWriter.WriteCT_ShapeBox=An,l.DrawingWriter.WriteCT_BarChart=kn,l.DrawingWriter.WriteCT_Bar3DChart=Mn,l.DrawingWriter.WriteCT_AreaChart=In,l.DrawingWriter.WriteCT_Area3DChart=En,l.DrawingWriter.WriteCT_PieChart=Rn,l.DrawingWriter.WriteCT_Pie3DChart=Dn,l.DrawingWriter.WriteCT_DoughnutChart=Nn,l.DrawingWriter.WriteCT_OfPieType=Fn,l.DrawingWriter.WriteCT_OfPieChart=_n,l.DrawingWriter.WriteCT_BubbleChart=Pn,l.DrawingWriter.WriteCT_BandFmt=Ln,l.DrawingWriter.WriteCT_BandFmts=On,l.DrawingWriter.WriteCT_SurfaceChart=Bn,l.DrawingWriter.WriteCT_Surface3DChart=jn,l.DrawingWriter.WriteCT_AxPos=Hn,l.DrawingWriter.WriteCT_Crosses=Gn,l.DrawingWriter.WriteCT_CrossBetween=Un,l.DrawingWriter.WriteCT_TickMark=Wn,l.DrawingWriter.WriteCT_TickLblPos=Vn,l.DrawingWriter.WriteCT_Skip=zn,l.DrawingWriter.WriteCT_TimeUnit=qn,l.DrawingWriter.WriteCT_AxisUnit=Zn,l.DrawingWriter.WriteCT_BuiltInUnit=Yn,l.DrawingWriter.WriteCT_PictureFormat=Kn,l.DrawingWriter.WriteCT_PictureStackUnit=Xn,l.DrawingWriter.WriteCT_PictureOptions=Jn,l.DrawingWriter.WriteCT_DispUnitsLbl=Qn,l.DrawingWriter.WriteCT_DispUnits=$n,l.DrawingWriter.WriteCT_Orientation=eo,l.DrawingWriter.WriteCT_LogBase=to,l.DrawingWriter.WriteCT_Scaling=ro,l.DrawingWriter.WriteCT_LblOffset=no,l.DrawingWriter.WriteCT_CatAx=oo,l.DrawingWriter.WriteCT_DateAx=io,l.DrawingWriter.WriteCT_SerAx=ao,l.DrawingWriter.WriteCT_ValAx=so,l.DrawingWriter.WriteCT_PlotArea=lo,l.DrawingWriter.WriteCT_PivotFmt=uo,l.DrawingWriter.WriteCT_PivotFmts=function(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.pivotFmt,function(e){uo(t,Ie,"pivotFmt",e)})})},l.DrawingWriter.WriteCT_LegendPos=co,l.DrawingWriter.WriteCT_LegendEntry=ho,l.DrawingWriter.WriteCT_Legend=fo,l.DrawingWriter.WriteCT_DispBlanksAs=po,l.DrawingWriter.WriteCT_DispNaAsBlank=go,l.DrawingWriter.WriteCT_Chart=mo,l.DrawingWriter.WriteCT_Style=bo,l.DrawingWriter.WriteCT_PivotSource=yo,l.DrawingWriter.WriteCT_Protection=Co,l.DrawingWriter.WriteCT_HeaderFooter=wo,l.DrawingWriter.WriteCT_PageMargins=vo,l.DrawingWriter.WriteCT_ExternalData=So,l.DrawingWriter.WriteCT_PageSetup=xo,l.DrawingWriter.WriteCT_PrintSettings=To,l.DrawingWriter.WriteCT_ChartSpace=function(f,e,t,d){f.writeElement("c:"+t,function(){f.writeAttributeString("xmlns:c",l.DrawingWriter.c),f.writeAttributeString("xmlns:a",l.DrawingWriter.a),f.writeAttributeString("xmlns:r",l.DrawingWriter.r)},function(){var e=d.roundedCorners,t=d.style,r=d.clrMapOvr,n=d.pivotSource,o=d.protection,i=d.chart,a=d.spPr,s=d.txPr,l=d.externalData,u=d.printSettings,c=d.userShapes,h=d.extLst;N.k(e)||Qt(f,Ie,"roundedCorners",e),N.k(t)||bo(f,Ie,be,t),N.k(r)||Do(f,Te,"clrMapOvr",r),N.k(n)||yo(f,Ie,"pivotSource",n),N.k(o)||Co(f,Ie,"protection",o),N.k(i)||mo(f,Ie,"chart",i),N.k(a)||Sa(f,Ie,B,a),N.k(s)||bs(f,Ie,j,s),N.k(l)||So(f,Ie,"externalData",l),N.k(u)||To(f,Ie,"printSettings",u),N.k(c)||Eo(f,Ie,"userShapes",c),N.k(h)||or(f,Ie,w,h)})},l.DrawingWriter.WriteCT_DLblExtensionList=Ao,l.DrawingWriter.WriteCT_DLblExt=ko,l.DrawingWriter.WriteCT_DLblsExtensionList=Mo,l.DrawingWriter.WriteCT_DLblsExt=Io,l.DrawingWriter.WriteCT_UserShapes=Eo,l.DrawingWriter.WriteCT_InvertSolidFillFmt=Ro,l.DrawingWriter.WriteCT_ColorMapping=Do,l.DrawingWriter.WriteCT_FullRef=function(e,t,r,n){Ge(e,t,r,n)},l.DrawingWriter.WriteCT_LevelRef=function(e,t,r,n){Ge(e,t,r,n)},l.DrawingWriter.WriteCT_FormulaRef=function(e,t,r,n){Ge(e,t,r,n)},l.DrawingWriter.WriteCT_FilteredSeriesTitle=function(e,t,r,n){He(e,t,r,n,fr,Ie,"tx")},l.DrawingWriter.WriteCT_FilteredCategoryTitle=function(e,t,r,n){He(e,t,r,n,gr,Ie,"cat")},l.DrawingWriter.WriteCT_FilteredBarSer=function(e,t,r,n){He(e,t,r,n,un,Ie,te)},l.DrawingWriter.WriteCT_FilteredLineSer=function(e,t,r,n){He(e,t,r,n,an,Ie,te)},l.DrawingWriter.WriteCT_FilteredScatterSer=function(e,t,r,n){He(e,t,r,n,sn,Ie,te)},l.DrawingWriter.WriteCT_FilteredAreaSer=function(e,t,r,n){He(e,t,r,n,cn,Ie,te)},l.DrawingWriter.WriteCT_FilteredPieSer=function(e,t,r,n){He(e,t,r,n,hn,Ie,te)},l.DrawingWriter.WriteCT_FilteredBubbleSer=function(e,t,r,n){He(e,t,r,n,fn,Ie,te)},l.DrawingWriter.WriteCT_FilteredRadarSer=function(e,t,r,n){He(e,t,r,n,ln,Ie,te)},l.DrawingWriter.WriteCT_FilteredSurfaceSer=function(e,t,r,n){He(e,t,r,n,dn,Ie,te)},l.DrawingWriter.WriteCT_SeriesDataLabelsRange=No,l.DrawingWriter.WriteCT_CategoryFilterException=Fo,l.DrawingWriter.WriteCT_CategoryFilterExceptions=function(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.categoryFilterException,function(e){Fo(t,Ee,"categoryFilterException",e)})})},l.DrawingWriter.WriteCT_DataLabelFieldTableEntry=_o,l.DrawingWriter.WriteCT_DataLabelFieldTable=Po,l.DrawingWriter.WriteCT_GraphicFrameNonVisual=function(e,t,r,n){Ye(e,t,r,n,Te)},l.DrawingWriter.WriteCT_CdrPosition=Lo,l.DrawingWriter.WriteCT_RelSizeAnchor=Oo,l.DrawingWriter.WriteCT_AbsSizeAnchor=Bo,l.DrawingWriter.WriteCT_ChartDrawing=function(r,e,t,n){r.writeElement("c:"+t,function(){r.writeAttributeString("xmlns:c",l.DrawingWriter.c),r.writeAttributeString("xmlns:cdr",l.DrawingWriter.cdr),r.writeAttributeString("xmlns:a",l.DrawingWriter.a)},function(){var e=n.relSizeAnchor,t=n.absSizeAnchor;e&&e.forEach(function(e){e&&Oo(r,Ae,"relSizeAnchor",e)}),t&&t.forEach(function(e){e&&Bo(r,Ae,"absSizeAnchor",e)})})},l.DrawingWriter.WriteCT_ConnectorLocking=jo,l.DrawingWriter.WriteCT_ShapeLocking=Ho,l.DrawingWriter.WriteCT_PictureLocking=Go,l.DrawingWriter.WriteCT_GroupLocking=Uo,l.DrawingWriter.WriteCT_GraphicalObjectFrameLocking=function(e,t,r,n){e.writeElement(t+":"+r,function(){!0===n.noGrp&&e.writeAttributeString("noGrp","1"),!0===n.noDrilldown&&e.writeAttributeString("noDrilldown","1"),!0===n.noSelect&&e.writeAttributeString("noSelect","1"),!0===n.noChangeAspect&&e.writeAttributeString("noChangeAspect","1"),!0===n.noMove&&e.writeAttributeString("noMove","1"),!0===n.noResize&&e.writeAttributeString("noResize","1")},function(){N.k(n.extLst)||Ut(e,Te,w,n.extLst)})},l.DrawingWriter.WriteCT_NonVisualDrawingProps=Wo,l.DrawingWriter.WriteCT_NonVisualDrawingShapeProps=Vo,l.DrawingWriter.WriteCT_NonVisualConnectorProperties=zo,l.DrawingWriter.WriteCT_NonVisualPictureProperties=qo,l.DrawingWriter.WriteCT_NonVisualGroupDrawingShapeProps=Zo,l.DrawingWriter.WriteCT_NonVisualGraphicFrameProperties=Yo,l.DrawingWriter.WriteCT_GraphicalObjectDataContent=Ko,l.DrawingWriter.WriteCT_GraphicalObjectData=Xo,l.DrawingWriter.WriteCT_GraphicalObject=Jo,l.DrawingWriter.WriteCT_Camera=Qo,l.DrawingWriter.WriteCT_LightRig=$o,l.DrawingWriter.WriteCT_Scene3D=ei,l.DrawingWriter.WriteCT_Backdrop=ti,l.DrawingWriter.WriteCT_Bevel=ri,l.DrawingWriter.WriteCT_Shape3D=ni,l.DrawingWriter.WriteCT_FlatText=oi,l.DrawingWriter.WriteCT_AlphaBiLevelEffect=ii,l.DrawingWriter.WriteCT_AlphaCeilingEffect=ai,l.DrawingWriter.WriteCT_AlphaFloorEffect=si,l.DrawingWriter.WriteCT_AlphaInverseEffect=li,l.DrawingWriter.WriteCT_AlphaModulateFixedEffect=ui,l.DrawingWriter.WriteCT_AlphaOutsetEffect=ci,l.DrawingWriter.WriteCT_AlphaReplaceEffect=hi,l.DrawingWriter.WriteCT_BiLevelEffect=fi,l.DrawingWriter.WriteCT_BlurEffect=di,l.DrawingWriter.WriteCT_ColorChangeEffect=pi,l.DrawingWriter.WriteCT_ColorReplaceEffect=gi,l.DrawingWriter.WriteCT_DuotoneEffect=mi,l.DrawingWriter.WriteCT_GlowEffect=bi,l.DrawingWriter.WriteCT_GrayscaleEffect=yi,l.DrawingWriter.WriteCT_HSLEffect=Ci,l.DrawingWriter.WriteCT_InnerShadowEffect=wi,l.DrawingWriter.WriteCT_LuminanceEffect=vi,l.DrawingWriter.WriteCT_OuterShadowEffect=Si,l.DrawingWriter.WriteCT_PresetShadowEffect=xi,l.DrawingWriter.WriteCT_ReflectionEffect=Ti,l.DrawingWriter.WriteCT_RelativeOffsetEffect=Ai,l.DrawingWriter.WriteCT_SoftEdgesEffect=ki,l.DrawingWriter.WriteCT_TintEffect=Mi,l.DrawingWriter.WriteCT_TransformEffect=Ii,l.DrawingWriter.WriteCT_NoFillProperties=Ei,l.DrawingWriter.WriteCT_SolidColorFillProperties=Ri,l.DrawingWriter.WriteCT_LinearShadeProperties=Di,l.DrawingWriter.WriteCT_PathShadeProperties=Ni,l.DrawingWriter.WriteCT_GradientStop=Fi,l.DrawingWriter.WriteCT_GradientStopList=_i,l.DrawingWriter.WriteCT_GradientFillProperties=Pi,l.DrawingWriter.WriteCT_TileInfoProperties=Li,l.DrawingWriter.WriteCT_StretchInfoProperties=Oi,l.DrawingWriter.WriteCT_Blip=Bi,l.DrawingWriter.WriteCT_BlipBlob=function(e,t,r,n){e.writeElement(t+":"+r,function(){N.k(n.type)||0===n.type||e.writeAttributeString(o,p.Charts.ST_BobType[n.type])},function(){N.k(n.blob)||e.writeElementString("a:blob",n.blob)})},l.DrawingWriter.WriteCT_BlipFillProperties=ji,l.DrawingWriter.WriteCT_PatternFillProperties=Hi,l.DrawingWriter.WriteCT_GroupFillProperties=Gi,l.DrawingWriter.WriteCT_FillProperties=Ui,l.DrawingWriter.WriteCT_FillEffect=Wi,l.DrawingWriter.WriteCT_FillOverlayEffect=Vi,l.DrawingWriter.WriteCT_EffectReference=zi,l.DrawingWriter.WriteCT_EffectContainer=qi,l.DrawingWriter.WriteCT_AlphaModulateEffect=Zi,l.DrawingWriter.WriteCT_BlendEffect=Yi,l.DrawingWriter.WriteCT_EffectList=Ki,l.DrawingWriter.WriteCT_EffectProperties=function(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.effectLst,t=n.effectDag;N.k(e)||Ki(r,Te,y,e),N.k(t)||qi(r,Te,C,t)})},l.DrawingWriter.WriteCT_GeomGuide=Xi,l.DrawingWriter.WriteCT_GeomGuideList=Ji,l.DrawingWriter.WriteCT_AdjPoint2D=Qi,l.DrawingWriter.WriteCT_GeomRect=$i,l.DrawingWriter.WriteCT_XYAdjustHandle=ea,l.DrawingWriter.WriteCT_PolarAdjustHandle=ta,l.DrawingWriter.WriteCT_ConnectionSite=ra,l.DrawingWriter.WriteCT_AdjustHandleList=na,l.DrawingWriter.WriteCT_ConnectionSiteList=oa,l.DrawingWriter.WriteCT_Connection=ia,l.DrawingWriter.WriteCT_Path2DMoveTo=function(e,t,r,n){He(e,t,r,n,Qi,Te,"pt")},l.DrawingWriter.WriteCT_Path2DLineTo=function(e,t,r,n){He(e,t,r,n,Qi,Te,"pt")},l.DrawingWriter.WriteCT_Path2DArcTo=aa,l.DrawingWriter.WriteCT_Path2DQuadBezierTo=function(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.pt,function(e){Qi(t,Te,"pt",e)})})},l.DrawingWriter.WriteCT_Path2DCubicBezierTo=function(t,e,r,n){t.writeElement(e+":"+r,function(){Xe(n.pt,function(e){Qi(t,Te,"pt",e)})})},l.DrawingWriter.WriteCT_Path2DClose=sa,l.DrawingWriter.WriteCT_Path2D=la,l.DrawingWriter.WriteCT_AdjPoint2DList=ua,l.DrawingWriter.WriteCT_Path2DList=ca,l.DrawingWriter.WriteCT_PresetGeometry2D=ha,l.DrawingWriter.WriteCT_PresetTextShape=fa,l.DrawingWriter.WriteCT_CustomGeometry2D=da,l.DrawingWriter.WriteCT_LineEndProperties=pa,l.DrawingWriter.WriteCT_LineJoinBevel=ga,l.DrawingWriter.WriteCT_LineJoinRound=ma,l.DrawingWriter.WriteCT_LineJoinMiterProperties=ba,l.DrawingWriter.WriteCT_PresetLineDashProperties=ya,l.DrawingWriter.WriteCT_DashStop=Ca,l.DrawingWriter.WriteCT_DashStopList=wa,l.DrawingWriter.WriteCT_LineProperties=va,l.DrawingWriter.WriteCT_ShapeProperties=Sa,l.DrawingWriter.WriteCT_GroupShapeProperties=xa,l.DrawingWriter.WriteCT_StyleMatrixReference=Ta,l.DrawingWriter.WriteCT_FontReference=Aa,l.DrawingWriter.WriteCT_ShapeStyle=ka,l.DrawingWriter.WriteCT_AnchorClientData=Ma,l.DrawingWriter.WriteCT_ShapeNonVisual=Ia,l.DrawingWriter.WriteCT_ShapeNonVisualForCdr=Ea,l.DrawingWriter.WriteCT_ShapeNonVisualForXdr=Ra,l.DrawingWriter.WriteCT_Shape=Da,l.DrawingWriter.WriteCT_ShapeForCdr=Na,l.DrawingWriter.WriteCT_ShapeForXdr=Fa,l.DrawingWriter.WriteCT_ConnectorNonVisual=_a,l.DrawingWriter.WriteCT_ConnectorNonVisualCdr=function(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.cNvPr,t=n.cNvCxnSpPr;N.k(e)||Wo(r,Ae,g,e),N.k(t)||zo(r,Ae,"cNvCxnSpPr",t)})},l.DrawingWriter.WriteCT_Connector=Pa,l.DrawingWriter.WriteCT_ConnectorCdr=La,l.DrawingWriter.WriteCT_PictureNonVisualGroup=Oa,l.DrawingWriter.WriteCT_PictureNonVisual=Ba,l.DrawingWriter.WriteCT_PictureNonVisualrelSizeAnchor=ja,l.DrawingWriter.WriteCT_PictureNonVisualOneCellAnchor=function(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.cNvPr,t=n.cNvPicPr;N.k(e)||Wo(r,Me,g,e),N.k(t)||qo(r,Me,Ce,t)})},l.DrawingWriter.WriteCT_PictureNonVisualForXdr=Ha,l.DrawingWriter.WriteCT_PictureGroup=Ga,l.DrawingWriter.WriteCT_PictureRelSizeAnchor=Ua,l.DrawingWriter.WriteCT_Picture=Wa,l.DrawingWriter.WriteCT_PictureOneCellAnchor=Va,l.DrawingWriter.WriteCT_PictureForXdr=za,l.DrawingWriter.WriteCT_GraphicalObjectFrameNonVisual=qa,l.DrawingWriter.WriteCT_GraphicalObjectFrameNonVisual_cdr=Za,l.DrawingWriter.WriteCT_GraphicalObjectFrame=Ya,l.DrawingWriter.WriteCT_GraphicalObjectFrame_cdr=Ka,l.DrawingWriter.WriteCT_GroupShapeNonVisual=Xa,l.DrawingWriter.WriteCT_GroupShape=Ja,l.DrawingWriter.WriteCT_Position=Qa,l.DrawingWriter.WriteCT_TwoCellAnchor=$a,l.DrawingWriter.WriteCT_AlternateContent=es,l.DrawingWriter.WriteCT_Choice=ts,l.DrawingWriter.WriteCT_FallBack=rs,l.DrawingWriter.WriteCT_OneCellAnchor=ns,l.DrawingWriter.WriteCT_AbsoluteAnchor=os,l.DrawingWriter.WriteCT_Drawing=function(t,e,r,n){t.writeElement("xdr:"+r,function(){t.writeAttributeString("xmlns:a",l.DrawingWriter.a),t.writeAttributeString("xmlns:xdr",l.DrawingWriter.xdr)},function(){n.AnchorBaseList.forEach(function(e){1===e.anchorType?ns(t,Me,"oneCellAnchor",e):0===e.anchorType?$a(t,Me,"twoCellAnchor",e):2===e.anchorType&&os(t,Me,"absoluteAnchor",e)})})},l.DrawingWriter.WriteCT_DefaultShapeDefinition=is,l.DrawingWriter.WriteCT_ObjectStyleDefaults=as,l.DrawingWriter.WriteCT_EmptyElement=ss,l.DrawingWriter.WriteCT_ColorMappingOverride=function(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.masterClrMapping,t=n.overrideClrMapping;N.k(e)||ss(r,Te,"masterClrMapping"),N.k(t)||Do(r,Te,"overrideClrMapping",t)})},l.DrawingWriter.WriteCT_ColorSchemeAndMapping=ls,l.DrawingWriter.WriteCT_ColorSchemeList=us,l.DrawingWriter.WriteCT_OfficeStyleSheet=function(i,e,t,a){i.writeElement(e+":"+t,function(){var e=a.name;Oe(e)||i.writeAttributeString(f,e)},function(){var e=a.themeElements,t=a.objectDefaults,r=a.extraClrSchemeLst,n=a.custClrLst,o=a.extLst;N.k(e)||bt(i,Te,"themeElements",e),N.k(t)||as(i,Te,"objectDefaults",t),N.k(r)||us(i,Te,"extraClrSchemeLst",r),N.k(n)||lt(i,Te,"custClrLst",n),N.k(o)||Ut(i,Te,w,o)})},l.DrawingWriter.WriteCT_BaseStylesOverride=function(n,e,t,o){n.writeElement(e+":"+t,function(){var e=o.clrScheme,t=o.fontScheme,r=o.fmtScheme;N.k(e)||it(n,Te,z,e),N.k(t)||ht(n,Te,q,t),N.k(r)||mt(n,Te,Z,r)})},l.DrawingWriter.WriteCT_ClipboardStyleSheet=function(r,e,t,n){r.writeElement(e+":"+t,function(){var e=n.themeElements,t=n.clrMap;N.k(e)||bt(r,Te,"themeElements",e),N.k(t)||Do(r,Te,"clrMap",t)})},l.DrawingWriter.WriteCT_TextParagraph=cs,l.DrawingWriter.WriteCT_TextListStyle=hs,l.DrawingWriter.WriteCT_TextNormalAutofit=fs,l.DrawingWriter.WriteCT_TextShapeAutofit=ds,l.DrawingWriter.WriteCT_TextNoAutofit=ps,l.DrawingWriter.getRotationData=gs,l.DrawingWriter.WriteCT_TextBodyProperties=ms,l.DrawingWriter.WriteCT_TextBody=bs,l.DrawingWriter.WriteCT_TextBulletColorFollowText=ys,l.DrawingWriter.WriteCT_TextBulletSizeFollowText=Cs,l.DrawingWriter.WriteCT_TextBulletSizePercent=ws,l.DrawingWriter.WriteCT_TextBulletSizePoint=vs,l.DrawingWriter.WriteCT_TextBulletTypefaceFollowText=Ss,l.DrawingWriter.WriteCT_TextAutonumberBullet=xs,l.DrawingWriter.WriteCT_TextCharBullet=Ts,l.DrawingWriter.WriteCT_TextBlipBullet=As,l.DrawingWriter.WriteCT_TextNoBullet=ks,l.DrawingWriter.WriteCT_TextFont=Ms,l.DrawingWriter.WriteCT_TextUnderlineLineFollowText=Is,l.DrawingWriter.WriteCT_TextUnderlineFillFollowText=Es,l.DrawingWriter.WriteCT_TextUnderlineFillGroupWrapper=Rs,l.DrawingWriter.WriteCT_TextCharacterProperties=Ds,l.DrawingWriter.WriteCT_TextSpacingPercent=Ns,l.DrawingWriter.WriteCT_TextSpacingPoint=Fs,l.DrawingWriter.WriteCT_TextTabStop=_s,l.DrawingWriter.WriteCT_TextTabStopList=Ps,l.DrawingWriter.WriteCT_TextLineBreak=Ls,l.DrawingWriter.WriteCT_TextSpacing=Os,l.DrawingWriter.WriteCT_TextParagraphProperties=Bs,l.DrawingWriter.WriteCT_TextField=js,l.DrawingWriter.WriteCT_RegularTextRun=Hs},"./src/xlsx-io/writer/comment-writer.ts":function(e,t,r){"use strict";var l,n,o,a,u,s;Object.defineProperty(t,"__esModule",{value:!0}),l=r("./src/common/common.ts"),n=r("./src/xml-io/xml-writer.ts"),o=r("./src/common/excel-types.ts"),a=r("./src/xlsx-io/common/color-writer.ts"),u=r("./src/datamodel/excel-style.ts"),s=l.Util.sa,t.writeComments=function(e,t){var r=new n.XmlWriter;return r.writeDocument(),r.writeElement("comments",function(){r.writeAttributeString("xmlns",o.XFileConstants.qd)},function(){var e;(e=r).writeElement("authors",void 0,function(){e.writeElement("author",void 0,function(){e.writeValue("Author")})}),r.writeElement("commentList",function(){t.forEach(function(e){var o,i;i=e,(o=r).writeElement("comment",function(){o.writeAttributeString("ref",l.IndexHelper.I(i.col)+(i.row+1)),o.writeAttributeString("authorId","0")},function(){o.writeElement("text",function(){o.writeElement("r",function(){var e,t,r;o.writeElement("rPr",function(){var e,t,r,n=i.fontWeight;(r=n)&&(-1!==r.toLowerCase().indexOf("bold")||400<parseInt(r,10))&&o.writeLeafElement("b"),n=i.fontStyle,(t=n)&&-1!==["italic","oblique"].indexOf(t.toLowerCase().trim())&&o.writeLeafElement("i"),(e=i.textDecoration)&&(1&e&&o.writeLeafElement("u"),8&e&&o.writeLeafElement("u",function(){o.writeAttributeString("val",u.UnderLineStyle[2])}),2&e&&o.writeLeafElement("strike")),(n=i.fontSize)&&o.writeLeafElement("sz",function(){o.writeAttributeString("val",n)}),(n=i.foreColor)?a.writeColor(o,"color",n):o.writeLeafElement("color",function(){o.writeAttributeString("indexed","81")}),(n=i.fontFamily)&&o.writeLeafElement("rFont",function(){o.writeAttributeString("val",n)}),o.writeLeafElement("family",function(){o.writeAttributeString("val","2")})}),e=i.text,t=l.k(e)?"":e,r=t.length!==t.trim().length,o.writeElement("t",function(){r&&o.writeAttributeString("xml:space","preserve")},function(){o.writeValue(s(t))})})})})})})}),r.getXmlString()},t.writeCommentShapes=function(e,t,r){var s=new n.XmlWriter;return s.writeElement("xml",function(){s.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),s.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),s.writeAttributeString("xmlns:x","urn:schemas-microsoft-com:office:excel")},function(){var i=1024*(t+1)+1;function a(e){return e&&0<=e.indexOf("rgb")?"#"+u.ColorHelper.fromHtmlColor(e).toString(16).substr(-6):e}s.writeElement("o:shapelayout",function(){s.writeAttributeString("v:ext","edit")},function(){s.writeLeafElement("o:idmap",function(){s.writeAttributeString("v:ext","edit"),s.writeAttributeString("data","1")})}),s.writeElement("v:shapetype",function(){s.writeAttributeString("id","_x0000_t202"),s.writeAttributeString("coordsize","21600,21600"),s.writeAttributeString("o:spt","202"),s.writeAttributeString("path","m,l,21600r21600,l21600,xe")},function(){s.writeLeafElement("v:stroke",function(){s.writeAttributeString("joinstyle","miter")}),s.writeLeafElement("v:path",function(){s.writeAttributeString("gradientshapeok","t"),s.writeAttributeString("o:connecttype","rect")})}),r.forEach(function(n){var o=n.inset;s.writeElement("v:shape",function(){var e,t,r;s.writeAttributeString("id","_x0000_s"+i),i++,s.writeAttributeString("type","#_x0000_t202"),s.writeAttributeString("style",(t=["position:absolute"],0<=(r=(e=n).marginLeft)&&t.push("margin-left:"+r+"pt"),0<=(r=e.marginTop)&&t.push("margin-top:"+r+"pt"),(r=e.width)&&t.push("width:"+r),(r=e.height)&&t.push("height:"+r),t.push("z-index:"+e.zIndex),(r=e.visibility)&&t.push("visibility:"+r),t.join(";"))),s.writeAttributeString("fillcolor",a(n.backColor)),s.writeAttributeString("strokecolor",a(n.borderColor)),s.writeAttributeString("strokeweight",""+n.borderWidth),o||s.writeAttributeString("o:insetmode","auto")},function(){var e=n.dashStyle,t=n.lineStyle;e?s.writeLeafElement("v:stroke",function(){s.writeAttributeString("dashstyle",e)}):t&&s.writeLeafElement("v:stroke",function(){s.writeAttributeString("linestyle",t)}),s.writeLeafElement("v:fill",function(){var e=n.opacity;l.k(e)||1===e||s.writeAttributeString("opacity",Math.floor(65535*e)+"f"),s.writeAttributeString("color2","#ffffe1")}),s.writeLeafElement("v:shadow",function(){s.writeAttributeString("color","black"),s.writeAttributeString("obscured","t")}),s.writeLeafElement("v:path",function(){s.writeAttributeString("o:connecttype","none")}),s.writeElement("v:textbox",function(){s.writeAttributeString("style","mso-direction-alt:auto"+(n.autoSize?";mso-fit-shape-to-text:t":"")),o&&s.writeAttributeString("inset",o)},function(){s.writeElement("div",function(){s.writeAttributeString("style","text-align:"+n.hAlign.toLowerCase())},null)}),s.writeElement("x:ClientData",function(){s.writeAttributeString("ObjectType","Note")},function(){!1===n.dynamicMove&&s.writeLeafElement("x:MoveWithCells"),!1===n.dynamicSize&&s.writeLeafElement("x:SizeWithCells"),!1===n.locked&&s.writeElementString("x:Locked","False"),!1===n.lockText&&s.writeElementString("x:LockText","False"),s.writeElementString("x:AutoFill","False");var e=n.hAlign;"Left"!==e&&s.writeElementString("x:TextHAlign",e),s.writeElementString("x:Row",n.row),s.writeElementString("x:Column",n.col),1===n.displayMode&&s.writeLeafElement("x:Visible")})})})}),s.getXmlString()}},"./src/xlsx-io/writer/conditionalformat-writer.ts":function(e,t,r){"use strict";var s,l,n,u,o,i,c,h,f,d,p,g,a;function m(e){var t=""+e;return"="===t.charAt(0)?t.substr(1):t}function b(e){return"string"==typeof e&&"="===e[0]?e.substr(1):e}function y(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):l.k(e)?e:""+e}function C(e){var t,r,n;if(!e||!e.ranges)return null;if((t=e.ranges[0]).row<0||t.col<0)return null;if(r=l.IndexHelper.I(t.col)+(t.row+1),n=t.rowCount===o.ExcelConstants.sb?w("${0}:${1}",l.IndexHelper.I(t.col),l.IndexHelper.I(t.col+t.colCount-1)):t.colCount===o.ExcelConstants.rb?w("${0}:${1}",t.row+1,t.row+t.rowCount):w("${0}${1}:${2}${3}",l.IndexHelper.I(t.col),t.row+1,l.IndexHelper.I(t.col+t.colCount-1),t.row+t.rowCount),"top10"===e.type)return e.bottom?e.percent?w("IF(INT(COUNT({0})*{1}%)>0,SMALL({0},INT(COUNT({0})*{1}%)),MIN({0}))>={2}",n,e.rank,r):w("SMALL(({0}),MIN({1},COUNT({0})))>={2}",n,e.rank,r):e.percent?w("IF(INT(COUNT({0})*{1}%)>0,LARGE({0},INT(COUNT({0})*{1}%)),MIN({0}))<={2}",n,e.rank,r):w("LARGE(({0}),MIN({1},COUNT({0})))<={2}",n,e.rank,r);if("containsText"===e.type)return w('NOT(ISERROR(SEARCH("{0}",{1})))',e.text,r);if("notContainsText"===e.type)return w('ISERROR(SEARCH("{0}",{1}))',e.text,r);if("beginsWith"===e.type)return w('LEFT({0},{1}) = "{2}"',r,e.text.length,e.text);if("endsWith"===e.type)return w('RIGHT({0},{1}) = "{2}"',r,e.text.length,e.text);if("duplicateValues"===e.type)return w("AND(COUNTIF({0},{1})>1,NOT(ISBLANK({1})))",n,r);if("uniqueValues"===e.type)return w("AND(COUNTIF({0},{1})=1,NOT(ISBLANK({1})))",n,r);if("aboveAverage"===e.type||"belowAverage"===e.type||"aboveOrEqualToAverage"===e.type||"belowOrEqualToAverage"===e.type){if("aboveAverage"===e.type&&l.k(e.stdDev))return w("{0}>AVERAGE({1})",r,n);if(!l.k(e.aboveAverage)){if(!(l.k(e.equalAverage)||e.aboveAverage||l.k(e.equalAverage))&&e.equalAverage&&l.k(e.stdDev))return w("{0}<=AVERAGE({1})",r,n);if(!e.aboveAverage&&l.k(e.stdDev))return w("{0}<AVERAGE({1})",r,n)}if(!l.k(e.equalAverage)&&e.equalAverage&&l.k(e.stdDev))return w("{0}>=AVERAGE({1})",r,n);if(!l.k(e.stdDev))return l.k(e.aboveAverage)||e.aboveAverage?w("({0}-AVERAGE({1}))>=STDEVP({1})*({2})",r,n,e.stdDev):w("({0}-AVERAGE({1}))<=STDEVP({1})*(-{2})",r,n,e.stdDev)}return null}function w(e){var t,r,n=[];for(t=1;t<arguments.length;t++)n[t-1]=arguments[t];return r=Array.prototype.slice.call(arguments,1),e.replace(/{(\d+)}/g,function(e,t){return void 0!==r[t]?r[t]:e})}function v(e){return n.ColorHelper.toExcelColor(e)}function S(e){return e.ruleType===c.iconSetRule&&(3===e.iconSetType||2===e.iconSetType||19===e.iconSetType||E(e.iconSetType,e.icons))}function x(e){return e.ruleType===c.dataBarRule}function T(e,t,r){return e.ruleType===c.formulaRule&&l.Util.xa(e.formula,t,r)}function A(e,t,r){var n,o,i=0;for(n=0;n<e.length;n++)(x(o=e[n])||S(o)||T(o,t,r))&&i++;return 0!==i}function k(e,t,r){e.writeElement("x14:conditionalFormatting",function(){e.writeAttributeString("xmlns:xm","http://schemas.microsoft.com/office/excel/2006/main")},function(){e.writeElement("x14:cfRule",function(){e.writeAttributeString("type","expression"),e.writeAttributeString("priority",r.priority),e.writeAttributeString("id",r.id)},function(){e.writeElement("xm:f",function(){e.writeValue(l.Util.sa(m(r.formula)))}),i.writeDxf(e,r.style,"x14:dxf")}),e.writeElement("xm:sqref",function(){e.writeValue(s.getRangeString(r.ranges))})})}function M(e,t,r){e.writeElement("x14:conditionalFormatting",function(){e.writeAttributeString("xmlns:xm","http://schemas.microsoft.com/office/excel/2006/main")},function(){e.writeElement("x14:cfRule",function(){e.writeAttributeString("type",c[r.ruleType].replace("Rule","")),e.writeAttributeString("id",r.id)},function(){e.writeElement("x14:dataBar",function(){e.writeAttributeString("minLength","0"),e.writeAttributeString("maxLength","100"),r.showBarOnly&&e.writeAttributeString("showValue","0"),r.showBorder&&e.writeAttributeString("border","1"),!1===r.gradient&&e.writeAttributeString("gradient","0"),!1===r.useNegativeFillColor&&e.writeAttributeString("negativeBarColorSameAsPositive","1"),r.useNegativeBorderColor&&e.writeAttributeString("negativeBarBorderColorSameAsPositive","0"),e.writeAttributeString("direction",1===r.dataBarDirection?"rightToLeft":"leftToRight"),0!==r.axisPosition&&(1===r.axisPosition&&e.writeAttributeString("axisPosition","middle"),2===r.axisPosition&&e.writeAttributeString("axisPosition","none"))},function(){l.k(r.minType)||5===r.minType?e.writeLeafElement("x14:cfvo",function(){e.writeAttributeString("type","autoMin")}):l.k(r.minValue)?e.writeLeafElement("x14:cfvo",function(){e.writeAttributeString("type",h[r.minType])}):e.writeElement("x14:cfvo",function(){e.writeAttributeString("type",h[r.minType])},function(){e.writeElement("xm:f",function(){e.writeValue(l.Util.sa(m(r.minValue)))})}),l.k(r.maxType)||7===r.maxType?e.writeLeafElement("x14:cfvo",function(){e.writeAttributeString("type","autoMax")}):l.k(r.maxValue)?e.writeLeafElement("x14:cfvo",function(){e.writeAttributeString("type",h[r.maxType])}):e.writeElement("x14:cfvo",function(){e.writeAttributeString("type",h[r.maxType])},function(){e.writeElement("xm:f",function(){e.writeValue(l.Util.sa(m(r.maxValue)))})}),r.showBorder&&r.borderColor&&u.writeColor(e,"x14:borderColor",v(r.borderColor)),l.k(r.negativeFillColor)?u.writeColor(e,"x14:negativeFillColor",v("red")):u.writeColor(e,"x14:negativeFillColor",v(r.negativeFillColor)),l.k(r.negativeBorderColor)?u.writeColor(e,"x14:negativeBorderColor",v("black")):u.writeColor(e,"x14:negativeBorderColor",v(r.negativeBorderColor)),2!==r.axisPosition&&u.writeColor(e,"x14:axisColor",v(r.axisColor))})}),e.writeElement("xm:sqref",function(){e.writeValue(s.getRangeString(r.ranges))})})}function I(i,e,a){i.writeElement("x14:conditionalFormatting",function(){i.writeAttributeString("xmlns:xm","http://schemas.microsoft.com/office/excel/2006/main")},function(){i.writeElement("x14:cfRule",function(){i.writeAttributeString("type","iconSet"),a.priority&&i.writeAttributeString("priority",a.priority),i.writeAttributeString("id",a.id)},function(){i.writeElement("x14:iconSet",function(){var e,t=a.iconSetType;l.k(t)&&(t=0),i.writeAttributeString("iconSet",f[t]),(e=E(t,a.icons))&&i.writeAttributeString("custom","1"),a.showIconOnly&&i.writeAttributeString("showValue","0"),a.reverseIconOrder&&(e?a.icons.reverse():i.writeAttributeString("reverse","1"))},function(){var e,t,r,n,o;for(i.writeElement("x14:cfvo",function(){i.writeAttributeString("type","percent")},function(){i.writeElement("xm:f",function(){i.writeValue("0")})}),e=function(e){var t=a.iconCriteria[e];i.writeElement("x14:cfvo",function(){i.writeAttributeString("type",d[t.iconValueType]),!1===t.isGreaterThanOrEqualTo&&i.writeAttributeString("gte","0")},function(){i.writeElement("xm:f",function(){i.writeValue(l.Util.sa(m(t.iconValue)))})})},t=0;t<a.iconCriteria.length;t++)e(t);for(r=a.icons,n=function(t){i.writeLeafElement("x14:cfIcon",function(){var e=function(e,t){if(10===e){if(3===t)return{iconSetType:0,iconIndex:2};if(0===t)return{iconSetType:0,iconIndex:0}}else if(15===e){if(4===t)return{iconSetType:0,iconIndex:2};if(0===t)return{iconSetType:0,iconIndex:0};if(2===t)return{iconSetType:0,iconIndex:1};if(3===t)return{iconSetType:10,iconIndex:2};if(1===t)return{iconSetType:10,iconIndex:1}}else if(11===e){if(3===t)return{iconSetType:1,iconIndex:2};if(0===t)return{iconSetType:1,iconIndex:0}}else if(16===e){if(4===t)return{iconSetType:1,iconIndex:2};if(0===t)return{iconSetType:1,iconIndex:0};if(2===t)return{iconSetType:1,iconIndex:1};if(3===t)return{iconSetType:11,iconIndex:2};if(1===t)return{iconSetType:11,iconIndex:1}}else if(14===e){if(3===t)return{iconSetType:5,iconIndex:2};if(2===t)return{iconSetType:5,iconIndex:1};if(1===t)return{iconSetType:5,iconIndex:0}}else if(13===e){if(0===t)return{iconSetType:17,iconIndex:1};if(1===t)return{iconSetType:17,iconIndex:2};if(2===t)return{iconSetType:17,iconIndex:3};if(3===t)return{iconSetType:17,iconIndex:4}}return{iconSetType:e,iconIndex:t}}(r[t].iconSetType,r[t].iconIndex);i.writeAttributeString("iconSet",f[e.iconSetType]),i.writeAttributeString("iconId",e.iconIndex)})},o=0;o<r.length;o++)n(o)})}),i.writeElement("xm:sqref",function(){i.writeValue(s.getRangeString(a.ranges))})})}function E(e,t){var r,n=!0,o=!0,i=!0;for(r=0;r<t.length;r++)if(t[r].iconSetType!==e){n=!1;break}for(r=0;r<t.length;r++)if(t[r].iconIndex!==r){o=!1;break}for(r=0;r<t.length;r++)if(t[r].iconIndex!==t.length-1-r){i=!1;break}return!n||!o&&!i}Object.defineProperty(t,"__esModule",{value:!0}),s=r("./src/common/range-parser.ts"),l=r("./src/common/common.ts"),n=r("./src/datamodel/excel-style.ts"),u=r("./src/xlsx-io/common/color-writer.ts"),o=r("./src/common/excel-types.ts"),i=r("./src/xlsx-io/writer/style-writer.ts"),(a=c=c||{})[a.conditionRuleBase=0]="conditionRuleBase",a[a.cellValueRule=1]="cellValueRule",a[a.specificTextRule=2]="specificTextRule",a[a.formulaRule=3]="formulaRule",a[a.dateOccurringRule=4]="dateOccurringRule",a[a.top10Rule=5]="top10Rule",a[a.uniqueRule=6]="uniqueRule",a[a.duplicateRule=7]="duplicateRule",a[a.averageRule=8]="averageRule",a[a.twoScaleRule=10]="twoScaleRule",a[a.threeScaleRule=11]="threeScaleRule",a[a.dataBarRule=12]="dataBarRule",a[a.iconSetRule=13]="iconSetRule",h={0:"num",1:"min",2:"max",3:"percent",4:"percentile",6:"formula",5:"autoMin",7:"autoMax"},f={0:"3Arrows",1:"3ArrowsGray",4:"3Flags",5:"3TrafficLights1",6:"3TrafficLights2",7:"3Signs",8:"3Symbols",9:"3Symbols2",10:"4Arrows",11:"4ArrowsGray",12:"4RedToBlack",13:"4Rating",14:"4TrafficLights",15:"5Arrows",16:"5ArrowsGray",17:"5Rating",18:"5Quarters",3:"3Stars",2:"3Triangles",19:"5Boxes",20:"NoIcons"},d={1:"num",4:"percent",7:"formula",5:"percentile"},p={0:"equal",1:"notEqual",2:"greaterThan",3:"greaterThanOrEqual",4:"lessThan",5:"lessThanOrEqual",6:"between",7:"notBetween"},t.writeConditionalFormating=function(o,t,r){var e,n,i=r.Zf(t),a=i&&i.rules;if(a&&0<a.length)for(e=function(e){var n=a[e];return l.k(n.priority)&&(n.priority=1),S(n)||T(n,t,r.ri())?"continue":void o.writeElement("conditionalFormatting",function(){o.writeAttributeString("sqref",s.getRangeString(n.ranges))},function(){if(n.ruleType===c.dataBarRule)o.writeElement("cfRule",function(){o.writeAttributeString("type",c[n.ruleType].replace("Rule","")),o.writeAttributeString("priority",n.priority)},function(){o.writeElement("dataBar",function(){n.showBarOnly&&o.writeAttributeString("showValue","0")},function(){var e,t=h[n.minType];!l.k(t)&&"autoMin"!==t||(t="min"),o.writeLeafElement("cfvo",function(){o.writeAttributeString("type",t),l.k(n.minValue)||o.writeAttributeString("val",l.Util.sa(m(n.minValue)))}),e=h[n.maxType],!l.k(e)&&"autoMax"!==e||(e="max"),o.writeLeafElement("cfvo",function(){o.writeAttributeString("type",e),l.k(n.maxValue)||o.writeAttributeString("val",l.Util.sa(m(n.maxValue)))}),u.writeColor(o,"color",v(n.color))}),o.writeElement("extLst",function(){o.writeElement("ext",function(){o.writeAttributeString("uri","{B025F937-C7B1-47D3-B67F-A62EFF666E3E}"),o.writeAttributeString("xmlns:x14","http://schemas.microsoft.com/office/spreadsheetml/2009/9/main")},function(){n.id=l.Util.za(),o.writeElement("x14:id",function(){o.writeValue(n.id)})})})});else if(n.ruleType===c.twoScaleRule||n.ruleType===c.threeScaleRule)o.writeElement("cfRule",function(){o.writeAttributeString("type","colorScale"),o.writeAttributeString("priority",n.priority)},function(){o.writeElement("colorScale",function(){o.writeLeafElement("cfvo",function(){o.writeAttributeString("type",h[n.minType]),l.k(n.minValue)||o.writeAttributeString("val",l.Util.sa(m(n.minValue)))});var e=n.ruleType===c.threeScaleRule;e&&o.writeLeafElement("cfvo",function(){o.writeAttributeString("type",h[n.midType]),l.k(n.midValue)?o.writeAttributeString("val","50"):o.writeAttributeString("val",l.Util.sa(m(n.midValue)))}),o.writeLeafElement("cfvo",function(){o.writeAttributeString("type",h[n.maxType]),l.k(n.maxValue)||o.writeAttributeString("val",l.Util.sa(m(n.maxValue)))}),u.writeColor(o,"color",v(n.minColor)),e&&u.writeColor(o,"color",v(n.midColor)),u.writeColor(o,"color",v(n.maxColor))})});else if(n.ruleType===c.iconSetRule){if(S(n))return;o.writeElement("cfRule",function(){o.writeAttributeString("type","iconSet"),o.writeAttributeString("priority",n.priority)},function(){o.writeElement("iconSet",function(){var e=n.iconSetType;l.k(e)&&(e=0),o.writeAttributeString("iconSet",f[e]),n.reverseIconOrder&&o.writeAttributeString("reverse","1"),n.showIconOnly&&o.writeAttributeString("showValue","0")},function(){var e,t;for(o.writeLeafElement("cfvo",function(){o.writeAttributeString("type","percent"),o.writeAttributeString("val","0")}),e=function(e){var t=n.iconCriteria[e];o.writeLeafElement("cfvo",function(){o.writeAttributeString("type",d[t.iconValueType]),o.writeAttributeString("val",m(t.iconValue)),!1===t.isGreaterThanOrEqualTo&&o.writeAttributeString("gte","0")})},t=0;t<n.iconCriteria.length;t++)e(t)})})}else if(n.ruleType===c.cellValueRule)o.writeElement("cfRule",function(){o.writeAttributeString("type","cellIs"),n.priority&&o.writeAttributeString("priority",n.priority),0<=n.dxfId&&o.writeAttributeString("dxfId",n.dxfId),n.stopIfTrue&&o.writeAttributeString("stopIfTrue","1"),l.k(n.operator)||o.writeAttributeString("operator",p[n.operator])},function(){l.k(n.value1)||o.writeElement("formula",function(){o.writeValue(y(b(n.value1)))}),l.k(n.value2)||o.writeElement("formula",function(){o.writeValue(y(b(n.value2)))})});else{var r=function(e){switch(e.ruleType){case 2:return function(e){var t,r,n=e.operator,o="containsText",i="contains";return 2===n?i=o="beginsWith":3===n?i=o="endsWith":1===n&&(o="notContainsText",i="notContains"),t={type:o,priority:e.priority,operator:i,text:e.text,stopIfTrue:e.stopIfTrue,dxfId:e.dxfId,ranges:e.ranges},(r=C(t))&&(t.formulas=[r]),t}(e);case 3:return function(e){return{type:"expression",ranges:e.ranges,priority:e.priority,stopIfTrue:e.stopIfTrue,dxfId:e.dxfId,formulas:[e.formula]}}(e);case 4:return function(e){var t={type:g[e.type],ranges:e.ranges,priority:e.priority,stopIfTrue:e.stopIfTrue,dxfId:e.dxfId},r=C(t);return r&&(t.formulas=[r]),t}(e);case 5:return function(e){var t,r,n=void 0;return 1===e.type&&(n=!0),t={type:"top10",ranges:e.ranges,stopIfTrue:e.stopIfTrue,percent:!1,priority:e.priority,rank:e.rank,dxfId:e.dxfId,bottom:n},(r=C(t))&&(t.formulas=[r]),t}(e);case 6:case 7:return function(e){var t,r,n="uniqueValues";return 7===e.ruleType&&(n="duplicateValues"),t={type:n,ranges:e.ranges,priority:e.priority,stopIfTrue:e.stopIfTrue,dxfId:e.dxfId},(r=C(t))&&(t.formulas=[r]),t}(e);case 8:return function(e){var t,r,n=0,o="aboveAverage";switch(e.type){case 0:o="aboveAverage";break;case 1:o="belowAverage";break;case 2:o="aboveOrEqualToAverage";break;case 3:o="belowOrEqualToAverage";break;case 4:o="aboveAverage",n=1;break;case 5:o="belowAverage",n=1;break;case 6:o="aboveAverage",n=2;break;case 7:o="belowAverage",n=2;break;case 8:o="aboveAverage",n=3;break;case 9:o="belowAverage",n=3}return t={type:o,ranges:e.ranges,priority:e.priority,stopIfTrue:e.stopIfTrue,stdDev:n,dxfId:e.dxfId},(r=C(t))&&(t.formulas=[r]),t}(e)}}(n);o.writeElement("cfRule",function(){4===n.ruleType?o.writeAttributeString("type","timePeriod"):8===n.ruleType?(o.writeAttributeString("type","aboveAverage"),"aboveOrEqualToAverage"!==r.type&&"belowOrEqualToAverage"!==r.type||(r.equalAverage=!0),"belowAverage"!==r.type&&"belowOrEqualToAverage"!==r.type||(r.aboveAverage=!1)):2===n.ruleType&&l.k(r.type)?o.writeAttributeString("type","containsText"):o.writeAttributeString("type",r.type),0<=r.dxfId&&o.writeAttributeString("dxfId",r.dxfId),0<=r.priority&&o.writeAttributeString("priority",r.priority),r.stopIfTrue&&o.writeAttributeString("stopIfTrue","1"),l.k(r.aboveAverage)||(r.aboveAverage?o.writeAttributeString("aboveAverage","1"):o.writeAttributeString("aboveAverage","0")),l.k(r.equalAverage)||(r.equalAverage?o.writeAttributeString("equalAverage","1"):o.writeAttributeString("equalAverage","0")),l.k(r.bottom)||(r.bottom?o.writeAttributeString("bottom","1"):o.writeAttributeString("bottom","0")),r.percent&&o.writeAttributeString("percent","1"),l.k(r.operator)||o.writeAttributeString("operator",r.operator),l.k(r.rank)||o.writeAttributeString("rank",r.rank),l.k(r.stdDev)||o.writeAttributeString("stdDev",r.stdDev),l.k(r.text)||o.writeAttributeString("text",l.Util.sa(r.text)),4===n.ruleType&&o.writeAttributeString("timePeriod",r.type)},function(){var e,t;if(!l.k(r.formulas))for(e=function(e){o.writeElement("formula",function(){o.writeValue(l.Util.sa(b(r.formulas[e])))})},t=0;t<r.formulas.length;t++)e(t)})}})},n=0;n<a.length;n++)e(n)},g={0:"today",1:"yesterday",2:"tomorrow",3:"last7Days",4:"thisMonth",5:"lastMonth",6:"nextMonth",7:"thisWeek",8:"lastWeek",9:"nextWeek"},t.needWriteConditionalFormatExtension=A,t.writeExtensionConditionalFormats=function(r,n,o){var e=o.Zf(n),i=e&&e.rules;i&&0!==i.length&&A(i,n,o.ri())&&r.writeElement("ext",function(){r.writeAttributeString("uri","{78C0D931-6437-407d-A8EE-F0AAD7539E65}"),r.writeAttributeString("xmlns:x14","http://schemas.microsoft.com/office/spreadsheetml/2009/9/main")},function(){r.writeElement("x14:conditionalFormattings",function(){var e,t;for(e=0;e<i.length;e++)t=i[e],l.k(t.id)&&(t.id=l.Util.za()),x(t)&&M(r,0,t),S(t)&&I(r,0,t),T(t,n,o.ri())&&k(r,0,t)})})}},"./src/xlsx-io/writer/datavalidation-writer.ts":function(e,t,r){"use strict";var i,a,s,n,o,l;function u(e){return i.isNullOrUndefined(e)||""===e}function c(e,t){i.isNullOrUndefined(t.type)||0===t.type||e.writeAttributeString("type",n[t.type]),i.isNullOrUndefined(t.errorStyle)||0===t.errorStyle||e.writeAttributeString("errorStyle",o[t.errorStyle]),i.isNullOrUndefined(t.compareOperator)||6===t.compareOperator||e.writeAttributeString("operator",l[t.compareOperator]),!1!==t.allowBlank&&e.writeAttributeString("allowBlank","1"),!1===t.showPromptBox&&e.writeAttributeString("showDropDown","1"),!1!==t.showInputMessage&&e.writeAttributeString("showInputMessage","1"),!1!==t.showErrorBox&&e.writeAttributeString("showErrorMessage","1"),u(t.errorTitle)||e.writeAttributeString("errorTitle",s(t.errorTitle)),u(t.error)||e.writeAttributeString("error",s(i.Util.Ba(t.error))),u(t.promptTitle)||e.writeAttributeString("promptTitle",s(t.promptTitle)),u(t.prompt)||e.writeAttributeString("prompt",s(i.Util.Ba(t.prompt)))}Object.defineProperty(t,"__esModule",{value:!0}),i=r("./src/common/common.ts"),a=i.StringEx.C,s=i.Util.sa,n={0:"none",1:"whole",2:"decimal",3:"list",4:"date",5:"time",6:"textLength",7:"custom"},o={0:"stop",1:"warning",2:"information"},l={6:"between",7:"notBetween",0:"equal",1:"notEqual",2:"greaterThan",4:"lessThan",3:"greaterThanOrEqual",5:"lessThanOrEqual"},t.writeDataValidations=function(t,e,r){var n=r.Oi(e),o=[];r.Im||(r.Im=[]),0<n.length&&n.forEach(function(e){e.external?r.Im.push(e):o.push(e)}),0<o.length&&t.writeElement("dataValidations",function(){t.writeAttributeString("count",o.length)},function(){o.forEach(function(e){i.isNullOrUndefined(e)||i.isNullOrUndefined(e.ranges)||t.writeElement("dataValidation",function(){c(t,e),t.writeAttributeString("sqref",e.ranges)},function(){a(e.firstFormula)||t.writeElementString("formula1",s(e.firstFormula)),a(e.secondFormula)||t.writeElementString("formula2",s(e.secondFormula))})})})},t.writeExtensionDataValidations=function(t,e){var r=e.Im;r&&0===r.length||(t.writeElement("ext",function(){t.writeAttributeString("xmlns:x14","http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"),t.writeAttributeString("uri","{CCE6A557-97BC-4b89-ADB6-D9C93CAAB3DF}")},function(){t.writeElement("x14:dataValidations",function(){t.writeAttributeString("xmlns:xm","http://schemas.microsoft.com/office/excel/2006/main"),t.writeAttributeString("count",r.length)},function(){r.forEach(function(e){t.writeElement("x14:dataValidation",function(){c(t,e)},function(){a(e.firstFormula)||t.writeElement("x14:formula1",function(){t.writeElementString("xm:f",s(e.firstFormula))}),a(e.secondFormula)||t.writeElement("x14:formula2",function(){t.writeElementString("xm:f",s(e.secondFormula))}),t.writeElementString("xm:sqref",e.ranges)})})})}),e.Im=null)}},"./src/xlsx-io/writer/docPropsAppWriter.ts":function(e,t,r){"use strict";var o,i;function a(n,o){n.writeElement("HeadingPairs",function(){},function(){n.writeElement("vt:vector",function(){n.writeAttributeString("size",o.HeadingPairs.size),n.writeAttributeString("baseType",o.HeadingPairs.baseType)},function(){function e(e){n.writeElement("vt:variant",function(){},function(){n.writeElement(r[e].elementType,function(){},function(){n.writeValue(r[e].value)})})}var t,r=o.HeadingPairs.workbookInfoArray;for(t=0;t<r.length;t++)e(t)})})}function s(n,o){n.writeElement("TitlesOfParts",function(){},function(){n.writeElement("vt:vector",function(){n.writeAttributeString("size",o.TitlesOfParts.size),n.writeAttributeString("baseType",o.TitlesOfParts.baseType)},function(){function e(e){n.writeElement("vt:lpstr",function(){},function(){n.writeValue(r[e])})}var t,r=o.TitlesOfParts.sheetsNameArray;for(t=0;t<r.length;t++)e(t)})})}function l(e,t,r){var n=e.slice(0,1).toUpperCase()+e.slice(1);t.writeElement(n,function(){},function(){t.writeValue(r[e])})}Object.defineProperty(t,"__esModule",{value:!0}),o=r("./src/xml-io/xml-writer.ts"),i=r("./src/common/excel-types.ts"),t.writeDocPropsApp=function(r){var n=new o.XmlWriter;return n.writeDocument(),n.writeElement("Properties",function(){n.writeAttributeString("xmlns",i.XFileConstants.be),n.writeAttributeString("xmlns:vt",i.XFileConstants.ce)},function(){var e,t=r.we.docProps.docPropsApp;for(e in t)if(t.hasOwnProperty(e))switch(e){case"HeadingPairs":a(n,t);break;case"TitlesOfParts":s(n,t);break;default:l(e,n,t)}}),n.getXmlString()}},"./src/xlsx-io/writer/docPropsCoreWriter.ts":function(e,t,r){"use strict";var i,a;Object.defineProperty(t,"__esModule",{value:!0}),i=r("./src/xml-io/xml-writer.ts"),a=r("./src/common/excel-types.ts"),t.writeDocPropsCore=function(n){var o=new i.XmlWriter;return o.writeDocument(),o.writeElement("cp:coreProperties",function(){o.writeAttributeString("xmlns:cp",a.XFileConstants.Xd),o.writeAttributeString("xmlns:dc",a.XFileConstants.Yd),o.writeAttributeString("xmlns:dcterms",a.XFileConstants.Zd),o.writeAttributeString("xmlns:dcmitype",a.XFileConstants.$d),o.writeAttributeString("xmlns:xsi",a.XFileConstants._d)},function(){function e(e){if(r.hasOwnProperty(e))switch(e){case"title":o.writeElement("dc:title",function(){},function(){o.writeValue(r[e])});break;case"subject":o.writeElement("dc:subject",function(){},function(){o.writeValue(r[e])});break;case"creator":o.writeElement("dc:creator",function(){},function(){o.writeValue(r[e])});break;case"keywords":o.writeElement("cp:keywords",function(){},function(){o.writeValue(r[e])});break;case"description":o.writeElement("dc:description",function(){},function(){o.writeValue(r[e])});break;case"lastModifiedBy":o.writeElement("cp:lastModifiedBy",function(){},function(){o.writeValue(r[e])});break;case"created":o.writeElement("dcterms:created",function(){o.writeAttributeString("xsi:type","dcterms:W3CDTF")},function(){o.writeValue(r[e])});break;case"modified":o.writeElement("dcterms:modified",function(){o.writeAttributeString("xsi:type","dcterms:W3CDTF")},function(){o.writeValue(r[e])});break;case"lastPrinted":o.writeElement("cp:lastPrinted",function(){},function(){o.writeValue(r[e])});break;case"category":o.writeElement("cp:category",function(){},function(){o.writeValue(r[e])});break;case"contentStatus":o.writeElement("cp:contentStatus",function(){},function(){o.writeValue(r[e])});break;case"language":o.writeElement("dc:language",function(){},function(){o.writeValue(r[e])});break;case"version":o.writeElement("cp:version",function(){},function(){o.writeValue(r[e])});break;case"revision":o.writeElement("cp:revision",function(){},function(){o.writeValue(r[e])})}}var t,r=n.we.docProps.docPropsCore;for(t in r)e(t)}),o.getXmlString()}},"./src/xlsx-io/writer/docPropsCustomWriter.ts":function(e,t,r){"use strict";var i,a;Object.defineProperty(t,"__esModule",{value:!0}),i=r("./src/xml-io/xml-writer.ts"),a=r("./src/common/excel-types.ts"),t.writeDocPropsCustom=function(n){var o=new i.XmlWriter;return o.writeDocument(),o.writeElement("Properties",function(){o.writeAttributeString("xmlns",a.XFileConstants.ee),o.writeAttributeString("xmlns:vt",a.XFileConstants.fe)},function(){function e(e){var n=r[e];o.writeElement("property",function(){for(var e in n)"propertyItemChildElement"!==e&&o.writeAttributeString(e,n[e])},function(){function e(e){r.hasOwnProperty(e)&&o.writeElement(e,function(){},function(){o.writeValue(r[e])})}var t,r=n.propertyItemChildElement;for(t in r)e(t)})}var t,r=n.we.docProps.docPropsCustom;for(t=0;t<r.length;t++)e(t)}),o.getXmlString()}},"./src/xlsx-io/writer/drawing-writer.ts":function(e,t,r){"use strict";var n,o,i,h,a,f,d;function p(){return o.XFileConstants}function g(e,t,r){a.writeColorScheme(e,t,r)}function m(e){return i.UnitHelper.pixelToEMU(e)}function b(e){var r=[];return e.forEach(function(e){if(e.sp)r.push(e.sp.nvSpPr.cNvPr.id);else if(e.cxnSp)r.push(e.cxnSp.nvCxnSpPr.cNvPr.id);else if(e.grpSp){var t=e.grpSp;r.push(t.nvGrpSpPr.cNvPr.id),function t(e,r){e.forEach(function(e){r.push((e.nvSpPr||e.nvCxnSpPr||e.nvGrpSpPr).cNvPr.id),e.nvGrpSpPr&&t(e.sp,r)})}(t.sp,r)}}),Math.max.apply(null,r)}function y(e,t,r){e.writeElement(t,function(){e.writeElementString("xdr:col",r.col),e.writeElementString("xdr:colOff",m(r.colOffset)),e.writeElementString("xdr:row",r.row),e.writeElementString("xdr:rowOff",m(r.rowOffset))})}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/xml-io/xml-writer.ts"),o=r("./src/common/excel-types.ts"),i=r("./src/datamodel/excel-style.ts"),h=r("./src/xlsx-io/writer/slicer-writer.ts"),a=r("./src/xlsx-io/common/color-writer.ts"),f=r("./src/xlsx-io/writer/chart-writer.ts"),d=r("./src/datamodel/chart-model.ts"),t.writeDrawing=function(e,u){var c=new n.XmlWriter;return c.Hm=1,c.writeDocument(!0),c.writeElement("xdr:wsDr",function(){c.writeAttributeString("xmlns:xdr",p().sd),c.writeAttributeString("xmlns:a",p().td)},function(){var e,t,r,n,o,i,a,s,l=u.shapes;l&&l.length&&(e=!0,t=b(l),c.Hm=t+1),(r=u.pictures)&&r.length&&(s=c,r.forEach(function(e){var o,i,a;o=s,(a=(i=e)&&i.twoCellAnchor)&&o.writeElement("xdr:twoCellAnchor",function(){var e=a.editAs;e&&o.writeAttributeString("editAs",d.Charts.ST_EditAs[e])},function(){var e,t,r,n;y(o,"xdr:from",a.startPoint),y(o,"xdr:to",a.endPoint),n=i,(r=o).writeElement("xdr:pic",function(){var a,s;r.writeElement("xdr:nvPicPr",function(){r.writeLeafElement("xdr:cNvPr",function(){r.writeAttributeString("id",r.Hm++),r.writeAttributeString("name",n.name),n.descr&&r.writeAttributeString("descr",n.descr),n.hidden&&r.writeAttributeString("hidden","1")}),r.writeElement("xdr:cNvPicPr",function(){r.writeLeafElement("a:picLocks",function(){r.writeAttributeString("noChangeAspect","1")})})}),r.writeElement("xdr:blipFill",function(){"svg+xml"===n.imageType?r.writeElement("a:blip",function(){r.writeAttributeString("xmlns:r",p().Cd)},function(){r.writeElement("a:extLst",function(){r.writeElement("a:ext",function(){r.writeAttributeString("uri","{96DAC541-7B7A-43D3-8B79-37D633B846F1}")},function(){r.writeLeafElement("asvg:svgBlip",function(){r.writeAttributeString("xmlns:asvg",p().Hd),r.writeAttributeString("r:embed",n.rid)})})})}):r.writeElement("a:blip",function(){r.writeAttributeString("xmlns:r",p().Cd),r.writeAttributeString("r:embed",n.rid),r.writeAttributeString("cstate","print")},function(){r.writeElement("a:extLst",function(){r.writeElement("a:ext",function(){r.writeAttributeString("uri","{28A0092B-C50C-407E-A947-70E740481C1C}")},function(){r.writeLeafElement("a14:useLocalDpi",function(){r.writeAttributeString("xmlns:a14",p().Gd),r.writeAttributeString("val","0")})})})});var e=n.srcRect;e&&f.DrawingWriter.WriteCT_RelativeRect(r,"a","srcRect",e),r.writeElement("a:stretch",function(){e||r.writeLeafElement("a:fillRect")})}),s=n,(a=r).writeElement("xdr:spPr",function(){var e,t,r,n,o,i;a.writeElement("a:xfrm",function(){s.rot&&a.writeAttributeString("rot",f.DrawingWriter.getRotationData(s.rot))},function(){a.writeLeafElement("a:off",function(){a.writeAttributeString("x","0"),a.writeAttributeString("y","0")}),a.writeLeafElement("a:ext",function(){a.writeAttributeString("cx","0"),a.writeAttributeString("cy","0")})}),a.writeElement("a:prstGeom",function(){a.writeAttributeString("prst","rect")},function(){a.writeLeafElement("a:avLst")}),(e=s.fillColor)&&g(a,"a:solidFill",e),t=s.lineBorder,r=t.width,n=t.color,o=t.style,i=t.noFill,a.writeElement("a:ln",function(){null!=r&&a.writeAttributeString("w",m(r)),"dbl"===o&&a.writeAttributeString("cmpd","dbl")},function(){i?a.writeLeafElement("a:noFill"):g(a,"a:solidFill",n),"dbl"!==o&&a.writeLeafElement("a:prstDash",function(){a.writeAttributeString("val",o)})})})}),t=i,(e=o).writeLeafElement("xdr:clientData",function(){!1===t.locked&&e.writeAttributeString("fLocksWithSheet","0")})})})),(n=u.slicers)&&n.length&&h.writeSlicerDrawings(c,n,y),(o=u.charts)&&o.length&&(a=c,function(e){var t={AnchorBaseList:[]};return e.forEach(function(e){e.graphicFrame||(e.graphicFrame={}),e.graphicFrame.graphic={graphicData:{chart:{id:e.chartId,typeName:"chartSpace"}}},t.AnchorBaseList.push(e)}),t}(o).AnchorBaseList.forEach(function(e){1===e.anchorType?f.DrawingWriter.WriteCT_OneCellAnchor(a,"xdr","oneCellAnchor",e):0===e.anchorType?f.DrawingWriter.WriteCT_TwoCellAnchor(a,"xdr","twoCellAnchor",e):2===e.anchorType&&f.DrawingWriter.WriteCT_AbsoluteAnchor(a,"xdr","absoluteAnchor",e)})),e&&(i=c,l.forEach(function(e){1===e.anchorType?f.DrawingWriter.WriteCT_OneCellAnchor(i,"xdr","oneCellAnchor",e):0===e.anchorType?f.DrawingWriter.WriteCT_TwoCellAnchor(i,"xdr","twoCellAnchor",e):2===e.anchorType&&f.DrawingWriter.WriteCT_AbsoluteAnchor(i,"xdr","absoluteAnchor",e)}))}),c.getXmlString()}},"./src/xlsx-io/writer/metadata-writer.ts":function(e,t,r){"use strict";var h,f;Object.defineProperty(t,"__esModule",{value:!0}),h=r("./src/common/excel-types.ts"),f='minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1"',t.getMetadataContent=function(e){var t,r,n,o,i,a,s=[],l=0<e,u=1<e,c=2<e;return s.push('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'),s.push("<metadata"),s.push('\txmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"'),i=s,a=l,u&&i.push('\txmlns:xlrd="'+h.XFileConstants.Rd+'"'),a&&i.push('\txmlns:xda="'+h.XFileConstants.Qd+'">'),o=((r=l)?1:0)+((n=u)?1:0),(t=s).push('\t<metadataTypes count="'+o+'">'),r&&t.push('\t\t<metadataType name="XLDAPR" '+f+' cellMeta="1"/>'),n&&t.push('\t\t<metadataType name="XLRICHVALUE" '+f+"/>"),t.push("\t</metadataTypes>"),function(e,t,r,n){if(t&&e.push('\t<futureMetadata name="XLDAPR" count="1"> <bk> <extLst> <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}"> <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/> </ext> </extLst> </bk> </futureMetadata>'),r){var o='<futureMetadata name="XLRICHVALUE" count="'+(n?2:1)+'"> <bk> <extLst> <ext uri="{3e2802c4-a4d2-4d8b-9148-e3be6c30e623}"> <xlrd:rvb i="0"/> </ext> </extLst> </bk>';n&&(o+=' <bk> <extLst> <ext uri="{3e2802c4-a4d2-4d8b-9148-e3be6c30e623}"> <xlrd:rvb i="1"/> </ext> </extLst> </bk>'),e.push("\t"+o+" </futureMetadata>")}}(s,l,u,c),l&&s.push('\t<cellMetadata count="1"> <bk> <rc t="1" v="0"/> </bk> </cellMetadata>'),u&&s.push('\t<valueMetadata count="'+(c?2:1)+'"> <bk> <rc t="2" v="0"/> </bk>'+(c?'<bk> <rc t="2" v="1"/> </bk>':"")+" </valueMetadata>"),s.push("</metadata>"),s.join("\r\n")}},"./src/xlsx-io/writer/pivot-writer.ts":function(e,t,r){"use strict";var _,n,x,o,a,s,l,i;function T(t,r){t.writeElement("cacheField",function(){_.isNullOrUndefined(r.name)||t.writeAttributeString("name",l(r.name)),_.isNullOrUndefined(r.caption)||t.writeAttributeString("caption",r.caption),_.isNullOrUndefined(r.formula)||t.writeAttributeString("formula",r.formula),_.isNullOrUndefined(r.numFmtId)||t.writeAttributeString("numFmtId",r.numFmtId),!1===r.databaseField&&t.writeAttributeString("databaseField","0"),0<r.hierarchy&&t.writeAttributeString("hierarchy",r.hierarchy),0<r.level&&t.writeAttributeString("level",r.level),0<r.mappingCount&&t.writeAttributeString("mappingCount",r.mappingCount),_.isNullOrUndefined(r.memberPropertyField)||t.writeAttributeString("memberPropertyField","1"),_.isNullOrUndefined(r.propertyName)||t.writeAttributeString("propertyName",r.propertyName),_.isNullOrUndefined(r.serverField)||t.writeAttributeString("serverField","1"),0<r.sqlType&&t.writeAttributeString("sqlType",r.sqlType),!1===r.uniqueList&&t.writeAttributeString("uniqueList","0")},function(){var n,e;!1!==r.databaseField&&(r.entities&&0<r.entities.length?t.writeElement("sharedItems",function(){u(t,r)},function(){!function(e,t){var r,n;for(r=0;r<t.entities.length;r++)n=t.entities[r],c(e,n)}(t,r)}):t.writeLeafElement("sharedItems",function(){u(t,r)})),n=t,e=r.fieldGroup,_.isNullOrUndefined(e)||n.writeElement("fieldGroup",function(){0<e.parent&&n.writeAttributeString("par",e.parent),0<=e.base&&n.writeAttributeString("base",e.base)},function(){var r,t;e.hasRangeGroup&&n.writeLeafElement("rangePr",function(){_.isNullOrUndefined(e.autoStart)||n.writeAttributeString("autoStart","0"),_.isNullOrUndefined(e.autoEnd)||n.writeAttributeString("autoEnd","0"),_.isNullOrUndefined(e.groupInterval)||n.writeAttributeString("groupInterval",e.groupInterval),_.isNullOrUndefined(e.groupBy)||n.writeAttributeString("groupBy",e.groupBy),_.isNullOrUndefined(e.startNum)||n.writeAttributeString("startNum",e.startNum),_.isNullOrUndefined(e.endNum)||n.writeAttributeString("endNum",e.endNum),_.isNullOrUndefined(e.startDate)||n.writeAttributeString("startDate",i(new Date(e.startDate))),_.isNullOrUndefined(e.endDate)||n.writeAttributeString("endDate",i(new Date(e.endDate)))}),(r=e.discreteGroup)&&0<r.length&&n.writeElement("discretePr",function(){n.writeAttributeString("count",r.length)},function(){function e(e){n.writeLeafElement("x",function(){n.writeAttributeString("v",r[e])})}var t;for(t=0;t<r.length;t++)e(t)}),(t=e.groupItems)&&0<t.length&&n.writeElement("groupItems",function(){n.writeAttributeString("count",t.length)},function(){for(var e=0;e<t.length;e++)c(n,t[e])})})})}function u(e,t){!1===t.containsSemiMixedTypes&&e.writeAttributeString("containsSemiMixedTypes","0"),!1===t.containsNonDate&&e.writeAttributeString("containsNonDate","0"),t.containsDate&&e.writeAttributeString("containsDate","1"),!1===t.containsString&&e.writeAttributeString("containsString","0"),t.containsBlank&&e.writeAttributeString("containsBlank","1"),t.containsMixedTypes&&e.writeAttributeString("containsMixedTypes","1"),t.containsNumber&&!t.containsDate&&e.writeAttributeString("containsNumber","1"),t.containsInteger&&!t.containsDate&&e.writeAttributeString("containsInteger","1"),t.isShared&&t.longText&&e.writeAttributeString("longText","0"),t.containsDate?(e.writeAttributeString("minDate",i(new Date(t.minDate))),e.writeAttributeString("maxDate",i(new Date(t.maxDate)))):(t.containsNumber||t.containsInteger)&&(e.writeAttributeString("minValue",""+t.minValue),e.writeAttributeString("maxValue",""+t.maxValue)),t.isShared&&(e.writeAttributeString("minDate",i(new Date(t.minDate))),e.writeAttributeString("maxDate",i(new Date(t.maxDate)))),t.entities&&0<t.entities.length&&e.writeAttributeString("count",t.entities.length)}function c(e,t){var r=null;switch(t.type){case x.PivotSharedItemType.B:e.writeLeafElement("b",function(){_.isNullOrUndefined(t.value)||(r=t.value?"1":"0",h(e,t,r))});break;case x.PivotSharedItemType.D:e.writeLeafElement("d",function(){_.isNullOrUndefined(t.value)||(r=i(new Date(t.value)),h(e,t,r))});break;case x.PivotSharedItemType.E:e.writeLeafElement("e",function(){_.isNullOrUndefined(t.value)||(r=t.value,h(e,t,r))});break;case x.PivotSharedItemType.M:e.writeLeafElement("m");break;case x.PivotSharedItemType.N:e.writeLeafElement("n",function(){_.isNullOrUndefined(t.value)||(r=t.value,h(e,t,r))});break;case x.PivotSharedItemType.S:e.writeLeafElement("s",function(){_.isNullOrUndefined(t.value)||(r=t.value,h(e,t,r))});break;case x.PivotSharedItemType.X:e.writeLeafElement("x",function(){_.isNullOrUndefined(t.value)||(r=t.value,h(e,t,r))})}}function h(e,t,r){_.isNullOrUndefined(r)||e.writeAttributeString("v",r),_.isNullOrUndefined(t.caption)||e.writeAttributeString("c",t.caption),0<t.propertyCount&&e.writeAttributeString("cp",t.propertyCount),_.isNullOrUndefined(t.isCalculatedItem)||e.writeAttributeString("f","1"),_.isNullOrUndefined(t.isUnusedItem)||e.writeAttributeString("u","1"),_.isNullOrUndefined(t.isBold)||e.writeAttributeString("b","1"),_.isNullOrUndefined(t.backgroundColor)||e.writeAttributeString("bc",t.backgroundColor),_.isNullOrUndefined(t.foregroundColor)||e.writeAttributeString("fc",t.foregroundColor),_.isNullOrUndefined(t.isItalic)||e.writeAttributeString("i","1"),0<t.formatIndex&&e.writeAttributeString("in",t.formatIndex),_.isNullOrUndefined(t.isStrikethrough)||e.writeAttributeString("st","1"),_.isNullOrUndefined(t.isUnderline)||e.writeAttributeString("un","1")}function A(t,r){t.writeElement("cacheHierarchy",function(){_.isNullOrUndefined(r.uniqueName)||t.writeAttributeString("uniqueName",r.uniqueName),_.isNullOrUndefined(r.caption)||t.writeAttributeString("caption",r.caption),r.measure&&t.writeAttributeString("measure","1"),r.set&&t.writeAttributeString("set","1"),0<=r.parentSet&&t.writeAttributeString("parentSet",r.parentSet),0<r.iconSet&&t.writeAttributeString("iconSet",r.iconSet),r.attribute&&t.writeAttributeString("attribute","1"),r.time&&t.writeAttributeString("time","1"),r.keyAttribute&&t.writeAttributeString("keyAttribute","1"),_.isNullOrUndefined(r.defaultMemberUniqueName)||t.writeAttributeString("defaultMemberUniqueName",r.defaultMemberUniqueName),_.isNullOrUndefined(r.allUniqueName)||t.writeAttributeString("allUniqueName",r.allUniqueName),_.isNullOrUndefined(r.allCaption)||t.writeAttributeString("allCaption",r.allCaption),_.isNullOrUndefined(r.dimensionUniqueName)||t.writeAttributeString("dimensionUniqueName",r.dimensionUniqueName),_.isNullOrUndefined(r.displayFolder)||t.writeAttributeString("displayFolder",r.displayFolder),_.isNullOrUndefined(r.measureGroup)||t.writeAttributeString("measureGroup",r.measureGroup),r.measures&&t.writeAttributeString("measures","1"),0<=r.count&&t.writeAttributeString("count",r.count),r.oneField&&t.writeAttributeString("oneField","1"),0<r.memberValueDatatype&&t.writeAttributeString("memberValueDatatype",r.memberValueDatatype),r.unbalanced||t.writeAttributeString("unbalanced","0"),r.unbalancedGroup||t.writeAttributeString("unbalancedGroup","0"),r.hidden&&t.writeAttributeString("hidden","1")},function(){0<r.fieldsUsage.length&&t.writeElement("fieldsUsage",function(){t.writeAttributeString("count",r.fieldsUsage.length)},function(){for(var e=0;e<r.fieldsUsage.length;e++)f(t,r.fieldsUsage[e])}),0<r.groupLevels.length&&t.writeElement("groupLevels",function(){t.writeAttributeString("count",r.groupLevels.length)},function(){for(var e=0;e<r.groupLevels.length;e++)d(t,r.groupLevels[e])})})}function f(e,t){e.writeElement("fieldUsage",function(){e.writeAttributeString("x",t)})}function d(r,n){r.writeElement("groupLevel",function(){_.isNullOrUndefined(n.uniqueName)||r.writeAttributeString("uniqueName",n.uniqueName),_.isNullOrUndefined(n.caption)||r.writeAttributeString("caption",n.caption),n.user&&r.writeAttributeString("user","1"),n.customRollUp&&r.writeAttributeString("customRollUp","1")},function(){0<n.groups.length&&r.writeElement("groups",function(){r.writeAttributeString("count",n.groups.length)},function(){var e,t;for(e=0;e<n.groups.length;e++)t=n.groups[e],p(r,t)})})}function p(t,r){t.writeElement("group",function(){_.isNullOrUndefined(r.name)||t.writeAttributeString("name",l(r.Name)),_.isNullOrUndefined(r.uniqueName)||t.writeAttributeString("uniqueName",r.uniqueName),_.isNullOrUndefined(r.caption)||t.writeAttributeString("caption",r.caption),_.isNullOrUndefined(r.uniqueParent)||t.writeAttributeString("uniqueParent",r.uniqueParent),0<r.id&&t.writeAttributeString("id",r.id)},function(){0<r.groupMembers.length&&t.writeElement("groupMembers",function(){t.writeAttributeString("count",r.groupMembers.length)},function(){for(var e=0;e<r.groupMembers.length;e++)g(t,r.groupMembers[e])})})}function g(e,t){e.writeLeafElement("groupMember",function(){_.isNullOrUndefined(t.uniqueName)||e.writeAttributeString("uniqueName",t.uniqueName),t.group&&e.writeAttributeString("group",1)})}function k(e,t){e.writeLeafElement("kpi",function(){_.isNullOrUndefined(t.uniqueName)||e.writeAttributeString("uniqueName",t.uniqueName),_.isNullOrUndefined(t.caption)||e.writeAttributeString("caption",t.caption),_.isNullOrUndefined(t.displayFolder)||e.writeAttributeString("displayFolder",t.displayFolder),_.isNullOrUndefined(t.measureGroup)||e.writeAttributeString("measureGroup",t.measureGroup),_.isNullOrUndefined(t.parent)||e.writeAttributeString("parent",t.parent),_.isNullOrUndefined(t.value)||e.writeAttributeString("value",t.value),_.isNullOrUndefined(t.goal)||e.writeAttributeString("goal",t.goal),_.isNullOrUndefined(t.status)||e.writeAttributeString("status",t.status),_.isNullOrUndefined(t.trend)||e.writeAttributeString("trend",t.trend),_.isNullOrUndefined(t.weight)||e.writeAttributeString("weight",t.weight),_.isNullOrUndefined(t.time)||e.writeAttributeString("time",t.time)})}function M(t,r){t.writeElement("query",function(){r.mdx&&t.writeAttributeString("mdx",r.mdx)},function(){r.tpls&&0<r.tpls.length&&t.writeElement("tpls",function(){t.writeAttributeString("c",r.tpls.length)},function(){for(var e=0;e<r.tpls.length;e++)m(t,r.tpls[e])})})}function m(e,t){e.writeElement("tpl",function(){0<=t.fld&&e.writeAttributeString("fld",t.fld),0<=t.hier&&e.writeAttributeString("hier",t.hier),0<=t.item&&e.writeAttributeString("item",t.item)})}function I(e,t){e.writeLeafElement("serverFormat",function(){_.isNullOrUndefined(t.culture)||e.writeAttributeString("culture",t.culture),_.isNullOrUndefined(t.format)||e.writeAttributeString("format",t.format)})}function E(e,t){t&&e.writeElement("calculatedItem",function(){0<=t.field&&e.writeAttributeString("field",t.field),t.formula&&e.writeAttributeString("formula",t.formula)},function(){t.pivotArea&&w(e,t.pivotArea)})}function R(e,t){e.writeLeafElement("calculatedMember",function(){_.isNullOrUndefined(t.name)||e.writeAttributeString("name",l(t.name)),_.isNullOrUndefined(t.mdx)||e.writeAttributeString("mdx",t.mdx),_.isNullOrUndefined(t.memberName)||e.writeAttributeString("memberName",t.memberName),_.isNullOrUndefined(t.hierarchy)||e.writeAttributeString("hierarchy",t.hierarchy),_.isNullOrUndefined(t.parent)||e.writeAttributeString("parent",t.parent),0<t.solveOrder&&e.writeAttributeString("solveOrder",t.solveOrder),t.set&&e.writeAttributeString("set","1")})}function D(e,t){e.writeLeafElement("dimension",function(){t.measure&&e.writeAttributeString("measure","1"),_.isNullOrUndefined(t.name)||e.writeAttributeString("name",l(t.name)),_.isNullOrUndefined(t.uniqueName)||e.writeAttributeString("uniqueName",t.uniqueName),_.isNullOrUndefined(t.caption)||e.writeAttributeString("caption",t.caption)})}function N(e,t){e.writeLeafElement("measureGroup",function(){t.name&&e.writeAttributeString("name",l(t.name)),t.caption&&e.writeAttributeString("caption",t.caption)})}function F(e,t){e.writeLeafElement("measureDimensionMap",function(){0<=t.measureGroup&&e.writeAttributeString("measureGroup",t.measureGroup),0<=t.dimension&&e.writeAttributeString("dimension",t.dimension)})}function b(t,r){t.writeElement("r",function(){},function(){for(var e=0;e<r.length;e++)c(t,r[e])})}function P(e,n){n.items&&0<n.items.length?e.writeElement("pivotField",function(){y(e,n)},function(){var t,r;t=e,(r=n).items&&0<r.items.length&&t.writeElement("items",function(){t.writeAttributeString("count",r.items.length)},function(){for(var e=0;e<r.items.length;e++)C(t,r.items[e])}),_.isNullOrUndefined(r.AutoSortScope)||t.writeElement("autoSortScope",function(){w(t,r.autoSortScope)})}):e.writeLeafElement("pivotField",function(){y(e,n)})}function y(e,t){_.isNullOrUndefined(t.name)||e.writeAttributeString("name",l(t.name)),_.isNullOrUndefined(t.axis)||e.writeAttributeString("axis",t.axis),t.allDrilled&&e.writeAttributeString("allDrilled","1"),t.autoShow&&e.writeAttributeString("autoShow","1"),t.dataField&&e.writeAttributeString("dataField","1"),!1===t.compact&&e.writeAttributeString("compact","0"),0<=t.numFmtId&&e.writeAttributeString("numFmtId",t.numFmtId),!1===t.outline&&e.writeAttributeString("outline","0"),!1===t.subtotalTop&&e.writeAttributeString("subtotalTop","0"),t.multipleItemSelectionAllowed&&e.writeAttributeString("multipleItemSelectionAllowed","1"),!1===t.showAll&&e.writeAttributeString("showAll","0"),t.insertBlankRow&&e.writeAttributeString("insertBlankRow","1"),t.insertPageBreak&&e.writeAttributeString("insertPageBreak","1"),t.includeNewItemsInFilter&&e.writeAttributeString("includeNewItemsInFilter","1"),t.sumSubtotal&&e.writeAttributeString("sumSubtotal","1"),t.countASubtotal&&e.writeAttributeString("countASubtotal","1"),t.avgSubtotal&&e.writeAttributeString("avgSubtotal","1"),t.maxSubtotal&&e.writeAttributeString("maxSubtotal","1"),t.minSubtotal&&e.writeAttributeString("minSubtotal","1"),t.productSubtotal&&e.writeAttributeString("productSubtotal","1"),t.countSubtotal&&e.writeAttributeString("countSubtotal","1"),t.stdDevSubtotal&&e.writeAttributeString("stdDevSubtotal","1"),t.stdDevPSubtotal&&e.writeAttributeString("stdDevPSubtotal","1"),t.dataSourceSort&&e.writeAttributeString("dataSourceSort","1"),t.defaultAttributeDrillState&&e.writeAttributeString("defaultAttributeDrillState","1"),!1===t.dragOff&&e.writeAttributeString("dragOff","0"),!1===t.dragToCol&&e.writeAttributeString("dragToCol","0"),!1===t.dragToData&&e.writeAttributeString("dragToData","0"),!1===t.dragToPage&&e.writeAttributeString("dragToPage","0"),!1===t.dragToRow&&e.writeAttributeString("dragToRow","0"),t.hiddenLevel&&e.writeAttributeString("hiddenLevel","1"),t.hideNewItems&&e.writeAttributeString("hideNewItems","1"),t.itemPageCount&&10!==t.itemPageCount&&e.writeAttributeString("itemPageCount",t.itemPageCount),t.measureFilter&&e.writeAttributeString("measureFilter","1"),t.nonAutoSortDefault&&e.writeAttributeString("nonAutoSortDefault","1"),t.serverField&&e.writeAttributeString("serverField","1"),!1===t.showDropDowns&&e.writeAttributeString("showDropDowns","0"),t.showPropAsCaption&&e.writeAttributeString("showPropAsCaption","1"),t.showPropCell&&e.writeAttributeString("showPropCell","1"),t.showPropTip&&e.writeAttributeString("showPropTip","1"),_.isNullOrUndefined(t.sortType)||e.writeAttributeString("sortType",t.sortType),0<=t.rankBy&&e.writeAttributeString("rankBy",t.rankBy),!1===t.defaultSubtotal&&e.writeAttributeString("defaultSubtotal","0"),_.isNullOrUndefined(t.subtotalCaption)||e.writeAttributeString("subtotalCaption",t.subtotalCaption),!1===t.topAutoShow&&e.writeAttributeString("topAutoShow","0"),_.isNullOrUndefined(t.uniqueMemberProperty)||e.writeAttributeString("uniqueMemberProperty",t.uniqueMemberProperty),t.varSubtotal&&e.writeAttributeString("varSubtotal","1"),t.varPSubtotal&&e.writeAttributeString("varPSubtotal","1")}function C(e,t){e.writeLeafElement("item",function(){t.childItems&&e.writeAttributeString("c","1"),!1===t.expanded&&e.writeAttributeString("d","0"),!1===t.drillAcross&&e.writeAttributeString("e","0"),t.calculatedMember&&e.writeAttributeString("f","1"),t.hidden&&e.writeAttributeString("h","1"),t.missing&&e.writeAttributeString("m","1"),_.isNullOrUndefined(t.caption)||e.writeAttributeString("n",t.caption),t.character&&e.writeAttributeString("s","1"),!0===t.collapse&&e.writeAttributeString("sd","0"),t.type&&e.writeAttributeString("t",t.type),_.isNullOrUndefined(t.indexValue)||e.writeAttributeString("x",t.indexValue)})}function w(t,r,e){t.writeElement("pivotArea",function(){r.field&&-1!==r.field&&t.writeAttributeString("field",r.field),_.isNullOrUndefined(r.type)||"normal"===r.type||t.writeAttributeString("type",r.type),!1===r.dataOnly&&t.writeAttributeString("dataOnly","0"),r.labelOnly&&t.writeAttributeString("labelOnly","1"),r.grandRow&&t.writeAttributeString("grandRow","1"),r.grandCol&&t.writeAttributeString("grandCol","1"),r.cacheIndex&&t.writeAttributeString("cacheIndex","1"),_.isNullOrUndefined(r.outline)||t.writeAttributeString("outline","0"),r.collapsedLevelsAreSubtotals&&t.writeAttributeString("collapsedLevelsAreSubtotals","1"),r.axis&&(e||"axisValue"!==r.axis)&&t.writeAttributeString("axis",r.axis),0<=r.fieldPosition&&t.writeAttributeString("fieldPosition",r.fieldPosition),_.isNullOrUndefined(r.offset)||t.writeAttributeString("offset",r.offset)},function(){r.references&&0<r.references.length&&t.writeElement("references",function(){t.writeAttributeString("count",r.references.length)},function(){for(var e=0;e<r.references.length;e++)v(t,r.references[e])})})}function v(t,r){t.writeElement("reference",function(){r.field&&0<=r.field&&t.writeAttributeString("field",r.field),t.writeAttributeString("count",r.indexes.length),r.avgSubtotal&&t.writeAttributeString("avgSubtotal","1"),r.byPosition&&t.writeAttributeString("byPosition","1"),r.countASubtotal&&t.writeAttributeString("countASubtotal","1"),r.countSubtotal&&t.writeAttributeString("countSubtotal","1"),r.defaultSubtotal&&t.writeAttributeString("defaultSubtotal","1"),r.maxSubtotal&&t.writeAttributeString("maxSubtotal","1"),r.minSubtotal&&t.writeAttributeString("minSubtotal","1"),r.productSubtotal&&t.writeAttributeString("productSubtotal","1"),r.relative&&t.writeAttributeString("relative","1"),!1===r.selected&&t.writeAttributeString("selected","0"),r.stdDevPSubtotal&&t.writeAttributeString("stdDevPSubtotal","1"),r.stdDevSubtotal&&t.writeAttributeString("stdDevSubtotal","1"),r.sumSubtotal&&t.writeAttributeString("sumSubtotal","1"),r.varPSubtotal&&t.writeAttributeString("varPSubtotal","1"),r.varSubtotal&&t.writeAttributeString("varSubtotal","1")},function(){if(r.indexes&&0<r.indexes.length)for(var e=0;e<r.indexes.length;e++)S(t,r.indexes[e])})}function S(e,t){e.writeLeafElement("x",function(){e.writeAttributeString("v",t)})}function L(r,n,o){(o&&n.rowFields&&0<n.rowFields.length||!o&&n.columnFields&&0<n.columnFields.length)&&r.writeElement(o?"rowFields":"colFields",function(){r.writeAttributeString("count",o?n.rowFields.length:n.columnFields.length)},function(){var e,t=o?n.rowFields:n.columnFields;for(e=0;e<t.length;e++)O(r,t[e])})}function O(e,t){e.writeLeafElement("field",function(){e.writeAttributeString("x",t)})}function B(t,r){t.writeElement("i",function(){_.isNullOrUndefined(r.type)||t.writeAttributeString("t",r.type),0<r.repeatCount&&t.writeAttributeString("r",r.repeatCount),0<r.dataFieldIndex&&t.writeAttributeString("i",r.dataFieldIndex)},function(){if(r.pivotItemIndexes&&0<r.pivotItemIndexes.length)for(var e=0;e<r.pivotItemIndexes.length;e++)j(t,r.pivotItemIndexes[e])})}function j(e,t){e.writeLeafElement("x",function(){t&&0<t&&e.writeAttributeString("v",t)})}function H(e,t){e.writeLeafElement("pageField",function(){_.isNullOrUndefined(t.name)||e.writeAttributeString("name",l(t.name)),_.isNullOrUndefined(t.fld)||e.writeAttributeString("fld",t.fld),_.isNullOrUndefined(t.cap)||e.writeAttributeString("cap",t.cap),_.isNullOrUndefined(t.item)||e.writeAttributeString("item",t.item),_.isNullOrUndefined(t.hier)||e.writeAttributeString("hier",t.hier)})}function G(e,t){e.writeLeafElement("dataField",function(){_.isNullOrUndefined(t.name)||e.writeAttributeString("name",l(t.name)),_.isNullOrUndefined(t.fld)||e.writeAttributeString("fld",t.fld),_.isNullOrUndefined(t.subtotal)||e.writeAttributeString("subtotal",t.subtotal),_.isNullOrUndefined(t.showDataAs)||e.writeAttributeString("showDataAs",t.showDataAs),_.isNullOrUndefined(t.baseField)||e.writeAttributeString("baseField",t.baseField),_.isNullOrUndefined(t.baseItem)||e.writeAttributeString("baseItem",t.baseItem),_.isNullOrUndefined(t.numFmtId)||e.writeAttributeString("numFmtId",t.numFmtId)})}function U(e,t){e.writeElement("format",function(){"Formatting"===t.action||_.isNullOrUndefined(t.action)||e.writeAttributeString("action",t.action),0<=t.dxfId&&e.writeAttributeString("dxfId",t.dxfId)},function(){_.isNullOrUndefined(t.pivotArea)||w(e,t.pivotArea,!0)})}function W(t,r){t.writeElement("conditionalFormat",function(){"Selection"!==r.scope&&t.writeAttributeString("scope",r.scope),"None"!==r.type&&t.writeAttributeString("type",r.type),t.writeAttributeString("priority",r.priority)},function(){r.pivotAreas&&0<r.pivotAreas.length&&t.writeElement("pivotAreas",function(){t.writeAttributeString("count",r.pivotAreas.length)},function(){for(var e=0;e<r.pivotAreas.length;e++)w(t,r.pivotAreas[e])})})}function V(e,t){e.writeElement("chartFormat",function(){0<=t.chart&&e.writeAttributeString("chart",t.chart),0<=t.format&&e.writeAttributeString("format",t.format),t.series&&e.writeAttributeString("series","1")},function(){_.isNullOrUndefined(t.pivotArea)||w(e,t.pivotArea)})}function z(t,r){t.writeElement("pivotHierarchy",function(){_.isNullOrUndefined(r.caption)||t.writeAttributeString("caption",r.caption),r.dragOff||t.writeAttributeString("dragOff","0"),r.dragToRow||t.writeAttributeString("dragToRow","0"),r.dragToCol||t.writeAttributeString("dragToCol","0"),r.dragToPage||t.writeAttributeString("dragToPage","0"),r.dragToData&&t.writeAttributeString("dragToData","1"),r.includeNewItemsInFilter&&t.writeAttributeString("includeNewItemsInFilter","1"),r.multipleItemSelectionAllowed&&t.writeAttributeString("multipleItemSelectionAllowed","1"),r.outline&&t.writeAttributeString("outline","1"),r.showInFieldList&&t.writeAttributeString("showInFieldList","1"),r.subtotalTop&&t.writeAttributeString("subtotalTop","1")},function(){var e;r.memberProperties&&0<r.memberProperties.length&&t.writeElement("mps",function(){t.writeAttributeString("count",r.memberProperties.length)},function(){for(e=0;e<r.memberProperties.length;e++)q(t,r.memberProperties[e])}),r.members&&0<r.members.length&&t.writeElement("members",function(){t.writeAttributeString("count",r.members.length)},function(){for(e=0;e<r.members.length;e++)Z(t,r.members[e])})})}function q(e,t){e.writeLeafElement("mp",function(){_.isNullOrUndefined(t.name)||e.writeAttributeString("name",l(t.name)),t.showCell&&e.writeAttributeString("showCell","1"),t.showTip&&e.writeAttributeString("showTip","1"),t.showAsCaption&&e.writeAttributeString("showAsCaption","1"),0<t.nameLen&&e.writeAttributeString("nameLen",l(t.nameLen)),0<=t.pPos&&e.writeAttributeString("pPos",t.pPos),0<t.pLen&&e.writeAttributeString("pLen",t.pLen),0<t.level&&e.writeAttributeString("level",t.level),0<=t.field&&e.writeAttributeString("field",t.field)})}function Z(e,t){e.writeLeafElement("member",function(){_.isNullOrUndefined(t.name)||e.writeAttributeString("name",l(t.name))})}function Y(t,r,n){var e=n.operator,o=n.conType,i=s[o][e];r.writeElement("filter",function(){0<=n.fld&&r.writeAttributeString("fld",n.fld),0<=n.mpFld&&r.writeAttributeString("mpFld",n.mpFld),void 0!==i&&r.writeAttributeString("type",i),0<n.evalOrder&&r.writeAttributeString("evalOrder",n.evalOrder),0<=n.id&&r.writeAttributeString("id",n.id),0<=n.iMeasureHier&&r.writeAttributeString("iMeasureHier",n.iMeasureHier),0<=n.iMeasureFld&&r.writeAttributeString("iMeasureFld",n.iMeasureFld),_.isNullOrUndefined(n.name)||r.writeAttributeString("name",l(n.name)),_.isNullOrUndefined(n.description)||r.writeAttributeString("description",n.description),_.isNullOrUndefined(n.stringValue1)||r.writeAttributeString("stringValue1",n.stringValue1),_.isNullOrUndefined(n.stringValue2)||r.writeAttributeString("stringValue2",n.stringValue2)},function(){if(!_.isNullOrUndefined(n.autoFilter)){var e=t.Hi(n,i);a.writePivotAutoFilter(r,e)}})}function K(e,t,r){var n=r?"rowHierarchyUsage":"colHierarchyUsage";e.writeLeafElement(n,function(){e.writeAttributeString("hierarchyUsage",t)})}Object.defineProperty(t,"__esModule",{value:!0}),_=r("./src/common/common.ts"),n=r("./src/xml-io/xml-writer.ts"),x=r("./src/common/excel-types.ts"),o=r("./src/datamodel/datetime-helper.ts"),a=r("./src/xlsx-io/writer/autofilter-writer.ts"),s=[["captionEqual","captionNotEqual","captionBeginsWith","captionNotBeginsWith","captionEndsWith","captionNotEndsWith","captionContains","captionNotContains","captionGreaterThan","captionGreaterThanOrEqual","captionLessThan","captionLessThanOrEqual","captionBetween","captionNotBetween"],["dateEqual","dateNotEqual","dateOlderThan","dateOlderThanOrEqual","dateNewerThan","dateNewerThanOrEqual","dateBetween","dateNotBetween","today","yesterday","tomorrow",,"thisMonth","lastMonth","nextMonth","thisWeek","lastWeek","nextWeek","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","yearToDate"],["valueEqual","valueNotEqual","valueGreaterThan","valueGreaterThanOrEqual","valueLessThan","valueLessThanOrEqual","valueBetween","valueNotBetwee"],["count","percent","sum"]],l=_.Util.sa,i=_.Util.Fa,t.writePivotCacheDefinition=function(v){var S=new n.XmlWriter;return S.writeDocument(),S.writeElement("pivotCacheDefinition",function(){S.writeAttributeString("xmlns",x.XFileConstants.qd),S.writeAttributeString("xmlns:r",x.XFileConstants.Cd),S.writeAttributeString("xmlns:mc",x.XFileConstants.rd),S.writeAttributeString("mc:Ignorable",x.XFileConstants.yd),S.writeAttributeString("xmlns:xr",x.XFileConstants.Wd),S.writeAttributeString("r:id","rId1"),!1===v.saveData&&S.writeAttributeString("saveData","0"),_.isNullOrUndefined(v.refreshedBy)||S.writeAttributeString("refreshedBy",v.refreshedBy),_.isNullOrUndefined(v.refreshedDate)||S.writeAttributeString("refreshedDate",o.DateTimeHelper.Of(v.refreshedDate)),v.backgroundQuery&&S.writeAttributeString("backgroundQuery","1"),_.isNullOrUndefined(v.createdVersion)||S.writeAttributeString("createdVersion",v.createdVersion),_.isNullOrUndefined(v.refreshedVersion)||S.writeAttributeString("refreshedVersion",v.refreshedVersion),!1===v.enableRefresh&&S.writeAttributeString("enableRefresh","0"),v.invalid&&S.writeAttributeString("invalid","1"),0<v.minRefreshableVersion&&v.minRefreshableVersion<=v.createdVersion&&S.writeAttributeString("minRefreshableVersion",v.minRefreshableVersion),0<v.missingItemsLimit&&S.writeAttributeString("missingItemsLimit",v.missingItemsLimit),v.optimizeMemory&&S.writeAttributeString("optimizeMemory","1"),_.isNullOrUndefined(v.recordCount)||S.writeAttributeString("recordCount",v.recordCount),v.refreshOnLoad&&S.writeAttributeString("refreshOnLoad","1"),v.supportSubquery&&S.writeAttributeString("supportSubquery","1"),v.supportAdvancedDrill&&S.writeAttributeString("supportAdvancedDrill","1"),v.tupleCache&&S.writeAttributeString("tupleCache","1"),v.upgradeOnRefresh&&S.writeAttributeString("upgradeOnRefresh","1")},function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w;w=v,(C=S).writeElement("cacheSource",function(){C.writeAttributeString("type",w.sourceType)},function(){"worksheet"===w.sourceType&&C.writeLeafElement("worksheetSource",function(){w.sourceName&&C.writeAttributeString("name",w.sourceName),w.ref&&C.writeAttributeString("ref",w.ref),w.sheet&&C.writeAttributeString("sheet",w.sheet)})}),b=S,y=v.fields,b.writeElement("cacheFields",function(){b.writeAttributeString("count",y.length)},function(){var e,t;for(e=0;e<y.length;e++)t=y[e],T(b,t)}),v.cacheHierarchies&&0<v.cacheHierarchies.length&&(g=S,(m=v).cacheHierarchies&&0<m.cacheHierarchies.length&&g.writeElement("cacheHierarchies",function(){g.writeAttributeString("count",m.cacheHierarchies.length)},function(){for(var e=0;e<m.cacheHierarchies.length;e++)A(g,m.cacheHierarchies[e])})),v.KPIs&&0<v.KPIs.length&&(d=S,(p=v).KPIs&&0<p.KPIs.length&&d.writeElement("kpis",function(){d.writeAttributeString("count",p.KPIs.length)},function(){var e,t;for(e=0;e<p.KPIs.length;e++)t=p.KPIs[e],k(d,t)})),_.isNullOrUndefined(v.pivotTupleCache)||(h=S,f=v.pivotTupleCache,h.writeElement("tupleCache",function(){},function(){var e;f.entries&&0<f.entries.length&&h.writeElement("entries",function(){h.writeAttributeString("count",f.entries.length)},function(){for(e=0;e<f.entries.length;e++)h.writePivotCacheDefinitionSharedItem(h,f.entries[e])}),f.sets&&0<f.sets.length&&h.writeElement("sets",function(){h.writeAttributeString("count",f.sets.length)},function(){for(e=0;e<f.sets.length;e++)f.sets[e]}),f.queryCache&&0<f.queryCache.length&&h.writeElement("queryCache",function(){h.writeAttributeString("count",f.queryCache.length)},function(){for(e=0;e<f.queryCache.length;e++)M(h,f.queryCache[e])}),f.serverFormats&&0<f.serverFormats.length&&h.writeElement("serverFormats",function(){h.writeAttributeString("count",f.serverFormats.length)},function(){for(e=0;e<f.serverFormats.length;e++)I(h,f.serverFormats[e])})})),v.calculatedItems&&0<v.calculatedItems.length&&(u=S,(c=v.calculatedItems)&&u.writeElement("calculatedItems",function(){u.writeAttributeString("count",c.length)},function(){for(var e=0;e<c.length;e++)E(u,c[e])})),v.calculatedMembers&&0<v.calculatedMembers.length&&(s=S,(l=v.calculatedMembers)&&s.writeElement("calculatedMembers",function(){s.writeAttributeString("count",l.length)},function(){for(var e=0;e<l.length;e++)R(s,l[e])})),v.dimensions&&0<v.dimensions.length&&(i=S,!(a=v).dimensions||a.dimensions.length<=0||i.writeElement("dimensions",function(){i.writeAttributeString("count",a.dimensions.length)},function(){for(var e=0;e<a.dimensions.length;e++)D(i,a.dimensions[e])})),v.measureGroups&&0<v.measureGroups.length&&(n=S,!(o=v).measureGroups||o.measureGroups.length<=0||n.writeElement("measureGroups",function(){n.writeAttributeString("count",o.measureGroups.length)},function(){for(var e=0;e<o.measureGroups.length;e++)N(n,o.measureGroups[e])})),v.measureDimensionMaps&&0<v.measureDimensionMaps.length&&(t=S,!(r=v).measureDimensionMaps||r.measureDimensionMaps.length<=0||t.writeElement("maps",function(){t.writeAttributeString("count")},function(){for(var e=0;e<r.measureDimensionMaps.length;e++)F(t,r.measureDimensionMaps[e])})),(e=S).writeElement("extLst",function(){},function(){e.writeElement("ext",function(){e.writeAttributeString("xmlns:x14",x.XFileConstants.Jd)},function(){e.writeLeafElement("x14:pivotCacheDefinition")})})}),S.getXmlString()},t.writePivotCacheRecords=function(t){var r=new n.XmlWriter;return r.writeDocument(),r.writeElement("pivotCacheRecords",function(){r.writeAttributeString("xmlns",x.XFileConstants.qd),r.writeAttributeString("xmlns:r",x.XFileConstants.Cd),r.writeAttributeString("xmlns:mc",x.XFileConstants.rd),r.writeAttributeString("mc:Ignorable",x.XFileConstants.yd),r.writeAttributeString("xmlns:xr",x.XFileConstants.Wd),r.writeAttributeString("count",t.length)},function(){for(var e=0;e<t.length;e++)b(r,t[e])}),r.getXmlString()},t.writePivotTable=function(D,N){var F=new n.XmlWriter;return F.writeDocument(),F.writeElement("pivotTableDefinition",function(){F.writeAttributeString("xmlns",x.XFileConstants.qd),F.writeAttributeString("xmlns:mc",x.XFileConstants.rd),F.writeAttributeString("mc:Ignorable",x.XFileConstants.yd),F.writeAttributeString("xmlns:xr",x.XFileConstants.Wd),_.isNullOrUndefined(N.name)||F.writeAttributeString("name",l(N.name)),F.writeAttributeString("cacheId",N.cacheId),!1===N.applyNumberFormats&&F.writeAttributeString("applyNumberFormats","0"),!1===N.applyBorderFormats&&F.writeAttributeString("applyBorderFormats","0"),!1===N.applyFontFormats&&F.writeAttributeString("applyFontFormats","0"),!1===N.applyPatternFormats&&F.writeAttributeString("applyPatternFormats","0"),!1===N.applyAlignmentFormats&&F.writeAttributeString("applyAlignmentFormats","0"),N.applyWidthHeightFormats&&F.writeAttributeString("applyWidthHeightFormats","1"),N.dataCaption&&F.writeAttributeString("dataCaption",N.dataCaption),_.isNullOrUndefined(N.grandTotalCaption)||F.writeAttributeString("grandTotalCaption",N.grandTotalCaption),_.isNullOrUndefined(N.errorCaption)||F.writeAttributeString("errorCaption",N.errorCaption),N.showError&&F.writeAttributeString("showError","1"),_.isNullOrUndefined(N.missingCaption)||F.writeAttributeString("missingCaption",N.missingCaption),!1===N.showMissing&&F.writeAttributeString("showMissing","0"),0<N.updatedVersion&&F.writeAttributeString("updatedVersion",N.updatedVersion),0<N.minRefreshableVersion&&N.minRefreshableVersion<=N.createdVersion&&F.writeAttributeString("minRefreshableVersion",N.minRefreshableVersion),N.printDrill&&F.writeAttributeString("printDrill","1"),!1===N.showDrill&&F.writeAttributeString("showDrill","0"),!1===N.showDataTips&&F.writeAttributeString("showDataTips","0"),!1===N.enableDrill&&F.writeAttributeString("enableDrill","0"),!1===N.preserveFormatting&&F.writeAttributeString("preserveFormatting","0"),N.useAutoFormatting&&F.writeAttributeString("useAutoFormatting","1"),0<N.pageWrap&&F.writeAttributeString("pageWrap",N.pageWrap),N.pageOverThenDown&&F.writeAttributeString("pageOverThenDown","1"),!1===N.rowGrandTotals&&F.writeAttributeString("rowGrandTotals","0"),!1===N.colGrandTotals&&F.writeAttributeString("colGrandTotals","0"),N.itemPrintTitles&&F.writeAttributeString("itemPrintTitles","1"),N.fieldPrintTitles&&F.writeAttributeString("fieldPrintTitles","1"),N.mergeItem&&F.writeAttributeString("mergeItem","1"),0<N.createdVersion&&F.writeAttributeString("createdVersion",N.createdVersion),0<=N.indent&&F.writeAttributeString("indent",N.indent),N.asteriskTotals&&F.writeAttributeString("asteriskTotals","1"),0<N.autoFormatId&&F.writeAttributeString("autoFormatId",N.autoFormatId),_.isNullOrUndefined(N.colHeaderCaption)||F.writeAttributeString("colHeaderCaption",N.colHeaderCaption),!1===N.compact&&F.writeAttributeString("compact","0"),!1===N.compactData&&F.writeAttributeString("compactData","0"),N.dataOnRows&&F.writeAttributeString("dataOnRows","1"),0<N.dataPosition&&F.writeAttributeString("dataPosition",N.dataPosition),N.disableFieldList&&F.writeAttributeString("disableFieldList","1"),N.editData&&F.writeAttributeString("editData","1"),!1===N.enableFieldProperties&&F.writeAttributeString("enableFieldProperties","0"),!1===N.enableWizard&&F.writeAttributeString("enableWizard","0"),N.gridDropZones&&F.writeAttributeString("gridDropZones","1"),N.immersive&&F.writeAttributeString("immersive","1"),N.mdxSubqueries&&F.writeAttributeString("mdxSubqueries","1"),!1===N.showHeaders&&F.writeAttributeString("showHeaders","0"),N.outline&&F.writeAttributeString("outline","1"),N.outlineData&&F.writeAttributeString("outlineData","1"),!1===N.multipleFieldFilters&&F.writeAttributeString("multipleFieldFilters","0"),0<N.chartFormat&&F.writeAttributeString("chartFormat",N.chartFormat),N.fieldListSortAscending&&F.writeAttributeString("fieldListSortAscending","1"),!1===N.customListSort&&F.writeAttributeString("customListSort","0"),_.isNullOrUndefined(N.pageStyle)||F.writeAttributeString("pageStyle",N.PageStyle),_.isNullOrUndefined(N.pivotTableStyle)||F.writeAttributeString("pivotTableStyle",N.pivotTableStyle),N.published&&F.writeAttributeString("published","1"),_.isNullOrUndefined(N.rowHeaderCaption)||F.writeAttributeString("rowHeaderCaption",N.rowHeaderCaption),!1===N.showCalcMbrs&&F.writeAttributeString("showCalcMbrs","0"),N.showDataDropDown&&F.writeAttributeString("showDataDropDown","0"),!1===N.showDropZones&&F.writeAttributeString("showDropZones","0"),!1===N.showEmptyCol&&F.writeAttributeString("showEmptyCol","0"),!1===N.showEmptyRow&&F.writeAttributeString("showEmptyRow","0"),!1===N.showItems&&F.writeAttributeString("showItems","0"),!1===N.showMemberPropertyTips&&F.writeAttributeString("showMemberPropertyTips","0"),!1===N.showMultipleLabel&&F.writeAttributeString("showMultipleLabel","0"),N.subtotalHiddenItems&&F.writeAttributeString("subtotalHiddenItems","1"),_.isNullOrUndefined(N.tag)||F.writeAttributeString("tag",N.tag),_.isNullOrUndefined(N.vacatedStyle)||F.writeAttributeString("vacatedStyle",N.vacatedStyle),!1===N.visualTotals&&F.writeAttributeString("visualTotals","0")},function(){var e,t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R;R=N,(E=F).writeLeafElement("location",function(){E.writeAttributeString("ref",R.ref),0<=R.firstHeaderRow&&E.writeAttributeString("firstHeaderRow",R.firstHeaderRow),0<=R.firstDataRow&&E.writeAttributeString("firstDataRow",R.firstDataRow),0<=R.firstDataCol&&E.writeAttributeString("firstDataCol",R.firstDataCol),0<R.rowPageCount&&E.writeAttributeString("rowPageCount",R.rowPageCount),0<R.colPageCount&&E.writeAttributeString("colPageCount",R.colPageCount)}),I=N,(M=F).writeElement("pivotFields",function(){M.writeAttributeString("count",I.fields.length)},function(){for(var e=0;e<I.fields.length;e++)P(M,I.fields[e])}),L(F,N,!0),A=F,(k=N.rowItems).length<=0||A.writeElement("rowItems",function(){A.writeAttributeString("count",k.length)},function(){for(var e=0;e<k.length;e++)B(A,k[e])}),L(F,N,!1),x=F,T=N.columnItems,x.writeElement("colItems",function(){x.writeAttributeString("count",T.length)},function(){for(var e=0;e<T.length;e++)B(x,T[e])}),v=F,(S=N).pageFields&&0<S.pageFields.length&&v.writeElement("pageFields",function(){v.writeAttributeString("count",S.pageFields.length)},function(){for(var e=0;e<S.pageFields.length;e++)H(v,S.pageFields[e])}),C=F,(w=N).dataFields&&0<w.dataFields.length&&C.writeElement("dataFields",function(){C.writeAttributeString("count",w.dataFields.length)},function(){for(var e=0;e<w.dataFields.length;e++)G(C,w.dataFields[e])}),b=F,(y=N.formats)&&0<y.length&&b.writeElement("formats",function(){b.writeAttributeString("count",y.length)},function(){for(var e=0;e<y.length;e++)U(b,y[e])}),g=F,(m=N.conditionalFormats)&&0<m&&g.writeElement("conditionalFormats",function(){g.writeAttributeString("count",m.length)},function(){for(var e=0;e<m.length;e++)W(g,m[e])}),d=F,(p=N).chartFormats&&0<p.chartFormats.length&&d.writeElement("chartFormats",function(){d.writeAttributeString("count",p.chartFormats.length)},function(){for(var e=0;e<p.chartFormats.length;e++)V(d,p.chartFormats[e])}),h=F,(f=N).pivotHierarchies&&0<f.pivotHierarchies.length&&h.writeElement("pivotHierarchies",function(){h.writeAttributeString("count",f.pivotHierarchies.length)},function(){for(var e=0;e<f.pivotHierarchies.length;e++)z(h,f.pivotHierarchies[e])}),c=N,(u=F).writeLeafElement("pivotTableStyleInfo",function(){_.isNullOrUndefined(c.styleName)||u.writeAttributeString("name",c.styleName),c.showRowHeaders&&u.writeAttributeString("showRowHeaders","1"),c.showColHeaders&&u.writeAttributeString("showColHeaders","1"),!1===c.showRowStripes?u.writeAttributeString("showRowStripes","0"):u.writeAttributeString("showRowStripes","1"),!1===c.showColStripes?u.writeAttributeString("showColStripes","0"):u.writeAttributeString("showColStripes","1"),c.showLastColumn&&u.writeAttributeString("showLastColumn","1")}),a=D,s=F,(l=N).pivotFilters&&0<l.pivotFilters.length&&s.writeElement("filters",function(){s.writeAttributeString("count",l.pivotFilters.length)},function(){for(var e=0;e<l.pivotFilters.length;e++)Y(a,s,l.pivotFilters[e])}),o=F,(i=N).rowHierarchies&&0<i.rowHierarchies.length&&o.writeElement("rowHierarchiesUsage",function(){o.writeAttributeString("count",i.rowHierarchies.length)},function(){for(var e=0;e<i.rowHierarchies.length;e++)K(o,i.rowHierarchies[e],!0)}),r=F,(n=N).colHierarchies&&0<n.colHierarchies.length&&r.writeElement("rowHierarchiesUsage",function(){r.writeAttributeString("count",n.colHierarchies.length)},function(){for(var e=0;e<n.colHierarchies.length;e++)K(r,n.colHierarchies[e],!1)}),N.hideValuesRow&&(t=N,(e=F).writeElement("extLst",function(){e.writeElement("ext",function(){e.writeAttributeString("uri","{962EF5D1-5CA2-4c93-8EF4-DBF5C05439D2}"),e.writeAttributeString("xmlns:x14","http://schemas.microsoft.com/office/spreadsheetml/2009/9/main")},function(){e.writeLeafElement("x14:pivotTableDefinition",function(){e.writeAttributeString("hideValuesRow","1"),e.writeAttributeString("xmlns:xm","http://schemas.microsoft.com/office/excel/2006/main")})}),e.writeElement("ext",function(){e.writeAttributeString("uri","{747A6164-185A-40DC-8AA5-F01512510D54}"),e.writeAttributeString("xmlns:xpdl","http://schemas.microsoft.com/office/spreadsheetml/2016/pivotdefaultlayout")},function(){e.writeLeafElement("xpdl:pivotTableDefinition16",function(){0===t.subtotalsOnTopDefault&&e.writeAttributeString("SubtotalsOnTopDefault","0")})})}))}),F.getXmlString()}},"./src/xlsx-io/writer/print-writer.ts":function(e,t,r){"use strict";var h,s,l,n,o,f,d;function i(t,r,n){r&&0<r.length&&t.writeElement(n,function(){var e=r.length;t.writeAttributeString("count",e),t.writeAttributeString("manualBreakCount",e)},function(){r.forEach(function(e){0<e&&t.writeLeafElement("brk",function(){t.writeAttributeString("id",e),t.writeAttributeString("man","1"),"rowBreaks"===n?t.writeAttributeString("max",o.ExcelConstants.sb):"colBreaks"===n&&t.writeAttributeString("max",o.ExcelConstants.rb)})})})}Object.defineProperty(t,"__esModule",{value:!0}),h=r("./src/common/common.ts"),s=h.StringEx.C,l=h.Util.sa,n=r("./src/xml-io/xml-writer.ts"),o=r("./src/common/excel-types.ts"),f={0:"auto",1:"downThenOver",2:"overThenDown"},d={0:"auto",1:"portrait",2:"landscape"},t.writePageMargins=function(e,t,r){var n=r.Pi(t);n&&e.writeLeafElement("pageMargins",function(){e.writeAttributeString("left",n.left),e.writeAttributeString("right",n.right),e.writeAttributeString("top",n.top),e.writeAttributeString("bottom",n.bottom),e.writeAttributeString("header",n.header),e.writeAttributeString("footer",n.footer)})},t.writePrintOptions=function(e,t,r){var n=r.Qi(t);n&&(n.printGridLine||n.printRowColumnsHeaders||n.horizontalCentered||n.verticalCentered)&&e.writeLeafElement("printOptions",function(){n.printRowColumnsHeaders&&e.writeAttributeString("headings","1"),n.printGridLine&&e.writeAttributeString("gridLines","1"),n.horizontalCentered&&e.writeAttributeString("horizontalCentered","1"),n.verticalCentered&&e.writeAttributeString("verticalCentered","1")})},t.writePageSetup=function(u,e,t){var c=t.Ri(e);c&&u.writeLeafElement("pageSetup",function(){var e=c.useSmartPrint,t=c.paperSizeIndex,r=c.zoomFactor,n=c.firstPageNumber,o=c.smartPrintPagesWidth,i=c.smartPrintPagesHeight,a=f[c.pageOrder],s=d[c.orientation],l=c.copies;e&&(void 0===o&&(o=0),void 0===i&&(i=0)),!h.isNullOrUndefined(t)&&1<t&&u.writeAttributeString("paperSize",t),!h.isNullOrUndefined(r)&&.01<Math.abs(r-1)&&u.writeAttributeString("scale",Math.round(100*r)),h.isNullOrUndefined(n)||u.writeAttributeString("firstPageNumber",n),(0<o&&1!==o||0===o)&&u.writeAttributeString("fitToWidth",o),(0<i&&1!==i||0===i)&&u.writeAttributeString("fitToHeight",i),h.isNullOrUndefined(a)||0===a||u.writeAttributeString("pageOrder",a),h.isNullOrUndefined(s)||0===s||u.writeAttributeString("orientation",s),!1===c.showColor&&u.writeAttributeString("blackAndWhite","1"),!0===c.draft&&u.writeAttributeString("draft","1"),!0===c.useCustomStartingPage&&u.writeAttributeString("useFirstPageNumber","1"),1<l&&l<32767&&u.writeAttributeString("copies",l)})},t.writeHeadFooter=function(e,t,r){var n,o,i,a=r.Ri(t);!a||(!(i=(o=a).advancedHeadFooterSetting)||!i.headerFooterDifferentOddEvenPages&&!i.headerFooterDifferentFirstPage&&i.headerFooterScalesWithDocument&&i.headerFooterAlignWithPageMargin&&s(o.header)&&s(o.footer)&&s(i.headerOddPage)&&s(i.footerOddPage)&&s(i.headerEvenPage)&&s(i.footerEvenPage)&&s(i.headerFirstPage)&&s(i.footerFirstPage))||(n=a.advancedHeadFooterSetting,e.writeElement("headerFooter",function(){!0===n.headerFooterDifferentOddEvenPages&&e.writeAttributeString("differentOddEven","1"),!0===n.headerFooterDifferentFirstPage&&e.writeAttributeString("differentFirst","1"),!1===n.headerFooterScalesWithDocument&&e.writeAttributeString("scaleWithDoc","0"),!1===n.headerFooterAlignWithPageMargin&&e.writeAttributeString("alignWithMargins","0")},function(){s(n.headerOddPage)?s(a.header)||e.writeElementString("oddHeader",l(a.header)):e.writeElementString("oddHeader",l(n.headerOddPage)),s(n.footerOddPage)?s(a.footer)||e.writeElementString("oddFooter",l(a.footer)):e.writeElementString("oddFooter",l(n.footerOddPage)),s(n.headerEvenPage)||e.writeElementString("evenHeader",l(n.headerEvenPage)),s(n.footerEvenPage)||e.writeElementString("evenFooter",l(n.footerEvenPage)),s(n.headerFirstPage)||e.writeElementString("firstHeader",n.headerFirstPage),s(n.footerFirstPage)||e.writeElementString("firstFooter",n.footerFirstPage)}))},t.writeRowColumnBreaks=function(e,t,r){var n=r.Ri(t);n&&(i(e,n.rowBreakLines,"rowBreaks"),i(e,n.columnBreakLines,"colBreaks"))},t.writeLegacyDrawingHF=function(e,t){t.hm&&(e.writeLeafElement("legacyDrawingHF",function(){e.writeAttributeString("r:id",t.hm)}),t.hm="")},t.writeVmlDrawingFile=function(e){var l=new n.XmlWriter;return l.writeElement("xml",function(){l.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),l.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),l.writeAttributeString("xmlns:x","urn:schemas-microsoft-com:office:excel")},function(){l.writeElement("o:shapelayout",function(){l.writeAttributeString("v:ext","edit")},function(){l.writeLeafElement("o:idmap",function(){l.writeAttributeString("v:ext","edit"),l.writeAttributeString("data","1")})}),l.writeElement("v:shapetype",function(){l.writeAttributeString("id","_x0000_t75"),l.writeAttributeString("coordsize","21600,21600"),l.writeAttributeString("o:spt","75"),l.writeAttributeString("o:preferrelative","t"),l.writeAttributeString("path","m@4@5l@4@11@9@11@9@5xe"),l.writeAttributeString("filled","f"),l.writeAttributeString("stroked","f")},function(){l.writeLeafElement("v:stroke",function(){l.writeAttributeString("joinstyle","miter")}),l.writeElement("v:formulas",function(){l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","if lineDrawn pixelLineWidth 0")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","sum @0 1 0")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","sum 0 0 @1")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","prod @2 1 2")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","prod @3 21600 pixelWidth")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","prod @3 21600 pixelHeight")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","sum @0 0 1")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","prod @6 1 2")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","prod @7 21600 pixelWidth")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","sum @8 21600 0")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","prod @7 21600 pixelHeight")}),l.writeLeafElement("v:f",function(){l.writeAttributeString("eqn","sum @10 21600 0")})}),l.writeLeafElement("v:path",function(){l.writeAttributeString("o:extrusionok","f"),l.writeAttributeString("gradientshapeok","t"),l.writeAttributeString("o:connecttype","rect")}),l.writeLeafElement("o:lock",function(){l.writeAttributeString("v:ext","edit"),l.writeAttributeString("aspectratio","t")})});var a=25,s=1;e.forEach(function(e){var t,r,n,o,i;0<=["LH","CH","RH","LF","CF","RF"].indexOf(e.name)&&(t=l,r=e.rid,n=e.name,o=a++,i=s++,t.writeElement("v:shape",function(){t.writeAttributeString("id",n),t.writeAttributeString("o:spid","_x0000_s10"+o),t.writeAttributeString("type","#_x0000_t75"),t.writeAttributeString("style","position:absolute;margin-left:0;margin-top:0;width:100%pt;height:100%pt;z-index:"+i)},function(){t.writeLeafElement("v:imagedata",function(){t.writeAttributeString("o:relid",r),t.writeAttributeString("o:title",n)}),t.writeLeafElement("o:lock",function(){t.writeAttributeString("v:ext","edit"),t.writeAttributeString("rotation","t")})}))})}),l.getXmlString()}},"./src/xlsx-io/writer/sharedString-writer.ts":function(e,t,r){"use strict";var l,n,o,u,c;Object.defineProperty(t,"__esModule",{value:!0}),l=r("./src/common/common.ts"),n=r("./src/common/excel-types.ts"),o=r("./src/xml-io/xml-writer.ts"),u=r("./src/datamodel/excel-style.ts"),c=r("./src/xlsx-io/writer/style-writer.ts"),t.writeSharedString=function(a){var s=new o.XmlWriter;return s.writeDocument(),s.writeElement("sst",function(){s.writeAttributeString("xmlns",n.XFileConstants.qd),s.writeAttributeString("count",""+a.Jm),s.writeAttributeString("uniqueCount",""+a.Km.length)},function(){function e(e,t){var n=a.Km[e],o=n.value,i=o.length!==o.trim().length;s.writeElement("si",void 0,function(){var t,e,r;if(n.richText)for(t=n.richText,e=function(e){void 0!==t[e].text&&s.writeElement("r",void 0,function(){c.writerRichTextStyle(s,u.ConverterHelper.fromRichTextStyle(t[e].style)),t[e].text&&(i=t[e].text.length!==t[e].text.trim().length),s.writeElement("t",function(){i&&s.writeAttributeString("xml:space","preserve")},function(){s.writeValue(l.Util.sa(l.Util.Ba(t[e].text,!0)))})})},r=0;r<t.length;r++)e(r);else s.writeElement("t",function(){i&&s.writeAttributeString("xml:space","preserve")},function(){s.writeValue(l.Util.sa(l.Util.Ba(o,!0)))})})}var t,r;for(t=0,r=a.Km.length;t<r;t++)e(t)}),s.getXmlString()}},"./src/xlsx-io/writer/slicer-writer.ts":function(e,t,r){"use strict";var n,l,u,o,i;Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/xml-io/xml-writer.ts"),l=r("./src/common/excel-types.ts"),u=r("./src/common/common.ts"),o=r("./src/datamodel/excel-style.ts"),i=o.UnitHelper.pixelToEMU,t.writeSlicer=function(e){if(u.isNullOrUndefined(e))return null;var r=new n.XmlWriter;return r.writeDocument(),r.writeElement("slicers",function(){r.writeAttributeString("xmlns",l.XFileConstants.Nd),r.writeAttributeString("xmlns:mc",l.XFileConstants.Ld),r.writeAttributeString("mc:Ignorable","x"),r.writeAttributeString("xmlns:x",l.XFileConstants.Md)},function(){e.forEach(function(t){r.writeLeafElement("slicer",function(){r.writeAttributeString("name",u.Util.ya(t.name,"\n","_x000a_")),r.writeAttributeString("cache",t.nameInFormula),r.writeAttributeString("caption",t.captionName),u.isNullOrUndefined(t.columnCount)||r.writeAttributeString("columnCount",t.columnCount),u.isNullOrUndefined(t.showHeader)||t.showHeader||r.writeAttributeString("showCaption","0"),r.writeAttributeString("style",t.style.name);var e=241300;t.itemHeight&&(e=i(t.itemHeight)),r.writeAttributeString("rowHeight",e),t.disableResizingAndMoving&&r.writeAttributeString("lockedPosition","1")})})}),r.getXmlString()},t.writeSlicerCache=function(e,a){if(u.isNullOrUndefined(e))return null;var s=new n.XmlWriter;return s.writeDocument(),s.writeElement("slicerCacheDefinition",function(){s.writeAttributeString("xmlns",l.XFileConstants.Nd),s.writeAttributeString("xmlns:mc",l.XFileConstants.Ld),s.writeAttributeString("mc:Ignorable","x"),s.writeAttributeString("xmlns:x",l.XFileConstants.Md),s.writeAttributeString("name",e.nameInFormula),s.writeAttributeString("sourceName",e.sourceName)},function(){s.writeElement("extLst",function(){},function(){s.writeElement("x:ext",function(){s.writeAttributeString("uri","{2F2917AC-EB37-4324-AD4E-5DD8C200BD13}"),s.writeAttributeString("xmlns:x15",l.XFileConstants.Od)},function(){s.writeLeafElement("x15:tableSlicerCache",function(){var t,r,n,o,i;s.writeAttributeString("tableId",(o=e.tableName,i=null,a.forEach(function(e){e.name===o&&(i=e.id)}),i)),s.writeAttributeString("column",(t=e.columnName,r=e.tableName,n=null,a.forEach(function(e){e.name===r&&e.columns.forEach(function(e){e.name===t&&(n=e.id)})}),n)),2===e.sortState&&s.writeAttributeString("sortOrder","descending"),!1===e.visuallyNoDataItems?s.writeAttributeString("crossFilter","none"):!1===e.showNoDataItemsInLast&&s.writeAttributeString("crossFilter","showItemsWithNoData")})}),!1===e.showNoDataItems&&s.writeElement("x:ext",function(){s.writeAttributeString("uri","{470722E0-AACD-4C17-9CDC-17EF765DBC7E}"),s.writeAttributeString("xmlns:x15",l.XFileConstants.Od)},function(){s.writeLeafElement("x15:slicerCacheHideItemsWithNoData",function(){})})})}),s.getXmlString()},t.writeSlicersInWorkSheet=function(e,t,r){var n=r.Ki(t);n&&0!==n.length&&e.writeElement("ext",function(){e.writeAttributeString("uri","{3A4CF648-6AED-40f4-86FF-DC5316D8AED3}"),e.writeAttributeString("xmlns:x15",l.XFileConstants.Od)},function(){e.writeElement("x14:slicerList",function(){e.writeAttributeString("xmlns:x14",l.XFileConstants.Nd)},function(){n[0].rid&&e.writeLeafElement("x14:slicer",function(){e.writeAttributeString("r:id",n[0].rid)})})})},t.writeSlicerCacheInWorkbook=function(t,r){t.writeElement("extLst",function(){},function(){t.writeElement("ext",function(){t.writeAttributeString("uri","{46BE6895-7355-4a93-B00E-2C351335B9C9}"),t.writeAttributeString("xmlns:x15",l.XFileConstants.Od)},function(){t.writeElement("x15:slicerCaches",function(){t.writeAttributeString("xmlns:x14",l.XFileConstants.Nd)},function(){for(var e in r)r.hasOwnProperty(e)&&r[e]&&r[e].length&&r[e].forEach(function(e){e.cacheRid&&t.writeLeafElement("x14:slicerCache",function(){t.writeAttributeString("r:id",e.cacheRid)})})})})})},t.writeSlicerDrawings=function(t,e,n){e.forEach(function(e){var r,i,a,s;r=t,a=n,(s=(i=e)&&i.twoCellAnchor)&&r.writeElement("xdr:twoCellAnchor",function(){i.dynamicMove?i.dynamicSize||r.writeAttributeString("editAs","oneCell"):r.writeAttributeString("editAs","absolute")},function(){var e,t,n,o;a(r,"xdr:from",s.startPoint),a(r,"xdr:to",s.endPoint),o=i,(n=r).writeElement("mc:AlternateContent",function(){n.writeAttributeString("xmlns:mc",l.XFileConstants.Ld)},function(){var t,e,r;r=o,(e=n).writeElement("mc:Choice",function(){e.writeAttributeString("xmlns:sle15","http://schemas.microsoft.com/office/drawing/2012/slicer"),e.writeAttributeString("Requires","sle15")},function(){var i,a;a=r,(i=e).writeElement("xdr:graphicFrame",function(){i.writeAttributeString("macro","")},function(){var e,t,r,n,o;o=a,(n=i).writeElement("xdr:nvGraphicFramePr",function(){},function(){var e,t;t=o,(e=n).writeLeafElement("xdr:cNvPr",function(){e.writeAttributeString("id","2"),e.writeAttributeString("name",u.Util.ya(t.name,"\n","&#xA;"))}),n.writeLeafElement("xdr:cNvGraphicFramePr")}),(r=i).writeElement("xdr:xfrm",function(){},function(){var e,t;(t=r).writeLeafElement("a:off",function(){t.writeAttributeString("x","0"),t.writeAttributeString("y","0")}),(e=r).writeLeafElement("a:ext",function(){e.writeAttributeString("cx","0"),e.writeAttributeString("cy","0")})}),t=a,(e=i).writeElement("a:graphic",function(){},function(){var r,n;n=t,(r=e).writeElement("a:graphicData",function(){r.writeAttributeString("uri","http://schemas.microsoft.com/office/drawing/2010/slicer")},function(){var e,t;t=n,(e=r).writeLeafElement("sle:slicer",function(){e.writeAttributeString("xmlns:sle","http://schemas.microsoft.com/office/drawing/2010/slicer"),e.writeAttributeString("name",u.Util.ya(t.name,"\n","&#xA;"))})})})})}),(t=n).writeElement("mc:Fallback",function(){t.writeAttributeString("xmlns","")},function(){var e;(e=t).writeElement("xdr:sp",function(){e.writeAttributeString("macro",""),e.writeAttributeString("textlink","")},function(){var r,o,n;(n=e).writeElement("xdr:nvSpPr",function(){},function(){var t,e;(e=n).writeLeafElement("xdr:cNvPr",function(){e.writeAttributeString("id","0"),e.writeAttributeString("name","")}),(t=n).writeElement("xdr:cNvSpPr",function(){},function(){var e;(e=t).writeLeafElement("a:spLocks",function(){e.writeAttributeString("noTextEdit","1")})})}),(o=e).writeElement("xdr:spPr",function(){},function(){var e,t,r,n;(n=o).writeElement("a:xfrm",function(){},function(){var e,t;(t=n).writeLeafElement("a:off",function(){t.writeAttributeString("x","5486400"),t.writeAttributeString("y","942975")}),(e=n).writeLeafElement("a:ext",function(){e.writeAttributeString("cx","1828800"),e.writeAttributeString("cy","2524125")})}),(r=o).writeElement("a:prstGeom",function(){r.writeAttributeString("prst","rect")},function(){r.writeLeafElement("a:avLst")}),(t=o).writeElement("a:solidFill",function(){},function(){var e;(e=t).writeLeafElement("a:prstClr",function(){e.writeAttributeString("val","white")})}),(e=o).writeElement("a:ln",function(){e.writeAttributeString("w","1")},function(){var t;(t=e).writeElement("a:solidFill",function(){},function(){var e;(e=t).writeLeafElement("a:prstClr",function(){e.writeAttributeString("val","green")})})})}),(r=e).writeElement("xdr:txBody",function(){},function(){var e,t;(t=r).writeLeafElement("a:bodyPr",function(){t.writeAttributeString("vertOverflow","clip"),t.writeAttributeString("horzOverflow","clip")}),r.writeLeafElement("a:lstStyle"),(e=r).writeElement("a:p",function(){},function(){var r;(r=e).writeElement("a:r",function(){},function(){var e,t;(t=r).writeLeafElement("a:rPr",function(){t.writeAttributeString("lang","en-US"),t.writeAttributeString("sz","1100")}),(e=r).writeElement("a:t",function(){e.writeValue("This shape represents a table slicer. Table slicers are supported in Excel or later.    If the shape was modified in an earlier version of Excel, or if the workbook was saved in Excel 2007 or earlier, the slicer can't be used.")})})})})})})}),t=i,(e=r).writeLeafElement("xdr:clientData",function(){t.isLocked||e.writeAttributeString("fLocksWithSheet","0")})})})}},"./src/xlsx-io/writer/sparkline-writer.ts":function(e,t,r){"use strict";var o,a,s,n,l,i,u,c,h;function f(t,r,n){t.writeElement("x14:sparklineGroups",function(){t.writeAttributeString("xmlns:xm",o.XFileConstants.Kd)},function(){var e=n.Gi(r);0<e.length&&e.forEach(function(e){d(t,r,e)})})}function d(o,i,r){o.writeElement("x14:sparklineGroup",function(){var e=r&&r.setting;r.sparklineType&&o.writeAttributeString("type",u[r.sparklineType]),r.displayDateAxis&&o.writeAttributeString("dateAxis","1"),a.isNullOrUndefined(e)||(!a.isNullOrUndefined(e.lineWeight)&&.001<3*(""+e.lineWeight)/4-.75&&o.writeAttributeString("lineWeight",""+e.lineWeight),e.displayEmptyCellsAs?o.writeAttributeString("displayEmptyCellsAs",c[e.displayEmptyCellsAs]):o.writeAttributeString("displayEmptyCellsAs",c[0]),e.showMarkers&&o.writeAttributeString("markers","1"),e.showHigh&&o.writeAttributeString("high","1"),e.showLow&&o.writeAttributeString("low","1"),e.showFirst&&o.writeAttributeString("first","1"),e.showLast&&o.writeAttributeString("last","1"),e.showNegative&&o.writeAttributeString("negative","1"),e.displayXAxis&&o.writeAttributeString("displayXAxis","1"),e.displayHidden&&o.writeAttributeString("displayHidden","1"),e.rightToLeft&&o.writeAttributeString("rightToLeft","1"),e.minAxisType&&o.writeAttributeString("minAxisType",h[e.minAxisType]),e.maxAxisType&&o.writeAttributeString("maxAxisType",h[e.maxAxisType]),e.manualMin&&o.writeAttributeString("manualMin",e.manualMin),e.manualMax&&o.writeAttributeString("manualMax",e.manualMax))},function(){var e=r&&r.setting,t=n.ColorHelper.toExcelColor(e.seriesColor||"rgba(36,64,98,1.0)");l.writeColor(o,"x14:colorSeries",t),t=n.ColorHelper.toExcelColor(e.negativeColor||"brown"),l.writeColor(o,"x14:colorNegative",t),t=n.ColorHelper.toExcelColor(e.axisColor||"black"),l.writeColor(o,"x14:colorAxis",t),t=n.ColorHelper.toExcelColor(e.markersColor||"rgba(36,64,98,1.0)"),l.writeColor(o,"x14:colorMarkers",t),t=n.ColorHelper.toExcelColor(e.firstMarkerColor||"rgba(149,179,215,1.0)"),l.writeColor(o,"x14:colorFirst",t),t=n.ColorHelper.toExcelColor(e.lastMarkerColor||"rgba(149,179,215,1.0)"),l.writeColor(o,"x14:colorLast",t),t=n.ColorHelper.toExcelColor(e.highMarkerColor||"blue"),l.writeColor(o,"x14:colorHigh",t),t=n.ColorHelper.toExcelColor(e.lowMarkerColor||"blue"),l.writeColor(o,"x14:colorLow",t),r.displayDateAxis&&r.axisReference&&o.writeElement("xm:f",function(){o.writeValue(p(r.axisReference.sheetName||i,r.axisReference))}),r.sparklines&&0<r.sparklines.length&&o.writeElement("x14:sparklines",function(){r.sparklines.forEach(function(e){var t,r,n;r=i,n=e,(t=o).writeElement("x14:sparkline",function(){a.isNullOrUndefined(n.data)||(t.writeElement("xm:f",function(){},function(){t.writeValue(p(n.data.sheetName||r,n.data))}),t.writeElement("xm:sqref",function(){},function(){t.writeValue(s.getRangeString([{row:n.row,col:n.col,rowCount:1,colCount:1}]))}))})})})})}function p(e,t){return i(e)+"!"+s.getRangeString([t])}Object.defineProperty(t,"__esModule",{value:!0}),o=r("./src/common/excel-types.ts"),a=r("./src/common/common.ts"),s=r("./src/common/range-parser.ts"),n=r("./src/datamodel/excel-style.ts"),l=r("./src/xlsx-io/common/color-writer.ts"),i=a.IndexHelper.K,t.writeSparkline=function(e,t,r){!r.Gi(t)||r.Gi(t).length<1||e.writeElement("ext",function(){e.writeAttributeString("uri","{05C60535-1F16-4fd2-B633-F4F36F0B64E0}"),e.writeAttributeString("xmlns:x14",o.XFileConstants.Jd)},function(){f(e,t,r)})},t.writeSparklineGroups=f,u={0:"line",1:"column",2:"stacked"},c={2:"span",0:"gap",1:"zero"},h={0:"individual",1:"group",2:"custom"},t.writeSparklineGroup=d},"./src/xlsx-io/writer/style-writer.ts":function(e,t,r){"use strict";var n,d,x,T,A,k,i,M,p,g;function I(e){var t=e&&e.fontName;return t&&('"'===t.charAt(0)&&(t=t.substr(1)),'"'===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),e.fontName=t),e}function m(e,t){t.key<0||e.writeLeafElement("numFmt",function(){e.writeAttributeString("numFmtId",""+t.key),e.writeAttributeString("formatCode",k.Util.sa(""+t.value))})}function b(t,r,n){r&&t.writeElement("font",M,function(){if(r.isBold&&t.writeLeafElement("b"),r.isItalic&&t.writeLeafElement("i"),r.isStrikeOut&&t.writeLeafElement("strike"),0!==r.underLineStyle&&(1===r.underLineStyle?t.writeLeafElement("u"):t.writeLeafElement("u",function(){t.writeAttributeString("val",A.UnderLineStyle[r.underLineStyle])})),!n&&(0!==r.fontSize||-1!==r.fontSize)){var e=r.fontSize;0<e&&t.writeLeafElement("sz",function(){t.writeAttributeString("val",""+e)})}void 0!==r.fontColor&&r.fontColor!==T.ExcelColor.EmptyColor&&i.writeColor(t,"color",r.fontColor),n||(0!==r.vertAlign&&t.writeLeafElement("vertAlign",function(){t.writeAttributeString("val",A.VertAlign[r.vertAlign])}),k.StringEx.C(r.fontName)||t.writeLeafElement("name",function(){t.writeAttributeString("val",r.fontName)}),k.isNullOrUndefined(r.fontFamily)||0===r.fontFamily||t.writeLeafElement("family",function(){t.writeAttributeString("val",""+r.fontFamily)}),0<r.charSetIndex&&t.writeLeafElement("charset",function(){t.writeAttributeString("val",""+r.charSetIndex)}),r.isShadowStyle&&t.writeLeafElement("shadow",function(){t.writeAttributeString("val","1")}),r.isOutlineStyle&&t.writeLeafElement("outline",function(){t.writeAttributeString("val","1")}),0!==r.fontScheme&&t.writeLeafElement("scheme",function(){t.writeAttributeString("val",T.FontSchemeCategory[r.fontScheme])}))})}function y(n,o){n.writeElement("fill",M,function(){o.stops?n.writeElement("gradientFill",function(){var e,t,r=["degree","left","right","top","bottom"];for(e in r)t=r[e],k.isNullOrUndefined(o[t])||n.writeAttributeString(t,o[t]);"path"===o.type&&n.writeAttributeString("type","path")},function(){function e(e){n.writeElement("stop",function(){n.writeAttributeString("position",o.stops[e].position)},function(){i.writeColor(n,"color",o.stops[e].color)})}var t;for(t=0;t<o.stops.length;t++)e(t)}):n.writeElement("patternFill",function(){n.writeAttributeString("patternType",A.FillPatternType[o.patternType])},function(){o.fgColor&&i.writeColor(n,"fgColor",o.fgColor),o.bgColor&&i.writeColor(n,"bgColor",o.bgColor)})})}function C(t,r,n){t.writeElement("border",function(){r.diagonalDown&&r.diagonalDown.color&&r.diagonalDown.lineStyle&&t.writeAttributeString("diagonalDown",1),r.diagonalUp&&r.diagonalUp.color&&r.diagonalUp.lineStyle&&t.writeAttributeString("diagonalUp",1)},function(){(!n||n&&r.left)&&o(t,"left",r.left),(!n||n&&r.right)&&o(t,"right",r.right),(!n||n&&r.top)&&o(t,"top",r.top),(!n||n&&r.bottom)&&o(t,"bottom",r.bottom),r.vertical&&o(t,"vertical",r.vertical),r.horizontal&&o(t,"horizontal",r.horizontal);var e=!1;r.diagonalUp&&r.diagonalUp.color&&r.diagonalUp.lineStyle&&(o(t,"diagonal",r.diagonalUp),e=!0),r.diagonalDown&&r.diagonalDown.color&&r.diagonalDown.lineStyle&&!e&&o(t,"diagonal",r.diagonalDown)})}function o(e,t,r){r&&(0!==r.lineStyle||r.color?e.writeElement(t,function(){0!==r.lineStyle&&e.writeAttributeString("style",A.ExcelBorderStyle[r.lineStyle])},function(){r.color&&i.writeColor(e,"color",r.color)}):e.writeLeafElement(t))}function w(l,u,e,c){0===u.length?l.writeElement(e,function(){l.writeAttributeString("count","1")},function(){l.writeLeafElement("xf",function(){l.writeAttributeString("numFmtId","0"),l.writeAttributeString("fontId","0"),l.writeAttributeString("fillId","0"),l.writeAttributeString("borderId","0"),c||l.writeAttributeString("xfId","0")})}):l.writeElement(e,function(){l.writeAttributeString("count",""+u.length)},function(){function e(e,t){var r=u[e],n=r.item6,o=r.item7,i=0!==n.horizontalAlign||2!==n.verticalAlign||0!==n.rotation||0!==n.readingOrder||n.isWordWrap||n.isShrinkToFit||n.isJustfyLastLine||0<n.indent,a=o&&(o.item1||!o.item2),s="writeElement";i||a||(s="writeLeafElement"),l[s]("xf",function(){if(l.writeAttributeString("numFmtId",""+r.item1),l.writeAttributeString("fontId",""+r.item2),l.writeAttributeString("fillId",""+r.item3),l.writeAttributeString("borderId",""+r.item4),n){if(!c)if(n.isStyleFormat||k.isNullOrUndefined(n.parentFormatID))l.writeAttributeString("xfId","0");else{var e=n.parentFormatID;k.isNullOrUndefined(e)?l.writeAttributeString("xfId","0"):l.writeAttributeString("xfId",""+e)}k.isNullOrUndefined(n.applyNumberFormat)||l.writeAttributeString("applyNumberFormat",!0===n.applyNumberFormat?"1":"0"),k.isNullOrUndefined(n.applyFont)||l.writeAttributeString("applyFont",!0===n.applyFont?"1":"0"),k.isNullOrUndefined(n.applyFill)||l.writeAttributeString("applyFill",!0===n.applyFill?"1":"0"),k.isNullOrUndefined(n.applyBorder)||l.writeAttributeString("applyBorder",!0===n.applyBorder?"1":"0"),k.isNullOrUndefined(n.applyAlignment)||l.writeAttributeString("applyAlignment",!0===n.applyAlignment?"1":"0"),k.isNullOrUndefined(n.applyProtection)||l.writeAttributeString("applyProtection",!0===n.applyProtection?"1":"0"),k.isNullOrUndefined(n.quotePrefix)||l.writeAttributeString("quotePrefix",!0===n.quotePrefix?"1":"0")}},function(){i&&l.writeLeafElement("alignment",function(){0!==n.horizontalAlign&&l.writeAttributeString("horizontal",A.ExcelHorizontalAlignment[n.horizontalAlign]),2!==n.verticalAlign&&l.writeAttributeString("vertical",T.ExcelVerticalAlignment[n.verticalAlign]),!0===n.isVerticalText?l.writeAttributeString("textRotation",255):0!==n.rotation&&l.writeAttributeString("textRotation",""+n.rotation),0!==n.readingOrder&&l.writeAttributeString("readingOrder",A.TextDirection[n.readingOrder]),n.isWordWrap&&l.writeAttributeString("wrapText","1"),n.isShrinkToFit&&l.writeAttributeString("shrinkToFit","1"),n.isJustfyLastLine&&l.writeAttributeString("justifyLastLine","1"),0<n.indent&&l.writeAttributeString("indent",""+n.indent)}),a&&l.writeLeafElement("protection",function(){o.item2||l.writeAttributeString("locked","0"),o.item1&&l.writeAttributeString("hidden","1")})})}var t,r;for(t=0,r=u.length;t<r;t++)e(t)})}function v(e){e.writeElement("cellStyles",function(){e.writeAttributeString("count","1")},function(){e.writeLeafElement("cellStyle",function(){e.writeAttributeString("name","Normal"),e.writeAttributeString("builtinId","0"),e.writeAttributeString("xfId","0")})})}function S(n,o,e){n.writeElement(e,function(){var e,t,r=o.isColorFilter?o:T.ConverterHelper.toDifferentialFormatting(o);r.font&&b(n,r.font,r.isPartFontStyle),(r.numberFormat||0<=r.numberFormatIndex)&&(t=e=void 0,t=r.numberFormat?(e=r.numberFormat.numberFormatId,r.numberFormat.numberFormatCode):(e=r.numberFormatIndex,r.numberFormatCode),m(n,{key:e,value:t})),r.fill&&(1===r.fill.patternType&&(r.fill.bgColor=r.fill.fgColor),y(n,r.fill)),r.border&&C(n,r.border,r.isSlicerHeader)})}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/xml-io/xml-writer.ts"),d=r("./src/common/excel-types.ts"),x=r("./src/common/tuple.ts"),T=r("./src/datamodel/excel-style.ts"),A=r("./src/datamodel/excel-style.ts"),k=r("./src/common/common.ts"),i=r("./src/xlsx-io/common/color-writer.ts"),M=void 0,p={wholeSlicerStyle:"wholeTable",headerStyle:"headerRow",wholeTableStyle:"wholeTable",headerRowStyle:"headerRow",footerRowStyle:"totalRow",highlightFirstColumnStyle:"firstColumn",highlightLastColumnStyle:"lastColumn",firstRowStripStyle:"firstRowStripe",secondRowStripStyle:"secondRowStripe",firstColumnStripStyle:"firstColumnStripe",secondColumnStripStyle:"secondColumnStripe",firstHeaderCellStyle:"firstHeaderCell",lastHeaderCellStyle:"lastHeaderCell",firstFooterCellStyle:"firstTotalCell",lastFooterCellStyle:"lastTotalCell"},g={selectedItemWithDataStyle:"selectedItemWithData",selectedItemWithNoDataStyle:"selectedItemWithNoData",unSelectedItemWithDataStyle:"unselectedItemWithData",unSelectedItemWithNoDataStyle:"unselectedItemWithNoData",hoveredSelectedItemWithDataStyle:"hoveredSelectedItemWithData",hoveredSelectedItemWithNoDataStyle:"hoveredSelectedItemWithNoData",hoveredUnSelectedItemWithDataStyle:"hoveredUnselectedItemWithData",hoveredUnSelectedItemWithNoDataStyle:"hoveredUnselectedItemWithNoData"},t.writeStyle=function(c,e){var h=function(e,t){var r,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C={Sm:0,Mm:[],Nm:[],Om:[],Lm:{count:0},Pm:M,Ke:M,Rm:e.Vi()},w=e.oi(),v=e.pi(),S=e.qi();if(S&&0!==S.length||(v?((r=new T.ExcelStyle).builtInStyle=0,r.name="Normal",r.format(v),(S=[]).push(r)):(S=[]).push(T.BuiltInExcelStyles.getNormalStyle())),n="Normal",S)for(o=0,i=S.length;o<i;o++)(a=S[o]).isBuiltInStyle()&&0===a.builtInStyle&&(n=a.name);for(C.Ke=S,s=k.Util.oa(S,function(e){return e.name===n},null),l=k.Util.oa(w,function(e){return!e.isStyleFormat},null),u=k.Util.oa(w,function(e){return e.isStyleFormat},null),null!==l&&l.equals(v)||(w.splice(0,0,v),C.Sm+=1),null!==u&&u.equals(s.format())||(w.splice(0,0,s.format()),C.Sm+=1),d=f=h=c=0,p=I(s.format().font),C.Mm.push(p),(g=new A.ExcelFill).patternType=0,g.bgColor=T.ExcelColor.EmptyColor,g.fgColor=T.ExcelColor.EmptyColor,C.Nm.push(g),(g=new A.ExcelFill).patternType=17,g.bgColor=T.ExcelColor.EmptyColor,g.fgColor=T.ExcelColor.EmptyColor,C.Nm.push(g),C.Om.push(new T.ExcelBorder),C.Qm=[],C.Pm=[],o=m=0,i=w.length;o<i;o++)(b=w[o]).font&&-1===(c=k.Util.pa(C.Mm,b.font))&&(C.Mm.push(I(b.font)),c=C.Mm.length-1),b.numberFormat?(h=b.numberFormat.numberFormatId,void 0===C.Lm[h]&&C.Lm.count++,C.Lm[h]=b.numberFormat.numberFormatCode):0<=b.numberFormatIndex&&(h=b.numberFormatIndex),b.border&&-1===(d=k.Util.pa(C.Om,b.border))&&(C.Om.push(b.border),d=C.Om.length-1),k.isNullOrUndefined(b.fill)||0===b.fill.patternType?f=0:(y=b.fill,-1===(f=k.Util.pa(C.Nm,y))&&(C.Nm.push(y),f=C.Nm.length-1)),b.isStyleFormat?(t[m++]=""+C.Pm.length,C.Pm.push(new x.Tuple(h,c,f,d,0,b,new x.Tuple(b.isHidden,b.isLocked)))):(t[m++]=""+C.Qm.length,C.Qm.push(new x.Tuple(h,c,f,d,0,b,new x.Tuple(b.isHidden,b.isLocked))));return C}(c,e),f=new n.XmlWriter;return f.writeDocument(),f.writeElement("styleSheet",function(){f.writeAttributeString("xmlns",d.XFileConstants.qd),f.writeAttributeString("xmlns:mc",d.XFileConstants.rd),f.writeAttributeString("xmlns:x14ac",d.XFileConstants.vd),f.writeAttributeString("mc:Ignorable",d.XFileConstants.wd)},function(){var o,e,t,r,n,i,a,s,l,u;if(0<h.Lm.count&&f.writeElement("numFmts",function(){f.writeAttributeString("count",""+h.Lm.count)},function(){for(var e in h.Lm)h.Lm.hasOwnProperty(e)&&"count"!==e&&m(f,{key:e,value:h.Lm[e]})}),f.writeElement("fonts",function(){f.writeAttributeString("count",""+h.Mm.length)},function(){for(var e=0,t=h.Mm.length;e<t;e++)b(f,h.Mm[e])}),f.writeElement("fills",function(){f.writeAttributeString("count",""+h.Nm.length)},function(){f.writeElement("fill",M,function(){f.writeLeafElement("patternFill",function(){f.writeAttributeString("patternType","none")})}),f.writeElement("fill",M,function(){f.writeLeafElement("patternFill",function(){f.writeAttributeString("patternType","gray125")})});for(var e=2;e<h.Nm.length;e++)y(f,h.Nm[e])}),f.writeElement("borders",function(){f.writeAttributeString("count",""+h.Om.length)},function(){for(var e=0,t=h.Om.length;e<t;e++)C(f,h.Om[e])}),w(f,h.Pm,"cellStyleXfs",!0),w(f,h.Qm,"cellXfs",!1),0===h.Ke.length)v(f);else{for(o=[],t=0,r=(e=Object.keys(h.Rm)).length;t<r;t++)n=e[t],i=h.Rm[n],o.push(new x.Tuple(i,h.Ke[i],n));0===o.length?v(f):f.writeElement("cellStyles",function(){f.writeAttributeString("count",""+o.length)},function(){function e(e,t){var r=o[e],n=r.item2;n?f.writeLeafElement("cellStyle",function(){f.writeAttributeString("name",k.Util.sa(r.item3)),f.writeAttributeString("xfId",""+r.item1),n.isBuiltInStyle()&&(f.writeAttributeString("builtinId",""+n.builtInStyle),n.isCustomBuiltin&&f.writeAttributeString("customBuiltin","1"),1!==n.builtInStyle&&2!==n.builtInStyle||f.writeAttributeString("iLevel",""+n.outLineLevel))}):f.writeLeafElement("cellStyle",function(){f.writeAttributeString("name",r.item3),f.writeAttributeString("xfId",""+r.item1)})}var t,r;for(t=0,r=o.length;t<r;t++)e(t)})}a=f,s=c,0===(u=l||s.Re).length?a.writeLeafElement("dxfs",function(){a.writeAttributeString("count","0")}):a.writeElement("dxfs",function(){a.writeAttributeString("count",u.length)},function(){for(var e=0;e<u.length;e++)S(a,u[e],"dxf")}),0<c.Lg.length?f.writeElement("tableStyles",function(){f.writeAttributeString("count",c.Lg.length),f.writeAttributeString("defaultTableStyle","TableStyleMedium2"),f.writeAttributeString("defaultPivotStyle","PivotStyleMedium9")},function(){var e=c.Lg;e&&e.forEach(function(e){f.writeElement("tableStyle",function(){f.writeAttributeString("name",e.name),f.writeAttributeString("pivot","0"),f.writeAttributeString("count",e.styleElements.length),k.isNullOrUndefined(e.tableId)||f.writeAttributeString("table",e.tableId)},function(){e.styleElements&&0<e.styleElements.length&&e.styleElements.forEach(function(e){f.writeLeafElement("tableStyleElement",function(){f.writeAttributeString("type",p[e.type]),f.writeAttributeString("dxfId",e.dxfId),k.isNullOrUndefined(e.size)||f.writeAttributeString("size",e.size)})})})})}):f.writeLeafElement("tableStyles",function(){f.writeAttributeString("count","0"),f.writeAttributeString("defaultTableStyle","TableStyleMedium2"),f.writeAttributeString("defaultPivotStyle","PivotStyleLight16")}),0<c.Ng.length&&f.writeElement("extLst",function(){var t,e,n,o;o=c,(n=f).writeElement("ext",function(){n.writeAttributeString("uri","{46F421CA-312F-682f-3DD2-61675219B42D}"),n.writeAttributeString("xmlns:x14",d.XFileConstants.Nd)},function(){var t,r;t=n,0===(r=o.Xg).length?t.writeLeafElement("x14:dxfs",function(){t.writeAttributeString("count","0")}):t.writeElement("x14:dxfs",function(){t.writeAttributeString("count",r.length)},function(){for(var e=0;e<r.length;e++)S(t,r[e],"dxf")})}),t=f,e=c.Ng,t.writeElement("ext",function(){t.writeAttributeString("uri","{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}"),t.writeAttributeString("xmlns:x14",d.XFileConstants.Nd)},function(){t.writeElement("x14:slicerStyles",function(){t.writeAttributeString("defaultSlicerStyle","SlicerStyleLight1")},function(){e&&e.length&&e.forEach(function(e){t.writeElement("x14:slicerStyle",function(){t.writeAttributeString("name",e.name)},function(){e.styleElements&&e.styleElements.length&&t.writeElement("x14:slicerStyleElements",function(){e.styleElements.forEach(function(e){t.writeLeafElement("x14:slicerStyleElement",function(){t.writeAttributeString("type",g[e.type]),t.writeAttributeString("dxfId",e.dxfId)})})})})})})})})}),{xml:f.getXmlString(),styleOffset:h.Sm}},t.writerRichTextStyle=function(t,r){r&&t.writeElement("rPr",M,function(){if(r.isBold&&t.writeLeafElement("b"),0<r.charSetIndex&&t.writeLeafElement("charset",function(){t.writeAttributeString("val",""+r.charSetIndex)}),r.foreColor&&r.foreColor!==T.ExcelColor.EmptyColor&&i.writeColor(t,"color",r.foreColor),r.isCondense&&t.writeLeafElement("condense"),r.isExtend&&t.writeLeafElement("extend"),k.isNullOrUndefined(r.fontFamilySet)||0===r.fontFamilySet||t.writeLeafElement("family",function(){t.writeAttributeString("val",""+r.fontFamilySet)}),r.isItalic&&t.writeLeafElement("i"),r.isOutlineStyle&&t.writeLeafElement("outline",function(){t.writeAttributeString("val","1")}),k.StringEx.C(r.fontFamily)||t.writeLeafElement("rFont",function(){t.writeAttributeString("val",r.fontFamily)}),r.fontScheme&&0!==r.fontScheme&&t.writeLeafElement("scheme",function(){t.writeAttributeString("val",T.FontSchemeCategory[r.fontScheme])}),r.isShadowStyle&&t.writeLeafElement("shadow",function(){t.writeAttributeString("val","1")}),r.isStrikeOut&&t.writeLeafElement("strike"),r.fontSize&&0!==r.fontSize||-1!==r.fontSize){var e=r.fontSize;0<e&&t.writeLeafElement("sz",function(){t.writeAttributeString("val",""+e)})}r.underLineStyle&&0!==r.underLineStyle&&(1===r.underLineStyle?t.writeLeafElement("u"):t.writeLeafElement("u",function(){t.writeAttributeString("val",A.UnderLineStyle[r.underLineStyle])})),r.vertAlign&&0!==r.vertAlign&&t.writeLeafElement("vertAlign",function(){t.writeAttributeString("val",A.VertAlign[r.vertAlign])})})},t.writeDxf=S},"./src/xlsx-io/writer/table-writer.ts":function(e,t,r){"use strict";var a,s,l,u,c,h,f;Object.defineProperty(t,"__esModule",{value:!0}),a=r("./src/xml-io/xml-writer.ts"),s=r("./src/common/excel-types.ts"),l=r("./src/common/common.ts"),u=r("./src/common/range-parser.ts"),c=r("./src/xlsx-io/writer/autofilter-writer.ts"),h=r("./src/xlsx-io/writer/autofilter-writer.ts"),t.writeTable=function(r,n,o){if(l.isNullOrUndefined(r))return null;var i=new a.XmlWriter;return i.writeDocument(),i.writeElement("table",function(){i.writeAttributeString("xmlns",s.XFileConstants.ud),i.writeAttributeString("id",r.id);var e=r.name.split(" ").join("_");i.writeAttributeString("name",e),i.writeAttributeString("displayName",e.split("-").join("_")),i.writeAttributeString("ref",u.getRangeString([{row:r.row,col:r.col,rowCount:r.rowCount,colCount:r.colCount}])),!1===r.showHeader&&i.writeAttributeString("headerRowCount","0"),r.showFooter&&i.writeAttributeString("totalsRowCount","1")},function(){var e,t;r.rowFilter&&!l.isNullOrUndefined(r.rowFilter)&&(e=void 0,(t=n.Ii(o,r.rowFilter,r.tableSortInfo))&&t.sortInfo&&(e=t.sortInfo,t.sortInfo=null),!1!==r.showHeader&&(function(e){var t,r;if(!e.showFilterButton)return;for(r in t=e.filterButtonVisibleInfo)if(t.hasOwnProperty(r)&&!t[r])return;return 1}(r.rowFilter)||function(e){if(0===e.filterColumns.length)for(var t=0;t<e.range.colCount;t++)e.filterColumns.push({autoFilterColumnId:t});e.filterColumns.forEach(function(e){e.hiddenButton="1"})}(t),c.writeAutoFilter(i,t)),e&&h.writeSortInfo(i,e)),r.columns&&0<r.columns.length&&i.writeElement("tableColumns",function(){i.writeAttributeString("count",r.columns.length)},function(){r.columns.forEach(function(t){var r=function(e){var t,r;if(!l.isNullOrUndefined(e))return t=/\[\S[\S\s]*\S\]/,"SUBTOTAL("===(e=e.trim()).substr(0,9)&&t.test(e)?(r=e.substr(9,3),f[r]||"custom"):"custom"}(t.footerFormula);"custom"!==r?i.writeElement("tableColumn",function(){i.writeAttributeString("id",""+t.id);var e=t.name;e=l.Util.ya(e,"\r",""),i.writeAttributeString("name",l.Util.sa(l.Util.ya(e,"\n","_x000a_"))),l.isNullOrUndefined(t.footerValue)||i.writeAttributeString("totalsRowLabel",l.Util.sa(l.Util.Ba(""+t.footerValue,!0))),l.isNullOrUndefined(t.footerFormula)||i.writeAttributeString("totalsRowFunction",r)},function(){l.isNullOrUndefined(t.dataAreaFormula)||i.writeElement("calculatedColumnFormula",function(){i.writeValue(l.Util.sa(l.addXLFNPrefix(t.dataAreaFormula)))})}):i.writeElement("tableColumn",function(){i.writeAttributeString("id",""+t.id);var e=t.name;e=l.Util.ya(e,"\r",""),i.writeAttributeString("name",l.Util.sa(l.Util.ya(e,"\n","_x000a_"))),i.writeAttributeString("totalsRowFunction","custom")},function(){l.isNullOrUndefined(t.dataAreaFormula)||i.writeElement("calculatedColumnFormula",function(){i.writeValue(l.Util.sa(l.addXLFNPrefix(t.dataAreaFormula)))}),i.writeElement("totalsRowFormula",function(){i.writeValue(l.Util.sa(t.footerFormula))})})})}),r.style&&i.writeLeafElement("tableStyleInfo",function(){var e;e=l.isNullOrUndefined(r.style.buildInName)?r.style.name:"TableStyle"+r.style.buildInName,i.writeAttributeString("name",e),r.highlightFirstColumn?i.writeAttributeString("showFirstColumn","1"):i.writeAttributeString("showFirstColumn","0"),r.highlightLastColumn?i.writeAttributeString("showLastColumn","1"):i.writeAttributeString("showLastColumn","0"),l.isNullOrUndefined(r.bandRows)?i.writeAttributeString("showRowStripes","1"):i.writeAttributeString("showRowStripes","0"),r.bandColumns?i.writeAttributeString("showColumnStripes","1"):i.writeAttributeString("showColumnStripes","0")}),r.reservedElement&&i.writeElement("extLst",function(){},function(){i.writeElement("ext",function(){l.isNullOrUndefined(r.reservedElement.ext.pe.uri)||i.writeAttributeString("uri",r.reservedElement.ext.pe.uri),l.isNullOrUndefined(r.reservedElement.ext.pe["xmlns:x14"])||i.writeAttributeString("xmlns:x14",r.reservedElement.ext.pe["xmlns:x14"])},function(){var e,t=r.reservedElement.ext["vp:columns"];l.isNullOrUndefined(t)||i.writeElement("vp:columns",function(){l.isNullOrUndefined(t.pe["xmlns:vp"])||i.writeAttributeString("xmlns:vp",t.pe["xmlns:vp"])},function(){l.isNullOrUndefined(t["vp:columns"])||i.writeValue(t["vp:columns"])}),e=r.reservedElement.ext["x14:table"],l.isNullOrUndefined(e)||i.writeLeafElement("x14:table",function(){l.isNullOrUndefined(e.pe.altText)||i.writeAttributeString("altText",e.pe.altText),l.isNullOrUndefined(e.pe.altTextSummary)||i.writeAttributeString("altTextSummary",e.pe.altTextSummary)})})})}),i.getXmlString()},f={101:"average",102:"countNums",103:"count",104:"max",105:"min",107:"stdDev",109:"sum",110:"let"}},"./src/xlsx-io/writer/theme-writer.ts":function(e,t,r){"use strict";var o,l,i,a;function s(n,o,e){var t,r,i,a,s;if(o)if(o.runFormattings&&(n.writeLeafElement("a:"+l.FontLanguage[0],function(){n.writeAttributeString("typeface",u(o.runFormattings,0))}),n.writeLeafElement("a:"+l.FontLanguage[2],function(){n.writeAttributeString("typeface",u(o.runFormattings,2))}),n.writeLeafElement("a:"+l.FontLanguage[1],function(){n.writeAttributeString("typeface",u(o.runFormattings,1))})),o.themesFonts&&0<o.themesFonts.length)for(t=function(e,t){var r=o.themesFonts[e];n.writeLeafElement("a:font",function(){n.writeAttributeString("script",r.script),n.writeAttributeString("script",r.typeface)})},r=0,i=o.themesFonts.length;r<i;r++)t(r);else e?((s=n).writeLeafElement("a:font",function(){s.writeAttributeString("script","Jpan"),s.writeAttributeString("typeface"," ")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Hang"),s.writeAttributeString("typeface"," ")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Hans"),s.writeAttributeString("typeface","")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Hant"),s.writeAttributeString("typeface","")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Arab"),s.writeAttributeString("typeface","Times New Roman")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Hebr"),s.writeAttributeString("typeface","Times New Roman")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Thai"),s.writeAttributeString("typeface","Tahoma")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Ethi"),s.writeAttributeString("typeface","Nyala")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Beng"),s.writeAttributeString("typeface","Vrinda")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Gujr"),s.writeAttributeString("typeface","Shruti")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Khmr"),s.writeAttributeString("typeface","MoolBoran")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Knda"),s.writeAttributeString("typeface","Tunga")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Guru"),s.writeAttributeString("typeface","Raavi")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Cans"),s.writeAttributeString("typeface","Euphemia")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Cher"),s.writeAttributeString("typeface","Plantagenet Cherokee")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Yiii"),s.writeAttributeString("typeface","Microsoft Yi Baiti")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Tibt"),s.writeAttributeString("typeface","Microsoft Himalaya")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Thaa"),s.writeAttributeString("typeface","MV Boli")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Deva"),s.writeAttributeString("typeface","Mangal")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Telu"),s.writeAttributeString("typeface","Gautami")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Taml"),s.writeAttributeString("typeface","Latha")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Syrc"),s.writeAttributeString("typeface","Estrangelo Edessa")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Orya"),s.writeAttributeString("typeface","Kalinga")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Mlym"),s.writeAttributeString("typeface","Kartika")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Laoo"),s.writeAttributeString("typeface","DokChampa")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Sinh"),s.writeAttributeString("typeface","Iskoola Pota")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Mong"),s.writeAttributeString("typeface","Mongolian Baiti")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Viet"),s.writeAttributeString("typeface","Times New Roman")}),s.writeLeafElement("a:font",function(){s.writeAttributeString("script","Uigh"),s.writeAttributeString("typeface","Microsoft Uighur")})):((a=n).writeLeafElement("a:font",function(){a.writeAttributeString("script","Jpan"),a.writeAttributeString("typeface"," ")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Hang"),a.writeAttributeString("typeface"," ")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Hans"),a.writeAttributeString("typeface","")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Hant"),a.writeAttributeString("typeface","")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Arab"),a.writeAttributeString("typeface","Arial")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Hebr"),a.writeAttributeString("typeface","Arial")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Thai"),a.writeAttributeString("typeface","Tahoma")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Ethi"),a.writeAttributeString("typeface","Nyala")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Beng"),a.writeAttributeString("typeface","Vrinda")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Gujr"),a.writeAttributeString("typeface","Shruti")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Khmr"),a.writeAttributeString("typeface","DaunPenh")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Knda"),a.writeAttributeString("typeface","Tunga")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Guru"),a.writeAttributeString("typeface","Raavi")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Cans"),a.writeAttributeString("typeface","Euphemia")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Cher"),a.writeAttributeString("typeface","Plantagenet Cherokee")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Yiii"),a.writeAttributeString("typeface","Microsoft Yi Baiti")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Tibt"),a.writeAttributeString("typeface","Microsoft Himalaya")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Thaa"),a.writeAttributeString("typeface","MV Boli")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Deva"),a.writeAttributeString("typeface","Mangal")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Telu"),a.writeAttributeString("typeface","Gautami")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Taml"),a.writeAttributeString("typeface","Latha")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Syrc"),a.writeAttributeString("typeface","Estrangelo Edessa")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Orya"),a.writeAttributeString("typeface","Kalinga")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Mlym"),a.writeAttributeString("typeface","Kartika")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Laoo"),a.writeAttributeString("typeface","DokChampa")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Sinh"),a.writeAttributeString("typeface","Iskoola Pota")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Mong"),a.writeAttributeString("typeface","Mongolian Baiti")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Viet"),a.writeAttributeString("typeface","Arial")}),a.writeLeafElement("a:font",function(){a.writeAttributeString("script","Uigh"),a.writeAttributeString("typeface","Microsoft Uighur")}))}function u(e,t){var r,n,o;if(!e)return"";for(r=0,n=e.length;r<n;r++)if((o=e[r]).fontLanguage===t)return o.typeface;return""}Object.defineProperty(t,"__esModule",{value:!0}),o=r("./src/xml-io/xml-writer.ts"),l=r("./src/common/excel-types.ts"),i=r("./src/common/builtIn-resource.ts"),a=r("./src/xlsx-io/common/color-writer.ts"),t.writeTheme=function(e){var r,n=e.Qh();return n=n||"Office",(r=new o.XmlWriter).writeDocument(),r.writeElement("a:theme",function(){r.writeAttributeString("xmlns:a",l.XFileConstants.Fd),n&&n.name?r.writeAttributeString("name",n.name):"Office"===n?r.writeAttributeString("name","Office Theme"):r.writeAttributeString("name",n)},function(){r.writeElement("a:themeElements",void 0,function(){var e,t;n&&n.colorScheme?(e=n.colorScheme,r.writeElement("a:clrScheme",function(){r.writeAttributeString("name",e.name)},function(){a.writeColorScheme(r,"a:dk1",e.schemeColors[1]),a.writeColorScheme(r,"a:lt1",e.schemeColors[0]),a.writeColorScheme(r,"a:dk2",e.schemeColors[3]),a.writeColorScheme(r,"a:lt2",e.schemeColors[2]),a.writeColorScheme(r,"a:accent1",e.schemeColors[4]),a.writeColorScheme(r,"a:accent2",e.schemeColors[5]),a.writeColorScheme(r,"a:accent3",e.schemeColors[6]),a.writeColorScheme(r,"a:accent4",e.schemeColors[7]),a.writeColorScheme(r,"a:accent5",e.schemeColors[8]),a.writeColorScheme(r,"a:accent6",e.schemeColors[9]),a.writeColorScheme(r,"a:hlink",e.schemeColors[10]),a.writeColorScheme(r,"a:folHlink",e.schemeColors[11])})):i.ThemeClrSchemes[n]?r.xml.addString(i.ThemeClrSchemes[n]):r.xml.addString(i.ThemeClrSchemes.Office),n&&n.fontScheme?(t=n.fontScheme,r.writeElement("a:fontScheme",function(){r.writeAttributeString("name",t.name)},function(){r.writeElement("a:majorFont",void 0,function(){s(r,t.majorFont,!0)}),r.writeElement("a:minorFont",void 0,function(){s(r,t.minorFont,!1)})})):i.ThemeFontSchemes[n]?r.xml.addString(i.ThemeFontSchemes[n]):r.xml.addString(i.ThemeFontSchemes.Office),i.ThemeFmtSchemes[n]?r.xml.addString(i.ThemeFmtSchemes[n]):r.xml.addString(i.ThemeFmtSchemes.Office)}),r.writeLeafElement("a:objectDefaults",void 0),r.writeLeafElement("a:extraClrSchemeLst",void 0)}),r.getXmlString()},t.writeThemeFonts=s},"./src/xlsx-io/writer/workbook-writer.ts":function(e,t,r){"use strict";var n,o,v,S,x,T;function A(e,t,r,n,o){if(r===T&&n===T&&e===T&&t===T)return T;var i="";return r!==T&&(i+="$"+v.IndexHelper.I(r)),e!==T&&(i+="$"+(e+1)),i+=":",n!==T&&(i+="$"+v.IndexHelper.I(n)),t!==T&&(i+="$"+(t+1)),o?v.IndexHelper.K(o)+"!"+i:i}function i(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t.name&&e[r].localSheetId===t.localSheetId)return 1}function k(e,t){for(var r=0;r<t.length;r++)i(e,t[r])||e.push(t[r])}function M(e,t){v.isEmptyObject(t)||e.writeLeafElement("pivotCache",function(){e.writeAttributeString("cacheId",t.cacheId),e.writeAttributeString("r:id",t.rid)})}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/xml-io/xml-writer.ts"),o=r("./src/common/excel-types.ts"),v=r("./src/common/common.ts"),S=r("./src/xlsx-io/writer/slicer-writer.ts"),x=r("./src/datamodel/datamodel-writer.ts"),T=void 0,t.writeWorkbook=function(p,g,m,b,y,C){var w=new n.XmlWriter;return w.writeDocument(),w.writeElement("workbook",function(){w.writeAttributeString("xmlns",o.XFileConstants.qd),w.writeAttributeString("xmlns:r",o.XFileConstants.Cd)},function(){var t,r,n,o,i,a,e,s,l,u,c,h,f,d;f=w,d=p.Ai(),f.writeElement("bookViews",void 0,function(){f.writeLeafElement("workbookView",function(){!1===d.showHorizontalScrollbar&&f.writeAttributeString("showHorizontalScroll","0"),!1===d.showVerticalScrollbar&&f.writeAttributeString("showVerticalScroll","0"),!1===d.tabStripVisible&&f.writeAttributeString("showSheetTabs","0"),"number"==typeof d.tabStripRatio&&.6!==d.tabStripRatio&&f.writeAttributeString("tabRatio",""+1e3*d.tabStripRatio),"number"==typeof d.startSheetIndex&&0<d.startSheetIndex&&f.writeAttributeString("firstSheet",""+d.startSheetIndex),"number"==typeof d.activeSheetIndex&&0<d.activeSheetIndex&&f.writeAttributeString("activeTab",""+d.activeSheetIndex)})}),w.writeElement("sheets",void 0,function(){function e(e,t){var r=g[e];r&&w.writeLeafElement("sheet",function(){w.writeAttributeString("name",v.Util.sa(r.name)),w.writeAttributeString("sheetId",""+r.sheetId),p.Bi(r.name)&&w.writeAttributeString("state","hidden"),w.writeAttributeString("r:id",""+r.rID)})}var t,r;for(t=0,r=g.length;t<r;t++)e(t)}),a=w,s=b,c=(e=p).Ci(),h=function(e){var t,r,n,o=[],i=e.ri();for(t=0;t<i.length;t++)if(r=e.Ki(i[t]))for(n=0;n<r.length;n++)o.push({name:r[n].nameInFormula,formula:"#N/A"});return o}(e),k(c,h),l=function(e){var t,r,n,o,i,a,s=[],l=e.ri();for(t=0;t<l.length;t++)r=l[t],(n=e.Ti(r))&&(o=e.si(r),n.range&&(i=x.getFilterRange(o,n.range),(a=A(i.row,i.row+i.rowCount,i.col,i.col+i.colCount,r))&&s.push({name:"_xlnm._FilterDatabase",localSheetId:t,formula:a})));return s}(e),k(c,l),u=function(e){var t,r,n,o,i,a,s,l=[],u=e.ri();for(t=0;t<u.length;t++)r=u[t],(n=e.Si(r))&&((o=A(n.rowStart,n.rowEnd,n.columnStart,n.columnEnd,r))&&l.push({name:"_xlnm.Print_Area",localSheetId:t,formula:o}),i=A(n.repeatRowStart,n.repeatRowEnd,T,T,r),a=A(T,T,n.repeatColumnStart,n.repeatColumnEnd,r),s=void 0,i&&a?s=a+","+i:i?s=i:a&&(s=a),s&&l.push({name:"_xlnm.Print_Titles",localSheetId:t,formula:s}));return l}(e),k(c,u),k(c,s),0<c.length&&a.writeElement("definedNames",T,function(){function e(e){var t=c[e];a.writeElement("definedName",function(){a.writeAttributeString("name",v.Util.sa(t.name)),t.comment&&a.writeAttributeString("comment",v.Util.sa(t.comment)),-1<t.localSheetId&&a.writeAttributeString("localSheetId",t.localSheetId),!0===t.hidden&&a.writeAttributeString("hidden","1")},function(){a.writeValue(v.addXLFNPrefix(t.formula).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))})}var t;for(t=0;t<c.length;t++)e(t)}),o=m,i=C,(n=w).writeLeafElement("calcPr",function(){var e,t,r;n.writeAttributeString("calcId","0"),o&&n.writeAttributeString("refMode","R1C1"),e=v.isNullOrUndefined(i.iterate)||i.iterate?"1":"0",t=v.isNullOrUndefined(i.count)?"1000":i.count,r=v.isNullOrUndefined(i.delta)?"0.01":i.delta,n.writeAttributeString("iterate",e),n.writeAttributeString("iterateCount",t),n.writeAttributeString("iterateDelta",r)}),t=w,r=y,v.isEmptyObject(r)||t.writeElement("pivotCaches",function(){for(var e in r)r.hasOwnProperty(e)&&M(t,r[e])}),function(e,t,r){var n,o,i,a,s={},l=0;for(n=0,o=r.length;n<o;n++)(i=r[n])&&(a=t.Ki(i.name))&&a.length&&(s[i.name]=t.Ki(i.name),l++);l&&S.writeSlicerCacheInWorkbook(e,s)}(w,p,g)}),w.getXmlString()}},"./src/xlsx-io/writer/worksheet-writer.ts":function(e,t,r){"use strict";var ge,n,me,be,ye,Ce,we,ve,Se,xe,Te,Ae,ke,Me,g,o,m;function Ie(o,e,t,r,i,n,a,s,l,u){function c(){if(!a.keepRowColIndex&&t===r+1||!n&&!i||o.writeAttributeString("r",h),n){if(0<=n.formatId){var e=s[n.formatId+l];e!==Me&&(o.writeAttributeString("s",e),o.writeAttributeString("customFormat","1"))}n.customHeight&&(o.writeAttributeString("customHeight","1"),n.height!==Me&&o.writeAttributeString("ht",""+n.height)),!1===n.visible&&o.writeAttributeString("hidden","1"),n.collapsed&&o.writeAttributeString("collapsed","1"),"number"==typeof n.outLineLevel&&0!==n.outLineLevel&&o.writeAttributeString("outlineLevel",""+n.outLineLevel)}}var h=""+(t+1);i&&0<i.length?o.writeElement("row",c,function(){var e,t,r,n=-1;for(e=0,t=i.length;e<t;e++)(r=i[e]).col>=me.ExcelConstants.rb||(f(o,r,h,n,a,s,l,u),n=r.col)}):o.writeLeafElement("row",c)}function f(o,i,a,s,l,u,c,h){var e,r=i.value,n=i.formula,f=i.cellType,d=i.richText;function p(e){var t,r=h.Tm[e.value],n=h.Um[e.value];return n===Me&&(n=h.Um[e.value]=[]),t=function(e,t){for(var r=0,n=e.length;r<n;r++)if(g(e[r].value,t))return e[r].index}(n,e),r===Me||t===Me?(r=h.Km.length,h.Km.push(e),h.Tm[e.value]=r,n.push({index:r,value:e})):r=t,h.Jm++,r}i.prefix&&i.prefix.LET&&(n=i.prefix.LET),e=function(){var e,t,r,n;switch(!l.keepRowColIndex&&i.col===s+1||o.writeAttributeString("r",ge.IndexHelper.I(i.col)+a),-1===i.formatId?o.writeAttributeString("s","0"):(e=i.formatId+c,(t=u[e])!==Me&&o.writeAttributeString("s",t)),0!==f||ge.StringEx.C(i.formula)||(f=3),f){case 0:break;case 9:case 2:o.writeAttributeString("t","s");break;case 3:(r=i.value)===Me||null===r||i.isArrayFormula?i.isSpillError&&(o.writeAttributeString("t","e"),o.writeAttributeString("vm","2")):"#"===(""+r).substring(0,1)?(n=(""+r).toUpperCase(),-1!==m.indexOf(n)?o.writeAttributeString("t","e"):"string"==typeof r&&o.writeAttributeString("t","str")):"string"==typeof r&&o.writeAttributeString("t","str");break;case 8:i.isDynamicArray&&o.writeAttributeString("cm","1"),i.isSpillError?(o.writeAttributeString("t","e"),o.writeAttributeString("vm","1")):o.writeAttributeString("t","str");break;case 5:o.writeAttributeString("t","b");break;case 7:o.writeAttributeString("t","e")}},r!==Me&&null!==r||!ge.StringEx.q(n)?o.writeElement("c",e,function(){if(!ge.StringEx.q(n)){var t=i.arrayFormulaRange;i.isArrayFormula&&t?i.row===t.row&&i.col===t.col&&o.writeElement("f",function(){o.writeAttributeString("t","array");var e=ge.IndexHelper.I(t.col)+(t.row+1)+":"+ge.IndexHelper.I(t.col+t.colCount-1)+(t.row+t.rowCount);t.isInvalid&&(e=e.substr(0,e.indexOf(":"))),o.writeAttributeString("ref",e)},function(){o.writeValue(ge.Util.sa(ge.addXLFNPrefix(n)))}):o.writeElement("f",Me,function(){o.writeValue(ge.Util.sa(ge.addXLFNPrefix(n)))})}r!==Me&&null!==r&&o.writeElement("v",Me,function(){switch("string"==typeof r&&"/OADate"===r.substring(0,7)&&(f=6),f){case 3:"boolean"==typeof r&&(r=r?1:0),o.writeValue(ge.Util.sa(""+r));break;case 9:case 2:o.writeValue(""+p({value:r,richText:d}));break;case 7:o.writeValue(r._error);break;case 5:var e="1";("boolean"!=typeof r||r)&&"FALSE"!==(""+r).toUpperCase()||(e="0"),o.writeValue(e);break;case 6:default:o.writeValue(ge.Util.sa(""+r))}})}):o.writeLeafElement("c",e)}Object.defineProperty(t,"__esModule",{value:!0}),ge=r("./src/common/common.ts"),n=r("./src/xml-io/xml-writer.ts"),me=r("./src/common/excel-types.ts"),be=r("./src/xlsx-io/common/color-writer.ts"),ye=r("./src/common/tuple.ts"),Ce=r("./src/xlsx-io/writer/sparkline-writer.ts"),we=r("./src/xlsx-io/writer/conditionalformat-writer.ts"),ve=r("./src/xlsx-io/writer/slicer-writer.ts"),Se=r("./src/xlsx-io/writer/autofilter-writer.ts"),xe=r("./src/xlsx-io/writer/datavalidation-writer.ts"),Te=r("./src/xlsx-io/writer/datavalidation-writer.ts"),Ae=r("./src/datamodel/excel-helper.ts"),ke=r("./src/xlsx-io/writer/print-writer.ts"),Me=void 0,g=ge.Util.wa,["AVERAGEIF","AVERAGEIFS","CUBEKPIMEMBER","CUBEMEMBER","CUBEMEMBERPROPERTY","CUBERANKEDMEMBER","CUBESET","CUBESETCOUNT","CUBEVALUE","COUNTIFS","IFERROR","SUMIFS","ACOT","ACOTH","AGGREGATE","ARABIC","BASE","BETA.DIST","BETA.INV","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING.MATH","CEILING.PRECISE","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHISQ.TEST","COMBINA","CONCAT","CONFIDENCE.T","COT","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","DAYS","DECIMAL","ENCODEURL","ERF.PRECISE","ERFC.PRECISE","EXPON.DIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FILTERXML","FLOOR.MATH","FLOOR.PRECISE","FORMULATEXT","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMALN.PRECISE","HYPGEOM.DIST","IFNA","IFS","IMCOSH","IMCOT","IMCSCH","IMSEC","IMSECH","IMSINH","IMTAN","ISFORMULA","ISOWEEKNUM","LOGNORM.DIST","LOGNORM.INV","MAXIFS","MINIFS","MODE.MULT","MODE.SNGL","MUNIT","NEGBINOM.DIST","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NUMBERVALUE","PDURATION","PERCENTILE.EXC","PERCENTILE.INC","PERCENTRANK.EXC","PERCENTRANK.INC","PERMUTATIONA","PHI","POISSON.DIST","QUARTILE.EXC","QUARTILE.INC","RANK.AVG","RANK.EQ","RRI","SECH","SHEET","SHEETS","STDEV.P","STDEV.S","SWITCH","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TEXTJOIN","UNICHAR","UNICODE","VAR.P","VAR.S","WEBSERVICE","WEIBULL.DIST","XOR","Z.TEST"].concat(["RANDARRAY","SEQUENCE","SORTBY","UNIQUE","ANCHORARRAY","FILTER","SORT","SINGLE"]),o="_xlfn._xlws.",t.writeWorksheet=function(ae,se,le,ue,ce,he,fe,de){var pe=new n.XmlWriter;return pe.writeDocument(),pe.writeElement("worksheet",function(){pe.writeAttributeString("xmlns",me.XFileConstants.qd),pe.writeAttributeString("xmlns:r",me.XFileConstants.Cd),pe.writeAttributeString("xmlns:mc",me.XFileConstants.rd),fe&&fe.attributes&&fe.attributes.forEach(function(e){pe.writeAttributeString(e.key,e.value)}),pe.writeAttributeString("xmlns:x14ac",me.XFileConstants.vd),pe.writeAttributeString("xmlns:xr",me.XFileConstants.zd),pe.writeAttributeString("xmlns:xr2",me.XFileConstants.Ad),pe.writeAttributeString("xmlns:xr3",me.XFileConstants.Bd),pe.writeAttributeString("xr:uid",ge.Ja()),pe.writeAttributeString("mc:Ignorable",me.XFileConstants.xd)},function(){var n,e,t,o,r,i,a,s,l,u,c,h,f,d,p,g,m,b,y,C,w,v,S,x,T,A,k,M,I,E,R,D,N,F,_,P,L,O,B,j,H,G,U,W,V,z,q,Z,Y,K,X,J,Q,$,ee,te,re,ne,oe,ie;if(j=pe,H=se,U=(G=ae).ti(H),W=U.colsSumRight,V=U.rowsSumBelow,z=G.ui(H),q=G.Ri(H,!0),Z=q&&q.useSmartPrint,!z&&W&&V&&!0!==Z||j.writeElement("sheetPr",function(){null!==z&&be.writeColor(j,"tabColor",z),W&&V||j.writeLeafElement("outlinePr",function(){W||j.writeAttributeString("summaryRight","0"),V||j.writeAttributeString("summaryBelow","0")}),!0===Z&&j.writeLeafElement("pageSetUpPr",function(){j.writeAttributeString("fitToPage","1")})}),F=pe,_=se,L=(P=ae).vi(_),O=L.columnCount,B=L.rowCount,0<O&&0<B?F.writeLeafElement("dimension",function(){F.writeAttributeString("ref","A1:"+P.Th(O-1)+B)}):F.writeLeafElement("dimension",function(){F.writeAttributeString("ref","A1")}),D=se,N=ae,(R=pe).writeElement("sheetViews",Me,function(){R.writeElement("sheetView",function(){var e,t,r,n,o,i,a,s,l,u,c=N.wi(D),h=c.gridlineColor;null!==h&&1===h.colorType()&&64!==h.value()&&(R.writeAttributeString("defaultGridColor","0"),R.writeAttributeString("colorId",""+h.value())),e=N.xi(D),t=c.topLeftCell,r=e.frozenColCount,n=e.frozenRowCount,t&&void 0!==t.row&&void 0!==t.col&&(r||n?r&&!n?(o="A"+(t.row+1),R.writeAttributeString("topLeftCell",""+o)):!r&&n&&(o=N.Th(t.col)+"1",R.writeAttributeString("topLeftCell",""+o)):(o=""+N.Th(t.col)+(t.row+1),R.writeAttributeString("topLeftCell",""+o))),c.showGridLine||R.writeAttributeString("showGridLines","0"),c.showRowColHeaders||R.writeAttributeString("showRowColHeaders","0"),i=c.zoom,.1<Math.abs(1-i)&&R.writeAttributeString("zoomScale",""+Math.round(100*i)),(a=N.si(D)).showFormulas&&R.writeAttributeString("showFormulas","1"),R.writeAttributeString("workbookViewId","0"),(l=N.Ai())&&(s=l.activeSheetIndex),u=a.index===s,(a.isSelected||u)&&R.writeAttributeString("tabSelected",1)},function(){var h,f,d,p,g,e,t,r=N.xi(D),m=r.frozenColCount,b=r.frozenRowCount,n=0,o=0,i=3,a="1",s="A",l=N.wi(D).topLeftCell;for((0<m||0<b)&&(0<m?(n=m,s=N.Th(l.col)):n=0,0<b?(o=b,a=l.row+1+""):o=0,0<m&&0===b?i=1:0===m&&0<b?i=2:0<m&&0<b&&(i=0),R.writeLeafElement("pane",function(){0<m&&R.writeAttributeString("xSplit",""+m),0<b&&R.writeAttributeString("ySplit",""+b),s+a==="A1"?R.writeAttributeString("topLeftCell",""+N.Th(n)+(o+1)):R.writeAttributeString("topLeftCell",""+s+a),R.writeAttributeString("activePane",me.PaneType[i]),R.writeAttributeString("state","frozen")})),h=[],f=new ge.Range,d=0,g=-(p=1),e=function(e){var t,r,n,o,i,a,s,l,u,c;if(h.length=0,t=e,N.hi(D,h,f,t)){for(p=h.length,d=0;d<p;d++)-1!==(r=h[d]).col&&-1!==r.colCount||(r=new ge.Range(r.row,0,r.rowCount,me.ExcelConstants.rb)),-1!==r.row&&-1!==r.rowCount||(r=new ge.Range(0,r.col,me.ExcelConstants.sb,r.colCount)),f.col>=r.col&&f.col<=r.col+r.colCount-1&&f.row>=r.row&&f.row<=r.row+r.rowCount-1&&(g=d);if(g<0&&0<p&&(f.row=h[0].row,f.col=h[0].col),n=""+N.Th(f.col)+(f.row+1),o="",0<m&&0<b&&(1===t||2===t))o=n;else{for(d=0;d<p;d++)i=h[d],a=Math.min(me.ExcelConstants.sb,i.row+1),s=Math.min(i.col,me.ExcelConstants.rb),o+=""+N.Th(s)+a,(1<i.colCount||1<i.rowCount)&&(l=Math.min(s+i.colCount-1,me.ExcelConstants.rb),u=Math.min(a+i.rowCount-1,me.ExcelConstants.sb),c=""+N.Th(l)+u,o+=":"+c),o+=" ";o=o.trim()}ge.StringEx.C(o)||3===t&&(0<m||0<b||3!==t)||R.writeLeafElement("selection",function(){3!==t&&R.writeAttributeString("pane",me.PaneType[t]),R.writeAttributeString("activeCell",n),0!==g&&R.writeAttributeString("activeCellId",""+g),R.writeAttributeString("sqref",o)})}},t=3;0<=t;t--)e(t)})}),x=pe,T=se,k=(A=ae).ei(T),M=k.height,I=k.customHeight,E=A.fi(T),x.writeLeafElement("sheetFormatPr",function(){var e,t,r;isNaN(E)||x.writeAttributeString("defaultColWidth",""+E),I&&x.writeAttributeString("customHeight","1"),x.writeAttributeString("defaultRowHeight",""+M),t=(e=A.di(T)).outlineLevelRow-1,r=e.outlineLevelColumn-1,0<t&&x.writeAttributeString("outlineLevelRow",""+t),0<r&&x.writeAttributeString("outlineLevelCol",""+r)}),m=pe,b=se,C=le,w=ue,v=(y=ae).ai(b),S=y.ci(b),0!==v.length&&m.writeElement("cols",Me,function(){function e(e,t){var r,n,o,i=v[e],a=i.index;if(a>=me.ExcelConstants.rb)return s=e,"break";for(r=e+1,n=a;r<v.length&&((o=v[r]).index===n+1&&o.index<me.ExcelConstants.rb&&o.formatId===i.formatId&&o.visible===i.visible&&o.outLineLevel===i.outLineLevel&&o.collapsed===i.collapsed&&Math.abs(o.width-i.width)<=1e-4);)n=o.index,e=r,r++;m.writeLeafElement("col",function(){if(m.writeAttributeString("min",""+(a+1)),m.writeAttributeString("max",""+(n+1)),0<=i.formatId){var e=C[i.formatId+w];e!==Me?m.writeAttributeString("style",e):m.writeAttributeString("style","0")}isNaN(i.width)||i.width===Me?m.writeAttributeString("width",""+S):m.writeAttributeString("width",""+i.width),!1===i.visible&&m.writeAttributeString("hidden","1"),i.collapsed&&m.writeAttributeString("collapsed","1"),!isNaN(i.width)&&1e-4<Math.abs(i.width-S)&&m.writeAttributeString("customWidth","1"),"number"==typeof i.outLineLevel&&0!==i.outLineLevel&&m.writeAttributeString("outlineLevel",""+i.outLineLevel)}),s=e}var s,t,r,n;for(t=0,r=v.length;t<r&&(n=e(t),t=s,"break"!==n);t++);}),function(o,e,t,i,a,s,l){var r,n,u,c,h,f,d,p,g={},m=t.Wh(e);if(m)for(r=0,n=m.length;r<n;r++)(u=m[r])&&u.index<me.ExcelConstants.sb&&(g[u.index]=new ye.Tuple(u,[]));if(c=t.Vh(e))for(h in c)if(c.hasOwnProperty(h))for(f=c[h],r=0,d=f.length;r<d;r++)(p=f[r])&&(g[p.row]||(g[p.row]=new ye.Tuple(null,[])),g[p.row].item2.push(p));o.writeElement("sheetData",Me,function(){var e,t,r,n=-1;for(e in g)g.hasOwnProperty(e)&&(t=g[e],r=parseInt(e,10),Ie(o,0,r,n,t.item2,t.item1,i,a,s,l),n=r)})}(pe,se,ae,ce,le,ue,he),c=pe,h=se,p=(f=ae).yi(h),g=f.zi(h,p),(p||0<Object.keys(g).length)&&c.writeLeafElement("sheetProtection",function(){for(var e in p&&c.writeAttributeString("sheet","1"),g)g.hasOwnProperty(e)&&("string"==typeof(d=g[e])&&"algorithmName"===e||"hashValue"===e||"saltValue"===e||"spinCount"===e?c.writeAttributeString(e,d):Ae.excelSupportProtectionOptions[e]&&(d=g[e]?"0":"1",c.writeAttributeString(e,d)))}),Se.writeAutoFilterForSheet(pe,se,ae),s=pe,l=se,(u=ae.ji(l))&&0<u.length&&s.writeElement("mergeCells",function(){s.writeAttributeString("count",""+u.length)},function(){function e(e,t){var r=u[e];s.writeLeafElement("mergeCell",function(){s.writeAttributeString("ref",ge.IndexHelper.I(r.col)+(r.row+1)+":"+ge.IndexHelper.I(r.col+r.colCount-1)+(r.row+r.rowCount))})}var t,r;for(t=0,r=u.length;t<r;t++)e(t)}),we.writeConditionalFormating(pe,se,ae),xe.writeDataValidations(pe,se,ae),o=pe,r=se,i=de,(a=ae._g[r])&&0<a.length&&o.writeElement("hyperlinks",function(){function e(e,t){var r=a[e];o.writeLeafElement("hyperlink",function(){var e;o.writeAttributeString("ref",r.ref),r.location?o.writeAttributeString("location",r.location):((e=new me.XFile("",me.RelationshipConstants.gb)).target=r.url,e.targetMode="External",r.rid=i.he(e),o.writeAttributeString("r:id",r.rid)),r.display&&o.writeAttributeString("display",r.display),r.tooltip&&o.writeAttributeString("tooltip",r.tooltip),r["xr:uid"]&&o.writeAttributeString("xr:uid",r["xr:uid"])})}var t,r;for(t=0,r=a.length;t<r;t++)e(t)}),ke.writePrintOptions(pe,se,ae),ke.writePageMargins(pe,se,ae),ke.writePageSetup(pe,se,ae),ke.writeHeadFooter(pe,se,ae),ke.writeRowColumnBreaks(pe,se,ae),fe)for(n=[{name:"drawing",value:fe.drawingId},{name:"legacyDrawing",value:fe.legacyDrawingId}],e=function(e){var t=n[e],r=t.value;r&&pe.writeLeafElement(t.name,function(){pe.writeAttributeString("r:id",r)})},t=0;t<2;t++)e(t);ke.writeLegacyDrawingHF(pe,ae),ae.vh(se)&&0<ae.vh(se).length&&(oe=pe,ie=ae.vh(se),oe.writeElement("tableParts",function(){oe.writeAttributeString("count",""+ie.length)},function(){ie.forEach(function(e){oe.writeLeafElement("tablePart",function(){oe.writeAttributeString("r:id",e.rid)})})})),Q=se,((ne=(J=ae).Ki(Q))&&0<ne.length||($=J.Gi(Q))&&0<$.length||(ee=J.Zf(Q),(te=ee&&ee.rules)&&we.needWriteConditionalFormatExtension(te,Q,J.ri())||(re=J.Im)&&0<re.length))&&(K=se,X=ae,(Y=pe).writeElement("extLst",Me,function(){we.writeExtensionConditionalFormats(Y,K,X),Ce.writeSparkline(Y,K,X),ve.writeSlicersInWorkSheet(Y,K,X),Te.writeExtensionDataValidations(Y,X)}))}),pe.getXmlString()},m=["#REF!","#NULL!","#DIV/0!","#VALUE!","#NAME?","#NUM!","#N/A","#SPILL!","#CALC!"]},"./src/xlsx-io/writer/xlsx-writer.ts":function(e,t,r){"use strict";var T,A,k,n,o,i,a,s,l,u,c,h,f,d,p,g,m,b,y,M,C,w,v,S;function x(e,t,r){var n,o,i,a=e.imageType||"jpg";return"svg+xml"===a&&(a="svg"),n=T.XFileConstants.Xc+t+"."+a,(o=new T.XFile(T.XFileConstants.Gc+"/"+n,T.RelationshipConstants.hb)).target="../media/"+n,i=r.he(o),e.rid=i,o}function I(e,t){var r=this;r.Sm=0,r.Vm=void 0,r.Wm={},r.pm=[],r.Xm=1===e.referenceStyle,r.Ym={iterate:e.iterativeCalculation,count:e.iterativeCalculationMaximumIterations,delta:e.iterativeCalculationMaximumChange},r.Hj={},r.Zm=S(),r.$m=0,r._m=0,r.an=0,r.bn=0,r.cn=0,r.dn=0,r.fn=0,r.Vm=new n.WriterDataModel(e),r.Vm.onCompleted=function(){t.call(r)},r.Vm.fh(),r.Vm&&r.Vm.nh()}Object.defineProperty(t,"__esModule",{value:!0}),T=r("./src/common/excel-types.ts"),A=r("./src/common/common.ts"),k=r("./src/xml-io/xml-writer.ts"),n=r("./src/datamodel/datamodel-writer.ts"),o=r("./src/xlsx-io/writer/style-writer.ts"),i=r("./src/xlsx-io/writer/docPropsCoreWriter.ts"),a=r("./src/xlsx-io/writer/docPropsAppWriter.ts"),s=r("./src/xlsx-io/writer/docPropsCustomWriter.ts"),l=r("./src/xlsx-io/writer/worksheet-writer.ts"),u=r("./src/xlsx-io/writer/sharedString-writer.ts"),c=r("./src/xlsx-io/writer/theme-writer.ts"),h=r("./src/xlsx-io/writer/workbook-writer.ts"),f=r("./src/xlsx-io/writer/comment-writer.ts"),d=r("./src/xlsx-io/writer/drawing-writer.ts"),p=r("./src/xlsx-io/writer/table-writer.ts"),g=r("./src/xlsx-io/writer/slicer-writer.ts"),m=r("./src/xlsx-io/writer/slicer-writer.ts"),b=r("./src/xlsx-io/writer/print-writer.ts"),y=r("./src/xlsx-io/writer/metadata-writer.ts"),M=r("./src/xlsx-io/writer/chart-writer.ts"),C=r("./src/datamodel/excel-helper.ts"),w=r("./src/datamodel/excel-style.ts"),v=r("./src/xlsx-io/writer/pivot-writer.ts"),S=r("./src/lib/jszip.min.js"),I.prototype.Ij=function(){var e,t,r,n=this,o=new T.XFile("",""),i=new T.XFile(T.XFileConstants.hd,T.RelationshipConstants.Pa);o.he(i),n.gn(o),e={Km:[],Tm:{},Jm:0,Um:{}},t=n.hn(i),r=[],n.jn(n.Vm.we.pivotCaches,i),n.kn(i,t,e,r),n.mn(i,e),n.nn(i),n.pn(i),n.qn(r),n.rn(o),n.sn(o,0<n.$m),n.rm(),n.Zm.generateAsync({type:n.Hj.useArrayBuffer?"arraybuffer":"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",compression:"DEFLATE"}).then(function(e){n.onZip(e)}).catch(function(){n.onError()})},I.prototype.gn=function(e){var t,r,n,o=this.Vm.we;A.isNullOrUndefined(o.docProps)||(o.docProps.docPropsCore&&(t=new T.XFile(T.XFileConstants.jd,T.RelationshipConstants.Ma),e.he(t),this.tn()),o.docProps.docPropsApp&&(r=new T.XFile(T.XFileConstants.kd,T.RelationshipConstants.Na),e.he(r),this.un()),o.docProps.docPropsCustom&&(n=new T.XFile(T.XFileConstants.ld,T.RelationshipConstants.Oa),e.he(n),this.vn()))},I.prototype.rn=function(e){var t,r,n,o,i,a,s,l,u;if(!A.isNullOrUndefined(e)&&!A.isNullOrUndefined(e.relationFiles)&&0!==e.relationFiles.count){for(i in r=(t=A.Util.va(e.fileName)).dir,n=t.fileName,o={},e.relationFiles)e.relationFiles.hasOwnProperty(i)&&(a=e.relationFiles[i])&&"count"!==i&&(s=[a.target||a.fileName.replace(r+"/",""),a.fileType],a.targetMode&&s.push(a.targetMode),o[i]=s,this.rn(a));(l=new k.XmlWriter).writeDocument(),l.writeElement("Relationships",function(){l.writeAttributeString("xmlns",T.XFileConstants.Ed)},function(){function e(e){if(o.hasOwnProperty(e)){var t=o[e];t&&2<=t.length&&l.writeLeafElement("Relationship",function(){l.writeAttributeString("Id",e),l.writeAttributeString("Type",t[1]),l.writeAttributeString("Target",t[0]),t[2]&&l.writeAttributeString("TargetMode",t[2])})}}var t;for(t in o)e(t)}),u=r+"/"+T.XFileConstants.xb+"/"+n+"."+T.XFileConstants.Cb,this.Zm.file(u.substring(1),l.getXmlString())}},I.prototype.sn=function(e,t){var n=this.Vm.Uh(e,t),o=new k.XmlWriter;o.writeDocument(),o.writeElement("Types",function(){o.writeAttributeString("xmlns",T.XFileConstants.Dd)},function(){function e(e,t){var r=n[e];r instanceof T.DefaultContentType?o.writeLeafElement("Default",function(){o.writeAttributeString("Extension",r.extension),o.writeAttributeString("ContentType",r.contentType)}):r instanceof T.OverrideContentType&&o.writeLeafElement("Override",function(){o.writeAttributeString("PartName",r.partName),o.writeAttributeString("ContentType",r.contentType)})}var t,r;for(t=0,r=n.length;t<r;t++)e(t)}),this.Zm.file(T.XFileConstants.zb,o.getXmlString())},I.prototype.tn=function(){var e=i.writeDocPropsCore(this.Vm);this.Zm.file(T.XFileConstants.jd.substring(1),e)},I.prototype.un=function(){var e=a.writeDocPropsApp(this.Vm);this.Zm.file(T.XFileConstants.kd.substring(1),e)},I.prototype.vn=function(){var e=s.writeDocPropsCustom(this.Vm);this.Zm.file(T.XFileConstants.ld.substring(1),e)},I.prototype.hn=function(e){var t,r=new T.XFile(T.XFileConstants.md,T.RelationshipConstants.Ra);return e.he(r),t=o.writeStyle(this.Vm,this.Wm),this.Zm.file(T.XFileConstants.md.substring(1),t.xml),t.styleOffset},I.prototype.kn=function(e,t,r,n){var o,i,a,s,l,u,c,h=this.Vm,f=h.ri(),d=f.length,p=0,g=h.vh();for(g&&0<g.length&&g.forEach(function(e){e.id=++p}),o=0;o<d;o++)(i=f[o])&&((a=new T.SheetInfo).name=i,a.sheetId=o+1,a.index=o,s=new T.XFile(T.XFileConstants.Ic+"/"+T.XFileConstants.Oc+a.sheetId+"."+T.XFileConstants.gc,T.RelationshipConstants.Ta),a.rID=e.he(s),this.pm.push(a),l={attributes:[]},this.wn(h,i,s,l,o),u=h.Ni(i),c=this.xn(s,l,u.withDrawingObjects),this.yn(h,c,i,u.charts,n),this.zn(h,c,u),this.An(h,s,i),this.Bn(h,s,i,e),this.Cn(h,s,i,e),this.Dn(h,s,i),this.En(a,t,r,l,s))},I.prototype.mn=function(e,t){var r,n;t.Km.length<=0||(r=new T.XFile(T.XFileConstants.dd,T.RelationshipConstants.Ua),e.he(r),n=u.writeSharedString(t),this.Zm.file(T.XFileConstants.dd.substring(1),n))},I.prototype.nn=function(e){var t,r=new T.XFile(T.XFileConstants.ed,T.RelationshipConstants.Wa);e.he(r),t=c.writeTheme(this.Vm),this.Zm.file(T.XFileConstants.nd.substring(1),t)},I.prototype.qn=function(e){var t=h.writeWorkbook(this.Vm,this.pm,this.Xm,e,this.Fn,this.Ym);this.Zm.file(T.XFileConstants.hd.substring(1),t)},I.prototype.jn=function(e,t){var r,n,o,i,a,s,l,u;if(e)for(o in n=r=1,this.Fn={},e)e.hasOwnProperty(o)&&(i=new T.XFile(T.XFileConstants.Mc+"/"+T.XFileConstants._c+r+"."+T.XFileConstants.gc,T.RelationshipConstants.Ya),a=new T.XFile(T.XFileConstants.Mc+"/"+T.XFileConstants.ad+n+"."+T.XFileConstants.gc,T.RelationshipConstants.Za),s=t.he(i),this.Fn[o]={file:i,cacheId:o,rid:s},l=v.writePivotCacheDefinition(e[o]),this.Zm.file((T.XFileConstants.Mc+"/"+T.XFileConstants._c+r+"."+T.XFileConstants.gc).substring(1),l),i.he(a),u=v.writePivotCacheRecords(e[o].pivotCacheRecords),this.Zm.file((T.XFileConstants.Mc+"/"+T.XFileConstants.ad+n+"."+T.XFileConstants.gc).substring(1),u),r++,n++)},I.prototype.En=function(e,t,r,n,o){var i=l.writeWorksheet(this.Vm,e.name,this.Wm,t,this.Hj,r,n,o);this.Zm.file(T.XFileConstants.fd.substring(1)+"/sheet"+e.sheetId+"."+T.XFileConstants.gc,i)},I.prototype.wn=function(e,t,r,n,o){var i,a,s,l,u,c=e.Di(t);c&&0<c.length&&(this._m++,i=T.XFileConstants.Pc+this._m+"."+T.XFileConstants.gc,(a=new T.XFile(T.XFileConstants.yb+"/"+i,T.RelationshipConstants.bb)).target="../"+i,r.he(a),this.$m++,s=T.XFileConstants.Cc+this.$m+"."+T.XFileConstants.hc,(l=new T.XFile(T.XFileConstants.Ec+"/"+s,T.RelationshipConstants.cb)).target="../drawings/"+s,u=r.he(l),n.legacyDrawingId=u,n.attributes.push({key:"xmlns:xdr",value:T.XFileConstants.sd}),this.Gn(e,o,c,a.fileName,l.fileName))},I.prototype.Gn=function(e,t,r,n,o){var i=this.Zm,a=f.writeComments(e,r);i.file(n.substring(1),a),a=f.writeCommentShapes(e,t,r),i.file(o.substring(1),a)},I.prototype.Dn=function(e,t,r){var n,o,i,a,s,l,u=e.Ei(r);if(u&&0<u.length)for(o in this.Hn||(this.Hn=1),n=this.Hn,u)u.hasOwnProperty(o)&&(i=T.XFileConstants.bd+n+"."+T.XFileConstants.gc,(a=new T.XFile(T.XFileConstants.Nc+"/"+i,T.RelationshipConstants.$a)).target="../pivotTables/"+i,t.he(a),(s=this.Fn&&this.Fn[u[o].cacheId]&&this.Fn[u[o].cacheId].file)&&a.he(s),l=v.writePivotTable(e,u[o]),this.Zm.file((T.XFileConstants.Nc+"/"+i).substring(1),l),this.Hn++)},I.prototype.yn=function(e,v,t,r,S){if(r){var x=this;r.forEach(function(e){var t,r,n,o,i,a,s,l,u,c,h,f,d,p,g,m=A.Util.Da(e),b=m&&m.layoutId,y=A.Util.Ea(b),C=y?T.RelationshipConstants.mb:T.RelationshipConstants.lb,w=y?T.XFileConstants.Rc:T.XFileConstants.Qc;x.fn++,t=w+x.fn+"."+T.XFileConstants.gc,r=T.XFileConstants.Sc+x.fn+"."+T.XFileConstants.gc,n=T.XFileConstants.Uc+x.fn+"."+T.XFileConstants.gc,o=new T.XFile(T.XFileConstants.Dc+"/"+t,C),i=new T.XFile(T.XFileConstants.Dc+"/"+r,T.RelationshipConstants.pb),a=new T.XFile(T.XFileConstants.Dc+"/"+n,T.RelationshipConstants.ob),o.target="../charts/"+t,e.chartId=v.he(o),s=e.graphicFrame.nvGraphicFramePr.cNvPr,e.AlternateContent=(d=s.name,p=e.chartId,g=s.descr,{AlternateContent:"http://schemas.openxmlformats.org/markup-compatibility/2006",Choice:{cx:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",Requires:"cx1",GraphicalObjectFrame:{nvGraphicFramePr:{cNvPr:{id:1,name:d,descr:g||""}},graphic:{graphicData:{chart:{id:p}}}}}}),(l=e.chartSpace)&&(x.In(l,e,o),x.Jn(l,o),(u=new k.XmlWriter).writeDocument(),y?(c=x.Vm&&x.Vm.we&&x.Vm.we.names?x.Vm.we.names:[],M.DrawingWriter.chart2016Write.WriteCT_ChartSpace(u,"cx","chartSpace",l,c,S)):M.DrawingWriter.WriteCT_ChartSpace(u,"c","chartSpace",l),x.Zm.file(o.fileName.substring(1),u.getXmlString()),y&&(i.target="../charts/"+r,A.isNullOrUndefined(e.chartSpace.style)&&(e.chartSpace.style=JSON.parse('{"attribute":{"cs":"http://schemas.microsoft.com/office/drawing/2012/chartStyle","a":"http://schemas.openxmlformats.org/drawingml/2006/main","id":"381"},"axisTitle":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1,"lumMod":[65000],"lumOff":[35000]}}},"idx":1},"defRPr":{"sz":12}},"categoryAxis":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1,"lumMod":[65000],"lumOff":[35000]}}},"idx":1},"spPr":{"ln":{"w":1,"cap":2,"cmpd":0,"algn":0,"solidFill":{"schemeClr":{"val":1,"lumMod":[15000],"lumOff":[85000]}},"round":true}},"defRPr":{"sz":12}},"chartArea":{"attribute":{"mods":"allowNoFillOverride allowNoLineOverride"},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"solidFill":{"schemeClr":{"val":0}},"ln":{"w":1,"cap":2,"cmpd":0,"algn":0,"solidFill":{"schemeClr":{"val":1,"lumMod":[15000],"lumOff":[85000]}},"round":true}},"defRPr":{"sz":13.33}},"dataLabel":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":14}}},"idx":1},"defRPr":{"sz":12}},"dataLabelCallout":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":13,"lumMod":[65000],"lumOff":[35000]}}},"idx":1},"spPr":{"solidFill":{"schemeClr":{"val":14}},"ln":{"solidFill":{"schemeClr":{"val":13,"lumMod":[25000],"lumOff":[75000]}}}},"defRPr":{"sz":12},"bodyPr":{"rot":0,"spcFirstLastPara":true,"vertOverflow":2,"horzOverflow":1,"vert":0,"wrap":1,"lIns":36576,"tIns":18288,"rIns":36576,"bIns":18288,"anchor":1,"anchorCtr":true,"spAutoFit":true}},"dataPoint":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{"styleClr":{"val":0}},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"solidFill":{"schemeClr":{"val":12}},"ln":{"w":2,"solidFill":{"schemeClr":{"val":14}}}}},"dataPoint3D":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{"styleClr":{"val":0}},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"solidFill":{"schemeClr":{"val":12}}}},"dataPointLine":{"attribute":{},"lnRef":{"ColorProp":{"styleClr":{"val":0}},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"ln":{"w":3,"cap":0,"solidFill":{"schemeClr":{"val":12}},"round":true}}},"dataPointMarker":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{"styleClr":{"val":0}},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"solidFill":{"schemeClr":{"val":12}},"ln":{"w":1,"solidFill":{"schemeClr":{"val":14}}}}},"dataPointMarkerLayout":{"attribute":{"symbol":"circle","size":"5"}},"dataPointWireframe":{"attribute":{},"lnRef":{"ColorProp":{"styleClr":{"val":0}},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"ln":{"w":3,"cap":0,"solidFill":{"schemeClr":{"val":12}},"round":true}}},"dataTable":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1,"lumMod":[65000],"lumOff":[35000]}}},"idx":1},"spPr":{"ln":{"w":1,"solidFill":{"schemeClr":{"val":1,"lumMod":[15000],"lumOff":[85000]}}}},"defRPr":{"sz":12}},"downBar":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":13}}},"idx":1},"spPr":{"solidFill":{"schemeClr":{"val":13,"lumMod":[65000],"lumOff":[35000]}},"ln":{"w":1,"solidFill":{"schemeClr":{"val":1,"lumMod":[65000],"lumOff":[35000]}}}}},"dropLine":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"ln":{"w":1,"cap":2,"cmpd":0,"algn":0,"solidFill":{"schemeClr":{"val":1,"lumMod":[35000],"lumOff":[65000]}},"round":true}}},"errorBar":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"ln":{"w":1,"cap":2,"cmpd":0,"algn":0,"solidFill":{"schemeClr":{"val":1,"lumMod":[65000],"lumOff":[35000]}},"round":true}}},"floor":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1}},"gridlineMajor":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"ln":{"w":1,"cap":2,"cmpd":0,"algn":0,"solidFill":{"schemeClr":{"val":1,"lumMod":[15000],"lumOff":[85000]}},"round":true}}},"gridlineMinor":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"ln":{"w":1,"cap":2,"cmpd":0,"algn":0,"solidFill":{"schemeClr":{"val":1,"lumMod":[15000],"lumOff":[85000]}},"round":true}}},"hiLoLine":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"ln":{"w":1,"cap":2,"cmpd":0,"algn":0,"solidFill":{"schemeClr":{"val":1,"lumMod":[75000],"lumOff":[25000]}},"round":true}}},"leaderLine":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"ln":{"w":1,"cap":2,"cmpd":0,"algn":0,"solidFill":{"schemeClr":{"val":1,"lumMod":[35000],"lumOff":[65000]}},"round":true}}},"legend":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1,"lumMod":[65000],"lumOff":[35000]}}},"idx":1},"defRPr":{"sz":12}},"plotArea":{"attribute":{"mods":"allowNoFillOverride allowNoLineOverride"},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1}},"plotArea3D":{"attribute":{"mods":"allowNoFillOverride allowNoLineOverride"},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1}},"seriesAxis":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1,"lumMod":[65000],"lumOff":[35000]}}},"idx":1},"spPr":{"ln":{"w":1,"cap":2,"cmpd":0,"algn":0,"solidFill":{"schemeClr":{"val":1,"lumMod":[15000],"lumOff":[85000]}},"round":true}},"defRPr":{"sz":12}},"seriesLine":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"ln":{"w":1,"cap":2,"solidFill":{"srgbClr":{"val":[217,217,217]}},"round":true}}},"title":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1,"lumMod":[65000],"lumOff":[35000]}}},"idx":1},"defRPr":{"sz":18.67}},"trendline":{"attribute":{},"lnRef":{"ColorProp":{"styleClr":{"val":0}},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1},"spPr":{"ln":{"w":2,"cap":0,"solidFill":{"schemeClr":{"val":12}},"prstDash":7}}},"trendlineLabel":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1,"lumMod":[65000],"lumOff":[35000]}}},"idx":1},"defRPr":{"sz":12}},"upBar":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":13}}},"idx":1},"spPr":{"solidFill":{"schemeClr":{"val":14}},"ln":{"w":1,"solidFill":{"schemeClr":{"val":1,"lumMod":[15000],"lumOff":[85000]}}}}},"valueAxis":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1,"lumMod":[65000],"lumOff":[35000]}}},"idx":1},"defRPr":{"sz":12}},"wall":{"attribute":{},"lnRef":{"ColorProp":{},"idx":0},"fillRef":{"ColorProp":{},"idx":0},"effectRef":{"ColorProp":{},"idx":0},"fontRef":{"TextCharacterProperties":{"solidFill":{"schemeClr":{"val":1}}},"idx":1}}}')),e.chartSpace.style.id=o.he(i),a.target="../charts/"+n,A.isNullOrUndefined(e.chartSpace.colors)&&(e.chartSpace.colors=JSON.parse('{"schemeClr":[{"val":4},{"val":5},{"val":6},{"val":7},{"val":8},{"val":9}],"variation":[{},{"lumMod":60000},{"lumMod":80000,"lumOff":20000},{"lumMod":80000},{"lumMod":60000,"lumOff":40000},{"lumMod":50000},{"lumMod":70000,"lumOff":30000},{"lumMod":70000},{"lumMod":50000,"lumOff":50000}],"attribute":{"cs":"http://schemas.microsoft.com/office/drawing/2012/chartStyle","a":"http://schemas.openxmlformats.org/drawingml/2006/main","meth":"cycle","id":"10"}}')),e.chartSpace.colors.id=o.he(a),h=new k.XmlWriter,M.DrawingWriter.chart2016Write.WriteCT_ChartStyle(h,"cs","chartStyle",null,l.style),x.Zm.file(i.fileName.substring(1),h.getXmlString()),f=new k.XmlWriter,M.DrawingWriter.chart2016Write.WriteCT_ChartColors(f,"cs","colorStyle",null,l.colors),x.Zm.file(a.fileName.substring(1),f.getXmlString())))})}},I.prototype.In=function(e,t,r){var n,o,i,a=this,s=e.userShapes,l=s&&s.relSizeAnchor;l&&0<l.length&&(a.an++,n=T.XFileConstants.Vc+a.an+"."+T.XFileConstants.gc,(o=new T.XFile(T.XFileConstants.Ec+"/"+n,T.RelationshipConstants.nb)).target="../drawings/"+n,t.drawingFile=o,i=r.he(o),e.userShapes.id=i,l.forEach(function(e){"1"===e.typeName?a.Kn(e,o):"2"===e.typeName&&a.Ln(e,o)}))},I.prototype.Kn=function(e,t){var r,n,o=e.src;o&&(this.bn++,r={},C.getPictureInfo(o,r),n=x(r,this.bn,t),this.Zm.file(n.fileName.substring(1),r.base64Image,{base64:!0}),e.pic.blipFill={blip:{embed:r.rid}})},I.prototype.Ln=function(e,t){var r,n,o,i,a,s,l,u,c;this.fn++,r=T.XFileConstants.Qc+this.fn+"."+T.XFileConstants.gc,(n=new T.XFile(T.XFileConstants.Dc+"/"+r,T.RelationshipConstants.lb)).target="../charts/"+r,o=t.he(n),i=e.chartSpace,s=(a=A.Util.Da(i))&&a.layoutId,l=A.Util.Ea(s),i&&(e.graphicFrame.graphic={graphicData:{chart:{id:o,typeName:"chartSpace"}}},(u=new k.XmlWriter).writeDocument(),l?(c=this.Vm&&this.Vm.we&&this.Vm.we.names?this.Vm.we.names:[],M.DrawingWriter.chart2016Write.WriteCT_ChartSpace(u,"cx","chartSpace",i,c)):M.DrawingWriter.WriteCT_ChartSpace(u,"c","chartSpace",i),this.Zm.file(n.fileName.substring(1),u.getXmlString()))},I.prototype.Jn=function(e,t){var r=this,n=e.chart.plotArea;n&&n.chartGroups&&n.chartGroups.forEach(function(e){e&&e.ser&&e.ser.forEach(function(e){e.spPr&&r.Mn(t,e.spPr),e.dLbls&&e.dLbls.spPr&&r.Mn(t,e.dLbls.spPr)})}),n.spPr&&r.Mn(t,n.spPr),e.spPr&&r.Mn(t,e.spPr)},I.prototype.Nn=function(e,t){var r=this;e&&e.forEach(function(e){(e.sp||e.cxnSp||e.grpSp)&&(e.sp&&e.sp.spPr?r.Mn(t,e.sp.spPr):e.grpSp&&(e.grpSp.sp&&e.grpSp.sp.forEach(function(e){e.spPr&&r.Mn(t,e.spPr)}),e.grpSp.grpSpPr&&r.Mn(t,e.grpSp.grpSpPr)))})},I.prototype.Mn=function(e,t){var r,n,o=t&&t.blipFill&&t.blipFill.blip&&t.blipFill.blip.blipBlob&&t.blipFill.blip.blipBlob.blob;o&&(this.bn++,r={},C.getPictureInfo(o,r),n=x(r,this.bn,e),this.Zm.file(n.fileName.substring(1),r.base64Image,{base64:!0}),t.blipFill.blip.embed=r.rid)},I.prototype.xn=function(e,t,r){var n,o,i;if(r)return this.an++,n=T.XFileConstants.Vc+this.an+"."+T.XFileConstants.gc,(o=new T.XFile(T.XFileConstants.Ec+"/"+n,T.RelationshipConstants.eb)).target="../drawings/"+n,i=e.he(o),t.drawingId=i,o},I.prototype.zn=function(e,r,t){var n,o=this,i=o.Zm,a=t.pictures;a&&0<a.length&&a.forEach(function(e){o.bn++;var t=x(e,o.bn,r);i.file(t.fileName.substring(1),e.base64Image,{base64:!0})}),t.withDrawingObjects&&(o.Nn(t.shapes,r),n=d.writeDrawing(e,t),i.file(r.fileName.substring(1),n),o.On(t.charts))},I.prototype.On=function(e){if(e&&0<e.length){var i=this.Zm;e.forEach(function(e){var t,r=e.chartSpace,n=r&&r.userShapes,o=n&&n.relSizeAnchor;o&&0<o.length&&((t=new k.XmlWriter).writeDocument(!1),M.DrawingWriter.WriteCT_ChartDrawing(t,"","userShapes",n),i.file(e.drawingFile.fileName.substring(1),t.getXmlString()))})}},I.prototype.An=function(o,i,a){var s=this,e=o.vh(a);e&&0<e.length&&e.forEach(function(e){var t,r=T.XFileConstants.Yc+e.id+"."+T.XFileConstants.gc,n=new T.XFile(T.XFileConstants.Jc+"/"+r,T.RelationshipConstants.ab);n.target="../tables/"+r,t=i.he(n),e.rid=t,s.Pn(e,n.fileName,o,a)})},I.prototype.Pn=function(e,t,r,n){var o=this.Zm,i=p.writeTable(e,r,n);o.file(t.substring(1),i)},I.prototype.Bn=function(e,t,r,n){var o=e.Ki(r);o&&0<o.length&&(this.Qn(e,t,r,o),this.Rn(e,t,r,o,n))},I.prototype.Qn=function(e,t,r,n){var o,i,a,s,l;this.cn++,o=T.XFileConstants.Zc+this.cn+"."+T.XFileConstants.gc,(i=new T.XFile(T.XFileConstants.Kc+"/"+o,T.RelationshipConstants.jb)).target="../slicers/"+o,a=t.he(i),n[0].rid=a,s=this.Zm,l=g.writeSlicer(n),s.file(i.fileName.substring(1),l)},I.prototype.Rn=function(e,t,r,n,a){var s=this,l={},u=e.vh();n.forEach(function(e){var t,r,n,o,i;0!==Object.keys(l).length&&l[e.nameInFormula]||(s.dn++,t=T.XFileConstants.$c+s.dn+"."+T.XFileConstants.gc,(r=new T.XFile(T.XFileConstants.Lc+"/"+t,T.RelationshipConstants.kb)).target="slicerCaches/"+t,n=a.he(r),l[e.nameInFormula]=n,e.cacheRid=n,o=s.Zm,i=m.writeSlicerCache(e,u),o.file(r.fileName.substring(1),i))})},I.prototype.Cn=function(e,t,r,n){var o,i,a,s,l=e.Ui(r);l&&0<l.length&&(this.$m++,o=T.XFileConstants.Cc+this.$m+"."+T.XFileConstants.hc,(i=new T.XFile(T.XFileConstants.Ec+"/"+o,T.RelationshipConstants.cb)).target="../drawings/"+o,this.Sn(l,i),a=t.he(i),e.hm=a,s=b.writeVmlDrawingFile(l),this.Zm.file(i.fileName.substring(1),s))},I.prototype.Sn=function(e,r){var n=this;e.forEach(function(e){n.bn++;var t=x(e,n.bn,r);n.Zm.file(t.fileName.substring(1),e.base64Image,{base64:!0}),r.relationFiles[e.rid]=t})},I.prototype.pn=function(e){var t,r,n,o=this.Vm.Yg;o&&(t=T.XFileConstants.od,(r=new T.XFile(T.XFileConstants.yb+"/"+t,T.RelationshipConstants.qb)).target=t,e.he(r),n=y.getMetadataContent(o),this.Zm.file(r.fileName.substring(1),n))},I.prototype.rm=function(){w.clearCache(),this.Vm=void 0},t.XlsxWriter=I},"./src/xml-io/node-helper.ts":function(e,t,r){"use strict";var n,o;function i(){}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/datamodel/excel-style.ts"),o=n.UnitHelper.emuToPixles,i.Xl=function(e,t){return"1"===e||"0"!==e&&t},i.Yl=function(e,t){if(e){var r=parseFloat(e);if(!isNaN(r))return r}return t},i.Zl=function(e,t){if(e){var r=parseInt(e,10);if(!isNaN(r))return r}return t},i.qe=function(e){return Array.isArray(e)||(e=e?[e]:[]),e},i.$l=function(e,t,r){return r=r||t,e[t]&&e[t][r]},i.cm=function(e,t){e&&(t.x=o(parseInt(e.pe.x,10)),t.y=o(parseInt(e.pe.y,10)))},i.dm=function(e,t){e&&(t.width=o(parseInt(e.pe.cx,10)),t.height=o(parseInt(e.pe.cy,10)))},i.em=function(e){if(e)return{col:parseInt(i.$l(e,"xdr:col"),10),colOffset:o(parseInt(i.$l(e,"xdr:colOff"),10)),row:parseInt(i.$l(e,"xdr:row"),10),rowOffset:o(parseInt(i.$l(e,"xdr:rowOff"),10))}},t.XmlNodeHelper=i},"./src/xml-io/xml-parser.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/xml-io/xml-reader.ts");function a(e,t){for(var r,n,o,i=e.depth;e.read()&&!(e.depth<=i);)if(1===e.nodeType()){for(r={},t[n=e.name()]?(Array.isArray(t[n])||(t[n]=[t[n]]),t[n].push(r)):t[n]=r,r.pe={};e.moveToNextAttribute();)r.pe[e.readAttributeNameAsString()]=e.readContentAsString();if(3===e.elementType)continue;o=e.readElementContentAsString(),1==(1&e.elementType)&&""!==o&&e.Tn>e.mm&&("preserve"===r.pe["xml:space"]&&(o=e.readElementContentAsString(!0)),r[n]=o),a(e,r)}}t.parseXmlToObject=function(e,t){var r,n,o;if(e){for(n={},(r=new i.XmlReader).reset(),r.setXml(e),r.keepRootNamespace=t;r.read();)if(2!==r.elementType){for(o={pe:{}},n[r.name()]=o;r.moveToNextAttribute();)o.pe[r.readAttributeNameAsString()]=r.readContentAsString();3!==r.elementType&&a(r,o)}return n}},t.convertObjectToXml=function e(t,r){var n,o,i="<"+r,a=t.pe;if(a)for(n in a)a.hasOwnProperty(n)&&(i+=" "+n+'="'+a[n]+'"');for(o in i+=">",t)t.hasOwnProperty(o)&&a!==t[o]&&(i+="object"==typeof t[o]?e(t[o],o):t[o]);return i+"</"+r+">"}},"./src/xml-io/xml-reader.ts":function(e,t,r){"use strict";var n,i,f;function o(){this.Un=-1,this.Vn=0,this.Wn=0,this.Xn=0,this.buffer="",this.elementType=2,this.depth=0,this.mm=0,this.al=0,this.Yn=0,this.Zn=0,this.$n=0,this._n=0,this.Tn=0,this.ao=0,this.xmlIndex=0,this.xml="",this.bo=!1,this.reset()}Object.defineProperty(t,"__esModule",{value:!0}),n=r("./src/common/common.ts"),i=n.Util.sa,f="<![CDATA[",o.prototype.reset=function(){var e=this;e.Un=-1,e.Vn=0,e.Wn=0,e.Xn=0,e.buffer="",e.elementType=2,e.depth=0,e.mm=0,e.al=0,e.Yn=0,e.Zn=0,e.$n=0,e._n=0,e.Tn=0,e.ao=0,e.xmlIndex=0,e.xml="",e.bo=!1,e.co=0,e.do=""},o.prototype.setXml=function(e){this.xml=e},o.prototype.name=function(){var e,t=this.buffer.slice(this.mm,this.mm+this.al);return t&&!this.keepRootNamespace?((e=t.lastIndexOf(":")+1)===this.co&&t.substr(0,e)===this.do||(e=0),t.substr(e)):t},o.prototype.nodeType=function(){return 2===this.elementType?15:1},o.prototype.fillBuffer=function(){return 0===this.buffer.length&&(this.buffer=this.xml,this.Un=0,this.Tn=0,this.Wn=this.buffer.length,!0)},o.prototype.read=function(){var e,t,r,n,o,i,a,s,l,u,c,h=this;for(h.Vn=Number.MAX_VALUE,h.bo=!1;;){if(h.Un++,h.Un>=h.Wn&&!h.fillBuffer())return!1;if("<"===(e=h.buffer[h.Un]))break}for(r=(t=["elementStarting","elementStart","elementNameEnd","elementEnd","elementContent","elementContentStart","endElementStart"]).length,n=0,o=!1;n<r;)switch(t[n]){case"elementStarting":for(o=!1;;){if(h.Un++,"/"===(e=h.buffer[h.Un])){n=6,o=!0;break}if("?"===e){for(h.elementType=3;;)if(h.Un++,">"===(e=h.buffer[h.Un]))return!0}else if(" "!==e&&"\r"!==e&&"\n"!==e&&"\t"!==e){h.mm=h.Un;break}}if(o)continue;case"elementStart":for(o=!1,1===h.elementType&&h.depth++;;){if(h.Un++,">"===(e=h.buffer[h.Un])){h.al=h.Un-h.mm,n=3,o=!0;break}if(" "===e||"\r"===e||"\n"===e||"\t"===e||"/"===e){h.al=h.Un-h.mm,h.Vn=h.Un;break}}if(0===h.depth&&!h.keepRootNamespace&&h.al&&(a=(i=h.buffer.substr(h.mm,h.al)).lastIndexOf(":")+1)&&(h.do=i.substr(0,a),h.co=a),o)continue;case"elementNameEnd":for(s=!1;h.Un++,'"'===(e=h.buffer[h.Un])&&(s=!s),s||">"!==e;);for(l=h.Un;;){if(l--,"/"===(e=h.buffer[l]))return h.Xn=l,h.elementType=3,!0;if(" "!==e&&"\r"!==e&&"\n"!==e&&"\t"!==e){h.Xn=l,h.elementType=1,n=4;break}}continue;case"elementEnd":for(l=h.Un;;){if(l--,"/"===(e=h.buffer[l]))return h.elementType=3,!0;if(" "!==e&&"\r"!==e&&"\n"!==e&&"\t"!==e){h.elementType=1;break}}case"elementContent":for(u=!1;;){if(h.Un++,e=h.buffer[h.Un],h.buffer.substr(h.Un,9)===f)return c=h.buffer.indexOf("]]>",h.Un),h.Tn=h.Un,h.ao=c+"]]>".length,h.Un=h.ao-1,h.bo=!0;if("<"===e)return h.Un--,u&&(h.ao=h.Un+1),!0;if(h.Tn=h.Un,u=!0,"\r"!==e&&"\n"!==e&&"\t"!==e)break}case"elementContentStart":for(;;)if(h.Un++,"<"===(e=h.buffer[h.Un]))return h.ao=h.Un,h.Un--,!0;case"endElementStart":for(2!==h.elementType&&3!==h.elementType||h.depth--,h.elementType=2,h.mm=h.Un+1;;)if(h.Un++,">"===(e=h.buffer[h.Un]))return h.al=h.Un-h.mm,!0}},o.prototype.fastRead=function(){var e,t,r,n,o,i,a,s,l,u=this;for(u.Vn=Number.MAX_VALUE,u.bo=!1;;){if(u.Un++,u.Un>=u.Wn&&!u.fillBuffer())return!1;if("<"===(e=u.buffer[u.Un]))break}for(r=0,n=!(t=["elementStarting","elementStart","elementNameEnd","elementEnd","elementContent","elementContentStart","endElementStart"]);r<t.length;)switch(t[r]){case"elementStarting":for(n=!1;;){if(u.Un++,"/"===(e=u.buffer[u.Un])){r=6,n=!0;break}if(" "!==e&&"\r"!==e&&"\n"!==e&&"\t"!==e){u.mm=u.Un;break}}if(n)continue;case"elementStart":for(n=!1,1===u.elementType&&u.depth++;;){if(u.Un++,">"===(e=u.buffer[u.Un])){u.al=u.Un-u.mm,r=3,n=!0;break}if(" "===e||"\r"===e||"\n"===e||"\t"===e){u.al=u.Un-u.mm,u.Vn=u.Un;break}}if(0===u.depth&&!u.keepRootNamespace&&u.al&&(i=(o=u.buffer.substr(u.mm,u.al)).lastIndexOf(":")+1)&&(u.do=o.substr(0,i),u.co=i),n)continue;case"elementNameEnd":for(a=!1;u.Un++,'"'===(e=u.buffer[u.Un])&&(a=!a),a||">"!==e;);for(s=u.Un;;){if(s--,"/"===(e=u.buffer[s]))return u.Xn=s,u.elementType=3,!0;if(" "!==e&&"\r"!==e&&"\n"!==e&&"\t"!==e){u.Xn=s,u.elementType=1,r=4;break}}continue;case"elementEnd":for(s=u.Un;;){if(s--,"/"===(e=u.buffer[s]))return u.elementType=3,!0;if(" "!==e&&"\r"!==e&&"\n"!==e&&"\t"!==e){u.elementType=1;break}}case"elementContent":for(;;){if(u.Un++,e=u.buffer[u.Un],u.buffer.substr(u.Un,9)===f)return l=u.buffer.indexOf("]]>",u.Un),u.Tn=u.Un,u.ao=l+"]]>".length,u.Un=u.ao-1,u.bo=!0;if("<"===e)return u.Un--,!0;if("\r"!==e&&"\n"!==e&&"\t"!==e){u.Tn=u.Un;break}}case"elementContentStart":for(;;)if(u.Un++,"<"===(e=u.buffer[u.Un]))return u.ao=u.Un,u.Un--,!0;case"endElementStart":for(2!==u.elementType&&3!==u.elementType||u.depth--,u.elementType=2;;)if(u.Un++,">"===(e=u.buffer[u.Un]))return!0}},o.prototype.moveToNextAttribute=function(){for(var e,t,r=this;;){if(r.Vn>=r.Xn-1)return!1;if(r.Vn++," "!==(e=r.buffer[r.Vn])&&"\r"!==e&&"\n"!==e&&"\t"!==e){r.Yn=r.Vn;break}}for(;;)if(r.Vn++,"="===(e=r.buffer[r.Vn])||" "===e||"\r"===e||"\n"===e||"\t"===e){r.Zn=r.Vn-r.Yn;break}for(t='"';;)if(r.Vn++,'"'===(e=r.buffer[r.Vn])||"'"===e){t=e,r.$n=r.Vn+1;break}for(;;)if(r.Vn++,(e=r.buffer[r.Vn])===t)return r._n=r.Vn,!0},o.prototype.readContentAsString=function(){return this.buffer.slice(this.$n,this._n)},o.prototype.readContentAsBoolean=function(e){var t=this.buffer[this.$n];return"1"===t||"t"===t||"0"!==t&&"f"!==t&&e},o.prototype.readContentAsInt=function(e){var t=parseInt(this.buffer.slice(this.$n,this._n),10);return isNaN(t)?e:t},o.prototype.readContentAsDouble=function(e){var t=parseFloat(this.buffer.slice(this.$n,this._n));return isNaN(t)?e:t},o.prototype.readContentAsError=function(){var e=this.readContentAsString(),t=null;switch(e){case"#DIV/0!":t=7;break;case"#N/A":t=42;break;case"#NAME?":t=29;break;case"#NULL!":t=0;break;case"#NUM!":t=36;break;case"#REF!":t=23;break;case"#VALUE!":t=15;break;case"#SPILL!":t=99}return null!==t?{_error:e,_code:t}:null},o.prototype.readElementContentAsString=function(e){var t,r,n,o=this.Tn;if(this.Tn<=this.mm)return"";if(e)for(r=(t=this.buffer)[o-1];" "===r||"\r"===r||"\n"===r||"\t"===r;)r=t[--o-1];return n=this.buffer.slice(o,this.ao),this.bo&&(n=i(n.replace(f,"").replace("]]>","")),this.bo=!1),n},o.prototype.readElementContentAsInt=function(e){var t=parseInt(this.buffer.slice(this.Tn,this.ao),10);return isNaN(t)?e:t},o.prototype.readElementContentAsDouble=function(e){var t=parseFloat(this.buffer.slice(this.Tn,this.ao));return isNaN(t)?e:t},o.prototype.readElementContentAsBoolean=function(e){var t=this.buffer[this.Tn];return"1"===t||"t"===t||"0"!==t&&"f"!==t&&e},o.prototype.readAttributeNameAsString=function(){return this.buffer.slice(this.Yn,this.Yn+this.Zn)},o.prototype.readFullElement=function(){var e,t,r=this;if(2===r.elementType)return"";if(e=r.mm-1,3===r.elementType)return r.buffer.slice(e,r.Xn+2);if(t=r.depth,1!==r.elementType)return"";for(;r.read()&&!(r.depth<=t););return r.buffer.slice(e,r.mm+r.al+1)},t.XmlReader=o},"./src/xml-io/xml-writer.ts":function(e,t,r){"use strict";function n(e){this.size=e||500,this.blockIndex=-1,this.stringIndex=0,this.blocks=[],this.createNewArray()}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype.createNewArray=function(){var e=Array(this.size);this.blocks.push(e),this.blockIndex++,this.stringIndex=0},n.prototype.addString=function(e){this.isFullArray()&&this.createNewArray(),this.blocks[this.blockIndex][this.stringIndex]=e,this.stringIndex++},n.prototype.getAllString=function(){var e,t;for(e=0;e<this.blocks.length;e++)this.blocks[e]=this.blocks[e].join("");return t=this.blocks.join(""),this.blocks=null,t},n.prototype.isFullArray=function(){return this.stringIndex>this.size-2};var o=(i.prototype.writeDocument=function(e){this.xml.addString('<?xml version="1.0" encoding="UTF-8" '+(e?"":'standalone="yes"')+"?>\r\n")},i.prototype.writeElement=function(e,t,r){void 0===r&&(r=t,t=void 0),this.xml.addString("<"+e),"function"==typeof t&&t(),this.xml.addString(">"),"function"==typeof r&&r(),this.xml.addString("</"+e+">")},i.prototype.writeValue=function(e){this.xml.addString(e)},i.prototype.writeLeafElement=function(e,t){this.xml.addString("<"+e),"function"==typeof t&&t(),this.xml.addString("/>")},i.prototype.writeAttributeString=function(e,t){this.xml.addString(" "+e),"style"===e?this.xml.addString("='"+t+"'"):this.xml.addString('="'+t+'"')},i.prototype.writeElementString=function(e,t){this.xml.addString("<"+e+">"+t+"</"+e+">")},i.prototype.getXmlString=function(){return this.xml.getAllString()},i);function i(){this.xml=new n}t.XmlWriter=o}},o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){var r,n;if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.j)return t;if(r=Object.create(null),o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(e){var t=e&&e.j?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/assets/",o(o.s="./src/excel-io.ts");function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}var r,n},t.exports=e()}).call(this,r(106),r(215).Buffer,r(429).setImmediate)},7:function(e,t,r){var n,o;window.GC?e.exports=window.GC:((n=r(1798)).Spread.Sheets.LicenseKey=(o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAB3RJTUUH5AkSBgUFv5FyKQAAEvBJREFUaN7tWnl4nlWVP+fed/32L1/2rWlKl9BSCkilbC2biKMFkU1nRAccGZwqoKODMDMs44rr8KDD4+AoqCjoIFQUSimlUGQpLXSxadM0aZZmT779+97t3jN/vF/SlCZtuow8Po/3Sf7Im/e99/zOfs85SETwl7zYu03AXwG82wQc71JO8H4kCQh8u0L0fwkIAMYfMkQEwBN1IJ4QIyYSQISMz5Cy0vvIAY8XyXECIJIC2QEx2tne4sjOYrLdznR5xTESFkmBis6VoBau1aNNZqLFLJvP1UDpeykQEfDYNfnYAZD0JkjP9r+R6ng207uxOLrLs5IgPUAGyBAQEIEkEQFJAGCqqYXrg9Wnx5oujjW9Tw1UHCeMYwFAJBEAkBHJ0V2/Htz6UG5gE3k2U0xUdAAk4ZJ0iYRPNAAiMmQKchWRk/SEVwTpqaHaxLwPVy35tFk27x0c+X8EMHHMaNsT+1//dn7wLcZ1roVJOMLNAUmuR7VQrRauU4NVXA0h49KzPCvp5Pqc7H63MCiFw7jBtRBJIewU1yOJlmvrz7pdC9WWAB+NKI4KQEnj7Wxv57rbku1Pc8XkWthzMtKzjNjsaOOFseZLw3XLVLN8ui3yw9vSXS+kOtbk+jdJN8+NOCJziyNqoKrh3LuqFt8AvkYxfqIBEAEQIBtrX9259nNuYUgNVAonK91CqHZp9emryhdcDQBS2Nm+13N9rxXH2tz8oHDzJD2umlyL6tFZwcpTw3VnG7FmALDSnf2bHxht/ZVXHFMC5SRcz0qWt1zbfOl/cTU4c3WaGQAi39/1vvbN3lfu4WoIFcMtDJmJloZz7krMu8LXqOEdP88NbvYKIyQ9RAbIEdm4EUuSAoCYGjRizbHmS6tP/Qc92uQWR3s23jW842eInOsRJzcQqFw0//LHjVjzDDHMBID/Au5b/6X+Td9Tg9UkXeFkq5bcNPui7wLA4NaH+rc8UBzdhagw1WRMmwhffghDAPDdEQBJIYUl3QLXwvE5H6g/59/M+NxM7ysda262ku1qsMorjiqBiparVgfKF84EwwwAkARkXS/d2ffafVqoVrg5ZGrz+36QmP+R3MDmjrWr8gNbuBpkqgkERHIc8GHOZIiMpCfsDFONqtNunnX+V4lk21PXje1ZrQWrPDujmPGF16414nOOaA9HAODzoH/LA/vWfV4L1ggny43YgiufDFYu3v/Gd3pf+Q8A4lqYSI57zKNYyBSSwrNGQzVL513+Kz1c37nu1oEtD2rBKs9O6dHZiz72omLEfA4eCwCf+nT3i7t+s5LrYenZTA0uvO45s2x++7OfHt72E8UsR2RE4mhJPxiGKuwUN2Lzr3g8XLusc91tA1t+qIVq3fxArPmyBVc+AUCHyVCm97hEyBTPznQ8twq56uOcf8VjZtn8PU9fP7ztJ2qwGvys5vgWSZfrUekUWn+zMrv/1dkXfS+x4Go3P6AGq5Ptv+vb9H0AJOkdNQAiCQA9L/+7ldzDtbCwkrMuuC9ce1bn87eO7Pylb8pHVveZYvCYagDJXU9eZaX2zvvQzwOViz0rqQQq9r/2jeJYGzKFplHRqQEQCWQ81//m0I6H1UClWxgqm/+RqsU3DG778cBbP1SDVSTdE0L6JAyCKaa0s7ufvBoA5lz2EDKOyIST7XnlHpheh6YGgIAAsP/1+0i4JD3FLG++5H4729u94U5FjxNJRIbIS7aFDH2XDwCAiPzY8mSSHtejheE/daxdFaw4pfr0z7iFEcVMJPf8LtO7EaYxtikAEElAlhvYnNq3VjHinjVWc8YqxSjrfP4W4WSQqyCFcHKenSbPAmTkWZ6dFk6uxEkn4zlpEs4x3FpIuqqZGNr+cLbv9YZz79WjTeRZRHJgyw9LjJ2RBIgAYHjHI+TZJF090li79Avpng2pjmcVI07CBcYSLdfULbvdLG8RdtqsWFi37PaylquJJHKlfNH1tUu/qEebSNjHdF9BAOjZeBciVp92k2dnFCOW7nqhONaGyA511ofGOULGPTud6nyO6xHPTlcuvgGR973+HQAEYFJYFQtvmH3Bt5Ap0VkXdr14e9OF3w7XLCUSe/EfFSPetOI+AIg0nLf3mU9JJwfIj8rWiYSiRTI9GzP7/1i15Ka+Td8n6Xh2aqx9dd3Sf/a193AS8I0927vRznQjU5iiV55yvZXqzPZu5FqYSABiqOZMP8IHyhdFZl0QSJwMAIg8XH9euO4cf59Q1WlqqEZK9whC8O8JyPwL0AEZkBx8+7+5GojOulDYWa6YqY41AHBoZnGIChEAQLprPRBJr2gmWsyyBSO7HhNuvhTSCVIdz7jFEQBIdvx+5E+PjnX8AQDsXN/IzkdHWn/pWkkAGOt4xknvY1yDw0R6ROkW3MKw52Slk5NufjxfkkwNZnpeJOkm5l8JJJhiFkZ2WqkOAHiHFr0TkE9lbnALUwzpFiP15wFAunMt4zqQBJJMMVJ7n2nLD6rBKjVUU7fs9sLw9t1tT3A9VjZ3pfSsfetuk8LK9W+Sno1MnVZ/kEmvWDbv8kjD8kzPBqaYJNzR3b9hahBIMq65uYF01/po4wrFTBAJYafzQ28bsWYimizUgyVABABuftBOdyHXCChSf45w88WxNqYYE0kH43qme4ObH2xYdkf14hvr3vtFkiLW9L6a0z5Td+bnQ3XLkm1PSTuLXD2M9iMy6eQCFacEq08vm3tFuO4cM7FAuPmSiiMSyXTPBq6F9VgzeTYQ5Ye2HVCSKQH42a+d3S/sFCBjihGoOKU40upZSWDK5C8Z183yhYoeAwBFi4TqlgXKF/j/ClYuVgIVgAyOmOciCicr7AxJj6TjWSkEBuNFJGRqYWg7AJhlC6RwkClWaq8vusPYgC+BAenZQJJrYS1UW0y2k3RxstgQmWJkul5Ida2TnpXu3Tiy/eHhnb/y7Iyd6x/a/rB08yVrOyjGwUExDhki53oUmQoAilmuGPHJrESuOtleADBis4EEMsXNDwIAHuwVDrYBIkDwrKSv7lwLMcVw8/2T80EiIawcIHojre1Pf9KsWFQc3elk9lvJ9kzXC0QiP/gWIifhMjUg3TxJD5BxNUgkhZMDIMZ1ZIpXHAPAwbceTHWscTLdRIJxQzHiJP1wS4hcOBkAUoNVBATIfFlhSRdwaiMGAClsACIg5BoASLcwfqli0i0Eq5Y0nHuP9Apcj47teap34311y25NLLhaelb3hjsKwztO+sCP9UiTlerYt+7W+rPvjNSfZ2d6OtfdoocbG5d/VdEig1sfyva9NveS+xHZ4Nb/CdecGZ19iZPt7X7pX6V0mGICSSAARCkcKRymmCWrkC6RwINpnsnFeVxkJJliFEdb093rG8+92zd3AAjVLI3UnQ0Ag9EmK9kWb/6AYsTNxILO52+J1J8XrlsWrFrSue42xYjFZ18KAJnejYWRHbFZFwFAtPECf+9AokUNVv/p0RUHWw5OTcn0NgAAwBQTEBGQPBsAmBaaMF9ELuxstuflkqzcPCBIr1ACKBwiEHYGAISdBgDh5gDAs9O+7vnZmBTWRFpWGG3d/eQ1VrIdAIzILDVYQ9IBREAAIsY1xnXp5ktmzdUjBTJEAFCMOCAHZMLJCbeghWr82FhSTcaZFpps9JMii196KUGdtD8iAMhSFoDAJniZ6nh2YMuv80NbAYBgcpqAJAU3YgDg5AcQEEgoehRLiQlOAwAQALRQDeM6IBNO1sn2mGXzkGvjQQBpsjNVQySA67HSx1wDQKaGfGoApO8xmGISCW5Ep9ABZIoxkSAcKI8iIElXDzcAgJXcC0wh6Y3fAaePxP41QAvXKUZcOFkprPzQtrK5l6tmQrh5RIVKziHrvx9runjxJ9eHa8/y/5y1/Gu1S7+gGDEAKI60eoW0FDYAcDWw4KrVZmzOFJpMRDROE0nPSpKUyNE32WDVEgAoju1mXJNuwYzP9T+BaSMxIgCpZrkeayZhI/JM78uMa2biZPIsRASSTA3kB98aePtHAMC1cLRxBVOM4Z2PFkZbjdiccM1SRG5nunteuYep2tD2n/pcDtcsLab2+kYPRDhOAnIVCJii+6o7a/nXuB4B6QEQMiXauMItjtqpDuQ6IAtUnnoIAw7xQn71M1TznmzPS0wNZXtfAYB48/vTXeu4n44TMaZ1rf/SWNtvg5WnEon80NZMz0tasCbSuFwL1XrWWKpzjVdMqoHyVMezO36xPFR3lp3qzA28ecrfbQQA5LqVbN/95DWAaKU61GC099VvDG37KZFgSsDno/RsLVwXaTh/ZNfjnp1SjDLFTPgCOWwgG7e3aOOF/W/ezxTdGtuTG3wr0XJNzx+/cqA0gMjUQLb3lXTXegBgXFPNhHTzo62PE0lEZFqIqQGSHlOD+aGt2f43gKQeneXrOjIunGyq8zmSLuM6UwOFoW15uRkA/eiJXPPsdHnLtQAwuvsJxlTpFiIN5+rheiA6fCoBvh+I1C0zYs0kHJLe0PafasHqWNNFwskcKJKR5FpIDZSrgXKmhUgKQK4YcTVQrphliAqQ9AliakA1y33DmFB7YJzrEUWPoaL77yh6TNGjihH32w6M61Wn3eQWRzI9G7gWkcKKNV8GU1VxDo0DSNJjaiA+52+Ek+VGdKztt8LJ1r33X5Apk6tgRJKkR9Ibd6NEJEh6fhF3slKOPywZK2MqEAFJv1NWeoeE/4OMCzsdnX1JsGLxwOYfeMUkAKlmRdlJH5rg7+EBlF6qWPRxpoUQuVsY6n3168GqJYn5VwkreQxNlAOHcQ0AimO7cdp7JpKUjOuzzv+qcLJD23+iGHHPTsXmXKZHGokEzASAX8AIJFrKTlrpFcdUIzG09cdWet/si/9TDVZJzzrqZhYCkGRcB+RDOx4ZaX2c65HxpO0dJytecbT6jFVm2fyuDV9284PIFKYYNad/ZnyjQ5gy/ZlQ994v+kFXeIXOtau4Fp598f3SLeA0e027iJCpnp3e8Yvlnc/903R9YmSKZ42FG85tPO/edM+G4e2PKIEKrziSWHBtsHIJkcCpGMfvvvvuKfZCJOmpwUrh5lOda7RgVX5oG3K16tQbATG59/dcDx/5vnLwjiA9YSW5GpyUmBxEvXCyWqh24XXPA9Cu/10pvSIAKUZs7gd/xrUwAkxZH5i+bM04ADScfWew6gzPSqqB8v1//MrYntX1y+6oOfNWNz+Ik+sIM8OAij5lAwGZKpysYsRPvvoPihHb9cSVdrqLa2HPSjWcd68WqvEvFVPuehgKkEggU+e8/0Hkmu/U25+5MdPzUtMF36o7+w7XGoWjbYweKjREZIpXHNEiDQs/ut6Iz2lb/bfp7vVqoNLJ9Vcs+njlouuB5GFOmVGDY6T18fbff0IxE1LYiOykDz4Sn33pSOtjnetuE3ZaMWJAx1BnR2RcClvY6fhJH5y38peM67tXf3Ss7bdasMYtDIVqzlx43Vr0fe70xaUjt5j8Jk/f5vu7XvhnNVBFwpHCbjz/3pozPufk+vauuTnd+RwylWmhUrPjCBui3/mTwhZ2Rg1W1S/7cvVpNzv5wbanrs31va4Gq93CsFk29+Tr1qpmOZEYz8yPFQD4rXlkfZu+2/XiHYoZR2RuYbRs3ofnvP9BRY8mO9f0vf7tbN9rJF2uBJDryFjJUukA2f5GJF3pFaVwtFBN+ckfrV92J9dCI62P7Vv/JWGNKWa5mx80y1tarnraV/0T0eQDAH+CBtnQjp91Pn8LAnE96haG1UBl7dLP15zxWQDI9m8a3vFIpudlO9Pt36FKPVZAICKQ/jiLYiYC5aeUzb288pRPMMUojOzofvmu1N5nuBZGRXdzA9Gmi+atfFQx4iewzTouBpKIPNv/xt5nP10caVWDVSQcz0oa8bmVi/++6tQb/TKRldqb63+zONrq5AeEkyXhMjWoGHEj1hSoXBKqfo8/qpLp3di/+YFU5xqSnmqUCTcnPav6jFVNK745obczIevoZiV8rgg33/Xil4d3PAwkuRGXniXsjBpIhGqWRpsuijScH0icPCXz3MJwrn9TqmtdpntDcWwXEChGnKTrWUkz0TJrxdfjpYxN4owd9DEMe5R4k93/au9r38x0vUAkFT1KQNLNS89miq4YZWqwUjESXAsCMvJsz0m7+WGvOCzsDAAyNcAUU3pF4WT1SGPlqZ+qPeOzTA2QFOP2M9N1TPNCRATSdw6ZnpcH3v5RpusF1xpjTGGK6TfkxjNQ6TtBRI5MAcYBgDxbehYwbpbNr1j4sYpFn1DNxIR4j5aW4xh4IoHj13ArvS/dtS7d/WJhcKuT65NesXQfmPDfRACATOFGzIzPDdWdFWu6OFx3jp+fkvRmPq52wgBMwCi5dgAAEG7eSrZb6U473e1ZY9IrkvSYYnA1qIVq9WiTET9JD9cf+Fx6xzk5d2KG/vx5FF9VZva6B+jDfpeH/qagza+TTMy4+A/HT0OE4xrx+zMA+HOvv/jJ3b8CeLfX/wFwDQ+oD4/bFQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wOS0xOFQwNjowMzo1MCswMDowMCVYxZkAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDktMThUMDY6MDM6NTArMDA6MDBUBX0lAAAAAElFTkSuQmCC/WYNR3JhcGVDaXR5LUludGVybmFsLVVzZS1Pbmx5LFd5biBEYXNoYm9hcmQsNTY4MzM3Mzk0NTE5NDQyI0IwcjNyNElsYXBkaldpZEhTa1Z6SzlKbVVXSjdWNk5HZXpzU2RydDRWbUpFUklGbWM3b0hXWVpEU0JoVWJrVlZZaVJWZUhwVlNFWmtjeEk1VTh3VWFuaFZTWHBIYlM1R2JUUlZWaFJsYWpkRWRGZDRVWFpqY0ZoRFdabFhkRlJHU0ZKSE5uTkhheUZqYXZGbFl4Sm5TNDltVnhsNk45WVhiNnNrYllSSGFEVmphbE5uWnJJRlpqVnpTSHRXTXMzbU1vNW1TdUpITjdkN0s4UlVWWUZsUzVvVVZaTmpZS3RrTlZaWE1NZDZiaFpsV0RsVWR4ZFZWcTlXYjlSNGJhdEdVT3Q2ZHNSa01ybFRNOU41U3lFSE41ZHpTdWQ2Tm1SRGNKcG1SQmRXZXBSa0kwSXlVaXdpSUJGa1FCSnpRd1FqSTBJQ1Npd2lNd2dUTzdjRE85QWpNMElpY2ZKeWUmUWYzNVZmaVVVUkpabEkwSXlRaXdpSTRFakw2QkNJVHBFSWtGV1p5QjdVaW9qSU9KeWVicGpJa0pIVWl3aUk3UUROeVlETWdBak14RURNeUFqTWlvakk0SjdRaXdpSXlWR1p1Rm1jQ0JTYWhobVdpb2pJaDk0UWl3aUl5UUROOUVUTjRrek03TXpNOFlUTmlvaklrbGtJczRYWnp4V1ltcGpJeU5IWmlzbk9pd21iQkp5ZTBJQ1Jpd2lJMzR6WjZKWFlWNWtNNGdWV1NSSFU0VlZiSnR5Y1FSNU1CSlVibnA1UktoV1VuVlRRcmxtU3pWNlFGWm1iSzNFZFM5R2NLM1VTaVJIZXg4a1dyUVZOeXR5Tk9aWFJtQnpWdUZGZVlabVF2TVZXcVZHVjU0NlZsRlRPOE56THZsVFp4ZDROTWRFZEJoR1M4SVZhbjltVHY5bU52UjVTeHVtZTY=",atob(o.substring(o.indexOf("/WYN")+4))),window.GC=n,e.exports=n)}}]);